!function(e){"use strict";"function"==typeof define&&define.amd?define(["jquery","./grid.base","./jquery.fmatter","./grid.utils"],e):e(jQuery)}(function(M){"use strict";M.jgrid=M.jgrid||{},M.extend(M.jgrid,{formatCell:function(e,t,r,l,o,a){var n;if(void 0!==l.formatter){var d={rowId:"",colModel:l,gid:o.p.id,pos:t,styleUI:"",isExported:!0,exporttype:a};n=M.isFunction(l.formatter)?l.formatter.call(o,e,d,r):M.fmatter?M.fn.fmatter.call(o,l.formatter,e,d,r):e}else n=e;return n},formatCellCsv:function(t,e){t=null==t?"":String(t);try{t=t.replace(e._regexsep,e.separatorReplace).replace(/\r\n/g,e.replaceNewLine).replace(/\n/g,e.replaceNewLine)}catch(e){t=""}return e.escquote&&(t=t.replace(e._regexquot,e.escquote+e.quote)),-1!==t.indexOf(e.separator)&&-1!==t.indexOf(e.qoute)||(t=e.quote+t+e.quote),t},excelCellPos:function(e){for(var t="A".charCodeAt(0),r="Z".charCodeAt(0)-t+1,l="";0<=e;)l=String.fromCharCode(e%r+t)+l,e=Math.floor(e/r)-1;return l},makeNode:function(e,t,r){var l=e.createElement(t);return r&&(r.attr&&M(l).attr(r.attr),r.children&&M.each(r.children,function(e,t){l.appendChild(t)}),r.hasOwnProperty("text")&&l.appendChild(e.createTextNode(r.text))),l},xmlToZip:function(o,e){var a,n,d,i,p,s,m=this,f=new XMLSerializer,u=-1===f.serializeToString(M.parseXML(M.jgrid.excelStrings["xl/worksheets/sheet1.xml"])).indexOf("xmlns:r"),c=[];M.each(e,function(e,t){if(M.isPlainObject(t))a=o.folder(e),m.xmlToZip(a,t);else{if(u){for(n=t.childNodes[0],d=n.attributes.length-1;0<=d;d--){var r=n.attributes[d].nodeName,l=n.attributes[d].nodeValue;-1!==r.indexOf(":")&&(c.push({name:r,value:l}),n.removeAttribute(r))}for(d=0,i=c.length;d<i;d++)(p=t.createAttribute(c[d].name.replace(":","_dt_b_namespace_token_"))).value=c[d].value,n.setAttributeNode(p)}s=f.serializeToString(t),u&&(-1===s.indexOf("<?xml")&&(s='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>'+s),s=s.replace(/_dt_b_namespace_token_/g,":")),s=s.replace(/<row xmlns="" /g,"<row ").replace(/<cols xmlns="">/g,"<cols>").replace(/<mergeCells xmlns="" /g,"<mergeCells ").replace(/<numFmt xmlns="" /g,"<numFmt ").replace(/<xf xmlns="" /g,"<xf "),o.file(e,s)}})},excelStrings:{"_rels/.rels":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships"><Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument" Target="xl/workbook.xml"/></Relationships>',"xl/_rels/workbook.xml.rels":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships"><Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet" Target="worksheets/sheet1.xml"/><Relationship Id="rId2" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles" Target="styles.xml"/></Relationships>',"[Content_Types].xml":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Types xmlns="http://schemas.openxmlformats.org/package/2006/content-types"><Default Extension="xml" ContentType="application/xml" /><Default Extension="rels" ContentType="application/vnd.openxmlformats-package.relationships+xml" /><Default Extension="jpeg" ContentType="image/jpeg" /><Override PartName="/xl/workbook.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml" /><Override PartName="/xl/worksheets/sheet1.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml" /><Override PartName="/xl/styles.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml" /></Types>',"xl/workbook.xml":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><workbook xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships"><fileVersion appName="xl" lastEdited="5" lowestEdited="5" rupBuild="24816"/><workbookPr showInkAnnotation="0" autoCompressPictures="0"/><bookViews><workbookView xWindow="0" yWindow="0" windowWidth="25600" windowHeight="19020" tabRatio="500"/></bookViews><sheets><sheet name="Sheet1" sheetId="1" r:id="rId1"/></sheets></workbook>',"xl/worksheets/sheet1.xml":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><worksheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" mc:Ignorable="x14ac" xmlns:x14ac="http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac"><sheetData/></worksheet>',"xl/styles.xml":'<?xml version="1.0" encoding="UTF-8"?><styleSheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" mc:Ignorable="x14ac" xmlns:x14ac="http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac"><numFmts count="7"><numFmt numFmtId="164" formatCode="#,##0.00_- [$$-45C]"/><numFmt numFmtId="165" formatCode="&quot;£&quot;#,##0.00"/><numFmt numFmtId="166" formatCode="[$€-2] #,##0.00"/><numFmt numFmtId="167" formatCode="0.0%"/><numFmt numFmtId="168" formatCode="#,##0;(#,##0)"/><numFmt numFmtId="169" formatCode="#,##0.00;(#,##0.00)"/><numFmt numFmtId="170" formatCode="yyyy/mm/dd;@"/></numFmts><fonts count="5" x14ac:knownFonts="1"><font><sz val="11" /><name val="Calibri" /></font><font><sz val="11" /><name val="Calibri" /><color rgb="FFFFFFFF" /></font><font><sz val="11" /><name val="Calibri" /><b /></font><font><sz val="11" /><name val="Calibri" /><i /></font><font><sz val="11" /><name val="Calibri" /><u /></font></fonts><fills count="6"><fill><patternFill patternType="none" /></fill><fill/><fill><patternFill patternType="solid"><fgColor rgb="FFD9D9D9" /><bgColor indexed="64" /></patternFill></fill><fill><patternFill patternType="solid"><fgColor rgb="FFD99795" /><bgColor indexed="64" /></patternFill></fill><fill><patternFill patternType="solid"><fgColor rgb="ffc6efce" /><bgColor indexed="64" /></patternFill></fill><fill><patternFill patternType="solid"><fgColor rgb="ffc6cfef" /><bgColor indexed="64" /></patternFill></fill></fills><borders count="2"><border><left /><right /><top /><bottom /><diagonal /></border><border diagonalUp="false" diagonalDown="false"><left style="thin"><color auto="1" /></left><right style="thin"><color auto="1" /></right><top style="thin"><color auto="1" /></top><bottom style="thin"><color auto="1" /></bottom><diagonal /></border></borders><cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0" /></cellStyleXfs><cellXfs count="67"><xf numFmtId="0" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="2" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="2" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="2" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="2" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="2" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="3" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="3" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="3" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="3" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="3" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="4" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="4" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="4" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="4" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="4" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="5" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="5" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="5" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="5" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="5" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="0" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="0" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="0" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="0" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="0" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="2" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="2" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="2" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="2" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="2" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="3" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="3" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="3" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="3" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="3" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="4" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="4" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="4" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="4" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="4" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="5" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="5" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="5" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="5" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="5" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyAlignment="1"><alignment horizontal="left"/></xf><xf numFmtId="0" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyAlignment="1"><alignment horizontal="center"/></xf><xf numFmtId="0" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyAlignment="1"><alignment horizontal="right"/></xf><xf numFmtId="0" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyAlignment="1"><alignment horizontal="fill"/></xf><xf numFmtId="0" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyAlignment="1"><alignment textRotation="90"/></xf><xf numFmtId="0" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyAlignment="1"><alignment wrapText="1"/></xf><xf numFmtId="9"   fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="164" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="165" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="166" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="167" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="168" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="169" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="3" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="4" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="1" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="2" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="170" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/></cellXfs><cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0" /></cellStyles><dxfs count="0" /><tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4" /></styleSheet>'},excelParsers:[{match:/^\-?\d+\.\d%$/,style:60,fmt:function(e){return e/100}},{match:/^\-?\d+\.?\d*%$/,style:56,fmt:function(e){return e/100}},{match:/^\-?\$[\d,]+.?\d*$/,style:57},{match:/^\-?£[\d,]+.?\d*$/,style:58},{match:/^\-?€[\d,]+.?\d*$/,style:59},{match:/^\-?\d+$/,style:65},{match:/^\-?\d+\.\d{2}$/,style:66},{match:/^\([\d,]+\)$/,style:61,fmt:function(e){return-1*e.replace(/[\(\)]/g,"")}},{match:/^\([\d,]+\.\d{2}\)$/,style:62,fmt:function(e){return-1*e.replace(/[\(\)]/g,"")}},{match:/^\-?[\d,]+$/,style:63},{match:/^\-?[\d,]+\.\d{2}$/,style:64},{match:/^\d{4}\-\d{2}\-\d{2}$/,style:67}]}),M.jgrid.extend({exportToCsv:function(w){w=M.extend(!0,{separator:",",separatorReplace:" ",quote:'"',escquote:'"',newLine:"\r\n",replaceNewLine:" ",includeCaption:!0,includeLabels:!0,includeGroupHeader:!0,includeFooter:!0,fileName:"jqGridExport.csv",mimetype:"text/csv;charset=utf-8",returnAsString:!1,onBeforeExport:null,loadIndicator:!0},w||{});var C="";if(this.each(function(){w._regexsep=new RegExp(w.separator,"g"),w._regexquot=new RegExp(w.quote,"g");var e,t,r,l,j=this,o=this.addLocalData(!0),a=o.length,n=j.p.colModel,d=n.length,i=j.p.colNames,p=0,s="",m="",f="",u="",c="",y=[];M.isFunction(w.loadIndicator)?w.loadIndicator("show"):w.loadIndicator&&M(j).jqGrid("progressBar",{method:"show",loadtype:j.p.loadui,htmlcontent:M.jgrid.getRegional(j,"defaults.loadtext")});var g,h=[];if(M.each(n,function(e,t){t._expcol=!0,void 0===t.exportcol?t.hidden&&(t._expcol=!1):t._expcol=t.exportcol,"cb"!==t.name&&"rn"!==t.name&&"subgrid"!==t.name||(t._expcol=!1),t._expcol&&(y.push(M.jgrid.formatCellCsv(i[e],w)),h.push(t.name))}),w.includeLabels&&(c=y.join(w.separator)+w.newLine),w.collen=y.length,j.p.grouping){var x=!!j.p.groupingView._locgr;j.p.groupingView._locgr=!1,s+=function(m,f){var u="",c=j.p.groupingView,y=[],g=c.groupField.length,h=j.p.colModel,x=h.length,I=0;function F(e,t,r,l){var o,a,n=function(e,t,r){var l,o=!1;if(0===t)o=r[e];else{var a=r[e].idx;if(0===a)o=r[e];else for(l=e;0<=l;l--)if(r[l].idx===a-t){o=r[l];break}}return o}(e,t,r),d=n.cnt,i=new Array(f.collen),p=0;for(a=l;a<x;a++)if(h[a]._excol){var s="{0}";M.each(n.summary,function(){if(this.nm===h[a].name){h[a].summaryTpl&&(s=h[a].summaryTpl),"string"==typeof this.st&&"avg"===this.st.toLowerCase()&&(this.sd&&this.vd?this.v=this.v/this.vd:this.v&&0<d&&(this.v=this.v/d));try{this.groupCount=n.cnt,this.groupIndex=n.dataIndex,this.groupValue=n.value,o=j.formatter("",this.v,a,this)}catch(e){o=this.v}return i[p]=M.jgrid.formatCellCsv(M.jgrid.stripHtml(M.jgrid.template(s,o)),f),!1}}),p++}return i}M.each(h,function(e,t){var r;for(r=0;r<g;r++)if(c.groupField[r]===t.name){y[r]=e;break}});var v,b,w=M.makeArray(c.groupSummary);if(w.reverse(),"local"===j.p.datatype&&!j.p.loadonce){M(j).jqGrid("groupingSetup");for(var e=M.jgrid.getMethod("groupingPrepare"),t=0;t<a;t++)e.call(M(j),o[t],t)}return M.each(c.groups,function(e,t){I++;try{v=M.isArray(c.formatDisplayField)&&M.isFunction(c.formatDisplayField[t.idx])?c.formatDisplayField[t.idx].call(j,t.displayValue,t.value,j.p.colModel[y[t.idx]],t.idx,c):j.formatter("",t.displayValue,y[t.idx],t.value)}catch(e){v=t.displayValue}var r,l="";if("string"!=typeof(l=M.isFunction(c.groupText[t.idx])?c.groupText[t.idx].call(j,v,t.cnt,t.summary):M.jgrid.template(c.groupText[t.idx],v,t.cnt,t.summary))&&"number"!=typeof l&&(l=v),(r="header"===c.groupSummaryPos[t.idx]?F(e,0,c.groups,0):new Array(f.collen))[0]=M.jgrid.formatCellCsv(M.jgrid.stripHtml(l),f),u+=r.join(f.separator)+f.newLine,g-1===t.idx){var o,a,n,d=c.groups[e+1],i=t.startRow,p=void 0!==d?d.startRow:c.groups[e].startRow+c.groups[e].cnt;for(o=i;o<p&&m[+o];o++){for(n=m[+o],a=b=0;a<h.length;a++)h[a]._expcol&&(r[b]=M.jgrid.formatCellCsv(M.jgrid.formatCell(n[h[a].name],a,n,h[a],j,"csv"),f),b++);u+=r.join(f.separator)+f.newLine}if("header"!==c.groupSummaryPos[t.idx]){var s;if(void 0!==d){for(s=0;s<c.groupField.length&&d.dataIndex!==c.groupField[s];s++);I=c.groupField.length-s}for(a=0;a<I;a++)w[a]&&(r=F(e,a,c.groups,0),u+=r.join(f.separator)+f.newLine);I=s}}}),u}(o,w),j.p.groupingView._locgr=x}else for(;p<a;){for(t=o[p],r=[],e=l=0;e<d;e++)n[e]._expcol&&(r[l]=M.jgrid.formatCellCsv(M.jgrid.formatCell(t[n[e].name],e,t,n[e],j,"csv"),w),l++);s+=r.join(w.separator)+w.newLine,p++}if(o=null,r=new Array(w.collen),w.includeCaption&&j.p.caption){for(p=w.collen;--p;)r[p]="";r[0]=M.jgrid.formatCellCsv(j.p.caption,w),m+=r.join(w.separator)+w.newLine}if(w.includeGroupHeader&&j.p.groupHeader&&j.p.groupHeader.length){var I=j.p.groupHeader;for(e=0;e<I.length;e++){var F=I[e].groupHeaders;for(r=[],g=p=0;g<h.length;g++){for(r[p]="",l=0;l<F.length;l++)F[l].startColumnName===h[g]&&(r[p]=M.jgrid.formatCellCsv(F[l].titleText,w));p++}f+=r.join(w.separator)+w.newLine}}if(w.includeFooter&&j.p.footerrow&&M(".ui-jqgrid-ftable",this.sDiv).length){var v=M(j).jqGrid("footerData","get");for(e=0,r=[];e<w.collen;){var b=h[e];v.hasOwnProperty(b)&&r.push(M.jgrid.formatCellCsv(M.jgrid.stripHtml(v[b]),w)),e++}u+=r.join(w.separator)+w.newLine}C=m+f+c+s+u,M.isFunction(w.loadIndicator)?w.loadIndicator("hide"):w.loadIndicator&&M(j).jqGrid("progressBar",{method:"hide",loadtype:j.p.loadui})}),w.returnAsString)return C;if(-1!==w.mimetype.toUpperCase().indexOf("UTF-8")&&(C="\ufeff"+C),M.isFunction(w.onBeforeExport)&&!(C=w.onBeforeExport(C)))throw"Before export does not return data!";M.jgrid.saveAs(C,w.fileName,{type:w.mimetype})},exportToExcel:function(E){E=M.extend(!0,{includeLabels:!0,includeGroupHeader:!0,includeFooter:!0,fileName:"jqGridExport.xlsx",mimetype:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",maxlength:40,onBeforeExport:null,replaceStr:null,loadIndicator:!0},E||{}),this.each(function(){function e(e){if(M.isEmptyObject(e))e.excel_parsers=!0;else if(e.excel_format&&!e.excel_style){var r=0,l=0;M.each(n,function(e,t){r++,l=Math.max(l,parseInt(M(t).attr("numFmtId"),10))});var t=M.jgrid.makeNode(o,"numFmt",{attr:{numFmtId:l+1,formatCode:e.excel_format}});a.appendChild(t),M(a).attr("count",r+1),r=0,t=M.jgrid.makeNode(o,"xf",{attr:{numFmtId:l+1+"",fontId:"0",fillId:"0",borderId:"0",applyFont:"1",applyFill:"1",applyBorder:"1",xfId:"0",applyNumberFormat:"1"}}),d.appendChild(t),r=parseInt(M(d).attr("count"),10),M(d).attr("count",r+1),e.excel_style=r+1}return e}var t,r,F=this,l=M.jgrid.excelStrings,f=0,u=M.parseXML(l["xl/worksheets/sheet1.xml"]),c=u.getElementsByTagName("sheetData")[0],o=M.parseXML(l["xl/styles.xml"]),a=o.getElementsByTagName("numFmts")[0],n=M(a.getElementsByTagName("numFmt")),d=o.getElementsByTagName("cellXfs")[0],i={_rels:{".rels":M.parseXML(l["_rels/.rels"])},xl:{_rels:{"workbook.xml.rels":M.parseXML(l["xl/_rels/workbook.xml.rels"])},"workbook.xml":M.parseXML(l["xl/workbook.xml"]),"styles.xml":o,worksheets:{"sheet1.xml":u}},"[Content_Types].xml":M.parseXML(l["[Content_Types].xml"])},v=F.p.colModel,p=0,b={body:F.addLocalData(!0),header:[],footer:[],width:[],map:[],parser:[]};for(t=0,r=v.length;t<r;t++)v[t]._expcol=!0,void 0===v[t].exportcol?v[t].hidden&&(v[t]._expcol=!1):v[t]._expcol=v[t].exportcol,"cb"!==v[t].name&&"rn"!==v[t].name&&"subgrid"!==v[t].name&&v[t]._expcol&&(b.header[p]=v[t].name,b.width[p]=5,b.map[p]=t,b.parser[t]=e(v[t].hasOwnProperty("exportoptions")?v[t].exportoptions:{}),p++);function y(e,t){return M.jgrid.makeNode(u,"c",{attr:e,children:[M.jgrid.makeNode(u,"v",{text:t})]})}function g(e,t){return M.jgrid.makeNode(u,"c",{attr:{t:"inlineStr",r:e},children:{row:M.jgrid.makeNode(u,"is",{children:{row:M.jgrid.makeNode(u,"t",{text:t})}})}})}var h,x,I=M.isFunction(E.replaceStr)?E.replaceStr:function(e){return e.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/[\x00-\x09\x0B\x0C\x0E-\x1F\x7F-\x9F]/g,"")},w=function(e,t){h=f+1,x=M.jgrid.makeNode(u,"row",{attr:{r:h}});for(var r=0;r<b.header.length;r++){var l,o,a=M.jgrid.excelCellPos(r)+""+h,n=M.isArray(e)&&t?F.p.colNames[b.map[r]]:e[b.header[r]];null==n&&(n=""),t||(n=M.jgrid.formatCell(n,b.map[r],e,v[b.map[r]],F,"excel")),b.width[r]=Math.max(b.width[r],Math.min(parseInt(n.toString().length,10),E.maxlength)),l=null;var d=b.parser[b.map[r]];if(!0!==d.excel_parsers||t)void 0===d.excel_format||void 0===d.excel_style||t||l||(d.replace_format&&(n=d.replace_format(n)),l=y({r:a,s:d.excel_style},n),x.appendChild(l));else for(var i=0,p=M.jgrid.excelParsers.length;i<p;i++){var s=M.jgrid.excelParsers[i];if(n.match&&!n.match(/^0\d+/)&&n.match(s.match)){var m=n;if(n=n.replace(/[^\d\.\-]/g,""),s.fmt&&(n=s.fmt(n)),67===s.style)l=y({t:"d",r:a,s:s.style},n);else{if(M.inArray(s.style,["63","64","65","66"])&&15<n.toString().length){l=g(a,m.replace?I(m):m),x.appendChild(l);break}l=y({r:a,s:s.style},n)}x.appendChild(l);break}}l||(n.match&&(o=n.match(/^-?([1-9]\d+)(\.(\d+))?$/)),l="number"==typeof n&&n.toString().length<=15||o&&o[1].length+(o[2]?o[3].length:0)<=15?y({t:"n",r:a},n):g(a,n.replace?I(n):n),x.appendChild(l))}c.appendChild(x),f++};if(M.isFunction(E.loadIndicator)?E.loadIndicator("show"):E.loadIndicator&&M(F).jqGrid("progressBar",{method:"show",loadtype:F.p.loadui,htmlcontent:M.jgrid.getRegional(F,"defaults.loadtext")}),M("sheets sheet",i.xl["workbook.xml"]).attr("name",E.sheetName),E.includeGroupHeader&&F.p.groupHeader&&F.p.groupHeader.length){var s,m,j=F.p.groupHeader,C=[],B=0;for(m=0;m<j.length;m++){var k=j[m].groupHeaders,T={};for(B++,t=t=0;t<b.header.length;t++){T[s=b.header[t]]="";for(var _=0;_<k.length;_++)if(k[_].startColumnName===s){T[s]=k[_].titleText;var S=M.jgrid.excelCellPos(t)+B,N=M.jgrid.excelCellPos(t+k[_].numberOfColumns-1)+B;C.push({ref:S+":"+N})}}w(T,!0)}M("row c",u).attr("s","2");var A=M.jgrid.makeNode(u,"mergeCells",{attr:{count:C.length}});for(M("worksheet",u).append(A),p=0;p<C.length;p++)A.appendChild(M.jgrid.makeNode(u,"mergeCell",{attr:C[p]}))}if(E.includeLabels&&(w(b.header,!0),M("row:last c",u).attr("s","2")),F.p.grouping){var L=!!F.p.groupingView._locgr;F.p.groupingView._locgr=!1,function(m){var f=F.p.groupingView,u=[],c=f.groupField.length,s=v.length,y=0;function g(e,t,r,l){var o,a,n=function(e,t,r){var l,o=!1;if(0===t)o=r[e];else{var a=r[e].idx;if(0===a)o=r[e];else for(l=e;0<=l;l--)if(r[l].idx===a-t){o=r[l];break}}return o}(e,t,r),d=n.cnt,i=h(b.header);for(a=l;a<s;a++)if(v[a]._expcol){var p="{0}";M.each(n.summary,function(){if(this.nm===v[a].name){v[a].summaryTpl&&(p=v[a].summaryTpl),"string"==typeof this.st&&"avg"===this.st.toLowerCase()&&(this.sd&&this.vd?this.v=this.v/this.vd:this.v&&0<d&&(this.v=this.v/d));try{this.groupCount=n.cnt,this.groupIndex=n.dataIndex,this.groupValue=n.value,o=F.formatter("",this.v,a,this)}catch(e){o=this.v}return i[this.nm]=M.jgrid.stripHtml(M.jgrid.template(p,o)),!1}})}return i}function h(e){for(var t={},r=0;r<e.length;r++)t[e[r]]="";return t}M.each(v,function(e,t){var r;for(r=0;r<c;r++)if(f.groupField[r]===t.name){u[r]=e;break}});var x,I=M.makeArray(f.groupSummary);if(I.reverse(),"local"===F.p.datatype&&!F.p.loadonce){M(F).jqGrid("groupingSetup");for(var e=M.jgrid.getMethod("groupingPrepare"),t=0;t<b.body.length;t++)e.call(M(F),b.body[t],t)}M.each(f.groups,function(e,t){y++;try{x=M.isArray(f.formatDisplayField)&&M.isFunction(f.formatDisplayField[t.idx])?f.formatDisplayField[t.idx].call(F,t.displayValue,t.value,F.p.colModel[u[t.idx]],t.idx,f):F.formatter("",t.displayValue,u[t.idx],t.value)}catch(e){x=t.displayValue}var r,l="";if("string"!=typeof(l=M.isFunction(f.groupText[t.idx])?f.groupText[t.idx].call(F,x,t.cnt,t.summary):M.jgrid.template(f.groupText[t.idx],x,t.cnt,t.summary))&&"number"!=typeof l&&(l=x),(r="header"===f.groupSummaryPos[t.idx]?g(e,0,f.groups,0):h(b.header))[Object.keys(r)[0]]=M.jgrid.stripHtml(new Array(5*t.idx).join(" ")+l),w(r,!0),c-1===t.idx){var o,a,n=f.groups[e+1],d=t.startRow,i=void 0!==n?n.startRow:f.groups[e].startRow+f.groups[e].cnt;for(o=d;o<i&&m[+o];o++){var p=m[+o];w(p,!1)}if("header"!==f.groupSummaryPos[t.idx]){var s;if(void 0!==n){for(s=0;s<f.groupField.length&&n.dataIndex!==f.groupField[s];s++);y=f.groupField.length-s}for(a=0;a<y;a++)I[a]&&(r=g(e,a,f.groups,0),w(r,!0));y=s}}})}(b.body),F.p.groupingView._locgr=L}else for(var D=0,H=b.body.length;D<H;D++)w(b.body[D],!1);if(E.includeFooter||F.p.footerrow){for(p in b.footer=M(F).jqGrid("footerData","get"),b.footer)b.footer.hasOwnProperty(p)&&(b.footer[p]=M.jgrid.stripHtml(b.footer[p]));w(b.footer,!0),M("row:last c",u).attr("s","2")}var P=M.jgrid.makeNode(u,"cols");for(M("worksheet",u).prepend(P),p=0,r=b.width.length;p<r;p++)P.appendChild(M.jgrid.makeNode(u,"col",{attr:{min:p+1,max:p+1,width:b.width[p],customWidth:1}}));M.isFunction(E.onBeforeExport)&&E.onBeforeExport(i,f),b=null;try{var V=new JSZip,q={type:"blob",mimeType:E.mimetype};M.jgrid.xmlToZip(V,i),V.generateAsync?V.generateAsync(q).then(function(e){M.jgrid.saveAs(e,E.fileName,{type:E.mimetype})}):M.jgrid.saveAs(V.generate(q),E.fileName,{type:E.mimetype})}catch(e){throw e}finally{M.isFunction(E.loadIndicator)?E.loadIndicator("hide"):E.loadIndicator&&M(F).jqGrid("progressBar",{method:"hide",loadtype:F.p.loadui})}})},exportToPdf:function(I){return I=M.extend(!0,{title:null,orientation:"portrait",pageSize:"A4",description:null,onBeforeExport:null,download:"download",includeLabels:!0,includeGroupHeader:!0,includeFooter:!0,fileName:"jqGridExport.pdf",mimetype:"application/pdf",loadIndicator:!0},I||{}),this.each(function(){var e,t,r,l,o,b=this,w=[],a=b.p.colModel,n={},d=b.addLocalData(!0),j=[],i=0,p=[],s=[],m=[],C={};for(M.isFunction(I.loadIndicator)?I.loadIndicator("show"):I.loadIndicator&&M(b).jqGrid("progressBar",{method:"show",loadtype:b.p.loadui,htmlcontent:M.jgrid.getRegional(b,"defaults.loadtext")}),e=0,t=a.length;e<t;e++)a[e]._expcol=!0,void 0===a[e].exportcol?a[e].hidden&&(a[e]._expcol=!1):a[e]._expcol=a[e].exportcol,"cb"!==a[e].name&&"rn"!==a[e].name&&"subgrid"!==a[e].name&&a[e]._expcol&&(n={text:b.p.colNames[e],style:"tableHeader"},s.push(n),j[i]=a[e].name,p[i]=e,m.push(a[e].width),C[a[e].name]=a[e].align||"left",i++);if(I.includeGroupHeader&&b.p.groupHeader&&b.p.groupHeader.length)for(o=b.p.groupHeader,i=0;i<o.length;i++){var f=[],u=o[i].groupHeaders;for(r=0;r<j.length;r++){for(n={text:"",style:"tableHeader"},l=0;l<u.length;l++)u[l].startColumnName===j[r]&&(n={text:u[l].titleText,colSpan:u[l].numberOfColumns,style:"tableHeader"});f.push(n),e++}w.push(f)}if(I.includeLabels&&w.push(s),b.p.grouping){var c=!!b.p.groupingView._locgr;b.p.groupingView._locgr=!1,function(m){var f=b.p.groupingView,u=[],c=f.groupField.length,s=b.p.colModel,y=s.length,g=0;function h(e,t){for(var r=0,l=[],o=0;o<j.length;o++)n={text:null==e[j[o]]?"":t?M.jgrid.formatCell(e[j[o]]+"",p[r],d[i],s[p[r]],b,"pdf"):e[j[o]],alignment:C[o],style:"tableBody"},l.push(n),r++;return l}function x(e,t,r,l){var o,a,n=function(e,t,r){var l,o=!1;if(0===t)o=r[e];else{var a=r[e].idx;if(0===a)o=r[e];else for(l=e;0<=l;l--)if(r[l].idx===a-t){o=r[l];break}}return o}(e,t,r),d=n.cnt,i=I(j);for(a=l;a<y;a++)if(s[a]._expcol){var p="{0}";M.each(n.summary,function(){if(this.nm===s[a].name){s[a].summaryTpl&&(p=s[a].summaryTpl),"string"==typeof this.st&&"avg"===this.st.toLowerCase()&&(this.sd&&this.vd?this.v=this.v/this.vd:this.v&&0<d&&(this.v=this.v/d));try{this.groupCount=n.cnt,this.groupIndex=n.dataIndex,this.groupValue=n.value,o=b.formatter("",this.v,a,this)}catch(e){o=this.v}return i[this.nm]=M.jgrid.stripHtml(M.jgrid.template(p,o)),!1}})}return i}function I(e){for(var t={},r=0;r<e.length;r++)t[e[r]]="";return t}M.each(s,function(e,t){var r;for(r=0;r<c;r++)if(f.groupField[r]===t.name){u[r]=e;break}});var F,v=M.makeArray(f.groupSummary);if(v.reverse(),"local"===b.p.datatype&&!b.p.loadonce){M(b).jqGrid("groupingSetup");for(var e=M.jgrid.getMethod("groupingPrepare"),t=0;t<d.length;t++)e.call(M(b),d[t],t)}M.each(f.groups,function(e,t){g++;try{F=M.isArray(f.formatDisplayField)&&M.isFunction(f.formatDisplayField[t.idx])?f.formatDisplayField[t.idx].call(b,t.displayValue,t.value,b.p.colModel[u[t.idx]],t.idx,f):b.formatter("",t.displayValue,u[t.idx],t.value)}catch(e){F=t.displayValue}var r,l="";if("string"!=typeof(l=M.isFunction(f.groupText[t.idx])?f.groupText[t.idx].call(b,F,t.cnt,t.summary):M.jgrid.template(f.groupText[t.idx],F,t.cnt,t.summary))&&"number"!=typeof l&&(l=F),(r="header"===f.groupSummaryPos[t.idx]?x(e,0,f.groups,0):I(j))[Object.keys(r)[0]]=M.jgrid.stripHtml(new Array(5*t.idx).join(" ")+l),w.push(h(r,!1)),c-1===t.idx){var o,a,n=f.groups[e+1],d=t.startRow,i=void 0!==n?n.startRow:f.groups[e].startRow+f.groups[e].cnt;for(o=d;o<i&&m[+o];o++){var p=m[+o];w.push(h(p,!0))}if("header"!==f.groupSummaryPos[t.idx]){var s;if(void 0!==n){for(s=0;s<f.groupField.length&&n.dataIndex!==f.groupField[s];s++);g=f.groupField.length-s}for(a=0;a<g;a++)v[a]&&(r=x(e,a,f.groups,0),w.push(h(r,!1)));g=s}}})}(d),b.p.groupingView._locgr=c}else{var y;for(i=0,t=d.length;i<t;i++){for(l=0,s=[],y=d[i],r=0;r<j.length;r++)n={text:null==y[j[r]]?"":M.jgrid.formatCell(y[j[r]]+"",p[l],d[i],a[p[l]],b,"pdf"),alignment:C[j[r]],style:"tableBody"},s.push(n),l++;w.push(s)}}if(I.includeFooter&&b.p.footerrow){var g=M(b).jqGrid("footerData","get");for(s=[],r=0;r<j.length;r++)n={text:M.jgrid.stripHtml(g[j[r]]),style:"tableFooter",alignment:C[j[r]]},s.push(n);w.push(s)}var h={pageSize:I.pageSize,pageOrientation:I.orientation,content:[{style:"tableExample",widths:m,table:{headerRows:null!=o?0:1,body:w}}],styles:{tableHeader:{bold:!0,fontSize:11,color:"#2e6e9e",fillColor:"#dfeffc",alignment:"center"},tableBody:{fontSize:10},tableFooter:{bold:!0,fontSize:11,color:"#2e6e9e",fillColor:"#dfeffc"},title:{alignment:"center",fontSize:15},description:{}},defaultStyle:{fontSize:10}};I.description&&h.content.unshift({text:I.description,style:"description",margin:[0,0,0,12]}),I.title&&h.content.unshift({text:I.title,style:"title",margin:[0,0,0,12]}),M.isFunction(I.onBeforeExport)&&I.onBeforeExport.call(b,h);try{var x=pdfMake.createPdf(h);x.getDataUrl(function(e){M.isFunction(I.loadIndicator)?I.loadIndicator("hide"):I.loadIndicator&&M(b).jqGrid("progressBar",{method:"hide",loadtype:b.p.loadui})}),"open"===I.download?x.open():x.getBuffer(function(e){M.jgrid.saveAs(e,I.fileName,{type:I.mimetype})})}catch(e){throw e}})},exportToHtml:function(p){var s;return p=M.extend(!0,{title:"",onBeforeExport:null,includeLabels:!0,includeGroupHeader:!0,includeFooter:!0,tableClass:"jqgridprint",autoPrint:!1,topText:"",bottomText:"",returnAsString:!1,loadIndicator:!0},p||{}),this.each(function(){var e,b=this,m=b.p.colModel,t=0,w={body:b.addLocalData(!0),header:[],footer:[],width:[],map:[],align:[]};for(e=0,n=m.length;e<n;e++)m[e]._expcol=!0,void 0===m[e].exportcol?m[e].hidden&&(m[e]._expcol=!1):m[e]._expcol=m[e].exportcol,"cb"!==m[e].name&&"rn"!==m[e].name&&"subgrid"!==m[e].name&&m[e]._expcol&&(w.header[t]=m[e].name,w.width[t]=m[e].width,w.map[t]=e,w.align[t]=m[e].align||"left",t++);var r=document.createElement("a"),l=function(e){r.href=e;var t=r.host;return-1===t.indexOf("/")&&0!==r.pathname.indexOf("/")&&(t+="/"),r.protocol+"//"+t+r.pathname+r.search},j=function(e,t,r,l,o){for(var a,n,d="<tr>",i=0,p=w.header.length;i<p&&(n=o?' colspan= "'+w.header.length+'" style=text-align:left':!0===l?" style=width:"+w.width[i]+"px;text-align:"+w.align[i]+";":" style=text-align:"+w.align[i]+";",a=w.header[i],e.hasOwnProperty(a)&&(d+="<"+t+n+">"+(r?M.jgrid.formatCell(e[a],w.map[i],e,m[w.map[i]],b,"html"):e[a])+"</"+t+">"),!o);i++);return d+"</tr>"};M.isFunction(p.loadIndicator)?p.loadIndicator("show"):p.loadIndicator&&M(b).jqGrid("progressBar",{method:"show",loadtype:b.p.loadui,htmlcontent:M.jgrid.getRegional(b,"defaults.loadtext")});var o='<table class="'+p.tableClass+'">';if(p.includeLabels&&(o+="<thead>"+function(e,t,r){for(var l="<tr>",o=0,a=e.length;o<a;o++)l+="<"+t+(!0===r?" style=width:"+w.width[o]+"px;":"")+">"+b.p.colNames[w.map[o]]+"</"+t+">";return l+"</tr>"}(w.header,"th",!0)+"</thead>"),o+="<tbody>",b.p.grouping){var a=!!b.p.groupingView._locgr;b.p.groupingView._locgr=!1,o+=function(f){var u=b.p.groupingView,c=[],y=u.groupField.length,s=m.length,g=0,h="";function x(e,t,r,l){var o,a,n=function(e,t,r){var l,o=!1;if(0===t)o=r[e];else{var a=r[e].idx;if(0===a)o=r[e];else for(l=e;0<=l;l--)if(r[l].idx===a-t){o=r[l];break}}return o}(e,t,r),d=n.cnt,i=I(w.header);for(a=l;a<s;a++)if(m[a]._expcol){var p="{0}";M.each(n.summary,function(){if(this.nm===m[a].name){m[a].summaryTpl&&(p=m[a].summaryTpl),"string"==typeof this.st&&"avg"===this.st.toLowerCase()&&(this.sd&&this.vd?this.v=this.v/this.vd:this.v&&0<d&&(this.v=this.v/d));try{this.groupCount=n.cnt,this.groupIndex=n.dataIndex,this.groupValue=n.value,o=b.formatter("",this.v,a,this)}catch(e){o=this.v}return i[this.nm]=M.jgrid.stripHtml(M.jgrid.template(p,o)),!1}})}return i}function I(e){for(var t={},r=0;r<e.length;r++)t[e[r]]="";return t}M.each(m,function(e,t){var r;for(r=0;r<y;r++)if(u.groupField[r]===t.name){c[r]=e;break}});var F,v=M.makeArray(u.groupSummary);if(v.reverse(),"local"===b.p.datatype&&!b.p.loadonce){M(b).jqGrid("groupingSetup");for(var e=M.jgrid.getMethod("groupingPrepare"),t=0;t<w.body.length;t++)e.call(M(b),w.body[t],t)}return M.each(u.groups,function(e,t){g++;try{F=M.isArray(u.formatDisplayField)&&M.isFunction(u.formatDisplayField[t.idx])?u.formatDisplayField[t.idx].call(b,t.displayValue,t.value,b.p.colModel[c[t.idx]],t.idx,u):b.formatter("",t.displayValue,c[t.idx],t.value)}catch(e){F=t.displayValue}var r="";"string"!=typeof(r=M.isFunction(u.groupText[t.idx])?u.groupText[t.idx].call(b,F,t.cnt,t.summary):M.jgrid.template(u.groupText[t.idx],F,t.cnt,t.summary))&&"number"!=typeof r&&(r=F);var l,o=!1;if("header"===u.groupSummaryPos[t.idx]?l=x(e,0,u.groups,0):(l=I(w.header),o=!0),l[Object.keys(l)[0]]=new Array(5*t.idx).join(" ")+r,h+=j(l,"td",!1,1===g,o),y-1===t.idx){var a,n,d=u.groups[e+1],i=t.startRow,p=void 0!==d?d.startRow:u.groups[e].startRow+u.groups[e].cnt;for(a=i;a<p&&f[+a];a++){var s=f[+a];h+=j(s,"td",!1)}if("header"!==u.groupSummaryPos[t.idx]){var m;if(void 0!==d){for(m=0;m<u.groupField.length&&d.dataIndex!==u.groupField[m];m++);g=u.groupField.length-m}for(n=0;n<g;n++)v[n]&&(l=x(e,n,u.groups,0),h+=j(l,"td",!1));g=m}}}),h}(w.body),b.p.groupingView._locgr=a}else{t=0;for(var n=w.body.length;t<n;t++)o+=j(w.body[t],"td",!0,0===t)}if(p.includeFooter&&b.p.footerrow&&(w.footer=M(b).jqGrid("footerData","get",null,!1),o+=j(w.footer,"td",!1)),o+="</tbody>",o+="</table>",p.returnAsString)s=o;else{var d=window.open("","");d.document.close();var i=p.title?"<title>"+p.title+"</title>":"";M("style, link").each(function(){var e;i+=("link"===(e=M(this).clone()[0]).nodeName.toLowerCase()&&(e.href=l(e.href)),e.outerHTML)});try{d.document.head.innerHTML=i}catch(e){M(d.document.head).html(i)}d.document.body.innerHTML=(p.title?"<h1>"+p.title+"</h1>":"")+"<div>"+(p.topText||"")+"</div>"+o+"<div>"+(p.bottomText||"")+"</div>",M(d.document.body).addClass("html-view"),M("img",d.document.body).each(function(e,t){t.setAttribute("src",l(t.getAttribute("src")))}),p.onBeforeExport&&p.onBeforeExport(d),Boolean(d.chrome)?p.autoPrint&&(d.print(),d.close()):setTimeout(function(){p.autoPrint&&(d.print(),d.close())},1e3)}M.isFunction(p.loadIndicator)?p.loadIndicator("hide"):p.loadIndicator&&M(b).jqGrid("progressBar",{method:"hide",loadtype:b.p.loadui})}),s}})});