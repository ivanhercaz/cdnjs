!function(e){"use strict";"function"==typeof define&&define.amd?define(["jquery"],e):e(jQuery)}(function(d){"use strict";d.fn.jqm=function(e){var t={overlay:50,closeoverlay:!0,overlayClass:"jqmOverlay",closeClass:"jqmClose",trigger:".jqModal",ajax:h,ajaxText:"",target:h,modal:h,toTop:h,onShow:h,onHide:h,onLoad:h};return this.each(function(){if(this._jqm)return u[this._jqm].c=d.extend({},u[this._jqm].c,e);n++,this._jqm=n,u[n]={c:d.extend(t,d.jqm.params,e),a:h,w:d(this).addClass("jqmID"+n),s:n},t.trigger&&d(this).jqmAddTrigger(t.trigger)})},d.fn.jqmAddClose=function(e){return i(this,e,"jqmHide")},d.fn.jqmAddTrigger=function(e){return i(this,e,"jqmShow")},d.fn.jqmShow=function(e){return this.each(function(){d.jqm.open(this._jqm,e)})},d.fn.jqmHide=function(e){return this.each(function(){d.jqm.close(this._jqm,e)})},d.jqm={hash:{},open:function(e,t){var n=u[e],o=n.c,i="."+o.closeClass,s=parseInt(n.w.css("z-index"));s=0<s?s:3e3;var r=d("<div></div>").css({height:"100%",width:"100%",position:"fixed",left:0,top:0,"z-index":s-1,opacity:o.overlay/100});if(n.a)return h;if(n.t=t,n.a=!0,n.w.css("z-index",s),o.modal?(f[0]||setTimeout(function(){new l("bind")},1),f.push(e)):0<o.overlay?o.closeoverlay&&n.w.jqmAddClose(r):r=h,n.o=r?r.addClass(o.overlayClass).prependTo("body"):h,o.ajax){var a=o.target||n.w,c=o.ajax;a="string"==typeof a?d(a,n.w):d(a),c="@"===c.substr(0,1)?d(t).attr(c.substring(1)):c,a.html(o.ajaxText).load(c,function(){o.onLoad&&o.onLoad.call(this,n),i&&n.w.jqmAddClose(d(i,n.w)),m(n)})}else i&&n.w.jqmAddClose(d(i,n.w));return o.toTop&&n.o&&n.w.before('<span id="jqmP'+n.w[0]._jqm+'"></span>').insertAfter(n.o),o.onShow?o.onShow(n):n.w.show(),m(n),h},close:function(e){var t=u[e];return t.a&&(t.a=h,f[0]&&(f.pop(),f[0]||new l("unbind")),t.c.toTop&&t.o&&d("#jqmP"+t.w[0]._jqm).after(t.w).remove(),t.c.onHide?t.c.onHide(t):(t.w.hide(),t.o&&t.o.remove())),h},params:{}};var n=0,u=d.jqm.hash,f=[],h=!1,m=function(e){void 0===e.c.focusField&&(e.c.focusField=0),0<=e.c.focusField&&t(e)},t=function(e){try{d(":input:visible",e.w)[parseInt(e.c.focusField,10)].focus()}catch(e){}},l=function(e){d(document)[e]("keypress",o)[e]("keydown",o)[e]("mousedown",o)},o=function(n){var e=u[f[f.length-1]],o=!d(n.target).parents(".jqmID"+e.s)[0];return o&&d(".jqmID"+e.s).each(function(){var e=d(this),t=e.offset();if(t.top<=n.pageY&&n.pageY<=t.top+e.height()&&t.left<=n.pageX&&n.pageX<=t.left+e.width())return o=!1}),!o},i=function(e,t,n){return e.each(function(){var e=this._jqm;d(t).each(function(){this[n]||(this[n]=[],d(this).click(function(){for(var e in{jqmShow:1,jqmHide:1})for(var t in this[e])u[this[e][t]]&&u[this[e][t]].w[e](this);return h})),this[n].push(e)})})}});