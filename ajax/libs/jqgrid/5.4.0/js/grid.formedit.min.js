!function(e){"use strict";"function"==typeof define&&define.amd?define(["jquery","./grid.base","./grid.common"],e):e(jQuery)}(function(Q){"use strict";var X={};Q.jgrid.extend({editGridRow:function(H,V){var e=Q.jgrid.getRegional(this[0],"edit"),t=this[0].p.styleUI,W=Q.jgrid.styleUI[t].formedit,L=Q.jgrid.styleUI[t].common;return V=Q.extend(!0,{top:0,left:0,width:"500",datawidth:"auto",height:"auto",dataheight:"auto",modal:!1,overlay:30,drag:!0,resize:!0,url:null,mtype:"POST",clearAfterAdd:!0,closeAfterEdit:!1,reloadAfterSubmit:!0,onInitializeForm:null,beforeInitData:null,beforeShowForm:null,afterShowForm:null,beforeSubmit:null,afterSubmit:null,onclickSubmit:null,afterComplete:null,onclickPgButtons:null,afterclickPgButtons:null,editData:{},recreateForm:!1,jqModal:!0,closeOnEscape:!1,addedrow:"first",topinfo:"",bottominfo:"",saveicon:[],closeicon:[],savekey:[!1,13],navkeys:[!1,38,40],checkOnSubmit:!1,checkOnUpdate:!1,processing:!1,onClose:null,ajaxEditOptions:{},serializeEditData:null,viewPagerButtons:!0,overlayClass:L.overlay,removemodal:!0,form:"edit",template:null,focusField:!0,editselected:!1,html5Check:!1,buttons:[]},e,V||{}),X[Q(this)[0].p.id]=V,this.each(function(){var q=this;if(q.grid&&H){q.p.savedData={};var a,m,g,v=q.p.id,y="FrmGrid_"+v,e="TblGrid_"+v,b="#"+Q.jgrid.jqID(e),j={themodal:"editmod"+v,modalhead:"edithd"+v,modalcontent:"editcnt"+v,scrollelm:y},t=!0,i=1,d=0,x="string"==typeof X[q.p.id].template&&0<X[q.p.id].template.length,w=Q.jgrid.getRegional(this,"errors");X[q.p.id].styleUI=q.p.styleUI||"jQueryUI",Q.jgrid.isMobile()&&(X[q.p.id].resize=!1),"new"===H?(H="_empty",g="add",V.caption=X[q.p.id].addCaption):(V.caption=X[q.p.id].editCaption,g="edit"),V.recreateForm||Q(q).data("formProp")&&Q.extend(X[Q(this)[0].p.id],Q(q).data("formProp"));var r=!0;V.checkOnUpdate&&V.jqModal&&!V.modal&&(r=!1);var o,n,l,s=isNaN(X[Q(this)[0].p.id].dataheight)?X[Q(this)[0].p.id].dataheight:X[Q(this)[0].p.id].dataheight+"px",c=isNaN(X[Q(this)[0].p.id].datawidth)?X[Q(this)[0].p.id].datawidth:X[Q(this)[0].p.id].datawidth+"px",_=Q("<form name='FormPost' id='"+y+"' class='FormGrid' onSubmit='return false;' style='width:"+c+";height:"+s+";'></form>").data("disabled",!1);if(a=x?(n=X[Q(this)[0].p.id].template,l="","string"==typeof n&&(l=n.replace(/\{([\w\-]+)(?:\:([\w\.]*)(?:\((.*?)?\))?)?\}/g,function(e,t){return'<span id="'+t+'" ></span>'})),o=l,b):(o=Q("<table id='"+e+"' class='EditTable ui-common-table'><tbody></tbody></table>"),b+"_2"),y="#"+Q.jgrid.jqID(y),Q(_).append("<div class='FormError "+L.error+"' style='display:none;'></div>"),Q(_).append("<div class='tinfo topinfo'>"+X[q.p.id].topinfo+"</div>"),Q(q.p.colModel).each(function(){var e=this.formoptions;i=Math.max(i,e&&e.colpos||0),d=Math.max(d,e&&e.rowpos||0)}),Q(_).append(o),void 0===(t=Q(q).triggerHandler("jqGridAddEditBeforeInitData",[_,g]))&&(t=!0),t&&Q.isFunction(X[q.p.id].beforeInitData)&&(t=X[q.p.id].beforeInitData.call(q,_,g)),!1!==t){!function(){var e;if("_empty"!==H&&void 0!==q.p.savedRow&&0<q.p.savedRow.length&&Q.isFunction(Q.fn.jqGrid.restoreRow))for(e=0;e<q.p.savedRow.length;e++)if(q.p.savedRow[e].id===H){Q(q).jqGrid("restoreRow",H);break}}(),function(n,l,s,c){var p,u,h,f,m,g,e,v,t,b=0,j=[],w=!1,D="";for(e=1;e<=c;e++)D+="<td class='CaptionTD'></td><td class='DataTD'></td>";"_empty"!==n&&(w=Q(l).jqGrid("getInd",n)),Q(l.p.colModel).each(function(t){if(p=this.name,u=(!this.editrules||!0!==this.editrules.edithidden)&&!0===this.hidden,m=u?"style='display:none'":"","cb"!==p&&"subgrid"!==p&&!0===this.editable&&"rn"!==p){if(!1===w)f="";else if(p===l.p.ExpandColumn&&!0===l.p.treeGrid)f=Q("td[role='gridcell']:eq("+t+")",l.rows[w]).text();else{try{f=Q.unformat.call(l,Q("td[role='gridcell']:eq("+t+")",l.rows[w]),{rowId:n,colModel:this},t)}catch(e){f=this.edittype&&"textarea"===this.edittype?Q("td[role='gridcell']:eq("+t+")",l.rows[w]).text():Q("td[role='gridcell']:eq("+t+")",l.rows[w]).html()}f&&"&nbsp;"!==f&&"&#160;"!==f&&(1!==f.length||160!==f.charCodeAt(0))||(f="")}var e=Q.extend({},this.editoptions||{},{id:p,name:p,rowId:n,oper:"edit",module:"form",checkUpdate:X[q.p.id].checkOnSubmit||X[q.p.id].checkOnUpdate}),i=Q.extend({},{elmprefix:"",elmsuffix:"",rowabove:!1,rowcontent:""},this.formoptions||{}),a=parseInt(i.rowpos,10)||b+1,d=parseInt(2*(parseInt(i.colpos,10)||1),10);if("_empty"===n&&e.defaultValue&&(f=Q.isFunction(e.defaultValue)?e.defaultValue.call(q):e.defaultValue),this.edittype||(this.edittype="text"),q.p.autoencode&&(f=Q.jgrid.htmlDecode(f)),g=Q.jgrid.createEl.call(q,this.edittype,e,f,!1,Q.extend({},Q.jgrid.ajaxOptions,l.p.ajaxSelectOptions||{})),"select"===this.edittype&&(f=Q(g).val(),"select-multiple"===Q(g).get(0).type&&f&&(f=f.join(","))),"checkbox"===this.edittype&&(f=Q(g).is(":checked")?Q(g).val():Q(g).attr("offval")),Q(g).addClass("FormElement"),-1<Q.inArray(this.edittype,["text","textarea","password","select","color","date","datetime","datetime-local","email","month","number","range","search","tel","time","url","week"])&&Q(g).addClass(W.inputClass),v=!0,x){var r=Q(_).find("#"+p);r.length?r.replaceWith(g):v=!1}else{if(h=Q(s).find("tr[rowpos="+a+"]"),i.rowabove){var o=Q("<tr><td class='contentinfo' colspan='"+2*c+"'>"+i.rowcontent+"</td></tr>");Q(s).append(o),o[0].rp=a}0===h.length&&(h=1<c?Q("<tr rowpos='"+a+"'></tr>").addClass("FormData").attr("id","tr_"+p):Q("<tr "+m+" rowpos='"+a+"'></tr>").addClass("FormData").attr("id","tr_"+p),Q(h).append(D),Q(s).append(h),h[0].rp=a),Q("td:eq("+(d-2)+")",h[0]).html("<label for='"+p+"'>"+(void 0===i.label?l.p.colNames[t]:i.label)+"</label>"),Q("td:eq("+(d-1)+")",h[0]).append(i.elmprefix).append(g).append(i.elmsuffix),1<c&&u&&(Q("td:eq("+(d-2)+")",h[0]).hide(),Q("td:eq("+(d-1)+")",h[0]).hide())}(X[q.p.id].checkOnSubmit||X[q.p.id].checkOnUpdate)&&v&&(q.p.savedData[p]=f),"custom"===this.edittype&&Q.isFunction(e.custom_value)&&e.custom_value.call(q,Q("#"+p,y),"set",f),Q.jgrid.bindEv.call(q,g,e),j[b]=t,b++}}),0<b&&(x?(t="<div class='FormData' style='display:none'><input class='FormElement' id='id_g' type='text' name='"+l.p.id+"_id' value='"+n+"'/>",Q(_).append(t)):((t=Q("<tr class='FormData' style='display:none'><td class='CaptionTD'></td><td colspan='"+(2*c-1)+"' class='DataTD'><input class='FormElement' id='id_g' type='text' name='"+l.p.id+"_id' value='"+n+"'/></td></tr>"))[0].rp=b+999,Q(s).append(t)),(X[q.p.id].checkOnSubmit||X[q.p.id].checkOnUpdate)&&(q.p.savedData[l.p.id+"_id"]=n))}(H,q,o,i);var p="rtl"===q.p.direction,u=p?"pData":"nData",h="<a id='"+(p?"nData":"pData")+"' class='fm-button "+L.button+"'><span class='"+L.icon_base+" "+W.icon_prev+"'></span></a>",f="<a id='"+u+"' class='fm-button "+L.button+"'><span class='"+L.icon_base+" "+W.icon_next+"'></span></a>",D="<a id='sData' class='fm-button "+L.button+"'>"+V.bSubmit+"</a>",I="<a id='cData' class='fm-button "+L.button+"'>"+V.bCancel+"</a>",k=Q.isArray(X[q.p.id].buttons)?Q.jgrid.buildButtons(X[q.p.id].buttons,D+I,L):D+I,C="<table style='height:auto' class='EditTable ui-common-table' id='"+e+"_2'><tbody><tr><td colspan='2'><hr class='"+L.content+"' style='margin:1px'/></td></tr><tr id='Act_Buttons'><td class='navButton'>"+(p?f+h:h+f)+"</td><td class='EditButton'>"+k+"</td></tr>";if(C+="</tbody></table>",0<d){var F=[];Q.each(Q(o)[0].rows,function(e,t){F[e]=t}),F.sort(function(e,t){return e.rp>t.rp?1:e.rp<t.rp?-1:0}),Q.each(F,function(e,t){Q("tbody",o).append(t)})}V.gbox="#gbox_"+Q.jgrid.jqID(v);var G,S=!1;!0===V.closeOnEscape&&(V.closeOnEscape=!1,S=!0),G=x?(Q(_).find("#pData").replaceWith(h),Q(_).find("#nData").replaceWith(f),Q(_).find("#sData").replaceWith(D),Q(_).find("#cData").replaceWith(I),Q("<div id="+e+"></div>").append(_)):Q("<div></div>").append(_).append(C),Q(_).append("<div class='binfo topinfo bottominfo'>"+X[q.p.id].bottominfo+"</div>");var O=Q(".ui-jqgrid").css("font-size")||"11px";if(Q.jgrid.createModal(j,G,X[Q(this)[0].p.id],"#gview_"+Q.jgrid.jqID(q.p.id),Q("#gbox_"+Q.jgrid.jqID(q.p.id))[0],null,{"font-size":O}),p&&(Q("#pData, #nData",b+"_2").css("float","right"),Q(".EditButton",b+"_2").css("text-align","left")),X[q.p.id].topinfo&&Q(".tinfo",y).show(),X[q.p.id].bottominfo&&Q(".binfo",y).show(),C=G=null,Q("#"+Q.jgrid.jqID(j.themodal)).keydown(function(e){var t=e.target;if(!0===Q(y).data("disabled"))return!1;if(!0===X[q.p.id].savekey[0]&&e.which===X[q.p.id].savekey[1]&&"TEXTAREA"!==t.tagName)return Q("#sData",b+"_2").trigger("click"),!1;if(27===e.which)return U()&&S&&Q.jgrid.hideModal("#"+Q.jgrid.jqID(j.themodal),{gb:V.gbox,jqm:V.jqModal,onClose:X[q.p.id].onClose,removemodal:X[q.p.id].removemodal,formprop:!X[q.p.id].recreateForm,form:X[q.p.id].form}),!1;if(!0===X[q.p.id].navkeys[0]){if("_empty"===Q("#id_g",b).val())return!0;if(e.which===X[q.p.id].navkeys[1])return Q("#pData",a).trigger("click"),!1;if(e.which===X[q.p.id].navkeys[2])return Q("#nData",a).trigger("click"),!1}}),V.checkOnUpdate&&(Q("a.ui-jqdialog-titlebar-close span","#"+Q.jgrid.jqID(j.themodal)).removeClass("jqmClose"),Q("a.ui-jqdialog-titlebar-close","#"+Q.jgrid.jqID(j.themodal)).off("click").click(function(){return U()&&Q.jgrid.hideModal("#"+Q.jgrid.jqID(j.themodal),{gb:"#gbox_"+Q.jgrid.jqID(v),jqm:V.jqModal,onClose:X[q.p.id].onClose,removemodal:X[q.p.id].removemodal,formprop:!X[q.p.id].recreateForm,form:X[q.p.id].form}),!1})),V.saveicon=Q.extend([!0,"left",W.icon_save],V.saveicon),V.closeicon=Q.extend([!0,"left",W.icon_close],V.closeicon),!0===V.saveicon[0]&&Q("#sData",a).addClass("right"===V.saveicon[1]?"fm-button-icon-right":"fm-button-icon-left").append("<span class='"+L.icon_base+" "+V.saveicon[2]+"'></span>"),!0===V.closeicon[0]&&Q("#cData",a).addClass("right"===V.closeicon[1]?"fm-button-icon-right":"fm-button-icon-left").append("<span class='"+L.icon_base+" "+V.closeicon[2]+"'></span>"),X[q.p.id].checkOnSubmit||X[q.p.id].checkOnUpdate){D="<a id='sNew' class='fm-button "+L.button+"' style='z-index:1002'>"+V.bYes+"</a>",f="<a id='nNew' class='fm-button "+L.button+"' style='z-index:1002;margin-left:5px'>"+V.bNo+"</a>",I="<a id='cNew' class='fm-button "+L.button+"' style='z-index:1002;margin-left:5px;'>"+V.bExit+"</a>";var P=V.zIndex||999;P++,Q("#"+j.themodal).append("<div class='"+V.overlayClass+" jqgrid-overlay confirm' style='z-index:"+P+";display:none;position:absolute;'>&#160;</div><div class='confirm ui-jqconfirm "+L.content+"' style='z-index:"+(1+P)+"'>"+V.saveData+"<br/><br/>"+D+f+I+"</div>"),Q("#sNew","#"+Q.jgrid.jqID(j.themodal)).click(function(){return B(),Q(y).data("disabled",!1),Q(".confirm","#"+Q.jgrid.jqID(j.themodal)).hide(),!1}),Q("#nNew","#"+Q.jgrid.jqID(j.themodal)).click(function(){return Q(".confirm","#"+Q.jgrid.jqID(j.themodal)).hide(),Q(y).data("disabled",!1),setTimeout(function(){Q(":input:visible",y)[0].focus()},0),!1}),Q("#cNew","#"+Q.jgrid.jqID(j.themodal)).click(function(){return Q(".confirm","#"+Q.jgrid.jqID(j.themodal)).hide(),Q(y).data("disabled",!1),Q.jgrid.hideModal("#"+Q.jgrid.jqID(j.themodal),{gb:"#gbox_"+Q.jgrid.jqID(v),jqm:V.jqModal,onClose:X[q.p.id].onClose,removemodal:X[q.p.id].removemodal,formprop:!X[q.p.id].recreateForm,form:X[q.p.id].form}),!1})}Q(q).triggerHandler("jqGridAddEditInitializeForm",[Q(y),g]),Q.isFunction(X[q.p.id].onInitializeForm)&&X[q.p.id].onInitializeForm.call(q,Q(y),g),"_empty"!==H&&X[q.p.id].viewPagerButtons?Q("#pData,#nData",a).show():Q("#pData,#nData",a).hide(),Q(q).triggerHandler("jqGridAddEditBeforeShowForm",[Q(y),g]),Q.isFunction(X[q.p.id].beforeShowForm)&&X[q.p.id].beforeShowForm.call(q,Q(y),g),z(),Q("#"+Q.jgrid.jqID(j.themodal)).data("onClose",X[q.p.id].onClose),Q.jgrid.viewModal("#"+Q.jgrid.jqID(j.themodal),{gbox:"#gbox_"+Q.jgrid.jqID(v),jqm:V.jqModal,overlay:V.overlay,modal:V.modal,overlayClass:V.overlayClass,focusField:V.focusField,onHide:function(e){var t=Q("#editmod"+v)[0].style.height,i=Q("#editmod"+v)[0].style.width;-1<t.indexOf("px")&&(t=parseFloat(t)),-1<i.indexOf("px")&&(i=parseFloat(i)),Q(q).data("formProp",{top:parseFloat(Q(e.w).css("top")),left:parseFloat(Q(e.w).css("left")),width:i,height:t,dataheight:Q(y).height(),datawidth:Q(y).width()}),e.w.remove(),e.o&&e.o.remove()}}),r||Q("."+Q.jgrid.jqID(V.overlayClass)).click(function(){return U()&&Q.jgrid.hideModal("#"+Q.jgrid.jqID(j.themodal),{gb:"#gbox_"+Q.jgrid.jqID(v),jqm:V.jqModal,onClose:X[q.p.id].onClose,removemodal:X[q.p.id].removemodal,formprop:!X[q.p.id].recreateForm,form:X[q.p.id].form}),!1}),Q(".fm-button","#"+Q.jgrid.jqID(j.themodal)).hover(function(){Q(this).addClass(L.hover)},function(){Q(this).removeClass(L.hover)}),Q("#sData",a).click(function(){return m={},Q(".FormError",y).hide(),M(),"_empty"===m[q.p.id+"_id"]?B():!0===V.checkOnSubmit&&R(m,q.p.savedData)?(Q(y).data("disabled",!0),Q(".confirm","#"+Q.jgrid.jqID(j.themodal)).show()):B(),!1}),Q("#cData",a).click(function(){return U()&&Q.jgrid.hideModal("#"+Q.jgrid.jqID(j.themodal),{gb:"#gbox_"+Q.jgrid.jqID(v),jqm:V.jqModal,onClose:X[q.p.id].onClose,removemodal:X[q.p.id].removemodal,formprop:!X[q.p.id].recreateForm,form:X[q.p.id].form}),!1}),Q(a).find("[data-index]").each(function(){var t=parseInt(Q(this).attr("data-index"),10);0<=t&&V.buttons[t].hasOwnProperty("click")&&Q(this).on("click",function(e){V.buttons[t].click.call(q,Q(y)[0],X[q.p.id],e)})}),Q("#nData",a).click(function(){if(!U())return!1;Q(".FormError",y).hide();var e=N();if(e[0]=parseInt(e[0],10),-1!==e[0]&&e[1][e[0]+1]){var t;if(Q(q).triggerHandler("jqGridAddEditClickPgButtons",["next",Q(y),e[1][e[0]]]),Q.isFunction(V.onclickPgButtons)&&void 0!==(t=V.onclickPgButtons.call(q,"next",Q(y),e[1][e[0]]))&&!1===t)return!1;if(Q("#"+Q.jgrid.jqID(e[1][e[0]+1])).hasClass(L.disabled))return!1;A(e[1][e[0]+1],q,y),q.p.multiselect&&X[q.p.id].editselected||Q(q).jqGrid("setSelection",e[1][e[0]+1]),Q(q).triggerHandler("jqGridAddEditAfterClickPgButtons",["next",Q(y),e[1][e[0]]]),Q.isFunction(V.afterclickPgButtons)&&V.afterclickPgButtons.call(q,"next",Q(y),e[1][e[0]+1]),z(),T(e[0]+1,e)}return!1}),Q("#pData",a).click(function(){if(!U())return!1;Q(".FormError",y).hide();var e=N();if(-1!==e[0]&&e[1][e[0]-1]){var t;if(Q(q).triggerHandler("jqGridAddEditClickPgButtons",["prev",Q(y),e[1][e[0]]]),Q.isFunction(V.onclickPgButtons)&&void 0!==(t=V.onclickPgButtons.call(q,"prev",Q(y),e[1][e[0]]))&&!1===t)return!1;if(Q("#"+Q.jgrid.jqID(e[1][e[0]-1])).hasClass(L.disabled))return!1;A(e[1][e[0]-1],q,y),q.p.multiselect&&X[q.p.id].editselected||Q(q).jqGrid("setSelection",e[1][e[0]-1]),Q(q).triggerHandler("jqGridAddEditAfterClickPgButtons",["prev",Q(y),e[1][e[0]]]),Q.isFunction(V.afterclickPgButtons)&&V.afterclickPgButtons.call(q,"prev",Q(y),e[1][e[0]-1]),z(),T(e[0]-1,e)}return!1}),Q(q).triggerHandler("jqGridAddEditAfterShowForm",[Q(y),g]),Q.isFunction(X[q.p.id].afterShowForm)&&X[q.p.id].afterShowForm.call(q,Q(y),g);var E=N();T(E[0],E)}}function M(){var e,d={};for(e in Q(b).find(".FormElement").each(function(){var e=Q(".customelement",this);if(e.length){var t=e[0],i=Q(t).attr("name");Q.each(q.p.colModel,function(){if(this.name===i&&this.editoptions&&Q.isFunction(this.editoptions.custom_value)){try{if(m[i]=this.editoptions.custom_value.call(q,Q("#"+Q.jgrid.jqID(i),b),"get"),void 0===m[i])throw"e1"}catch(e){"e1"===e?Q.jgrid.info_dialog(w.errcap,"function 'custom_value' "+X[Q(this)[0]].p.msg.novalue,X[Q(this)[0]].p.bClose,{styleUI:X[Q(this)[0]].p.styleUI}):Q.jgrid.info_dialog(w.errcap,e.message,X[Q(this)[0]].p.bClose,{styleUI:X[Q(this)[0]].p.styleUI})}return!0}})}else{switch(Q(this).get(0).type){case"checkbox":if(Q(this).is(":checked"))m[this.name]=Q(this).val();else{var a=Q(this).attr("offval");m[this.name]=a}break;case"select-one":m[this.name]=Q(this).val();break;case"select-multiple":m[this.name]=Q(this).val(),m[this.name]=m[this.name]?m[this.name].join(","):"";break;case"radio":if(d.hasOwnProperty(this.name))return!0;d[this.name]=void 0===Q(this).attr("offval")?"off":Q(this).attr("offval");break;default:m[this.name]=Q(this).val()}q.p.autoencode&&(m[this.name]=Q.jgrid.htmlEncode(m[this.name]))}}),d)if(d.hasOwnProperty(e)){var t=Q('input[name="'+e+'"]:checked',b).val();m[e]=void 0!==t?t:d[e],q.p.autoencode&&(m[e]=Q.jgrid.htmlEncode(m[e]))}return 1}function A(i,a,d){var r,o,e,t,n,l,s=0;(X[q.p.id].checkOnSubmit||X[q.p.id].checkOnUpdate)&&(q.p.savedData={},q.p.savedData[a.p.id+"_id"]=i);var c=a.p.colModel;if("_empty"===i)return Q(c).each(function(){r=this.name,t=Q.extend({},this.editoptions||{}),(e=Q("#"+Q.jgrid.jqID(r),d))&&e.length&&null!==e[0]&&(n="","custom"===this.edittype&&Q.isFunction(t.custom_value)?t.custom_value.call(q,Q("#"+r,d),"set",n):t.defaultValue?(n=Q.isFunction(t.defaultValue)?t.defaultValue.call(q):t.defaultValue,"checkbox"===e[0].type?(l=n.toLowerCase()).search(/(false|f|0|no|n|off|undefined)/i)<0&&""!==l?(e[0].checked=!0,e[0].defaultChecked=!0,e[0].value=n):(e[0].checked=!1,e[0].defaultChecked=!1):e.val(n)):"checkbox"===e[0].type?(e[0].checked=!1,e[0].defaultChecked=!1,n=Q(e).attr("offval")):e[0].type&&"select"===e[0].type.substr(0,6)?e[0].selectedIndex=0:e.val(n),!0!==X[q.p.id].checkOnSubmit&&!X[q.p.id].checkOnUpdate||(q.p.savedData[r]=n))}),void Q("#id_g",d).val(i);var p=Q(a).jqGrid("getInd",i,!0);p&&(Q('td[role="gridcell"]',p).each(function(t){if("cb"!==(r=c[t].name)&&"subgrid"!==r&&"rn"!==r&&!0===c[t].editable){if(r===a.p.ExpandColumn&&!0===a.p.treeGrid)o=Q(this).text();else try{o=Q.unformat.call(a,Q(this),{rowId:i,colModel:c[t]},t)}catch(e){o="textarea"===c[t].edittype?Q(this).text():Q(this).html()}switch(q.p.autoencode&&(o=Q.jgrid.htmlDecode(o)),!0!==X[q.p.id].checkOnSubmit&&!X[q.p.id].checkOnUpdate||(q.p.savedData[r]=o),r=Q.jgrid.jqID(r),c[t].edittype){case"select":var e=o.split(",");e=Q.map(e,function(e){return Q.trim(e)}),Q("#"+r+" option",d).each(function(){c[t].editoptions.multiple||Q.trim(o)!==Q.trim(Q(this).text())&&e[0]!==Q.trim(Q(this).text())&&e[0]!==Q.trim(Q(this).val())?c[t].editoptions.multiple&&(-1<Q.inArray(Q.trim(Q(this).text()),e)||-1<Q.inArray(Q.trim(Q(this).val()),e))?this.selected=!0:this.selected=!1:this.selected=!0}),!0!==X[q.p.id].checkOnSubmit&&!X[q.p.id].checkOnUpdate||(o=Q("#"+r,d).val(),c[t].editoptions.multiple&&(o=o.join(",")),q.p.savedData[r]=o);break;case"checkbox":if(o=String(o),c[t].editoptions&&c[t].editoptions.value)c[t].editoptions.value.split(":")[0]===o?Q("#"+r,d)[q.p.useProp?"prop":"attr"]({checked:!0,defaultChecked:!0}):Q("#"+r,d)[q.p.useProp?"prop":"attr"]({checked:!1,defaultChecked:!1});else(o=o.toLowerCase()).search(/(false|f|0|no|n|off|undefined)/i)<0&&""!==o?(Q("#"+r,d)[q.p.useProp?"prop":"attr"]("checked",!0),Q("#"+r,d)[q.p.useProp?"prop":"attr"]("defaultChecked",!0)):(Q("#"+r,d)[q.p.useProp?"prop":"attr"]("checked",!1),Q("#"+r,d)[q.p.useProp?"prop":"attr"]("defaultChecked",!1));!0!==X[q.p.id].checkOnSubmit&&!X[q.p.id].checkOnUpdate||(o=Q("#"+r,d).is(":checked")?Q("#"+r,d).val():Q("#"+r,d).attr("offval"),q.p.savedData[r]=o);break;case"custom":try{if(!c[t].editoptions||!Q.isFunction(c[t].editoptions.custom_value))throw"e1";c[t].editoptions.custom_value.call(q,Q("#"+r,d),"set",o)}catch(e){"e1"===e?Q.jgrid.info_dialog(w.errcap,"function 'custom_value' "+X[Q(this)[0]].p.msg.nodefined,Q.rp_ge[Q(this)[0]].p.bClose,{styleUI:X[Q(this)[0]].p.styleUI}):Q.jgrid.info_dialog(w.errcap,e.message,Q.rp_ge[Q(this)[0]].p.bClose,{styleUI:X[Q(this)[0]].p.styleUI})}break;default:("&nbsp;"===o||"&#160;"===o||1===o.length&&160===o.charCodeAt(0))&&(o=""),Q("#"+r,d).val(o)}s++}}),0<s&&(Q("#id_g",b).val(i),!0!==X[q.p.id].checkOnSubmit&&!X[q.p.id].checkOnUpdate||(q.p.savedData[a.p.id+"_id"]=i)))}function B(){var a,d,r,e,o,t,i,n=[!0,"",""],l={},s=q.p.prmNames,c=Q(q).triggerHandler("jqGridAddEditBeforeCheckValues",[m,Q(y),g]);if(c&&"object"==typeof c&&(m=c),Q.isFunction(X[q.p.id].beforeCheckValues)&&(c=X[q.p.id].beforeCheckValues.call(q,m,Q(y),g))&&"object"==typeof c&&(m=c),!X[q.p.id].html5Check||Q.jgrid.validateForm(_[0])){for(e in m)if(m.hasOwnProperty(e)&&!1===(n=Q.jgrid.checkValues.call(q,m[e],e))[0])break;if(Q.each(q.p.colModel,function(e,t){t.editoptions&&!0===t.editoptions.NullIfEmpty&&m.hasOwnProperty(t.name)&&""===m[t.name]&&(m[t.name]="null")}),n[0]&&(void 0===(l=Q(q).triggerHandler("jqGridAddEditClickSubmit",[X[q.p.id],m,g]))&&Q.isFunction(X[q.p.id].onclickSubmit)&&(l=X[q.p.id].onclickSubmit.call(q,X[q.p.id],m,g)||{}),void 0===(n=Q(q).triggerHandler("jqGridAddEditBeforeSubmit",[m,Q(y),g]))&&(n=[!0,"",""]),n[0]&&Q.isFunction(X[q.p.id].beforeSubmit)&&(n=X[q.p.id].beforeSubmit.call(q,m,Q(y),g))),n[0]&&!X[q.p.id].processing){if(X[q.p.id].processing=!0,Q("#sData",b+"_2").addClass(L.active),i=X[q.p.id].url||Q(q).jqGrid("getGridParam","editurl"),r=s.oper,d="clientArray"===i?q.p.keyName:s.id,m[r]="_empty"===Q.trim(m[q.p.id+"_id"])?s.addoper:s.editoper,m[r]!==s.addoper?m[d]=m[q.p.id+"_id"]:void 0===m[d]&&(m[d]=m[q.p.id+"_id"]),delete m[q.p.id+"_id"],m=Q.extend(m,X[q.p.id].editData,l),!0===q.p.treeGrid){if(m[r]===s.addoper){o=Q(q).jqGrid("getGridParam","selrow");var p="adjacency"===q.p.treeGridModel?q.p.treeReader.parent_id_field:"parent_id";m[p]=o}for(t in q.p.treeReader)if(q.p.treeReader.hasOwnProperty(t)){var u=q.p.treeReader[t];if(m.hasOwnProperty(u)){if(m[r]===s.addoper&&"parent_id_field"===t)continue;delete m[u]}}}m[d]=Q.jgrid.stripPref(q.p.idPrefix,m[d]);var h=Q.extend({url:i,type:X[q.p.id].mtype,data:Q.isFunction(X[q.p.id].serializeEditData)?X[q.p.id].serializeEditData.call(q,m):m,complete:function(e,t){var i;if(Q("#sData",b+"_2").removeClass(L.active),m[d]=q.p.idPrefix+m[d],300<=e.status&&304!==e.status?(n[0]=!1,n[1]=Q(q).triggerHandler("jqGridAddEditErrorTextFormat",[e,g]),Q.isFunction(X[q.p.id].errorTextFormat)?n[1]=X[q.p.id].errorTextFormat.call(q,e,g):n[1]=t+" Status: '"+e.statusText+"'. Error code: "+e.status):(void 0===(n=Q(q).triggerHandler("jqGridAddEditAfterSubmit",[e,m,g]))&&(n=[!0,"",""]),n[0]&&Q.isFunction(X[q.p.id].afterSubmit)&&(n=X[q.p.id].afterSubmit.call(q,e,m,g))),!1===n[0])Q(".FormError",y).html(n[1]),Q(".FormError",y).show();else if(q.p.autoencode&&Q.each(m,function(e,t){m[e]=Q.jgrid.htmlDecode(t)}),m[r]===s.addoper?(n[2]||(n[2]=Q.jgrid.randId()),null==m[d]||m[d]===q.p.idPrefix+"_empty"||""===m[d]?m[d]=n[2]:n[2]=m[d],X[q.p.id].reloadAfterSubmit?Q(q).trigger("reloadGrid"):!0===q.p.treeGrid?Q(q).jqGrid("addChildNode",n[2],o,m):Q(q).jqGrid("addRowData",n[2],m,V.addedrow),X[q.p.id].closeAfterAdd?(!0!==q.p.treeGrid&&Q(q).jqGrid("setSelection",n[2]),Q.jgrid.hideModal("#"+Q.jgrid.jqID(j.themodal),{gb:"#gbox_"+Q.jgrid.jqID(v),jqm:V.jqModal,onClose:X[q.p.id].onClose,removemodal:X[q.p.id].removemodal,formprop:!X[q.p.id].recreateForm,form:X[q.p.id].form})):X[q.p.id].clearAfterAdd&&A("_empty",q,y)):(X[q.p.id].reloadAfterSubmit?(Q(q).trigger("reloadGrid"),X[q.p.id].closeAfterEdit||setTimeout(function(){Q(q).jqGrid("setSelection",m[d])},1e3)):!0===q.p.treeGrid?Q(q).jqGrid("setTreeRow",m[d],m):Q(q).jqGrid("setRowData",m[d],m),X[q.p.id].closeAfterEdit&&Q.jgrid.hideModal("#"+Q.jgrid.jqID(j.themodal),{gb:"#gbox_"+Q.jgrid.jqID(v),jqm:V.jqModal,onClose:X[q.p.id].onClose,removemodal:X[q.p.id].removemodal,formprop:!X[q.p.id].recreateForm,form:X[q.p.id].form})),(Q.isFunction(X[q.p.id].afterComplete)||Q._data(Q(q)[0],"events").hasOwnProperty("jqGridAddEditAfterComplete"))&&(a=e,setTimeout(function(){Q(q).triggerHandler("jqGridAddEditAfterComplete",[a,m,Q(y),g]);try{X[q.p.id].afterComplete.call(q,a,m,Q(y),g)}catch(e){}a=null},500)),(X[q.p.id].checkOnSubmit||X[q.p.id].checkOnUpdate)&&(Q(y).data("disabled",!1),"_empty"!==q.p.savedData[q.p.id+"_id"]))for(i in q.p.savedData)q.p.savedData.hasOwnProperty(i)&&m[i]&&(q.p.savedData[i]=m[i]);X[q.p.id].processing=!1;try{Q(":input:visible",y)[0].focus()}catch(e){}}},Q.jgrid.ajaxOptions,X[q.p.id].ajaxEditOptions);if(h.url||X[q.p.id].useDataProxy||(Q.isFunction(q.p.dataProxy)?X[q.p.id].useDataProxy=!0:(n[0]=!1,n[1]+=" "+w.nourl)),n[0])if(X[q.p.id].useDataProxy){var f=q.p.dataProxy.call(q,h,"set_"+q.p.id);void 0===f&&(f=[!0,""]),!1===f[0]?(n[0]=!1,n[1]=f[1]||"Error deleting the selected row!"):(h.data.oper===s.addoper&&X[q.p.id].closeAfterAdd&&Q.jgrid.hideModal("#"+Q.jgrid.jqID(j.themodal),{gb:"#gbox_"+Q.jgrid.jqID(v),jqm:V.jqModal,onClose:X[q.p.id].onClose,removemodal:X[q.p.id].removemodal,formprop:!X[q.p.id].recreateForm,form:X[q.p.id].form}),h.data.oper===s.editoper&&X[q.p.id].closeAfterEdit&&Q.jgrid.hideModal("#"+Q.jgrid.jqID(j.themodal),{gb:"#gbox_"+Q.jgrid.jqID(v),jqm:V.jqModal,onClose:X[q.p.id].onClose,removemodal:X[q.p.id].removemodal,formprop:!X[q.p.id].recreateForm,form:X[q.p.id].form}))}else"clientArray"===h.url?(X[q.p.id].reloadAfterSubmit=!1,m=h.data,h.complete({status:200,statusText:""},"")):Q.ajax(h)}!1===n[0]&&(Q(".FormError",y).html(n[1]),Q(".FormError",y).show())}}function R(e,t){var i,a=!1;if(!(a=!(Q.isPlainObject(e)&&Q.isPlainObject(t)&&Object.getOwnPropertyNames(e).length===Object.getOwnPropertyNames(t).length)))for(i in t)if(t.hasOwnProperty(i)){if(!e.hasOwnProperty(i)){a=!0;break}if(e[i]!==t[i]){a=!0;break}}return a}function U(){var e=!0;return Q(".FormError",y).hide(),X[q.p.id].checkOnUpdate&&(m={},M(),R(m,q.p.savedData)&&(Q(y).data("disabled",!0),Q(".confirm","#"+j.themodal).show(),e=!1)),e}function T(e,t){var i=t[1].length-1;0===e||void 0!==t[1][e-1]&&Q("#"+Q.jgrid.jqID(t[1][e-1])).hasClass(L.disabled)?Q("#pData",a).addClass(L.disabled):Q("#pData",a).removeClass(L.disabled),e===i||void 0!==t[1][e+1]&&Q("#"+Q.jgrid.jqID(t[1][e+1])).hasClass(L.disabled)?Q("#nData",a).addClass(L.disabled):Q("#nData",a).removeClass(L.disabled)}function N(){var e=Q(q).jqGrid("getDataIDs"),t=Q("#id_g",b).val();if(q.p.multiselect&&X[q.p.id].editselected){for(var i=[],a=0,d=e.length;a<d;a++)-1!==Q.inArray(e[a],q.p.selarrrow)&&i.push(e[a]);return[Q.inArray(t,i),i]}return[Q.inArray(t,e),e]}function z(){if(X[q.p.id].checkOnSubmit||X[q.p.id].checkOnUpdate){var i=[],a={};for(var e in i=Q.map(q.p.savedData,function(e,t){return t}),Q(".FormElement",_).each(function(){if(""!==Q.trim(this.name)&&-1===i.indexOf(this.name)){var e=Q(this).val(),t=Q(this).get(0).type;if("checkbox"===t)Q(this).is(":checked")||(e=Q(this).attr("offval"));else if("select-multiple"===t)e=e.join(",");else if("radio"===t){if(a.hasOwnProperty(this.name))return!0;a[this.name]=void 0===Q(this).attr("offval")?"off":Q(this).attr("offval")}q.p.savedData[this.name]=e}}),a)if(a.hasOwnProperty(e)){var t=Q('input[name="'+e+'"]:checked',_).val();q.p.savedData[e]=void 0!==t?t:a[e]}}}})},viewGridRow:function(C,F){var e=Q.jgrid.getRegional(this[0],"view"),t=this[0].p.styleUI,G=Q.jgrid.styleUI[t].formedit,S=Q.jgrid.styleUI[t].common;return F=Q.extend(!0,{top:0,left:0,width:500,datawidth:"auto",height:"auto",dataheight:"auto",modal:!1,overlay:30,drag:!0,resize:!0,jqModal:!0,closeOnEscape:!1,labelswidth:"auto",closeicon:[],navkeys:[!1,38,40],onClose:null,beforeShowForm:null,beforeInitData:null,viewPagerButtons:!0,recreateForm:!1,removemodal:!0,form:"view",buttons:[]},e,F||{}),X[Q(this)[0].p.id]=F,this.each(function(){var i=this;if(i.grid&&C){var e=i.p.id,t="ViewGrid_"+Q.jgrid.jqID(e),n="ViewTbl_"+Q.jgrid.jqID(e),a="ViewGrid_"+e,d="ViewTbl_"+e,r={themodal:"viewmod"+e,modalhead:"viewhd"+e,modalcontent:"viewcnt"+e,scrollelm:t},o=!0,l=1,s=0;X[i.p.id].styleUI=i.p.styleUI||"jQueryUI",F.recreateForm||Q(i).data("viewProp")&&Q.extend(X[Q(this)[0].p.id],Q(i).data("viewProp"));var c=isNaN(X[Q(this)[0].p.id].dataheight)?X[Q(this)[0].p.id].dataheight:X[Q(this)[0].p.id].dataheight+"px",p=isNaN(X[Q(this)[0].p.id].datawidth)?X[Q(this)[0].p.id].datawidth:X[Q(this)[0].p.id].datawidth+"px",u=Q("<form name='FormPost' id='"+a+"' class='FormGrid' style='width:"+p+";height:"+c+";'></form>"),h=Q("<table id='"+d+"' class='EditTable ViewTable'><tbody></tbody></table>");if(Q(i.p.colModel).each(function(){var e=this.formoptions;l=Math.max(l,e&&e.colpos||0),s=Math.max(s,e&&e.rowpos||0)}),Q(u).append(h),void 0===(o=Q(i).triggerHandler("jqGridViewRowBeforeInitData",[u]))&&(o=!0),o&&Q.isFunction(X[i.p.id].beforeInitData)&&(o=X[i.p.id].beforeInitData.call(i,u)),!1!==o){!function(e,r,o,n){var l,s,c,p,u,h,t,f,m,g,v=0,b=[],i="<td class='CaptionTD form-view-label "+S.content+"' width='"+F.labelswidth+"'></td><td class='DataTD form-view-data ui-helper-reset "+S.content+"'></td>",j="",a="<td class='CaptionTD form-view-label "+S.content+"'></td><td class='DataTD form-view-data "+S.content+"'></td>",d=["integer","number","currency"],w=0,D=0;for(t=1;t<=n;t++)j+=1===t?i:a;if(Q(r.p.colModel).each(function(){(s=(!this.editrules||!0!==this.editrules.edithidden)&&!0===this.hidden)||"right"!==this.align||(this.formatter&&-1!==Q.inArray(this.formatter,d)?w=Math.max(w,parseInt(this.width,10)):D=Math.max(D,parseInt(this.width,10)))}),f=0!==w?w:0!==D?D:0,h=Q(r).jqGrid("getInd",e),Q(r.p.colModel).each(function(e){if(l=this.name,m=!1,s=(!this.editrules||!0!==this.editrules.edithidden)&&!0===this.hidden,u=s?"style='display:none'":"",g="boolean"!=typeof this.viewable||this.viewable,"cb"!==l&&"subgrid"!==l&&"rn"!==l&&g){p=!1===h?"":l===r.p.ExpandColumn&&!0===r.p.treeGrid?Q("td:eq("+e+")",r.rows[h]).text():Q("td:eq("+e+")",r.rows[h]).html(),m="right"===this.align&&0!==f;var t=Q.extend({},{rowabove:!1,rowcontent:""},this.formoptions||{}),i=parseInt(t.rowpos,10)||v+1,a=parseInt(2*(parseInt(t.colpos,10)||1),10);if(t.rowabove){var d=Q("<tr><td class='contentinfo' colspan='"+2*n+"'>"+t.rowcontent+"</td></tr>");Q(o).append(d),d[0].rp=i}0===(c=Q(o).find("tr[rowpos="+i+"]")).length&&(c=Q("<tr "+u+" rowpos='"+i+"'></tr>").addClass("FormData").attr("id","trv_"+l),Q(c).append(j),Q(o).append(c),c[0].rp=i),Q("td:eq("+(a-2)+")",c[0]).html("<b>"+(void 0===t.label?r.p.colNames[e]:t.label)+"</b>"),Q("td:eq("+(a-1)+")",c[0]).append("<span>"+p+"</span>").attr("id","v_"+l),m&&Q("td:eq("+(a-1)+") span",c[0]).css({"text-align":"right",width:f+"px"}),b[v]=e,v++}}),0<v){var q=Q("<tr class='FormData' style='display:none'><td class='CaptionTD'></td><td colspan='"+(2*n-1)+"' class='DataTD'><input class='FormElement' id='id_g' type='text' name='id' value='"+e+"'/></td></tr>");q[0].rp=v+99,Q(o).append(q)}}(C,i,h,l);var f="rtl"===i.p.direction,m=f?"pData":"nData",g="<a id='"+(f?"nData":"pData")+"' class='fm-button "+S.button+"'><span class='"+S.icon_base+" "+G.icon_prev+"'></span></a>",v="<a id='"+m+"' class='fm-button "+S.button+"'><span class='"+S.icon_base+" "+G.icon_next+"'></span></a>",b="<a id='cData' class='fm-button "+S.button+"'>"+F.bClose+"</a>",j=Q.isArray(X[i.p.id].buttons)?Q.jgrid.buildButtons(X[i.p.id].buttons,b,S):b;if(0<s){var w=[];Q.each(Q(h)[0].rows,function(e,t){w[e]=t}),w.sort(function(e,t){return e.rp>t.rp?1:e.rp<t.rp?-1:0}),Q.each(w,function(e,t){Q("tbody",h).append(t)})}F.gbox="#gbox_"+Q.jgrid.jqID(e);var D=Q("<div></div>").append(u).append("<table border='0' class='EditTable' id='"+n+"_2'><tbody><tr id='Act_Buttons'><td class='navButton' width='"+F.labelswidth+"'>"+(f?v+g:g+v)+"</td><td class='EditButton'>"+j+"</td></tr></tbody></table>"),q=Q(".ui-jqgrid").css("font-size")||"11px";Q.jgrid.createModal(r,D,X[Q(this)[0].p.id],"#gview_"+Q.jgrid.jqID(i.p.id),Q("#gview_"+Q.jgrid.jqID(i.p.id))[0],null,{"font-size":q}),f&&(Q("#pData, #nData","#"+n+"_2").css("float","right"),Q(".EditButton","#"+n+"_2").css("text-align","left")),F.viewPagerButtons||Q("#pData, #nData","#"+n+"_2").hide(),D=null,Q("#"+r.themodal).keydown(function(e){if(27===e.which)return X[i.p.id].closeOnEscape&&Q.jgrid.hideModal("#"+Q.jgrid.jqID(r.themodal),{gb:F.gbox,jqm:F.jqModal,onClose:F.onClose,removemodal:X[i.p.id].removemodal,formprop:!X[i.p.id].recreateForm,form:X[i.p.id].form}),!1;if(!0===F.navkeys[0]){if(e.which===F.navkeys[1])return Q("#pData","#"+n+"_2").trigger("click"),!1;if(e.which===F.navkeys[2])return Q("#nData","#"+n+"_2").trigger("click"),!1}}),F.closeicon=Q.extend([!0,"left",G.icon_close],F.closeicon),!0===F.closeicon[0]&&Q("#cData","#"+n+"_2").addClass("right"===F.closeicon[1]?"fm-button-icon-right":"fm-button-icon-left").append("<span class='"+S.icon_base+" "+F.closeicon[2]+"'></span>"),Q(i).triggerHandler("jqGridViewRowBeforeShowForm",[Q("#"+t)]),Q.isFunction(F.beforeShowForm)&&F.beforeShowForm.call(i,Q("#"+t)),Q.jgrid.viewModal("#"+Q.jgrid.jqID(r.themodal),{gbox:"#gbox_"+Q.jgrid.jqID(e),jqm:F.jqModal,overlay:F.overlay,modal:F.modal,onHide:function(e){Q(i).data("viewProp",{top:parseFloat(Q(e.w).css("top")),left:parseFloat(Q(e.w).css("left")),width:Q(e.w).width(),height:Q(e.w).height(),dataheight:Q("#"+t).height(),datawidth:Q("#"+t).width()}),e.w.remove(),e.o&&e.o.remove()}}),Q(".fm-button:not(."+S.disabled+")","#"+n+"_2").hover(function(){Q(this).addClass(S.hover)},function(){Q(this).removeClass(S.hover)}),x(),Q("#cData","#"+n+"_2").click(function(){return Q.jgrid.hideModal("#"+Q.jgrid.jqID(r.themodal),{gb:"#gbox_"+Q.jgrid.jqID(e),jqm:F.jqModal,onClose:F.onClose,removemodal:X[i.p.id].removemodal,formprop:!X[i.p.id].recreateForm,form:X[i.p.id].form}),!1}),Q("#"+n+"_2").find("[data-index]").each(function(){var t=parseInt(Q(this).attr("data-index"),10);0<=t&&F.buttons[t].hasOwnProperty("click")&&Q(this).on("click",function(e){F.buttons[t].click.call(i,Q("#"+a)[0],X[i.p.id],e)})}),Q("#nData","#"+n+"_2").click(function(){Q("#FormError","#"+n).hide();var e=k();return e[0]=parseInt(e[0],10),-1!==e[0]&&e[1][e[0]+1]&&(Q(i).triggerHandler("jqGridViewRowClickPgButtons",["next",Q("#"+t),e[1][e[0]]]),Q.isFunction(F.onclickPgButtons)&&F.onclickPgButtons.call(i,"next",Q("#"+t),e[1][e[0]]),_(e[1][e[0]+1],i),Q(i).jqGrid("setSelection",e[1][e[0]+1]),Q(i).triggerHandler("jqGridViewRowAfterClickPgButtons",["next",Q("#"+t),e[1][e[0]+1]]),Q.isFunction(F.afterclickPgButtons)&&F.afterclickPgButtons.call(i,"next",Q("#"+t),e[1][e[0]+1]),I(e[0]+1,e)),x(),!1}),Q("#pData","#"+n+"_2").click(function(){Q("#FormError","#"+n).hide();var e=k();return-1!==e[0]&&e[1][e[0]-1]&&(Q(i).triggerHandler("jqGridViewRowClickPgButtons",["prev",Q("#"+t),e[1][e[0]]]),Q.isFunction(F.onclickPgButtons)&&F.onclickPgButtons.call(i,"prev",Q("#"+t),e[1][e[0]]),_(e[1][e[0]-1],i),Q(i).jqGrid("setSelection",e[1][e[0]-1]),Q(i).triggerHandler("jqGridViewRowAfterClickPgButtons",["prev",Q("#"+t),e[1][e[0]-1]]),Q.isFunction(F.afterclickPgButtons)&&F.afterclickPgButtons.call(i,"prev",Q("#"+t),e[1][e[0]-1]),I(e[0]-1,e)),x(),!1});var y=k();I(y[0],y)}}function x(){!0!==X[i.p.id].closeOnEscape&&!0!==X[i.p.id].navkeys[0]||setTimeout(function(){Q(".ui-jqdialog-titlebar-close","#"+Q.jgrid.jqID(r.modalhead)).attr("tabindex","-1").focus()},0)}function _(e,t){var i,a,d,r,o=0;(r=Q(t).jqGrid("getInd",e,!0))&&(Q("td",r).each(function(e){i=t.p.colModel[e].name,a=(!t.p.colModel[e].editrules||!0!==t.p.colModel[e].editrules.edithidden)&&!0===t.p.colModel[e].hidden,"cb"!==i&&"subgrid"!==i&&"rn"!==i&&(d=i===t.p.ExpandColumn&&!0===t.p.treeGrid?Q(this).text():Q(this).html(),i=Q.jgrid.jqID("v_"+i),Q("#"+i+" span","#"+n).html(d),a&&Q("#"+i,"#"+n).parents("tr:first").hide(),o++)}),0<o&&Q("#id_g","#"+n).val(e))}function I(e,t){var i=t[1].length-1;0===e?Q("#pData","#"+n+"_2").addClass(S.disabled):void 0!==t[1][e-1]&&Q("#"+Q.jgrid.jqID(t[1][e-1])).hasClass(S.disabled)?Q("#pData",n+"_2").addClass(S.disabled):Q("#pData","#"+n+"_2").removeClass(S.disabled),e===i?Q("#nData","#"+n+"_2").addClass(S.disabled):void 0!==t[1][e+1]&&Q("#"+Q.jgrid.jqID(t[1][e+1])).hasClass(S.disabled)?Q("#nData",n+"_2").addClass(S.disabled):Q("#nData","#"+n+"_2").removeClass(S.disabled)}function k(){var e=Q(i).jqGrid("getDataIDs"),t=Q("#id_g","#"+n).val();return[Q.inArray(t,e),e]}})},delGridRow:function(b,j){var e=Q.jgrid.getRegional(this[0],"del"),t=this[0].p.styleUI,w=Q.jgrid.styleUI[t].formedit,D=Q.jgrid.styleUI[t].common;return j=Q.extend(!0,{top:0,left:0,width:240,height:"auto",dataheight:"auto",modal:!1,overlay:30,drag:!0,resize:!0,url:"",mtype:"POST",reloadAfterSubmit:!0,beforeShowForm:null,beforeInitData:null,afterShowForm:null,beforeSubmit:null,onclickSubmit:null,afterSubmit:null,jqModal:!0,closeOnEscape:!1,delData:{},delicon:[],cancelicon:[],onClose:null,ajaxDelOptions:{},processing:!1,serializeDelData:null,useDataProxy:!1},e,j||{}),X[Q(this)[0].p.id]=j,this.each(function(){var o=this;if(o.grid&&b){var n,a,l,s,c=o.p.id,p={},e=!0,u="DelTbl_"+Q.jgrid.jqID(c),i="DelTbl_"+c,h={themodal:"delmod"+c,modalhead:"delhd"+c,modalcontent:"delcnt"+c,scrollelm:u};if(X[o.p.id].styleUI=o.p.styleUI||"jQueryUI",Q.isArray(b)&&(b=b.join()),void 0!==Q("#"+Q.jgrid.jqID(h.themodal))[0]){if(void 0===(e=Q(o).triggerHandler("jqGridDelRowBeforeInitData",[Q("#"+u)]))&&(e=!0),e&&Q.isFunction(X[o.p.id].beforeInitData)&&(e=X[o.p.id].beforeInitData.call(o,Q("#"+u))),!1===e)return;Q("#DelData>td","#"+u).text(b),Q("#DelError","#"+u).hide(),!0===X[o.p.id].processing&&(X[o.p.id].processing=!1,Q("#dData","#"+u).removeClass(D.active)),Q(o).triggerHandler("jqGridDelRowBeforeShowForm",[Q("#"+u)]),Q.isFunction(X[o.p.id].beforeShowForm)&&X[o.p.id].beforeShowForm.call(o,Q("#"+u)),Q.jgrid.viewModal("#"+Q.jgrid.jqID(h.themodal),{gbox:"#gbox_"+Q.jgrid.jqID(c),jqm:X[o.p.id].jqModal,overlay:X[o.p.id].overlay,modal:X[o.p.id].modal}),Q(o).triggerHandler("jqGridDelRowAfterShowForm",[Q("#"+u)]),Q.isFunction(X[o.p.id].afterShowForm)&&X[o.p.id].afterShowForm.call(o,Q("#"+u))}else{var t=isNaN(X[o.p.id].dataheight)?X[o.p.id].dataheight:X[o.p.id].dataheight+"px",d=isNaN(j.datawidth)?j.datawidth:j.datawidth+"px",r="<div id='"+i+"' class='formdata' style='width:"+d+";overflow:auto;position:relative;height:"+t+";'>";r+="<table class='DelTable'><tbody>",r+="<tr id='DelError' style='display:none'><td class='"+D.error+"'></td></tr>",r+="<tr id='DelData' style='display:none'><td >"+b+"</td></tr>",r+='<tr><td class="delmsg" style="white-space:pre;">'+X[o.p.id].msg+"</td></tr><tr><td >&#160;</td></tr>",r+="</tbody></table></div>";var f="<a id='dData' class='fm-button "+D.button+"'>"+j.bSubmit+"</a>",m="<a id='eData' class='fm-button "+D.button+"'>"+j.bCancel+"</a>",g=Q.isArray(X[o.p.id].buttons)?Q.jgrid.buildButtons(X[o.p.id].buttons,f+m,D):f+m,v=Q(".ui-jqgrid").css("font-size")||"11px";if(r+="<table class='EditTable ui-common-table' id='"+u+"_2'><tbody><tr><td><hr class='"+D.content+"' style='margin:1px'/></td></tr><tr><td class='DelButton EditButton'>"+g+"</td></tr></tbody></table>",j.gbox="#gbox_"+Q.jgrid.jqID(c),Q.jgrid.createModal(h,r,X[o.p.id],"#gview_"+Q.jgrid.jqID(o.p.id),Q("#gview_"+Q.jgrid.jqID(o.p.id))[0],null,{"font-size":v}),Q(".fm-button","#"+u+"_2").hover(function(){Q(this).addClass(D.hover)},function(){Q(this).removeClass(D.hover)}),j.delicon=Q.extend([!0,"left",w.icon_del],X[o.p.id].delicon),j.cancelicon=Q.extend([!0,"left",w.icon_cancel],X[o.p.id].cancelicon),!0===j.delicon[0]&&Q("#dData","#"+u+"_2").addClass("right"===j.delicon[1]?"fm-button-icon-right":"fm-button-icon-left").append("<span class='"+D.icon_base+" "+j.delicon[2]+"'></span>"),!0===j.cancelicon[0]&&Q("#eData","#"+u+"_2").addClass("right"===j.cancelicon[1]?"fm-button-icon-right":"fm-button-icon-left").append("<span class='"+D.icon_base+" "+j.cancelicon[2]+"'></span>"),Q("#dData","#"+u+"_2").click(function(){var e,d=[!0,""],r=Q("#DelData>td","#"+u).text();if(p={},void 0===(p=Q(o).triggerHandler("jqGridDelRowClickSubmit",[X[o.p.id],r]))&&Q.isFunction(X[o.p.id].onclickSubmit)&&(p=X[o.p.id].onclickSubmit.call(o,X[o.p.id],r)||{}),void 0===(d=Q(o).triggerHandler("jqGridDelRowBeforeSubmit",[r]))&&(d=[!0,"",""]),d[0]&&Q.isFunction(X[o.p.id].beforeSubmit)&&(d=X[o.p.id].beforeSubmit.call(o,r)),d[0]&&!X[o.p.id].processing){if(X[o.p.id].processing=!0,l=o.p.prmNames,n=Q.extend({},X[o.p.id].delData,p),s=l.oper,n[s]=l.deloper,a=l.id,!(r=String(r).split(",")).length)return!1;for(e in r)r.hasOwnProperty(e)&&(r[e]=Q.jgrid.stripPref(o.p.idPrefix,r[e]));n[a]=r.join(),Q(this).addClass(D.active);var t=Q.extend({url:X[o.p.id].url||Q(o).jqGrid("getGridParam","editurl"),type:X[o.p.id].mtype,data:Q.isFunction(X[o.p.id].serializeDelData)?X[o.p.id].serializeDelData.call(o,n):n,complete:function(e,t){var i;if(Q("#dData","#"+u+"_2").removeClass(D.active),300<=e.status&&304!==e.status?(d[0]=!1,d[1]=Q(o).triggerHandler("jqGridDelRowErrorTextFormat",[e]),Q.isFunction(X[o.p.id].errorTextFormat)&&(d[1]=X[o.p.id].errorTextFormat.call(o,e)),void 0===d[1]&&(d[1]=t+" Status: '"+e.statusText+"'. Error code: "+e.status)):(void 0===(d=Q(o).triggerHandler("jqGridDelRowAfterSubmit",[e,n]))&&(d=[!0,"",""]),d[0]&&Q.isFunction(X[o.p.id].afterSubmit)&&(d=X[o.p.id].afterSubmit.call(o,e,n))),!1===d[0])Q("#DelError>td","#"+u).html(d[1]),Q("#DelError","#"+u).show();else{if(X[o.p.id].reloadAfterSubmit&&"local"!==o.p.datatype)Q(o).trigger("reloadGrid");else{if(!0===o.p.treeGrid)try{Q(o).jqGrid("delTreeNode",o.p.idPrefix+r[0])}catch(e){}else for(i=0;i<r.length;i++)Q(o).jqGrid("delRowData",o.p.idPrefix+r[i]);o.p.selrow=null,o.p.selarrrow=[]}if(Q.isFunction(X[o.p.id].afterComplete)||Q._data(Q(o)[0],"events").hasOwnProperty("jqGridDelRowAfterComplete")){var a=e;setTimeout(function(){Q(o).triggerHandler("jqGridDelRowAfterComplete",[a,n]);try{X[o.p.id].afterComplete.call(o,a,n)}catch(e){}},500)}}X[o.p.id].processing=!1,d[0]&&Q.jgrid.hideModal("#"+Q.jgrid.jqID(h.themodal),{gb:"#gbox_"+Q.jgrid.jqID(c),jqm:j.jqModal,onClose:X[o.p.id].onClose})}},Q.jgrid.ajaxOptions,X[o.p.id].ajaxDelOptions);if(t.url||X[o.p.id].useDataProxy||(Q.isFunction(o.p.dataProxy)?X[o.p.id].useDataProxy=!0:(d[0]=!1,d[1]+=" "+Q.jgrid.getRegional(o,"errors.nourl"))),d[0])if(X[o.p.id].useDataProxy){var i=o.p.dataProxy.call(o,t,"del_"+o.p.id);void 0===i&&(i=[!0,""]),!1===i[0]?(d[0]=!1,d[1]=i[1]||"Error deleting the selected row!"):Q.jgrid.hideModal("#"+Q.jgrid.jqID(h.themodal),{gb:"#gbox_"+Q.jgrid.jqID(c),jqm:j.jqModal,onClose:X[o.p.id].onClose})}else"clientArray"===t.url?(n=t.data,t.complete({status:200,statusText:""},"")):Q.ajax(t)}return!1===d[0]&&(Q("#DelError>td","#"+u).html(d[1]),Q("#DelError","#"+u).show()),!1}),Q("#eData","#"+u+"_2").click(function(){return Q.jgrid.hideModal("#"+Q.jgrid.jqID(h.themodal),{gb:"#gbox_"+Q.jgrid.jqID(c),jqm:X[o.p.id].jqModal,onClose:X[o.p.id].onClose}),!1}),Q("#"+u+"_2").find("[data-index]").each(function(){var t=parseInt(Q(this).attr("data-index"),10);0<=t&&j.buttons[t].hasOwnProperty("click")&&Q(this).on("click",function(e){j.buttons[t].click.call(o,Q("#"+i)[0],X[o.p.id],e)})}),void 0===(e=Q(o).triggerHandler("jqGridDelRowBeforeInitData",[Q("#"+u)]))&&(e=!0),e&&Q.isFunction(X[o.p.id].beforeInitData)&&(e=X[o.p.id].beforeInitData.call(o,Q("#"+u))),!1===e)return;Q(o).triggerHandler("jqGridDelRowBeforeShowForm",[Q("#"+u)]),Q.isFunction(X[o.p.id].beforeShowForm)&&X[o.p.id].beforeShowForm.call(o,Q("#"+u)),Q.jgrid.viewModal("#"+Q.jgrid.jqID(h.themodal),{gbox:"#gbox_"+Q.jgrid.jqID(c),jqm:X[o.p.id].jqModal,overlay:X[o.p.id].overlay,modal:X[o.p.id].modal}),Q(o).triggerHandler("jqGridDelRowAfterShowForm",[Q("#"+u)]),Q.isFunction(X[o.p.id].afterShowForm)&&X[o.p.id].afterShowForm.call(o,Q("#"+u))}!0===X[o.p.id].closeOnEscape&&setTimeout(function(){Q(".ui-jqdialog-titlebar-close","#"+Q.jgrid.jqID(h.modalhead)).attr("tabindex","-1").focus()},0)}})},navGrid:function(m,g,v,b,j,w,D){var q=Q.jgrid.getRegional(this[0],"nav"),y=this[0].p.styleUI,e=Q.jgrid.styleUI[y].navigator,x=Q.jgrid.styleUI[y].common;return g=Q.extend({edit:!0,editicon:e.icon_edit_nav,add:!0,addicon:e.icon_add_nav,del:!0,delicon:e.icon_del_nav,search:!0,searchicon:e.icon_search_nav,refresh:!0,refreshicon:e.icon_refresh_nav,refreshstate:"firstpage",view:!1,viewicon:e.icon_view_nav,position:"left",closeOnEscape:!0,beforeRefresh:null,afterRefresh:null,cloneToTop:!1,alertwidth:200,alertheight:"auto",alerttop:null,alertleft:null,alertzIndex:null,dropmenu:!1,navButtonText:""},q,g||{}),this.each(function(){if(!this.p.navGrid){var e,t,i,a={themodal:"alertmod_"+this.p.id,modalhead:"alerthd_"+this.p.id,modalcontent:"alertcnt_"+this.p.id},d=this;if(d.grid&&"string"==typeof m){if(Q(d).data("navGrid")||Q(d).data("navGrid",g),i=Q(d).data("navGrid"),d.p.force_regional&&(i=Q.extend(i,q)),void 0===Q("#"+a.themodal)[0]){i.alerttop||i.alertleft||(void 0!==window.innerWidth?(i.alertleft=window.innerWidth,i.alerttop=window.innerHeight):void 0!==document.documentElement&&void 0!==document.documentElement.clientWidth&&0!==document.documentElement.clientWidth?(i.alertleft=document.documentElement.clientWidth,i.alerttop=document.documentElement.clientHeight):(i.alertleft=1024,i.alerttop=768),i.alertleft=i.alertleft/2-parseInt(i.alertwidth,10)/2,i.alerttop=i.alerttop/2-25);var r=Q(".ui-jqgrid").css("font-size")||"11px";Q.jgrid.createModal(a,"<div>"+i.alerttext+"</div><span tabindex='0'><span tabindex='-1' id='jqg_alrt'></span></span>",{gbox:"#gbox_"+Q.jgrid.jqID(d.p.id),jqModal:!0,drag:!0,resize:!0,caption:i.alertcap,top:i.alerttop,left:i.alertleft,width:i.alertwidth,height:i.alertheight,closeOnEscape:i.closeOnEscape,zIndex:i.alertzIndex,styleUI:d.p.styleUI},"#gview_"+Q.jgrid.jqID(d.p.id),Q("#gbox_"+Q.jgrid.jqID(d.p.id))[0],!0,{"font-size":r})}var o,n=1,l=function(){Q(this).hasClass(x.disabled)||Q(this).addClass(x.hover)},s=function(){Q(this).removeClass(x.hover)};for(i.cloneToTop&&d.p.toppager&&(n=2),o=0;o<n;o++){var c,p,u,h=Q("<table class='ui-pg-table navtable ui-common-table'><tbody><tr></tr></tbody></table>"),f="<td class='ui-pg-button "+x.disabled+"' style='width:4px;'><span class='ui-separator'></span></td>";0===o?(p=m,u=d.p.id,p===d.p.toppager&&(u+="_top",n=1)):(p=d.p.toppager,u=d.p.id+"_top"),"rtl"===d.p.direction&&Q(h).attr("dir","rtl").css("float","right"),b=b||{},i.add&&(c=Q("<td class='ui-pg-button "+x.cornerall+"'></td>"),Q(c).append("<div class='ui-pg-div'><span class='"+x.icon_base+" "+i.addicon+"'></span>"+i.addtext+"</div>"),Q("tr",h).append(c),Q(c,h).attr({title:i.addtitle||"",id:b.id||"add_"+u}).click(function(){return Q(this).hasClass(x.disabled)||(Q.jgrid.setSelNavIndex(d,this),Q.isFunction(i.addfunc)?i.addfunc.call(d):Q(d).jqGrid("editGridRow","new",b)),!1}).hover(l,s),c=null),v=v||{},i.edit&&(c=Q("<td class='ui-pg-button "+x.cornerall+"'></td>"),Q(c).append("<div class='ui-pg-div'><span class='"+x.icon_base+" "+i.editicon+"'></span>"+i.edittext+"</div>"),Q("tr",h).append(c),Q(c,h).attr({title:i.edittitle||"",id:v.id||"edit_"+u}).click(function(){if(!Q(this).hasClass(x.disabled)){var e=d.p.selrow;e?(Q.jgrid.setSelNavIndex(d,this),Q.isFunction(i.editfunc)?i.editfunc.call(d,e):Q(d).jqGrid("editGridRow",e,v)):(Q.jgrid.viewModal("#"+a.themodal,{gbox:"#gbox_"+Q.jgrid.jqID(d.p.id),jqm:!0}),Q("#jqg_alrt").focus())}return!1}).hover(l,s),c=null),D=D||{},i.view&&(c=Q("<td class='ui-pg-button "+x.cornerall+"'></td>"),Q(c).append("<div class='ui-pg-div'><span class='"+x.icon_base+" "+i.viewicon+"'></span>"+i.viewtext+"</div>"),Q("tr",h).append(c),Q(c,h).attr({title:i.viewtitle||"",id:D.id||"view_"+u}).click(function(){if(!Q(this).hasClass(x.disabled)){var e=d.p.selrow;e?(Q.jgrid.setSelNavIndex(d,this),Q.isFunction(i.viewfunc)?i.viewfunc.call(d,e):Q(d).jqGrid("viewGridRow",e,D)):(Q.jgrid.viewModal("#"+a.themodal,{gbox:"#gbox_"+Q.jgrid.jqID(d.p.id),jqm:!0}),Q("#jqg_alrt").focus())}return!1}).hover(l,s),c=null),j=j||{},i.del&&(c=Q("<td class='ui-pg-button "+x.cornerall+"'></td>"),Q(c).append("<div class='ui-pg-div'><span class='"+x.icon_base+" "+i.delicon+"'></span>"+i.deltext+"</div>"),Q("tr",h).append(c),Q(c,h).attr({title:i.deltitle||"",id:j.id||"del_"+u}).click(function(){var e;Q(this).hasClass(x.disabled)||(d.p.multiselect?0===(e=d.p.selarrrow).length&&(e=null):e=d.p.selrow,e?(Q.jgrid.setSelNavIndex(d,this),Q.isFunction(i.delfunc)?i.delfunc.call(d,e):Q(d).jqGrid("delGridRow",e,j)):(Q.jgrid.viewModal("#"+a.themodal,{gbox:"#gbox_"+Q.jgrid.jqID(d.p.id),jqm:!0}),Q("#jqg_alrt").focus()));return!1}).hover(l,s),c=null),(i.add||i.edit||i.del||i.view)&&Q("tr",h).append(f),w=w||{},i.search&&(c=Q("<td class='ui-pg-button "+x.cornerall+"'></td>"),Q(c).append("<div class='ui-pg-div'><span class='"+x.icon_base+" "+i.searchicon+"'></span>"+i.searchtext+"</div>"),Q("tr",h).append(c),Q(c,h).attr({title:i.searchtitle||"",id:w.id||"search_"+u}).click(function(){return Q(this).hasClass(x.disabled)||(Q.jgrid.setSelNavIndex(d,this),Q.isFunction(i.searchfunc)?i.searchfunc.call(d,w):Q(d).jqGrid("searchGrid",w)),!1}).hover(l,s),w.showOnLoad&&!0===w.showOnLoad&&Q(c,h).click(),c=null),i.refresh&&(c=Q("<td class='ui-pg-button "+x.cornerall+"'></td>"),Q(c).append("<div class='ui-pg-div'><span class='"+x.icon_base+" "+i.refreshicon+"'></span>"+i.refreshtext+"</div>"),Q("tr",h).append(c),Q(c,h).attr({title:i.refreshtitle||"",id:"refresh_"+u}).click(function(){if(!Q(this).hasClass(x.disabled)){Q.isFunction(i.beforeRefresh)&&i.beforeRefresh.call(d),d.p.search=!1,d.p.resetsearch=!0;try{if("currentfilter"!==i.refreshstate){var e=d.p.id;d.p.postData.filters="";try{Q("#fbox_"+Q.jgrid.jqID(e)).jqFilter("resetFilter")}catch(e){}Q.isFunction(d.clearToolbar)&&d.clearToolbar.call(d,!1)}}catch(e){}switch(i.refreshstate){case"firstpage":Q(d).trigger("reloadGrid",[{page:1}]);break;case"current":case"currentfilter":Q(d).trigger("reloadGrid",[{current:!0}])}Q.isFunction(i.afterRefresh)&&i.afterRefresh.call(d),Q.jgrid.setSelNavIndex(d,this)}return!1}).hover(l,s),c=null),t=Q(".ui-jqgrid").css("font-size")||"11px",Q("body").append("<div id='testpg2' class='ui-jqgrid "+Q.jgrid.styleUI[y].base.entrieBox+"' style='font-size:"+t+";visibility:hidden;' ></div>"),e=Q(h).clone().appendTo("#testpg2").width(),Q("#testpg2").remove(),d.p._nvtd&&(i.dropmenu?(h=null,Q(d).jqGrid("_buildNavMenu",p,u,g,v,b,j,w,D)):e>d.p._nvtd[0]?(d.p.responsive?(h=null,Q(d).jqGrid("_buildNavMenu",p,u,g,v,b,j,w,D)):Q(p+"_"+i.position,p).append(h).width(e),d.p._nvtd[0]=e):Q(p+"_"+i.position,p).append(h),d.p._nvtd[1]=e),d.p.navGrid=!0}d.p.storeNavOptions&&(d.p.navOptions=i,d.p.editOptions=v,d.p.addOptions=b,d.p.delOptions=j,d.p.searchOptions=w,d.p.viewOptions=D,d.p.navButtons=[])}}})},navButtonAdd:function(c,p){var u=this[0].p.styleUI,e=Q.jgrid.styleUI[u].navigator;return p=Q.extend({caption:"newButton",title:"",buttonicon:e.icon_newbutton_nav,onClickButton:null,position:"last",cursor:"pointer",internal:!1},p||{}),this.each(function(){if(this.grid){"string"==typeof c&&0!==c.indexOf("#")&&(c="#"+Q.jgrid.jqID(c));var e=Q(".navtable",c)[0],t=this,i=Q.jgrid.styleUI[u].common.disabled,a=Q.jgrid.styleUI[u].common.hover,d=Q.jgrid.styleUI[u].common.cornerall,r=Q.jgrid.styleUI[u].common.icon_base;if(t.p.storeNavOptions&&!p.internal&&t.p.navButtons.push([c,p]),e){if(p.id&&void 0!==Q("#"+Q.jgrid.jqID(p.id),e)[0])return;var o=Q("<td></td>");"NONE"===p.buttonicon.toString().toUpperCase()?Q(o).addClass("ui-pg-button "+d).append("<div class='ui-pg-div'>"+p.caption+"</div>"):Q(o).addClass("ui-pg-button "+d).append("<div class='ui-pg-div'><span class='"+r+" "+p.buttonicon+"'></span>"+p.caption+"</div>"),p.id&&Q(o).attr("id",p.id),"first"===p.position?0===e.rows[0].cells.length?Q("tr",e).append(o):Q("tr td:eq(0)",e).before(o):Q("tr",e).append(o),Q(o,e).attr("title",p.title||"").click(function(e){return Q(this).hasClass(i)||(Q.jgrid.setSelNavIndex(t,this),Q.isFunction(p.onClickButton)&&p.onClickButton.call(t,e)),!1}).hover(function(){Q(this).hasClass(i)||Q(this).addClass(a)},function(){Q(this).removeClass(a)})}else if(e=Q(".dropdownmenu",c)[0]){var n=Q(e).val(),l=p.id||Q.jgrid.randId(),s=Q('<li class="ui-menu-item" role="presentation"><a class="'+d+' g-menu-item" tabindex="0" role="menuitem" id="'+l+'">'+(p.caption||p.title)+"</a></li>");n&&("first"===p.position?Q("#"+n).prepend(s):Q("#"+n).append(s),Q(s).on("click",function(e){return Q(this).hasClass(i)||(Q("#"+n).hide(),Q.isFunction(p.onClickButton)&&p.onClickButton.call(t,e)),!1}).find("a").hover(function(){Q(this).hasClass(i)||Q(this).addClass(a)},function(){Q(this).removeClass(a)}))}}})},navSeparatorAdd:function(a,d){var e=this[0].p.styleUI,r=Q.jgrid.styleUI[e].common;return d=Q.extend({sepclass:"ui-separator",sepcontent:"",position:"last"},d||{}),this.each(function(){if(this.grid){"string"==typeof a&&0!==a.indexOf("#")&&(a="#"+Q.jgrid.jqID(a));var e,t,i=Q(".navtable",a)[0];this.p.storeNavOptions&&this.p.navButtons.push([a,d]),i?(e="<td class='ui-pg-button "+r.disabled+"' style='width:4px;'><span class='"+d.sepclass+"'></span>"+d.sepcontent+"</td>","first"===d.position?0===i.rows[0].cells.length?Q("tr",i).append(e):Q("tr td:eq(0)",i).before(e):Q("tr",i).append(e)):(i=Q(".dropdownmenu",a)[0],e="<li class='ui-menu-item "+r.disabled+"' style='width:100%' role='presentation'><hr class='ui-separator-li'></li>",i&&(t=Q(i).val())&&("first"===d.position?Q("#"+t).prepend(e):Q("#"+t).append(e)))}})},_buildNavMenu:function(h,f,m,g,v,b,j,w){return this.each(function(){var t=this,e=Q.jgrid.getRegional(t,"nav"),i=t.p.styleUI,a=(Q.jgrid.styleUI[i].navigator,Q.jgrid.styleUI[i].filter),d=Q.jgrid.styleUI[i].common,r="form_menu_"+Q.jgrid.randId(),o=m.navButtonText?m.navButtonText:e.selectcaption||"Actions",n="<button class='dropdownmenu "+d.button+"' value='"+r+"'>"+o+"</button>";Q(h+"_"+m.position,h).append(n);var l,s,c,p,u="alertmod_"+this.p.id;this.p.id,this.p.id;c=Q(".ui-jqgrid").css("font-size")||"11px",p=Q('<ul id="'+r+'" class="ui-nav-menu modal-content" role="menu" tabindex="0" style="display:none;font-size:'+c+'"></ul>'),m.add&&(l=(v=v||{}).id||"add_"+f,s=Q('<li class="ui-menu-item" role="presentation"><a class="'+d.cornerall+' g-menu-item" tabindex="0" role="menuitem" id="'+l+'">'+(m.addtext||m.addtitle)+"</a></li>").click(function(){return Q(this).hasClass(d.disabled)||(Q.isFunction(m.addfunc)?m.addfunc.call(t):Q(t).jqGrid("editGridRow","new",v),Q(p).hide()),!1}),Q(p).append(s)),m.edit&&(l=(g=g||{}).id||"edit_"+f,s=Q('<li class="ui-menu-item" role="presentation"><a class="'+d.cornerall+' g-menu-item" tabindex="0" role="menuitem" id="'+l+'">'+(m.edittext||m.edittitle)+"</a></li>").click(function(){if(!Q(this).hasClass(d.disabled)){var e=t.p.selrow;e?Q.isFunction(m.editfunc)?m.editfunc.call(t,e):Q(t).jqGrid("editGridRow",e,g):(Q.jgrid.viewModal("#"+u,{gbox:"#gbox_"+Q.jgrid.jqID(t.p.id),jqm:!0}),Q("#jqg_alrt").focus()),Q(p).hide()}return!1}),Q(p).append(s)),m.view&&(l=(w=w||{}).id||"view_"+f,s=Q('<li class="ui-menu-item" role="presentation"><a class="'+d.cornerall+' g-menu-item" tabindex="0" role="menuitem" id="'+l+'">'+(m.viewtext||m.viewtitle)+"</a></li>").click(function(){if(!Q(this).hasClass(d.disabled)){var e=t.p.selrow;e?Q.isFunction(m.editfunc)?m.viewfunc.call(t,e):Q(t).jqGrid("viewGridRow",e,w):(Q.jgrid.viewModal("#"+u,{gbox:"#gbox_"+Q.jgrid.jqID(t.p.id),jqm:!0}),Q("#jqg_alrt").focus()),Q(p).hide()}return!1}),Q(p).append(s)),m.del&&(l=(b=b||{}).id||"del_"+f,s=Q('<li class="ui-menu-item" role="presentation"><a class="'+d.cornerall+' g-menu-item" tabindex="0" role="menuitem" id="'+l+'">'+(m.deltext||m.deltitle)+"</a></li>").click(function(){var e;Q(this).hasClass(d.disabled)||(t.p.multiselect?0===(e=t.p.selarrrow).length&&(e=null):e=t.p.selrow,e?Q.isFunction(m.delfunc)?m.delfunc.call(t,e):Q(t).jqGrid("delGridRow",e,b):(Q.jgrid.viewModal("#"+u,{gbox:"#gbox_"+Q.jgrid.jqID(t.p.id),jqm:!0}),Q("#jqg_alrt").focus()),Q(p).hide());return!1}),Q(p).append(s)),(m.add||m.edit||m.del||m.view)&&Q(p).append("<li class='ui-menu-item "+d.disabled+"' style='width:100%' role='presentation'><hr class='ui-separator-li'></li>"),m.search&&(l=(j=j||{}).id||"search_"+f,s=Q('<li class="ui-menu-item" role="presentation"><a class="'+d.cornerall+' g-menu-item" tabindex="0" role="menuitem" id="'+l+'">'+(m.searchtext||m.searchtitle)+"</a></li>").click(function(){return Q(this).hasClass(d.disabled)||(Q.isFunction(m.searchfunc)?m.searchfunc.call(t,j):Q(t).jqGrid("searchGrid",j),Q(p).hide()),!1}),Q(p).append(s),j.showOnLoad&&!0===j.showOnLoad&&Q(s).click()),m.refresh&&(l=j.id||"search_"+f,s=Q('<li class="ui-menu-item" role="presentation"><a class="'+d.cornerall+' g-menu-item" tabindex="0" role="menuitem" id="'+l+'">'+(m.refreshtext||m.refreshtitle)+"</a></li>").click(function(){if(!Q(this).hasClass(d.disabled)){Q.isFunction(m.beforeRefresh)&&m.beforeRefresh.call(t),t.p.search=!1,t.p.resetsearch=!0;try{if("currentfilter"!==m.refreshstate){var e=t.p.id;t.p.postData.filters="";try{Q("#fbox_"+Q.jgrid.jqID(e)).jqFilter("resetFilter")}catch(e){}Q.isFunction(t.clearToolbar)&&t.clearToolbar.call(t,!1)}}catch(e){}switch(m.refreshstate){case"firstpage":Q(t).trigger("reloadGrid",[{page:1}]);break;case"current":case"currentfilter":Q(t).trigger("reloadGrid",[{current:!0}])}Q.isFunction(m.afterRefresh)&&m.afterRefresh.call(t),Q(p).hide()}return!1}),Q(p).append(s)),Q(p).hide(),Q("body").append(p),Q("#"+r).addClass("ui-menu "+a.menu_widget),Q("#"+r+" > li > a").hover(function(){Q(this).addClass(d.hover)},function(){Q(this).removeClass(d.hover)}),Q(".dropdownmenu",h+"_"+m.position).on("click",function(e){var t=Q(this).offset(),i=t.left,a=parseInt(t.top),d=Q(this).val();Q("#"+d).show().css({top:a-(Q("#"+d).height()+10)+"px",left:i+"px"}),e.stopPropagation()}),Q("body").on("click",function(e){Q(e.target).hasClass("dropdownmenu")||Q("#"+r).hide()})})},GridToForm:function(a,d){return this.each(function(){var e,t=this;if(t.grid){var i=Q(t).jqGrid("getRowData",a);if(i)for(e in i)i.hasOwnProperty(e)&&(Q("[name="+Q.jgrid.jqID(e)+"]",d).is("input:radio")||Q("[name="+Q.jgrid.jqID(e)+"]",d).is("input:checkbox")?Q("[name="+Q.jgrid.jqID(e)+"]",d).each(function(){Q(this).val()==i[e]?Q(this)[t.p.useProp?"prop":"attr"]("checked",!0):Q(this)[t.p.useProp?"prop":"attr"]("checked",!1)}):Q("[name="+Q.jgrid.jqID(e)+"]",d).val(i[e]))}})},FormToGrid:function(t,a,d,r){return this.each(function(){if(this.grid){d=d||"set",r=r||"first";var e=Q(a).serializeArray(),i={};Q.each(e,function(e,t){i[t.name]=t.value}),"add"===d?Q(this).jqGrid("addRowData",t,i,r):"set"===d&&Q(this).jqGrid("setRowData",t,i)}})}})});