!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.cellx=t():e.cellx=t()}(window,function(){return function(e){var t={};function i(r){if(t[r])return t[r].exports;var s=t[r]={i:r,l:!1,exports:{}};return e[r].call(s.exports,s,s.exports,i),s.l=!0,s.exports}return i.m=e,i.c=t,i.d=function(e,t,r){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)i.d(r,s,function(t){return e[t]}.bind(null,s));return r},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=0)}([function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i(1);var s=i(3);t.EventEmitter=s.EventEmitter;var n=i(7);t.ObservableMap=n.ObservableMap;var o=i(8);t.ObservableList=o.ObservableList;var l=i(1);t.Cell=l.Cell;var h=i(6);t.WaitError=h.WaitError;var a=i(5);t.configure=a.configure;const c={__proto__:Function.prototype,cell:null,on(e,t,i){return this.cell.on(e,t,i)},off(e,t,i){return this.cell.off(e,t,i)},addChangeListener(e,t){return this.cell.addChangeListener(e,t)},removeChangeListener(e,t){return this.cell.removeChangeListener(e,t)},addErrorListener(e,t){return this.cell.addErrorListener(e,t)},removeErrorListener(e,t){return this.cell.removeErrorListener(e,t)},subscribe(e,t){return this.cell.subscribe(e,t)},unsubscribe(e,t){return this.cell.unsubscribe(e,t)},get value(){return this.cell.value},set value(e){this.cell.value=e},reap(){return this.cell.reap()},dispose(){return this.cell.dispose()}};function u(e,t,i){let s=t+"Cell";return Object.defineProperty(e,s,{configurable:!0,enumerable:!1,writable:!0,value:i instanceof r.Cell?i:new r.Cell(i,{context:e})}),Object.defineProperty(e,t,{configurable:!0,enumerable:!0,get(){return this[s].get()},set(e){this[s].set(e)}}),e}function _(e,t){return Object.keys(t).forEach(i=>{u(e,i,t[i])}),e}t.cellx=function e(t,i){let s=function(e){return arguments.length?(s.cell.set(e),e):s.cell.get()};return Object.setPrototypeOf(s,c),s.constructor=e,s.cell=new r.Cell(t,i),s},t.defineObservableProperty=u,t.defineObservableProperties=_,t.define=function(e,t,i){return"string"==typeof t?u(e,t,i):_(e,t),e}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i(2),s=i(3),n=i(4),o=i(6),l=Symbol("listenerWrappers");function h(e,t){e.push(t)}const a=[];let c,u=0,_=null;const d={error:null};let f=0;function p(){for(;u<a.length;){let e=a[u++];e._active&&e.actualize()}if(a.length=0,u=0,c){let e=c;c=null;for(let t of e)t()}}class g extends s.EventEmitter{constructor(e,t){super(),this._reactions=[],this._error=null,this._lastErrorEvent=null,this._hasSubscribers=!1,this._active=!1,this._currentlyPulling=!1,this._updationId=-1,this.debugKey=t&&t.debugKey,this.context=t&&void 0!==t.context?t.context:this,this._pull=t&&t.pull||("function"==typeof e?e:null),this._get=t&&t.get||null,this._validate=t&&t.validate||null,this._merge=t&&t.merge||null,this._put=t&&t.put||h,this._reap=t&&t.reap||null,this.meta=t&&t.meta||null,this._pull?(this._dependencies=void 0,this._value=void 0,this._state="dirty",this._inited=!1):(this._dependencies=null,t&&void 0!==t.value&&(e=t.value),this._validate&&this._validate(e,void 0),this._merge&&(e=this._merge(e,void 0)),this._value=e,this._state="actual",this._inited=!0,e instanceof s.EventEmitter&&e.on("change",this._onValueChange,this)),t&&(t.onChange&&this.on("change",t.onChange),t.onError&&this.on("error",t.onError))}static get currentlyPulling(){return!!_}static autorun(e,t){let i;return new g(function(){i||(i=(()=>{this.dispose()})),e.call(t,i)},{onChange(){}}),i}static release(){p()}static afterRelease(e){(c||(c=[])).push(e)}on(e,t,i){return null!==this._dependencies&&this.actualize(),"object"==typeof e?super.on(e,void 0!==t?t:this.context):super.on(e,t,void 0!==i?i:this.context),this._hasSubscribers=!0,this._activate(!0),this}off(e,t,i){return null!==this._dependencies&&this.actualize(),e?"object"==typeof e?super.off(e,void 0!==t?t:this.context):super.off(e,t,void 0!==i?i:this.context):super.off(),!this._hasSubscribers||this._reactions.length||this._events.has("change")||this._events.has("error")||(this._hasSubscribers=!1,this._deactivate(),this._reap&&this._reap.call(this.context)),this}addChangeListener(e,t){return this.on("change",e,void 0!==t?t:this.context)}removeChangeListener(e,t){return this.off("change",e,void 0!==t?t:this.context)}addErrorListener(e,t){return this.on("error",e,void 0!==t?t:this.context)}removeErrorListener(e,t){return this.off("error",e,void 0!==t?t:this.context)}subscribe(e,t){let i=e[l]||(e[l]=new Map);if(i.has(this))return this;function r(t){return e.call(this,t.data.error||null,t)}return i.set(this,r),void 0===t&&(t=this.context),this.on("change",r,t).on("error",r,t)}unsubscribe(e,t){let i=e[l],r=i&&i.get(this);return r?(i.delete(this),void 0===t&&(t=this.context),this.off("change",r,t).off("error",r,t)):this}_addReaction(e,t){this._reactions.push(e),this._hasSubscribers=!0,this._activate(t)}_deleteReaction(e){this._reactions.splice(this._reactions.indexOf(e),1),!this._hasSubscribers||this._reactions.length||this._events.has("change")||this._events.has("error")||(this._hasSubscribers=!1,this._deactivate(),this._reap&&this._reap.call(this.context))}_activate(e){if(this._active||!this._pull)return;let t=this._dependencies;if(t){let i=t.length;do{t[--i]._addReaction(this,e)}while(i);e&&(this._state="actual"),this._active=!0}}_deactivate(){if(!this._active)return;let e=this._dependencies,t=e.length;do{e[--t]._deleteReaction(this)}while(t);this._state="dirty",this._active=!1}_onValueChange(e){this._inited=!0,this._updationId=++f;let t=this._reactions;for(let e=0;e<t.length;e++)t[e]._addToRelease(!0);this.handleEvent(e)}_addToRelease(e){this._state=e?"dirty":"check";let t=this._reactions,i=t.length;if(i)do{"actual"==t[--i]._state&&t[i]._addToRelease(!1)}while(i);else 1==a.push(this)&&r.nextTick(p)}actualize(){if("dirty"==this._state)this.pull();else if("check"==this._state){let e=this._dependencies;for(let t=0;;){if(e[t].actualize(),"dirty"==this._state){this.pull();break}if(++t==e.length){this._state="actual";break}}}}get value(){return this.get()}set value(e){this.set(e)}get(){if("actual"!=this._state&&this._updationId!=f&&this.actualize(),_&&(_._dependencies?-1==_._dependencies.indexOf(this)&&_._dependencies.push(this):_._dependencies=[this],this._error&&this._error instanceof o.WaitError))throw this._error;return this._get?this._get(this._value):this._value}pull(){if(!this._pull)return!1;if(this._currentlyPulling)throw new TypeError("Circular pulling detected");this._currentlyPulling=!0;let e=this._dependencies;this._dependencies=null;let t,i=_;_=this;try{t=this._pull.length?this._pull.call(this.context,this,this._value):this._pull.call(this.context)}catch(e){d.error=e,t=d}if(_=i,this._currentlyPulling=!1,this._hasSubscribers){let t=this._dependencies,i=0;if(t){let r=t.length;do{let s=t[--r];e&&-1!=e.indexOf(s)||(s._addReaction(this,!1),i++)}while(r)}if(e&&(!t||t.length-i<e.length))for(let i=e.length;i;)i--,t&&-1!=t.indexOf(e[i])||e[i]._deleteReaction(this);t?this._active=!0:(this._state="actual",this._active=!1)}else this._state=this._dependencies?"dirty":"actual";return t===d?this.fail(d.error):this.push(t)}set(e){return this._inited||this.pull(),this._validate&&this._validate(e,this._value),this._merge&&(e=this._merge(e,this._value)),this._put.length>=3?this._put.call(this.context,this,e,this._value):this._put.call(this.context,this,e),this}push(e){this._inited=!0,this._error&&this._setError(null);let t=this._value,i=!Object.is(e,t);if(i&&(this._value=e,t instanceof s.EventEmitter&&t.off("change",this._onValueChange,this),e instanceof s.EventEmitter&&e.on("change",this._onValueChange,this)),this._active&&(this._state="actual"),this._updationId=++f,i){let i=this._reactions;for(let e=0;e<i.length;e++)i[e]._addToRelease(!0);this.emit("change",{prevValue:t,value:e})}return i}fail(e){this._inited=!0;let t=e instanceof o.WaitError;return t||(this.debugKey?n.logError("["+this.debugKey+"]",e):n.logError(e),e instanceof Error||(e=new Error(String(e)))),this._setError(e),this._active&&(this._state="actual"),t}_setError(e){this._error=e,this._updationId=++f,e&&this._handleErrorEvent({target:this,type:"error",data:{error:e}})}_handleErrorEvent(e){if(this._lastErrorEvent===e)return;this._lastErrorEvent=e,this.handleEvent(e);let t=this._reactions;for(let i=0;i<t.length;i++)t[i]._handleErrorEvent(e)}wait(){throw new o.WaitError}reap(){this.off();let e=this._reactions;for(let t=0;t<e.length;t++)e[t].reap();return this}dispose(){return this.reap()}}t.Cell=g},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.nextTick=(()=>{const e=Function("return this;")();if(e.process&&"[object process]"==e.process.toString()&&e.process.nextTick)return e.process.nextTick;if(e.setImmediate&&-1!=e.setImmediate.toString().indexOf("[native code]")){const t=e.setImmediate;return e=>{t(e)}}const t=Promise.resolve();return e=>{t.then(()=>{e()})}})()},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i(4),s=Object.prototype.hasOwnProperty;let n=!1,o=0,l=[],h=0;t.EventEmitter=class{static get currentlySubscribing(){return n}static transact(e){o++;try{e()}catch(e){r.logError(e)}if(--o)return;let t=l;l=[];for(let e of t)e.target.handleEvent(e)}static silently(e){h++;try{e()}catch(e){r.logError(e)}h--}constructor(){this._events=new Map}getEvents(e){if(e){let t=this._events.get(e);return t?Array.isArray(t)?t:[t]:[]}let t=new Map;for(let[e,i]of this._events)t.set(e,Array.isArray(i)?i:[i]);return t}on(e,t,i){if("object"==typeof e){i=void 0!==t?t:this;let r=e;for(e in r)s.call(r,e)&&this._on(e,r[e],i);for(let e of Object.getOwnPropertySymbols(r))this._on(e,r[e],i)}else this._on(e,t,void 0!==i?i:this);return this}off(e,t,i){if(e)if("object"==typeof e){i=void 0!==t?t:this;let r=e;for(e in r)s.call(r,e)&&this._off(e,r[e],i);for(let e of Object.getOwnPropertySymbols(r))this._off(e,r[e],i)}else this._off(e,t,void 0!==i?i:this);else this._events.clear();return this}_on(e,t,i){let r;if("string"==typeof e&&-1!=(r=e.indexOf(":"))){let s=e.slice(r+1);n=!0,(this[s+"Cell"]||(this[s],this[s+"Cell"])).on(e.slice(0,r),t,i),n=!1}else{let r=this._events.get(e),s={listener:t,context:i};r?Array.isArray(r)?r.push(s):this._events.set(e,[r,s]):this._events.set(e,s)}}_off(e,t,i){let r;if("string"==typeof e&&-1!=(r=e.indexOf(":"))){let s=e.slice(r+1);(this[s+"Cell"]||(this[s],this[s+"Cell"])).off(e.slice(0,r),t,i)}else{let r,s=this._events.get(e);if(!s)return;if(Array.isArray(s)){if(1!=s.length){for(let e=s.length;e;)if((r=s[--e]).listener==t&&r.context===i){s.splice(e,1);break}return}r=s[0]}else r=s;r.listener==t&&r.context===i&&this._events.delete(e)}}once(e,t,i){function r(s){return this._off(e,r,i),t.call(this,s)}return void 0===i&&(i=this),this._on(e,r,i),r}emit(e,t){if("object"==typeof e)if(e.target){if(e.target!=this)throw new TypeError("Event cannot be emitted on this target")}else e.target=this;else e={target:this,type:e};if(t&&(e.data=t),!h)if(o)for(let t=l.length;;){if(!t){(e.data||(e.data={})).prevEvent=null,l.push(e);break}let i=l[--t];if(i.target==this&&i.type===e.type){(e.data||(e.data={})).prevEvent=i,l[t]=e;break}}else this.handleEvent(e);return e}handleEvent(e){let t=this._events.get(e.type);if(t)if(Array.isArray(t))if(1==t.length)!1===this._tryEventListener(t[0],e)&&(e.propagationStopped=!0);else{t=t.slice();for(let i=0;i<t.length;i++)!1===this._tryEventListener(t[i],e)&&(e.propagationStopped=!0)}else!1===this._tryEventListener(t,e)&&(e.propagationStopped=!0)}_tryEventListener(e,t){try{return e.listener.call(e.context,t)}catch(e){r.logError(e)}}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i(5);t.logError=function(...e){r.config.logError(...e)}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.config={logError:(...e)=>{console.error(...e)}},t.configure=function(e){return Object.assign(t.config,e),t.config}},function(e,t,i){"use strict";function r(){}Object.defineProperty(t,"__esModule",{value:!0}),t.WaitError=r,r.prototype={__proto__:Error.prototype,constructor:r}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i(3),s=Object.prototype.hasOwnProperty;class n extends r.EventEmitter{constructor(e){if(super(),this._entries=new Map,e){let t=this._entries;if(e instanceof Map||e instanceof n)(e instanceof Map?e:e._entries).forEach((e,i)=>{t.set(i,e)});else if(Array.isArray(e))for(let i=0,r=e.length;i<r;i++)t.set(e[i][0],e[i][1]);else for(let i in e)s.call(e,i)&&t.set(i,e[i])}}get size(){return this._entries.size}has(e){return this._entries.has(e)}get(e){return this._entries.get(e)}set(e,t){let i,r=this._entries,s=r.has(e);return s&&(i=r.get(e),Object.is(t,i))?this:(r.set(e,t),this.emit("change",{subtype:s?"update":"add",key:e,prevValue:i,value:t}),this)}delete(e){let t=this._entries;if(t.has(e)){let i=t.get(e);return t.delete(e),this.emit("change",{subtype:"delete",key:e,value:i}),!0}return!1}clear(){return this._entries.size&&(this._entries.clear(),this.emit("change",{subtype:"clear"})),this}forEach(e,t){this._entries.forEach(function(i,r){e.call(t,i,r,this)},this)}keys(){return this._entries.keys()}values(){return this._entries.values()}entries(){return this._entries.entries()}clone(e){let t;return e&&(t=[],this._entries.forEach((e,i)=>{t.push([i,e&&e.clone?e.clone(!0):e])})),new this.constructor(t||this)}}t.ObservableMap=n,n.prototype[Symbol.iterator]=n.prototype.entries},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i(3),s=Array.prototype.push,n=Array.prototype.splice,o=(e,t)=>e<t?-1:e>t?1:0;class l extends r.EventEmitter{constructor(e,t){if(super(),this._items=[],t&&(t.sorted||t.comparator&&!1!==t.sorted)?(this._comparator=t.comparator||o,this._sorted=!0):(this._comparator=null,this._sorted=!1),e)if(this._sorted){e instanceof l&&(e=e._items);for(let t=0,i=e.length;t<i;t++)this._insertSortedValue(e[t])}else s.apply(this._items,e instanceof l?e._items:e)}get length(){return this._items.length}_validateIndex(e,t){if(void 0===e)return e;if(e<0){if((e+=this._items.length)<0)throw new RangeError("Index out of valid range")}else if(e>this._items.length-(t?0:1))throw new RangeError("Index out of valid range");return e}contains(e){return-1!=this._items.indexOf(e)}indexOf(e,t){return this._items.indexOf(e,this._validateIndex(t,!0))}lastIndexOf(e,t){return this._items.lastIndexOf(e,void 0===t?-1:this._validateIndex(t,!0))}get(e){return this._items[this._validateIndex(e,!0)]}getRange(e,t){if(e=this._validateIndex(e,!0),void 0===t)return this._items.slice(e);if(e+t>this._items.length)throw new RangeError('Sum of "index" and "count" out of valid range');return this._items.slice(e,e+t)}set(e,t){if(this._sorted)throw new TypeError("Cannot set to sorted list");return e=this._validateIndex(e,!0),Object.is(t,this._items[e])||(this._items[e]=t,this.emit("change")),this}setRange(e,t){if(this._sorted)throw new TypeError("Cannot set to sorted list");e=this._validateIndex(e,!0),t instanceof l&&(t=t._items);let i=t.length;if(!i)return this;if(e+i>this._items.length)throw new RangeError('Sum of "index" and "values.length" out of valid range');let r=this._items,s=!1;for(let n=e+i;n>e;){let i=t[--n-e];Object.is(i,r[n])||(r[n]=i,s=!0)}return s&&this.emit("change"),this}add(e,t){return t&&-1!=this._items.indexOf(e)?this:(this._sorted?this._insertSortedValue(e):this._items.push(e),this.emit("change"),this)}addRange(e,t){if(e instanceof l&&(e=e._items),e.length)if(t){let t=this._items,i=this._sorted,r=!1;for(let s of e)-1==t.indexOf(s)&&(i?this._insertSortedValue(s):t.push(s),r=!0);r&&this.emit("change")}else{if(this._sorted)for(let t=0,i=e.length;t<i;t++)this._insertSortedValue(e[t]);else s.apply(this._items,e);this.emit("change")}return this}insert(e,t){if(this._sorted)throw new TypeError("Cannot insert to sorted list");return this._items.splice(this._validateIndex(e,!0),0,t),this.emit("change"),this}insertRange(e,t){if(this._sorted)throw new TypeError("Cannot insert to sorted list");return e=this._validateIndex(e,!0),t instanceof l&&(t=t._items),t.length&&(n.apply(this._items,[e,0].concat(t)),this.emit("change")),this}remove(e,t){let i=this._items.indexOf(e,this._validateIndex(t,!0));return-1!=i&&(this._items.splice(i,1),this.emit("change"),!0)}removeAll(e,t){let i=this._validateIndex(t,!0),r=this._items,s=!1;for(;-1!=(i=r.indexOf(e,i));)r.splice(i,1),s=!0;return s&&this.emit("change"),s}removeEach(e,t){t=this._validateIndex(t,!0),e instanceof l&&(e=e._items.slice());let i=this._items,r=!1;for(let s=0,n=e.length;s<n;s++){let n=i.indexOf(e[s],t);-1!=n&&(i.splice(n,1),r=!0)}return r&&this.emit("change"),r}removeAt(e){let t=this._items.splice(this._validateIndex(e),1)[0];return this.emit("change"),t}removeRange(e,t){if(e=this._validateIndex(e,!0),void 0===t){if(!(t=this._items.length-e))return[]}else{if(!t)return[];if(e+t>this._items.length)throw new RangeError('Sum of "index" and "count" out of valid range')}let i=this._items.splice(e,t);return this.emit("change"),i}clear(){return this._items.length&&(this._items.length=0,this.emit("change",{subtype:"clear"})),this}join(e){return this._items.join(e)}find(e,t){let i=this._items;for(let r=0,s=i.length;r<s;r++){let s=i[r];if(e.call(t,s,r,this))return s}}findIndex(e,t){let i=this._items;for(let r=0,s=i.length;r<s;r++)if(e.call(t,i[r],r,this))return r;return-1}clone(e){return new this.constructor(e?this._items.map(e=>e&&e.clone?e.clone(!0):e):this,{comparator:this._comparator||void 0,sorted:this._sorted})}toArray(){return this._items.slice()}toString(){return this._items.join()}_insertSortedValue(e){let t=this._items,i=this._comparator,r=0,s=t.length;for(;r!=s;){let n=r+s>>1;i(e,t[n])<0?s=n:r=n+1}t.splice(r,0,e)}}t.ObservableList=l,["forEach","map","filter","every","some"].forEach(e=>{l.prototype[e]=function(t,i){return this._items[e](function(e,r){return t.call(i,e,r,this)},this)}}),["reduce","reduceRight"].forEach(e=>{l.prototype[e]=function(t,i){let r=this;function s(e,i,s){return t(e,i,s,r)}return arguments.length>=2?this._items[e](s,i):this._items[e](s)}}),[["keys",e=>e],["values",(e,t)=>t],["entries",(e,t)=>[e,t]]].forEach(e=>{let t=e[1];l.prototype[e[0]]=function(){let e=this._items,i=0,r=!1;return{next(){if(!r){if(i<e.length)return{value:t(i,e[i++]),done:!1};r=!0}return{value:void 0,done:!0}}}}}),l.prototype[Symbol.iterator]=l.prototype.values}])});