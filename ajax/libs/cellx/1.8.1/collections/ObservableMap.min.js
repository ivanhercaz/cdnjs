"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const EventEmitter_1=require("../EventEmitter"),hasOwn=Object.prototype.hasOwnProperty;class ObservableMap extends EventEmitter_1.EventEmitter{constructor(e){if(super(),this._entries=new Map,e){let t=this._entries;if(e instanceof Map||e instanceof ObservableMap)(e instanceof Map?e:e._entries).forEach((e,s)=>{t.set(s,e)});else if(Array.isArray(e))for(let s=0,r=e.length;s<r;s++)t.set(e[s][0],e[s][1]);else for(let s in e)hasOwn.call(e,s)&&t.set(s,e[s])}}get size(){return this._entries.size}has(e){return this._entries.has(e)}get(e){return this._entries.get(e)}set(e,t){let s,r=this._entries,i=r.has(e);return i&&(s=r.get(e),Object.is(t,s))?this:(r.set(e,t),this.emit("change",{subtype:i?"update":"add",key:e,prevValue:s,value:t}),this)}delete(e){let t=this._entries;if(t.has(e)){let s=t.get(e);return t.delete(e),this.emit("change",{subtype:"delete",key:e,value:s}),!0}return!1}clear(){return this._entries.size&&(this._entries.clear(),this.emit("change",{subtype:"clear"})),this}forEach(e,t){this._entries.forEach(function(s,r){e.call(t,s,r,this)},this)}keys(){return this._entries.keys()}values(){return this._entries.values()}entries(){return this._entries.entries()}clone(e){let t;return e&&(t=[],this._entries.forEach((e,s)=>{t.push([s,e&&e.clone?e.clone(!0):e])})),new this.constructor(t||this)}}exports.ObservableMap=ObservableMap,ObservableMap.prototype[Symbol.iterator]=ObservableMap.prototype.entries;