define(["./query","./_base/lang","./_base/array","./dom-construct","./dom-attr","./NodeList-dom"],function(a,p,d,u,i){var e=a.NodeList;function o(e){for(;e.childNodes[0]&&1==e.childNodes[0].nodeType;)e=e.childNodes[0];return e}function s(e,t){return"string"==typeof e?11==(e=u.toDom(e,t&&t.ownerDocument)).nodeType&&(e=e.childNodes[0]):1==e.nodeType&&e.parentNode&&(e=e.cloneNode(!1)),e}return p.extend(e,{_placeMultiple:function(e,t){for(var n="string"==typeof e||e.nodeType?a(e):e,r=[],i=0;i<n.length;i++)for(var o,s=n[i],h=this.length,l=h-1;o=this[l];l--)0<i&&(o=this._cloneNode(o),r.unshift(o)),l==h-1?u.place(o,s,t):s.parentNode.insertBefore(o,s),s=o;return r.length&&(r.unshift(0),r.unshift(this.length-1),Array.prototype.splice.apply(this,r)),this},innerHTML:function(e){return arguments.length?this.addContent(e,"only"):this[0].innerHTML},text:function(e){if(arguments.length){for(var t,n=0;t=this[n];n++)1==t.nodeType&&i.set(t,"textContent",e);return this}var r="";for(n=0;t=this[n];n++)r+=i.get(t,"textContent");return r},val:function(e){if(arguments.length){for(var t,n=p.isArray(e),r=0;t=this[r];r++){var i=t.nodeName.toUpperCase(),o=t.type,s=n?e[r]:e;if("SELECT"==i)for(var h=t.options,l=0;l<h.length;l++){var a=h[l];t.multiple?a.selected=-1!=d.indexOf(e,a.value):a.selected=a.value==s}else"checkbox"==o||"radio"==o?t.checked=t.value==s:t.value=s}return this}if((t=this[0])&&1==t.nodeType){if(e=t.value||"","SELECT"==t.nodeName.toUpperCase()&&t.multiple){for(e=[],h=t.options,l=0;l<h.length;l++)(a=h[l]).selected&&e.push(a.value);e.length||(e=null)}return e}},append:function(e){return this.addContent(e,"last")},appendTo:function(e){return this._placeMultiple(e,"last")},prepend:function(e){return this.addContent(e,"first")},prependTo:function(e){return this._placeMultiple(e,"first")},after:function(e){return this.addContent(e,"after")},insertAfter:function(e){return this._placeMultiple(e,"after")},before:function(e){return this.addContent(e,"before")},insertBefore:function(e){return this._placeMultiple(e,"before")},remove:e.prototype.orphan,wrap:function(e){if(this[0]){e=s(e,this[0]);for(var t,n=0;t=this[n];n++){var r=this._cloneNode(e);t.parentNode&&t.parentNode.replaceChild(r,t),o(r).appendChild(t)}}return this},wrapAll:function(e){if(this[0]){e=s(e,this[0]),this[0].parentNode.replaceChild(e,this[0]);for(var t,n=o(e),r=0;t=this[r];r++)n.appendChild(t)}return this},wrapInner:function(e){if(this[0]){e=s(e,this[0]);for(var t=0;t<this.length;t++){var n=this._cloneNode(e);this._wrap(p._toArray(this[t].childNodes),null,this._NodeListCtor).wrapAll(n)}}return this},replaceWith:function(e){e=this._normalize(e,this[0]);for(var t,n=0;t=this[n];n++)this._place(e,t,"before",0<n),t.parentNode.removeChild(t);return this},replaceAll:function(e){for(var t,n=a(e),r=this._normalize(this,this[0]),i=0;t=n[i];i++)this._place(r,t,"before",0<i),t.parentNode.removeChild(t);return this},clone:function(){for(var e=[],t=0;t<this.length;t++)e.push(this._cloneNode(this[t]));return this._wrap(e,this,this._NodeListCtor)}}),e.prototype.html||(e.prototype.html=e.prototype.innerHTML),e});