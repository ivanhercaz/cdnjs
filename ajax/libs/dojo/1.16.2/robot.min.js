define(["./_base/array","./dom","./dom-geometry","./_base/kernel","./_base/lang","./_base/window","doh/_browserRunner","doh/robot","./window"],function(o,n,s,e,t,r,i,u,c){return e.experimental("dojo.robot"),t.mixin(u,{_resolveNode:function(o){return"function"==typeof o&&(o=o()),o?n.byId(o):null},_scrollIntoView:function(r){var i=null;o.forEach(u._getWindowChain(r),function(o){var n=s.position(r,!1),e=s.getPadBorderExtents(r),t=null;i=i?{x:(t=i).x+n.x+e.l,y:i.y+n.y+e.t,w:i.w,h:i.h}:n,c.scrollIntoView(r,i),n=s.position(r,!1),i=t?{x:t.x+n.x+e.l,y:t.y+n.y+e.t,w:i.w,h:i.h}:n,r=o.frameElement})},_position:function(r){var i=null,l=Math.max,a=Math.min;return o.forEach(u._getWindowChain(r),function(o){var n=s.position(r,!1),e=s.getPadBorderExtents(r);if(i){var t=c.getBox(r.contentWindow.document);n.r=n.x+t.w,n.b=n.y+t.h,(i={x:l(i.x+n.x,n.x)+e.l,y:l(i.y+n.y,n.y)+e.t,r:a(i.x+n.x+i.w,n.r)+e.l,b:a(i.y+n.y+i.h,n.b)+e.t}).w=i.r-i.x,i.h=i.b-i.y}else i=n;r=o.frameElement}),i},_getWindowChain:function(o){var n=c.get(o.ownerDocument),e=[n],t=n.frameElement;return n!=r.global&&t?e.concat(u._getWindowChain(t)):e},scrollIntoView:function(o,n){u.sequence(function(){u._scrollIntoView(u._resolveNode(o))},n)},mouseMoveAt:function(n,o,e,t,r){u._assertRobot();var i={};this.sequence(function(){n=u._resolveNode(n),u._scrollIntoView(n);var o=u._position(n);void 0===r&&(t=o.w/2,r=o.h/2),i.x=o.x+t,i.y=o.y+r},o),this.mouseMoveTo(i,0,e,!1)}}),u});