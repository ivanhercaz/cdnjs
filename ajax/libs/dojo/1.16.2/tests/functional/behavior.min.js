define(["require","intern!object","intern/chai!assert","../support/ready"],function(e,t,n,o){t({name:"dojo/behavior",before:function(){return o(this.get("remote"),e.toUrl("./behavior.html"))},".add":function(){return this.get("remote").execute(function(){return{bar:!!behavior._behaviors[".bar"],foo:!!behavior._behaviors[".foo > span"]}}).then(function(e){n.ok(!e.bar),n.ok(!e.foo)}).execute(function(){return behavior.add(behaviorObject),{bar:behavior._behaviors[".bar"]&&behavior._behaviors[".bar"].length,foo:behavior._behaviors[".foo > span"]&&behavior._behaviors[".foo > span"].length,applyCount:applyCount}}).then(function(e){n.strictEqual(e.bar,1),n.strictEqual(e.foo,1),n.strictEqual(e.applyCount,0)})},".apply":function(){return this.get("remote").execute(function(){return behavior.apply(),applyCount}).then(function(e){n.strictEqual(e,2)}).execute(function(){return behavior.apply(),applyCount}).then(function(e){n.strictEqual(e,2)})},reapply:function(){return this.get("remote").execute(function(){return behavior.add(behaviorObject),behavior.apply(),applyCount}).then(function(e){n.strictEqual(e,4)})},events:function(){return this.get("remote").execute(function(){return behavior.add({".foo":"/foo"}),behavior.apply(),topicCount}).then(function(e){n.strictEqual(e,2)}).findById("another").click().end().execute(function(){return behavior.add({".foo":{onfocus:"/foo"}}),behavior.apply(),topicCount}).then(function(e){n.strictEqual(e,2)}).findById("blah").click().end().sleep(500).execute(function(){return topicCount}).then(function(e){n.strictEqual(e,3)}).findById("another").click().end().sleep(500).findById("blah").click().end().sleep(500).execute(function(){return topicCount}).then(function(e){n.strictEqual(e,4)})}})});