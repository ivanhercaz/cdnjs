define(["intern!object","intern/chai!assert","../../number","../../i18n"],function(t,c,n){function o(t){c.notStrictEqual(t,t)}function i(t){return t!=t}function q(t,r){var a=t-r;if(Math.abs(a)<.001)return 1;if(isNaN(Math.abs(a))){var l=t.toString().split(r)[1];return l=l.replace(",","0").replace("٫","0"),Number(l)<.001}}function e(t,r,a,l){if(null==t)t.pattern,t.locale;var u=n.format(r,t);if(i(a)?o(u):c.strictEqual(u,a),l){var e=n.parse(u,t);q(e,r)||c.strictEqual(e,r);var s=n.format(e,t);q(u,s)||c.strictEqual(s,u)}}function s(t,r,a){t&&null!=t.pattern&&t.pattern;var l=n.parse(r,t);i(a)?o(l):c.strictEqual(l,a)}function r(t,r,a,l){for(var u="#0.",e=0;e<r;e++)u+="#";var s=n.format(t,{locale:l||"en-us",pattern:u});c.strictEqual(s,a)}t({name:"dojo/number",".invalid":function(){c.isNull(n.format(NaN)),c.isNull(n.format(Number.NaN)),c.isNull(n.format(1/0)),c.isNull(n.format(-1/0))},".round":{basic:function(){c.strictEqual(n.round(0),0),c.strictEqual(n.round(.5),1),c.strictEqual(n.round(-.5),-1),c.strictEqual(n.round(.05,1),.1),c.strictEqual(n.round(.09,1),.1),c.strictEqual(n.round(.04999999,1),0),c.strictEqual(n.round(.09499999,1),.1),c.strictEqual(n.round(.095,1),.1),c.strictEqual(n.round(.09999999,1),.1),c.strictEqual(n.round(-.05,1),-.1),c.strictEqual(n.round(1.05,1),1.1),c.strictEqual(n.round(-1.05,1),-1.1)},multiple:function(){c.strictEqual(n.round(123.4525,2,5),123.455),c.strictEqual(n.round(123.452,2,5),123.45),c.strictEqual(n.round(123.454,2,5),123.455),c.strictEqual(n.round(123.456,2,5),123.455),c.strictEqual(n.round(-123.452,2,5),-123.45),c.strictEqual(n.round(-123.4525,2,5),-123.455),c.strictEqual(n.round(-123.454,2,5),-123.455),c.strictEqual(n.round(-123.456,2,5),-123.455)},speleotrove:function(){c.strictEqual(n.round(12344.9),12345,"radx200"),c.strictEqual(n.round(12344.99),12345,"radx201"),c.strictEqual(n.round(12344.999),12345,"radx202"),c.strictEqual(n.round(12345-1e-5),12345,"radx203"),c.strictEqual(n.round(12345-1e-6),12345,"radx204"),c.strictEqual(n.round(12345-1e-7),12345,"radx205"),c.strictEqual(n.round(12345),12345,"radx206"),c.strictEqual(n.round(12345+1e-7),12345,"radx207"),c.strictEqual(n.round(12345+1e-6),12345,"radx208"),c.strictEqual(n.round(12345+1e-5),12345,"radx209"),c.strictEqual(n.round(12345.0001),12345,"radx210"),c.strictEqual(n.round(12345.001),12345,"radx211"),c.strictEqual(n.round(12345.01),12345,"radx212"),c.strictEqual(n.round(12345.1),12345,"radx213"),c.strictEqual(n.round(12346.49999),12346,"radx215"),c.strictEqual(n.round(12346.5),12347,"radx216"),c.strictEqual(n.round(12346.50001),12347,"radx217"),c.strictEqual(n.round(12345.4),12345,"radx220"),c.strictEqual(n.round(12345.49),12345,"radx221"),c.strictEqual(n.round(12345.499),12345,"radx222"),c.strictEqual(n.round(12345.49999),12345,"radx223"),c.strictEqual(n.round(12345.5),12346,"radx224"),c.strictEqual(n.round(12345.50001),12346,"radx225"),c.strictEqual(n.round(12345.5001),12346,"radx226"),c.strictEqual(n.round(12345.501),12346,"radx227"),c.strictEqual(n.round(12345.51),12346,"radx228"),c.strictEqual(n.round(12345.6),12346,"radx229"),c.strictEqual(n.round(-12345.1),-12345,"rsux200"),c.strictEqual(n.round(-12345.01),-12345,"rsux201"),c.strictEqual(n.round(-12345.001),-12345,"rsux202"),c.strictEqual(n.round(-12345-1e-5),-12345,"rsux203"),c.strictEqual(n.round(-12345-1e-6),-12345,"rsux204"),c.strictEqual(n.round(-12345-1e-7),-12345,"rsux205"),c.strictEqual(n.round(-12345),-12345,"rsux206"),c.strictEqual(n.round(1e-7-12345),-12345,"rsux207"),c.strictEqual(n.round(1e-6-12345),-12345,"rsux208"),c.strictEqual(n.round(1e-5-12345),-12345,"rsux209"),c.strictEqual(n.round(1e-4-12345),-12345,"rsux210"),c.strictEqual(n.round(-12344.999),-12345,"rsux211"),c.strictEqual(n.round(-12344.99),-12345,"rsux212"),c.strictEqual(n.round(-12344.9),-12345,"rsux213"),c.strictEqual(n.round(-12345.50001),-12346,"rsux215"),c.strictEqual(n.round(-12345.5),-12346,"rsux216"),c.strictEqual(n.round(-12345.49999),-12345,"rsux217"),c.strictEqual(n.round(-12344.6),-12345,"rsux220"),c.strictEqual(n.round(-12344.51),-12345,"rsux221"),c.strictEqual(n.round(-12344.501),-12345,"rsux222"),c.strictEqual(n.round(-12344.50001),-12345,"rsux223"),c.strictEqual(n.round(-12344.5),-12345,"rsux224"),c.strictEqual(n.round(-12344.49999),-12344,"rsux225"),c.strictEqual(n.round(-12344.4999),-12344,"rsux226"),c.strictEqual(n.round(-12344.499),-12344,"rsux227"),c.strictEqual(n.round(-12344.49),-12344,"rsux228"),c.strictEqual(n.round(-12344.4),-12344,"rsux229"),c.strictEqual(n.round(12345),12345,"rdvx401"),c.strictEqual(n.round(12345/1.0001),12344,"rdvx402"),c.strictEqual(n.round(12345/1.001),12333,"rdvx403"),c.strictEqual(n.round(12345/1.01),12223,"rdvx404"),c.strictEqual(n.round(12345/1.1),11223,"rdvx405"),c.strictEqual(n.round(3088.75,1),3088.8,"rdvx406"),c.strictEqual(n.round(3086.25,1),3086.3,"rdvx407"),c.strictEqual(n.round(12355/4.0001,1),3088.7,"rdvx408"),c.strictEqual(n.round(12345/4.0001,1),3086.2,"rdvx409"),c.strictEqual(n.round(12345/4.9,1),2519.4,"rdvx410"),c.strictEqual(n.round(12345/4.99,1),2473.9,"rdvx411"),c.strictEqual(n.round(12345/4.999,1),2469.5,"rdvx412"),c.strictEqual(n.round(12345/4.9999,1),2469,"rdvx413"),c.strictEqual(n.round(2469,1),2469,"rdvx414"),c.strictEqual(n.round(12345/5.0001,1),2469,"rdvx415"),c.strictEqual(n.round(12345/5.001,1),2468.5,"rdvx416"),c.strictEqual(n.round(12345/5.01,1),2464.1,"rdvx417"),c.strictEqual(n.round(12345/5.1,1),2420.6,"rdvx418"),c.strictEqual(n.round(12345),12345,"rmux401"),c.strictEqual(n.round(12346.2345),12346,"rmux402"),c.strictEqual(n.round(12357.345),12357,"rmux403"),c.strictEqual(n.round(12468.45),12468,"rmux404"),c.strictEqual(n.round(12345*1.1),13580,"rmux405"),c.strictEqual(n.round(49380),49380,"rmux406"),c.strictEqual(n.round(49381.2345),49381,"rmux407"),c.strictEqual(n.round(12345*4.9),60491,"rmux408"),c.strictEqual(n.round(61601.55),61602,"rmux409"),c.strictEqual(n.round(61712.655),61713,"rmux410"),c.strictEqual(n.round(61723.7655),61724,"rmux411"),c.strictEqual(n.round(61725),61725,"rmux412"),c.strictEqual(n.round(61726.2345),61726,"rmux413"),c.strictEqual(n.round(61737.345),61737,"rmux414"),c.strictEqual(n.round(61848.45),61848,"rmux415")}},".format":{"old tests":function(){c.strictEqual(n.format(123,{pattern:"0000"}),"0123"),c.strictEqual(n.format(-1234567.89,{pattern:"#,##,##0.000##",locale:"en-us"}),"-12,34,567.890"),c.strictEqual(n.format(-1234567.890123,{pattern:"#,##,##0.000##",locale:"en-us"}),"-12,34,567.89012"),c.strictEqual(n.format(-1234567.890123,{pattern:"#,##0.000##;(#,##0.000##)",locale:"en-us"}),"(1,234,567.89012)"),c.strictEqual(n.format(-1234567.890123,{pattern:"#,##0.000##;(#)",locale:"en-us"}),"(1,234,567.89012)"),c.strictEqual(n.format(.501,{pattern:"#0.#%",locale:"en-us"}),"50.1%"),c.strictEqual(n.format(1998,{pattern:"00"}),"98"),c.strictEqual(n.format(1998,{pattern:"00000"}),"01998"),c.strictEqual(n.format(.125,{pattern:"0.##",locale:"en-us"}),"0.13"),c.strictEqual(n.format(.125,{pattern:"0.0000",locale:"en-us"}),"0.1250"),c.strictEqual(n.format(.100004,{pattern:"0.####",locale:"en-us"}),"0.1"),c.strictEqual(n.format(-12.3,{places:0,locale:"en-us"}),"-12"),c.strictEqual(n.format(-1234567.89,{locale:"en-us"}),"-1,234,567.89"),c.strictEqual(n.format(-1234567.89,{places:0,locale:"en-us"}),"-1,234,568"),c.strictEqual(n.format(-1000.1,{places:2,locale:"fr-fr"}),"-1 000,10"),c.strictEqual(n.format(-1000.1,{places:2,locale:"en-us"}),"-1,000.10"),c.strictEqual(n.format(-1000.1,{places:2,locale:"fr-fr"}),"-1 000,10"),c.strictEqual(n.format(-1234.56,{places:2,locale:"de-de"}),"-1.234,56"),c.strictEqual(n.format(-1000.1,{places:2,locale:"en-us"}),"-1,000.10"),c.strictEqual(n.format(1.23456,{places:2,locale:"en-us",type:"percent"}),"123.46%"),c.strictEqual(n.format(123.4,{places:"1,3",locale:"en-us"}),"123.4"),c.strictEqual(n.format(123.45,{places:"1,3",locale:"en-us"}),"123.45"),c.strictEqual(n.format(123.456,{places:"1,3",locale:"en-us"}),"123.456"),c.strictEqual(n.format(-1234567.89,{places:0,locale:"en-us"}),"-1,234,568"),c.strictEqual(n.format(-1000.114,{places:2,locale:"en-us"}),"-1,000.11"),c.strictEqual(n.format(-1000.115,{places:2,locale:"en-us"}),"-1,000.12"),c.strictEqual(n.format(-1000.116,{places:2,locale:"en-us"}),"-1,000.12"),c.strictEqual(n.format(-1e-4,{places:2,locale:"en-us"}),"-0.00"),c.strictEqual(n.format(0,{places:2,locale:"en-us"}),"0.00"),c.strictEqual(n.format(-1000.1,{places:3,locale:"fr-fr"}),"-1 000,100"),c.strictEqual(n.format(-1000.1,{places:3,locale:"en-us"}),"-1,000.100")},patterns:function(){for(var t=["#0.#","#0.","#.0","#"],r=t.length,a=["0","0","0.0","0"],l=0;l<r;++l)e({pattern:t[l],locale:"en-us"},0,a[l],!1)},rounding:function(){r(179999e-9,5,"0.00018"),r(99e-5,4,"0.001"),r(17.6995,3,"17.7"),r(15.3999,0,"15"),r(-29.6,0,"-30")},perMill:function(){var t=n.format(.4857,{pattern:"###.###‰",locale:"en-us"});c.strictEqual(t,"485.7‰")},grouping:function(){e({pattern:"#,##,###",locale:"en-us"},123456789,"12,34,56,789",!0)}},".parse":{"old tests":function(){c.strictEqual(n.parse("1000",{locale:"en-us"}),1e3),c.strictEqual(n.parse("1000.123",{locale:"en-us"}),1000.123),c.strictEqual(n.parse("1,000",{locale:"en-us"}),1e3),c.strictEqual(n.parse("-1000",{locale:"en-us"}),-1e3),c.strictEqual(n.parse("-1000.123",{locale:"en-us"}),-1000.123),c.strictEqual(n.parse("-1,234,567.89",{locale:"en-us"}),-1234567.89),c.strictEqual(n.parse("-1 234 567,89",{locale:"fr-fr"}),-1234567.89),o(n.parse("-1 234 567,89",{locale:"en-us"})),c.strictEqual(n.parse("0123",{pattern:"0000"}),123),o(n.parse("10,00",{locale:"en-us"})),o(n.parse("1000.1",{locale:"fr-fr"})),o(n.parse("")),o(n.parse("abcd")),c.strictEqual(n.parse("1.23456789",{locale:"en-us"}),1.23456789),c.strictEqual(n.parse("123%",{locale:"en-us",type:"percent"}),1.23),c.strictEqual(n.parse("123%",{places:0,locale:"en-us",type:"percent"}),1.23),o(n.parse("123.46%",{places:0,locale:"en-us",type:"percent"})),c.strictEqual(n.parse("123.46%",{places:2,locale:"en-us",type:"percent"}),1.2346),c.strictEqual(n.parse("50.1%",{pattern:"#0.#%",locale:"en-us"}),.501),c.strictEqual(n.parse("123.4",{pattern:"#0.#",locale:"en-us"}),123.4),c.strictEqual(n.parse("-123.4",{pattern:"#0.#",locale:"en-us"}),-123.4),c.strictEqual(n.parse("123.4",{pattern:"#0.#;(#0.#)",locale:"en-us"}),123.4),c.strictEqual(n.parse("(123.4)",{pattern:"#0.#;(#0.#)",locale:"en-us"}),-123.4),c.isNull(n.format("abcd",{pattern:"0000"})),c.strictEqual(n.parse("123",{places:0}),123),c.strictEqual(n.parse("123",{places:"0"}),123),c.strictEqual(n.parse("123.4",{places:1,locale:"en-us"}),123.4),c.strictEqual(n.parse("123.45",{places:"1,3",locale:"en-us"}),123.45),c.strictEqual(n.parse("123.45",{places:"0,2",locale:"en-us"}),123.45)},t18466:function(){var t="fr";s({pattern:"#,###.00 ¤;(#,###.00) ¤",locale:t},"1,00 ",NaN),s({pattern:"#,###.00 ¤;(#,###.00) ¤",locale:t},"1,00",1),s({pattern:"#,###.00¤;(#,###.00)¤",locale:t},"1,00 ",NaN),s({pattern:"#,###.00¤;(#,###.00)¤",locale:t},"1,00",1),s({pattern:"#,###.00 ¤;(#,###.00) ¤",locale:t},"1 000,00 ",NaN),s({pattern:"#,###.00 ¤;(#,###.00) ¤",locale:t},"1 000,00",1e3),s({pattern:"#,###.00¤;(#,###.00)¤",locale:t},"1 000,00 ",NaN),s({pattern:"#,###.00¤;(#,###.00)¤",locale:t},"1 000,00",1e3),e({pattern:"#,###.00 ¤;(#,###.00) ¤",locale:t},"1200","1 200,00",!0),e({pattern:"#,###.00¤;(#,###.00)¤",locale:t},"1200","1 200,00",!0),e({pattern:"#,###.00 ¤;(#,###.00) ¤",locale:t},"1200 ","1 200,00",!0),e({pattern:"#,###.00¤;(#,###.00)¤",locale:t},"1200 ","1 200,00",!0),s({pattern:"¤ #,###.00;¤ (#,###.00)",locale:t}," 1,00",NaN),s({pattern:"¤ #,###.00;¤ (#,###.00)",locale:t},"1,00",1),s({pattern:"¤#,###.00;¤(#,###.00)",locale:t}," 1,00",NaN),s({pattern:"¤#,###.00;¤(#,###.00)",locale:t},"1,00",1),s({pattern:"¤ #,###.00;¤ (#,###.00)",locale:t}," 1 000,00",NaN),s({pattern:"¤ #,###.00;¤ (#,###.00)",locale:t},"1 000,00",1e3),s({pattern:"¤#,###.00;¤(#,###.00)",locale:t}," 1 000,00",NaN),s({pattern:"¤#,###.00;¤(#,###.00)",locale:t},"1 000,00",1e3),e({pattern:"¤ #,###.00;¤ (#,###.00)",locale:t},"1200","1 200,00",!0),e({pattern:"¤#,###.00;¤(#,###.00)",locale:t},"1200","1 200,00",!0),e({pattern:"¤ #,###.00;¤ (#,###.00)",locale:t}," 1200","1 200,00",!0),e({pattern:"¤#,###.00;¤(#,###.00)",locale:t}," 1200 ","1 200,00",!0)}},"ICU4J Regressions":function(){e({pattern:"#0.#",locale:"en-us"},-.09,"-0.1",!1),e({places:0},0,"0",!1),e({places:0},.1,"0",!1),s({pattern:"#0.#####",locale:"en-us"},123.55456,123.55456),e({pattern:"#.#"},0,"0",!1),s({locale:"en-us"},"99.99",99.99),e({pattern:"#.#"},0,"0",!1),e({places:0},123,"123",!1),e({locale:"en-us"},-0,"0",!1),e({locale:"en-us",places:6},-1e-4,"-0.000100",!1);var t="###.00;(###.00)",r={pattern:t,locale:"fr"};e(r,1234,"1234,00",!1),e(r,-1234,"(1234,00)",!1),e(r={pattern:t="#,###.00;(#,###.00)",locale:"fr"},1234,"1 234,00",!1),e(r,-1234,"(1 234,00)",!1);for(var a=["#0000","#000","#00","#0","#"],l=["0042","042","42","42","42"],u=0;u<a.length;u++)e({pattern:a[u]},42,l[u],!1),e({pattern:a[u]},-42,"-"+l[u],!1);e({pattern:"#,#00.00;-#.#",locale:"en-us"},3456.78,"3,456.78",!1),s({pattern:"#,#00.00"},"abc3",NaN),s(null,"hello: ,.#$@^&**10x",NaN),e({pattern:"000.00",locale:"en-us"},12.34,"012.34",!1),e({pattern:"+000.00%;-000.00%",locale:"en-us"},.1234,"+012.34%",!1),e({pattern:"##,###,###.00",locale:"en-us"},9.02,"9.02",!1);for(a=["#.00","0.00","00.00","#0.0#","#0.00"],l=["1.20","1.20","01.20","1.2","1.20"],u=0;u<a.length;u++)e({pattern:a[u],locale:"en-us"},1.2,l[u],!1)}})});