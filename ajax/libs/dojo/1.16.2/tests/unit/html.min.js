define(["intern!object","intern/chai!assert","sinon","../../html","../../parser","../../_base/kernel","dojo/_base/declare","dojo/Deferred","dojo/dom-construct","dojo/query","dojo/_base/array","dojo/text!./support/html.template.html"],function(t,o,e,r,a,s,c,l,u,f,h,p){function m(t){window[t]=void 0;try{delete window[t]}catch(t){}}t(function(){var i,n;function t(t,e){return"string"==typeof t&&(t=f(t,i)[0]),r.set(t,e),o.strictEqual(t.innerHTML.replace(/(<[a-z]*[^>]*>)\s*/gi,"$1"),e),t}return{name:"dojo/html",before:function(){c("SimpleThing",null,{constructor:function(t,e){e.setAttribute("test","ok")}})},beforeEach:function(){i=u.place(p,document.body)},afterEach:function(){document.body.removeChild(i),i=null,m("ifrs"),m("id00"),m("id01")},after:function(){m("SimpleThing")},".set":{"basic usage":function(){t(i,"expected")},"numeric value":function(){r.set(i,1.618),o.strictEqual(i.innerHTML,1.618.toString())},"attach onEnd handler":function(){var t=e.stub();r.set(i,"expected",{onEnd:t}),o.isTrue(t.calledOnce)},"parseContent: true":function(){var t=new l,e="<div data-"+s._scopeName+'-type="SimpleThing" data-'+s._scopeName+'-id="ifrs" data="{}"></div>',n={parseContent:!0,postscript:function(){this.set(),o.isDefined(ifrs),o.strictEqual(ifrs.declaredClass,"SimpleThing"),o.lengthOf(this.parseResults,1),t.resolve()}};return r.set(i,e,n),t},"change content of tr in thead":function(){t("#tableTest > thead > tr","<td><div>This</div>Should<u>Work</u></td>")},"change content of th in thead":function(){t("#tableTest > thead","<tr><td><div>This</div>Should<u>Work</u></td></tr>")},"change content of tr in tbody":function(){t("#tableTest > tbody > tr","<td><div>This</div>Should<u>Work</u></td>")},"change content of tbody":function(){t("#tableTest > tbody","<tr><td><div>This</div>Should<u>Work</u></td></tr>")},"change content of table":function(){t("#tableTest","<tbody><tr><td><div>This</div>Should<u>Work</u></td></tr></tbody>")},"basic NodeList":function(){var t=u.create("ul");u.create("li",{innerHTML:"item 1"},t),u.create("li",{innerHTML:"item 2"},t),r.set(i,t.childNodes),o.lengthOf(f("li",i),2)},"mixed content":function(){t(i,"<h4>See Jane</h4>Look at her <span>Run</span>!")},"extractContent: true":function(){r.set(i,'<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"><html>\t\t\t\t\t\t\t\t\t\t\t\t<head>\t\t\t\t\t\t\t\t\t\t\t\t<title>\t\t\t\t\t\t\t\t\t\t\t\tthe title\t\t\t\t\t\t\t\t\t</title>\t\t\t\t\t\t\t\t\t</head>\t\t\t\t\t\t\t\t\t\t\t<body>\t\t\t\t\t\t\t\t\t\t\t\t<p>\t\t\t\t\t\t\t\t\t\t\t\t\tThis is the <b>Good Stuff</b><br>\t\t\t</p>\t\t\t\t\t\t\t\t\t\t</body>\t\t\t\t\t\t\t\t\t\t</html>\t\t\t\t\t\t\t\t\t\t',{extractContent:!0}),o.strictEqual(i.innerHTML.indexOf("title"),-1),o.lengthOf(f("*",i),3)},inheritance:{beforeEach:function(){n=e.spy(a,"parse")},afterEach:function(){n.restore(),delete window.ifrs},"dir, lang, textDir are not specified":function(){var t=d({parseContent:!0});o.isTrue(n.called),o.isUndefined(t.dir,"dir should not exist"),o.isUndefined(t.lang,"lang should not exist"),o.isUndefined(t.textDir,"textDir should not exist")},"dir, lang, textDir are specified":function(){var t={parseContent:!0,dir:"expectedDir",lang:"expectedLang",textDir:"expectedTextDir"},e=d(t);o.isTrue(n.called),o.strictEqual(e.dir,t.dir),o.strictEqual(e.lang,t.lang),o.strictEqual(e.textDir,t.textDir)}},_emptyNode:function(){i.innerHTML="<div><span>just</span>some test<br/></div>text",r._emptyNode(i),o.lengthOf(i.childNodes,0),o.strictEqual(i.innerHTML,"")},_ContentSetter:function(){var t=[["simple"],["<div data-"+s._scopeName+'-type="SimpleThing" data-'+s._scopeName+'-id="id00">parsed content</div>',{parseContent:!0}],["<div data-"+s._scopeName+'-type="SimpleThing" data-'+s._scopeName+'-id="id01">parsed content</div>',{parseContent:!0}]],e=new r._ContentSetter({node:i});h.forEach(t,function(t){e.node=i,e.set.apply(e,t),e.tearDown()}),o.isDefined(id00),o.isDefined(id01),o.isUndefined(e.parseResults)}}};function d(t){return r.set(i,'<div data-dojo-testing-type="SimpleThing" data-dojo-testing-id="ifrs" data="{}"></div>',t),n.lastCall.args[0].inherited}})});