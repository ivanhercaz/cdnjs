define(["intern!object","intern/chai!assert","sinon","../../NodeList","../../dom-attr","../../dom-construct","../../query","../../NodeList-manipulate","../../NodeList-traverse"],function(e,s,c,d,o,u,a){function r(e,t,n){n=n||"verify";for(var a,r=0;a=e[r];r++)s.isTrue(a.id==t[r]||a==t[r],n+" "+r);s.equal(r,t.length,n+" length")}var t,n;e({name:"dojo/NodeList-manipulate",_placeMultiple:{"returns original node list":function(){var e=new d,t=e._placeMultiple(document.createElement("div"),"last");s.strictEqual(t,e)},"string + string calls dojo/dom-construct::place with correct arguments":function(){var e=[document.createElement("input"),document.createElement("input")],t=new d(e),n=[document.createElement("span"),document.createElement("span")],a=document.createElement("div"),r=c.spy(u,"place"),l="last";for(var o in e)e[o].className="class"+o;for(var o in n)a.appendChild(n[o]);document.body.appendChild(a),t._placeMultiple("span",l),s.deepEqual(r.args[0],[e[1],n[0],l]),s.equal(e[1].previousSibling,e[0]),s.notEqual(r.args[1][0],e[1]),s.equal(r.args[1][0].outerHTML,e[1].outerHTML),s.notEqual(n[1].children[1],e[1]),s.equal(n[1].children[1].outerHTML,e[1].outerHTML),r.restore()},"Node + string calls dojo/dom-construct::place with correct arguments":function(){var e=[document.createElement("input"),document.createElement("input")],t=new d(e),n=document.createElement("span"),a=document.createElement("div"),r=c.spy(u,"place"),l="last";for(var o in e)e[o].className="class"+o;a.appendChild(n),document.body.appendChild(a),t._placeMultiple(n,l),s.deepEqual(r.args[0],[e[1],n,l]),s.equal(e[1].previousSibling,e[0]),r.restore()},"NodeList + string calls dojo/dom-construct::place with correct arguments":function(){var e=[document.createElement("input"),document.createElement("input")],t=new d(e),n=[document.createElement("span"),document.createElement("span")],a=new d(n),r=document.createElement("div"),l=c.spy(u,"place"),o="last";for(var i in e)e[i].className="class"+i;for(var i in n)r.appendChild(n[i]);document.body.appendChild(r),t._placeMultiple(a,o),s.deepEqual(l.args[0],[e[1],n[0],o]),s.equal(e[1].previousSibling,e[0]),s.notEqual(l.args[1][0],e[1]),s.equal(l.args[1][0].outerHTML,e[1].outerHTML),s.notEqual(n[1].children[1],e[1]),s.equal(n[1].children[1].outerHTML,e[1].outerHTML),l.restore()}},"innerHTML()":{"when argument present => delegate to addContent":function(){var e=new d(["bar","baz"]),t=c.stub(e,"addContent").returns("foo"),n=e.innerHTML("bar");s.equal(n,"foo"),s.deepEqual(t.args[0],["bar","only"]),t.restore()},"when no argument, return first nodes innerHTML":function(){var e=document.createElement("div"),t=document.createElement("div"),n="the expected result",a=new d([e,t]);e.innerHTML=n,t="this is not the expected content";var r=a.innerHTML();s.equal(r,n)}},"text()":{"string => attr.set":function(){var e=[document.createElement("div"),document.createElement("div")],t=new d(e),n="the expected content",a=c.spy(o,"set"),r=t.text(n);for(var l in e)s.deepEqual(a.args[l],[e[l],"textContent",n]);s.equal(r,t),a.restore()},"no args => attr.get":function(){var e=[document.createElement("div"),document.createElement("div")],t=new d(e),n=["the first expected content","the second expected content"],a=c.stub(o,"get");for(var r in e)a.withArgs(e[r]).returns(n[r]);var l=t.text();for(var r in s.equal(l,n[0]+n[1]),e)s.deepEqual(a.args[r],[e[r],"textContent"]);a.restore()}},"val()":{"empty nodelist::val() = undefined":function(){var e=(new d).val();s.isUndefined(e)},"nodeList([<select/>, ...]);:val() = value of first element":function(){var e="the value",t=document.createElement("select"),n=document.createElement("input"),a=document.createElement("option"),r=document.createElement("option"),l=new d([t,n]);a.value="not the expected value",r.value=e,t.add(a),t.add(r),r.selected=!0;var o=l.val();s.equal(o,e)},"nodeList([<select multiple/>, ...])::val() = array of selected options":function(){var e=["blue","yellow"],t=document.createElement("select"),n=document.createElement("option"),a=document.createElement("option"),r=document.createElement("option"),l=new d([t]);t.multiple=!0,n.value="red",a.value=e[0],r.value=e[1],t.add(a),t.add(n),t.add(r),a.selected=!0,r.selected=!0;var o=l.val();s.deepEqual(o,e)},"nodeList([<input/>, <input/>])::val(string) => sets the value of the input elements":function(){var e="the value",t=[document.createElement("input"),document.createElement("input")],n=new d(t);for(var a in t)t[a].value="the old value";var r=n.val(e);for(var a in t)s.equal(e,t[a].value);s.equal(r,n)},"nodeList([<input/>, <input/>])::val(array) => sets the value of the input elements":function(){var e=["the first value","the second value"],t=[document.createElement("input"),document.createElement("input")],n=new d(t);for(var a in t)t[a].value="the old value";var r=n.val(e);for(var a in t)s.equal(e[a],t[a].value);s.equal(r,n)},"nodeList([<select/>])::val(string) => sets correct options to selected":function(){var e="the value",t=document.createElement("select"),n=document.createElement("option"),a=document.createElement("option"),r=new d([t]);n.value="not the expected value",a.value=e,t.add(n),t.add(a);var l=r.val(e);s.isTrue(a.selected),s.isFalse(n.selected),s.equal(l,r)},"nodeList([<input type='checkbox'/>, <input type='checkbox'/>])::val(string) => selects correct elements":function(){var e="the value",t=document.createElement("input"),n=document.createElement("input"),a=[n,t],r=new d(a);for(var l in a)a[l].type="checkbox";t.value=e,n.value="not expected value",t.checked=!1,n.checked=!0;var o=r.val(e);s.isTrue(t.checked),s.isFalse(n.checked),s.equal(o,r)},"nodeList([<input type='radio'/>])::val(string) => selects correct elements":function(){var e="the value",t=document.createElement("input"),n=document.createElement("input"),a=[n,t],r=new d(a);for(var l in a)a[l].type="radio",a[l].name="theName"+l;t.value=e,n.value="not expected value",t.checked=!1,n.checked=!0;var o=r.val(e);s.isTrue(t.checked),s.isFalse(n.checked),s.equal(o,r)}},"append()":{"any => this.addContent(any, 'last')":function(){var e={foo:"bar"},t="the result",n=new d,a=c.stub(n,"addContent").returns(t),r=n.append(e);s.deepEqual(a.args[0],[e,"last"]),s.equal(r,t),a.restore()}},"appendTo()":{"string => this._placeMultiple(string, 'last')":function(){var e={foo:"bar"},t="the result",n=new d,a=c.stub(n,"_placeMultiple").returns(t),r=n.appendTo(e);s.deepEqual(a.args[0],[e,"last"]),s.equal(r,t),a.restore()}},"prepend()":{"string => this.prepend(string, 'first')":function(){var e={foo:"bar"},t="the result",n=new d,a=c.stub(n,"addContent").returns(t),r=n.prepend(e);s.deepEqual(a.args[0],[e,"first"]),s.equal(r,t),a.restore()}},"prependTo()":{"string => this._placeMultiple(string, 'first')":function(){var e={foo:"bar"},t="the result",n=new d,a=c.stub(n,"_placeMultiple").returns(t),r=n.prependTo(e);s.deepEqual(a.args[0],[e,"first"]),s.equal(r,t),a.restore()}},"after()":{"string => this.after(string, 'after')":function(){var e={foo:"bar"},t="the result",n=new d,a=c.stub(n,"addContent").returns(t),r=n.after(e);s.deepEqual(a.args[0],[e,"after"]),s.equal(r,t),a.restore()}},"insertAfter()":{"string => this._placeMultiple(string, 'after')":function(){var e={foo:"bar"},t="the result",n=new d,a=c.stub(n,"_placeMultiple").returns(t),r=n.insertAfter(e);s.deepEqual(a.args[0],[e,"after"]),s.equal(r,t),a.restore()}},"before()":{"string => this.after(string, 'before')":function(){var e={foo:"bar"},t="the result",n=new d,a=c.stub(n,"addContent").returns(t),r=n.before(e);s.deepEqual(a.args[0],[e,"before"]),s.equal(r,t),a.restore()}},"insertBefore()":{"string => this._placeMultiple(string, 'before')":function(){var e={foo:"bar"},t="the result",n=new d,a=c.stub(n,"_placeMultiple").returns(t),r=n.insertBefore(e);s.deepEqual(a.args[0],[e,"before"]),s.equal(r,t),a.restore()}},"remove()":{"remove is alias of NodeList.prototype.orphan":function(){var e=new d;s.strictEqual(e.remove,d.prototype.orphan)}},"wrap()":{"returns nodeList":function(){var e=new d,t=e.wrap("<div></div>");s.strictEqual(t,e)},"inserts nodes at the lowest level of the wrapper":function(){var e=document.createElement("input"),t=new d([e]);document.createElement("div").appendChild(e),t.wrap("<div><span><b></b></span></div>"),s.equal(e.parentNode.nodeName.toLowerCase(),"b")},"wraps all nodes in nodelist":function(){var e=[document.createElement("input"),document.createElement("input")],t=new d(e),n=document.createElement("div");for(var a in e)n.appendChild(e[a]);for(var a in t.wrap("<span></span>"),e)s.equal(e[a].parentNode.nodeName.toLowerCase(),"span")}},"wrapAll()":{"returns original nodeList":function(){var e=new d,t=e.wrapAll("<div></div>");s.strictEqual(t,e)},"wraps all nodes in the wrapper as direct children":function(){var e=[document.createElement("input"),document.createElement("input"),document.createElement("input")],t=new d(e),n=[document.createElement("div"),document.createElement("div"),document.createElement("div")];for(var a in e)n[a].appendChild(e[a]);t.wrapAll("<div></div>");var r=e[0].parentElement;for(var a in e)s.strictEqual(r,e[a].parentElement)},"wrapper located in the same location as the first node":function(){var e=[document.createElement("input"),document.createElement("input"),document.createElement("input")],t=new d(e),n=[document.createElement("div"),document.createElement("div"),document.createElement("div")];for(var a in e)n[a].appendChild(e[a]);t.wrapAll("<div></div>");var r=e[0].parentElement;s.strictEqual(r.parentElement,n[0])}},"wrapInner()":{"returns the original node list":function(){var e=new d,t=e.wrapInner("<div></div>");s.strictEqual(t,e)},"wraps the direct children with the wrapper":function(){var e=[document.createElement("input"),document.createElement("input")],t=document.createElement("div"),n=new d(t);for(var a in e)t.appendChild(e[a]);for(var a in n.wrapInner("<span></span>"),e)s.equal(e[a].parentElement.nodeName.toLowerCase(),"span")}},"replaceWith()":{"returns the original node list":function(){var e=new d,t=e.replaceWith("<div></div>");s.strictEqual(t,e)},"content is passed through the _normalize method":function(){var e=[document.createElement("span"),document.createElement("span")],t=new d(e),n=document.createElement("div"),a="<div></div>",r=document.createElement("div"),l=c.stub(t,"_normalize").returns(r);for(var o in e)n.appendChild(e[o]);t.replaceWith(a),s.isTrue(l.calledWith(a,e[0])),l.restore()},"calls _place method with correct arguments":function(){var e=[document.createElement("span"),document.createElement("span")],t=new d(e),n=document.createElement("div"),a="<div></div>",r=(document.createElement("div"),c.stub(t,"_normalize").returns(a)),l=c.stub(t,"_place");for(var o in e)n.appendChild(e[o]);t.replaceWith(a),s.isTrue(l.calledWith(a,e[0],"before",!1)),s.isTrue(l.calledWith(a,e[1],"before",!0)),r.restore(),l.restore()},"removes original nodes":function(){var e=[document.createElement("span"),document.createElement("span")],t=new d(e),n=document.createElement("div"),a="<div></div>",r=(document.createElement("div"),c.stub(t,"_normalize").returns(a)),l=c.stub(t,"_place");for(var o in e)n.appendChild(e[o]);for(var o in t.replaceWith(a),e)s.notEqual(n,e[o].parentElement);r.restore(),l.restore()}},"replaceAll()":{"returns the original node list":function(){var e=new d,t=e.replaceAll("div");s.strictEqual(t,e)},"content is passed through the _normalize method":function(){var e=[document.createElement("span"),document.createElement("span")],t=new d(e),n=document.createElement("div"),a=[document.createElement("div"),document.createElement("div")],r=(new d(a),document.createElement("b")),l=c.stub(t,"_normalize").returns(r),o=c.spy(t,"_place");for(var i in e)n.appendChild(e[i]);for(var i in a)n.appendChild(a[i]);document.body.appendChild(n),t.replaceAll("div div"),s.isTrue(l.calledWith(t,e[0])),l.restore(),o.restore()},"calls _place method with correct arguments":function(){var e=[document.createElement("span"),document.createElement("span")],t=new d(e),n=document.createElement("div"),a=[document.createElement("div"),document.createElement("div")],r=(new d(a),document.createElement("b")),l=c.stub(t,"_normalize").returns(r),o=c.spy(t,"_place");for(var i in e)n.appendChild(e[i]);for(var i in a)n.appendChild(a[i]);document.body.appendChild(n),t.replaceAll("div div"),s.isTrue(o.calledWith(r,a[0],"before",!1)),s.isTrue(o.calledWith(r,a[1],"before",!0)),l.restore(),o.restore()},"removes original nodes":function(){var e=[document.createElement("span"),document.createElement("span")],t=new d(e),n=document.createElement("div"),a=[document.createElement("div"),document.createElement("div")],r=(new d(a),document.createElement("b")),l=c.stub(t,"_normalize").returns(r),o=c.spy(t,"_place");for(var i in e)n.appendChild(e[i]);for(var i in a)n.appendChild(a[i]);document.body.appendChild(n),t.replaceAll("div div"),s.isFalse(n.contains(a[0])),s.isFalse(n.contains(a[1])),l.restore(),o.restore()}},"clone()":{"returns node list populated with clones of originals":function(){var e=[document.createElement("input"),document.createElement("input")],t=new d(e);for(var n in e)e[n].className="nodeClass"+n;var a=t.clone();for(var n in s.notStrictEqual(a,t),e)s.notStrictEqual(a[n],e[n]),s.equal(a[n].outerHTML,e[n].outerHTML)}},"validation tests":{setup:function(){t=u.toDom('<div>    <h1 id="firstH1">testing dojo.NodeList-traverse</h1>    <div id="sq100" class="testDiv">        100px square, abs    </div>    <div id="t" class="testDiv">        <span id="c1">c1</span>    </div>   <div id="third" class="third testDiv">       \x3c!-- This is the third top level div --\x3e       <span id="crass">Crass, baby</span>       The third div       <span id="classy" class="classy">Classy, baby</span>       The third div, again       \x3c!-- Another comment --\x3e       <span id="yeah">Yeah, baby</span>   </div>   <div id="level1" class="foo">       <div id="level2" class="bar">           <div id="level3" class="foo">               <div id="level4" class="bar">                   <div id="level5" class="bar">                       <div id="level6" class="bang">foo bar bar bang</div>                   </div>               </div>           </div>       </div>   </div></div>'),document.body.appendChild(t),n=a("div.testDiv")},teardown:function(){document.body.removeChild(t)},children:function(){r(n.last().children(),["crass","classy","yeah"])},closest:function(){var e=a("#classy").closest("div");r(e,["third"],"closest('div')"),r(e.end().closest(".classy"),["classy"],"closestDiv.end().closest('.classy')");var t=a(".bang"),n=t.closest(".foo > .bar");r(n,["level4"],".foo > .bar"),r(t.closest(".bogus .foo"),[],".bogus .foo"),r(n=t.closest(".foo > .bar","level2"),["level4"],".foo > .bar query relative to level2"),r(t.closest("> .bar","level3"),["level4"],"> .bar query relative to level3"),r(n=t.closest(".foo > .bar","level3"),[],".foo > .bar query relative to level3"),r(a("div").closest(".foo"),["level1","level3"],".foo from div")},parent:function(){r(a("#classy").parent(),["third"])},parents:function(){var e=a("#classy");r(e.parents(),["third",t,document.body,document.body.parentElement]),r(e.parents(".third"),["third"]),r(e.parents("body"),[document.body])},siblings:function(){r(a("#classy").siblings(),["crass","yeah"])},next:function(){r(a("#crass").next(),["classy"])},nextAll:function(){r(a("#crass").nextAll(),["classy","yeah"]),r(a("#crass").nextAll("#yeah"),["yeah"])},prev:function(){r(a("#classy").prev(),["crass"])},prevAll:function(){r(a("#yeah").prevAll(),["classy","crass"]),r(a("#yeah").prevAll("#crass"),["crass"])},andSelf:function(){r(a("#yeah").prevAll().andSelf(),["classy","crass","yeah"])},first:function(){r(n.first(),["sq100"])},last:function(){r(n.last(),["third"])},even:function(){var e=n.even();r(e,["t"]),r(e.end(),["sq100","t","third"])},odd:function(){var e=n.odd();r(e,["sq100","third"]),r(e.end(),["sq100","t","third"])}}})});