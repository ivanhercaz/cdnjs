define(["intern!object","intern/chai!assert","../../../request/iframe","dojo/dom-construct","dojo/dom","dojo/domReady!"],function(e,r,t,a,n){var c;e({name:"dojo/request/iframe",beforeEach:function(){c=a.place('<form id="contentArrayTest" method="get" enctype="multipart/form-data"><input type="hidden" name="size" value="42"/></form>',document.body)},afterEach:function(){a.destroy(c),c=null},".get text":function(){var e=this.async();t.get("/__services/request/iframe",{query:{type:"text"},preventCache:!0}).response.then(e.callback(function(e){r.strictEqual(e.data,"iframe succeeded")}),e.reject)},".post json":function(){var e=this.async();t.post("/__services/request/iframe",{form:"contentArrayTest",query:{type:"json"},data:{color:"blue"},handleAs:"json",preventCache:!0}).then(e.callback(function(e){r.strictEqual(e.query.type,"json"),r.strictEqual(e.payload.color,"blue"),r.strictEqual(e.payload.size,"42")}),e.reject)},".post no form":function(){var e=this.async();t.post("/__services/request/iframe",{query:{type:"json"},data:{color:"blue"},handleAs:"json",preventCache:!0}).then(e.callback(function(e){r.strictEqual(e.query.type,"json"),r.strictEqual(e.payload.color,"blue")}),e.reject)},".get json":function(){var e=this.async();t.get("/__services/request/iframe",{query:{type:"json"},data:{color:"blue"},handleAs:"json",preventCache:!0}).then(e.callback(function(e){r.strictEqual(e.query.type,"json"),r.strictEqual(e.query.color,"blue")}),e.reject)},".get with form":function(){var e=this.async();t.get("/__services/request/iframe",{form:"contentArrayTest",query:{type:"json"},data:{color:"blue"},handleAs:"json",preventCache:!0}).then(e.callback(function(e){r.strictEqual(e.query.type,"json"),r.strictEqual(e.query.color,"blue"),r.strictEqual(e.query.size,"42")}),e.reject)},".get javascript":function(){var e=this.async();t.get("/__services/request/iframe",{query:{type:"javascript"},handleAs:"javascript",preventCache:!0}).then(e.callback(function(){r.strictEqual(window.iframeTestingFunction(),42)}),e.reject)},".get html":function(){var e=this.async();t.get("/__services/request/iframe",{query:{type:"html"},handleAs:"html",preventCache:!0}).then(e.callback(function(e){var t=e.getElementsByTagName("h1")[0];r.strictEqual(t.innerHTML,"SUCCESSFUL HTML response")}),e.reject)},".get xml":function(){var e=this.async();t.get("/__services/request/iframe",{query:{type:"xml"},handleAs:"xml",preventCache:!0}).then(e.callback(function(e){var t=e.documentElement.getElementsByTagName("child");r.strictEqual(t.length,4)}),e.reject)},"data array":function(){var e=this.async();t.post("/__services/request/iframe",{query:{type:"json"},form:"contentArrayTest",data:{tag:["value1","value2"]},handleAs:"json"}).then(e.callback(function(e){r.strictEqual(e.query.type,"json"),r.strictEqual(e.payload.tag,"value2"),r.strictEqual(e.payload.size,"42");var t=n.byId("contentArrayTest");r.ok(t),r.notStrictEqual(t.style.position,"absolute")}),e.reject)},queue:function(){var e=this.async();t.get("/__services/request/iframe",{query:{type:"text",delay:2e3,text:"one"}}).then(e.rejectOnError(function(e){r.strictEqual(e,"one")}),e.reject),t.get("/__services/request/iframe",{query:{type:"text",text:"two"}}).then(e.rejectOnError(function(e){r.strictEqual(e,"two")}),e.reject),t.get("/__services/request/iframe",{query:{type:"text",text:"three"}}).then(e.callback(function(e){r.strictEqual(e,"three")}),e.reject)}})});