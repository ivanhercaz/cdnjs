define(["intern!object","intern/chai!assert","sinon","../../NodeList","../../_base/lang","../../dom-construct","../../query","../../NodeList-traverse"],function(e,l,t,c,n,r,o){function a(e,t,n){n=n||"verify";for(var r,o=0;r=e[o];o++)l.isTrue(t[o]==r.id||t[o]==r,n+" "+o);l.equal(o,t.length,n+" length")}var d,i,s,u,m,p,v,h,f,b,E,y,g,C,q,w,V,L,x,N,A,D,S,T,j,_,H,Y,k,z,B,F,G,I,J,K,M,O,P,Q,R,U,W,X,Z;e({name:"dojo/NodeList-traverse","children()":{"returns children of nodes":function(){var e=[document.createElement("div"),document.createElement("div")],t=[[document.createElement("span"),document.createElement("span")],[document.createElement("input"),document.createElement("input")]],n=t[0].concat(t[1]),r=new c(e);for(var o in e){for(var a in t[o])e[o].appendChild(t[o][a]);document.body.appendChild(e[o])}var d=r.children();for(o=0;o<d.length;o++)l.propertyVal(n,d[o]);for(var o in e)document.body.removeChild(e[o])},"filters children with query, if present":function(){var e=[document.createElement("div"),document.createElement("div")],t=[[document.createElement("span"),document.createElement("span")],[document.createElement("input"),document.createElement("input")]],n=(t[0].concat(t[1]),new c(e));for(var r in e){for(var o in t[r])e[r].appendChild(t[r][o]);document.body.appendChild(e[r])}var a=n.children("span");for(r=0;r<a.length;r++)l.equal(a[r].nodeName.toLowerCase(),"span")}},"closest()":{setup:function(){for(var e in U=document.createElement("div"),W=[document.createElement("span"),document.createElement("span")],X=[[document.createElement("b"),document.createElement("b")],[document.createElement("i"),document.createElement("i")]],Z=new c(X[0].concat(X[1])),document.body.appendChild(U),W)for(var t in U.appendChild(W[e]),X[e])W[e].appendChild(X[e][t])},teardown:function(){document.body.removeChild(U)},"returns closest parent that matches query":function(){var e=Z.closest("span");for(var t in l.equal(e.length,W.length),W)l.propertyVal(e,W[t])},"returns empty NodeList if no parent matches query":function(){var e=Z.closest("h1");l.equal(e.length,0)}},"parent()":{setup:function(){for(var e in Q=document.createElement("div"),M=[document.createElement("h1"),document.createElement("h1")],O=[document.createElement("span"),document.createElement("i")],P=[document.createElement("b"),document.createElement("b")],document.body.appendChild(Q),M)Q.appendChild(M[e]),M[e].appendChild(O[e]),O[e].appendChild(P[e]);R=new c(P)},teardown:function(){document.body.removeChild(Q)},"returns parents of nodes in NodeList":function(){var e=R.parent();for(var t in l.equal(e.length,O.length),O)l.propertyVal(e,O[t])},"filters returned parents by query, if present":function(){var e=R.parent("i");l.equal(e.length,1),l.equal(e[0],O[1])}},"parents()":{setup:function(){for(var e in J=document.createElement("div"),F=[document.createElement("h1"),document.createElement("h1")],G=[document.createElement("span"),document.createElement("i")],I=[document.createElement("b"),document.createElement("b")],document.body.appendChild(J),F)J.appendChild(F[e]),F[e].appendChild(G[e]),G[e].appendChild(I[e]);K=new c(I)},teardown:function(){document.body.removeChild(J)},"returns parents of nodes in NodeList":function(){var e=K.parents();for(var t in l.equal(e.length,G.length+F.length+3),G)l.propertyVal(e,G[t]);for(var t in F)l.propertyVal(e,F[t]);l.propertyVal(e,J),l.propertyVal(e,document.body),l.propertyVal(e,document.body.parentElement)},"filters returned parents by query, if present":function(){var e=K.parents("i");l.equal(e.length,1),l.propertyVal(e[0],G[1])}},"siblings()":{setup:function(){for(var e in z=document.createElement("div"),H=[document.createElement("h1"),document.createElement("h1")],Y=[document.createElement("span"),document.createElement("i")],k=[document.createElement("b"),document.createElement("b")],document.body.appendChild(z),H)z.appendChild(H[e]),H[e].appendChild(k[e]),H[e].appendChild(Y[e]);B=new c(k)},teardown:function(){document.body.removeChild(z)},"returns siblings of nodes in NodeList":function(){var e=B.siblings();for(var t in l.equal(e.length,Y.length),Y)l.propertyVal(e,Y[t]);for(var t in H)l.propertyVal(e,H[t])},"filters returned siblings by query, if present":function(){var e=B.siblings("i");l.equal(e.length,1),l.propertyVal(e[0],Y[1])}},"next()":{setup:function(){for(var e in A=document.createElement("div"),D=[document.createElement("h1"),document.createElement("h1")],S=[document.createElement("span"),document.createElement("span")],T=[document.createElement("i"),document.createElement("b")],j=[document.createElement("button"),document.createElement("button")],document.body.appendChild(A),D)A.appendChild(D[e]),D[e].appendChild(S[e]),D[e].appendChild(T[e]),D[e].appendChild(j[e]);_=new c(S)},teardown:function(){document.body.removeChild(A)},"returns NodeList consisting of next siblings of nodes in this NodeList":function(){var e=_.next();for(var t in l.equal(e.length,T.length),T)l.propertyVal(e,T[t])},"filters returned nodes by query, if provided":function(){var e=_.next("b");l.equal(e.length,1),l.propertyVal(e[0],T[1])}},"nextAll()":{setup:function(){for(var e in q=document.createElement("div"),w=[document.createElement("div"),document.createElement("div")],V=[document.createElement("h1"),document.createElement("h1")],L=[document.createElement("table"),document.createElement("table")],x=[[document.createElement("button"),document.createElement("button")],[document.createElement("b"),document.createElement("b")]],N=new c(L),document.body.appendChild(q),w)for(var t in q.appendChild(w[e]),w[e].appendChild(V[e]),w[e].appendChild(L[e]),x[e])w[e].appendChild(x[e][t]);N=new c(L)},teardown:function(){document.body.removeChild(q)},"returns all siblings after nodes in nodelist":function(){var e=N.nextAll(),t=x[0].concat(x[1]);for(var n in l.equal(e.length,t.length),t)l.propertyVal(e,t[n])},"filters returned values by query, if provided":function(){var e=N.nextAll("button");for(var t in l.equal(e.length,x[0].length),x[0])l.propertyVal(e,x[0][t])}},"prev()":{setup:function(){for(var e in f=document.createElement("div"),b=[document.createElement("h1"),document.createElement("h1")],E=[document.createElement("span"),document.createElement("span")],y=[document.createElement("i"),document.createElement("b")],g=[document.createElement("button"),document.createElement("button")],document.body.appendChild(f),b)f.appendChild(b[e]),b[e].appendChild(g[e]),b[e].appendChild(y[e]),b[e].appendChild(E[e]);C=new c(E)},teardown:function(){document.body.removeChild(f)},"returns NodeList consisting of previous siblings of nodes in this NodeList":function(){var e=C.prev();for(var t in l.equal(e.length,y.length),y)l.propertyVal(e,y[t])},"filters returned nodes by query, if provided":function(){var e=C.prev("b");l.equal(e.length,1),l.propertyVal(e[0],y[1])}},"prevAll()":{setup:function(){for(var e in s=document.createElement("div"),u=[document.createElement("div"),document.createElement("div")],v=[document.createElement("h1"),document.createElement("h1")],p=[document.createElement("table"),document.createElement("table")],m=[[document.createElement("button"),document.createElement("button")],[document.createElement("b"),document.createElement("b")]],h=new c(p),document.body.appendChild(s),u){for(var t in s.appendChild(u[e]),m[e])u[e].appendChild(m[e][t]);u[e].appendChild(p[e]),u[e].appendChild(v[e])}h=new c(p)},teardown:function(){document.body.removeChild(s)},"returns all siblings before nodes in nodelist":function(){var e=h.prevAll(),t=m[0].concat(m[1]);for(var n in l.equal(e.length,t.length),t)l.propertyVal(e,t[n])},"filters returned values by query, if provided":function(){var e=h.prevAll("button");for(var t in l.equal(e.length,m[0].length),m[0])l.propertyVal(e,m[0][t])}},"andSelf()":{"returns concatenation of nodeList's parent to itself":function(){var e=[document.createElement("div"),document.createElement("div")],t=[document.createElement("span"),document.createElement("span")],n=new c(e),r=new c(t);n._parent=r;var o=n.andSelf(),a=e.concat(t);for(var d in l.equal(o.length,a.length),a)l.propertyVal(o,a[d])}},"first()":{"returns first node from the NodeList":function(){var e=document.createElement("div"),t=[document.createElement("span"),document.createElement("button")],n=[e].concat(t),r=new c(n).first();console.dir(r),l.equal(r.length,1),l.equal(r[0],e)}},"last()":{"returns last node from the NodeList":function(){var e=document.createElement("div"),t=[document.createElement("span"),document.createElement("button")].concat([e]),n=new c(t).last();console.dir(n),l.equal(n.length,1),l.equal(n[0],e)}},"even()":{"returns even entries from the nodeList":function(){var e=[document.createElement("div"),document.createElement("div"),document.createElement("div")],t=[document.createElement("div"),document.createElement("div")],n=[];for(var r in e)n.push(e[r]),t[r]&&n.push(t[r]);var o=new c(n).even();for(var r in l.equal(o.length,t.length),t)l.propertyVal(o,t[r])}},"odd()":{"returns odd entries from the nodeList":function(){var e=[document.createElement("div"),document.createElement("div"),document.createElement("div")],t=[document.createElement("div"),document.createElement("div")],n=[];for(var r in e)n.push(e[r]),t[r]&&n.push(t[r]);var o=new c(n).odd();for(var r in l.equal(o.length,e.length),e)l.propertyVal(o,e[r])}},"validation tests":{setup:function(){d=document.createElement("div"),d=r.toDom('<div>    <h1 id="firstH1">testing dojo.NodeList-traverse</h1>    <div id="sq100" class="testDiv">        100px square, abs    </div>    <div id="t" class="testDiv">        <span id="c1">c1</span>    </div>    <div id="third" class="third testDiv">        \x3c!-- This is the third top level div --\x3e        <span id="crass">Crass, baby</span>            The third div            <span id="classy" class="classy">Classy, baby</span>            The third div, again            \x3c!-- Another comment --\x3e        <span id="yeah">Yeah, baby</span>    </div>    <div id="level1" class="foo">        <div id="level2" class="bar">            <div id="level3" class="foo">                <div id="level4" class="bar">                    <div id="level5" class="bar">                        <div id="level6" class="bang">foo bar bar bang</div>                    </div>                </div>            </div>        </div>    </div></div>'),document.body.appendChild(d),i=o("div.testDiv")},teardown:function(){document.body.removeChild(d)},children:function(){a(i.last().children(),["crass","classy","yeah"])},closest:function(){var e=o("#classy").closest("div");a(e,["third"],"closest('div')"),a(e.end().closest(".classy"),["classy"],"closestDiv.end().closest('.classy')");var t=o(".bang"),n=t.closest(".foo > .bar");a(n,["level4"],".foo > .bar"),a(t.closest(".bogus .foo"),[],".bogus .foo"),a(n=t.closest(".foo > .bar","level2"),["level4"],".foo > .bar query relative to level2"),a(t.closest("> .bar","level3"),["level4"],"> .bar query relative to level3"),a(n=t.closest(".foo > .bar","level3"),[],".foo > .bar query relative to level3"),a(o("div").closest(".foo"),["level1","level3"],".foo from div")},parent:function(){a(o("#classy").parent(),["third"])},parents:function(){var e=o("#classy");a(e.parents(),["third",d,document.body,document.body.parentElement]),a(e.parents(".third"),["third"]),a(e.parents("body"),[document.body])},siblings:function(){a(o("#classy").siblings(),["crass","yeah"])},next:function(){a(o("#crass").next(),["classy"])},nextAll:function(){a(o("#crass").nextAll(),["classy","yeah"]),a(o("#crass").nextAll("#yeah"),["yeah"])},prev:function(){a(o("#classy").prev(),["crass"])},prevAll:function(){a(o("#yeah").prevAll(),["classy","crass"]),a(o("#yeah").prevAll("#crass"),["crass"])},andSelf:function(){a(o("#yeah").prevAll().andSelf(),["classy","crass","yeah"])},first:function(){a(i.first(),["sq100"])},last:function(){a(i.last(),["third"])},even:function(){var e=i.even();a(e,["t"]),a(e.end(),["sq100","t","third"])},odd:function(){var e=i.odd();a(e,["sq100","third"]),a(e.end(),["sq100","t","third"])}}})});