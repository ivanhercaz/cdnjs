define(["intern!object","intern/chai!assert","sinon","../../../_base/window","../../../_base/kernel","../../../_base/lang","../../../_base/sniff"],function(e,b,u,m,f,o,n){e({name:"dojo/_base/window","direct delegation":function(){b.equal(f.global,m.global),b.equal(f.global.document,m.doc)},"body()":{undefined:function(){var e=m.body();b.equal(e,f.doc.body)},document:function(){var e=document.createElement("iframe");document.body.appendChild(e);var o=m.body(e.contentDocument);b.equal(o,e.contentDocument.body),document.body.removeChild(e)}},"setContext()":{"object + document":function(){var e={foo:"bar"},o=document.createElement("iframe"),n=f.global,t=f.doc;document.body.appendChild(o);var a=o.contentDocument;m.setContext(e,a),b.equal(a,f.doc),b.equal(a,m.doc),b.equal(e,f.global),b.equal(e,m.global),f.global=m.global=n,f.doc=m.doc=t}},"withGlobal()":{"object + function + object + array":function(){function e(){}var o={document:{foo:"bar"}},n={baz:"buz"},t=[42,27],a=u.spy(m,"withDoc"),c=f.global;m.withGlobal(o,e,n,t),b.isTrue(a.calledWith(o.document,e,n,t)),b.equal(f.global,c),a.restore()}},"withDoc()":{"document + function + object + array":function(){var e,o,n=document.createElement("iframe"),t="expected return",a={baz:"buz"},c=[42,27];f.global;document.body.appendChild(n);var u=n.contentDocument,d=m.withDoc(u,function(){return o=this,e=arguments,t},a,c);for(var l in b.equal(d,t),c)b.equal(e[l],c[l]);b.equal(o,a)},"document + string + object + array":function(){var e,o,n=document.createElement("iframe"),t="expected return",a="theFunction",c={baz:"buz"},u=[42,27],d=f.doc;c[a]=function(){return o=this,e=arguments,t},document.body.appendChild(n);var l=n.contentDocument,r=m.withDoc(l,a,c,u);for(var i in b.equal(r,t),u)b.equal(e[i],u[i]);b.equal(o,c),b.equal(f.doc,d)},"document + function + object":function(){var e,o,n=document.createElement("iframe"),t="expected return",a="theFunction",c={baz:"buz"},u=f.doc;c[a]=function(){return o=this,e=arguments,t},document.body.appendChild(n);var d=n.contentDocument,l=m.withDoc(d,a,c);b.equal(l,t),b.deepEqual(e.length,0),b.equal(o,c),b.equal(f.doc,u)}}})});