define(["exports","intern/dojo/_base/lang","intern/dojo/_base/array","intern/dojo/Deferred","intern/dojo/errors/CancelError","intern/dojo/promise/Promise","intern/dojo/promise/all"],function(i,t,r,c,s,n,o){i.Promise=function(e,r){var n,o=new c(function(e){return n?n(e):new s("canceled")});try{e(t.hitch(o,"resolve"),t.hitch(o,"reject"),t.hitch(o,"progress"),function(e){n=e})}catch(e){o.reject(e)}return r?o:o.promise},i.Promise.reject=function(e){var r=new c;return r.reject(e),r.promise},i.Promise.resolve=function(e){if(e instanceof n)return e;if(e instanceof c)return e.promise;var r=new c;return e&&"function"==typeof e.then?e.then(t.hitch(r,"resolve"),t.hitch(r,"reject"),t.hitch(r,"progress")):r.resolve(e),r.promise},i.map=function(e,n){return o(r.map(e,function(e,r){return i.Promise.resolve(e).then(function(e){return n(e,r)})}))},i.delay=function(e,o){var t=i.Promise.resolve(e);return new i.Promise(function(e,r,n){setTimeout(function(){t.then(e,r,n)},o)})},i.call=function(e){var r=Array.prototype.slice.call(arguments,1);return i.Promise(function(n,o){r.push(function(e,r){e?o(e):n(r)}),e.apply(this,r)})}});