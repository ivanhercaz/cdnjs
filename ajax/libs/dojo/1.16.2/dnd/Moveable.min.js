define(["../_base/array","../_base/declare","../_base/lang","../dom","../dom-class","../Evented","../has","../on","../topic","../touch","./common","./Mover","../_base/window"],function(t,o,e,n,s,i,h,a,d,c,r,l,u){var v,p=function(){};return h("touch-action")&&(p=function(){"touchAction"in document.body.style?v="touchAction":"msTouchAction"in document.body.style&&(v="msTouchAction"),(p=function(t,o){t.style[v]=o})(arguments[0],arguments[1])}),o("dojo.dnd.Moveable",[i],{handle:"",delay:0,skip:!1,constructor:function(t,o){this.node=n.byId(t),p(this.node,"none"),o=o||{},this.handle=o.handle?n.byId(o.handle):null,this.handle||(this.handle=this.node),this.delay=0<o.delay?o.delay:0,this.skip=o.skip,this.mover=o.mover?o.mover:l,this.events=[a(this.handle,c.press,e.hitch(this,"onMouseDown")),a(this.handle,"dragstart",e.hitch(this,"onSelectStart")),a(this.handle,"selectstart",e.hitch(this,"onSelectStart"))]},markupFactory:function(t,o,e){return new e(o,t)},destroy:function(){t.forEach(this.events,function(t){t.remove()}),p(this.node,""),this.events=this.node=this.handle=null},onMouseDown:function(t){this.skip&&r.isFormElement(t)||(this.delay?(this.events.push(a(this.handle,c.move,e.hitch(this,"onMouseMove")),a(this.handle.ownerDocument,c.release,e.hitch(this,"onMouseUp"))),this._lastX=t.pageX,this._lastY=t.pageY):this.onDragDetected(t),t.stopPropagation(),t.preventDefault())},onMouseMove:function(t){(Math.abs(t.pageX-this._lastX)>this.delay||Math.abs(t.pageY-this._lastY)>this.delay)&&(this.onMouseUp(t),this.onDragDetected(t)),t.stopPropagation(),t.preventDefault()},onMouseUp:function(t){for(var o=0;o<2;++o)this.events.pop().remove();t.stopPropagation(),t.preventDefault()},onSelectStart:function(t){this.skip&&r.isFormElement(t)||(t.stopPropagation(),t.preventDefault())},onDragDetected:function(t){new this.mover(this.node,t,this)},onMoveStart:function(t){d.publish("/dnd/move/start",t),s.add(u.body(),"dojoMove"),s.add(this.node,"dojoMoveItem")},onMoveStop:function(t){d.publish("/dnd/move/stop",t),s.remove(u.body(),"dojoMove"),s.remove(this.node,"dojoMoveItem")},onFirstMove:function(){},onMove:function(t,o){this.onMoving(t,o);var e=t.node.style;e.left=o.l+"px",e.top=o.t+"px",this.onMoved(t,o)},onMoving:function(){},onMoved:function(){}})});