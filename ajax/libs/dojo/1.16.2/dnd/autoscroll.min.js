define(["../_base/lang","../sniff","../_base/window","../dom-geometry","../dom-style","../window"],function(o,R,T,s,w,a){var f={};o.setObject("dojo.dnd.autoscroll",f),f.getViewport=a.getBox,f.V_TRIGGER_AUTOSCROLL=32,f.H_TRIGGER_AUTOSCROLL=32,f.V_AUTOSCROLL_VALUE=16,f.H_AUTOSCROLL_VALUE=16;var L,n=T.doc,i=1/0,_=1/0;return f.autoScrollStart=function(o){n=o,L=a.getBox(n);var e=T.body(n).parentNode;i=Math.max(e.scrollHeight-L.h,0),_=Math.max(e.scrollWidth-L.w,0)},f.autoScroll=function(o){var e=L||a.getBox(n),t=T.body(n).parentNode,l=0,r=0;o.clientX<f.H_TRIGGER_AUTOSCROLL?l=-f.H_AUTOSCROLL_VALUE:o.clientX>e.w-f.H_TRIGGER_AUTOSCROLL&&(l=Math.min(f.H_AUTOSCROLL_VALUE,_-t.scrollLeft)),o.clientY<f.V_TRIGGER_AUTOSCROLL?r=-f.V_AUTOSCROLL_VALUE:o.clientY>e.h-f.V_TRIGGER_AUTOSCROLL&&(r=Math.min(f.V_AUTOSCROLL_VALUE,i-t.scrollTop)),window.scrollBy(l,r)},f._validNodes={div:1,p:1,td:1},f._validOverflow={auto:1,scroll:1},f.autoScrollNodes=function(o){for(var e,t,l,r,a,L,n=0,i=0,_=o.target;_;){if(1==_.nodeType&&_.tagName.toLowerCase()in f._validNodes){var O=w.getComputedStyle(_),c=O.overflowX.toLowerCase()in f._validOverflow,d=O.overflowY.toLowerCase()in f._validOverflow;if((c||d)&&(e=s.getContentBox(_,O),t=s.position(_,!0)),c&&(l=Math.min(f.H_TRIGGER_AUTOSCROLL,e.w/2),a=o.pageX-t.x,(R("webkit")||R("opera"))&&(a+=T.body().scrollLeft),(n=0)<a&&a<e.w&&(a<l?n=-l:a>e.w-l&&(n=l),_.scrollLeft,_.scrollLeft=_.scrollLeft+n)),d&&(r=Math.min(f.V_TRIGGER_AUTOSCROLL,e.h/2),L=o.pageY-t.y,(R("webkit")||R("opera"))&&(L+=T.body().scrollTop),(i=0)<L&&L<e.h&&(L<r?i=-r:L>e.h-r&&(i=r),_.scrollTop,_.scrollTop=_.scrollTop+i)),n||i)return}try{_=_.parentNode}catch(o){_=null}}f.autoScroll(o)},f});