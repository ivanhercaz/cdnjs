define(["require","../_base/array","./default!platform","./util"],function(u,f,i,n){var o=[];function l(n,r){for(var t,e=o.slice(0),u=0;t=e[u++];)if(t(n,r))return t.request.apply(null,arguments);return i.apply(null,arguments)}return l.register=function(n,r,t){var e,u,i,l=(e=n,(u=r)?(i=e.test?function(n){return e.test(n)}:e.apply&&e.call?function(){return e.apply(null,arguments)}:function(n){return n===e}).request=u:(i=function(){return!0}).request=e,i);return o[t?"unshift":"push"](l),{remove:function(){var n;~(n=f.indexOf(o,l))&&o.splice(n,1)}}},l.load=function(n,r,t,e){n?u([n],function(n){i=n,t(l)}):t(l)},n.addCommonMethods(l),l});