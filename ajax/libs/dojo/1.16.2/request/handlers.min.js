define(["../json","../_base/kernel","../_base/array","../has","../has!dom?../selector/_loader"],function(n,t,a,o){var e;if(o.add("activex","undefined"!=typeof ActiveXObject),o.add("dom-parser",function(e){return"DOMParser"in e}),o("activex")){var s,u=["Msxml2.DOMDocument.6.0","Msxml2.DOMDocument.4.0","MSXML2.DOMDocument.3.0","MSXML.DOMDocument"];e=function(e){var t=e.data,r=e.text;function n(e){try{var n=new ActiveXObject(e);n.async=!1,n.loadXML(r),t=n,s=e}catch(e){return!1}return!0}return t&&o("dom-qsa2.1")&&!t.querySelectorAll&&o("dom-parser")&&(t=(new DOMParser).parseFromString(r,"application/xml")),t&&t.documentElement||s&&n(s)||a.some(u,n),t}}function r(e){return o("native-xhr2-blob")||"blob"!==e.options.handleAs||"undefined"==typeof Blob?e.xhr.response:new Blob([e.xhr.response],{type:e.xhr.getResponseHeader("Content-Type")})}var c={javascript:function(e){return t.eval(e.text||"")},json:function(e){return n.parse(e.text||null)},xml:e,blob:r,arraybuffer:r,document:r};function i(e){var n=c[e.options.handleAs];return e.data=n?n(e):e.data||e.text,e}return i.register=function(e,n){c[e]=n},i});