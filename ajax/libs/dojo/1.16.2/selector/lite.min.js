define(["../has","../_base/kernel"],function(l,d){"use strict";var e=document.createElement("div"),n=e.matches||e.webkitMatchesSelector||e.mozMatchesSelector||e.msMatchesSelector||e.oMatchesSelector,m=e.querySelectorAll,s=/([^\s,](?:"(?:\\.|[^"])+"|'(?:\\.|[^'])+'|[^,])*)/g;l.add("dom-matches-selector",!!n),l.add("dom-qsa",!!m);var t,c,f,o,g=function(e,r){if(y&&-1<e.indexOf(","))return y(e,r);var t=r?r.ownerDocument||r:d.doc||document,n=(m?/^([\w]*)#([\w\-]+$)|^(\.)([\w\-\*]+$)|^(\w+$)/:/^([\w]*)#([\w\-]+)(?:\s+(.*))?$|(?:^|(>|.+\s+))([\w\-\*]+)(\S*$)/).exec(e);if(r=r||t,n){var o=8===l("ie")&&l("quirks")?r.nodeType===t.nodeType:null!==r.parentNode&&9!==r.nodeType&&r.parentNode===t;if(n[2]&&o){var u;if(!(u=d.byId?d.byId(n[2],t):t.getElementById(n[2]))||n[1]&&n[1]!=u.tagName.toLowerCase())return[];if(r!=t)for(var a=u;a!=r;)if(!(a=a.parentNode))return[];return n[3]?g(n[3],u):[u]}if(n[3]&&r.getElementsByClassName)return r.getElementsByClassName(n[4]);if(n[5]){if(u=r.getElementsByTagName(n[5]),!n[4]&&!n[6])return u;e=(n[4]||"")+n[6]}}if(m)return 1===r.nodeType&&"object"!==r.nodeName.toLowerCase()?v(r,e,r.querySelectorAll):r.querySelectorAll(e);for(var i=[],c=0,f=(u=u||r.getElementsByTagName("*")).length;c<f;c++){var s=u[c];1==s.nodeType&&p(s,e,r)&&i.push(s)}return i},v=function(e,r,t){var n=e,o=e.getAttribute("id"),u=o||"__dojo__",a=e.parentNode,i=/^\s*[+~]/.test(r);if(i&&!a)return[];o?u=u.replace(/'/g,"\\$&"):e.setAttribute("id",u),i&&a&&(e=e.parentNode);for(var c=r.match(s),f=0;f<c.length;f++)c[f]="[id='"+u+"'] "+c[f];r=c.join(",");try{return t.call(e,r)}finally{o||n.removeAttribute("id")}};if(!l("dom-matches-selector"))var p=(t="div"==e.tagName?"toLowerCase":"toUpperCase",c={"":function(r){return r=r[t](),function(e){return e.tagName==r}},".":function(r){var t=" "+r+" ";return function(e){return-1<e.className.indexOf(r)&&-1<(" "+e.className+" ").indexOf(t)}},"#":function(r){return function(e){return e.id==r}}},f={"^=":function(e,r){return 0==e.indexOf(r)},"*=":function(e,r){return-1<e.indexOf(r)},"$=":function(e,r){return e.substring(e.length-r.length,e.length)==r},"~=":function(e,r){return-1<(" "+e+" ").indexOf(" "+r+" ")},"|=":function(e,r){return 0==(e+"-").indexOf(r+"-")},"=":function(e,r){return e==r},"":function(e,r){return!0}},o={},function(e,r,t){var i=o[r];if(!i){if(r.replace(/(?:\s*([> ])\s*)|(#|\.)?((?:\\.|[\w-])+)|\[\s*([\w-]+)\s*(.?=)?\s*("(?:\\.|[^"])+"|'(?:\\.|[^'])+'|(?:\\.|[^\]])*)\s*\]/g,function(e,r,t,n,o,u,a){return n?i=h(i,c[t||""](n.replace(/\\/g,""))):r?i=(" "==r?function(t){return function(e,r){for(;(e=e.parentNode)!=r;)if(t(e,r))return!0}}:function(t){return function(e,r){return e=e.parentNode,t?e!=r&&t(e,r):e==r}})(i):o&&(i=h(i,function(t,n,e){var r=n.charAt(0);'"'!=r&&"'"!=r||(n=n.slice(1,-1)),n=n.replace(/\\/g,"");var o=f[e||""];return function(e){var r=e.getAttribute(t);return r&&o(r,n)}}(o,a,u))),""}))throw new Error("Syntax error in query");if(!i)return!0;o[r]=i}return i(e,t)});function h(t,n){return t?function(e,r){return n(e)&&t(e,r)}:n}if(!l("dom-qsa"))var y=function(e,r){for(var t=e.match(s),n=[],o=0;o<t.length;o++){(e=new String(t[o].replace(/\s*$/,""))).indexOf=escape;for(var u=g(e,r),a=0,i=u.length;a<i;a++){var c=u[a];n[c.sourceIndex]=c}}var f=[];for(o in n)f.push(n[o]);return f};return g.match=n?function(r,e,t){return t&&9!=t.nodeType?v(t,e,function(e){return n.call(r,e)}):n.call(r,e)}:p,g});