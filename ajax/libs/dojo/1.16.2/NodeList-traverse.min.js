define(["./query","./_base/lang","./_base/array"],function(i,n,u){var e=i.NodeList;return n.extend(e,{_buildArrayFromCallback:function(e){for(var t=[],n=0;n<this.length;n++){var r=e.call(this[n],this[n],t);r&&(t=t.concat(r))}return t},_getUniqueAsNodeList:function(e){for(var t,n=[],r=0;t=e[r];r++)1==t.nodeType&&-1==u.indexOf(n,t)&&n.push(t);return this._wrap(n,null,this._NodeListCtor)},_getUniqueNodeListWithParent:function(e,t){var n=this._getUniqueAsNodeList(e);return(n=t?i._filterResult(n,t):n)._stash(this)},_getRelatedUniqueNodes:function(e,t){return this._getUniqueNodeListWithParent(this._buildArrayFromCallback(t),e)},children:function(e){return this._getRelatedUniqueNodes(e,function(e,t){return n._toArray(e.childNodes)})},closest:function(n,r){return this._getRelatedUniqueNodes(null,function(e,t){do{if(i._filterResult([e],n,r).length)return e}while(e!=r&&(e=e.parentNode)&&1==e.nodeType);return null})},parent:function(e){return this._getRelatedUniqueNodes(e,function(e,t){return e.parentNode})},parents:function(e){return this._getRelatedUniqueNodes(e,function(e,t){for(var n=[];e.parentNode;)e=e.parentNode,n.push(e);return n})},siblings:function(e){return this._getRelatedUniqueNodes(e,function(e,t){for(var n=[],r=e.parentNode&&e.parentNode.childNodes,i=0;i<r.length;i++)r[i]!=e&&n.push(r[i]);return n})},next:function(e){return this._getRelatedUniqueNodes(e,function(e,t){for(var n=e.nextSibling;n&&1!=n.nodeType;)n=n.nextSibling;return n})},nextAll:function(e){return this._getRelatedUniqueNodes(e,function(e,t){for(var n=[],r=e;r=r.nextSibling;)1==r.nodeType&&n.push(r);return n})},prev:function(e){return this._getRelatedUniqueNodes(e,function(e,t){for(var n=e.previousSibling;n&&1!=n.nodeType;)n=n.previousSibling;return n})},prevAll:function(e){return this._getRelatedUniqueNodes(e,function(e,t){for(var n=[],r=e;r=r.previousSibling;)1==r.nodeType&&n.push(r);return n})},andSelf:function(){return this.concat(this._parent)},first:function(){return this._wrap(this[0]?[this[0]]:[],this)},last:function(){return this._wrap(this.length?[this[this.length-1]]:[],this)},even:function(){return this.filter(function(e,t){return t%2!=0})},odd:function(){return this.filter(function(e,t){return t%2==0})}}),e});