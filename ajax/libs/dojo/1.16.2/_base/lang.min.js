define(["./kernel","../has","../sniff"],function(u,c){c.add("bug-for-in-skips-shadowed",function(){for(var n in{toString:1})return 0;return 1});function a(n,t,r){r=r||(n[0]&&u.scopeMap[n[0]]?u.scopeMap[n.shift()][1]:u.global);try{for(var i=0;i<n.length;i++){var e=n[i];if(!(e in r)){if(!t)return;r[e]={}}r=r[e]}return r}catch(n){}}function t(n,t,r){return(r||[]).concat(Array.prototype.slice.call(n,t||0))}var s=c("bug-for-in-skips-shadowed")?"hasOwnProperty.valueOf.isPrototypeOf.propertyIsEnumerable.toLocaleString.toString.constructor".split("."):[],f=s.length,r=Object.prototype.toString,i=/\{([^\}]+)\}/g,l={_extraNames:s,_mixin:function(n,t,r){var i,e,o,u={};for(i in t)e=t[i],i in n&&(n[i]===e||i in u&&u[i]===e)||(n[i]=r?r(e):e);if(c("bug-for-in-skips-shadowed")&&t)for(o=0;o<f;++o)e=t[i=s[o]],i in n&&(n[i]===e||i in u&&u[i]===e)||(n[i]=r?r(e):e);return n},mixin:function(n,t){n=n||{};for(var r=1,i=arguments.length;r<i;r++)l._mixin(n,arguments[r]);return n},setObject:function(n,t,r){var i=n.split("."),e=i.pop(),o=a(i,!0,r);return o&&e?o[e]=t:void 0},getObject:function(n,t,r){return n?a(n.split("."),t,r):r},exists:function(n,t){return void 0!==l.getObject(n,!1,t)},isString:function(n){return"string"==typeof n||n instanceof String},isArray:Array.isArray||function(n){return"[object Array]"==r.call(n)},isFunction:function(n){return"[object Function]"===r.call(n)},isObject:function(n){return void 0!==n&&(null===n||"object"==typeof n||l.isArray(n)||l.isFunction(n))},isArrayLike:function(n){return!!n&&!l.isString(n)&&!l.isFunction(n)&&!(n.tagName&&"form"==n.tagName.toLowerCase())&&(l.isArray(n)||isFinite(n.length))},isAlien:function(n){return n&&!l.isFunction(n)&&/\{\s*\[native code\]\s*\}/.test(String(n))},extend:function(n,t){for(var r=1,i=arguments.length;r<i;r++)l._mixin(n.prototype,arguments[r]);return n},_hitchArgs:function(r,i){var e=l._toArray(arguments,2),o=l.isString(i);return function(){var n=l._toArray(arguments),t=o?(r||u.global)[i]:i;return t&&t.apply(r||this,e.concat(n))}},hitch:function(n,t){if(2<arguments.length)return l._hitchArgs.apply(u,arguments);if(t||(t=n,n=null),l.isString(t)){if(!(n=n||u.global)[t])throw['lang.hitch: scope["',t,'"] is null (scope="',n,'")'].join("");return function(){return n[t].apply(n,arguments||[])}}return n?function(){return t.apply(n,arguments||[])}:t},delegate:function(n,t){e.prototype=n;var r=new e;return e.prototype=null,t&&l._mixin(r,t),r},_toArray:c("ie")?function(n){return(n.item?function(n,t,r){for(var i=r||[],e=t||0;e<n.length;e++)i.push(n[e]);return i}:t).apply(this,arguments)}:t,partial:function(n){return l.hitch.apply(u,[null].concat(l._toArray(arguments)))},clone:function(n){if(!n||"object"!=typeof n||l.isFunction(n))return n;if(n.nodeType&&"cloneNode"in n)return n.cloneNode(!0);if(n instanceof Date)return new Date(n.getTime());if(n instanceof RegExp)return new RegExp(n);var t,r,i;if(l.isArray(n))for(t=[],r=0,i=n.length;r<i;++r)r in n&&(t[r]=l.clone(n[r]));else t=n.constructor?new n.constructor:{};return l._mixin(t,n,l.clone)},trim:String.prototype.trim?function(n){return n.trim()}:function(n){return n.replace(/^\s\s*/,"").replace(/\s\s*$/,"")},replace:function(n,r,t){return n.replace(t||i,l.isFunction(r)?r:function(n,t){return l.getObject(t,!1,r)})}};function e(){}return c("extend-dojo")&&l.mixin(u,l),l});