define(["./has","./_base/lang"],function(e,a){var D={getDaysInMonth:function(e){var a=e.getMonth();return 1==a&&D.isLeapYear(e)?29:[31,28,31,30,31,30,31,31,30,31,30,31][a]},isLeapYear:function(e){var a=e.getFullYear();return!(a%400&&(a%4||!(a%100)))},getTimezoneName:function(e){var a,t=e.toString(),r="",n=t.indexOf("(");if(-1<n)r=t.substring(++n,t.indexOf(")"));else{var s=/([A-Z\/]+) \d{4}$/;(a=t.match(s))?r=a[1]:(s=/ ([A-Z\/]+)$/,(a=(t=e.toLocaleString()).match(s))&&(r=a[1]))}return"AM"==r||"PM"==r?"":r},compare:function(e,a,t){return e=new Date(+e),a=new Date(+(a||new Date)),"date"==t?(e.setHours(0,0,0,0),a.setHours(0,0,0,0)):"time"==t&&(e.setFullYear(0,0,0),a.setFullYear(0,0,0)),a<e?1:e<a?-1:0},add:function(e,a,t){var r=new Date(+e),n=!1,s="Date";switch(a){case"day":break;case"weekday":var c,i,o=t%5;i=o?(c=o,parseInt(t/5)):(c=0<t?5:-5,0<t?(t-5)/5:(t+5)/5);var u=e.getDay(),d=0;6==u&&0<t?d=1:0==u&&t<0&&(d=-1);var g=u+c;0!=g&&6!=g||(d=0<t?2:-2),t=7*i+c+d;break;case"year":s="FullYear",n=!0;break;case"week":t*=7;break;case"quarter":t*=3;case"month":n=!0,s="Month";break;default:s="UTC"+a.charAt(0).toUpperCase()+a.substring(1)+"s"}return s&&r["set"+s](r["get"+s]()+t),n&&r.getDate()<e.getDate()&&r.setDate(0),r},difference:function(e,a,t){t=t||"day";var r=(a=a||new Date).getFullYear()-e.getFullYear(),n=1;switch(t){case"quarter":var s=e.getMonth(),c=a.getMonth(),i=Math.floor(s/3)+1,o=Math.floor(c/3)+1;n=(o+=4*r)-i;break;case"weekday":var u=Math.round(D.difference(e,a,"day")),d=parseInt(D.difference(e,a,"week")),g=u%7;if(0==g)u=5*d;else{var f=0,k=e.getDay(),b=a.getDay();d=parseInt(u/7),g=u%7;var h=new Date(e);h.setDate(h.getDate()+7*d);var l=h.getDay();if(0<u)switch(!0){case 6==k:f=-1;break;case 0==k:f=0;break;case 6==b:f=-1;break;case 0==b:f=-2;break;case 5<l+g:f=-2}else if(u<0)switch(!0){case 6==k:f=0;break;case 0==k:f=1;break;case 6==b:f=2;break;case 0==b:f=1;break;case l+g<0:f=2}u+=f,u-=2*d}n=u;break;case"year":n=r;break;case"month":n=a.getMonth()-e.getMonth()+12*r;break;case"week":n=parseInt(D.difference(e,a,"day")/7);break;case"day":n/=24;case"hour":n/=60;case"minute":n/=60;case"second":n/=1e3;case"millisecond":n*=a.getTime()-e.getTime()}return Math.round(n)}};return e("extend-dojo")&&a.mixin(a.getObject("dojo.date",!0),D),D});