define(["./_base/kernel","./_base/Deferred","./_base/array"],function(t,r,c){return t.DeferredList=function(n,f,i,o,e){var a=[];r.call(this);var s=this;0!==n.length||f||this.resolve([0,[]]);var u=0;c.forEach(n,function(e,t){function r(e,r){a[t]=[e,r],++u===n.length&&s.resolve(a)}e.then(function(e){f?s.resolve([t,e]):r(!0,e)},function(e){if(i?s.reject(e):r(!1,e),o)return null;throw e})})},t.DeferredList.prototype=new r,t.DeferredList.prototype.gatherResults=function(e){var r=new t.DeferredList(e,!1,!0,!1);return r.addCallback(function(e){var r=[];return c.forEach(e,function(e){r.push(e[1])}),r}),r},t.DeferredList});