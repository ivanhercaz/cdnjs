function parseBigInt(t,n){return new BigInteger(t,n)}function linebrk(t,n){for(var r="",e=0;e+n<t.length;)r+=t.substring(e,e+n)+"\n",e+=n;return r+t.substring(e,t.length)}function byte2Hex(t){return t<16?"0"+t.toString(16):t.toString(16)}function pkcs1pad2(t,n){if(n<t.length+11)throw"Message too long for RSA";for(var r=new Array,e=t.length-1;0<=e&&0<n;){var i=t.charCodeAt(e--);i<128?r[--n]=i:127<i&&i<2048?(r[--n]=63&i|128,r[--n]=i>>6|192):(r[--n]=63&i|128,r[--n]=i>>6&63|128,r[--n]=i>>12|224)}r[--n]=0;for(var o=new SecureRandom,l=new Array;2<n;){for(l[0]=0;0==l[0];)o.nextBytes(l);r[--n]=l[0]}return r[--n]=2,r[--n]=0,new BigInteger(r)}function oaep_mgf1_arr(t,n,r){for(var e="",i=0;e.length<n;)e+=r(String.fromCharCode.apply(String,t.concat([(4278190080&i)>>24,(16711680&i)>>16,(65280&i)>>8,255&i]))),i+=1;return e}function oaep_pad(t,n,r,e){var i=KJUR.crypto.MessageDigest,o=KJUR.crypto.Util,l=null;if("string"==typeof(r=r||"sha1")&&(l=i.getCanonicalAlgName(r),e=i.getHashLength(l),r=function(t){return hextorstr(o.hashHex(rstrtohex(t),l))}),t.length+2*e+2>n)throw"Message too long for RSA";var u,a="";for(u=0;u<n-t.length-2*e-2;u+=1)a+="\0";var h=r("")+a+""+t,s=new Array(e);(new SecureRandom).nextBytes(s);var g=oaep_mgf1_arr(s,h.length,r),c=[];for(u=0;u<h.length;u+=1)c[u]=h.charCodeAt(u)^g.charCodeAt(u);var p=oaep_mgf1_arr(c,s.length,r),f=[0];for(u=0;u<s.length;u+=1)f[u+1]=s[u]^p.charCodeAt(u);return new BigInteger(f.concat(c))}function RSAKey(){this.n=null,this.e=0,this.d=null,this.p=null,this.q=null,this.dmp1=null,this.dmq1=null,this.coeff=null}function RSASetPublic(t,n){if(this.isPublic=!0,this.isPrivate=!1,"string"!=typeof t)this.n=t,this.e=n;else{if(!(null!=t&&null!=n&&0<t.length&&0<n.length))throw"Invalid RSA public key";this.n=parseBigInt(t,16),this.e=parseInt(n,16)}}function RSADoPublic(t){return t.modPowInt(this.e,this.n)}function RSAEncrypt(t){var n=pkcs1pad2(t,this.n.bitLength()+7>>3);if(null==n)return null;var r=this.doPublic(n);if(null==r)return null;var e=r.toString(16);return 0==(1&e.length)?e:"0"+e}function RSAEncryptOAEP(t,n,r){var e=oaep_pad(t,this.n.bitLength()+7>>3,n,r);if(null==e)return null;var i=this.doPublic(e);if(null==i)return null;var o=i.toString(16);return 0==(1&o.length)?o:"0"+o}RSAKey.prototype.doPublic=RSADoPublic,RSAKey.prototype.setPublic=RSASetPublic,RSAKey.prototype.encrypt=RSAEncrypt,RSAKey.prototype.encryptOAEP=RSAEncryptOAEP,RSAKey.prototype.type="RSA";