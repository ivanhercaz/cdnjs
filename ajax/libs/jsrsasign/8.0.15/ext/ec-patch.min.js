ECFieldElementFp.prototype.getByteLength=function(){return Math.floor((this.toBigInteger().bitLength()+7)/8)},ECPointFp.prototype.getEncoded=function(t){function i(t,i){var e=t.toByteArrayUnsigned();if(i<e.length)e=e.slice(e.length-i);else for(;i>e.length;)e.unshift(0);return e}var e=this.getX().toBigInteger(),r=this.getY().toBigInteger(),n=i(e,32);return t?r.isEven()?n.unshift(2):n.unshift(3):(n.unshift(4),n=n.concat(i(r,32))),n},ECPointFp.decodeFrom=function(t,i){i[0];var e=i.length-1,r=i.slice(1,1+e/2),n=i.slice(1+e/2,1+e);r.unshift(0),n.unshift(0);var o=new BigInteger(r),s=new BigInteger(n);return new ECPointFp(t,t.fromBigInteger(o),t.fromBigInteger(s))},ECPointFp.decodeFromHex=function(t,i){i.substr(0,2);var e=i.length-2,r=i.substr(2,e/2),n=i.substr(2+e/2,e/2),o=new BigInteger(r,16),s=new BigInteger(n,16);return new ECPointFp(t,t.fromBigInteger(o),t.fromBigInteger(s))},ECPointFp.prototype.add2D=function(t){if(this.isInfinity())return t;if(t.isInfinity())return this;if(this.x.equals(t.x))return this.y.equals(t.y)?this.twice():this.curve.getInfinity();var i=t.x.subtract(this.x),e=t.y.subtract(this.y).divide(i),r=e.square().subtract(this.x).subtract(t.x),n=e.multiply(this.x.subtract(r)).subtract(this.y);return new ECPointFp(this.curve,r,n)},ECPointFp.prototype.twice2D=function(){if(this.isInfinity())return this;if(0==this.y.toBigInteger().signum())return this.curve.getInfinity();var t=this.curve.fromBigInteger(BigInteger.valueOf(2)),i=this.curve.fromBigInteger(BigInteger.valueOf(3)),e=this.x.square().multiply(i).add(this.curve.a).divide(this.y.multiply(t)),r=e.square().subtract(this.x.multiply(t)),n=e.multiply(this.x.subtract(r)).subtract(this.y);return new ECPointFp(this.curve,r,n)},ECPointFp.prototype.multiply2D=function(t){if(this.isInfinity())return this;if(0==t.signum())return this.curve.getInfinity();var i,e=t,r=e.multiply(new BigInteger("3")),n=this.negate(),o=this;for(i=r.bitLength()-2;0<i;--i){o=o.twice();var s=r.testBit(i);s!=e.testBit(i)&&(o=o.add2D(s?this:n))}return o},ECPointFp.prototype.isOnCurve=function(){var t=this.getX().toBigInteger(),i=this.getY().toBigInteger(),e=this.curve.getA().toBigInteger(),r=this.curve.getB().toBigInteger(),n=this.curve.getQ(),o=i.multiply(i).mod(n),s=t.multiply(t).multiply(t).add(e.multiply(t)).add(r).mod(n);return o.equals(s)},ECPointFp.prototype.toString=function(){return"("+this.getX().toBigInteger().toString()+","+this.getY().toBigInteger().toString()+")"},ECPointFp.prototype.validate=function(){var t=this.curve.getQ();if(this.isInfinity())throw new Error("Point is at infinity.");var i=this.getX().toBigInteger(),e=this.getY().toBigInteger();if(i.compareTo(BigInteger.ONE)<0||0<i.compareTo(t.subtract(BigInteger.ONE)))throw new Error("x coordinate out of bounds");if(e.compareTo(BigInteger.ONE)<0||0<e.compareTo(t.subtract(BigInteger.ONE)))throw new Error("y coordinate out of bounds");if(!this.isOnCurve())throw new Error("Point is not on the curve.");if(this.multiply(t).isInfinity())throw new Error("Point is not a scalar multiple of G.");return!0};