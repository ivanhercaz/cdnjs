!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("rxjs"),require("@angular/common"),require("@angular/router"),require("rxjs/operators"),require("@angular/core")):"function"==typeof define&&define.amd?define("angulartics2",["exports","rxjs","@angular/common","@angular/router","rxjs/operators","@angular/core"],t):t(e.angulartics2={},e.rxjs,e.ng.common,e.ng.router,e.rxjs.operators,e.ng.core)}(this,function(e,a,t,r,n,i){"use strict";var o=function(){return(o=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};var s=function d(){this.pageTracking={autoTrackVirtualPages:!0,basePath:"",excludedRoutes:[],clearIds:!1,clearHash:!1,clearQueryParams:!1,idsRegExp:/^\d+$|^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/},this.developerMode=!1,this.ga={},this.appInsights={},this.gtm={},this.gst={}},c=new i.InjectionToken("ANGULARTICS2"),u=function(){function e(){}return e.prototype.trackLocation=function(e){return new a.BehaviorSubject({url:"/"})},e.prototype.prepareExternalUrl=function(e){return e},e}(),l=function(){function e(e,t){var r=this;this.tracker=e,this.pageTrack=new a.ReplaySubject(10),this.eventTrack=new a.ReplaySubject(10),this.exceptionTrack=new a.ReplaySubject(10),this.setAlias=new a.ReplaySubject(10),this.setUsername=new a.ReplaySubject(10),this.setUserProperties=new a.ReplaySubject(10),this.setUserPropertiesOnce=new a.ReplaySubject(10),this.setSuperProperties=new a.ReplaySubject(10),this.setSuperPropertiesOnce=new a.ReplaySubject(10),this.userTimings=new a.ReplaySubject(10);var n=new s;this.settings=o({},n,t.settings),this.settings.pageTracking=o({},n.pageTracking,t.settings.pageTracking),this.tracker.trackLocation(this.settings).subscribe(function(e){return r.trackUrlChange(e.url)})}return e.prototype.filterDeveloperMode=function(){var r=this;return n.filter(function(e,t){return!r.settings.developerMode})},e.prototype.trackUrlChange=function(e){if(this.settings.pageTracking.autoTrackVirtualPages&&!this.matchesExcludedRoute(e)){var t=this.clearUrl(e),r=void 0;r=this.settings.pageTracking.basePath.length?this.settings.pageTracking.basePath+t:this.tracker.prepareExternalUrl(t),this.pageTrack.next({path:r})}},e.prototype.matchesExcludedRoute=function(e){var t,r;try{for(var n=function o(e){var t="function"==typeof Symbol&&e[Symbol.iterator],r=0;return t?t.call(e):{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}}}(this.settings.pageTracking.excludedRoutes),a=n.next();!a.done;a=n.next()){var i=a.value;if(i instanceof RegExp&&i.test(e)||-1!==e.indexOf(i))return!0}}catch(s){t={error:s}}finally{try{a&&!a.done&&(r=n["return"])&&r.call(n)}finally{if(t)throw t.error}}return!1},e.prototype.clearUrl=function(e){var t=this;return this.settings.pageTracking.clearIds||this.settings.pageTracking.clearQueryParams||this.settings.pageTracking.clearHash?e.split("/").map(function(e){return t.settings.pageTracking.clearQueryParams?e.split("?")[0]:e}).map(function(e){return t.settings.pageTracking.clearHash?e.split("#")[0]:e}).filter(function(e){return!t.settings.pageTracking.clearIds||!e.match(t.settings.pageTracking.idsRegExp)}).join("/"):e},e.decorators=[{type:i.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:u},{type:undefined,decorators:[{type:i.Inject,args:[c]}]}]},e.ngInjectableDef=i.defineInjectable({factory:function(){return new e(i.inject(u),i.inject(c))},token:e,providedIn:"root"}),e}(),p=function(){function e(e,t){this.router=e,this.location=t}return e.prototype.trackLocation=function(e){return this.router.events.pipe(n.filter(function(e){return e instanceof r.NavigationEnd}),n.filter(function(){return!e.developerMode}),n.map(function(e){return{url:e.urlAfterRedirects}}),n.delay(0))},e.prototype.prepareExternalUrl=function(e){return this.location.prepareExternalUrl(e)},e.decorators=[{type:i.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:r.Router},{type:t.Location}]},e.ngInjectableDef=i.defineInjectable({factory:function(){return new e(i.inject(r.Router),i.inject(t.Location))},token:e,providedIn:"root"}),e}(),g=function(){function e(e,t,r){this.elRef=e,this.angulartics2=t,this.renderer=r,this.angularticsProperties={}}return e.prototype.ngAfterContentInit=function(){var t=this;this.renderer.listen(this.elRef.nativeElement,this.angulartics2On||"click",function(e){return t.eventTrack(e)})},e.prototype.eventTrack=function(e){var t=this.angularticsAction,r=o({},this.angularticsProperties,{eventType:e.type});this.angularticsCategory&&(r.category=this.angularticsCategory),this.angularticsLabel&&(r.label=this.angularticsLabel),this.angularticsValue&&(r.value=this.angularticsValue),this.angulartics2.eventTrack.next({action:t,properties:r})},e.decorators=[{type:i.Directive,args:[{selector:"[angulartics2On]"}]}],e.ctorParameters=function(){return[{type:i.ElementRef},{type:l},{type:i.Renderer2}]},e.propDecorators={angulartics2On:[{type:i.Input,args:["angulartics2On"]}],angularticsAction:[{type:i.Input}],angularticsCategory:[{type:i.Input}],angularticsLabel:[{type:i.Input}],angularticsValue:[{type:i.Input}],angularticsProperties:[{type:i.Input}]},e}(),f=function(){function e(){}return e.decorators=[{type:i.NgModule,args:[{declarations:[g],exports:[g]}]}],e}(),h=function(){function t(){}return t.forRoot=function(e){return void 0===e&&(e={}),{ngModule:t,providers:[{provide:c,useValue:{settings:e}},{provide:u,useClass:p},l]}},t.decorators=[{type:i.NgModule,args:[{imports:[f],exports:[g]}]}],t}();e.Angulartics2=l,e.Angulartics2Module=h,e.ANGULARTICS2_TOKEN=c,e.Angulartics2On=g,e.Angulartics2OnModule=f,e.RouterlessTracking=u,e.AngularRouterTracking=p,e.DefaultConfig=s,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=angulartics2.umd.min.js.map