import{__decorate,__metadata}from"tslib";import{ɵɵdefineInjectable,ɵɵinject,Injectable}from"@angular/core";import{Angulartics2}from"angulartics2";class GoogleTagManagerDefaults{constructor(){this.userId=null}}let Angulartics2GoogleTagManager=class{constructor(e){this.angulartics2=e,"undefined"!=typeof dataLayer&&dataLayer&&(dataLayer=window.dataLayer=window.dataLayer||[]);const a=new GoogleTagManagerDefaults;this.angulartics2.settings.gtm=Object.assign({},a,this.angulartics2.settings.gtm),this.angulartics2.setUsername.subscribe(e=>this.setUsername(e))}startTracking(){this.angulartics2.pageTrack.pipe(this.angulartics2.filterDeveloperMode()).subscribe(e=>this.pageTrack(e.path)),this.angulartics2.eventTrack.pipe(this.angulartics2.filterDeveloperMode()).subscribe(e=>this.eventTrack(e.action,e.properties)),this.angulartics2.exceptionTrack.pipe(this.angulartics2.filterDeveloperMode()).subscribe(e=>this.exceptionTrack(e))}pageTrack(e){this.pushLayer({event:"Page View","content-name":e,userId:this.angulartics2.settings.gtm.userId})}pushLayer(e){"undefined"!=typeof dataLayer&&dataLayer&&dataLayer.push(e)}eventTrack(e,a){a=a||{},this.pushLayer(Object.assign({event:a.event||"interaction",target:a.category||"Event",action:e,label:a.label,value:a.value,interactionType:a.noninteraction,userId:this.angulartics2.settings.gtm.userId},a.gtmCustom))}exceptionTrack(e){e&&e.appId&&e.appName&&e.appVersion?(void 0===e.fatal&&(console.log('No "fatal" provided, sending with fatal=true'),e.exFatal=!0),e.exDescription=e.event?e.event.stack:e.description,this.eventTrack(`Exception thrown for ${e.appName} <${e.appId}@${e.appVersion}>`,{category:"Exception",label:e.exDescription})):console.error("Must be setted appId, appName and appVersion.")}setUsername(e){this.angulartics2.settings.gtm.userId=e}};Angulartics2GoogleTagManager.ngInjectableDef=ɵɵdefineInjectable({factory:function(){return new Angulartics2GoogleTagManager(ɵɵinject(Angulartics2))},token:Angulartics2GoogleTagManager,providedIn:"root"}),Angulartics2GoogleTagManager=__decorate([Injectable({providedIn:"root"}),__metadata("design:paramtypes",[Angulartics2])],Angulartics2GoogleTagManager);export{Angulartics2GoogleTagManager,GoogleTagManagerDefaults};