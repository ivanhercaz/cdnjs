!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("angulartics2")):"function"==typeof define&&define.amd?define("angulartics2/gst",["exports","@angular/core","angulartics2"],e):e((t.angulartics2=t.angulartics2||{},t.angulartics2.gst={}),t.ng.core,t.angulartics2)}(this,function(t,e,n){"use strict";var c=function(){return(c=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)};function u(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}}var i=function s(){var n=this;this.trackingIds=[],"undefined"!=typeof ga&&ga&&ga(function(){ga.getAll().forEach(function(t){var e=t.get("trackingId");e!==undefined&&-1===n.trackingIds.indexOf(e)&&n.trackingIds.push(e)})})},r=function(){function t(t){this.angulartics2=t,this.dimensionsAndMetrics={};var e=new i;this.angulartics2.settings.gst=c({},e,this.angulartics2.settings.gst)}return t.prototype.startTracking=function(){var e=this;this.angulartics2.pageTrack.pipe(this.angulartics2.filterDeveloperMode()).subscribe(function(t){return e.pageTrack(t.path)}),this.angulartics2.eventTrack.pipe(this.angulartics2.filterDeveloperMode()).subscribe(function(t){return e.eventTrack(t.action,t.properties)}),this.angulartics2.exceptionTrack.pipe(this.angulartics2.filterDeveloperMode()).subscribe(function(t){return e.exceptionTrack(t)}),this.angulartics2.userTimings.pipe(this.angulartics2.filterDeveloperMode()).subscribe(function(t){return e.userTimings(e.convertTimings(t))}),this.angulartics2.setUsername.pipe(this.angulartics2.filterDeveloperMode()).subscribe(function(t){return e.setUsername(t)}),this.angulartics2.setUserProperties.pipe(this.angulartics2.filterDeveloperMode()).subscribe(function(t){return e.setUserProperties(t)})},t.prototype.pageTrack=function(t){var e,n;if("undefined"!=typeof gtag&&gtag){var i=c({page_path:t,page_location:window.location.protocol+"//"+window.location.host+t},this.dimensionsAndMetrics);this.angulartics2.settings.gst.customMap&&(i.custom_map=this.angulartics2.settings.gst.customMap),this.angulartics2.settings.gst.userId&&(i.user_id=this.angulartics2.settings.gst.userId),this.angulartics2.settings.gst.anonymizeIp&&(i.anonymize_ip=this.angulartics2.settings.gst.anonymizeIp);try{for(var r=u(this.angulartics2.settings.gst.trackingIds),s=r.next();!s.done;s=r.next()){var a=s.value;gtag("config",a,c({},i))}}catch(o){e={error:o}}finally{try{s&&!s.done&&(n=r["return"])&&n.call(r)}finally{if(e)throw e.error}}}},t.prototype.eventTrack=function(t,e){void 0===e&&(e={}),this.eventTrackInternal(t,c({event_category:e.category||"interaction",event_label:e.label,value:e.value,non_interaction:e.noninteraction},e.gstCustom))},t.prototype.exceptionTrack=function(t){t.fatal===undefined&&(console.log('No "fatal" provided, sending with fatal=true'),t.fatal=!0),t.exDescription=t.event?t.event.stack:t.description,this.eventTrack("exception",{gstCustom:c({description:t.exDescription,fatal:t.fatal},t.gstCustom)})},t.prototype.userTimings=function(t){t?this.eventTrackInternal("timing_complete",{name:t.name,value:t.value,event_category:t.category,event_label:t.label}):console.error('User timings - "properties" parameter is required to be set.')},t.prototype.convertTimings=function(t){return{name:t.timingVar,value:t.timingValue,category:t.timingCategory,label:t.timingLabel}},t.prototype.setUsername=function(t){var e,n;if(this.angulartics2.settings.gst.userId=t,"undefined"!=typeof gtag&&gtag)try{for(var i=u(this.angulartics2.settings.gst.trackingIds),r=i.next();!r.done;r=i.next()){var s=r.value;gtag("set",s,{user_id:"string"==typeof t?t:t.userId})}}catch(a){e={error:a}}finally{try{r&&!r.done&&(n=i["return"])&&n.call(i)}finally{if(e)throw e.error}}},t.prototype.setUserProperties=function(t){this.setDimensionsAndMetrics(t)},t.prototype.setDimensionsAndMetrics=function(t){var e,n,i=this;if(this.dimensionsAndMetrics=c({},this.dimensionsAndMetrics,t),Object.keys(this.dimensionsAndMetrics).forEach(function(t){var e=i.dimensionsAndMetrics[t];e!==undefined&&null!==e||delete i.dimensionsAndMetrics[t]}),"undefined"!=typeof gtag&&gtag)try{for(var r=u(this.angulartics2.settings.gst.trackingIds),s=r.next();!s.done;s=r.next()){var a=s.value;gtag("set",a,this.dimensionsAndMetrics)}}catch(o){e={error:o}}finally{try{s&&!s.done&&(n=r["return"])&&n.call(r)}finally{if(e)throw e.error}}},t.prototype.eventTrackInternal=function(t,e){void 0===e&&(e={}),this.cleanProperties(e),"undefined"!=typeof gtag&&gtag&&gtag("event",t,e)},t.prototype.cleanProperties=function(t){if(t.value){var e=parseInt(t.value,10);t.value=isNaN(e)?0:e}},t.decorators=[{type:e.Injectable,args:[{providedIn:"root"}]}],t.ctorParameters=function(){return[{type:n.Angulartics2}]},t.ngInjectableDef=e.defineInjectable({factory:function(){return new t(e.inject(n.Angulartics2))},token:t,providedIn:"root"}),t}();t.GoogleGlobalSiteTagDefaults=i,t.Angulartics2GoogleGlobalSiteTag=r,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=angulartics2-gst.umd.min.js.map