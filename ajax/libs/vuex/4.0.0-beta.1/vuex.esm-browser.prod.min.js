import{inject,watch,reactive,computed}from"vue";const storeKey="store";function useStore(t=null){return inject(null!==t?t:storeKey)}const target="undefined"!=typeof window?window:"undefined"!=typeof global?global:{},devtoolHook=target.__VUE_DEVTOOLS_GLOBAL_HOOK__;function devtoolPlugin(t){devtoolHook&&(t._devtoolHook=devtoolHook,devtoolHook.emit("vuex:init",t),devtoolHook.on("vuex:travel-to-state",e=>{t.replaceState(e)}),t.subscribe((t,e)=>{devtoolHook.emit("vuex:mutation",t,e)},{prepend:!0}),t.subscribeAction((t,e)=>{devtoolHook.emit("vuex:action",t,e)},{prepend:!0}))}function forEachValue(t,e){Object.keys(t).forEach(s=>e(t[s],s))}function isObject(t){return null!==t&&"object"==typeof t}function isPromise(t){return t&&"function"==typeof t.then}function assert(t,e){if(!t)throw new Error(`[vuex] ${e}`)}function partial(t,e){return function(){return t(e)}}class Module{constructor(t,e){this.runtime=e,this._children=Object.create(null),this._rawModule=t;const s=t.state;this.state=("function"==typeof s?s():s)||{}}get namespaced(){return!!this._rawModule.namespaced}addChild(t,e){this._children[t]=e}removeChild(t){delete this._children[t]}getChild(t){return this._children[t]}hasChild(t){return t in this._children}update(t){this._rawModule.namespaced=t.namespaced,t.actions&&(this._rawModule.actions=t.actions),t.mutations&&(this._rawModule.mutations=t.mutations),t.getters&&(this._rawModule.getters=t.getters)}forEachChild(t){forEachValue(this._children,t)}forEachGetter(t){this._rawModule.getters&&forEachValue(this._rawModule.getters,t)}forEachAction(t){this._rawModule.actions&&forEachValue(this._rawModule.actions,t)}forEachMutation(t){this._rawModule.mutations&&forEachValue(this._rawModule.mutations,t)}}class ModuleCollection{constructor(t){this.register([],t,!1)}get(t){return t.reduce((t,e)=>t.getChild(e),this.root)}getNamespace(t){let e=this.root;return t.reduce((t,s)=>t+((e=e.getChild(s)).namespaced?s+"/":""),"")}update(t){update([],this.root,t)}register(t,e,s=!0){const o=new Module(e,s);if(0===t.length)this.root=o;else{this.get(t.slice(0,-1)).addChild(t[t.length-1],o)}e.modules&&forEachValue(e.modules,(e,o)=>{this.register(t.concat(o),e,s)})}unregister(t){const e=this.get(t.slice(0,-1)),s=t[t.length-1];e.getChild(s).runtime&&e.removeChild(s)}isRegistered(t){const e=this.get(t.slice(0,-1)),s=t[t.length-1];return e.hasChild(s)}}function update(t,e,s){if(e.update(s),s.modules)for(const o in s.modules){if(!e.getChild(o))return;update(t.concat(o),e.getChild(o),s.modules[o])}}function createStore(t){return new Store(t)}class Store{constructor(t={}){"production"!==process.env.NODE_ENV&&(assert("undefined"!=typeof Promise,"vuex requires a Promise polyfill in this browser."),assert(this instanceof Store,"store must be called with the new operator."));const{plugins:e=[],strict:s=!1}=t;this._committing=!1,this._actions=Object.create(null),this._actionSubscribers=[],this._mutations=Object.create(null),this._wrappedGetters=Object.create(null),this._modules=new ModuleCollection(t),this._modulesNamespaceMap=Object.create(null),this._subscribers=[],this._makeLocalGettersCache=Object.create(null);const o=this,{dispatch:r,commit:i}=this;this.dispatch=function(t,e){return r.call(o,t,e)},this.commit=function(t,e,s){return i.call(o,t,e,s)},this.strict=s;const a=this._modules.root.state;installModule(this,a,[],this._modules.root),resetStoreState(this,a),e.forEach(t=>t(this)),(void 0===t.devtools||t.devtools)&&devtoolPlugin(this)}install(t,e){t.provide(e||storeKey,this),t.config.globalProperties.$store=this}get state(){return this._state.data}set state(t){}commit(t,e,s){const{type:o,payload:r,options:i}=unifyObjectStyle(t,e,s),a={type:o,payload:r},n=this._mutations[o];n&&(this._withCommit(()=>{n.forEach(function(t){t(r)})}),this._subscribers.slice().forEach(t=>t(a,this.state)))}dispatch(t,e){const{type:s,payload:o}=unifyObjectStyle(t,e),r={type:s,payload:o},i=this._actions[s];if(i){try{this._actionSubscribers.slice().filter(t=>t.before).forEach(t=>t.before(r,this.state))}catch(t){}return(i.length>1?Promise.all(i.map(t=>t(o))):i[0](o)).then(t=>{try{this._actionSubscribers.filter(t=>t.after).forEach(t=>t.after(r,this.state))}catch(t){}return t})}}subscribe(t,e){return genericSubscribe(t,this._subscribers,e)}subscribeAction(t,e){return genericSubscribe("function"==typeof t?{before:t}:t,this._actionSubscribers,e)}watch(t,e,s){return watch(()=>t(this.state,this.getters),e,Object.assign({},s))}replaceState(t){this._withCommit(()=>{this._state.data=t})}registerModule(t,e,s={}){"string"==typeof t&&(t=[t]),this._modules.register(t,e),installModule(this,this.state,t,this._modules.get(t),s.preserveState),resetStoreState(this,this.state)}unregisterModule(t){"string"==typeof t&&(t=[t]),this._modules.unregister(t),this._withCommit(()=>{delete getNestedState(this.state,t.slice(0,-1))[t[t.length-1]]}),resetStore(this)}hasModule(t){return"string"==typeof t&&(t=[t]),"production"!==process.env.NODE_ENV&&assert(Array.isArray(t),"module path must be a string or an Array."),this._modules.isRegistered(t)}hotUpdate(t){this._modules.update(t),resetStore(this,!0)}_withCommit(t){const e=this._committing;this._committing=!0,t(),this._committing=e}}function genericSubscribe(t,e,s){return e.indexOf(t)<0&&(s&&s.prepend?e.unshift(t):e.push(t)),()=>{const s=e.indexOf(t);s>-1&&e.splice(s,1)}}function resetStore(t,e){t._actions=Object.create(null),t._mutations=Object.create(null),t._wrappedGetters=Object.create(null),t._modulesNamespaceMap=Object.create(null);const s=t.state;installModule(t,s,[],t._modules.root,!0),resetStoreState(t,s,e)}function resetStoreState(t,e,s){const o=t._state;t.getters={},t._makeLocalGettersCache=Object.create(null);const r=t._wrappedGetters,i={};forEachValue(r,(e,s)=>{i[s]=partial(e,t),Object.defineProperty(t.getters,s,{get:()=>computed(()=>i[s]()).value,enumerable:!0})}),t._state=reactive({data:e}),t.strict&&enableStrictMode(t),o&&s&&t._withCommit(()=>{o.data=null})}function installModule(t,e,s,o,r){const i=!s.length,a=t._modules.getNamespace(s);if(o.namespaced&&(t._modulesNamespaceMap[a],t._modulesNamespaceMap[a]=o),!i&&!r){const r=getNestedState(e,s.slice(0,-1)),i=s[s.length-1];t._withCommit(()=>{r[i]=o.state})}const n=o.context=makeLocalContext(t,a,s);o.forEachMutation((e,s)=>{registerMutation(t,a+s,e,n)}),o.forEachAction((e,s)=>{const o=e.root?s:a+s,r=e.handler||e;registerAction(t,o,r,n)}),o.forEachGetter((e,s)=>{registerGetter(t,a+s,e,n)}),o.forEachChild((o,i)=>{installModule(t,e,s.concat(i),o,r)})}function makeLocalContext(t,e,s){const o=""===e,r={dispatch:o?t.dispatch:(s,o,r)=>{const i=unifyObjectStyle(s,o,r),{payload:a,options:n}=i;let{type:c}=i;return n&&n.root||(c=e+c),t.dispatch(c,a)},commit:o?t.commit:(s,o,r)=>{const i=unifyObjectStyle(s,o,r),{payload:a,options:n}=i;let{type:c}=i;n&&n.root||(c=e+c),t.commit(c,a,n)}};return Object.defineProperties(r,{getters:{get:o?()=>t.getters:()=>makeLocalGetters(t,e)},state:{get:()=>getNestedState(t.state,s)}}),r}function makeLocalGetters(t,e){if(!t._makeLocalGettersCache[e]){const s={},o=e.length;Object.keys(t.getters).forEach(r=>{if(r.slice(0,o)!==e)return;const i=r.slice(o);Object.defineProperty(s,i,{get:()=>t.getters[r],enumerable:!0})}),t._makeLocalGettersCache[e]=s}return t._makeLocalGettersCache[e]}function registerMutation(t,e,s,o){(t._mutations[e]||(t._mutations[e]=[])).push(function(e){s.call(t,o.state,e)})}function registerAction(t,e,s,o){(t._actions[e]||(t._actions[e]=[])).push(function(e){let r=s.call(t,{dispatch:o.dispatch,commit:o.commit,getters:o.getters,state:o.state,rootGetters:t.getters,rootState:t.state},e);return isPromise(r)||(r=Promise.resolve(r)),t._devtoolHook?r.catch(e=>{throw t._devtoolHook.emit("vuex:error",e),e}):r})}function registerGetter(t,e,s,o){t._wrappedGetters[e]||(t._wrappedGetters[e]=function(t){return s(o.state,o.getters,t.state,t.getters)})}function enableStrictMode(t){watch(()=>t._state.data,()=>{},{deep:!0,flush:"sync"})}function getNestedState(t,e){return e.reduce((t,e)=>t[e],t)}function unifyObjectStyle(t,e,s){return isObject(t)&&t.type&&(s=e,e=t,t=t.type),{type:t,payload:e,options:s}}const mapState=normalizeNamespace((t,e)=>{const s={};return normalizeMap(e).forEach(({key:e,val:o})=>{s[e]=function(){let e=this.$store.state,s=this.$store.getters;if(t){const o=getModuleByNamespace(this.$store,"mapState",t);if(!o)return;e=o.context.state,s=o.context.getters}return"function"==typeof o?o.call(this,e,s):e[o]},s[e].vuex=!0}),s}),mapMutations=normalizeNamespace((t,e)=>{const s={};return normalizeMap(e).forEach(({key:e,val:o})=>{s[e]=function(...e){let s=this.$store.commit;if(t){const e=getModuleByNamespace(this.$store,"mapMutations",t);if(!e)return;s=e.context.commit}return"function"==typeof o?o.apply(this,[s].concat(e)):s.apply(this.$store,[o].concat(e))}}),s}),mapGetters=normalizeNamespace((t,e)=>{const s={};return normalizeMap(e).forEach(({key:e,val:o})=>{o=t+o,s[e]=function(){if(!t||getModuleByNamespace(this.$store,"mapGetters",t))return this.$store.getters[o]},s[e].vuex=!0}),s}),mapActions=normalizeNamespace((t,e)=>{const s={};return normalizeMap(e).forEach(({key:e,val:o})=>{s[e]=function(...e){let s=this.$store.dispatch;if(t){const e=getModuleByNamespace(this.$store,"mapActions",t);if(!e)return;s=e.context.dispatch}return"function"==typeof o?o.apply(this,[s].concat(e)):s.apply(this.$store,[o].concat(e))}}),s}),createNamespacedHelpers=t=>({mapState:mapState.bind(null,t),mapGetters:mapGetters.bind(null,t),mapMutations:mapMutations.bind(null,t),mapActions:mapActions.bind(null,t)});function normalizeMap(t){return isValidMap(t)?Array.isArray(t)?t.map(t=>({key:t,val:t})):Object.keys(t).map(e=>({key:e,val:t[e]})):[]}function isValidMap(t){return Array.isArray(t)||isObject(t)}function normalizeNamespace(t){return(e,s)=>("string"!=typeof e?(s=e,e=""):"/"!==e.charAt(e.length-1)&&(e+="/"),t(e,s))}function getModuleByNamespace(t,e,s){return t._modulesNamespaceMap[s]}var index={version:"__VERSION__",createStore:createStore,Store:Store,useStore:useStore,mapState:mapState,mapMutations:mapMutations,mapGetters:mapGetters,mapActions:mapActions,createNamespacedHelpers:createNamespacedHelpers};export default index;export{Store,createNamespacedHelpers,createStore,mapActions,mapGetters,mapMutations,mapState,useStore};