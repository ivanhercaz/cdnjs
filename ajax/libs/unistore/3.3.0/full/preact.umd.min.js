!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports,require("preact")):"function"==typeof define&&define.amd?define(["exports","preact"],n):n(t.unistore={},t.preact)}(this,function(t,p){function a(t,n){for(var e in n)t[e]=n[e];return t}function n(t){this.getChildContext=function(){return{store:t.store}}}n.prototype.render=function(t){return t.children[0]},t.createStore=function(u){var i=[];function n(t){for(var n=[],e=0;e<i.length;e++)i[e]===t?t=null:n.push(i[e]);i=n}function e(t,n,e){u=n?t:a(a({},u),t);for(var r=i,o=0;o<r.length;o++)r[o](u,e)}return u=u||{},{action:function(o){function i(t){e(t,!1,o)}return function(){for(var t=arguments,n=[u],e=0;e<arguments.length;e++)n.push(t[e]);var r=o.apply(this,n);if(null!=r)return r.then?r.then(i):i(r)}},setState:e,subscribe:function(t){return i.push(t),function(){n(t)}},unsubscribe:n,getState:function(){return u}}},t.Provider=n,t.connect=function(c,s){var r;return"function"!=typeof c&&("string"==typeof(r=c||[])&&(r=r.split(/\s*,\s*/)),c=function(t){for(var n={},e=0;e<r.length;e++)n[r[e]]=t[r[e]];return n}),function(f){function t(t,n){function e(){var t=c(o?o.getState():{},r.props);for(var n in t)if(t[n]!==i[n])return i=t,r.setState();for(var e in i)if(!(e in t))return i=t,r.setState()}var r=this,o=n.store,i=c(o?o.getState():{},t),u=s?function(t,n){"function"==typeof t&&(t=t(n));var e={};for(var r in t)e[r]=n.action(t[r]);return e}(s,o):{store:o};this.componentWillReceiveProps=e,this.componentDidMount=function(){o.subscribe(e)},this.componentWillUnmount=function(){o.unsubscribe(e)},this.render=function(t){return p.h(f,a(a(a({},u),t),i))}}return(t.prototype=new p.Component).constructor=t}}});