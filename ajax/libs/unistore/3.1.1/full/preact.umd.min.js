!function(n,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("preact")):"function"==typeof define&&define.amd?define(["exports","preact"],t):t(n.unistore={},n.preact)}(this,function(n,a){function p(n,t){for(var e in t)n[e]=t[e];return n}function t(n){this.getChildContext=function(){return{store:n.store}}}t.prototype.render=function(n){return n.children[0]},n.createStore=function(i){var u=[];function t(n){for(var t=[],e=0;e<u.length;e++)u[e]===n?n=null:t.push(u[e]);u=t}function e(n,t,e){i=t?n:p(p({},i),n);for(var r=u,o=0;o<r.length;o++)r[o](i,e)}return i=i||{},{action:function(o){function u(n){e(n,!1,o)}return function(){for(var n=arguments,t=[i],e=0;e<arguments.length;e++)t.push(n[e]);var r=o.apply(this,t);if(null!=r)return r.then?r.then(u):u(r)}},setState:e,subscribe:function(n){return u.push(n),function(){t(n)}},unsubscribe:t,getState:function(){return i}}},n.Provider=t,n.connect=function(c,s){var r;return"function"!=typeof c&&("string"==typeof(r=c||[])&&(r=r.split(/\s*,\s*/)),c=function(n){for(var t={},e=0;e<r.length;e++)t[r[e]]=n[r[e]];return t}),function(f){function n(n,t){function e(){var n=c(o?o.getState():{},r.props);for(var t in n)if(n[t]!==u[t])return u=n,r.setState(null);for(var e in u)if(!(e in n))return u=n,r.setState(null)}var r=this,o=t.store,u=c(o?o.getState():{},n),i=s?function(n,t){"function"==typeof n&&(n=n(t));var e={};for(var r in n)e[r]=t.action(n[r]);return e}(s,o):{store:o};this.componentDidMount=function(){o.subscribe(e)},this.componentWillUnmount=function(){o.unsubscribe(e)},this.render=function(n){return a.h(f,p(p(p({},i),n),u))}}return(n.prototype=new a.Component).constructor=n}}});