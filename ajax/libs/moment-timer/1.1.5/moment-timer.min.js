!function(){function r(t,i,r){if(this.timerDuration=t,this.callback=r,this.loop=i.loop,this.started=!1,this.stopped=!1,this.timer,this.startTick,this.endTick,i.start)if(0<i.wait){var e=this;setTimeout(function(){i.executeAfterWait&&r(),e.start()},i.wait)}else this.start()}var t;if(r.prototype.start=function(){if(this.started)return!1;var t=this;return this.stopped?(setTimeout(function(){return t.callback(),t.start()},this.getRemainingDuration()),!(this.stopped=!1)):(this.loop?this.timer=setInterval(function(){return t.updateStartEndTickFromDuration(t.timerDuration),t.callback()},this.timerDuration):this.timer=setTimeout(function(){return t.started=!1,t.callback()},this.timerDuration),this.updateStartEndTickFromDuration(t.timerDuration),this.started=!0)},r.prototype.stop=function(){return!!this.started&&(this.clearTimer(),this.updateStartEndTickFromDuration(this.getRemainingDuration()),this.started=!1,this.stopped=!0)},r.prototype.clearTimer=function(){return!!this.timer&&(this.loop?this.timer=clearInterval(this.timer):this.timer=clearTimeout(this.timer),!0)},r.prototype.updateStartEndTickFromDuration=function(t){return this.startTick=Date.now(),this.endTick=this.startTick+t,!0},r.prototype.duration=function(){return 0<arguments.length&&(this.timerDuration=t.duration(arguments[0],arguments[1]).asMilliseconds(),this.stop(),this.start(),!0)},r.prototype.getDuration=function(){return this.timerDuration},r.prototype.getRemainingDuration=function(){return this.startTick&&this.endTick?this.stopped?this.endTick-this.startTick:this.endTick-Date.now():0},r.prototype.isStopped=function(){return this.stopped},"function"==typeof require)try{t=require("moment")}catch(t){}if(!t&&this.moment&&(t=this.moment),!t)throw"Moment Timer cannot find Moment.js";t.duration.fn.timer=function(t,i){if("function"==typeof t)i=t,t={wait:0,loop:!1,start:!0};else{if("object"!=typeof t||"function"!=typeof i)throw new Error("First argument must be of type function or object.");null==t.start&&(t.start=!0)}return new r(this.asMilliseconds(),t,i)}}();