import Mmenu from"../../core/oncanvas/mmenu.oncanvas";import options from"./_options";import{extendShorthandOptions}from"./_options";import*as DOM from"../../_modules/dom";import{extend}from"../../_modules/helpers";Mmenu.options.lazySubmenus=options;export default function(){var n=this,e=extendShorthandOptions(this.opts.lazySubmenus);this.opts.lazySubmenus=extend(e,Mmenu.options.lazySubmenus),e.load&&(this.bind("initMenu:after",function(){var e=[];DOM.find(n.node.pnls,"li").forEach(function(o){e.push.apply(e,DOM.children(o,n.conf.panelNodetype.join(", ")))}),e.filter(function(n){return!n.matches(".mm-listview_inset")}).filter(function(n){return!n.matches(".mm-nolistview")}).filter(function(n){return!n.matches(".mm-nopanel")}).forEach(function(n){["mm-panel_lazysubmenu","mm-nolistview","mm-nopanel"].forEach(function(e){n.classList.add(e)})})}),this.bind("initPanels:before",function(){DOM.children(n.node.pnls,n.conf.panelNodetype.join(", ")).forEach(function(n){var e=".mm-panel_lazysubmenu",o=DOM.find(n,e);n.matches(e)&&o.unshift(n),o.filter(function(n){return!n.matches(".mm-panel_lazysubmenu .mm-panel_lazysubmenu")}).forEach(function(n){["mm-panel_lazysubmenu","mm-nolistview","mm-nopanel"].forEach(function(e){n.classList.remove(e)})})})}),this.bind("initOpened:before",function(){var e=[];DOM.find(n.node.pnls,"."+n.conf.classNames.selected).forEach(function(n){e.push.apply(e,DOM.parents(n,".mm-panel_lazysubmenu"))}),e.length&&(e.forEach(function(n){["mm-panel_lazysubmenu","mm-nolistview","mm-nopanel"].forEach(function(e){n.classList.remove(e)})}),n.initPanel(e[e.length-1]))}),this.bind("openPanel:before",function(e){var o=".mm-panel_lazysubmenu",t=DOM.find(e,o);e.matches(o)&&t.unshift(e),(t=t.filter(function(n){return!n.matches(".mm-panel_lazysubmenu .mm-panel_lazysubmenu")})).forEach(function(e){n.initPanel(e)})}))};