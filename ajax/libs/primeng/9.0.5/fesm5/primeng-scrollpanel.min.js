import{ElementRef,NgZone,Input,ViewChild,Component,ChangeDetectionStrategy,NgModule}from"@angular/core";import{CommonModule}from"@angular/common";import{DomHandler}from"primeng/dom";var __decorate=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,l=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,o,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(l=(r<3?i(l):r>3?i(t,o,l):i(t,o))||l);return r>3&&l&&Object.defineProperty(t,o,l),l},ScrollPanel=function(){function e(e,t){this.el=e,this.zone=t,this.timeoutFrame=function(e){return setTimeout(e,0)}}return e.prototype.ngAfterViewInit=function(){var e=this;this.zone.runOutsideAngular(function(){e.moveBar(),e.moveBar=e.moveBar.bind(e),e.onXBarMouseDown=e.onXBarMouseDown.bind(e),e.onYBarMouseDown=e.onYBarMouseDown.bind(e),e.onDocumentMouseMove=e.onDocumentMouseMove.bind(e),e.onDocumentMouseUp=e.onDocumentMouseUp.bind(e),window.addEventListener("resize",e.moveBar),e.contentViewChild.nativeElement.addEventListener("scroll",e.moveBar),e.contentViewChild.nativeElement.addEventListener("mouseenter",e.moveBar),e.xBarViewChild.nativeElement.addEventListener("mousedown",e.onXBarMouseDown),e.yBarViewChild.nativeElement.addEventListener("mousedown",e.onYBarMouseDown),e.calculateContainerHeight(),e.initialized=!0})},e.prototype.calculateContainerHeight=function(){var e=this.containerViewChild.nativeElement,t=this.contentViewChild.nativeElement,o=this.xBarViewChild.nativeElement,n=getComputedStyle(e),i=getComputedStyle(o),r=DomHandler.getHeight(e)-parseInt(i.height,10);"none"!=n["max-height"]&&0==r&&(t.offsetHeight+parseInt(i.height,10)>parseInt(n["max-height"],10)?e.style.height=n["max-height"]:e.style.height=t.offsetHeight+parseFloat(n.paddingTop)+parseFloat(n.paddingBottom)+parseFloat(n.borderTopWidth)+parseFloat(n.borderBottomWidth)+"px")},e.prototype.moveBar=function(){var e=this,t=this.containerViewChild.nativeElement,o=this.contentViewChild.nativeElement,n=this.xBarViewChild.nativeElement,i=o.scrollWidth,r=o.clientWidth,l=-1*(t.clientHeight-n.clientHeight);this.scrollXRatio=r/i;var a=this.yBarViewChild.nativeElement,s=o.scrollHeight,d=o.clientHeight,c=-1*(t.clientWidth-a.clientWidth);this.scrollYRatio=d/s,this.requestAnimationFrame(function(){if(e.scrollXRatio>=1)DomHandler.addClass(n,"ui-scrollpanel-hidden");else{DomHandler.removeClass(n,"ui-scrollpanel-hidden");var t=Math.max(100*e.scrollXRatio,10),u=o.scrollLeft*(100-t)/(i-r);n.style.cssText="width:"+t+"%; left:"+u+"%;bottom:"+l+"px;"}if(e.scrollYRatio>=1)DomHandler.addClass(a,"ui-scrollpanel-hidden");else{DomHandler.removeClass(a,"ui-scrollpanel-hidden");var h=Math.max(100*e.scrollYRatio,10),m=o.scrollTop*(100-h)/(s-d);a.style.cssText="height:"+h+"%; top: calc("+m+"% - "+n.clientHeight+"px);right:"+c+"px;"}})},e.prototype.onYBarMouseDown=function(e){this.isYBarClicked=!0,this.lastPageY=e.pageY,DomHandler.addClass(this.yBarViewChild.nativeElement,"ui-scrollpanel-grabbed"),DomHandler.addClass(document.body,"ui-scrollpanel-grabbed"),document.addEventListener("mousemove",this.onDocumentMouseMove),document.addEventListener("mouseup",this.onDocumentMouseUp),e.preventDefault()},e.prototype.onXBarMouseDown=function(e){this.isXBarClicked=!0,this.lastPageX=e.pageX,DomHandler.addClass(this.xBarViewChild.nativeElement,"ui-scrollpanel-grabbed"),DomHandler.addClass(document.body,"ui-scrollpanel-grabbed"),document.addEventListener("mousemove",this.onDocumentMouseMove),document.addEventListener("mouseup",this.onDocumentMouseUp),e.preventDefault()},e.prototype.onDocumentMouseMove=function(e){this.isXBarClicked?this.onMouseMoveForXBar(e):this.isYBarClicked?this.onMouseMoveForYBar(e):(this.onMouseMoveForXBar(e),this.onMouseMoveForYBar(e))},e.prototype.onMouseMoveForXBar=function(e){var t=this,o=e.pageX-this.lastPageX;this.lastPageX=e.pageX,this.requestAnimationFrame(function(){t.contentViewChild.nativeElement.scrollLeft+=o/t.scrollXRatio})},e.prototype.onMouseMoveForYBar=function(e){var t=this,o=e.pageY-this.lastPageY;this.lastPageY=e.pageY,this.requestAnimationFrame(function(){t.contentViewChild.nativeElement.scrollTop+=o/t.scrollYRatio})},e.prototype.scrollTop=function(e){var t=this.contentViewChild.nativeElement.scrollHeight-this.contentViewChild.nativeElement.clientHeight;e=e>t?t:e>0?e:0,this.contentViewChild.nativeElement.scrollTop=e},e.prototype.onDocumentMouseUp=function(e){DomHandler.removeClass(this.yBarViewChild.nativeElement,"ui-scrollpanel-grabbed"),DomHandler.removeClass(this.xBarViewChild.nativeElement,"ui-scrollpanel-grabbed"),DomHandler.removeClass(document.body,"ui-scrollpanel-grabbed"),document.removeEventListener("mousemove",this.onDocumentMouseMove),document.removeEventListener("mouseup",this.onDocumentMouseUp),this.isXBarClicked=!1,this.isYBarClicked=!1},e.prototype.requestAnimationFrame=function(e){(window.requestAnimationFrame||this.timeoutFrame)(e)},e.prototype.ngOnDestroy=function(){this.initialized&&(window.removeEventListener("resize",this.moveBar),this.contentViewChild.nativeElement.removeEventListener("scroll",this.moveBar),this.contentViewChild.nativeElement.removeEventListener("mouseenter",this.moveBar),this.xBarViewChild.nativeElement.removeEventListener("mousedown",this.onXBarMouseDown),this.yBarViewChild.nativeElement.removeEventListener("mousedown",this.onYBarMouseDown))},e.prototype.refresh=function(){this.moveBar()},e.ctorParameters=function(){return[{type:ElementRef},{type:NgZone}]},__decorate([Input()],e.prototype,"style",void 0),__decorate([Input()],e.prototype,"styleClass",void 0),__decorate([ViewChild("container")],e.prototype,"containerViewChild",void 0),__decorate([ViewChild("content")],e.prototype,"contentViewChild",void 0),__decorate([ViewChild("xBar")],e.prototype,"xBarViewChild",void 0),__decorate([ViewChild("yBar")],e.prototype,"yBarViewChild",void 0),e=__decorate([Component({selector:"p-scrollPanel",template:'\n        <div #container [ngClass]="\'ui-scrollpanel ui-widget ui-widget-content ui-corner-all\'" [ngStyle]="style" [class]="styleClass">\n            <div class="ui-scrollpanel-wrapper">\n                <div #content class="ui-scrollpanel-content">\n                    <ng-content></ng-content>\n                </div>\n            </div>\n            <div #xBar class="ui-scrollpanel-bar ui-scrollpanel-bar-x"></div>\n            <div #yBar class="ui-scrollpanel-bar ui-scrollpanel-bar-y"></div>   \n        </div>\n    ',changeDetection:ChangeDetectionStrategy.Default})],e)}(),ScrollPanelModule=function(){function e(){}return e=__decorate([NgModule({imports:[CommonModule],exports:[ScrollPanel],declarations:[ScrollPanel]})],e)}();export{ScrollPanel,ScrollPanelModule};