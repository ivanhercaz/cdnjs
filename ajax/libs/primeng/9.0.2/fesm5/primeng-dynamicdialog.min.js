import{ViewContainerRef,Directive,ComponentFactoryResolver,ChangeDetectorRef,Renderer2,NgZone,ViewChild,Component,NgModule,ApplicationRef,Injector,Injectable}from"@angular/core";import{trigger,state,style,transition,animate}from"@angular/animations";import{CommonModule}from"@angular/common";import{DomHandler}from"primeng/dom";import{Subject}from"rxjs";var __decorate=this&&this.__decorate||function(t,e,o,n){var i,a=arguments.length,r=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(r=(a<3?i(r):a>3?i(e,o,r):i(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r},DynamicDialogContent=function(){function t(t){this.viewContainerRef=t}return t.ctorParameters=function(){return[{type:ViewContainerRef}]},t=__decorate([Directive({selector:"[pDynamicDialogContent]"})],t)}(),DynamicDialogConfig=function(){return function(){}}(),DynamicDialogRef=function(){function t(){this._onClose=new Subject,this.onClose=this._onClose.asObservable()}return t.prototype.close=function(t){this._onClose.next(t)},t}(),__decorate$1=this&&this.__decorate||function(t,e,o,n){var i,a=arguments.length,r=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(r=(a<3?i(r):a>3?i(e,o,r):i(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r},DynamicDialogComponent=function(){function t(t,e,o,n,i,a){this.componentFactoryResolver=t,this.cd=e,this.renderer=o,this.config=n,this.dialogRef=i,this.zone=a,this.visible=!0}return t.prototype.ngAfterViewInit=function(){this.loadChildComponent(this.childComponentType),this.cd.detectChanges()},t.prototype.onOverlayClicked=function(t){this.dialogRef.close()},t.prototype.onDialogClicked=function(t){t.stopPropagation()},t.prototype.loadChildComponent=function(t){var e=this.componentFactoryResolver.resolveComponentFactory(t),o=this.insertionPoint.viewContainerRef;o.clear(),this.componentRef=o.createComponent(e)},t.prototype.moveOnTop=function(){if(!1!==this.config.autoZIndex){var t=this.config.baseZIndex||++DomHandler.zindex+0;this.container.style.zIndex=String(t),this.maskViewChild.nativeElement.style.zIndex=String(t-1)}},t.prototype.onAnimationStart=function(t){switch(t.toState){case"visible":this.container=t.element,this.moveOnTop(),this.bindGlobalListeners(),DomHandler.addClass(document.body,"ui-overflow-hidden");break;case"void":this.onContainerDestroy()}},t.prototype.onAnimationEnd=function(t){"void"===t.toState&&this.dialogRef.close()},t.prototype.onContainerDestroy=function(){DomHandler.removeClass(document.body,"ui-overflow-hidden"),this.unbindGlobalListeners(),this.container=null},t.prototype.close=function(){this.visible=!1},t.prototype.onMaskClick=function(){this.config.dismissableMask&&this.close()},t.prototype.bindGlobalListeners=function(){!1!==this.config.closeOnEscape&&!1!==this.config.closable&&this.bindDocumentEscapeListener()},t.prototype.unbindGlobalListeners=function(){this.unbindDocumentEscapeListener()},t.prototype.bindDocumentEscapeListener=function(){var t=this;this.documentEscapeListener=this.renderer.listen("document","keydown",function(e){27==e.which&&parseInt(t.container.style.zIndex)==DomHandler.zindex&&t.close()})},t.prototype.unbindDocumentEscapeListener=function(){this.documentEscapeListener&&(this.documentEscapeListener(),this.documentEscapeListener=null)},t.prototype.ngOnDestroy=function(){this.onContainerDestroy(),this.componentRef&&this.componentRef.destroy()},t.ctorParameters=function(){return[{type:ComponentFactoryResolver},{type:ChangeDetectorRef},{type:Renderer2},{type:DynamicDialogConfig},{type:DynamicDialogRef},{type:NgZone}]},__decorate$1([ViewChild(DynamicDialogContent,{static:!1})],t.prototype,"insertionPoint",void 0),__decorate$1([ViewChild("mask",{static:!1})],t.prototype,"maskViewChild",void 0),t=__decorate$1([Component({selector:"p-dynamicDialog",template:'\n\t\t<div #mask class="ui-widget-overlay ui-dialog-mask ui-dialog-mask-scrollblocker" *ngIf="visible" (click)="onMaskClick()"></div>\n\t\t<div [ngClass]="{\'ui-dialog ui-dynamicdialog ui-widget ui-widget-content ui-corner-all ui-shadow\':true, \'ui-dialog-rtl\': config.rtl}" [ngStyle]="config.style" [class]="config.styleClass"\n\t\t\t[@animation]="{value: \'visible\', params: {transitionParams: config.transitionOptions || \'150ms cubic-bezier(0, 0, 0.2, 1)\'}}" \n\t\t\t(@animation.start)="onAnimationStart($event)" (@animation.done)="onAnimationEnd($event)" role="dialog" *ngIf="visible"\n\t\t\t[style.width]="config.width" [style.height]="config.height">\n            <div class="ui-dialog-titlebar ui-widget-header ui-helper-clearfix ui-corner-top" *ngIf="config.showHeader === false ? false: true">\n                <span class="ui-dialog-title">{{config.header}}</span>\n                <div class="ui-dialog-titlebar-icons">\n                    <a [ngClass]="\'ui-dialog-titlebar-icon ui-dialog-titlebar-close ui-corner-all\'" tabindex="0" role="button" (click)="close()" (keydown.enter)="close()" *ngIf="config.closable !== false">\n                        <span class="pi pi-times"></span>\n                    </a>\n                </div>\n            </div>\n            <div class="ui-dialog-content ui-widget-content" [ngStyle]="config.contentStyle">\n\t\t\t\t<ng-template pDynamicDialogContent></ng-template>\n\t\t\t</div>\n\t\t\t<div class="ui-dialog-footer ui-widget-content" *ngIf="config.footer">\n\t\t\t\t{{config.footer}}\n            </div>\n\t\t</div>\n\t',animations:[trigger("animation",[state("void",style({transform:"translateX(-50%) translateY(-50%) scale(0.7)",opacity:0})),state("visible",style({transform:"translateX(-50%) translateY(-50%) scale(1)",opacity:1})),transition("* => *",animate("{{transitionParams}}"))])]})],t)}(),DynamicDialogModule=function(){function t(){}return t=__decorate$1([NgModule({imports:[CommonModule],declarations:[DynamicDialogComponent,DynamicDialogContent],entryComponents:[DynamicDialogComponent]})],t)}(),DynamicDialogInjector=function(){function t(t,e){this._parentInjector=t,this._additionalTokens=e}return t.prototype.get=function(t,e,o){var n=this._additionalTokens.get(t);return n||this._parentInjector.get(t,e)},t}(),__decorate$2=this&&this.__decorate||function(t,e,o,n){var i,a=arguments.length,r=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(r=(a<3?i(r):a>3?i(e,o,r):i(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r},DialogService=function(){function t(t,e,o){this.componentFactoryResolver=t,this.appRef=e,this.injector=o}return t.prototype.open=function(t,e){var o=this.appendDialogComponentToBody(e);return this.dialogComponentRef.instance.childComponentType=t,o},t.prototype.appendDialogComponentToBody=function(t){var e=this,o=new WeakMap;o.set(DynamicDialogConfig,t);var n=new DynamicDialogRef;o.set(DynamicDialogRef,n);var i=n.onClose.subscribe(function(){e.removeDialogComponentFromBody(),i.unsubscribe()}),a=this.componentFactoryResolver.resolveComponentFactory(DynamicDialogComponent).create(new DynamicDialogInjector(this.injector,o));this.appRef.attachView(a.hostView);var r=a.hostView.rootNodes[0];return document.body.appendChild(r),this.dialogComponentRef=a,n},t.prototype.removeDialogComponentFromBody=function(){this.appRef.detachView(this.dialogComponentRef.hostView),this.dialogComponentRef.destroy()},t.ctorParameters=function(){return[{type:ComponentFactoryResolver},{type:ApplicationRef},{type:Injector}]},t=__decorate$2([Injectable()],t)}();export{DialogService,DynamicDialogComponent,DynamicDialogConfig,DynamicDialogInjector,DynamicDialogModule,DynamicDialogRef,DynamicDialogContent as Éµa};