import{EventEmitter,NgZone,Input,Output,ViewChild,Component,ChangeDetectorRef,ContentChildren,ChangeDetectionStrategy,NgModule}from"@angular/core";import{CommonModule}from"@angular/common";import{DomHandler}from"primeng/dom";import{MessageService,PrimeTemplate,SharedModule}from"primeng/api";import{trigger,state,style,transition,animate,query,animateChild}from"@angular/animations";var __decorate=this&&this.__decorate||function(t,e,o,s){var i,n=arguments.length,a=n<3?e:null===s?s=Object.getOwnPropertyDescriptor(e,o):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,s);else for(var r=t.length-1;r>=0;r--)(i=t[r])&&(a=(n<3?i(a):n>3?i(e,o,a):i(e,o))||a);return n>3&&a&&Object.defineProperty(e,o,a),a},__read=this&&this.__read||function(t,e){var o="function"==typeof Symbol&&t[Symbol.iterator];if(!o)return t;var s,i,n=o.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(s=n.next()).done;)a.push(s.value)}catch(t){i={error:t}}finally{try{s&&!s.done&&(o=n.return)&&o.call(n)}finally{if(i)throw i.error}}return a},__spread=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(__read(arguments[e]));return t},ToastItem=function(){function t(t){this.zone=t,this.onClose=new EventEmitter}return t.prototype.ngAfterViewInit=function(){this.initTimeout()},t.prototype.initTimeout=function(){var t=this;this.message.sticky||this.zone.runOutsideAngular(function(){t.timeout=setTimeout(function(){t.onClose.emit({index:t.index,message:t.message})},t.message.life||3e3)})},t.prototype.clearTimeout=function(){this.timeout&&(clearTimeout(this.timeout),this.timeout=null)},t.prototype.onMouseEnter=function(){this.clearTimeout()},t.prototype.onMouseLeave=function(){this.initTimeout()},t.prototype.onCloseIconClick=function(t){this.clearTimeout(),this.onClose.emit({index:this.index,message:this.message}),t.preventDefault()},t.prototype.ngOnDestroy=function(){this.clearTimeout()},t.ctorParameters=function(){return[{type:NgZone}]},__decorate([Input()],t.prototype,"message",void 0),__decorate([Input()],t.prototype,"index",void 0),__decorate([Input()],t.prototype,"template",void 0),__decorate([Input()],t.prototype,"showTransformOptions",void 0),__decorate([Input()],t.prototype,"hideTransformOptions",void 0),__decorate([Input()],t.prototype,"showTransitionOptions",void 0),__decorate([Input()],t.prototype,"hideTransitionOptions",void 0),__decorate([Output()],t.prototype,"onClose",void 0),__decorate([ViewChild("container")],t.prototype,"containerViewChild",void 0),t=__decorate([Component({selector:"p-toastItem",template:'\n        <div #container [attr.id]="message.id" class="ui-toast-message ui-shadow" [@messageState]="{value: \'visible\', params: {showTransformParams: showTransformOptions, hideTransformParams: hideTransformOptions, showTransitionParams: showTransitionOptions, hideTransitionParams: hideTransitionOptions}}"\n            [ngClass]="{\'ui-toast-message-info\': message.severity == \'info\',\'ui-toast-message-warn\': message.severity == \'warn\',\n                \'ui-toast-message-error\': message.severity == \'error\',\'ui-toast-message-success\': message.severity == \'success\'}"\n                (mouseenter)="onMouseEnter()" (mouseleave)="onMouseLeave()" role="alert" aria-live="assertive" aria-atomic="true">\n            <div class="ui-toast-message-content">\n                <a tabindex="0" class="ui-toast-close-icon pi pi-times" (click)="onCloseIconClick($event)" (keydown.enter)="onCloseIconClick($event)" *ngIf="message.closable !== false"></a>\n                <ng-container *ngIf="!template">\n                    <span class="ui-toast-icon pi"\n                        [ngClass]="{\'pi-info-circle\': message.severity == \'info\', \'pi-exclamation-triangle\': message.severity == \'warn\',\n                            \'pi-times-circle\': message.severity == \'error\', \'pi-check\' :message.severity == \'success\'}"></span>\n                    <div class="ui-toast-message-text-content">\n                        <div class="ui-toast-summary">{{message.summary}}</div>\n                        <div class="ui-toast-detail">{{message.detail}}</div>\n                    </div>\n                </ng-container>\n                <ng-container *ngTemplateOutlet="template; context: {$implicit: message}"></ng-container>\n            </div>\n        </div>\n    ',animations:[trigger("messageState",[state("visible",style({transform:"translateY(0)",opacity:1})),transition("void => *",[style({transform:"{{showTransformParams}}",opacity:0}),animate("{{showTransitionParams}}")]),transition("* => void",[animate("{{hideTransitionParams}}",style({height:0,opacity:0,transform:"{{hideTransformParams}}"}))])])]})],t)}(),Toast=function(){function t(t,e){this.messageService=t,this.cd=e,this.autoZIndex=!0,this.baseZIndex=0,this.position="top-right",this.preventOpenDuplicates=!1,this.preventDuplicates=!1,this.showTransformOptions="translateY(100%)",this.hideTransformOptions="translateY(-100%)",this.showTransitionOptions="300ms ease-out",this.hideTransitionOptions="250ms ease-in",this.onClose=new EventEmitter}return t.prototype.ngOnInit=function(){var t=this;this.messageSubscription=this.messageService.messageObserver.subscribe(function(e){if(e){if(e instanceof Array){var o=e.filter(function(e){return t.canAdd(e)});t.add(o)}else t.canAdd(e)&&t.add([e]);t.modal&&t.messages&&t.messages.length&&t.enableModality()}}),this.clearSubscription=this.messageService.clearObserver.subscribe(function(e){e?t.key===e&&(t.messages=null):t.messages=null,t.modal&&t.disableModality()})},t.prototype.add=function(t){this.messages=this.messages?__spread(this.messages,t):__spread(t),this.preventDuplicates&&(this.messagesArchieve=this.messagesArchieve?__spread(this.messagesArchieve,t):__spread(t))},t.prototype.canAdd=function(t){var e=this.key===t.key;return e&&this.preventOpenDuplicates&&(e=!this.containsMessage(this.messages,t)),e&&this.preventDuplicates&&(e=!this.containsMessage(this.messagesArchieve,t)),e},t.prototype.containsMessage=function(t,e){return!!t&&null!=t.find(function(t){return t.summary===e.summary&&t.detail==e.detail&&t.severity===e.severity})},t.prototype.ngAfterContentInit=function(){var t=this;this.templates.forEach(function(e){switch(e.getType()){case"message":default:t.template=e.template}})},t.prototype.onMessageClose=function(t){this.messages.splice(t.index,1),0===this.messages.length&&this.disableModality(),this.onClose.emit({message:t.message}),this.cd.detectChanges()},t.prototype.enableModality=function(){if(!this.mask){this.mask=document.createElement("div"),this.mask.style.zIndex=String(parseInt(this.containerViewChild.nativeElement.style.zIndex)-1),this.mask.style.display="block";DomHandler.addMultipleClasses(this.mask,"ui-widget-overlay ui-dialog-mask"),document.body.appendChild(this.mask)}},t.prototype.disableModality=function(){this.mask&&(document.body.removeChild(this.mask),this.mask=null)},t.prototype.onAnimationStart=function(t){"void"===t.fromState&&this.autoZIndex&&(this.containerViewChild.nativeElement.style.zIndex=String(this.baseZIndex+ ++DomHandler.zindex))},t.prototype.ngOnDestroy=function(){this.messageSubscription&&this.messageSubscription.unsubscribe(),this.clearSubscription&&this.clearSubscription.unsubscribe(),this.disableModality()},t.ctorParameters=function(){return[{type:MessageService},{type:ChangeDetectorRef}]},__decorate([Input()],t.prototype,"key",void 0),__decorate([Input()],t.prototype,"autoZIndex",void 0),__decorate([Input()],t.prototype,"baseZIndex",void 0),__decorate([Input()],t.prototype,"style",void 0),__decorate([Input()],t.prototype,"styleClass",void 0),__decorate([Input()],t.prototype,"position",void 0),__decorate([Input()],t.prototype,"modal",void 0),__decorate([Input()],t.prototype,"preventOpenDuplicates",void 0),__decorate([Input()],t.prototype,"preventDuplicates",void 0),__decorate([Input()],t.prototype,"showTransformOptions",void 0),__decorate([Input()],t.prototype,"hideTransformOptions",void 0),__decorate([Input()],t.prototype,"showTransitionOptions",void 0),__decorate([Input()],t.prototype,"hideTransitionOptions",void 0),__decorate([Output()],t.prototype,"onClose",void 0),__decorate([ViewChild("container")],t.prototype,"containerViewChild",void 0),__decorate([ContentChildren(PrimeTemplate)],t.prototype,"templates",void 0),t=__decorate([Component({selector:"p-toast",template:"\n        <div #container [ngClass]=\"{'ui-toast ui-widget': true, \n                'ui-toast-top-right': position === 'top-right',\n                'ui-toast-top-left': position === 'top-left',\n                'ui-toast-bottom-right': position === 'bottom-right',\n                'ui-toast-bottom-left': position === 'bottom-left',\n                'ui-toast-top-center': position === 'top-center',\n                'ui-toast-bottom-center': position === 'bottom-center',\n                'ui-toast-center': position === 'center'}\" \n                [ngStyle]=\"style\" [class]=\"styleClass\">\n            <p-toastItem *ngFor=\"let msg of messages; let i=index\" [message]=\"msg\" [index]=\"i\" (onClose)=\"onMessageClose($event)\"\n                    [template]=\"template\" @toastAnimation (@toastAnimation.start)=\"onAnimationStart($event)\" \n                    [showTransformOptions]=\"showTransformOptions\" [hideTransformOptions]=\"hideTransformOptions\" \n                    [showTransitionOptions]=\"showTransitionOptions\" [hideTransitionOptions]=\"hideTransitionOptions\"></p-toastItem>\n        </div>\n    ",animations:[trigger("toastAnimation",[transition(":enter, :leave",[query("@*",animateChild())])])],changeDetection:ChangeDetectionStrategy.Default})],t)}(),ToastModule=function(){function t(){}return t=__decorate([NgModule({imports:[CommonModule],exports:[Toast,SharedModule],declarations:[Toast,ToastItem]})],t)}();export{Toast,ToastItem,ToastModule};