import{Inject,forwardRef,Input,Component,EventEmitter,ElementRef,Output,ContentChildren,ChangeDetectionStrategy,NgModule}from"@angular/core";import{trigger,state,style,transition,animate}from"@angular/animations";import{CommonModule}from"@angular/common";import{PrimeTemplate,SharedModule}from"primeng/api";var __decorate=this&&this.__decorate||function(e,t,n,o){var i,a=arguments.length,r=a<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,o);else for(var l=e.length-1;l>=0;l--)(i=e[l])&&(r=(a<3?i(r):a>3?i(t,n,r):i(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},__param=this&&this.__param||function(e,t){return function(n,o){t(n,o,e)}},__read=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var o,i,a=n.call(e),r=[];try{for(;(void 0===t||t-- >0)&&!(o=a.next()).done;)r.push(o.value)}catch(e){i={error:e}}finally{try{o&&!o.done&&(n=a.return)&&n.call(a)}finally{if(i)throw i.error}}return r},__spread=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(__read(arguments[t]));return e},OrganizationChartNode=function(){function e(e){this.chart=e}return Object.defineProperty(e.prototype,"leaf",{get:function(){return 0!=this.node.leaf&&!(this.node.children&&this.node.children.length)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"colspan",{get:function(){return this.node.children&&this.node.children.length?2*this.node.children.length:null},enumerable:!0,configurable:!0}),e.prototype.onNodeClick=function(e,t){this.chart.onNodeClick(e,t)},e.prototype.toggleNode=function(e,t){t.expanded=!t.expanded,t.expanded?this.chart.onNodeExpand.emit({originalEvent:e,node:this.node}):this.chart.onNodeCollapse.emit({originalEvent:e,node:this.node}),e.preventDefault()},e.prototype.isSelected=function(){return this.chart.isSelected(this.node)},e.ctorParameters=function(){return[{type:void 0,decorators:[{type:Inject,args:[forwardRef(function(){return OrganizationChart})]}]}]},__decorate([Input()],e.prototype,"node",void 0),__decorate([Input()],e.prototype,"root",void 0),__decorate([Input()],e.prototype,"first",void 0),__decorate([Input()],e.prototype,"last",void 0),e=__decorate([Component({selector:"[pOrganizationChartNode]",template:'\n        <tr *ngIf="node">\n            <td [attr.colspan]="colspan">\n                <div class="ui-organizationchart-node-content ui-widget-content ui-corner-all {{node.styleClass}}" \n                    [ngClass]="{\'ui-organizationchart-selectable-node\': chart.selectionMode && node.selectable !== false,\'ui-state-highlight\':isSelected()}"\n                    (click)="onNodeClick($event,node)">\n                    <div *ngIf="!chart.getTemplateForNode(node)">{{node.label}}</div>\n                    <div *ngIf="chart.getTemplateForNode(node)">\n                        <ng-container *ngTemplateOutlet="chart.getTemplateForNode(node); context: {$implicit: node}"></ng-container>\n                    </div>\n                    <a *ngIf="!leaf" tabindex="0" class="ui-node-toggler" (click)="toggleNode($event, node)" (keydown.enter)="toggleNode($event, node)">\n                        <i class="ui-node-toggler-icon pi" [ngClass]="{\'pi-chevron-down\': node.expanded, \'pi-chevron-up\': !node.expanded}"></i>\n                    </a>\n                </div>\n            </td>\n        </tr>\n        <tr [ngClass]="!leaf&&node.expanded ? \'ui-organizationchart-node-visible\' : \'ui-organizationchart-node-hidden\'" class="ui-organizationchart-lines" [@childState]="\'in\'">\n            <td [attr.colspan]="colspan">\n                <div class="ui-organizationchart-line-down"></div>\n            </td>\n        </tr>\n        <tr [ngClass]="!leaf&&node.expanded ? \'ui-organizationchart-node-visible\' : \'ui-organizationchart-node-hidden\'" class="ui-organizationchart-lines" [@childState]="\'in\'">\n            <ng-container *ngIf="node.children && node.children.length === 1">\n                <td [attr.colspan]="colspan">\n                    <div class="ui-organizationchart-line-down"></div>\n                </td>\n            </ng-container>\n            <ng-container *ngIf="node.children && node.children.length > 1">\n                <ng-template ngFor let-child [ngForOf]="node.children" let-first="first" let-last="last">\n                    <td class="ui-organizationchart-line-left" [ngClass]="{\'ui-organizationchart-line-top\':!first}">&nbsp;</td>\n                    <td class="ui-organizationchart-line-right" [ngClass]="{\'ui-organizationchart-line-top\':!last}">&nbsp;</td>\n                </ng-template>\n            </ng-container>\n        </tr>\n        <tr [ngClass]="!leaf&&node.expanded ? \'ui-organizationchart-node-visible\' : \'ui-organizationchart-node-hidden\'" class="ui-organizationchart-nodes" [@childState]="\'in\'">\n            <td *ngFor="let child of node.children" colspan="2">\n                <table class="ui-organizationchart-table" pOrganizationChartNode [node]="child"></table>\n            </td>\n        </tr>\n    ',animations:[trigger("childState",[state("in",style({opacity:1})),transition("void => *",[style({opacity:0}),animate(150)]),transition("* => void",[animate(150,style({opacity:0}))])])]}),__param(0,Inject(forwardRef(function(){return OrganizationChart})))],e)}(),OrganizationChart=function(){function e(e){this.el=e,this.preserveSpace=!0,this.selectionChange=new EventEmitter,this.onNodeSelect=new EventEmitter,this.onNodeUnselect=new EventEmitter,this.onNodeExpand=new EventEmitter,this.onNodeCollapse=new EventEmitter}return Object.defineProperty(e.prototype,"root",{get:function(){return this.value&&this.value.length?this.value[0]:null},enumerable:!0,configurable:!0}),e.prototype.ngAfterContentInit=function(){var e=this;this.templates.length&&(this.templateMap={}),this.templates.forEach(function(t){e.templateMap[t.getType()]=t.template})},e.prototype.getTemplateForNode=function(e){return this.templateMap?e.type?this.templateMap[e.type]:this.templateMap.default:null},e.prototype.onNodeClick=function(e,t){var n=e.target;if((!n.className||-1===n.className.indexOf("ui-node-toggler")&&-1===n.className.indexOf("ui-node-toggler-icon"))&&this.selectionMode){if(!1===t.selectable)return;var o=this.findIndexInSelection(t),i=o>=0;"single"===this.selectionMode?i?(this.selection=null,this.onNodeUnselect.emit({originalEvent:e,node:t})):(this.selection=t,this.onNodeSelect.emit({originalEvent:e,node:t})):"multiple"===this.selectionMode&&(i?(this.selection=this.selection.filter(function(e,t){return t!=o}),this.onNodeUnselect.emit({originalEvent:e,node:t})):(this.selection=__spread(this.selection||[],[t]),this.onNodeSelect.emit({originalEvent:e,node:t}))),this.selectionChange.emit(this.selection)}},e.prototype.findIndexInSelection=function(e){var t=-1;if(this.selectionMode&&this.selection)if("single"===this.selectionMode)t=this.selection==e?0:-1;else if("multiple"===this.selectionMode)for(var n=0;n<this.selection.length;n++)if(this.selection[n]==e){t=n;break}return t},e.prototype.isSelected=function(e){return-1!=this.findIndexInSelection(e)},e.ctorParameters=function(){return[{type:ElementRef}]},__decorate([Input()],e.prototype,"value",void 0),__decorate([Input()],e.prototype,"style",void 0),__decorate([Input()],e.prototype,"styleClass",void 0),__decorate([Input()],e.prototype,"selectionMode",void 0),__decorate([Input()],e.prototype,"selection",void 0),__decorate([Input()],e.prototype,"preserveSpace",void 0),__decorate([Output()],e.prototype,"selectionChange",void 0),__decorate([Output()],e.prototype,"onNodeSelect",void 0),__decorate([Output()],e.prototype,"onNodeUnselect",void 0),__decorate([Output()],e.prototype,"onNodeExpand",void 0),__decorate([Output()],e.prototype,"onNodeCollapse",void 0),__decorate([ContentChildren(PrimeTemplate)],e.prototype,"templates",void 0),e=__decorate([Component({selector:"p-organizationChart",template:'\n        <div [ngStyle]="style" [class]="styleClass" [ngClass]="{\'ui-organizationchart ui-widget\': true, \'ui-organizationchart-preservespace\': preserveSpace}">\n            <table class="ui-organizationchart-table" pOrganizationChartNode [node]="root" *ngIf="root"></table>\n        </div>\n    ',changeDetection:ChangeDetectionStrategy.Default})],e)}(),OrganizationChartModule=function(){function e(){}return e=__decorate([NgModule({imports:[CommonModule],exports:[OrganizationChart,SharedModule],declarations:[OrganizationChart,OrganizationChartNode]})],e)}();export{OrganizationChart,OrganizationChartModule,OrganizationChartNode};