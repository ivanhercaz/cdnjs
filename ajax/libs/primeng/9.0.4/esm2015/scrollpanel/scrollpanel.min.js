var __decorate=this&&this.__decorate||function(e,t,o,i){var n,l=arguments.length,s=l<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,i);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(l<3?n(s):l>3?n(t,o,s):n(t,o))||s);return l>3&&s&&Object.defineProperty(t,o,s),s};import{NgModule,Component,Input,AfterViewInit,OnDestroy,ElementRef,NgZone,ViewChild,ChangeDetectionStrategy}from"@angular/core";import{CommonModule}from"@angular/common";import{DomHandler}from"primeng/dom";let ScrollPanel=class{constructor(e,t){this.el=e,this.zone=t,this.timeoutFrame=(e=>setTimeout(e,0))}ngAfterViewInit(){this.zone.runOutsideAngular(()=>{this.moveBar(),this.moveBar=this.moveBar.bind(this),this.onXBarMouseDown=this.onXBarMouseDown.bind(this),this.onYBarMouseDown=this.onYBarMouseDown.bind(this),this.onDocumentMouseMove=this.onDocumentMouseMove.bind(this),this.onDocumentMouseUp=this.onDocumentMouseUp.bind(this),window.addEventListener("resize",this.moveBar),this.contentViewChild.nativeElement.addEventListener("scroll",this.moveBar),this.contentViewChild.nativeElement.addEventListener("mouseenter",this.moveBar),this.xBarViewChild.nativeElement.addEventListener("mousedown",this.onXBarMouseDown),this.yBarViewChild.nativeElement.addEventListener("mousedown",this.onYBarMouseDown),this.calculateContainerHeight(),this.initialized=!0})}calculateContainerHeight(){let e=this.containerViewChild.nativeElement,t=this.contentViewChild.nativeElement,o=this.xBarViewChild.nativeElement,i=getComputedStyle(e),n=getComputedStyle(o),l=DomHandler.getHeight(e)-parseInt(n.height,10);"none"!=i["max-height"]&&0==l&&(t.offsetHeight+parseInt(n.height,10)>parseInt(i["max-height"],10)?e.style.height=i["max-height"]:e.style.height=t.offsetHeight+parseFloat(i.paddingTop)+parseFloat(i.paddingBottom)+parseFloat(i.borderTopWidth)+parseFloat(i.borderBottomWidth)+"px")}moveBar(){let e=this.containerViewChild.nativeElement,t=this.contentViewChild.nativeElement,o=this.xBarViewChild.nativeElement,i=t.scrollWidth,n=t.clientWidth,l=-1*(e.clientHeight-o.clientHeight);this.scrollXRatio=n/i;let s=this.yBarViewChild.nativeElement,a=t.scrollHeight,r=t.clientHeight,d=-1*(e.clientWidth-s.clientWidth);this.scrollYRatio=r/a,this.requestAnimationFrame(()=>{if(this.scrollXRatio>=1)DomHandler.addClass(o,"ui-scrollpanel-hidden");else{DomHandler.removeClass(o,"ui-scrollpanel-hidden");const e=Math.max(100*this.scrollXRatio,10),s=t.scrollLeft*(100-e)/(i-n);o.style.cssText="width:"+e+"%; left:"+s+"%;bottom:"+l+"px;"}if(this.scrollYRatio>=1)DomHandler.addClass(s,"ui-scrollpanel-hidden");else{DomHandler.removeClass(s,"ui-scrollpanel-hidden");const e=Math.max(100*this.scrollYRatio,10),i=t.scrollTop*(100-e)/(a-r);s.style.cssText="height:"+e+"%; top: calc("+i+"% - "+o.clientHeight+"px);right:"+d+"px;"}})}onYBarMouseDown(e){this.isYBarClicked=!0,this.lastPageY=e.pageY,DomHandler.addClass(this.yBarViewChild.nativeElement,"ui-scrollpanel-grabbed"),DomHandler.addClass(document.body,"ui-scrollpanel-grabbed"),document.addEventListener("mousemove",this.onDocumentMouseMove),document.addEventListener("mouseup",this.onDocumentMouseUp),e.preventDefault()}onXBarMouseDown(e){this.isXBarClicked=!0,this.lastPageX=e.pageX,DomHandler.addClass(this.xBarViewChild.nativeElement,"ui-scrollpanel-grabbed"),DomHandler.addClass(document.body,"ui-scrollpanel-grabbed"),document.addEventListener("mousemove",this.onDocumentMouseMove),document.addEventListener("mouseup",this.onDocumentMouseUp),e.preventDefault()}onDocumentMouseMove(e){this.isXBarClicked?this.onMouseMoveForXBar(e):this.isYBarClicked?this.onMouseMoveForYBar(e):(this.onMouseMoveForXBar(e),this.onMouseMoveForYBar(e))}onMouseMoveForXBar(e){let t=e.pageX-this.lastPageX;this.lastPageX=e.pageX,this.requestAnimationFrame(()=>{this.contentViewChild.nativeElement.scrollLeft+=t/this.scrollXRatio})}onMouseMoveForYBar(e){let t=e.pageY-this.lastPageY;this.lastPageY=e.pageY,this.requestAnimationFrame(()=>{this.contentViewChild.nativeElement.scrollTop+=t/this.scrollYRatio})}scrollTop(e){let t=this.contentViewChild.nativeElement.scrollHeight-this.contentViewChild.nativeElement.clientHeight;e=e>t?t:e>0?e:0,this.contentViewChild.nativeElement.scrollTop=e}onDocumentMouseUp(e){DomHandler.removeClass(this.yBarViewChild.nativeElement,"ui-scrollpanel-grabbed"),DomHandler.removeClass(this.xBarViewChild.nativeElement,"ui-scrollpanel-grabbed"),DomHandler.removeClass(document.body,"ui-scrollpanel-grabbed"),document.removeEventListener("mousemove",this.onDocumentMouseMove),document.removeEventListener("mouseup",this.onDocumentMouseUp),this.isXBarClicked=!1,this.isYBarClicked=!1}requestAnimationFrame(e){(window.requestAnimationFrame||this.timeoutFrame)(e)}ngOnDestroy(){this.initialized&&(window.removeEventListener("resize",this.moveBar),this.contentViewChild.nativeElement.removeEventListener("scroll",this.moveBar),this.contentViewChild.nativeElement.removeEventListener("mouseenter",this.moveBar),this.xBarViewChild.nativeElement.removeEventListener("mousedown",this.onXBarMouseDown),this.yBarViewChild.nativeElement.removeEventListener("mousedown",this.onYBarMouseDown))}refresh(){this.moveBar()}};ScrollPanel.ctorParameters=(()=>[{type:ElementRef},{type:NgZone}]),__decorate([Input()],ScrollPanel.prototype,"style",void 0),__decorate([Input()],ScrollPanel.prototype,"styleClass",void 0),__decorate([ViewChild("container")],ScrollPanel.prototype,"containerViewChild",void 0),__decorate([ViewChild("content")],ScrollPanel.prototype,"contentViewChild",void 0),__decorate([ViewChild("xBar")],ScrollPanel.prototype,"xBarViewChild",void 0),__decorate([ViewChild("yBar")],ScrollPanel.prototype,"yBarViewChild",void 0);export{ScrollPanel};let ScrollPanelModule=class{};ScrollPanelModule=__decorate([NgModule({imports:[CommonModule],exports:[ScrollPanel=__decorate([Component({selector:"p-scrollPanel",template:'\n        <div #container [ngClass]="\'ui-scrollpanel ui-widget ui-widget-content ui-corner-all\'" [ngStyle]="style" [class]="styleClass">\n            <div class="ui-scrollpanel-wrapper">\n                <div #content class="ui-scrollpanel-content">\n                    <ng-content></ng-content>\n                </div>\n            </div>\n            <div #xBar class="ui-scrollpanel-bar ui-scrollpanel-bar-x"></div>\n            <div #yBar class="ui-scrollpanel-bar ui-scrollpanel-bar-y"></div>   \n        </div>\n    ',changeDetection:ChangeDetectionStrategy.Default})],ScrollPanel)],declarations:[ScrollPanel]})],ScrollPanelModule);export{ScrollPanelModule};