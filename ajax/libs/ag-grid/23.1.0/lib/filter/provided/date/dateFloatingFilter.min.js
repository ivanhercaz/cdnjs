"use strict";var __extends=this&&this.__extends||function(){var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)};return function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}(),__decorate=this&&this.__decorate||function(e,t,o,r){var i,n=arguments.length,a=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,r);else for(var p=e.length-1;0<=p;p--)(i=e[p])&&(a=(n<3?i(a):3<n?i(t,o,a):i(t,o))||a);return 3<n&&a&&Object.defineProperty(t,o,a),a},__metadata=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(exports,"__esModule",{value:!0});var dateFilter_1=require("./dateFilter"),context_1=require("../../../context/context"),userComponentFactory_1=require("../../../components/framework/userComponentFactory"),utils_1=require("../../../utils"),dateCompWrapper_1=require("./dateCompWrapper"),componentAnnotations_1=require("../../../widgets/componentAnnotations"),simpleFilter_1=require("../simpleFilter"),simpleFloatingFilter_1=require("../../floating/provided/simpleFloatingFilter"),providedFilter_1=require("../providedFilter"),DateFloatingFilter=function(i){function e(){return i.call(this,'<div class="ag-input-wrapper" role="presentation">\n                <input ref="eReadOnlyText" disabled="true" class="ag-floating-filter-input">\n                <div ref="eDateWrapper" style="display: flex; flex: 1 1 auto; overflow: hidden;"></div>\n            </div>')||this}return __extends(e,i),e.prototype.getDefaultFilterOptions=function(){return dateFilter_1.DateFilter.DEFAULT_FILTER_OPTIONS},e.prototype.conditionToString=function(e){return e.type==simpleFilter_1.SimpleFilter.IN_RANGE?e.dateFrom+"-"+e.dateTo:null!=e.dateFrom?""+e.dateFrom:""+e.type},e.prototype.init=function(e){i.prototype.init.call(this,e),this.params=e,this.createDateComponent()},e.prototype.setEditable=function(e){utils_1._.setDisplayed(this.eDateWrapper,e),utils_1._.setDisplayed(this.eReadOnlyText,!e)},e.prototype.onParentModelChanged=function(e,t){if(!this.isEventFromFloatingFilter(t)){i.prototype.setLastTypeFromModel.call(this,e);var o=this.canWeEditAfterModelFromParentFilter(e);if(this.setEditable(o),o){if(e){var r=e;this.dateComp.setDate(utils_1._.parseYyyyMmDdToDate(r.dateFrom,"-"))}else this.dateComp.setDate(null);this.eReadOnlyText.value=""}else this.eReadOnlyText.value=this.getTextFromModel(e),this.dateComp.setDate(null)}},e.prototype.onDateChanged=function(){var t=this,e=this.dateComp.getDate(),o=utils_1._.serializeDateToYyyyMmDd(e,"-");this.params.parentFilterInstance(function(e){e&&e.onFloatingFilterChanged(t.getLastType(),o)})},e.prototype.createDateComponent=function(){var e=this,t=providedFilter_1.ProvidedFilter.getDebounceMs(this.params.filterParams,this.getDefaultDebounceMs()),o={onDateChanged:utils_1._.debounce(this.onDateChanged.bind(this),t),filterParams:this.params.column.getColDef().filterParams};this.dateComp=new dateCompWrapper_1.DateCompWrapper(this.userComponentFactory,o,this.eDateWrapper),this.addDestroyFunc(function(){e.dateComp.destroy()})},__decorate([context_1.Autowired("userComponentFactory"),__metadata("design:type",userComponentFactory_1.UserComponentFactory)],e.prototype,"userComponentFactory",void 0),__decorate([componentAnnotations_1.RefSelector("eReadOnlyText"),__metadata("design:type",HTMLInputElement)],e.prototype,"eReadOnlyText",void 0),__decorate([componentAnnotations_1.RefSelector("eDateWrapper"),__metadata("design:type",HTMLInputElement)],e.prototype,"eDateWrapper",void 0),e}(simpleFloatingFilter_1.SimpleFloatingFilter);exports.DateFloatingFilter=DateFloatingFilter;