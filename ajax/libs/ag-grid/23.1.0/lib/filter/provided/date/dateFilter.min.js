"use strict";var __extends=this&&this.__extends||function(){var r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)};return function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}}(),__decorate=this&&this.__decorate||function(t,e,o,r){var a,i=arguments.length,n=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;0<=s;s--)(a=t[s])&&(n=(i<3?a(n):3<i?a(e,o,n):a(e,o))||n);return 3<i&&n&&Object.defineProperty(e,o,n),n},__metadata=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(exports,"__esModule",{value:!0});var componentAnnotations_1=require("../../../widgets/componentAnnotations"),context_1=require("../../../context/context"),userComponentFactory_1=require("../../../components/framework/userComponentFactory"),utils_1=require("../../../utils"),dateCompWrapper_1=require("./dateCompWrapper"),simpleFilter_1=require("../simpleFilter"),scalerFilter_1=require("../scalerFilter"),DateFilter=function(a){function i(){return null!==a&&a.apply(this,arguments)||this}return __extends(i,a),i.prototype.mapRangeFromModel=function(t){return{from:utils_1._.parseYyyyMmDdToDate(t.dateFrom,"-"),to:utils_1._.parseYyyyMmDdToDate(t.dateTo,"-")}},i.prototype.setValueFromFloatingFilter=function(t){if(null!=t){var e=utils_1._.parseYyyyMmDdToDate(t,"-");this.dateCompFrom1.setDate(e)}else this.dateCompFrom1.setDate(null);this.dateCompTo1.setDate(null),this.dateCompFrom2.setDate(null),this.dateCompTo2.setDate(null)},i.prototype.setConditionIntoUi=function(t,e){var o=e===simpleFilter_1.ConditionPosition.One,r=t?t.dateFrom:null,a=t?t.dateTo:null,i=utils_1._.parseYyyyMmDdToDate(r,"-"),n=utils_1._.parseYyyyMmDdToDate(a,"-"),s=o?this.dateCompFrom1:this.dateCompFrom2,p=o?this.dateCompTo1:this.dateCompTo2;s.setDate(i),p.setDate(n)},i.prototype.resetUiToDefaults=function(){a.prototype.resetUiToDefaults.call(this),this.dateCompTo1.setDate(null),this.dateCompTo2.setDate(null),this.dateCompFrom1.setDate(null),this.dateCompFrom2.setDate(null)},i.prototype.comparator=function(){return this.dateFilterParams.comparator?this.dateFilterParams.comparator:this.defaultComparator.bind(this)},i.prototype.defaultComparator=function(t,e){return e<t?-1:t<e?1:null!=e?0:-1},i.prototype.setParams=function(t){a.prototype.setParams.call(this,t),this.dateFilterParams=t,this.createDateComponents()},i.prototype.createDateComponents=function(){var t=this,e={onDateChanged:function(){return t.onUiChanged()},filterParams:this.dateFilterParams};this.dateCompFrom1=new dateCompWrapper_1.DateCompWrapper(this.userComponentFactory,e,this.ePanelFrom1),this.dateCompFrom2=new dateCompWrapper_1.DateCompWrapper(this.userComponentFactory,e,this.ePanelFrom2),this.dateCompTo1=new dateCompWrapper_1.DateCompWrapper(this.userComponentFactory,e,this.ePanelTo1),this.dateCompTo2=new dateCompWrapper_1.DateCompWrapper(this.userComponentFactory,e,this.ePanelTo2),this.addDestroyFunc(function(){t.dateCompFrom1.destroy(),t.dateCompFrom2.destroy(),t.dateCompTo1.destroy(),t.dateCompTo2.destroy()})},i.prototype.getDefaultFilterOptions=function(){return i.DEFAULT_FILTER_OPTIONS},i.prototype.createValueTemplate=function(t){var e=t===simpleFilter_1.ConditionPosition.One?"1":"2";return'<div class="ag-filter-body" ref="eCondition'+e+'Body">\n                    <div class="ag-filter-date-from" ref="ePanelFrom'+e+'">\n                    </div>\n                    <div class="ag-filter-date-to" ref="ePanelTo'+e+'"">\n                    </div>\n                </div>'},i.prototype.isConditionUiComplete=function(t){var e=t===simpleFilter_1.ConditionPosition.One,o=e?this.getCondition1Type():this.getCondition2Type(),r=e?this.dateCompFrom1:this.dateCompFrom2,a=e?this.dateCompTo1:this.dateCompTo2,i=r.getDate(),n=a.getDate();return o!==simpleFilter_1.SimpleFilter.EMPTY&&(!!this.doesFilterHaveHiddenInput(o)||(o===simpleFilter_1.SimpleFilter.IN_RANGE?null!=i&&null!=n:null!=i))},i.prototype.areSimpleModelsEqual=function(t,e){return t.dateFrom===e.dateFrom&&t.dateTo===e.dateTo&&t.type===e.type},i.prototype.getFilterType=function(){return i.FILTER_TYPE},i.prototype.createCondition=function(t){var e=t===simpleFilter_1.ConditionPosition.One,o=e?this.getCondition1Type():this.getCondition2Type(),r=e?this.dateCompTo1:this.dateCompTo2,a=e?this.dateCompFrom1:this.dateCompFrom2;return{dateTo:utils_1._.serializeDateToYyyyMmDd(r.getDate(),"-"),dateFrom:utils_1._.serializeDateToYyyyMmDd(a.getDate(),"-"),type:o,filterType:i.FILTER_TYPE}},i.prototype.updateUiVisibility=function(){a.prototype.updateUiVisibility.call(this);var t=this.showValueFrom(this.getCondition1Type());utils_1._.setDisplayed(this.ePanelFrom1,t);var e=this.showValueTo(this.getCondition1Type());utils_1._.setDisplayed(this.ePanelTo1,e);var o=this.showValueFrom(this.getCondition2Type());utils_1._.setDisplayed(this.ePanelFrom2,o);var r=this.showValueTo(this.getCondition2Type());utils_1._.setDisplayed(this.ePanelTo2,r)},i.FILTER_TYPE="date",i.DEFAULT_FILTER_OPTIONS=[scalerFilter_1.ScalerFilter.EQUALS,scalerFilter_1.ScalerFilter.GREATER_THAN,scalerFilter_1.ScalerFilter.LESS_THAN,scalerFilter_1.ScalerFilter.NOT_EQUAL,scalerFilter_1.ScalerFilter.IN_RANGE],__decorate([componentAnnotations_1.RefSelector("ePanelFrom1"),__metadata("design:type",HTMLElement)],i.prototype,"ePanelFrom1",void 0),__decorate([componentAnnotations_1.RefSelector("ePanelFrom2"),__metadata("design:type",HTMLElement)],i.prototype,"ePanelFrom2",void 0),__decorate([componentAnnotations_1.RefSelector("ePanelTo1"),__metadata("design:type",HTMLElement)],i.prototype,"ePanelTo1",void 0),__decorate([componentAnnotations_1.RefSelector("ePanelTo2"),__metadata("design:type",HTMLElement)],i.prototype,"ePanelTo2",void 0),__decorate([context_1.Autowired("userComponentFactory"),__metadata("design:type",userComponentFactory_1.UserComponentFactory)],i.prototype,"userComponentFactory",void 0),i}(scalerFilter_1.ScalerFilter);exports.DateFilter=DateFilter;