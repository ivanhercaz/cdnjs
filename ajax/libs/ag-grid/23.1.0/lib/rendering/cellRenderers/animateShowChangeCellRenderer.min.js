"use strict";var __extends=this&&this.__extends||function(){var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])})(e,t)};return function(e,t){function a(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)}}(),__decorate=this&&this.__decorate||function(e,t,a,r){var n,s=arguments.length,i=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,a):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,a,r);else for(var l=e.length-1;0<=l;l--)(n=e[l])&&(i=(s<3?n(i):3<s?n(t,a,i):n(t,a))||i);return 3<s&&i&&Object.defineProperty(t,a,i),i},__metadata=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(exports,"__esModule",{value:!0});var component_1=require("../../widgets/component"),utils_1=require("../../utils"),filterManager_1=require("../../filter/filterManager"),context_1=require("../../context/context"),ARROW_UP="↑",ARROW_DOWN="↓",AnimateShowChangeCellRenderer=function(t){function a(){var e=t.call(this,a.TEMPLATE)||this;return e.refreshCount=0,e}return __extends(a,t),a.prototype.init=function(e){this.eValue=this.queryForHtmlElement(".ag-value-change-value"),this.eDelta=this.queryForHtmlElement(".ag-value-change-delta"),this.refresh(e)},a.prototype.showDelta=function(e,t){var a=Math.abs(t),r=e.formatValue(a),n=utils_1._.exists(r)?r:a,s=0<=t;this.eDelta.innerHTML=s?ARROW_UP+n:ARROW_DOWN+n,utils_1._.addOrRemoveCssClass(this.eDelta,"ag-value-change-delta-up",s),utils_1._.addOrRemoveCssClass(this.eDelta,"ag-value-change-delta-down",!s)},a.prototype.setTimerToRemoveDelta=function(){var e=this;this.refreshCount++;var t=this.refreshCount;window.setTimeout(function(){t===e.refreshCount&&e.hideDeltaValue()},2e3)},a.prototype.hideDeltaValue=function(){utils_1._.removeCssClass(this.eValue,"ag-value-change-value-highlight"),utils_1._.clearElement(this.eDelta)},a.prototype.refresh=function(e){var t=e.value;if(t!==this.lastValue&&(utils_1._.exists(e.valueFormatted)?this.eValue.innerHTML=e.valueFormatted:utils_1._.exists(e.value)?this.eValue.innerHTML=t:utils_1._.clearElement(this.eValue),!this.filterManager.isSuppressFlashingCellsBecauseFiltering())){if("number"==typeof t&&"number"==typeof this.lastValue){var a=t-this.lastValue;this.showDelta(e,a)}return this.lastValue&&utils_1._.addCssClass(this.eValue,"ag-value-change-value-highlight"),this.setTimerToRemoveDelta(),this.lastValue=t,!0}},a.TEMPLATE='<span><span class="ag-value-change-delta"></span><span class="ag-value-change-value"></span></span>',__decorate([context_1.Autowired("filterManager"),__metadata("design:type",filterManager_1.FilterManager)],a.prototype,"filterManager",void 0),a}(component_1.Component);exports.AnimateShowChangeCellRenderer=AnimateShowChangeCellRenderer;