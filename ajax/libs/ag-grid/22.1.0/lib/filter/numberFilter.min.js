"use strict";var __extends=this&&this.__extends||function(){var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)};return function(e,t){function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}}(),__decorate=this&&this.__decorate||function(e,t,i,r){var o,n=arguments.length,l=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,i,r);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(l=(n<3?o(l):3<n?o(t,i,l):o(t,i))||l);return 3<n&&l&&Object.defineProperty(t,i,l),l},__metadata=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(exports,"__esModule",{value:!0});var componentAnnotations_1=require("../widgets/componentAnnotations"),baseFilter_1=require("./baseFilter"),utils_1=require("../utils"),NumberFilter=function(t){function l(){return null!==t&&t.apply(this,arguments)||this}return __extends(l,t),l.prototype.modelFromFloatingFilter=function(e){return{type:this.selectedFilter,filter:Number(e),filterTo:this.filterNumberTo,filterType:"number"}},l.prototype.getApplicableFilterTypes=function(){return[baseFilter_1.BaseFilter.EQUALS,baseFilter_1.BaseFilter.NOT_EQUAL,baseFilter_1.BaseFilter.LESS_THAN,baseFilter_1.BaseFilter.LESS_THAN_OR_EQUAL,baseFilter_1.BaseFilter.GREATER_THAN,baseFilter_1.BaseFilter.GREATER_THAN_OR_EQUAL,baseFilter_1.BaseFilter.IN_RANGE]},l.prototype.bodyTemplate=function(e){var t=this.translate.bind(this),i=e==baseFilter_1.FilterConditionType.MAIN?"filterText":"filterConditionText",r=e==baseFilter_1.FilterConditionType.MAIN?"filterNumberToPanel":"filterNumberToPanelCondition",o=e==baseFilter_1.FilterConditionType.MAIN?"filterToText":"filterToConditionText";return'<div class="ag-filter-body">\n            <div class="ag-input-text-wrapper">\n                <input class="ag-filter-filter" id="'+i+'" type="text" placeholder="'+t("filterOoo")+'"/>\n            </div>\n             <div class="ag-input-text-wrapper ag-filter-number-to" id="'+r+'">\n                <input class="ag-filter-filter" id="'+o+'" type="text" placeholder="'+t("filterOoo")+'"/>\n            </div>\n        </div>'},l.prototype.initialiseFilterBodyUi=function(e){t.prototype.initialiseFilterBodyUi.call(this,e),e===baseFilter_1.FilterConditionType.MAIN?(this.eFilterTextField=this.queryForHtmlInputElement("#filterText"),this.addFilterChangedEventListeners(e,this.eFilterTextField,this.eFilterToTextField)):(this.eFilterTextConditionField=this.queryForHtmlInputElement("#filterConditionText"),this.addFilterChangedEventListeners(e,this.eFilterTextConditionField,this.eFilterToConditionText),this.setFilter(this.filterNumberCondition,baseFilter_1.FilterConditionType.CONDITION),this.setFilterTo(this.filterNumberConditionTo,baseFilter_1.FilterConditionType.CONDITION),this.setFilterType(this.selectedFilterCondition,baseFilter_1.FilterConditionType.CONDITION))},l.prototype.addFilterChangedEventListeners=function(e,t,i){var r=this,o=this.getDebounceMs(this.filterParams),n=utils_1._.debounce(function(){return r.onTextFieldsChanged(e,t,i)},o);this.addDestroyableEventListener(t,"input",n),this.addDestroyableEventListener(i,"input",n)},l.prototype.afterGuiAttached=function(){this.eFilterTextField.focus()},l.prototype.comparator=function(){return function(e,t){return e===t?0:e<t?1:t<e?-1:void 0}},l.prototype.onTextFieldsChanged=function(e,t,i){var r=this.stringToFloat(t.value),o=this.stringToFloat(i.value);e===baseFilter_1.FilterConditionType.MAIN?this.filterNumber===r&&this.filterNumberTo===o||(this.filterNumber=r,this.filterNumberTo=o,this.onFilterChanged()):this.filterNumberCondition===r&&this.filterNumberConditionTo===o||(this.filterNumberCondition=r,this.filterNumberConditionTo=o,this.onFilterChanged())},l.prototype.filterValues=function(e){return e===baseFilter_1.FilterConditionType.MAIN?this.selectedFilter!==baseFilter_1.BaseFilter.IN_RANGE?this.asNumber(this.filterNumber):[this.asNumber(this.filterNumber),this.asNumber(this.filterNumberTo)]:this.selectedFilterCondition!==baseFilter_1.BaseFilter.IN_RANGE?this.asNumber(this.filterNumberCondition):[this.asNumber(this.filterNumberCondition),this.asNumber(this.filterNumberConditionTo)]},l.prototype.asNumber=function(e){return utils_1._.isNumeric(e)?e:null},l.prototype.stringToFloat=function(e){var t=utils_1._.makeNull(e);return t&&""===t.trim()&&(t=null),null!=t?parseFloat(t):null},l.prototype.setFilter=function(e,t){if(null!==(e=utils_1._.makeNull(e))&&"number"!=typeof e&&(e=parseFloat(e)),t===baseFilter_1.FilterConditionType.MAIN){if(this.filterNumber=e,!this.eFilterTextField)return;this.eFilterTextField.value=e}else{if(this.filterNumberCondition=e,!this.eFilterTextConditionField)return;this.eFilterTextConditionField.value=e}},l.prototype.setFilterTo=function(e,t){if(null!==(e=utils_1._.makeNull(e))&&"number"!=typeof e&&(e=parseFloat(e)),t===baseFilter_1.FilterConditionType.MAIN){if(this.filterNumberTo=e,!this.eFilterToTextField)return;this.eFilterToTextField.value=e}else{if(this.filterNumberConditionTo=e,!this.eFilterToConditionText)return;this.eFilterToConditionText.value=e}},l.prototype.getFilter=function(e){return e===baseFilter_1.FilterConditionType.MAIN?this.filterNumber:this.filterNumberCondition},l.prototype.serialize=function(e){var t=e===baseFilter_1.FilterConditionType.MAIN?this.selectedFilter:this.selectedFilterCondition,i=e===baseFilter_1.FilterConditionType.MAIN?this.filterNumber:this.filterNumberCondition,r=e===baseFilter_1.FilterConditionType.MAIN?this.filterNumberTo:this.filterNumberConditionTo;return{type:t||this.defaultFilter,filter:i,filterTo:r,filterType:"number"}},l.prototype.parse=function(e,t){this.setFilterType(e.type,t),this.setFilter(e.filter,t),this.setFilterTo(e.filterTo,t)},l.prototype.refreshFilterBodyUi=function(e){var t=e===baseFilter_1.FilterConditionType.MAIN?this.selectedFilter:this.selectedFilterCondition,i=e===baseFilter_1.FilterConditionType.MAIN?this.eNumberToPanel:this.eNumberToConditionPanel;if(i){var r=t===l.IN_RANGE;utils_1._.setVisible(i,r)}var o=e===baseFilter_1.FilterConditionType.MAIN?this.eFilterTextField:this.eFilterTextConditionField;if(o){var n=!this.doesFilterHaveHiddenInput(t)&&t!==baseFilter_1.BaseFilter.EMPTY;utils_1._.setVisible(o,n)}},l.prototype.resetState=function(e){void 0===e&&(e=!1),e||(this.setFilterType(this.defaultFilter,baseFilter_1.FilterConditionType.MAIN),this.setFilter(null,baseFilter_1.FilterConditionType.MAIN),this.setFilterTo(null,baseFilter_1.FilterConditionType.MAIN)),this.setFilterType(this.defaultFilter,baseFilter_1.FilterConditionType.CONDITION),this.setFilter(null,baseFilter_1.FilterConditionType.CONDITION),this.setFilterTo(null,baseFilter_1.FilterConditionType.CONDITION)},l.prototype.setType=function(e,t){this.setFilterType(e,t)},l.LESS_THAN="lessThan",__decorate([componentAnnotations_1.QuerySelector("#filterText"),__metadata("design:type",HTMLInputElement)],l.prototype,"eFilterTextField",void 0),__decorate([componentAnnotations_1.QuerySelector("#filterTextCondition"),__metadata("design:type",HTMLInputElement)],l.prototype,"eFilterTextConditionField",void 0),__decorate([componentAnnotations_1.QuerySelector("#filterToText"),__metadata("design:type",HTMLInputElement)],l.prototype,"eFilterToTextField",void 0),__decorate([componentAnnotations_1.QuerySelector("#filterToConditionText"),__metadata("design:type",HTMLInputElement)],l.prototype,"eFilterToConditionText",void 0),__decorate([componentAnnotations_1.QuerySelector("#filterNumberToPanel"),__metadata("design:type",HTMLElement)],l.prototype,"eNumberToPanel",void 0),__decorate([componentAnnotations_1.QuerySelector("#filterNumberToPanelCondition"),__metadata("design:type",HTMLElement)],l.prototype,"eNumberToConditionPanel",void 0),l}(baseFilter_1.ScalarBaseFilter);exports.NumberFilter=NumberFilter;