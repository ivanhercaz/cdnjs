"use strict";var __extends=this&&this.__extends||function(){var r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}(),__decorate=this&&this.__decorate||function(t,e,i,r){var n,o=arguments.length,l=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;0<=a;a--)(n=t[a])&&(l=(o<3?n(l):3<o?n(e,i,l):n(e,i))||l);return 3<o&&l&&Object.defineProperty(e,i,l),l},__metadata=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(exports,"__esModule",{value:!0});var componentAnnotations_1=require("../../../widgets/componentAnnotations"),utils_1=require("../../../utils"),simpleFilter_1=require("../simpleFilter"),TextFilter=function(i){function l(){return null!==i&&i.apply(this,arguments)||this}return __extends(l,i),l.prototype.getDefaultDebounceMs=function(){return 500},l.prototype.getValue=function(t){var e=t.value;return(e=utils_1._.makeNull(e))&&""===e.trim()&&(e=null),e},l.prototype.addValueChangedListeners=function(){function t(){return e.onUiChanged()}var e=this;this.addDestroyableEventListener(this.eValue1,"input",t),this.addDestroyableEventListener(this.eValue2,"input",t)},l.prototype.setParams=function(t){i.prototype.setParams.call(this,t),this.textFilterParams=t,this.comparator=this.textFilterParams.textCustomComparator?this.textFilterParams.textCustomComparator:l.DEFAULT_COMPARATOR,this.formatter=this.textFilterParams.textFormatter?this.textFilterParams.textFormatter:1==this.textFilterParams.caseSensitive?l.DEFAULT_FORMATTER:l.DEFAULT_LOWERCASE_FORMATTER,this.addValueChangedListeners()},l.prototype.setConditionIntoUi=function(t,e){(e===simpleFilter_1.ConditionPosition.One?this.eValue1:this.eValue2).value=t?t.filter:null},l.prototype.createCondition=function(t){var e=t===simpleFilter_1.ConditionPosition.One,i=e?this.getCondition1Type():this.getCondition2Type(),r=e?this.eValue1:this.eValue2,n=this.getValue(r),o={filterType:l.FILTER_TYPE,type:i};return this.doesFilterHaveHiddenInput(i)||(o.filter=n),o},l.prototype.getFilterType=function(){return l.FILTER_TYPE},l.prototype.areSimpleModelsEqual=function(t,e){return t.filter===e.filter&&t.type===e.type},l.prototype.resetUiToDefaults=function(){i.prototype.resetUiToDefaults.call(this),this.eValue1.value=null,this.eValue2.value=null},l.prototype.setValueFromFloatingFilter=function(t){this.eValue1.value=t,this.eValue2.value=null},l.prototype.getDefaultFilterOptions=function(){return l.DEFAULT_FILTER_OPTIONS},l.prototype.createValueTemplate=function(t){var e=t===simpleFilter_1.ConditionPosition.One?"1":"2";return'<div class="ag-filter-body" ref="eCondition'+e+'Body" role="presentation">\n            <div class="ag-input-wrapper" ref="eInputWrapper'+e+'" role="presentation">\n                <input class="ag-filter-filter" ref="eValue'+e+'" type="text" placeholder="'+this.gridOptionsWrapper.getLocaleTextFunc()("filterOoo","Filter...")+'"/>\n            </div>\n        </div>'},l.prototype.updateUiVisibility=function(){i.prototype.updateUiVisibility.call(this);var t=this.showValueFrom(this.getCondition1Type());utils_1._.setDisplayed(this.eInputWrapper1,t);var e=this.showValueFrom(this.getCondition2Type());utils_1._.setDisplayed(this.eInputWrapper2,e)},l.prototype.afterGuiAttached=function(){this.eValue1.focus()},l.prototype.isConditionUiComplete=function(t){var e=t===simpleFilter_1.ConditionPosition.One,i=e?this.getCondition1Type():this.getCondition2Type(),r=e?this.eValue1:this.eValue2;if(i===simpleFilter_1.SimpleFilter.EMPTY)return!1;var n=this.getValue(r);return!!this.doesFilterHaveHiddenInput(i)||null!=n},l.prototype.individualConditionPasses=function(t,e){var i=e.filter,r=e.type,n=this.textFilterParams.valueGetter(t.node),o=this.formatter(n),l=this.optionsFactory.getCustomOption(r);if(l&&(null!=i||l.hideFilterInput))return l.test(i,o);if(null==n)return r===simpleFilter_1.SimpleFilter.NOT_EQUAL||r===simpleFilter_1.SimpleFilter.NOT_CONTAINS;var a=this.formatter(i);return this.comparator(r,o,a)},l.FILTER_TYPE="text",l.DEFAULT_FILTER_OPTIONS=[simpleFilter_1.SimpleFilter.CONTAINS,simpleFilter_1.SimpleFilter.NOT_CONTAINS,simpleFilter_1.SimpleFilter.EQUALS,simpleFilter_1.SimpleFilter.NOT_EQUAL,simpleFilter_1.SimpleFilter.STARTS_WITH,simpleFilter_1.SimpleFilter.ENDS_WITH],l.DEFAULT_FORMATTER=function(t){return t},l.DEFAULT_LOWERCASE_FORMATTER=function(t){return null==t?null:t.toString().toLowerCase()},l.DEFAULT_COMPARATOR=function(t,e,i){switch(t){case l.CONTAINS:return 0<=e.indexOf(i);case l.NOT_CONTAINS:return-1===e.indexOf(i);case l.EQUALS:return e===i;case l.NOT_EQUAL:return e!=i;case l.STARTS_WITH:return 0===e.indexOf(i);case l.ENDS_WITH:var r=e.lastIndexOf(i);return 0<=r&&r===e.length-i.length;default:return console.warn("invalid filter type "+t),!1}},__decorate([componentAnnotations_1.RefSelector("eValue1"),__metadata("design:type",HTMLInputElement)],l.prototype,"eValue1",void 0),__decorate([componentAnnotations_1.RefSelector("eValue2"),__metadata("design:type",HTMLInputElement)],l.prototype,"eValue2",void 0),__decorate([componentAnnotations_1.RefSelector("eInputWrapper1"),__metadata("design:type",HTMLElement)],l.prototype,"eInputWrapper1",void 0),__decorate([componentAnnotations_1.RefSelector("eInputWrapper2"),__metadata("design:type",HTMLElement)],l.prototype,"eInputWrapper2",void 0),l}(simpleFilter_1.SimpleFilter);exports.TextFilter=TextFilter;