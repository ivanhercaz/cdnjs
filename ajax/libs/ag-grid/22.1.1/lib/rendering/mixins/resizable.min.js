"use strict";var __extends=this&&this.__extends||function(){var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)};return function(e,t){function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}}(),__decorate=this&&this.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;0<=a;a--)(o=e[a])&&(n=(s<3?o(n):3<s?o(t,i,n):o(t,i))||n);return 3<s&&n&&Object.defineProperty(t,i,n),n},__metadata=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(exports,"__esModule",{value:!0});var context_1=require("../../context/context"),dragService_1=require("../../dragAndDrop/dragService");function Resizable(e){var t;function i(){var e=null!==t&&t.apply(this,arguments)||this;return e.RESIZE_TEMPLATE='\n            <div class="ag-resizer-wrapper">\n                <div ref="eTopLeftResizer" class="ag-resizer ag-resizer-topLeft"></div>\n                <div ref="eTopResizer" class="ag-resizer ag-resizer-top"></div>\n                <div ref="eTopRightResizer" class="ag-resizer ag-resizer-topRight"></div>\n                <div ref="eRightResizer" class="ag-resizer ag-resizer-right"></div>\n                <div ref="eBottomRightResizer" class="ag-resizer ag-resizer-bottomRight"></div>\n                <div ref="eBottomResizer" class="ag-resizer ag-resizer-bottom"></div>\n                <div ref="eBottomLeftResizer" class="ag-resizer ag-resizer-bottomLeft"></div>\n                <div ref="eLeftResizer" class="ag-resizer ag-resizer-left"></div>\n            </div>\n        ',e.resizable={},e.isResizable=!1,e.isResizing=!1,e.lastPosition={x:0,y:0,width:0,height:0},e}return __extends(i,t=e),i.prototype.postConstruct=function(){t.prototype.postConstruct.call(this);var e=this.config.resizable;this.addResizers(),e&&this.setResizable(e)},i.prototype.addResizers=function(){var e=this.getGui();if(e){var t=(new DOMParser).parseFromString(this.RESIZE_TEMPLATE,"text/html").body;e.appendChild(t.firstChild),this.createMap()}},i.prototype.createMap=function(){var e=this.getGui();this.resizerMap={topLeft:{element:e.querySelector("[ref=eTopLeftResizer]")},top:{element:e.querySelector("[ref=eTopResizer]")},topRight:{element:e.querySelector("[ref=eTopRightResizer]")},right:{element:e.querySelector("[ref=eRightResizer]")},bottomRight:{element:e.querySelector("[ref=eBottomRightResizer]")},bottom:{element:e.querySelector("[ref=eBottomResizer]")},bottomLeft:{element:e.querySelector("[ref=eBottomLeftResizer]")},left:{element:e.querySelector("[ref=eLeftResizer]")}}},i.prototype.getResizerElement=function(e){return this.resizerMap[e].element},i.prototype.onResizeStart=function(e){this.isResizing=!0,this.updateDragStartPosition(e.clientX,e.clientY)},i.prototype.onResize=function(e,t){if(this.isResizing){var i=!!t.match(/left/i),r=!!t.match(/right/i),o=!!t.match(/top/i),s=!!t.match(/bottom/i),n=i||r,a=o||s,c=this.calculateMouseMovement({e:e,isLeft:i,isTop:o}),p=c.movementX,l=c.movementY,f=0,h=0;if(n&&p){var g=i?-1:1,d=this.getWidth(),u=d+p*g,z=!1;i&&(f=d-u,(this.position.x+f<=0||u<=this.minWidth)&&(z=!0,f=0)),z||this.setWidth(u)}if(a&&l){g=o?-1:1;var v=this.getHeight(),R=v+l*g,m=!1;o&&(h=v-R,(this.position.y+h<=0||R<=this.minHeight)&&(m=!0,h=0)),m||this.setHeight(R)}this.updateDragStartPosition(e.clientX,e.clientY),(f||h)&&this.offsetElement(this.position.x+f,this.position.y+h)}},i.prototype.onResizeEnd=function(){this.isResizing=!1;var e={type:"resize",api:this.gridOptionsWrapper.getApi(),columnApi:this.gridOptionsWrapper.getColumnApi()};this.localEventService&&this.localEventService.dispatchEvent(e)},i.prototype.destroy=function(){t.prototype.destroy.call(this),this.setResizable(!1)},i.prototype.setResizable=function(s){var n=this,a=!1;"boolean"==typeof s&&(s={topLeft:s,top:s,topRight:s,right:s,bottomRight:s,bottom:s,bottomLeft:s,left:s}),Object.keys(s).forEach(function(e){var t=e,i=!!s[t],r=n.getResizerElement(t),o=n.resizerMap[t].dragSource||{eElement:r,onDragStart:n.onResizeStart.bind(n),onDragging:function(e){return n.onResize(e,t)},onDragStop:n.onResizeEnd.bind(n)};!!n.resizable[t]==i&&(n.isAlive()||i)||(i?(n.dragService.addDragSource(o),r.style.pointerEvents="all",a=!0):(n.dragService.removeDragSource(o),r.style.pointerEvents="none"),n.resizerMap[t].dragSource=i?o:void 0)}),this.isResizable=a},__decorate([context_1.Autowired("dragService"),__metadata("design:type",dragService_1.DragService)],i.prototype,"dragService",void 0),i}exports.Resizable=Resizable;