!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n((t=t||self).popmotion={})}(this,function(t){"use strict";var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var r in n)n.hasOwnProperty(r)&&(t[r]=n[r])})(t,n)};function n(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}var x=function(){return(x=Object.assign||function(t){for(var n,r=1,e=arguments.length;r<e;r++)for(var o in n=arguments[r])Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o]);return t}).apply(this,arguments)};function s(t,n){var r={};for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&n.indexOf(e)<0&&(r[e]=t[e]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(e=Object.getOwnPropertySymbols(t);o<e.length;o++)n.indexOf(e[o])<0&&Object.prototype.propertyIsEnumerable.call(t,e[o])&&(r[e[o]]=t[e[o]])}return r}function r(n,r){return function(t){return Math.max(Math.min(t,r),n)}}function c(t){return t%1?Number(t.toFixed(5)):t}function o(n){return{test:function(t){return"string"==typeof t&&t.endsWith(n)&&1===t.split(" ").length},parse:parseFloat,transform:function(t){return""+t+n}}}function u(t){return void 0!==t.red}function i(t){return void 0!==t.hue}function a(o){return function(t){if("string"!=typeof t)return t;for(var n={},r=function(t){return t.substring(t.indexOf("(")+1,t.lastIndexOf(")"))}(t).split(/,\s*/),e=0;e<4;e++)n[o[e]]=void 0!==r[e]?parseFloat(r[e]):1;return n}}var f=function(){return(f=Object.assign||function(t){for(var n,r=1,e=arguments.length;r<e;r++)for(var o in n=arguments[r])Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o]);return t}).apply(this,arguments)},p=/(-)?(\d[\d\.]*)/g,d=/(#[0-9a-f]{6}|#[0-9a-f]{3}|#(?:[0-9a-f]{2}){2,4}|(rgb|hsl)a?\((-?\d+%?[,\s]+){2,3}\s*[\d\.]+%?\))/gi,l=/^(#[0-9a-f]{3}|#(?:[0-9a-f]{2}){2,4}|(rgb|hsl)a?\((-?\d+%?[,\s]+){2,3}\s*[\d\.]+%?\))$/i,v={test:function(t){return"number"==typeof t},parse:parseFloat,transform:function(t){return t}},h=(f({},v,{transform:r(0,1)}),f({},v,{default:1}),o("deg")),m=o("%"),y=o("px"),g=o("vh"),b=o("vw"),w=(f({},m,{parse:function(t){return m.parse(t)/100},transform:function(t){return m.transform(100*t)}}),r(0,255)),O=f({},v,{transform:function(t){return Math.round(w(t))}});function M(t,n){return t.startsWith(n)&&l.test(t)}function A(t){return"number"==typeof t?0:t}var P,C={test:function(t){return"string"==typeof t?M(t,"rgb"):u(t)},parse:a(["red","green","blue","alpha"]),transform:function(t){var n=t.red,r=t.green,e=t.blue,o=t.alpha;return function(t){var n=t.red,r=t.green,e=t.blue,o=t.alpha;return"rgba("+n+", "+r+", "+e+", "+(void 0===o?1:o)+")"}({red:O.transform(n),green:O.transform(r),blue:O.transform(e),alpha:c(o)})}},S={test:function(t){return"string"==typeof t?M(t,"hsl"):i(t)},parse:a(["hue","saturation","lightness","alpha"]),transform:function(t){var n=t.hue,r=t.saturation,e=t.lightness,o=t.alpha;return function(t){var n=t.hue,r=t.saturation,e=t.lightness,o=t.alpha;return"hsla("+n+", "+r+", "+e+", "+(void 0===o?1:o)+")"}({hue:Math.round(n),saturation:m.transform(c(r)),lightness:m.transform(c(e)),alpha:c(o)})}},V=f({},C,{test:function(t){return"string"==typeof t&&M(t,"#")},parse:function(t){var n="",r="",e="";return 4<t.length?(n=t.substr(1,2),r=t.substr(3,2),e=t.substr(5,2)):(n=t.substr(1,1),r=t.substr(2,1),e=t.substr(3,1),n+=n,r+=r,e+=e),{red:parseInt(n,16),green:parseInt(r,16),blue:parseInt(e,16),alpha:1}}}),j=function(t){return"string"==typeof t&&l.test(t)||u(t)||i(t)},k=function(t){return C.test(t)?C.parse(t):S.test(t)?S.parse(t):V.test(t)?V.parse(t):t},E=function(t){return u(t)?C.transform(t):i(t)?S.transform(t):t},D="${c}",F="${n}",R={test:function(t){if("string"!=typeof t||!isNaN(t))return!1;var n=0,r=t.match(p),e=t.match(d);return r&&(n+=r.length),e&&(n+=e.length),0<n},parse:function(t){var n=t,r=[],e=n.match(d);e&&(n=n.replace(d,D),r.push.apply(r,e.map(k)));var o=n.match(p);return o&&r.push.apply(r,o.map(v.parse)),r},createTransformer:function(t){var e=t,o=0,n=t.match(d),u=n?n.length:0;if(n)for(var r=0;r<u;r++)e=e.replace(n[r],D),o++;var i=e.match(p),a=i?i.length:0;if(i)for(r=0;r<a;r++)e=e.replace(i[r],F),o++;return function(t){for(var n=e,r=0;r<o;r++)n=n.replace(r<u?D:F,r<u?E(t[r]):c(t[r]));return n}},getAnimatableNone:function(t){var n=R.parse(t);return R.createTransformer(t)(n.map(A))}};P=function(t,n){if(!t)throw new Error(n)};var T,X,Y=0,_="undefined"!=typeof window&&void 0!==window.requestAnimationFrame?function(t){return window.requestAnimationFrame(t)}:function(t){var n=Date.now(),r=Math.max(0,16.7-(n-Y));Y=n+r,setTimeout(function(){return t(Y)},r)};(X=T=T||{}).Read="read",X.Update="update",X.Render="render",X.PostRender="postRender",X.FixedUpdate="fixedUpdate";function q(t){return st=t}function L(t){return lt[t].process(ft)}function N(n){return function(t){return 1-n(1-t)}}function B(n){return function(t){return t<=.5?n(2*t)/2:(2-n(2*(1-t)))/2}}function U(t){return t}function I(t){return"number"==typeof t}function z(t,n){return void 0===n&&(n=xt),function(t){return 180*t/Math.PI}(Math.atan2(n.y-t.y,n.x-t.x))}function G(n,r){var e=!0;return void 0===r&&(r=n,e=!1),function(t){return e?t-n+r:(n=t,e=!0,r)}}function H(t){return t.hasOwnProperty("x")&&t.hasOwnProperty("y")}function W(t){return H(t)&&t.hasOwnProperty("z")}function $(t,n){return Math.abs(t-n)}function K(t,n){if(void 0===n&&(n=xt),I(t)&&I(n))return $(t,n);if(H(t)&&H(n)){var r=$(t.x,n.x),e=$(t.y,n.y),o=W(t)&&W(n)?$(t.z,n.z):0;return Math.sqrt(Math.pow(r,2)+Math.pow(e,2)+Math.pow(o,2))}return 0}function J(t,n,r){var e=n-t;return 0==e?1:(r-t)/e}function Q(t,n,r){return-r*t+r*n+t}function Z(t,n,r){var e=t*t,o=n*n;return Math.sqrt(Math.max(0,r*(o-e)+e))}function tt(n){return Pt.find(function(t){return t.test(n)})}function nt(t){return"'"+t+"' is not an animatable color. Use the equivalent color code instead."}function rt(t,n){var r=tt(t),e=tt(n);P(!!r,nt(t)),P(!!e,nt(n)),P(r.transform===e.transform,"Both colors must be hex/RGBA, OR both must be HSLA.");var o=r.parse(t),u=e.parse(n),i=At({},o),a=r===S?Q:Z;return function(t){for(var n in i)"alpha"!==n&&(i[n]=a(o[n],u[n],t));return i.alpha=Q(o.alpha,u.alpha,t),r.transform(i)}}function et(n,r){return function(t){return r(n(t))}}function ot(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return t.reduce(et)}var ut,it=1/60*1e3,at=!0,st=!1,ct=!1,ft={delta:0,timestamp:0},pt=[T.Read,T.Update,T.Render,T.PostRender],dt=pt.reduce(function(t,n){var e=function(e){var u=[],i=[],a=0,s=!1,o=0,c=new WeakSet,f=new WeakSet,p={cancel:function(t){var n=i.indexOf(t);c.add(t),-1!==n&&i.splice(n,1)},process:function(t){var n,r;if(s=!0,u=(n=[i,u])[0],(i=n[1]).length=0,a=u.length)for(o=0;o<a;o++)(r=u[o])(t),!0!==f.has(r)||c.has(r)||(p.schedule(r),e(!0));s=!1},schedule:function(t,n,r){void 0===n&&(n=!1),void 0===r&&(r=!1),P("function"==typeof t,"Argument must be a function");var e=r&&s,o=e?u:i;c.delete(t),n&&f.add(t),-1===o.indexOf(t)&&(o.push(t),e&&(a=u.length))}};return p}(q);return t.sync[n]=function(t,n,r){return void 0===n&&(n=!1),void 0===r&&(r=!1),st||yt(),e.schedule(t,n,r),t},t.cancelSync[n]=function(t){return e.cancel(t)},t.steps[n]=e,t},{steps:{},sync:{},cancelSync:{}}),lt=dt.steps,vt=dt.sync,ht=dt.cancelSync,mt=function(t){st=!1,ft.delta=at?it:Math.max(Math.min(t-ft.timestamp,40),1),at||(it=ft.delta),ft.timestamp=t,ct=!0,pt.forEach(L),ct=!1,st&&(at=!1,_(mt))},yt=function(){at=st=!0,ct||_(mt)},gt=N,bt=function(n){return function(t){return Math.pow(t,n)}}(2),wt=N(bt),Ot=B(bt),xt={x:0,y:0,z:0},Mt=(ut=function(t,n,r){return Math.min(Math.max(r,t),n)},function(n,r,t){return void 0!==t?ut(n,r,t):function(t){return ut(n,r,t)}}),At=function(){return(At=Object.assign||function(t){for(var n,r=1,e=arguments.length;r<e;r++)for(var o in n=arguments[r])Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o]);return t}).apply(this,arguments)},Pt=[V,C,S];function Ct(t,r){var e=t.slice(),o=e.length,u=t.map(function(t,n){return function(n,r){return I(n)?function(t){return Q(n,r,t)}:j(n)?rt(n,r):kt(n,r)}(t,r[n])});return function(t){for(var n=0;n<o;n++)e[n]=u[n](t);return e}}function St(t){for(var n=R.parse(t),r=n.length,e=0,o=0,u=0,i=0;i<r;i++)e||"number"==typeof n[i]?e++:void 0!==n[i].hue?u++:o++;return{parsed:n,numNumbers:e,numRGB:o,numHSL:u}}function Vt(t,n){return I(t)?t/(1e3/n):0}function jt(t,n){return n?t*(1e3/n):0}var kt=function(t,n){var r=R.createTransformer(n),e=St(t),o=St(n);return P(e.numHSL===o.numHSL&&e.numRGB===o.numRGB&&e.numNumbers>=o.numNumbers,"Complex values '"+t+"' and '"+n+"' too different to mix. Ensure all colors are of the same type."),ot(Ct(e.parsed,o.parsed),r)},Et=(Mt(0,1),Dt.prototype.applyMiddleware=function(t){return this.create(x({},this.props,{middleware:this.props.middleware?[t].concat(this.props.middleware):[t]}))},Dt.prototype.pipe=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=1===t.length?t[0]:ot.apply(void 0,t);return this.applyMiddleware(function(n){return function(t){return n(r(t))}})},Dt.prototype.while=function(e){return this.applyMiddleware(function(n,r){return function(t){return e(t)?n(t):r()}})},Dt.prototype.filter=function(r){return this.applyMiddleware(function(n){return function(t){return r(t)&&n(t)}})},Dt);function Dt(t){void 0===t&&(t={}),this.props=t}function Ft(t,n,r){var e=n.middleware;return new Tt({middleware:e,onComplete:r},"function"==typeof t?{update:t}:t)}var Rt,Tt=function(t,n){var r=this,e=t.middleware,o=t.onComplete;this.isActive=!0,this.update=function(t){r.observer.update&&r.updateObserver(t)},this.complete=function(){r.observer.complete&&r.isActive&&r.observer.complete(),r.onComplete&&r.onComplete(),r.isActive=!1},this.error=function(t){r.observer.error&&r.isActive&&r.observer.error(t),r.isActive=!1},this.observer=n,this.updateObserver=function(t){return n.update(t)},this.onComplete=o,n.update&&e&&e.length&&e.forEach(function(t){return r.updateObserver=t(r.updateObserver,r.complete)})},Xt=(n(Yt,Rt=Et),Yt.prototype.create=function(t){return new Yt(t)},Yt.prototype.start=function(t){void 0===t&&(t={});var n=!1,r={stop:function(){}},e=this.props,o=e.init,u=s(e,["init"]),i=o(Ft(t,u,function(){n=!0,r.stop()}));return r=i?x({},r,i):r,t.registerParent&&t.registerParent(r),n&&r.stop(),r},Yt);function Yt(){return null!==Rt&&Rt.apply(this,arguments)||this}function _t(t){return new Xt({init:t})}var qt,Lt=(n(Nt,qt=Et),Nt.prototype.complete=function(){this.subscribers.forEach(function(t){return t.complete()})},Nt.prototype.error=function(n){this.subscribers.forEach(function(t){return t.error(n)})},Nt.prototype.update=function(t){for(var n=0;n<this.subscribers.length;n++)this.subscribers[n].update(t)},Nt.prototype.subscribe=function(t){var n=this,r=Ft(t,this.props);return this.subscribers.push(r),{unsubscribe:function(){var t=n.subscribers.indexOf(r);-1!==t&&n.subscribers.splice(t,1)}}},Nt.prototype.stop=function(){this.parent&&this.parent.stop()},Nt.prototype.registerParent=function(t){this.stop(),this.parent=t},Nt);function Nt(){var t=null!==qt&&qt.apply(this,arguments)||this;return t.subscribers=[],t}var Bt,Ut=(n(It,Bt=Lt),It.prototype.create=function(t){return new It(t)},It);function It(){return null!==Bt&&Bt.apply(this,arguments)||this}var zt,Gt=(n(Ht,zt=Lt),Ht.prototype.create=function(t){return new Ht(t)},Ht.prototype.get=function(){return this.current},Ht.prototype.getVelocity=function(){return this.getVelocityOfCurrent()},Ht.prototype.update=function(t){zt.prototype.update.call(this,t),this.prev=this.current,this.updateCurrent(t);var n=ft,r=n.delta,e=n.timestamp;this.timeDelta=r,this.lastUpdated=e,vt.postRender(this.scheduleVelocityCheck)},Ht.prototype.subscribe=function(t){var n=zt.prototype.subscribe.call(this,t);return this.subscribers[this.subscribers.length-1].update(this.current),n},Ht.prototype.getSingleVelocity=function(t,n){return"number"==typeof t&&"number"==typeof n?jt(t-n,this.timeDelta):jt(parseFloat(t)-parseFloat(n),this.timeDelta)||0},Ht.prototype.getListVelocity=function(){var r=this;return this.current.map(function(t,n){return r.getSingleVelocity(t,r.prev[n])})},Ht.prototype.getMapVelocity=function(){var t={};for(var n in this.current)this.current.hasOwnProperty(n)&&(t[n]=this.getSingleVelocity(this.current[n],this.prev[n]));return t},Ht);function Ht(t){var r=zt.call(this,t)||this;return r.scheduleVelocityCheck=function(){return vt.postRender(r.velocityCheck)},r.velocityCheck=function(t){t.timestamp!==r.lastUpdated&&(r.prev=r.current)},r.prev=r.current=t.value||0,!function(t){var n=typeof t;return"string"==n||"number"==n}(r.current)?!function(t){return Array.isArray(t)}(r.current)?(r.updateCurrent=function(t){for(var n in r.current={},t)t.hasOwnProperty(n)&&(r.current[n]=t[n])},r.getVelocityOfCurrent=function(){return r.getMapVelocity()}):(r.updateCurrent=function(t){return r.current=t.slice()},r.getVelocityOfCurrent=function(){return r.getListVelocity()}):(r.updateCurrent=function(t){return r.current=t},r.getVelocityOfCurrent=function(){return r.getSingleVelocity(r.current,r.prev)}),t.initialSubscription&&r.subscribe(t.initialSubscription),r}function Wt(t,n){return new Gt({value:t,initialSubscription:n})}function $t(t){var f=t.getCount,p=t.getFirst,d=t.getOutput,l=t.mapApi,v=t.setProp,h=t.startActions;return function(c){return _t(function(t){function e(){return n(a)}var n=t.update,o=t.complete,u=t.error,i=f(c),a=d(),s=0,r=h(c,function(t,n){var r=!1;return t.start({complete:function(){r||(r=!0,++s===i&&vt.update(o))},error:u,update:function(t){v(a,n,t),vt.update(e,!1,!0)}})});return Object.keys(p(r)).reduce(function(t,n){return t[n]=l(r,n),t},{})})}}function Kt(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return dn(t)}function Jt(n){return ln.find(function(t){return t.test(n)})}function Qt(t,n){return t(n)}function Zt(e,o,u){var t=u[0],n=o[t].map(function(t,n){var r=u.reduce(function(r){return function(t,n){return t[n]=t[n][r],t}}(n),x({},o));return mn(t)(e,r)});return Kt.apply(void 0,n)}function tn(e,o,u){var i=u[0],t=Object.keys(o[i]).reduce(function(t,n){var r=u.reduce(function(r){return function(t,n){return t[n]=t[n][r],t}}(n),x({},o));return t[n]=mn(o[i][n])(e,r),t},{});return pn(t)}function nn(t,n){var r=n.from,e=n.to,o=s(n,["from","to"]),u=Jt(r)||Jt(e),i=u.transform,a=u.parse;return t(x({},o,{from:"string"==typeof r?a(r):r,to:"string"==typeof e?a(e):e})).pipe(i)}function rn(u){return function(t,n){var r=n.from,e=n.to,o=s(n,["from","to"]);return t(x({},o,{from:0,to:1})).pipe(u(r,e))}}function en(e,t){var n=function(r){function e(t,n){return void 0!==t&&!r[n](t)}var t=Object.keys(r);return{getVectorKeys:function(r){return t.reduce(function(t,n){return e(r[n],n)&&t.push(n),t},[])},testVectorProps:function(n){return n&&t.some(function(t){return e(n[t],t)})}}}(t),o=n.testVectorProps,u=n.getVectorKeys;return function(t){if(!o(t))return e(t);var n=u(t),r=t[n[0]];return mn(r)(e,t,n)}}function on(T){return void 0===T&&(T={}),_t(function(t){function r(t){var n;void 0===t&&(t=!1),D=wn({from:O=(n=[M,O])[0],to:M=n[1],ease:p,reverseEase:t}).start(i)}function e(){F=On(J(0,c,P)),D.seek(F)}function n(){R=!0,u=vt.update(function(t){var n=t.delta;P+=n,e(),function(){var t=R&&c+b<P;return!!t&&(!(!t||h||l||y)||(P=c-(P-b),h&&E<h?(E++,!1):l&&S<l?(S++,r(),!1):!(y&&j<y)||(r(++j%2!=0),!1)))}()&&(ht.update(u),a&&vt.update(a,!1,!0))},!0)}function o(){R=!1,u&&ht.update(u)}var u,i=t.update,a=t.complete,s=T.duration,c=void 0===s?300:s,f=T.ease,p=void 0===f?wt:f,d=T.flip,l=void 0===d?0:d,v=T.loop,h=void 0===v?0:v,m=T.yoyo,y=void 0===m?0:m,g=T.repeatDelay,b=void 0===g?0:g,w=T.from,O=void 0===w?0:w,x=T.to,M=void 0===x?1:x,A=T.elapsed,P=void 0===A?0:A,C=T.flipCount,S=void 0===C?0:C,V=T.yoyoCount,j=void 0===V?0:V,k=T.loopCount,E=void 0===k?0:k,D=wn({from:O,to:M,ease:p}).start(i),F=0,R=!1;return n(),{isActive:function(){return R},getElapsed:function(){return Mt(0,c,P)},getProgress:function(){return F},stop:function(){o()},pause:function(){return o(),this},resume:function(){return R||n(),this},seek:function(t){return P=Q(0,c,t),vt.update(e,!1,!0),this},reverse:function(){return r(),this}}})}function un(t){var n=t.easings,r=t.ease,e=void 0===r?U:r,o=t.times,u=t.values,i=s(t,["easings","ease","times","values"]);n=Array.isArray(n)?n:function(t,n){return t.map(function(){return n||wt}).splice(0,t.length-1)}(u,n),o=o||function(t){var r=t.length;return t.map(function(t,n){return 0!==n?n/(r-1):0})}(u);var a=n.map(function(t,n){return wn({from:u[n],to:u[n+1],ease:t})});return on(x({},i,{ease:e})).applyMiddleware(function(t){return function(e,t,n){var o=e.length,u=o-1,i=u-1,a=t.map(function(t){return t.start(n)});return function(t){t<=e[0]&&a[0].seek(0),t>=e[u]&&a[i].seek(1);for(var n=1;n<o&&!(e[n]>t||n===u);n++);var r=J(e[n-1],e[n],t);a[n-1].seek(xn(r))}}(o,a,t)})}function an(t,n){return Array.isArray(n)?t.push.apply(t,function(t){var e=[],n=t[t.length-1],r="number"==typeof n,o=r?n:0,u=r?t.slice(0,-1):t,i=u.length,a=0;return u.forEach(function(t,n){if(e.push(t),n!==i-1){var r=t.duration||300;a+=o,e.push("-"+(r-a))}}),e}(n)):t.push(n),t}function sn(t,n,r){var e=t.duration,o=t.easings,u=t.times,i=t.values,a=i.length,s=u[a-1],c=0===n.at?0:n.at/e,f=(n.at+n.duration)/e;if(0===r)i.push(n.from),u.push(c);else if(s!==c){void 0!==n.from&&(i.push(i[a-1]),u.push(c),o.push(U));var p=void 0!==n.from?n.from:i[a-1];i.push(p),u.push(c),o.push(U)}else void 0!==n.from&&(i.push(n.from),u.push(c),o.push(U));return i.push(n.to),u.push(f),o.push(n.ease||Ot),t}function cn(e,o,u){return _t(function(t){var n=t.update,r=o.split(" ").map(function(t){return e.addEventListener(t,n,u),t});return{stop:function(){return r.forEach(function(t){return e.removeEventListener(t,n,u)})}}})}function fn(t,n){return void 0===n&&(n={clientX:0,clientY:0,pageX:0,pageY:0,x:0,y:0}),n.clientX=n.x=t.clientX,n.clientY=n.y=t.clientY,n.pageX=t.pageX,n.pageY=t.pageY,n}var pn=$t({getOutput:function(){return{}},getCount:function(t){return Object.keys(t).length},getFirst:function(t){return t[Object.keys(t)[0]]},mapApi:function(o,u){return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Object.keys(o).reduce(function(t,n){var r;return o[n][u]&&(e[0]&&void 0!==e[0][n]?t[n]=o[n][u](e[0][n]):t[n]=(r=o[n])[u].apply(r,e)),t},{})}},setProp:function(t,n,r){return t[n]=r},startActions:function(r,e){return Object.keys(r).reduce(function(t,n){return t[n]=e(r[n],n),t},{})}}),dn=$t({getOutput:function(){return[]},getCount:function(t){return t.length},getFirst:function(t){return t[0]},mapApi:function(n,e){return function(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];return n.map(function(t,n){if(t[e])return Array.isArray(r[0])?t[e](r[0][n]):t[e].apply(t,r)})}},setProp:function(t,n,r){return t[n]=r},startActions:function(t,r){return t.map(function(t,n){return r(t,n)})}}),ln=[y,m,h,g,b],vn=rn(rt),hn=rn(kt),mn=function(t){return"number"==typeof t?Qt:Array.isArray(t)?Zt:function(t){return Boolean(Jt(t))}(t)?nn:j(t)?vn:R.test(t)?hn:"object"==typeof t?tn:Qt},yn=en(function(b){return void 0===b&&(b={}),_t(function(t){var o=t.complete,u=t.update,n=b.velocity,r=void 0===n?0:n,e=b.from,i=void 0===e?0:e,a=b.power,s=void 0===a?.8:a,c=b.timeConstant,f=void 0===c?350:c,p=b.restDelta,d=void 0===p?.5:p,l=b.modifyTarget,v=0,h=s*r,m=Math.round(i+h),y=void 0===l?m:l(m),g=vt.update(function(t){var n=t.delta;v+=n;var r=-h*Math.exp(-v/f),e=d<r||r<-d;u(e?y+r:y),e||(ht.update(g),o())},!0);return{stop:function(){return ht.update(g)}}})},{from:v.test,modifyTarget:function(t){return"function"==typeof t},velocity:v.test}),gn=en(function(P){return void 0===P&&(P={}),_t(function(t){var s=t.update,c=t.complete,n=P.velocity,f=void 0===n?0:n,r=P.from,e=void 0===r?0:r,o=P.to,p=void 0===o?0:o,u=P.stiffness,d=void 0===u?100:u,i=P.damping,l=void 0===i?10:i,a=P.mass,v=void 0===a?1:a,h=P.restSpeed,m=void 0===h?.01:h,y=P.restDelta,g=void 0===y?.01:y,b=f?-f/1e3:0,w=0,O=p-e,x=e,M=x,A=vt.update(function(t){var n=t.delta;w+=n;var r=l/(2*Math.sqrt(d*v)),e=Math.sqrt(d/v)/1e3;if(M=x,r<1){var o=Math.exp(-r*e*w),u=e*Math.sqrt(1-r*r);x=p-o*((b+r*e*O)/u*Math.sin(u*w)+O*Math.cos(u*w))}else{o=Math.exp(-e*w);x=p-o*(O+(b+e*O)*w)}f=jt(x-M,n);var i=Math.abs(f)<=m,a=Math.abs(p-x)<=g;i&&a?(s(x=p),ht.update(A),c()):s(x)},!0);return{stop:function(){return ht.update(A)}}})},{from:v.test,to:v.test,stiffness:v.test,damping:v.test,mass:v.test,velocity:v.test}),bn=en(function(t){var n=t.from,d=void 0===n?0:n,r=t.velocity,l=void 0===r?0:r,v=t.min,h=t.max,e=t.power,m=void 0===e?.8:e,o=t.timeConstant,y=void 0===o?700:o,u=t.bounceStiffness,g=void 0===u?500:u,i=t.bounceDamping,b=void 0===i?10:i,a=t.restDelta,w=void 0===a?1:a,O=t.modifyTarget;return _t(function(t){function r(t){return void 0!==v&&t<=v}function e(t){return void 0!==h&&h<=t}function n(t){return r(t)||e(t)}function o(t,n){i&&i.stop(),i=t.start({update:function(t){return c.update(t)},complete:function(){n?n():s()}})}function u(t){f=!0,o(gn(x({},t,{to:r(t.from)?v:h,stiffness:g,damping:b,restDelta:w})))}var i,a=t.update,s=t.complete,c=Wt(d),f=!1;if(c.subscribe(function(t){a(t);var n=c.getVelocity();i&&!f&&function(t,n){return r(t)&&n<0||e(t)&&0<n}(t,n)&&u({from:t,velocity:n})}),n(d))u({from:d,velocity:l});else if(0!==l){var p=yn({from:d,velocity:l,timeConstant:y,power:m,restDelta:n(d)?20:w,modifyTarget:O});o(p,function(){var t=c.get();n(t)?u({from:t,velocity:c.getVelocity()}):s()})}else s();return{stop:function(){return i&&i.stop()}}})},{from:v.test,velocity:v.test,min:v.test,max:v.test,damping:v.test,stiffness:v.test,modifyTarget:function(t){return"function"==typeof t}}),wn=en(function(t){var n=t.from,r=void 0===n?0:n,e=t.to,o=void 0===e?1:e,u=t.ease,i=void 0===u?U:u,a=t.reverseEase;return void 0!==a&&a&&(i=gt(i)),_t(function(t){var n=t.update;return{seek:function(t){return n(t)}}}).pipe(i,function(t){return Q(r,o,t)})},{ease:function(t){return"function"==typeof t},from:v.test,to:v.test}),On=Mt(0,1),xn=Mt(0,1),Mn=en(function(m){return void 0===m&&(m={}),_t(function(t){var e=t.complete,o=t.update,n=m.acceleration,u=void 0===n?0:n,r=m.friction,i=void 0===r?0:r,a=m.velocity,s=void 0===a?0:a,c=m.springStrength,f=m.to,p=m.restSpeed,d=void 0===p?.001:p,l=m.from,v=void 0===l?0:l,h=vt.update(function(t){var n=t.delta,r=Math.max(n,16);u&&(s+=Vt(u,r)),i&&(s*=Math.pow(1-i,r/100)),void 0!==c&&void 0!==f&&(s+=(f-v)*Vt(c,r));v+=Vt(s,r),o(v),!1!==d&&(!s||Math.abs(s)<=d)&&(ht.update(h),e())},!0);return{set:function(t){return v=t,this},setAcceleration:function(t){return u=t,this},setFriction:function(t){return i=t,this},setSpringStrength:function(t){return c=t,this},setSpringTarget:function(t){return f=t,this},setVelocity:function(t){return s=t,this},stop:function(){return ht.update(h)}}})},{acceleration:v.test,friction:v.test,velocity:v.test,from:v.test,to:v.test,springStrength:v.test}),An=[{clientX:0,clientY:0,pageX:0,pageY:0,x:0,y:0}],Pn=!1;if("undefined"!=typeof document){cn(document,"touchstart touchmove",{passive:!0,capture:!0}).start(function(t){var n=t.touches;Pn=!0;for(var r=n.length,e=An.length=0;e<r;e++){var o=n[e];An.push(fn(o))}})}function Cn(t){var n=void 0===t?{}:t,r=n.preventDefault,f=void 0===r||r,e=n.scale,p=void 0===e?1:e,o=n.rotate,d=void 0===o?0:o;return _t(function(t){var o=t.update,u={touches:An,scale:p,rotate:d},i=0,a=0,s=1<An.length;if(s){var n=An[0],r=An[1];i=K(n,r),a=z(n,r)}function e(){if(s){var t=An[0],n=An[1],r=K(t,n),e=z(t,n);u.scale=p*(r/i),u.rotate=d+(e-a)}o(u)}var c=cn(document,"touchmove",{passive:!f}).start(function(t){(f||1<t.touches.length)&&t.preventDefault(),vt.update(e)});return Pn&&vt.update(e),{stop:function(){ht.update(e),c.stop()}}})}var Sn={clientX:0,clientY:0,pageX:0,pageY:0,x:0,y:0},Vn=!1;if("undefined"!=typeof document){cn(document,"mousedown mousemove",!0).start(function(t){Vn=!0,fn(t,Sn)})}function jn(t){var n=(void 0===t?{}:t).preventDefault,o=void 0===n||n;return _t(function(t){function n(){return r(Sn)}var r=t.update,e=cn(document,"mousemove").start(function(t){o&&t.preventDefault(),vt.update(n)});return Vn&&vt.update(n),{stop:function(){ht.update(n),e.stop()}}})}function kn(t){return t[0]}function En(t){return void 0===t&&(t={}),Pn?Cn(t).pipe(function(t){return t.touches},kn):jn(t)}function Dn(){for(var i=[],t=0;t<arguments.length;t++)i[t]=arguments[t];return _t(function(t){var n,r=t.update,e=t.complete,o=0,u=function(){n=i[o].start({complete:function(){++o>=i.length?e():u()},update:r})};return u(),{stop:function(){return n&&n.stop()}}})}function Fn(e){return _t(function(t){var n=t.complete,r=setTimeout(n,e);return{stop:function(){return clearTimeout(r)}}})}t.Action=Xt,t.ValueReaction=Gt,t.action=_t,t.chain=Dn,t.composite=pn,t.crossfade=function(n,r){return _t(function(e){var o=0,t=Kt(n,r).start(x({},e,{update:function(t){var n=t[0],r=t[1];e.update(Q(n,r,o))}}));return{setBalance:function(t){return o=t},stop:function(){return t.stop()}}})},t.decay=yn,t.delay=Fn,t.everyFrame=function(){return _t(function(t){var r=t.update,e=0,n=vt.update(function(t){var n=t.timestamp;r(n-(e=e||n))},!0,!0);return{stop:function(){return ht.update(n)}}})},t.inertia=bn,t.keyframes=un,t.listen=cn,t.merge=function(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];return _t(function(n){var t=r.map(function(t){return t.start(n)});return{stop:function(){return t.forEach(function(t){return t.stop()})}}})},t.mouse=jn,t.multicast=function(){return new Ut},t.multitouch=Cn,t.parallel=Kt,t.physics=Mn,t.pointer=function(t){void 0===t&&(t={});var n=t.x,r=t.y,e=s(t,["x","y"]);if(void 0===n&&void 0===r)return En(e);var o=G(n||0),u=G(r||0),i={x:0,y:0};return En(e).pipe(function(t){return i.x=o(t.x),i.y=u(t.y),i})},t.schedule=function(i,a){return _t(function(t){var n,r=t.update,e=t.complete,o=i.start({update:function(){return void 0!==n&&r(n)},complete:e}),u=a.start({update:function(t){return n=t},complete:e});return{stop:function(){o.stop(),u.stop()}}})},t.spring=gn,t.stagger=function(t,e){var o="number"==typeof e,n=t.map(function(t,n){var r=o?e*n:e(n);return Dn(Fn(r),t)});return Kt.apply(void 0,n)},t.styler=function(){return P(!1,"styler has been removed from Popmotion in 9.0. Downgrade to 8.x or npm install stylefire")},t.timeline=function(t,n){var r=void 0===n?{}:n,e=r.duration,o=r.elapsed,u=r.ease,i=r.loop,a=r.flip,s=r.yoyo,c=0,f=0,p=t.reduce(an,[]),d=[];p.forEach(function(t){if("string"==typeof t)c+=parseFloat(t);else if("number"==typeof t)c=t;else{var n=x({},t,{at:c});n.duration=void 0===n.duration?300:n.duration,d.push(n),c+=n.duration,f=Math.max(f,n.at+n.duration)}});for(var l={},v=d.length,h=0;h<v;h++){var m=d[h],y=m.track;if(void 0===y)throw new Error("No track defined");l.hasOwnProperty(y)||(l[y]=[]),l[y].push(m)}var g={};for(var b in l)if(l.hasOwnProperty(b)){var w=l[b].reduce(sn,{duration:f,easings:[],times:[],values:[]});g[b]=un(x({},w,{duration:e||f,ease:u,elapsed:o,loop:i,yoyo:s,flip:a}))}return pn(g)},t.tween=on,t.value=Wt,Object.defineProperty(t,"__esModule",{value:!0})});
