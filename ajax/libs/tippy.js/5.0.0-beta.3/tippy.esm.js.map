{"version":3,"file":"tippy.esm.js","sources":["../src/addons/createSingleton.ts","../src/addons/delegate.ts","../src/plugins/followCursor.ts","../src/plugins/sticky.ts"],"sourcesContent":["import { Instance, Props } from '../types'\nimport tippy from '..'\nimport {\n  invokeWithArgsOrReturn,\n  preserveInvocation,\n  useIfDefined,\n} from '../utils'\nimport { defaultProps } from '../props'\nimport {\n  throwErrorWhen,\n  createInvalidCreateSingletonArgumentError,\n} from '../validation'\n\n/**\n * Re-uses a single tippy element for many different tippy instances.\n * Replaces v4's `tippy.group()`.\n */\nexport default function createSingleton(\n  tippyInstances: Instance[],\n  optionalProps?: Partial<Props>,\n): Instance {\n  if (__DEV__) {\n    throwErrorWhen(\n      !Array.isArray(tippyInstances),\n      createInvalidCreateSingletonArgumentError(String(tippyInstances)),\n    )\n  }\n\n  tippyInstances.forEach(instance => {\n    instance.disable()\n  })\n\n  let currentAria: string | null\n  let currentTarget: Element\n\n  let { aria, onTrigger, onMount, onUntrigger, onPropsUpdated, onDestroy } = {\n    ...defaultProps,\n    ...optionalProps,\n  }\n\n  function handleAriaDescribedByAttribute(\n    id: string,\n    isInteractive: boolean,\n    isShow: boolean,\n  ): void {\n    if (!currentAria) {\n      return\n    }\n\n    if (isShow && !isInteractive) {\n      currentTarget.setAttribute(`aria-${currentAria}`, id)\n    } else {\n      currentTarget.removeAttribute(`aria-${currentAria}`)\n    }\n  }\n\n  const references = tippyInstances.map(instance => instance.reference)\n\n  const singleton = tippy(document.createElement('div'), {\n    aria: null,\n    triggerTarget: references,\n    onMount(instance) {\n      preserveInvocation(onMount, instance.props.onMount, [instance])\n      handleAriaDescribedByAttribute(\n        instance.popperChildren.tooltip.id,\n        instance.props.interactive,\n        true,\n      )\n    },\n    onUntrigger(instance, event): void {\n      preserveInvocation(onUntrigger, instance.props.onUntrigger, [\n        instance,\n        event,\n      ])\n\n      handleAriaDescribedByAttribute(\n        instance.popperChildren.tooltip.id,\n        instance.props.interactive,\n        false,\n      )\n    },\n    onTrigger(instance, event): void {\n      preserveInvocation(onTrigger, instance.props.onTrigger, [instance, event])\n\n      const target = event.currentTarget as Element\n      const index = references.indexOf(target)\n\n      currentTarget = target\n      currentAria = aria\n\n      if (instance.state.isVisible) {\n        handleAriaDescribedByAttribute(\n          instance.popperChildren.tooltip.id,\n          instance.props.interactive,\n          true,\n        )\n      }\n\n      instance.setContent(tippyInstances[index].props.content)\n\n      instance.reference.getBoundingClientRect = (): DOMRect | ClientRect =>\n        target.getBoundingClientRect()\n\n      // @ts-ignore - awaiting popper.js@1.16.0 release\n      instance.reference.referenceNode =\n        instance.props.appendTo === 'parent'\n          ? target.parentNode\n          : invokeWithArgsOrReturn(instance.props.appendTo, [target])\n    },\n    onPropsUpdated(instance, partialProps): void {\n      preserveInvocation(onPropsUpdated, instance.props.onPropsUpdated, [\n        instance,\n      ])\n\n      aria = useIfDefined(partialProps.aria, aria)\n      onTrigger = useIfDefined(partialProps.onTrigger, onTrigger)\n      onMount = useIfDefined(partialProps.onMount, onMount)\n      onUntrigger = useIfDefined(partialProps.onUntrigger, onUntrigger)\n      onPropsUpdated = useIfDefined(partialProps.onPropsUpdated, onPropsUpdated)\n      onDestroy = useIfDefined(partialProps.onDestroy, onDestroy)\n    },\n    onDestroy(instance): void {\n      preserveInvocation(onDestroy, instance.props.onDestroy, [instance])\n\n      tippyInstances.forEach(instance => {\n        instance.enable()\n      })\n    },\n    ...optionalProps,\n  }) as Instance\n\n  return singleton\n}\n","import { Targets, Instance, Props } from '../types'\nimport tippy from '..'\nimport { throwErrorWhen, MISSING_TARGET_WARNING } from '../validation'\nimport { removeProperties, splitBySpaces } from '../utils'\n\ninterface ListenerObj {\n  element: Element\n  eventType: string\n  listener: EventListener\n  options: boolean | object\n}\n\n/**\n * Creates a delegate instance that controls the creation of tippy instances\n * for child elements (`target` CSS selector).\n */\nexport default function delegate(\n  targets: Targets,\n  props: Partial<Props> & { target: string },\n): Instance | Instance[] {\n  if (__DEV__) {\n    throwErrorWhen(!props || !props.target, MISSING_TARGET_WARNING)\n  }\n\n  let listeners: ListenerObj[] = []\n  let childTippyInstances: Instance[] = []\n\n  const { target } = props\n  const nativeProps = removeProperties(props, ['target'])\n  const trigger = props.trigger || tippy.defaultProps.trigger\n\n  const returnValue = tippy(targets, { ...nativeProps, trigger: 'manual' })\n\n  function onTrigger(event: Event): void {\n    if (event.target) {\n      const targetNode = (event.target as Element).closest(target)\n\n      if (targetNode) {\n        const instance = tippy(targetNode, {\n          ...nativeProps,\n          showOnCreate: true,\n        })\n\n        if (instance) {\n          childTippyInstances = childTippyInstances.concat(instance)\n        }\n      }\n    }\n  }\n\n  function on(\n    element: Element,\n    eventType: string,\n    listener: EventListener,\n    options: object | boolean = false,\n  ): void {\n    element.addEventListener(eventType, listener, options)\n    listeners.push({ element, eventType, listener, options })\n  }\n\n  function addEventListeners(instance: Instance): void {\n    const { reference } = instance\n\n    splitBySpaces(trigger).forEach((eventType): void => {\n      switch (eventType) {\n        case 'mouseenter': {\n          on(reference, 'mouseover', onTrigger)\n          break\n        }\n        case 'focus': {\n          on(reference, 'focusin', onTrigger)\n          break\n        }\n        case 'click': {\n          on(reference, 'click', onTrigger)\n        }\n      }\n    })\n  }\n\n  function removeEventListeners(): void {\n    listeners.forEach(\n      ({ element, eventType, listener, options }: ListenerObj): void => {\n        element.removeEventListener(eventType, listener, options)\n      },\n    )\n    listeners = []\n  }\n\n  function applyMutations(instance: Instance): void {\n    const originalDestroy = instance.destroy\n    instance.destroy = (shouldDestroyChildInstances = true): void => {\n      if (shouldDestroyChildInstances) {\n        childTippyInstances.forEach((instance): void => {\n          instance.destroy()\n        })\n      }\n\n      childTippyInstances = []\n\n      removeEventListeners()\n      originalDestroy()\n    }\n\n    addEventListeners(instance)\n\n    instance.setProps({ trigger: 'manual' })\n  }\n\n  if (Array.isArray(returnValue)) {\n    returnValue.forEach(applyMutations)\n  } else {\n    applyMutations(returnValue)\n  }\n\n  return returnValue\n}\n","import {\n  Instance,\n  Props,\n  Placement,\n  PopperElement,\n  FollowCursorProps,\n} from '../types'\nimport { includes, closestCallback, useIfDefined } from '../utils'\nimport { getBasePlacement } from '../popper'\nimport { currentInput } from '../bindGlobalEventListeners'\nimport Popper from 'popper.js'\n\ninterface ExtendedInstance extends Instance {\n  props: Props & FollowCursorProps\n}\n\nexport default function followCursor(\n  instance: ExtendedInstance,\n): Partial<Props> {\n  const { reference, popper } = instance\n\n  // Internal state\n  let lastMouseMoveEvent: MouseEvent\n  let firstTriggerEventType: string | null = null\n  let isPopperInstanceCreated = false\n  let normalizedPlacement: Placement\n  let shouldBypassSetPropsHook = false\n\n  // These are controlled by this plugin, so we need to store the user's\n  // original prop value\n  let placement: Props['placement']\n  let flipOnUpdate: Props['flipOnUpdate']\n\n  function setPrivateProps(props: Partial<Props>): void {\n    placement = useIfDefined(props.placement, placement)\n    flipOnUpdate = useIfDefined(props.flipOnUpdate, flipOnUpdate)\n  }\n\n  // Due to `getVirtualOffsets()`, we need to reverse the placement if it's\n  // shifted (start -> end, and vice-versa)\n  function setNormalizedPlacement(): void {\n    const shift = placement.split('-')[1]\n\n    normalizedPlacement = (instance.props.followCursor && shift\n      ? placement.replace(shift, shift === 'start' ? 'end' : 'start')\n      : placement) as Placement\n\n    shouldBypassSetPropsHook = true\n    instance.setProps({ placement: normalizedPlacement })\n    shouldBypassSetPropsHook = false\n  }\n\n  function resetReference(): void {\n    if (instance.popperInstance) {\n      instance.popperInstance.reference = reference\n    }\n  }\n\n  function addListener(): void {\n    document.addEventListener('mousemove', onMouseMove)\n  }\n\n  function removeListener(): void {\n    document.removeEventListener('mousemove', onMouseMove)\n  }\n\n  function onMouseMove(event: MouseEvent): void {\n    if (firstTriggerEventType === 'focus' || !event) {\n      return\n    }\n\n    const { clientX, clientY } = (lastMouseMoveEvent = event)\n\n    if (\n      !instance.props.followCursor ||\n      !instance.popperInstance ||\n      !isPopperInstanceCreated\n    ) {\n      return\n    }\n\n    // If the instance is interactive, avoid updating the position unless it's\n    // over the reference element\n    const isCursorOverReference = closestCallback(\n      event.target as Element,\n      (el: Element): boolean => el === reference,\n    )\n\n    const rect = reference.getBoundingClientRect()\n    const { followCursor } = instance.props\n    const isHorizontal = followCursor === 'horizontal'\n    const isVertical = followCursor === 'vertical'\n    const isVerticalPlacement = includes(\n      ['top', 'bottom'],\n      getBasePlacement(instance.state.currentPlacement),\n    )\n\n    // The virtual reference needs some size to prevent itself from overflowing\n    const { size, x, y } = getVirtualOffsets(popper, isVerticalPlacement)\n\n    if (isCursorOverReference || !instance.props.interactive) {\n      instance.popperInstance.reference = {\n        // These `client` values don't get used by Popper.js if they are 0\n        clientWidth: 0,\n        clientHeight: 0,\n        // This will exist in next Popper.js feature release to fix #532\n        // @ts-ignore\n        referenceNode: reference,\n        getBoundingClientRect: (): DOMRect | ClientRect => ({\n          width: isVerticalPlacement ? size : 0,\n          height: isVerticalPlacement ? 0 : size,\n          top: (isHorizontal ? rect.top : clientY) - y,\n          bottom: (isHorizontal ? rect.bottom : clientY) + y,\n          left: (isVertical ? rect.left : clientX) - x,\n          right: (isVertical ? rect.right : clientX) + x,\n        }),\n      }\n\n      instance.popperInstance.update()\n    }\n\n    // \"initial\" behavior\n    if (\n      currentInput.isTouch ||\n      (instance.props.followCursor === 'initial' && instance.state.isVisible)\n    ) {\n      removeListener()\n    }\n  }\n\n  return {\n    onCreate(): void {\n      setPrivateProps(instance.props)\n      setNormalizedPlacement()\n\n      const { popperOptions } = instance.props\n\n      instance.setProps({\n        popperOptions: {\n          ...popperOptions,\n          // Technically we should try and preserve `onCreate` if `.setProps()`\n          // is called after the instance is created, but before the\n          // popperInstance is created, but this correctness seems extremely\n          // unlikely to be needed\n          onCreate(data: Popper.Data): void {\n            if (popperOptions && popperOptions.onCreate) {\n              popperOptions.onCreate(data)\n            }\n\n            isPopperInstanceCreated = true\n          },\n        },\n      })\n    },\n    onPropsUpdated(_, partialProps): void {\n      if (!shouldBypassSetPropsHook) {\n        setPrivateProps(partialProps)\n\n        if (partialProps.placement !== placement) {\n          setNormalizedPlacement()\n        }\n      }\n\n      onMouseMove(lastMouseMoveEvent)\n\n      if (!instance.props.followCursor) {\n        resetReference()\n      }\n    },\n    onMount(): void {\n      // Popper's scroll listeners make sense for `true`, where the cursor\n      // follows both axes. TODO: somehow keep scroll listeners for vertical\n      // scrolling for \"vertical\", and horizontal scrolling for \"horizontal\".\n      if (\n        // Touch devices always emulate \"initial\"\n        currentInput.isTouch ||\n        (firstTriggerEventType !== 'focus' &&\n          instance.props.followCursor !== true)\n      ) {\n        instance.popperInstance!.disableEventListeners()\n      }\n\n      onMouseMove(lastMouseMoveEvent)\n    },\n    onTrigger(_, event): void {\n      // Tapping on touch devices can trigger `mouseenter` then `focus`\n      if (!firstTriggerEventType) {\n        firstTriggerEventType = event.type\n      }\n\n      if (event instanceof MouseEvent) {\n        lastMouseMoveEvent = event\n      }\n\n      if (firstTriggerEventType === 'focus') {\n        resetReference()\n      }\n\n      if (\n        instance.props.followCursor &&\n        firstTriggerEventType !== 'focus' &&\n        // Touch devices can add two listeners due to `mouseenter` + `focus`\n        !(event.type === 'focus' && currentInput.isTouch) &&\n        !(instance.state.isMounted && instance.props.followCursor === 'initial')\n      ) {\n        // Force `flipOnUpdate: true` in followCursor mode, as it's better UX\n        // and works better with initial flips\n        instance.setProps({ flipOnUpdate: true })\n        addListener()\n      } else {\n        instance.setProps({ flipOnUpdate })\n      }\n    },\n    onUntrigger(): void {\n      // The listener gets added in `onTrigger()`, but due to potential delay(s)\n      // the instance made be untriggered before it shows. `onHidden()` will\n      // therefore never be invoked.\n      if (!instance.state.isVisible) {\n        removeListener()\n      }\n\n      firstTriggerEventType = null\n    },\n    onHidden(): void {\n      // If scheduled to show before unmounting (e.g. delay: [500, 0]), the\n      // listener should not be removed\n      if (!instance.state.isScheduledToShow) {\n        removeListener()\n      }\n\n      instance.popperInstance!.options.placement = normalizedPlacement\n    },\n  }\n}\n\nexport function getVirtualOffsets(\n  popper: PopperElement,\n  isVerticalPlacement: boolean,\n): {\n  size: number\n  x: number\n  y: number\n} {\n  const size = isVerticalPlacement ? popper.offsetWidth : popper.offsetHeight\n\n  return {\n    size,\n    x: isVerticalPlacement ? size : 0,\n    y: isVerticalPlacement ? 0 : size,\n  }\n}\n","import { Instance, Props, StickyProps } from '../types'\n\ninterface ExtendedInstance extends Instance {\n  props: Props & StickyProps\n}\n\nexport default function sticky(instance: ExtendedInstance): Partial<Props> {\n  const { reference, popper } = instance\n\n  function shouldCheck(value: 'reference' | 'popper'): boolean {\n    return instance.props.sticky === true || instance.props.sticky === value\n  }\n\n  let prevRefRect = shouldCheck('reference')\n    ? reference.getBoundingClientRect()\n    : null\n  let prevPopRect = shouldCheck('popper')\n    ? popper.getBoundingClientRect()\n    : null\n\n  function updatePosition(): void {\n    const currentRefRect = shouldCheck('reference')\n      ? reference.getBoundingClientRect()\n      : null\n    const currentPopRect = shouldCheck('popper')\n      ? popper.getBoundingClientRect()\n      : null\n\n    // Schedule an update if the reference rect has changed\n    if (\n      (shouldCheck('reference') &&\n        areRectsDifferent(prevRefRect, currentRefRect)) ||\n      (shouldCheck('popper') && areRectsDifferent(prevPopRect, currentPopRect))\n    ) {\n      instance.popperInstance!.update()\n    }\n\n    prevRefRect = currentRefRect\n    prevPopRect = currentPopRect\n\n    if (instance.state.isMounted) {\n      requestAnimationFrame(updatePosition)\n    }\n  }\n\n  return {\n    onMount(): void {\n      if (instance.props.sticky) {\n        updatePosition()\n      }\n    },\n  }\n}\n\nfunction areRectsDifferent(\n  rectA: ClientRect | null,\n  rectB: ClientRect | null,\n): boolean {\n  if (rectA && rectB) {\n    return (\n      rectA.top !== rectB.top ||\n      rectA.right !== rectB.right ||\n      rectA.bottom !== rectB.bottom ||\n      rectA.left !== rectB.left\n    )\n  }\n\n  return true\n}\n"],"names":["createSingleton","tippyInstances","optionalProps","throwErrorWhen","Array","isArray","createInvalidCreateSingletonArgumentError","String","forEach","instance","disable","currentAria","currentTarget","defaultProps","aria","onTrigger","onMount","onUntrigger","onPropsUpdated","onDestroy","handleAriaDescribedByAttribute","id","isInteractive","isShow","setAttribute","removeAttribute","references","map","reference","singleton","tippy","document","createElement","triggerTarget","preserveInvocation","props","popperChildren","tooltip","interactive","event","target","index","indexOf","state","isVisible","setContent","content","getBoundingClientRect","referenceNode","appendTo","parentNode","invokeWithArgsOrReturn","partialProps","useIfDefined","enable","delegate","targets","MISSING_TARGET_WARNING","listeners","childTippyInstances","nativeProps","removeProperties","trigger","returnValue","targetNode","closest","showOnCreate","concat","on","element","eventType","listener","options","addEventListener","push","addEventListeners","splitBySpaces","removeEventListeners","removeEventListener","applyMutations","originalDestroy","destroy","shouldDestroyChildInstances","setProps","followCursor","popper","lastMouseMoveEvent","firstTriggerEventType","isPopperInstanceCreated","normalizedPlacement","shouldBypassSetPropsHook","placement","flipOnUpdate","setPrivateProps","setNormalizedPlacement","shift","split","replace","resetReference","popperInstance","addListener","onMouseMove","removeListener","clientX","clientY","isCursorOverReference","closestCallback","el","rect","isHorizontal","isVertical","isVerticalPlacement","includes","getBasePlacement","currentPlacement","getVirtualOffsets","size","x","y","clientWidth","clientHeight","width","height","top","bottom","left","right","update","currentInput","isTouch","onCreate","popperOptions","data","_","disableEventListeners","type","MouseEvent","isMounted","onHidden","isScheduledToShow","offsetWidth","offsetHeight","sticky","shouldCheck","value","prevRefRect","prevPopRect","updatePosition","currentRefRect","currentPopRect","areRectsDifferent","requestAnimationFrame","rectA","rectB"],"mappings":"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"}