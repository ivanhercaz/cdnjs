!function(e,n,s){e&&!s&&(s=require("underscore"));n.JSONForm=n.JSONForm||{},n.JSONForm.split=function(e,i,d){if(d=d||{},i=i||[],!e||!e.form)return{included:{},excluded:{}};s.isString(i)&&(i=[i]);var r={included:{schema:{properties:{}},form:[]},excluded:{schema:{properties:{}},form:[]}};s.each(e,function(e,n){"schema"!==n&&"form"!==n&&(r.included[n]=e,r.excluded[n]=e)});var o=function(e){return n=e,!!(r=s.isString(n)?n:n.key)&&(s.include(i,r)||!!s.find(i,function(e){return 0===r.indexOf(e+".")||0===r.indexOf(e+"[]")}))||e.items&&!!s.some(e.items,function(e){return o(e)});var n,r},c=function(e){return n=e,!!(r=s.isString(n)?n:n.key)&&!s.include(i,r)&&!s.find(i,function(e){return 0===r.indexOf(e+".")||0===r.indexOf(e+"[]")})||e.items&&!!s.some(e.items,function(e){return c(e)});var n,r},f=function(e,n,r){var i=null,t=e.root||"all"===n||r&&r.key&&"selectfieldset"===r.type||e.type&&"help"===e.type;if((t=t||"included"===n&&o(e))||(t="excluded"===n&&c(e))&&!d.excludeCoupledKeys&&(t=!o(e)),!t)return null;var u=n;return"included"!==u||d.excludeCoupledKeys||e.root||(u="all"),(i=s.clone(e)).items&&(i.items=s.map(i.items,function(e){return f(e,u,i)}),i.items=s.compact(i.items)),i},t=function(e,n){return!!e&&(!!n&&(s.isString(e)?e===n||0===e.indexOf(n+".")||0===e.indexOf(n+"[]"):!(!e.key||e.key!==n&&0!==e.key.indexOf(n+".")&&0!==e.key.indexOf(n+"[]"))||!!s.some(e.items,function(e){return t(e,n)})))},n=null;(n=f({items:e.form,root:!0},"included"))&&(r.included.form=n.items),(n=f({items:e.form,root:!0},"excluded"))&&(r.excluded.form=n.items);var u=e.schema;return u.properties&&(u=u.properties),s.each(u,function(e,n){s.some(r.included.form,function(e){return t(e,n)})?r.included.schema.properties[n]=e:r.excluded.schema.properties[n]=e}),r}}("undefined"!=typeof exports,"undefined"!=typeof exports?exports:window,"undefined"!=typeof _?_:null);