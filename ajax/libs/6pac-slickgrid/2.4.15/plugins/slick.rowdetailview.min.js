!function(A){A.extend(!0,window,{Slick:{Plugins:{RowDetailView:function(e){var u,c,p,w,g="id",n=null,o=this,i=null,l=[],t=new Slick.EventHandler,s=5,a=0,r={columnId:"_detail_selector",cssClass:"detailView-toggle",expandedClass:null,collapsedClass:null,keyPrefix:"_",loadOnce:!1,collapseAllOnSort:!0,saveDetailViewOnScroll:!0,singleRowExpand:!1,useSimpleViewportCalc:!1,alwaysRenderColumn:!0,toolTip:"",width:30,maxRows:null},f=r.keyPrefix,d=0,m=[],R=A.extend(!0,{},r,e);"function"==typeof R.expandableOverride&&k(R.expandableOverride);function v(e,t){if(e)for(var i=0;i<e.length;i++)if(e[i]===t)return i;return-1}function h(e,t){var i=u.getDataItem(t.row);if(E(t.row,i,u)&&(R.useRowClick||u.getColumns()[t.cell][g]===R.columnId&&A(e.target).hasClass(R.cssClass))){if(u.getEditorLock().isActive()&&!u.getEditorLock().commitCurrentEdit())return e.preventDefault(),void e.stopImmediatePropagation();var n=w.getItem(t.row);o.onBeforeRowDetailToggle.notify({grid:u,item:n},e,o),function(e,t){if(!E(e,t,u))return;w.beginUpdate(),function(e){e&&(e[f+"collapsed"]?I(e):V(e))}(t),w.endUpdate()}(t.row,n),o.onAfterRowDetailToggle.notify({grid:u,item:n,expandedRows:l},e,o),e.stopPropagation(),e.stopImmediatePropagation()}}function b(e,t){R.useSimpleViewportCalc?function(){if(u){var i=u.getRenderedRange();l.forEach(function(e){var t=function(e,t){if(Math.abs(t.bottom-d-e)>2*a)return!0;return!1}(w.getRowById(e[g]),i);!t&&0<=v(m,e[g])?y(e,e[g]):t&&x(e,e[g])})}}():function(){if(u){var o=u.getRenderedRange();if(0<l.length){var a="DOWN";if(i){if(i.top===o.top&&i.bottom===o.bottom)return;(i.top>o.top||0===i.top&&0===o.top&&i.bottom>o.bottom)&&(a="UP")}}l.forEach(function(e){var t=w.getRowById(e[g]),i=e[f+"sizePadding"],n=0<=v(m,e[g]);"UP"===a?(R.saveDetailViewOnScroll&&t>=o.bottom-d&&P(e),n&&t-s<o.top&&t>=o.top?y(e,e[g]):!n&&t+i>o.bottom&&x(e,e[g])):"DOWN"===a&&(R.saveDetailViewOnScroll&&t<=o.top+d&&P(e),n&&t+i+s>o.bottom&&t<t+i?y(e,e[g]):!n&&t<o.top&&x(e,e[g]))}),i=o}}()}function x(e,t){var i=e.rowIndex||w.getRowById(e[g]);o.onRowOutOfViewportRange.notify({grid:u,item:e,rowId:t,rowIndex:i,expandedRows:l,rowIdsOutOfViewport:C(t,!0)},null,o)}function y(e,t){var i=e.rowIndex||w.getRowById(e[g]);setTimeout(function(){A(".cellDetailView_"+e[g]).length&&o.onRowBackToViewportRange.notify({grid:u,item:e,rowId:t,rowIndex:i,expandedRows:l,rowIdsOutOfViewport:C(t,!1)},null,o)},100)}function C(e,t){var i=v(m,e);return t&&i<0?m.push(e):!t&&0<=i&&m.splice(i,1),m}function D(){w.beginUpdate();for(var e=l.length-1;0<=e;e--)V(l[e],!0);w.endUpdate()}function V(t,e){e||w.beginUpdate(),R.loadOnce&&P(t),t[f+"collapsed"]=!0;for(var i=1;i<=t[f+"sizePadding"];i++)w.deleteItem(t[g]+"."+i);t[f+"sizePadding"]=0,w.updateItem(t[g],t),l=l.filter(function(e){return e[g]!==t[g]}),e||w.endUpdate()}function I(e){if(R&&R.singleRowExpand&&D(),e[f+"collapsed"]=!1,l.push(e),e[f+"detailContent"]||(e[f+"detailViewLoaded"]=!1),e[f+"detailViewLoaded"]&&!0===R.loadOnce)return o.onAsyncResponse.notify({item:e,itemDetail:e,detailView:e[f+"detailContent"]},void 0,this),S(e),void w.updateItem(e[g],e);e[f+"detailContent"]=R.preTemplate(e),S(e),w.updateItem(e[g],e),R.process(e)}function P(e){if(A("."+p+" .innerDetailView_"+e[g])){var t=A("."+p+" .innerDetailView_"+e[g]).html();void 0!==t&&(e[f+"detailContent"]=t)}}var O=function(e,t){var i={};for(var n in u.getData())i[n]=null;return i[g]=e[g]+"."+t,i[f+"collapsed"]=!0,i[f+"isPadding"]=!0,i[f+"parent"]=e,i[f+"offset"]=t,i};function S(e){var t=R.panelRows;e[f+"sizePadding"]=Math.ceil(2*t*13/c.rowHeight),e[f+"height"]=e[f+"sizePadding"]*c.rowHeight;for(var i=w.getIdxById(e[g]),n=1;n<=e[f+"sizePadding"];n++)w.insertItem(i+n,O(e,n))}function z(e,t,i,n,o,a){if(!E(e,o,a))return null;if(null==o[f+"collapsed"]&&(o[f+"collapsed"]=!0,o[f+"sizePadding"]=0,o[f+"height"]=0,o[f+"isPadding"]=!1,o[f+"parent"]=void 0,o[f+"offset"]=0),o[f+"isPadding"])return null;if(o[f+"collapsed"]){var l=R.cssClass+" expand ";return R.collapsedClass&&(l+=R.collapsedClass),'<div class="'+l+'"></div>'}var s=[],r=c.rowHeight,d=o[f+"sizePadding"]*c.rowHeight;null!==R.maxRows&&o[f+"sizePadding"]>R.maxRows&&(d=R.maxRows*r,o[f+"sizePadding"]=R.maxRows);var u=R.cssClass+" collapse ";return R.expandedClass&&(u+=R.expandedClass),s.push('<div class="'+u+'"></div></div>'),s.push('<div class="dynamic-cell-detail cellDetailView_',o[g],'" '),s.push('style="height:',d,"px;"),s.push("top:",r,'px">'),s.push('<div class="detail-container detailViewContainer_',o[g],'">'),s.push('<div class="innerDetailView_',o[g],'">',o[f+"detailContent"],"</div></div>"),s.join("")}function E(e,t,i){return"function"!=typeof n||n(e,t,i)}function k(e){n=e}A.extend(this,{init:function(e){if(!e)throw new Error('RowDetailView Plugin requires the Grid instance to be passed as argument to the "init()" method');p=(u=e).getUID(),c=e.getOptions()||{},w=u.getData(),f=R&&R.keyPrefix||"_",d=u.getOptions().minRowBuffer,u.getOptions().minRowBuffer=R.panelRows+3,t.subscribe(u.onClick,h).subscribe(u.onScroll,b),R.collapseAllOnSort&&(t.subscribe(u.onSort,D),l=[],m=[]),t.subscribe(u.getData().onRowCountChanged,function(){u.updateRowCount(),u.render()}),t.subscribe(u.getData().onRowsChanged,function(e,t){u.invalidateRows(t.rows),u.render()}),o.onAsyncResponse.subscribe(function(e,t){if(!t||!t.item&&!t.itemDetail)throw'Slick.RowDetailView plugin requires the onAsyncResponse() to supply "args.item" property.';var i=t.item||t.itemDetail;t.detailView?i[f+"detailContent"]=t.detailView:i[f+"detailContent"]=R.postTemplate(i),i[f+"detailViewLoaded"]=!0,w.updateItem(i[g],i),o.onAsyncEndUpdate.notify({grid:u,item:i,itemDetail:i},e,o)}),t.subscribe(w.onSetItemsCalled,function(e,t){g=w&&w.getIdPropertyName()||"id"}),R.useSimpleViewportCalc&&t.subscribe(u.onRendered,function(e,t){t&&t.endRow&&(a=t.endRow-t.startRow)})},destroy:function(){t.unsubscribeAll(),o.onAsyncResponse.unsubscribe(),o.onAsyncEndUpdate.unsubscribe(),o.onAfterRowDetailToggle.unsubscribe(),o.onBeforeRowDetailToggle.unsubscribe(),o.onRowOutOfViewportRange.unsubscribe(),o.onRowBackToViewportRange.unsubscribe()},pluginName:"RowDetailView",collapseAll:D,collapseDetailView:V,expandDetailView:I,expandableOverride:k,getColumnDefinition:function(){return{id:R.columnId,name:"",toolTip:R.toolTip,field:"sel",width:R.width,resizable:!1,sortable:!1,alwaysRenderColumn:R.alwaysRenderColumn,cssClass:R.cssClass,formatter:z}},getExpandedRows:function(){return l},getFilterItem:function(e){return e[f+"isPadding"]&&e[f+"parent"]&&(e=e[f+"parent"]),e},getOptions:function(){return R},resizeDetailView:function(e){if(e){var t=document.querySelector("."+p+" .detailViewContainer_"+e[g]),i=document.querySelector("."+p+" .cellDetailView_"+e[g]),n=document.querySelector("."+p+" .innerDetailView_"+e[g]);if(t&&i&&n){for(var o=1;o<=e[f+"sizePadding"];o++)w.deleteItem(e[g]+"."+o);var a=c.rowHeight;t.style.minHeight=null;var l=t.scrollHeight,s=Math.ceil(l/a);e[f+"sizePadding"]=Math.ceil(2*s*13/a),e[f+"height"]=l;var r=e[f+"sizePadding"]*a;null!==R.maxRows&&e[f+"sizePadding"]>R.maxRows&&(r=R.maxRows*a,e[f+"sizePadding"]=R.maxRows),u.getOptions().minRowBuffer<e[f+"sizePadding"]&&(u.getOptions().minRowBuffer=e[f+"sizePadding"]+3),t.setAttribute("style","min-height: "+e[f+"height"]+"px"),i&&i.setAttribute("style","height: "+r+"px; top:"+a+"px");var d=w.getIdxById(e[g]);for(o=1;o<=e[f+"sizePadding"];o++)w.insertItem(d+o,O(e,o));P(e)}}},saveDetailView:P,setOptions:function(e){(R=A.extend(!0,{},R,e))&&R.singleRowExpand&&D()},onAsyncResponse:new Slick.Event,onAsyncEndUpdate:new Slick.Event,onAfterRowDetailToggle:new Slick.Event,onBeforeRowDetailToggle:new Slick.Event,onRowOutOfViewportRange:new Slick.Event,onRowBackToViewportRange:new Slick.Event})}}}})}(jQuery);