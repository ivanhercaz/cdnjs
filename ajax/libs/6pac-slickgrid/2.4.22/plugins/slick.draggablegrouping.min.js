!function(m){m.extend(!0,window,{Slick:{DraggableGrouping:function(p){var n,u,g,a,i,f,s,t={},o=new Slick.Event;var h=[];function d(t,d){var c=d.attr("id").replace(u,""),l=!0;h.forEach(function(e,o,r){e.id==c&&(l=!1)}),l&&(g.forEach(function(e,o,r){var l,n,a,i,s;e.id==c&&(null==e.grouping||m.isEmptyObject(e.grouping)||(l=m("<div id='"+u+e.id+"_entry' data-id='"+e.id+"' class='slick-dropped-grouping'>"),m("<div style='display: inline-flex'>"+d.text()+"</div>").appendTo(l),n=m("<div class='slick-groupby-remove'>&nbsp;</div>"),p.deleteIconCssClass&&n.addClass(p.deleteIconCssClass),p.deleteIconImage&&n.css("background","url("+p.deleteIconImage+") no-repeat center right"),p.deleteIconCssClass||p.deleteIconImage||n.addClass("slick-groupby-remove-image"),n.appendTo(l),m("</div>").appendTo(l),l.appendTo(t),s=e,h.push(s),v("add-group"),a=e.id,i=l,m("#"+u+a+"_entry >.slick-groupby-remove").on("click",function(){m(this).off("click"),function(e,o){o.remove();var l=[];g.forEach(function(e,o,r){l[e.id]=e}),function(e){var o,r,l=arguments,n=l.length;for(;1<n&&e.length;)for(o=l[--n];-1!=(r=e.indexOf(o));)e.splice(r,1)}(h,l[e]),0===h.length&&f.show();v("remove-group")}(a,i)})))}),s.css("display","block"))}function v(e){if(0===h.length)return a.setGrouping([]),void o.notify({caller:e,groupColumns:[]});var l=[];h.forEach(function(e,o,r){l.push(e.grouping)}),a.setGrouping(l),o.notify({caller:e,groupColumns:l})}m.extend(this,{init:function(e){p=m.extend(!0,{},t,p),u=(n=e).getUID(),g=n.getColumns(),a=n.getData(),i=m(n.getPreHeaderPanel());var o=p.dropPlaceHolderText||"Drop a column header here to group by the column";i.html("<div class='slick-placeholder'>"+o+"</div><div class='slick-group-toggle-all expanded' style='display:none'></div>"),f=i.find(".slick-placeholder"),s=i.find(".slick-group-toggle-all"),i.droppable({activeClass:"ui-state-default",hoverClass:"ui-state-hover",accept:":not(.ui-sortable-helper)",deactivate:function(e,o){i.removeClass("slick-header-column-denied")},drop:function(e,o){d(this,o.draggable)},over:function(e,o){var l=o.draggable.attr("id").replace(u,"");g.forEach(function(e,o,r){e.id==l&&null==e.grouping&&i.addClass("slick-header-column-denied")})}}),i.sortable({items:"div.slick-dropped-grouping",cursor:"default",tolerance:"pointer",helper:"clone",update:function(e,o){for(var r=m(this).sortable("toArray",{attribute:"data-id"}),l=[],n=0,a=r.length;n<a;n++)for(var i=0,s=h.length;i<s;i++)if(h[i].id==r[n]){l.push(h[i]);break}h=l,v("sort-group")}}),i.html(),s.on("click",function(e){this.classList.contains("collapsed")?(this.classList.remove("collapsed"),this.classList.add("expanded"),a.expandAllGroups()):(this.classList.add("collapsed"),this.classList.remove("expanded"),a.collapseAllGroups())}),n.onHeaderCellRendered.subscribe(function(e,o){var r,l=o.column,n=o.node;m.isEmptyObject(l.grouping)||(r=m("<span class='slick-column-groupable' />"),p.groupIconCssClass&&r.addClass(p.groupIconCssClass),p.groupIconImage&&r.css("background","url("+p.groupIconImage+") no-repeat center center"),m(n).css("cursor","pointer").append(r))});for(var r=0;r<g.length;r++){var l=g[r].field;n.updateColumnHeader(l)}},destroy:function(){o.unsubscribe()},pluginName:"DraggableGrouping",onGroupChanged:o,setDroppedGroups:function(e){var o=e instanceof Array?e:[e];f.hide();for(var r=0;r<o.length;r++){var l=m(n.getHeaderColumn(o[r]));d(i,l)}},clearDroppedGroups:function(){h=[],v("clear-all"),i.find(".slick-dropped-grouping").remove(),s.css("display","none"),f.show()},getSetupColumnReorder:function(n,a,e,i,s,t,d,c,p){a.filter(":ui-sortable").sortable("destroy");var r=m(n.getPreHeaderPanel());a.sortable({distance:3,cursor:"default",tolerance:"intersection",helper:"clone",placeholder:"slick-sortable-placeholder ui-state-default slick-header-column",forcePlaceholderSize:!0,appendTo:"body",start:function(e,o){m(o.helper).addClass("slick-header-column-active"),r.find(".slick-placeholder").show(),r.find(".slick-dropped-grouping").hide()},beforeStop:function(e,o){m(o.helper).removeClass("slick-header-column-active"),0<r.find(".slick-dropped-grouping").length&&(r.find(".slick-placeholder").hide(),r.find(".slick-dropped-grouping").show())},stop:function(e){if(n.getEditorLock().commitCurrentEdit()){for(var o=a.sortable("toArray"),r=[],l=0;l<o.length;l++)r.push(t[d(o[l].replace(c,""))]);i(r),p(n.onColumnsReordered,{grid:n}),e.stopPropagation(),s()}else m(this).sortable("cancel")}})}})}}})}(jQuery);