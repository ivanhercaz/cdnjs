!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.pnp=t():e.pnp=t()}(window,function(){return r={},i.m=n=[function(e,n,r){"use strict";(function(e){r.d(n,"a",function(){return t});var t=void 0===e?window:e}).call(this,r(2))},function(e,t,n){var r=function(){"use strict";return r=function(e){if(this.REQUEST_TYPE={LOGIN:"LOGIN",RENEW_TOKEN:"RENEW_TOKEN",UNKNOWN:"UNKNOWN"},this.RESPONSE_TYPE={ID_TOKEN_TOKEN:"id_token token",TOKEN:"token"},this.CONSTANTS={ACCESS_TOKEN:"access_token",EXPIRES_IN:"expires_in",ID_TOKEN:"id_token",ERROR_DESCRIPTION:"error_description",SESSION_STATE:"session_state",ERROR:"error",STORAGE:{TOKEN_KEYS:"adal.token.keys",ACCESS_TOKEN_KEY:"adal.access.token.key",EXPIRATION_KEY:"adal.expiration.key",STATE_LOGIN:"adal.state.login",STATE_RENEW:"adal.state.renew",NONCE_IDTOKEN:"adal.nonce.idtoken",SESSION_STATE:"adal.session.state",USERNAME:"adal.username",IDTOKEN:"adal.idtoken",ERROR:"adal.error",ERROR_DESCRIPTION:"adal.error.description",LOGIN_REQUEST:"adal.login.request",LOGIN_ERROR:"adal.login.error",RENEW_STATUS:"adal.token.renew.status",ANGULAR_LOGIN_REQUEST:"adal.angular.login.request"},RESOURCE_DELIMETER:"|",CACHE_DELIMETER:"||",LOADFRAME_TIMEOUT:6e3,TOKEN_RENEW_STATUS_CANCELED:"Canceled",TOKEN_RENEW_STATUS_COMPLETED:"Completed",TOKEN_RENEW_STATUS_IN_PROGRESS:"In Progress",LOGGING_LEVEL:{ERROR:0,WARN:1,INFO:2,VERBOSE:3},LEVEL_STRING_MAP:{0:"ERROR:",1:"WARNING:",2:"INFO:",3:"VERBOSE:"},POPUP_WIDTH:483,POPUP_HEIGHT:600},r.prototype._singletonInstance)return r.prototype._singletonInstance;if((r.prototype._singletonInstance=this).instance="https://login.microsoftonline.com/",this.config={},this.callback=null,this.popUp=!1,this.isAngular=!1,this._user=null,this._activeRenewals={},this._loginInProgress=!1,this._acquireTokenInProgress=!1,this._renewStates=[],this._callBackMappedToRenewStates={},this._callBacksMappedToRenewStates={},this._openedWindows=[],this._requestType=this.REQUEST_TYPE.LOGIN,window._adalInstance=this,e.displayCall&&"function"!=typeof e.displayCall)throw new Error("displayCall is not a function");if(!e.clientId)throw new Error("clientId is required");this.config=this._cloneConfig(e),void 0===this.config.navigateToLoginRequestUrl&&(this.config.navigateToLoginRequestUrl=!0),this.config.popUp&&(this.popUp=!0),this.config.callback&&"function"==typeof this.config.callback&&(this.callback=this.config.callback),this.config.instance&&(this.instance=this.config.instance),this.config.loginResource||(this.config.loginResource=this.config.clientId),this.config.redirectUri||(this.config.redirectUri=window.location.href.split("?")[0].split("#")[0]),this.config.postLogoutRedirectUri||(this.config.postLogoutRedirectUri=window.location.href.split("?")[0].split("#")[0]),this.config.anonymousEndpoints||(this.config.anonymousEndpoints=[]),this.config.isAngular&&(this.isAngular=this.config.isAngular),this.config.loadFrameTimeout&&(this.CONSTANTS.LOADFRAME_TIMEOUT=this.config.loadFrameTimeout)},"undefined"!=typeof window&&(window.Logging={piiLoggingEnabled:!1,level:0,log:function(e){}}),r.prototype.login=function(){var e,t,n;this._loginInProgress?this.info("Login in progress"):(this._loginInProgress=!0,e=this._guid(),this.config.state=e,this._idTokenNonce=this._guid(),(t=this._getItem(this.CONSTANTS.STORAGE.ANGULAR_LOGIN_REQUEST))&&""!==t?this._saveItem(this.CONSTANTS.STORAGE.ANGULAR_LOGIN_REQUEST,""):t=window.location.href,this.verbose("Expected state: "+e+" startPage:"+t),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_REQUEST,t),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.STATE_LOGIN,e,!0),this._saveItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN,this._idTokenNonce,!0),this._saveItem(this.CONSTANTS.STORAGE.ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,""),n=this._getNavigateUrl("id_token",null)+"&nonce="+encodeURIComponent(this._idTokenNonce),this.config.displayCall?this.config.displayCall(n):this.popUp?(this._saveItem(this.CONSTANTS.STORAGE.STATE_LOGIN,""),this._renewStates.push(e),this.registerCallback(e,this.config.clientId,this.callback),this._loginPopup(n)):this.promptUser(n))},r.prototype._openPopup=function(e,t,n,r){try{var i=window.screenLeft?window.screenLeft:window.screenX,o=window.screenTop?window.screenTop:window.screenY,s=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,a=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,u=s/2-n/2+i,c=a/2-r/2+o,l=window.open(e,t,"width="+n+", height="+r+", top="+c+", left="+u);return l.focus&&l.focus(),l}catch(e){return this.warn("Error opening popup, "+e.message),this._loginInProgress=!1,this._acquireTokenInProgress=!1,null}},r.prototype._handlePopupError=function(e,t,n,r,i){this.warn(r),this._saveItem(this.CONSTANTS.STORAGE.ERROR,n),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,r),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,i),t&&this._activeRenewals[t]&&(this._activeRenewals[t]=null),this._loginInProgress=!1,this._acquireTokenInProgress=!1,e&&e(r,null,n)},r.prototype._loginPopup=function(e,r,t){var i,o,s,n,a=this._openPopup(e,"login",this.CONSTANTS.POPUP_WIDTH,this.CONSTANTS.POPUP_HEIGHT),u=t||this.callback;null!=a?(this._openedWindows.push(a),i=-1!=this.config.redirectUri.indexOf("#")?this.config.redirectUri.split("#")[0]:this.config.redirectUri,o=this,s=window.setInterval(function(){if(!a||a.closed||void 0===a.closed){var e="Popup Window closed",t="Popup Window closed by UI action/ Popup Window handle destroyed due to cross zone navigation in IE/Edge";return o.isAngular&&o._broadcast("adal:popUpClosed",t+o.CONSTANTS.RESOURCE_DELIMETER+e),o._handlePopupError(u,r,e,t,t),void window.clearInterval(s)}try{var n=a.location;if(-1!=encodeURI(n.href).indexOf(encodeURI(i)))return o.isAngular?o._broadcast("adal:popUpHashChanged",n.hash):o.handleWindowCallback(n.hash),window.clearInterval(s),o._loginInProgress=!1,o._acquireTokenInProgress=!1,o.info("Closing popup window"),o._openedWindows=[],void a.close()}catch(e){}},1)):(n="Popup Window is null. This can happen if you are using IE",this._handlePopupError(u,r,"Error opening popup",n,n))},r.prototype._broadcast=function(e,t){function n(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var n=document.createEvent("CustomEvent");return n.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),n}"function"!=typeof window.CustomEvent&&(n.prototype=window.Event.prototype,window.CustomEvent=n);var r=new CustomEvent(e,{detail:t});window.dispatchEvent(r)},r.prototype.loginInProgress=function(){return this._loginInProgress},r.prototype._hasResource=function(e){var t=this._getItem(this.CONSTANTS.STORAGE.TOKEN_KEYS);return t&&!this._isEmpty(t)&&-1<t.indexOf(e+this.CONSTANTS.RESOURCE_DELIMETER)},r.prototype.getCachedToken=function(e){if(!this._hasResource(e))return null;var t=this._getItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+e),n=this._getItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+e),r=this.config.expireOffsetSeconds||300;return n&&n>this._now()+r?t:(this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+e,""),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+e,0),null)},r.prototype.getCachedUser=function(){if(this._user)return this._user;var e=this._getItem(this.CONSTANTS.STORAGE.IDTOKEN);return this._user=this._createUser(e),this._user},r.prototype.registerCallback=function(o,s,e){this._activeRenewals[s]=o,this._callBacksMappedToRenewStates[o]||(this._callBacksMappedToRenewStates[o]=[]);var a=this;this._callBacksMappedToRenewStates[o].push(e),this._callBackMappedToRenewStates[o]||(this._callBackMappedToRenewStates[o]=function(e,t,n,r){a._activeRenewals[s]=null;for(var i=0;i<a._callBacksMappedToRenewStates[o].length;++i)try{a._callBacksMappedToRenewStates[o][i](e,t,n,r)}catch(n){a.warn(n)}a._callBacksMappedToRenewStates[o]=null,a._callBackMappedToRenewStates[o]=null})},r.prototype._renewToken=function(e,t,n){this.info("renewToken is called for resource:"+e);var r=this._addAdalFrame("adalRenewFrame"+e),i=this._guid()+"|"+e;this.config.state=i,this._renewStates.push(i),this.verbose("Renew token Expected state: "+i),n=n||"token";var o=this._urlRemoveQueryStringParameter(this._getNavigateUrl(n,e),"prompt");n===this.RESPONSE_TYPE.ID_TOKEN_TOKEN&&(this._idTokenNonce=this._guid(),this._saveItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN,this._idTokenNonce,!0),o+="&nonce="+encodeURIComponent(this._idTokenNonce)),o+="&prompt=none",o=this._addHintParameters(o),this.registerCallback(i,e,t),this.verbosePii("Navigate to:"+o),r.src="about:blank",this._loadFrameTimeout(o,"adalRenewFrame"+e,e)},r.prototype._renewIdToken=function(e,t){this.info("renewIdToken is called");var n=this._addAdalFrame("adalIdTokenFrame"),r=this._guid()+"|"+this.config.clientId;this._idTokenNonce=this._guid(),this._saveItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN,this._idTokenNonce,!0),this.config.state=r,this._renewStates.push(r),this.verbose("Renew Idtoken Expected state: "+r);var i=null==t?null:this.config.clientId,o=(t=t||"id_token",this._urlRemoveQueryStringParameter(this._getNavigateUrl(t,i),"prompt"));o+="&prompt=none",o=this._addHintParameters(o),o+="&nonce="+encodeURIComponent(this._idTokenNonce),this.registerCallback(r,this.config.clientId,e),this.verbosePii("Navigate to:"+o),n.src="about:blank",this._loadFrameTimeout(o,"adalIdTokenFrame",this.config.clientId)},r.prototype._urlContainsQueryStringParameter=function(e,t){return new RegExp("[\\?&]"+e+"=").test(t)},r.prototype._urlRemoveQueryStringParameter=function(e,t){var n=new RegExp("(\\&"+t+"=)[^&]+");return e=e.replace(n,""),n=new RegExp("("+t+"=)[^&]+&"),e=e.replace(n,""),n=new RegExp("("+t+"=)[^&]+"),e.replace(n,"")},r.prototype._loadFrameTimeout=function(e,t,n){this.verbose("Set loading state to pending for: "+n),this._saveItem(this.CONSTANTS.STORAGE.RENEW_STATUS+n,this.CONSTANTS.TOKEN_RENEW_STATUS_IN_PROGRESS),this._loadFrame(e,t);var r=this;setTimeout(function(){var e;r._getItem(r.CONSTANTS.STORAGE.RENEW_STATUS+n)===r.CONSTANTS.TOKEN_RENEW_STATUS_IN_PROGRESS&&(r.verbose("Loading frame has timed out after: "+r.CONSTANTS.LOADFRAME_TIMEOUT/1e3+" seconds for resource "+n),(e=r._activeRenewals[n])&&r._callBackMappedToRenewStates[e]&&r._callBackMappedToRenewStates[e]("Token renewal operation failed due to timeout",null,"Token Renewal Failed"),r._saveItem(r.CONSTANTS.STORAGE.RENEW_STATUS+n,r.CONSTANTS.TOKEN_RENEW_STATUS_CANCELED))},r.CONSTANTS.LOADFRAME_TIMEOUT)},r.prototype._loadFrame=function(t,e){var n=this;n.info("LoadFrame: "+e);var r=e;setTimeout(function(){var e=n._addAdalFrame(r);""!==e.src&&"about:blank"!==e.src||(e.src=t,n._loadFrame(t,r))},500)},r.prototype.acquireToken=function(e,t){if(this._isEmpty(e))return this.warn("resource is required"),void t("resource is required",null,"resource is required");var n=this.getCachedToken(e);return n?(this.info("Token is already in cache for resource:"+e),void t(null,n,null)):this._user||this.config.extraQueryParameter&&-1!==this.config.extraQueryParameter.indexOf("login_hint")?void(this._activeRenewals[e]?this.registerCallback(this._activeRenewals[e],e,t):(this._requestType=this.REQUEST_TYPE.RENEW_TOKEN,e===this.config.clientId?this._user?(this.verbose("renewing idtoken"),this._renewIdToken(t)):(this.verbose("renewing idtoken and access_token"),this._renewIdToken(t,this.RESPONSE_TYPE.ID_TOKEN_TOKEN)):this._user?(this.verbose("renewing access_token"),this._renewToken(e,t)):(this.verbose("renewing idtoken and access_token"),this._renewToken(e,t,this.RESPONSE_TYPE.ID_TOKEN_TOKEN)))):(this.warn("User login is required"),void t("User login is required",null,"login required"))},r.prototype.acquireTokenPopup=function(e,t,n,r){if(this._isEmpty(e))return this.warn("resource is required"),void r("resource is required",null,"resource is required");if(!this._user)return this.warn("User login is required"),void r("User login is required",null,"login required");if(this._acquireTokenInProgress)return this.warn("Acquire token interactive is already in progress"),void r("Acquire token interactive is already in progress",null,"Acquire token interactive is already in progress");var i=this._guid()+"|"+e;this.config.state=i,this._renewStates.push(i),this._requestType=this.REQUEST_TYPE.RENEW_TOKEN,this.verbose("Renew token Expected state: "+i);var o=this._urlRemoveQueryStringParameter(this._getNavigateUrl("token",e),"prompt");if(o+="&prompt=select_account",t&&(o+=t),n&&-1===o.indexOf("&claims"))o+="&claims="+encodeURIComponent(n);else if(n&&-1!==o.indexOf("&claims"))throw new Error("Claims cannot be passed as an extraQueryParameter");o=this._addHintParameters(o),this._acquireTokenInProgress=!0,this.info("acquireToken interactive is called for the resource "+e),this.registerCallback(i,e,r),this._loginPopup(o,e,r)},r.prototype.acquireTokenRedirect=function(e,t,n){if(this._isEmpty(e))return this.warn("resource is required"),void r("resource is required",null,"resource is required");var r=this.callback;if(!this._user)return this.warn("User login is required"),void r("User login is required",null,"login required");if(this._acquireTokenInProgress)return this.warn("Acquire token interactive is already in progress"),void r("Acquire token interactive is already in progress",null,"Acquire token interactive is already in progress");var i=this._guid()+"|"+e;this.config.state=i,this.verbose("Renew token Expected state: "+i);var o=this._urlRemoveQueryStringParameter(this._getNavigateUrl("token",e),"prompt");if(o+="&prompt=select_account",t&&(o+=t),n&&-1===o.indexOf("&claims"))o+="&claims="+encodeURIComponent(n);else if(n&&-1!==o.indexOf("&claims"))throw new Error("Claims cannot be passed as an extraQueryParameter");o=this._addHintParameters(o),this._acquireTokenInProgress=!0,this.info("acquireToken interactive is called for the resource "+e),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_REQUEST,window.location.href),this._saveItem(this.CONSTANTS.STORAGE.STATE_RENEW,i,!0),this.promptUser(o)},r.prototype.promptUser=function(e){e?(this.infoPii("Navigate to:"+e),window.location.replace(e)):this.info("Navigate url is empty")},r.prototype.clearCache=function(){this._saveItem(this.CONSTANTS.STORAGE.LOGIN_REQUEST,""),this._saveItem(this.CONSTANTS.STORAGE.ANGULAR_LOGIN_REQUEST,""),this._saveItem(this.CONSTANTS.STORAGE.SESSION_STATE,""),this._saveItem(this.CONSTANTS.STORAGE.STATE_LOGIN,""),this._saveItem(this.CONSTANTS.STORAGE.STATE_RENEW,""),this._renewStates=[],this._saveItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN,""),this._saveItem(this.CONSTANTS.STORAGE.IDTOKEN,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,""),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,"");var e=this._getItem(this.CONSTANTS.STORAGE.TOKEN_KEYS);if(!this._isEmpty(e)){e=e.split(this.CONSTANTS.RESOURCE_DELIMETER);for(var t=0;t<e.length&&""!==e[t];t++)this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+e[t],""),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+e[t],0)}this._saveItem(this.CONSTANTS.STORAGE.TOKEN_KEYS,"")},r.prototype.clearCacheForResource=function(e){this._saveItem(this.CONSTANTS.STORAGE.STATE_RENEW,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,""),this._hasResource(e)&&(this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+e,""),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+e,0))},r.prototype.logOut=function(){var e,t,n;this.clearCache(),this._user=null,e=this.config.logOutUri?this.config.logOutUri:(t="common",n="",this.config.tenant&&(t=this.config.tenant),this.config.postLogoutRedirectUri&&(n="post_logout_redirect_uri="+encodeURIComponent(this.config.postLogoutRedirectUri)),this.instance+t+"/oauth2/logout?"+n),this.infoPii("Logout navigate to: "+e),this.promptUser(e)},r.prototype._isEmpty=function(e){return void 0===e||!e||0===e.length},r.prototype.getUser=function(e){if("function"!=typeof e)throw new Error("callback is not a function");var t;this._user?e(null,this._user):(t=this._getItem(this.CONSTANTS.STORAGE.IDTOKEN),this._isEmpty(t)?(this.warn("User information is not available"),e("User information is not available",null)):(this.info("User exists in cache: "),this._user=this._createUser(t),e(null,this._user)))},r.prototype._addHintParameters=function(e){var t;return this._user&&this._user.profile&&(this._user.profile.sid&&-1!==e.indexOf("&prompt=none")?this._urlContainsQueryStringParameter("sid",e)||(e+="&sid="+encodeURIComponent(this._user.profile.sid)):this._user.profile.upn&&(this._urlContainsQueryStringParameter("login_hint",e)||(e+="&login_hint="+encodeURIComponent(this._user.profile.upn)),!this._urlContainsQueryStringParameter("domain_hint",e)&&-1<this._user.profile.upn.indexOf("@"))&&(t=this._user.profile.upn.split("@"),e+="&domain_hint="+encodeURIComponent(t[t.length-1]))),e},r.prototype._createUser=function(e){var t=null,n=this._extractIdToken(e);return n&&n.hasOwnProperty("aud")&&(n.aud.toLowerCase()===this.config.clientId.toLowerCase()?(t={userName:"",profile:n},n.hasOwnProperty("upn")?t.userName=n.upn:n.hasOwnProperty("email")&&(t.userName=n.email)):this.warn("IdToken has invalid aud field")),t},r.prototype._getHash=function(e){return-1<e.indexOf("#/")?e=e.substring(e.indexOf("#/")+2):-1<e.indexOf("#")&&(e=e.substring(1)),e},r.prototype.isCallback=function(e){e=this._getHash(e);var t=this._deserialize(e);return t.hasOwnProperty(this.CONSTANTS.ERROR_DESCRIPTION)||t.hasOwnProperty(this.CONSTANTS.ACCESS_TOKEN)||t.hasOwnProperty(this.CONSTANTS.ID_TOKEN)},r.prototype.getLoginError=function(){return this._getItem(this.CONSTANTS.STORAGE.LOGIN_ERROR)},r.prototype.getRequestInfo=function(e){e=this._getHash(e);var t,n=this._deserialize(e),r={valid:!1,parameters:{},stateMatch:!1,stateResponse:"",requestType:this.REQUEST_TYPE.UNKNOWN};if(n&&((r.parameters=n).hasOwnProperty(this.CONSTANTS.ERROR_DESCRIPTION)||n.hasOwnProperty(this.CONSTANTS.ACCESS_TOKEN)||n.hasOwnProperty(this.CONSTANTS.ID_TOKEN))){if(r.valid=!0,!n.hasOwnProperty("state"))return this.warn("No state returned"),r;if(this.verbose("State: "+n.state),t=n.state,r.stateResponse=t,this._matchState(r))return r;if(!r.stateMatch&&window.parent){r.requestType=this._requestType;for(var i=this._renewStates,o=0;o<i.length;o++)if(i[o]===r.stateResponse){r.stateMatch=!0;break}}}return r},r.prototype._matchNonce=function(e){var t=this._getItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN);if(t){t=t.split(this.CONSTANTS.CACHE_DELIMETER);for(var n=0;n<t.length;n++)if(t[n]===e.profile.nonce)return!0}return!1},r.prototype._matchState=function(e){var t=this._getItem(this.CONSTANTS.STORAGE.STATE_LOGIN);if(t){t=t.split(this.CONSTANTS.CACHE_DELIMETER);for(var n=0;n<t.length;n++)if(t[n]===e.stateResponse)return e.requestType=this.REQUEST_TYPE.LOGIN,e.stateMatch=!0}var r=this._getItem(this.CONSTANTS.STORAGE.STATE_RENEW);if(r)for(r=r.split(this.CONSTANTS.CACHE_DELIMETER),n=0;n<r.length;n++)if(r[n]===e.stateResponse)return e.requestType=this.REQUEST_TYPE.RENEW_TOKEN,e.stateMatch=!0;return!1},r.prototype._getResourceFromState=function(e){if(e){var t=e.indexOf("|");if(-1<t&&t+1<e.length)return e.substring(t+1)}return""},r.prototype.saveTokenFromHash=function(e){this.info("State status:"+e.stateMatch+"; Request type:"+e.requestType),this._saveItem(this.CONSTANTS.STORAGE.ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,"");var t,n=this._getResourceFromState(e.stateResponse);e.parameters.hasOwnProperty(this.CONSTANTS.ERROR_DESCRIPTION)?(this.infoPii("Error :"+e.parameters.error+"; Error description:"+e.parameters[this.CONSTANTS.ERROR_DESCRIPTION]),this._saveItem(this.CONSTANTS.STORAGE.ERROR,e.parameters.error),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,e.parameters[this.CONSTANTS.ERROR_DESCRIPTION]),e.requestType===this.REQUEST_TYPE.LOGIN&&(this._loginInProgress=!1,this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,e.parameters.error_description))):e.stateMatch?(this.info("State is right"),e.parameters.hasOwnProperty(this.CONSTANTS.SESSION_STATE)&&this._saveItem(this.CONSTANTS.STORAGE.SESSION_STATE,e.parameters[this.CONSTANTS.SESSION_STATE]),e.parameters.hasOwnProperty(this.CONSTANTS.ACCESS_TOKEN)&&(this.info("Fragment has access token"),this._hasResource(n)||(t=this._getItem(this.CONSTANTS.STORAGE.TOKEN_KEYS)||"",this._saveItem(this.CONSTANTS.STORAGE.TOKEN_KEYS,t+n+this.CONSTANTS.RESOURCE_DELIMETER)),this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+n,e.parameters[this.CONSTANTS.ACCESS_TOKEN]),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+n,this._expiresIn(e.parameters[this.CONSTANTS.EXPIRES_IN]))),e.parameters.hasOwnProperty(this.CONSTANTS.ID_TOKEN)&&(this.info("Fragment has id token"),this._loginInProgress=!1,this._user=this._createUser(e.parameters[this.CONSTANTS.ID_TOKEN]),this._user&&this._user.profile?this._matchNonce(this._user)?(this._saveItem(this.CONSTANTS.STORAGE.IDTOKEN,e.parameters[this.CONSTANTS.ID_TOKEN]),n=this.config.loginResource?this.config.loginResource:this.config.clientId,this._hasResource(n)||(t=this._getItem(this.CONSTANTS.STORAGE.TOKEN_KEYS)||"",this._saveItem(this.CONSTANTS.STORAGE.TOKEN_KEYS,t+n+this.CONSTANTS.RESOURCE_DELIMETER)),this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+n,e.parameters[this.CONSTANTS.ID_TOKEN]),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+n,this._user.profile.exp)):(this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,"Nonce received: "+this._user.profile.nonce+" is not same as requested: "+this._getItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN)),this._user=null):(e.parameters.error="invalid id_token",e.parameters.error_description="Invalid id_token. id_token: "+e.parameters[this.CONSTANTS.ID_TOKEN],this._saveItem(this.CONSTANTS.STORAGE.ERROR,"invalid id_token"),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,"Invalid id_token. id_token: "+e.parameters[this.CONSTANTS.ID_TOKEN])))):(e.parameters.error="Invalid_state",e.parameters.error_description="Invalid_state. state: "+e.stateResponse,this._saveItem(this.CONSTANTS.STORAGE.ERROR,"Invalid_state"),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,"Invalid_state. state: "+e.stateResponse)),this._saveItem(this.CONSTANTS.STORAGE.RENEW_STATUS+n,this.CONSTANTS.TOKEN_RENEW_STATUS_COMPLETED)},r.prototype.getResourceForEndpoint=function(e){if(this.config&&this.config.anonymousEndpoints)for(var t=0;t<this.config.anonymousEndpoints.length;t++)if(-1<e.indexOf(this.config.anonymousEndpoints[t]))return null;if(this.config&&this.config.endpoints)for(var n in this.config.endpoints)if(-1<e.indexOf(n))return this.config.endpoints[n];return!(-1<e.indexOf("http://")||-1<e.indexOf("https://"))||this._getHostFromUri(e)===this._getHostFromUri(this.config.redirectUri)?this.config.loginResource:null},r.prototype._getHostFromUri=function(e){return String(e).replace(/^(https?:)\/\//,"").split("/")[0]},r.prototype.handleWindowCallback=function(e){if(null==e&&(e=window.location.hash),this.isCallback(e)){var t=null,n=!1;0<this._openedWindows.length&&this._openedWindows[this._openedWindows.length-1].opener&&this._openedWindows[this._openedWindows.length-1].opener._adalInstance?(t=this._openedWindows[this._openedWindows.length-1].opener._adalInstance,n=!0):window.parent&&window.parent._adalInstance&&(t=window.parent._adalInstance);var r,i=t.getRequestInfo(e),o=null,s=n||window.parent!==window?t._callBackMappedToRenewStates[i.stateResponse]:t.callback;t.info("Returned from redirect url"),t.saveTokenFromHash(i),i.requestType===this.REQUEST_TYPE.RENEW_TOKEN&&window.parent?(window.parent!==window?t.verbose("Window is in iframe, acquiring token silently"):t.verbose("acquiring token interactive in progress"),r=i.parameters[t.CONSTANTS.ACCESS_TOKEN]||i.parameters[t.CONSTANTS.ID_TOKEN],o=t.CONSTANTS.ACCESS_TOKEN):i.requestType===this.REQUEST_TYPE.LOGIN&&(r=i.parameters[t.CONSTANTS.ID_TOKEN],o=t.CONSTANTS.ID_TOKEN);var a=i.parameters[t.CONSTANTS.ERROR_DESCRIPTION],u=i.parameters[t.CONSTANTS.ERROR];try{s&&s(a,r,u,o)}catch(e){t.error("Error occurred in user defined callback function: "+e)}window.parent!==window||n||(t.config.navigateToLoginRequestUrl?window.location.href=t._getItem(t.CONSTANTS.STORAGE.LOGIN_REQUEST):window.location.hash="")}},r.prototype._getNavigateUrl=function(e,t){var n="common";this.config.tenant&&(n=this.config.tenant);var r=this.instance+n+"/oauth2/authorize"+this._serialize(e,this.config,t)+this._addLibMetadata();return this.info("Navigate url:"+r),r},r.prototype._extractIdToken=function(e){var t=this._decodeJwt(e);if(!t)return null;try{var n=t.JWSPayload,r=this._base64DecodeStringUrlSafe(n);return r?JSON.parse(r):(this.info("The returned id_token could not be base64 url safe decoded."),null)}catch(e){this.error("The returned id_token could not be decoded",e)}return null},r.prototype._base64DecodeStringUrlSafe=function(e){return e=e.replace(/-/g,"+").replace(/_/g,"/"),window.atob?decodeURIComponent(escape(window.atob(e))):decodeURIComponent(escape(this._decode(e)))},r.prototype._decode=function(e){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",n=(e=String(e).replace(/=+$/,"")).length;if(n%4==1)throw new Error("The token to be decoded is not correctly encoded.");for(var r,i,o,s,a,u,c,l,p="",d=0;d<n;d+=4){if(r=t.indexOf(e.charAt(d)),i=t.indexOf(e.charAt(d+1)),o=t.indexOf(e.charAt(d+2)),s=t.indexOf(e.charAt(d+3)),d+2===n-1){u=(a=r<<18|i<<12|o<<6)>>16&255,c=a>>8&255,p+=String.fromCharCode(u,c);break}if(d+1===n-1){u=(a=r<<18|i<<12)>>16&255,p+=String.fromCharCode(u);break}u=(a=r<<18|i<<12|o<<6|s)>>16&255,c=a>>8&255,l=255&a,p+=String.fromCharCode(u,c,l)}return p},r.prototype._decodeJwt=function(e){if(this._isEmpty(e))return null;var t=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(e);return!t||t.length<4?(this.warn("The returned id_token is not parseable."),null):{header:t[1],JWSPayload:t[2],JWSSig:t[3]}},r.prototype._convertUrlSafeToRegularBase64EncodedString=function(e){return e.replace("-","+").replace("_","/")},r.prototype._serialize=function(e,t,n){var r,i=[];return null!==t&&(i.push("?response_type="+e),i.push("client_id="+encodeURIComponent(t.clientId)),n&&i.push("resource="+encodeURIComponent(n)),i.push("redirect_uri="+encodeURIComponent(t.redirectUri)),i.push("state="+encodeURIComponent(t.state)),t.hasOwnProperty("slice")&&i.push("slice="+encodeURIComponent(t.slice)),t.hasOwnProperty("extraQueryParameter")&&i.push(t.extraQueryParameter),r=t.correlationId?t.correlationId:this._guid(),i.push("client-request-id="+encodeURIComponent(r))),i.join("&")},r.prototype._deserialize=function(e){for(var t=/\+/g,n=/([^&=]+)=([^&]*)/g,r=function(e){return decodeURIComponent(e.replace(t," "))},i={},o=n.exec(e);o;)i[r(o[1])]=r(o[2]),o=n.exec(e);return i},r.prototype._decimalToHex=function(e){for(var t=e.toString(16);t.length<2;)t="0"+t;return t},r.prototype._guid=function(){var e=window.crypto||window.msCrypto;if(e&&e.getRandomValues){var t=new Uint8Array(16);return e.getRandomValues(t),t[6]|=64,t[6]&=79,t[8]|=128,t[8]&=191,this._decimalToHex(t[0])+this._decimalToHex(t[1])+this._decimalToHex(t[2])+this._decimalToHex(t[3])+"-"+this._decimalToHex(t[4])+this._decimalToHex(t[5])+"-"+this._decimalToHex(t[6])+this._decimalToHex(t[7])+"-"+this._decimalToHex(t[8])+this._decimalToHex(t[9])+"-"+this._decimalToHex(t[10])+this._decimalToHex(t[11])+this._decimalToHex(t[12])+this._decimalToHex(t[13])+this._decimalToHex(t[14])+this._decimalToHex(t[15])}for(var n="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",r="0123456789abcdef",i=0,o="",s=0;s<36;s++)"-"!==n[s]&&"4"!==n[s]&&(i=16*Math.random()|0),"x"===n[s]?o+=r[i]:"y"===n[s]?(i&=3,o+=r[i|=8]):o+=n[s];return o},r.prototype._expiresIn=function(e){return e=e||3599,this._now()+parseInt(e,10)},r.prototype._now=function(){return Math.round((new Date).getTime()/1e3)},r.prototype._addAdalFrame=function(e){if(void 0!==e){this.info("Add adal frame to document:"+e);var t,n=document.getElementById(e);return n||(document.createElement&&document.documentElement&&(window.opera||-1===window.navigator.userAgent.indexOf("MSIE 5.0"))?((t=document.createElement("iframe")).setAttribute("id",e),t.setAttribute("aria-hidden","true"),t.style.visibility="hidden",t.style.position="absolute",t.style.width=t.style.height=t.borderWidth="0px",n=document.getElementsByTagName("body")[0].appendChild(t)):document.body&&document.body.insertAdjacentHTML&&document.body.insertAdjacentHTML("beforeEnd",'<iframe name="'+e+'" id="'+e+'" style="display:none"></iframe>'),window.frames&&window.frames[e]&&(n=window.frames[e])),n}},r.prototype._saveItem=function(e,t,n){var r;return this.config&&this.config.cacheLocation&&"localStorage"===this.config.cacheLocation?this._supportsLocalStorage()?(n?(r=this._getItem(e)||"",localStorage.setItem(e,r+t+this.CONSTANTS.CACHE_DELIMETER)):localStorage.setItem(e,t),!0):(this.info("Local storage is not supported"),!1):this._supportsSessionStorage()?(sessionStorage.setItem(e,t),!0):(this.info("Session storage is not supported"),!1)},r.prototype._getItem=function(e){return this.config&&this.config.cacheLocation&&"localStorage"===this.config.cacheLocation?this._supportsLocalStorage()?localStorage.getItem(e):(this.info("Local storage is not supported"),null):this._supportsSessionStorage()?sessionStorage.getItem(e):(this.info("Session storage is not supported"),null)},r.prototype._supportsLocalStorage=function(){try{return!!window.localStorage&&(window.localStorage.setItem("storageTest","A"),"A"==window.localStorage.getItem("storageTest")&&(window.localStorage.removeItem("storageTest"),!window.localStorage.getItem("storageTest")))}catch(e){return!1}},r.prototype._supportsSessionStorage=function(){try{return!!window.sessionStorage&&(window.sessionStorage.setItem("storageTest","A"),"A"==window.sessionStorage.getItem("storageTest")&&(window.sessionStorage.removeItem("storageTest"),!window.sessionStorage.getItem("storageTest")))}catch(e){return!1}},r.prototype._cloneConfig=function(e){if(null===e||"object"!=typeof e)return e;var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t},r.prototype._addLibMetadata=function(){return"&x-client-SKU=Js&x-client-Ver="+this._libVersion()},r.prototype.log=function(e,t,n,r){if(e<=Logging.level){if(!Logging.piiLoggingEnabled&&r)return;var i=(new Date).toUTCString(),o="",o=this.config.correlationId?i+":"+this.config.correlationId+"-"+this._libVersion()+"-"+this.CONSTANTS.LEVEL_STRING_MAP[e]+" "+t:i+":"+this._libVersion()+"-"+this.CONSTANTS.LEVEL_STRING_MAP[e]+" "+t;n&&(o+="\nstack:\n"+n.stack),Logging.log(o)}},r.prototype.error=function(e,t){this.log(this.CONSTANTS.LOGGING_LEVEL.ERROR,e,t)},r.prototype.warn=function(e){this.log(this.CONSTANTS.LOGGING_LEVEL.WARN,e,null)},r.prototype.info=function(e){this.log(this.CONSTANTS.LOGGING_LEVEL.INFO,e,null)},r.prototype.verbose=function(e){this.log(this.CONSTANTS.LOGGING_LEVEL.VERBOSE,e,null)},r.prototype.errorPii=function(e,t){this.log(this.CONSTANTS.LOGGING_LEVEL.ERROR,e,t,!0)},r.prototype.warnPii=function(e){this.log(this.CONSTANTS.LOGGING_LEVEL.WARN,e,null,!0)},r.prototype.infoPii=function(e){this.log(this.CONSTANTS.LOGGING_LEVEL.INFO,e,null,!0)},r.prototype.verbosePii=function(e){this.log(this.CONSTANTS.LOGGING_LEVEL.VERBOSE,e,null,!0)},r.prototype._libVersion=function(){return"1.0.17"},e.exports&&(e.exports=r,e.exports.inject=function(e){return new r(e)}),r}()},function(e,t){var n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";n.r(t);var r={};n.r(r),n.d(r,"App",function(){return Li}),n.d(r,"AppCatalog",function(){return xi}),n.d(r,"Attachment",function(){return Wi}),n.d(r,"Attachments",function(){return qi}),n.d(r,"ClientsidePageFromFile",function(){return yo}),n.d(r,"CreateClientsidePage",function(){return go}),n.d(r,"CanvasColumn",function(){return mo}),n.d(r,"CanvasSection",function(){return vo}),n.d(r,"ClientsideText",function(){return So}),n.d(r,"ClientsideWebpart",function(){return To}),n.d(r,"ColumnControl",function(){return bo}),n.d(r,"PromotedState",function(){return zi}),n.d(r,"Comment",function(){return no}),n.d(r,"Comments",function(){return eo}),n.d(r,"Replies",function(){return io}),n.d(r,"ContentType",function(){return Wo}),n.d(r,"ContentTypes",function(){return qo}),n.d(r,"FieldLink",function(){return Qo}),n.d(r,"FieldLinks",function(){return Ho}),n.d(r,"Feature",function(){return rs}),n.d(r,"Features",function(){return ts}),n.d(r,"Fields",function(){return _s}),n.d(r,"Field",function(){return Cs}),n.d(r,"AddFieldOptions",function(){return cs}),n.d(r,"CalendarType",function(){return ls}),n.d(r,"ChoiceFieldFormatType",function(){return hs}),n.d(r,"DateTimeFieldFormatType",function(){return as}),n.d(r,"DateTimeFieldFriendlyFormatType",function(){return us}),n.d(r,"FieldTypes",function(){return ss}),n.d(r,"FieldUserSelectionMode",function(){return ds}),n.d(r,"UrlFieldFormatType",function(){return ps}),n.d(r,"File",function(){return hi}),n.d(r,"Files",function(){return pi}),n.d(r,"CheckinType",function(){return Fr}),n.d(r,"MoveOperations",function(){return Br}),n.d(r,"TemplateFileType",function(){return jr}),n.d(r,"Version",function(){return vi}),n.d(r,"Versions",function(){return yi}),n.d(r,"Folder",function(){return xo}),n.d(r,"Folders",function(){return Ao}),n.d(r,"Form",function(){return Ls}),n.d(r,"Forms",function(){return xs}),n.d(r,"HubSite",function(){return Ws}),n.d(r,"HubSites",function(){return qs}),n.d(r,"Item",function(){return Wn}),n.d(r,"Items",function(){return qn}),n.d(r,"ItemVersion",function(){return Qn}),n.d(r,"ItemVersions",function(){return Hn}),n.d(r,"PagedItemCollection",function(){return zn}),n.d(r,"List",function(){return An}),n.d(r,"Lists",function(){return Rn}),n.d(r,"ControlMode",function(){return Pn}),n.d(r,"RenderListDataOptions",function(){return wn}),n.d(r,"Navigation",function(){return ta}),n.d(r,"NavigationNode",function(){return Zs}),n.d(r,"NavigationNodes",function(){return $s}),n.d(r,"NavigationService",function(){return ra}),n.d(r,"spODataEntity",function(){return en}),n.d(r,"spODataEntityArray",function(){return tn}),n.d(r,"Profiles",function(){return fa}),n.d(r,"UrlZone",function(){return ua}),n.d(r,"RegionalSettings",function(){return Oa}),n.d(r,"TimeZone",function(){return Ea}),n.d(r,"TimeZones",function(){return Na}),n.d(r,"RelatedItemManager",function(){return Xa}),n.d(r,"SortDirection",function(){return tu}),n.d(r,"ReorderingRuleMatchType",function(){return nu}),n.d(r,"QueryPropertyValueType",function(){return ru}),n.d(r,"SearchBuiltInSourceId",function(){return mu}),n.d(r,"SearchQueryBuilder",function(){return eu}),n.d(r,"SearchResults",function(){return du}),n.d(r,"Search",function(){return pu}),n.d(r,"Suggest",function(){return fu}),n.d(r,"RoleAssignment",function(){return Zu}),n.d(r,"RoleAssignments",function(){return $u}),n.d(r,"RoleDefinition",function(){return rc}),n.d(r,"RoleDefinitions",function(){return tc}),n.d(r,"PermissionKind",function(){return Su}),n.d(r,"SPSharedObjectType",function(){return wu}),n.d(r,"SharingDomainRestrictionMode",function(){return Pu}),n.d(r,"SharingLinkKind",function(){return _u}),n.d(r,"SharingOperationStatusCode",function(){return Iu}),n.d(r,"SharingRole",function(){return Tu}),n.d(r,"RoleType",function(){return Ou}),n.d(r,"SiteDesigns",function(){return Ac}),n.d(r,"SiteGroup",function(){return Xu}),n.d(r,"SiteGroups",function(){return Qu}),n.d(r,"SiteScripts",function(){return Bc}),n.d(r,"SiteUser",function(){return Hu}),n.d(r,"SiteUsers",function(){return Wu}),n.d(r,"Site",function(){return pn}),n.d(r,"MySocial",function(){return tl}),n.d(r,"Social",function(){return Yc}),n.d(r,"SocialActorType",function(){return qc}),n.d(r,"SocialActorTypes",function(){return Gc}),n.d(r,"SocialFollowResult",function(){return Wc}),n.d(r,"SocialStatusCode",function(){return Vc}),n.d(r,"Utilities",function(){return al}),n.d(r,"Subscription",function(){return yl}),n.d(r,"Subscriptions",function(){return hl}),n.d(r,"UserCustomAction",function(){return Va}),n.d(r,"UserCustomActions",function(){return Ga}),n.d(r,"UserCustomActionRegistrationType",function(){return La}),n.d(r,"UserCustomActionScope",function(){return ka}),n.d(r,"View",function(){return Ol}),n.d(r,"ViewFields",function(){return El}),n.d(r,"Views",function(){return Il}),n.d(r,"ViewScope",function(){return ml}),n.d(r,"WebPartsPersonalizationScope",function(){return Ul}),n.d(r,"WebPartDefinitions",function(){return ql}),n.d(r,"WebPartDefinition",function(){return Wl}),n.d(r,"LimitedWebPartManager",function(){return Bl}),n.d(r,"Web",function(){return mn}),n.d(r,"Webs",function(){return gn}),n.d(r,"SharePointQueryableInstance",function(){return Mt}),n.d(r,"SharePointQueryableCollection",function(){return Bt}),n.d(r,"SharePointQueryable",function(){return kt}),n.d(r,"spInvokableFactory",function(){return Dt}),n.d(r,"SPBatch",function(){return rn}),n.d(r,"defaultPath",function(){return Kt}),n.d(r,"spGet",function(){return Et}),n.d(r,"spPost",function(){return Rt}),n.d(r,"spDelete",function(){return Nt}),n.d(r,"spPatch",function(){return At}),n.d(r,"spPostDelete",function(){return Ut}),n.d(r,"spPostDeleteETag",function(){return xt}),n.d(r,"SPHttpClient",function(){return bt}),n.d(r,"SPRest",function(){return on}),n.d(r,"sp",function(){return Ql}),n.d(r,"PrincipalType",function(){return ir}),n.d(r,"PrincipalSource",function(){return or}),n.d(r,"PageType",function(){return sr}),n.d(r,"toAbsoluteUrl",function(){return wt}),n.d(r,"extractWebUrl",function(){return vt}),n.d(r,"objectToSPKeyValueCollection",function(){return hr}),n.d(r,"stripInvalidFileFolderChars",function(){return vr}),n.d(r,"containsInvalidFileFolderChars",function(){return gr});var i={};n.r(i),n.d(i,"Attachment",function(){return _p}),n.d(i,"Attachments",function(){return Op}),n.d(i,"Calendar",function(){return Jp}),n.d(i,"Calendars",function(){return Xp}),n.d(i,"Event",function(){return $p}),n.d(i,"Events",function(){return Yp}),n.d(i,"Contact",function(){return gd}),n.d(i,"ContactFolder",function(){return md}),n.d(i,"ContactFolders",function(){return bd}),n.d(i,"Contacts",function(){return vd}),n.d(i,"Conversation",function(){return up}),n.d(i,"Conversations",function(){return cp}),n.d(i,"Post",function(){return hp}),n.d(i,"Posts",function(){return fp}),n.d(i,"Senders",function(){return yp}),n.d(i,"Thread",function(){return lp}),n.d(i,"Threads",function(){return pp}),n.d(i,"DirectoryObjectTypes",function(){return Rp}),n.d(i,"DirectoryObject",function(){return kp}),n.d(i,"DirectoryObjects",function(){return Fp}),n.d(i,"Group",function(){return Qp}),n.d(i,"GroupType",function(){return Np}),n.d(i,"Groups",function(){return zp}),n.d(i,"Insights",function(){return Ld}),n.d(i,"SharedInsight",function(){return Md}),n.d(i,"SharedInsights",function(){return qd}),n.d(i,"TrendingInsight",function(){return kd}),n.d(i,"TrendingInsights",function(){return Fd}),n.d(i,"UsedInsight",function(){return Bd}),n.d(i,"UsedInsights",function(){return jd}),n.d(i,"Resource",function(){return Gd}),n.d(i,"Invitations",function(){return Yd}),n.d(i,"Member",function(){return nh}),n.d(i,"Members",function(){return rh}),n.d(i,"MailFolder",function(){return hh}),n.d(i,"MailFolders",function(){return fh}),n.d(i,"MailboxSettings",function(){return yh}),n.d(i,"Message",function(){return ph}),n.d(i,"Messages",function(){return dh}),n.d(i,"Drive",function(){return Oh}),n.d(i,"DriveItem",function(){return Rh}),n.d(i,"DriveItems",function(){return Nh}),n.d(i,"Drives",function(){return Ch}),n.d(i,"Root",function(){return Eh}),n.d(i,"Notebook",function(){return Gh}),n.d(i,"Notebooks",function(){return Wh}),n.d(i,"OneNote",function(){return qh}),n.d(i,"Section",function(){return Vh}),n.d(i,"Sections",function(){return Hh}),n.d(i,"Photo",function(){return Yh}),n.d(i,"Bucket",function(){return hf}),n.d(i,"Buckets",function(){return ff}),n.d(i,"Plan",function(){return cf}),n.d(i,"Planner",function(){return uf}),n.d(i,"Plans",function(){return lf}),n.d(i,"Task",function(){return pf}),n.d(i,"Tasks",function(){return df}),n.d(i,"Subscription",function(){return If}),n.d(i,"Subscriptions",function(){return _f}),n.d(i,"Channel",function(){return kf}),n.d(i,"Channels",function(){return Ff}),n.d(i,"Tab",function(){return Bf}),n.d(i,"Tabs",function(){return jf}),n.d(i,"Team",function(){return Df}),n.d(i,"Teams",function(){return Lf}),n.d(i,"User",function(){return hd}),n.d(i,"Users",function(){return fd}),n.d(i,"People",function(){return yd}),n.d(i,"graph",function(){return ci}),n.d(i,"GraphRest",function(){return ui});var o,s,y=(Object.defineProperty(c,"activeLogLevel",{get:function(){return c.instance.activeLogLevel},set:function(e){c.instance.activeLogLevel=e},enumerable:!0,configurable:!0}),Object.defineProperty(c,"instance",{get:function(){return null!=c._instance||(c._instance=new a),c._instance},enumerable:!0,configurable:!0}),c.subscribe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];e.forEach(function(e){return c.instance.subscribe(e)})},c.clearSubscribers=function(){return c.instance.clearSubscribers()},Object.defineProperty(c,"count",{get:function(){return c.instance.count},enumerable:!0,configurable:!0}),c.write=function(e,t){void 0===t&&(t=1),c.instance.log({level:t,message:e})},c.writeJSON=function(e,t){void 0===t&&(t=1),this.write(JSON.stringify(e),t)},c.log=function(e){c.instance.log(e)},c.error=function(e){c.instance.log({data:e,level:3,message:e.message})},c),a=(u.prototype.subscribe=function(e){this.subscribers.push(e)},u.prototype.clearSubscribers=function(){var e=this.subscribers.slice(0);return this.subscribers.length=0,e},Object.defineProperty(u.prototype,"count",{get:function(){return this.subscribers.length},enumerable:!0,configurable:!0}),u.prototype.write=function(e,t){void 0===t&&(t=1),this.log({level:t,message:e})},u.prototype.log=function(t){void 0!==t&&this.activeLogLevel<=t.level&&this.subscribers.map(function(e){return e.log(t)})},u);function u(e,t){void 0===e&&(e=2),void 0===t&&(t=[]),this.activeLogLevel=e,this.subscribers=t}function c(){}(s=o=o||{})[s.Verbose=0]="Verbose",s[s.Info=1]="Info",s[s.Warning=2]="Warning",s[s.Error=3]="Error",s[s.Off=99]="Off";var l=(h.prototype.log=function(e){var t=this.format(e);switch(e.level){case 0:case 1:console.log(t);break;case 2:console.warn(t);break;case 3:console.error(t)}},h.prototype.format=function(e){var t=[];if(t.push("Message: "+e.message),void 0!==e.data)try{t.push(" Data: "+JSON.stringify(e.data))}catch(e){t.push(" Data: Error in stringify of supplied data "+e)}return t.join("")},h),p=(d.prototype.log=function(e){this.method(e)},d);function d(e){this.method=e}function h(){}function f(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return function(){t.apply(e,n)}}function g(e,t,n){var r=new Date(e.toString());switch(t.toLowerCase()){case"year":r.setFullYear(r.getFullYear()+n);break;case"quarter":r.setMonth(r.getMonth()+3*n);break;case"month":r.setMonth(r.getMonth()+n);break;case"week":r.setDate(r.getDate()+7*n);break;case"day":r.setDate(r.getDate()+n);break;case"hour":r.setTime(r.getTime()+36e5*n);break;case"minute":r.setTime(r.getTime()+6e4*n);break;case"second":r.setTime(r.getTime()+1e3*n);break;default:r=void 0}return r}function v(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.filter(function(e){return!_(e)}).map(function(e){return e.replace(/^[\\|\/]/,"").replace(/[\\|\/]$/,"")}).join("/").replace(/\\/g,"/")}function m(e){for(var t=new Array(e),n=0;n<e;n++)t[n]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(Math.floor(62*Math.random()));return t.join("")}function b(){var n=Date.now();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=(n+16*Math.random())%16|0;return n=Math.floor(n/16),("x"===e?t:3&t|8).toString(16)})}function S(e){return"function"==typeof e}function T(e){return null!=e}function w(e){return Array.isArray?Array.isArray(e):e&&"number"==typeof e.length&&e.constructor===Array}function P(t,n,e,r){if(void 0===e&&(e=!1),void 0===r&&(r=function(){return!0}),!T(n))return t;var i=e?function(e,t){return!(t in e)}:function(){return!0};return Object.getOwnPropertyNames(n).filter(function(e){return i(t,e)&&r(e)}).reduce(function(e,t){return e[t]=n[t],e},t)}function I(e){return/^https?:\/\/|^\/\//i.test(e)}function _(e){return null==e||e.length<1}function O(e){if(_(e))return e;var t=/([0-9A-F]{8}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{12})/i.exec(e);return null===t?e:t[1]}function C(e){return JSON.stringify(e)}function E(e,t){return Object.hasOwnProperty.call(e,t)}function R(e){var t=0;if(0===e.length)return t;for(var n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n),t|=0;return t}var N=S(Object.entries)?Object.entries:function(t){return Object.keys(t).map(function(e){return[e,t[e]]})};function A(e){return null!=e?new Map(N(e)):new Map}function U(n){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];for(var r=0;r<e.length;r++)e[r].forEach(function(e,t){n.set(t,e)});return n}var x=["defaultCachingStore","defaultCachingTimeoutSeconds","globalCacheDisable","enableCacheExpiration","cacheExpirationIntervalMilliseconds","spfxContext","ie11"],D=(F.prototype.assign=function(e){this._v=U(this._v,A(e))},F.prototype.get=function(e){return this._v.get(e)},Object.defineProperty(F.prototype,"defaultCachingStore",{get:function(){return this.get(x[0])},enumerable:!0,configurable:!0}),Object.defineProperty(F.prototype,"defaultCachingTimeoutSeconds",{get:function(){return this.get(x[1])},enumerable:!0,configurable:!0}),Object.defineProperty(F.prototype,"globalCacheDisable",{get:function(){return this.get(x[2])},enumerable:!0,configurable:!0}),Object.defineProperty(F.prototype,"enableCacheExpiration",{get:function(){return this.get(x[3])},enumerable:!0,configurable:!0}),Object.defineProperty(F.prototype,"cacheExpirationIntervalMilliseconds",{get:function(){return this.get(x[4])},enumerable:!0,configurable:!0}),Object.defineProperty(F.prototype,"spfxContext",{get:function(){return this.get(x[5])},enumerable:!0,configurable:!0}),Object.defineProperty(F.prototype,"ie11",{get:function(){return this.get(x[6])},enumerable:!0,configurable:!0}),F),L=new D,k=function(e,t){return(k=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function F(e){void 0===e&&(e=new Map),this._v=e,this._v.set(x[0],"session"),this._v.set(x[1],60),this._v.set(x[2],!1),this._v.set(x[3],!1),this._v.set(x[4],750),this._v.set(x[5],null),this._v.set(x[6],!1)}function B(e,t){function n(){this.constructor=e}k(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function j(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;0<=a;a--)(i=e[a])&&(s=(o<3?i(s):3<o?i(t,n,s):i(t,n))||s);return 3<o&&s&&Object.defineProperty(t,n,s),s}function M(o,s,a,u){return new(a=a||Promise)(function(e,t){function n(e){try{i(u.next(e))}catch(e){t(e)}}function r(e){try{i(u.throw(e))}catch(e){t(e)}}function i(t){t.done?e(t.value):new a(function(e){e(t.value)}).then(n,r)}i((u=u.apply(o,s||[])).next())})}function q(n,r){var i,o,s,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},e={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(i)throw new TypeError("Generator is already executing.");for(;a;)try{if(i=1,o&&(s=2&t[0]?o.return:t[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,t[1])).done)return s;switch(o=0,s&&(t=[2&t[0],s.value]),t[0]){case 0:case 1:s=t;break;case 4:return a.label++,{value:t[1],done:!1};case 5:a.label++,o=t[1],t=[0];continue;case 7:t=a.ops.pop(),a.trys.pop();continue;default:if(!(s=0<(s=a.trys).length&&s[s.length-1])&&(6===t[0]||2===t[0])){a=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3])){a.label=t[1];break}if(6===t[0]&&a.label<s[1]){a.label=s[1],s=t;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(t);break}s[2]&&a.ops.pop(),a.trys.pop();continue}t=r.call(n,a)}catch(e){t=[6,e],o=0}finally{i=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}}function G(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||0<t--)&&!(r=o.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s}function W(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(G(arguments[t]));return e}var V=n(0);function H(n,e){T(e)&&new Request("",{headers:e}).headers.forEach(function(e,t){n.append(t,e)})}function K(e,t){var n;T(t)&&(n=P(e.headers||{},t.headers),(e=P(e,t)).headers=n)}function Q(e){var t=new URL(e);return t.protocol+"//"+t.hostname}var z,X,J=(ve.prototype.fetch=function(e,t){return V.a.fetch(e,t)},ve),$=(B(ge,X=J),Object.defineProperty(ge.prototype,"token",{get:function(){return this._token||""},set:function(e){this._token=e},enumerable:!0,configurable:!0}),ge.prototype.fetch=function(e,t){void 0===t&&(t={});var n=new Headers;return H(n,t.headers),n.set("Authorization","Bearer "+this._token),t.headers=n,X.prototype.fetch.call(this,e,t)},ge),Y=(B(ye,z=$),ye.prototype.fetch=function(n,r){return M(this,void 0,void 0,function(){var t;return q(this,function(e){switch(e.label){case 0:return[4,this.getToken(Q(n))];case 1:return t=e.sent(),this.token=t,[2,z.prototype.fetch.call(this,n,r)]}})})},ye.prototype.getToken=function(t){return M(this,void 0,void 0,function(){return q(this,function(e){switch(e.label){case 0:return[4,this.context.aadTokenProviderFactory.getTokenProvider()];case 1:return[2,e.sent().getToken(t)]}})})},ye),Z=(fe.bind=function(e){return new fe(void 0===e?new ee:e)},fe.prototype.get=function(e){if(!this.enabled)return null;var t=this.store.getItem(e);if(!T(t))return null;var n=JSON.parse(t);return new Date(n.expiration)<=new Date?(this.delete(e),null):n.value},fe.prototype.put=function(e,t,n){this.enabled&&this.store.setItem(e,this.createPersistable(t,n))},fe.prototype.delete=function(e){this.enabled&&this.store.removeItem(e)},fe.prototype.getOrPut=function(n,r,i){return M(this,void 0,void 0,function(){var t;return q(this,function(e){switch(e.label){case 0:return this.enabled?null!==(t=this.get(n))?[3,2]:[4,r()]:[2,r()];case 1:t=e.sent(),this.put(n,t,i),e.label=2;case 2:return[2,t]}})})},fe.prototype.deleteExpired=function(){return M(this,void 0,void 0,function(){var t,n;return q(this,function(e){switch(e.label){case 0:if(!this.enabled)return[2];t=0,e.label=1;case 1:return t<this.store.length?null!==(n=this.store.key(t))&&/["|']?pnp["|']? ?: ?1/i.test(this.store.getItem(n))?[4,this.get(n)]:[3,3]:[3,4];case 2:e.sent(),e.label=3;case 3:return t++,[3,1];case 4:return[2]}})})},fe.prototype.test=function(){try{return this.store.setItem("t","t"),this.store.removeItem("t"),!0}catch(e){return!1}},fe.prototype.createPersistable=function(e,t){var n;return void 0===t&&(n=L.defaultCachingTimeoutSeconds,0<this.defaultTimeoutMinutes&&(n=60*this.defaultTimeoutMinutes),t=g(new Date,"second",n)),C({pnp:1,expiration:t,value:e})},fe.prototype.cacheExpirationHandler=function(){var t=this;this.enabled&&this.deleteExpired().then(function(e){setTimeout(f(t,t.cacheExpirationHandler),L.cacheExpirationIntervalMilliseconds)}).catch(console.error)},fe),ee=(Object.defineProperty(he.prototype,"length",{get:function(){return this._store.size},enumerable:!0,configurable:!0}),he.prototype.clear=function(){this._store.clear()},he.prototype.getItem=function(e){return this._store.get(e)},he.prototype.key=function(e){return Array.from(this._store)[e][0]},he.prototype.removeItem=function(e){this._store.delete(e)},he.prototype.setItem=function(e,t){this._store.set(e,t)},he),te=(Object.defineProperty(de.prototype,"local",{get:function(){return null===this._local&&(this._local=new Z("undefined"==typeof localStorage?new ee:localStorage)),this._local},enumerable:!0,configurable:!0}),Object.defineProperty(de.prototype,"session",{get:function(){return null===this._session&&(this._session=new Z("undefined"==typeof sessionStorage?new ee:sessionStorage)),this._session},enumerable:!0,configurable:!0}),de),ne=(pe.prototype.add=function(e,t){this._settings.set(e,t)},pe.prototype.addJSON=function(e,t){this._settings.set(e,C(t))},pe.prototype.apply=function(n){var r=this;return new Promise(function(e,t){try{r._settings=U(r._settings,A(n)),e()}catch(e){t(e)}})},pe.prototype.load=function(n){var r=this;return new Promise(function(t,e){n.getConfiguration().then(function(e){r._settings=U(r._settings,A(e)),t()}).catch(e)})},pe.prototype.get=function(e){return this._settings.get(e)||null},pe.prototype.getJSON=function(e){var t=this.get(e);return null==t?t:JSON.parse(t)},pe),re=(le.prototype.getWrappedProvider=function(){return this.wrappedProvider},le.prototype.getConfiguration=function(){var t=this;return this.store&&this.store.enabled?this.store.getOrPut(this.cacheKey,function(){return t.wrappedProvider.getConfiguration().then(function(e){return t.store.put(t.cacheKey,e),e})}):this.wrappedProvider.getConfiguration()},le.prototype.selectPnPCache=function(){var e=new te;if(e.local&&e.local.enabled)return e.local;if(e.session&&e.session.enabled)return e.session;throw Error("Cannot create a caching configuration provider since cache is not available.")},le),ie=(Object.defineProperty(ce.prototype,"batchId",{get:function(){return this._batchId},enumerable:!0,configurable:!0}),Object.defineProperty(ce.prototype,"requests",{get:function(){return this._reqs.sort(function(e,t){return e.index-t.index})},enumerable:!0,configurable:!0}),ce.prototype.track=function(e){e.data.batch=this,(void 0===e.data.batchIndex||e.data.batchIndex<0)&&(e.data.batchIndex=++this._index)},ce.prototype.add=function(e){var n={id:e.requestId,index:e.batchIndex,method:e.method.toUpperCase(),options:e.options,parser:e.parser,reject:null,resolve:null,url:e.url},t=new Promise(function(e,t){n.resolve=e,n.reject=t});return this._reqs.push(n),t},ce.prototype.addDependency=function(){var t=function(){};return this._deps.push(new Promise(function(e){t=e})),t},ce.prototype.addResolveBatchDependency=function(e){this._rDeps.push(e)},ce.prototype.execute=function(){var e=this;return Promise.all(this._deps).then(function(){return Promise.all(e._deps)}).then(function(){return e.executeImpl()}).then(function(){return Promise.all(e._rDeps)}).then(function(){})},ce),oe=(Object.defineProperty(ue.prototype,"store",{get:function(){return"local"===this.storeName?ue.storage.local:ue.storage.session},enumerable:!0,configurable:!0}),ue.storage=new te,ue),se=(ae.prototype.parse=function(e){var t=this;return this.parser.parse(e).then(function(e){return t.cacheData(e)})},ae.prototype.cacheData=function(e){return null!==this.cacheOptions.store&&this.cacheOptions.store.put(this.cacheOptions.key,e,this.cacheOptions.expiration),e},ae);function ae(e,t){this.parser=e,this.cacheOptions=t}function ue(e,t,n){void 0===t&&(t=L.defaultCachingStore),void 0===n&&(n=g(new Date,"second",L.defaultCachingTimeoutSeconds)),this.key=e,this.storeName=t,this.expiration=n}function ce(e){void 0===e&&(e=b()),this._batchId=e,this._reqs=[],this._deps=[],this._rDeps=[],this._index=-1}function le(e,t,n){this.wrappedProvider=e,this.cacheKey=t,this.wrappedProvider=e,this.store=n||this.selectPnPCache()}function pe(e){void 0===e&&(e=new Map),this._settings=e}function de(e,t){void 0===e&&(e=null),void 0===t&&(t=null),this._local=e,this._session=t}function he(e){void 0===e&&(e=new Map),this._store=e}function fe(e,t){void 0===t&&(t=-1),this.store=e,this.defaultTimeoutMinutes=t,this.enabled=this.test(),L.enableCacheExpiration&&this.cacheExpirationHandler()}function ye(e){var t=z.call(this,null)||this;return t.context=e,t}function ge(e){var t=X.call(this)||this;return t._token=e,t}function ve(){}function me(e,t,n,r){Reflect.defineProperty(e.prototype,t,{configurable:!0,enumerable:!0,get:function(){return n(this,r)}})}function be(e){we=!0,_e(Pe,e)}function Se(e,t){return we=!0,Reflect.has(e,Ie)||Reflect.set(e,Ie,[]),_e(Reflect.get(e,Ie),t),e}function Te(e,t){we=!0,void 0===e.__proto__[Ie]&&(e.__proto__[Ie]=[]),_e(e.__proto__[Ie],t)}var we=!1,Pe=[],Ie=Symbol("__extensions");function _e(e,t){w(t)?e.push.apply(e,W(t)):e.push(t)}function Oe(){Pe.length=0}function Ce(){we=!1}function Ee(){we=!0}function Re(e,t,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];if(we){var o=[];Reflect.has(n,Ie)&&o.push.apply(o,W(Reflect.get(n,Ie))),o.push.apply(o,W(Pe));for(var s=0;s<o.length;s++){var a=o[s],u=void 0;if(S(a)?u=a.apply(void 0,W([e,n],r)):"get"===e&&Reflect.has(a,r[0])?u=Reflect.get(a,r[0],n):Reflect.has(a,e)&&(u=Reflect.get(a,e).apply(void 0,W([n],r))),void 0!==u)return u}}return t.apply(void 0,W([n],r))}var Ne,Ae,Ue,xe,De,Le,ke,Fe=(Ne=function(e){return this.defaultAction(e)},function(o){return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];function n(e){var n=Object.assign(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Ne.apply(n,e)},new(o.bind.apply(o,W([void 0],e))));return Reflect.setPrototypeOf(n,o.prototype),n}var r,i;return L.ie11?n(e):new Proxy((i=(r=n)(e),r.__proto__[Ie]&&(i=Se(i,r.__proto__[Ie])),i),{apply:function(e,t,n){return Re("apply",function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Reflect.apply(e[0],e[1],e[2])},e,t,n)},get:function(e,t,n){return Re("get",function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Reflect.get(e[0],e[1],e[2])},e,t,n)},has:function(e,t){return Re("has",function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Reflect.has(e[0],e[1])},e,t)},set:function(e,t,n,r){return Re("set",function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Reflect.set(e[0],e[1],e[2],e[3])},e,t,n,r)}})}}),Be=($e.prototype.parse=function(n){var r=this;return new Promise(function(e,t){r.handleError(n,t)&&r.parseImpl(n,e,t)})},$e.prototype.parseImpl=function(e,t,n){var r=this;e.headers.has("Content-Length")&&0===parseFloat(e.headers.get("Content-Length"))||204===e.status?t({}):e.text().then(function(e){return 0<e.replace(/\s/gi,"").length?JSON.parse(e):{}}).then(function(e){return t(r.parseODataJSON(e))}).catch(function(e){return n(e)})},$e.prototype.handleError=function(e,t){return e.ok||Ve.init(e).then(t),e.ok},$e.prototype.parseODataJSON=function(e){var t=e;return E(e,"d")?t=E(e.d,"results")?e.d.results:e.d:E(e,"value")&&(t=e.value),t},$e),je=(B(Je,ke=Be),Je.prototype.parseImpl=function(e,t){e.text().then(t)},Je),Me=(B(Xe,Le=Be),Xe.prototype.parseImpl=function(e,t){e.blob().then(t)},Xe),qe=(B(ze,De=Be),ze.prototype.parseImpl=function(e,t){e.json().then(t)},ze),Ge=(B(Qe,xe=Be),Qe.prototype.parseImpl=function(e,t){S(e.arrayBuffer)?e.arrayBuffer().then(t):e.buffer().then(t)},Qe),We=(B(Ke,Ue=Be),Ke.prototype.parseImpl=function(e,t){this.parser(e).then(t)},Ke),Ve=(B(He,Ae=Error),He.init=function(n){return M(this,void 0,void 0,function(){var t;return q(this,function(e){switch(e.label){case 0:return[4,n.clone().text()];case 1:return t=e.sent(),[2,new He("Error making HttpClient request in queryable ["+n.status+"] "+n.statusText+" ::> "+t,n.clone())]}})})},He);function He(e,t,n,r){void 0===n&&(n=t.status),void 0===r&&(r=t.statusText);var i=Ae.call(this,e)||this;return i.response=t,i.status=n,i.statusText=r,i.isHttpRequestError=!0,i}function Ke(e){var t=Ue.call(this)||this;return t.parser=e,t}function Qe(){return null!==xe&&xe.apply(this,arguments)||this}function ze(){return null!==De&&De.apply(this,arguments)||this}function Xe(){return null!==Le&&Le.apply(this,arguments)||this}function Je(){return null!==ke&&ke.apply(this,arguments)||this}function $e(){}function Ye(n){var e=JSON.stringify(n,function(e,t){switch(e){case"query":return JSON.stringify(W(t));case"batch":case"batchDependency":case"cachingOptions":case"clientFactory":case"parser":return"-";default:return t}},0),t=JSON.parse(e,function(e,t){switch(e){case"query":return new Map(JSON.parse(t));case"batch":return n.batch;case"batchDependency":return n.batchDependency;case"cachingOptions":return n.cachingOptions;case"clientFactory":return n.clientFactory;case"parser":return n.parser;default:return t}});return n.options&&n.options.body&&(t.options.body=n.options.body),t}var Ze=(Object.defineProperty(et.prototype,"data",{get:function(){return this._data},set:function(e){this._data=Object.assign({},Ye(this.data),Ye(e))},enumerable:!0,configurable:!0}),et.prototype.toUrl=function(){return this.data.url},et.prototype.concat=function(e){return this.data.url+=e,this},Object.defineProperty(et.prototype,"query",{get:function(){return this.data.query},enumerable:!0,configurable:!0}),et.prototype.configure=function(e){return K(this.data.options,e),this},et.prototype.configureFrom=function(e){return K(this.data.options,e.data.options),this},et.prototype.usingCaching=function(e){return L.globalCacheDisable||(this.data.useCaching=!0,void 0!==e&&(this.data.cachingOptions=e)),this},et.prototype.usingParser=function(e){return this.data.parser=e,this},et.prototype.withPipeline=function(e){return this.data.pipes=e.slice(0),this},et.prototype.append=function(e){this.data.url=v(this.data.url,e)},et.prototype.inBatch=function(e){if(this.hasBatch)throw Error("This query is already part of a batch.");return T(e)&&e.track(this),this},et.prototype.addBatchDependency=function(){return T(this.data.batch)?this.data.batch.addDependency():function(){return null}},Object.defineProperty(et.prototype,"hasBatch",{get:function(){return T(this.data.batch)},enumerable:!0,configurable:!0}),Object.defineProperty(et.prototype,"batch",{get:function(){return this.hasBatch?this.data.batch:null},enumerable:!0,configurable:!0}),Object.defineProperty(et.prototype,"parentUrl",{get:function(){return this.data.parentUrl},enumerable:!0,configurable:!0}),et.prototype.cloneTo=function(e,t){return void 0===t&&(t={includeBatch:!0}),e.data=Object.assign({},Ye(this.data),{batch:null,cloneParentCacheOptions:null,cloneParentWasCaching:!1},Ye(e.data)),e.configureFrom(this),t.includeBatch&&e.inBatch(this.batch),this.data.useCaching&&(e.data.cloneParentWasCaching=!0,e.data.cloneParentCacheOptions=this.data.cachingOptions),e},et);function et(e){void 0===e&&(e={}),this._data=Object.assign({},{cloneParentWasCaching:!1,options:{},parentUrl:"",parser:new Be,query:new Map,url:"",useCaching:!1},Ye(e))}function tt(t,n){return new Promise(function(e){t.result=n,t.hasResult=!0,e(t)})}function nt(e){return 0<e.pipes.length?e.pipes.shift()(e):Promise.resolve(e)}function rt(e){if(e.pipes.length<1)throw y.write("["+e.requestId+"] ("+(new Date).getTime()+") Request pipeline contains no methods!",3),Error("Request pipeline contains no methods!");var t=nt(e).then(function(e){return t=e,y.log({data:0===y.activeLogLevel?t.result:{},level:1,message:"["+t.requestId+"] ("+(new Date).getTime()+") Returning result from pipeline. Set logging to verbose to see data."}),Promise.resolve(t.result);var t}).catch(function(e){throw y.error(e),e});return e.isBatched&&e.batch.addResolveBatchDependency(t),t}function it(o){return void 0===o&&(o=!1),function(n,r,e){var i=e.value;e.value=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return!o&&0<e.length&&E(e[0],"hasResult")&&e[0].hasResult?(y.write("["+e[0].requestId+"] ("+(new Date).getTime()+") Skipping request pipeline method "+r+", existing result in pipeline.",0),Promise.resolve(e[0])):(y.write("["+e[0].requestId+"] ("+(new Date).getTime()+") Calling request pipeline method "+r+".",0),i.apply(n,e).then(nt))}}}var ot=(st.logStart=function(t){return new Promise(function(e){y.log({data:1===y.activeLogLevel?{}:t,level:1,message:"["+t.requestId+"] ("+(new Date).getTime()+") Beginning "+t.method+" request ("+t.url+")"}),e(t)})},st.caching=function(r){return new Promise(function(t){if(r.useCaching){y.write("["+r.requestId+"] ("+(new Date).getTime()+") Caching is enabled for request, checking cache...",1);var e=new oe(r.url.toLowerCase());if(void 0!==r.cachingOptions&&(e=P(e,r.cachingOptions)),null!==e.store){var n=e.store.get(e.key);if(null!==n)return y.log({data:1===y.activeLogLevel?{}:n,level:1,message:"["+r.requestId+"] ("+(new Date).getTime()+") Value returned from cache."}),S(r.batchDependency)&&r.batchDependency(),E(r.parser,"hydrate")&&(n=r.parser.hydrate(n)),tt(r,n).then(function(e){return t(e)})}y.write("["+r.requestId+"] ("+(new Date).getTime()+") Value not found in cache.",1),r.parser=new se(r.parser,e)}return t(r)})},st.send=function(o){return new Promise(function(t,n){var e,r,i;o.isBatched?(e=o.batch.add(o),S(o.batchDependency)&&o.batchDependency(),y.write("["+o.requestId+"] ("+(new Date).getTime()+") Batching request in batch "+o.batch.batchId+".",1),t(tt(o,e))):(y.write("["+o.requestId+"] ("+(new Date).getTime()+") Sending request.",1),r=o.clientFactory(),i=P(o.options||{},{method:o.method}),r.fetch(o.url,i).then(function(e){return o.parser.parse(e)}).then(function(e){return tt(o,e)}).then(function(e){return t(e)}).catch(function(e){return n(e)}))})},st.logEnd=function(t){return new Promise(function(e){t.isBatched?y.log({data:1===y.activeLogLevel?{}:t,level:1,message:"["+t.requestId+"] ("+(new Date).getTime()+") "+t.method+" request will complete in batch "+t.batch.batchId+"."}):y.log({data:1===y.activeLogLevel?{}:t,level:1,message:"["+t.requestId+"] ("+(new Date).getTime()+") Completing "+t.method+" request."}),e(t)})},j([it(!0)],st,"logStart",null),j([it()],st,"caching",null),j([it()],st,"send",null),j([it(!0)],st,"logEnd",null),st);function st(){}function at(){return[ot.logStart,ot.caching,ot.send,ot.logEnd].slice(0)}function ut(r){return function(n){return function(t){return function(e){return rt(Object.assign({},{batch:null,batchDependency:null,batchIndex:-1,cachingOptions:null,clientFactory:n,cloneParentCacheOptions:null,cloneParentWasCaching:!1,hasResult:!1,isBatched:T(e.batch),method:t,options:null,parentUrl:"",parser:new Be,pipes:r.slice(0),query:new Map,requestId:b(),url:"",useCaching:/^get$/i.test(e.method)&&e.useCaching},Ye(e)))}}}}var ct=ut(at());function lt(e,t){return Object.assign({body:C(e)},t)}function pt(e,t){return Object.assign({headers:e},t)}function dt(e){return{__metadata:{type:e}}}var ht="00000000-0000-0000-0000-000000000000";function ft(e){L.assign(e)}var yt=(Object.defineProperty(gt.prototype,"headers",{get:function(){var e=L.get("sp");return void 0!==e&&void 0!==e.headers?e.headers:{}},enumerable:!0,configurable:!0}),Object.defineProperty(gt.prototype,"baseUrl",{get:function(){var e=L.get("sp");return void 0!==e&&void 0!==e.baseUrl?e.baseUrl:T(L.spfxContext)?L.spfxContext.pageContext.web.absoluteUrl:null},enumerable:!0,configurable:!0}),Object.defineProperty(gt.prototype,"fetchClientFactory",{get:function(){var e=L.get("sp");return void 0!==e&&void 0!==e.fetchClientFactory?e.fetchClientFactory:function(){return new J}},enumerable:!0,configurable:!0}),new gt);function gt(){}function vt(e){if(_(e))return"";var t=e.indexOf("_api/");return t<0&&(t=e.indexOf("_vti_bin/")),-1<t?e.substr(0,t):e}function mt(i){return function(e,t,n){void 0===n&&(n=Object.getOwnPropertyDescriptor(e,t));var r=n.value;return n.value=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return M(this,void 0,void 0,function(){return q(this,function(e){return this.configure(pt({"X-PnPjs-Tracking":i})),[2,r.apply(this,t)]})})},n}}mt.getClientTag=function(e,t){if(void 0===t&&(t=!0),e.has("X-PnPjs-Tracking")){var n=e.get("X-PnPjs-Tracking");if(t&&e.delete("X-PnPjs-Tracking"),!_(n))return n}return""},mt.configure=function(e,t){return e.configure(pt({"X-PnPjs-Tracking":t}))},mt.isTagged=function(e){return e.data.options.headers&&e.data.options.headers["X-PnPjs-Tracking"]};var bt=(Tt.prototype.fetch=function(s,a){return void 0===a&&(a={}),M(this,void 0,void 0,function(){var t,n,r,i,o;return q(this,function(e){switch(e.label){case 0:return t=P(a,{cache:"no-cache",credentials:"same-origin"},!0),H(n=new Headers,yt.headers),H(n,a.headers),n.has("Accept")||n.append("Accept","application/json"),n.has("Content-Type")||n.append("Content-Type","application/json;odata=verbose;charset=utf-8"),n.has("X-ClientService-ClientTag")||(r=mt.getClientTag(n),32<(i="PnPCoreJS:$$Version$$:"+r).length&&(i=i.substr(0,32)),n.append("X-ClientService-ClientTag",i)),!(t=P(t,{headers:n})).method||"GET"===t.method.toUpperCase()||n.has("X-RequestDigest")||n.has("Authorization")?[3,2]:[4,this._digestCache(vt(s))];case 1:o=e.sent(),n.append("X-RequestDigest",o),e.label=2;case 2:return[2,this.fetchRaw(s,t)]}})})},Tt.prototype.fetchRaw=function(e,r){var i=this;void 0===r&&(r={});var t=new Headers;H(t,r.headers),r=P(r,{headers:t});var o=function(n){function t(e){var t;e.headers.has("Retry-After")?t=1e3*parseInt(e.headers.get("Retry-After"),10):(t=n.delay,n.delay*=2),n.attempts++,n.retryCount<=n.attempts?n.reject(Error("Retry count exceeded ("+n.retryCount+") for request. Response status: ["+e.status+"] "+e.statusText)):setTimeout(f(i,o,n),t)}i._impl.fetch(e,r).then(function(e){429===e.status?t(e):n.resolve(e)}).catch(function(e){503===e.status||504===e.status?t(e):n.reject(e)})};return new Promise(function(e,t){o.call(i,{attempts:0,delay:100,reject:t,resolve:e,retryCount:7})})},Tt.prototype.get=function(e,t){void 0===t&&(t={});var n=P(t,{method:"GET"});return this.fetch(e,n)},Tt.prototype.post=function(e,t){void 0===t&&(t={});var n=P(t,{method:"POST"});return this.fetch(e,n)},Tt.prototype.patch=function(e,t){void 0===t&&(t={});var n=P(t,{method:"PATCH"});return this.fetch(e,n)},Tt.prototype.delete=function(e,t){void 0===t&&(t={});var n=P(t,{method:"DELETE"});return this.fetch(e,n)},Tt),St=new Map;function Tt(e){void 0===e&&(e=yt.fetchClientFactory()),this._impl=e,this._digestCache=function(u){var e=this;return function(a){return M(e,void 0,void 0,function(){var t,n,r,i,o,s;return q(this,function(e){switch(e.label){case 0:return void 0!==(t=St.get(a))&&new Date<t.expiration?[2,t.value]:(n=v(a,"/_api/contextinfo"),r={Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose;charset=utf-8"},[4,u.fetchRaw(n,{cache:"no-cache",credentials:"same-origin",headers:P(r,yt.headers,!0),method:"POST"})]);case 1:return i=e.sent(),[4,(new Be).parse(i).then(function(e){return e.GetContextWebInformation})];case 2:return o=e.sent(),s={expiration:g(new Date,"second",o.FormDigestTimeoutSeconds),value:o.FormDigestValue},St.set(a,s),[2,s.value]}})})}}(this)}function wt(i){return new Promise(function(n){if(I(i))return n(i);if(null!==yt.baseUrl)return n(v(yt.baseUrl,i));if(void 0!==V.a._spPageContextInfo){if(E(V.a._spPageContextInfo,"webAbsoluteUrl"))return n(v(V.a._spPageContextInfo.webAbsoluteUrl,i));if(E(V.a._spPageContextInfo,"webServerRelativeUrl"))return n(v(V.a._spPageContextInfo.webServerRelativeUrl,i))}var r;return void 0!==V.a.location&&(r=V.a.location.toString().toLowerCase(),["/_layouts/","/siteassets/"].forEach(function(e){var t=r.indexOf(e);if(0<t)return n(v(r.substr(0,t),i))})),n(i)})}function Pt(e){var s=Ct(e);return function(i,o){return M(this,void 0,void 0,function(){var t,n,r;return q(this,function(e){switch(e.label){case 0:return t=Ye(i.data),n=T(t.batch)?t.batch.addDependency():function(){},[4,wt(i.toUrlAndQuery())];case 1:return r=e.sent(),K(t.options,o),[2,s(Object.assign({},t,{batchDependency:n,url:r}))]}})})}}var It,_t,Ot,Ct=ct(function(){return new bt}),Et=function(e,t){return e.data.cloneParentWasCaching&&e.usingCaching(e.data.cloneParentCacheOptions),e._forceCaching&&(e.data.useCaching=!0),Pt("GET")(e,t)},Rt=Pt("POST"),Nt=Pt("DELETE"),At=Pt("PATCH"),Ut=function(e,t){var n=Object.assign(pt({"X-HTTP-Method":"DELETE"}),t);return Rt(e,n)},xt=function(e,t,n){void 0===n&&(n="*");var r=Object.assign(pt({"X-HTTP-Method":"DELETE","IF-Match":n}),t);return Rt(e,r)},Dt=function(e){return Fe(e)},Lt=(B(Wt,Ot=Ze),Wt.prototype.toUrlAndQuery=function(){var e,r=new Map(this.query),t=this.toUrl().replace(/'!(@.*?)::(.*?)'/gi,function(e,t,n){return y.write("Rewriting aliased parameter from match "+e+" to label: "+t+" value: "+n,0),r.set(t,"'"+n+"'"),t});return 0<r.size&&(e=-1<t.indexOf("?")?"&":"?",t+=e+Array.from(r).map(function(e){return e[0]+"="+e[1]}).join("&")),t},Wt.prototype.select=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return 0<e.length&&this.query.set("$select",e.join(",")),this},Wt.prototype.get=function(e){return Et(this,e)},Wt.prototype.expand=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return 0<e.length&&this.query.set("$expand",e.join(",")),this},Wt.prototype.clone=function(e,t,n){void 0===n&&(n=!0);var r=Ot.prototype.cloneTo.call(this,e(this,t),{includeBatch:n}),i="@target";return this.query.has(i)&&r.query.set(i,this.query.get(i)),r},Wt.prototype.defaultAction=function(e){return Et(this,e)},Wt.prototype.getParent=function(e,t,n,r){void 0===t&&(t=this.parentUrl);var i=e(t,n).configureFrom(this),o="@target";return this.query.has(o)&&i.query.set(o,this.query.get(o)),void 0!==r&&(i=i.inBatch(r)),i},Wt),kt=Dt(Lt),Ft=(B(Gt,_t=Lt),Gt.prototype.filter=function(e){return this.query.set("$filter",e),this},Gt.prototype.orderBy=function(e,t){void 0===t&&(t=!0);var n="$orderby",r=this.query.has(n)?this.query.get(n).split(","):[];return r.push(e+" "+(t?"asc":"desc")),this.query.set(n,r.join(",")),this},Gt.prototype.skip=function(e){return this.query.set("$skip",e.toString()),this},Gt.prototype.top=function(e){return this.query.set("$top",e.toString()),this},Gt),Bt=Dt(Ft),jt=(B(qt,It=Lt),qt.prototype._update=function(e,n){var r=this;return function(t){return Rt(mt.configure(r,e+".Update"),{body:C(P(dt(e),t)),headers:{"X-HTTP-Method":"MERGE"}}).then(function(e){return n(e,t)})}},qt),Mt=Dt(jt);function qt(){return null!==It&&It.apply(this,arguments)||this}function Gt(){return null!==_t&&_t.apply(this,arguments)||this}function Wt(e,t){var n,r,i=this,o="",s="",a=new Map;return"string"==typeof e?o=I(e)||e.lastIndexOf("/")<0?v(s=e,t):e.lastIndexOf("/")>e.lastIndexOf("(")?(n=e.lastIndexOf("/"),s=e.slice(0,n),t=v(e.slice(n),t),v(s,t)):(n=e.lastIndexOf("("),s=e.slice(0,n),v(e,t)):(o=v(s=e.toUrl(),t||""),void 0!==(r=e.query.get("@target"))&&a.set("@target",r)),i=Ot.call(this,{parentUrl:s,query:a,url:o})||this,"string"!=typeof e&&i.configureFrom(e),i._forceCaching=!1,i}function Vt(e){return function(){return Ut(mt.configure(this,e+".delete"))}}function Ht(t){return function(e){return void 0===e&&(e="*"),xt(mt.configure(this,t+".delete"),{},e)}}function Kt(r){return function(e){return B(t,n=e),t;function t(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return n.call(this,e[0],1<e.length&&void 0!==e[1]?e[1]:r)||this}var n}}function Qt(e){var t,n=[],r=["odata.type","odata.editLink","__metadata","odata.metadata","odata.id"];return E(e,r[0])&&"SP.Web"===e[r[0]]?E(e,r[4])?n.push(e[r[4]]):E(e,r[2])&&n.push(e.__metadata.uri):E(e,r[3])&&E(e,r[1])?(t=I(e[r[1]])?e[r[1]].split("_api")[1]:e[r[1]],n.push(vt(e[r[3]]),"_api",t)):E(e,r[1])?n.push("_api",e[r[1]]):E(e,r[2])&&n.push(e.__metadata.uri),n.length<1?(y.write("No uri information found in ODataEntity parsing, chaining will fail for this object.",2),""):v.apply(void 0,W(n))}var zt,Xt,Jt=(B(Zt,Xt=Be),Zt.prototype.parse=function(e){var t=this;return Xt.prototype.parse.call(this,e).then(function(e){return P(t.factory(Qt(e),null),e)})},Zt),$t=(B(Yt,zt=Be),Yt.prototype.parse=function(e){var t=this;return zt.prototype.parse.call(this,e).then(function(e){return e.map(function(e){return P(t.factory(Qt(e),null),e)})})},Yt);function Yt(e){var t=zt.call(this)||this;return t.factory=e,t.hydrate=function(e){return e.map(function(e){return P(t.factory(Qt(e),null),e)})},t}function Zt(e){var t=Xt.call(this)||this;return t.factory=e,t.hydrate=function(e){return P(t.factory(Qt(e),null),e)},t}function en(e){return new Jt(e)}function tn(e){return new $t(e)}var nn,rn=(B(an,nn=ie),an.ParseResponse=function(e){for(var t,n,r=[],i=new RegExp("^HTTP/[0-9.]+ +([0-9]+) +(.*)","i"),o=e.split("\n"),s="batch",a=0;a<o.length;++a){var u=o[a];switch(s){case"batch":if("--batchresponse_"===u.substr(0,"--batchresponse_".length))s="batchHeaders";else if(""!==u.trim())throw Error("Invalid response, line "+a);break;case"batchHeaders":""===u.trim()&&(s="status");break;case"status":var c=i.exec(u);if(3!==c.length)throw Error("Invalid status, line "+a);t=parseInt(c[1],10),n=c[2],s="statusHeaders";break;case"statusHeaders":""===u.trim()&&(s="body");break;case"body":r.push(204===t?new Response:new Response(u,{status:t,statusText:n})),s="batch"}}if("status"!==s)throw Error("Unexpected end of input");return r},an.prototype.executeImpl=function(){return M(this,void 0,void 0,function(){var t,n,r,i,o,s,a,u,c,l,p,d,h,f=this;return q(this,function(e){switch(e.label){case 0:return y.write("["+this.batchId+"] ("+(new Date).getTime()+") Executing batch with "+this.requests.length+" requests.",1),this.requests.length<1?(y.write("Resolving empty batch.",1),[2]):(t=new bt,[4,wt(this.baseUrl)]);case 1:for(n=e.sent(),r=[],i="",o=0;o<this.requests.length;o++)"GET"===(s=this.requests[o]).method?(0<i.length&&(r.push("--changeset_"+i+"--\n\n"),i=""),r.push("--batch_"+this.batchId+"\n")):(i.length<1&&(i=b(),r.push("--batch_"+this.batchId+"\n"),r.push('Content-Type: multipart/mixed; boundary="changeset_'+i+'"\n\n')),r.push("--changeset_"+i+"\n")),r.push("Content-Type: application/http\n"),r.push("Content-Transfer-Encoding: binary\n\n"),a=new Headers,u=I(s.url)?s.url:v(n,s.url),y.write("["+this.batchId+"] ("+(new Date).getTime()+") Adding request "+s.method+" "+u+" to batch.",0),"GET"!==s.method?(c=s.method,l=s.options.headers,E(s,"options")&&E(s.options,"headers")&&void 0!==l["X-HTTP-Method"]&&(c=l["X-HTTP-Method"],delete l["X-HTTP-Method"]),r.push(c+" "+u+" HTTP/1.1\n"),a.set("Content-Type","application/json;odata=verbose;charset=utf-8")):r.push(s.method+" "+u+" HTTP/1.1\n"),H(a,yt.headers),s.options&&H(a,s.options.headers),a.has("Accept")||a.append("Accept","application/json"),a.has("Content-Type")||a.append("Content-Type","application/json;odata=verbose;charset=utf-8"),a.has("X-ClientService-ClientTag")||a.append("X-ClientService-ClientTag","PnPCoreJS:@pnp-$$Version$$:batch"),a.forEach(function(e,t){r.push(t+": "+e+"\n")}),r.push("\n"),s.options.body&&r.push(s.options.body+"\n\n");return 0<i.length&&(r.push("--changeset_"+i+"--\n\n"),i=""),r.push("--batch_"+this.batchId+"--\n"),p={body:r.join(""),headers:{"Content-Type":"multipart/mixed; boundary=batch_"+this.batchId},method:"POST"},y.write("["+this.batchId+"] ("+(new Date).getTime()+") Sending batch request.",1),[4,t.fetch(v(n,"/_api/$batch"),p)];case 2:return[4,e.sent().text()];case 3:if(d=e.sent(),(h=an.ParseResponse(d)).length!==this.requests.length)throw Error("Could not properly parse responses to match requests in batch.");return y.write("["+this.batchId+"] ("+(new Date).getTime()+") Resolving batched requests.",1),[2,h.reduce(function(e,o,s){return e.then(function(e){return M(f,void 0,void 0,function(){var t,n,r,i;return q(this,function(e){switch(e.label){case 0:t=this.requests[s],y.write("["+t.id+"] ("+(new Date).getTime()+") Resolving request in batch "+this.batchId+".",1),e.label=1;case 1:return e.trys.push([1,3,,4]),r=(n=t).resolve,[4,t.parser.parse(o)];case 2:return r.apply(n,[e.sent()]),[3,4];case 3:return i=e.sent(),t.reject(i),[3,4];case 4:return[2]}})})})},Promise.resolve(void 0))]}})})},an),on=(sn.prototype.configure=function(e,t){return void 0===t&&(t=""),new sn(e,t)},sn.prototype.setup=function(e){e.pageContext?ft({spfxContext:e}):ft(e)},sn);function sn(e,t){void 0===e&&(e={}),void 0===t&&(t=""),this._options=e,this._baseUrl=t}function an(e){var t=nn.call(this)||this;return t.baseUrl=e,t}function un(e){return _(e)?"":/!(@.*?)::(.*?)/gi.test(e)?e.replace(/!(@.*?)::(.*)$/gi,function(e,t,n){return y.write("Rewriting aliased parameter from match "+e+" to label: "+t+" value: "+n,0),"!"+t+"::"+encodeURIComponent(n.replace(/\'/gi,"''"))}):encodeURIComponent(e.replace(/\'/gi,"''"))}new on;var cn,ln=(B(dn,cn=jt),Object.defineProperty(dn.prototype,"rootWeb",{get:function(){return mt.configure(mn(this,"rootweb"),"si.rootWeb")},enumerable:!0,configurable:!0}),dn.prototype.getRootWeb=function(){return M(this,void 0,void 0,function(){var t;return q(this,function(e){switch(e.label){case 0:return[4,this.rootWeb.select("Url")()];case 1:return t=e.sent(),[2,mt.configure(mn(t.Url),"si.getRootWeb")]}})})},dn.prototype.getContextInfo=function(){return M(this,void 0,void 0,function(){var t,n,r;return q(this,function(e){switch(e.label){case 0:return t=mt.configure(pn(this.parentUrl,"_api/contextinfo"),"si.getContextInfo"),[4,Rt(t)];case 1:return E(n=e.sent(),"GetContextWebInformation")?((r=n.GetContextWebInformation).SupportedSchemaVersions=r.SupportedSchemaVersions.results,[2,r]):[2,n]}})})},dn.prototype.createBatch=function(){return new rn(this.parentUrl)},dn.prototype.delete=function(){return M(this,void 0,void 0,function(){var t,n;return q(this,function(e){switch(e.label){case 0:return[4,this.clone(pn,"").select("Id")()];case 1:return t=e.sent(),n=mt.configure(pn(this.parentUrl,"_api/SPSiteManager/Delete"),"si.delete"),[4,Rt(n,lt({siteId:t.Id}))];case 2:return e.sent(),[2]}})})},dn.prototype.getDocumentLibraries=function(r){return M(this,void 0,void 0,function(){var t,n;return q(this,function(e){switch(e.label){case 0:return(t=mt.configure(kt("","_api/sp.web.getdocumentlibraries(@v)"),"si.getDocumentLibraries")).query.set("@v","'"+un(r)+"'"),[4,t()];case 1:return[2,E(n=e.sent(),"GetDocumentLibraries")?n.GetDocumentLibraries:n]}})})},dn.prototype.getWebUrlFromPageUrl=function(r){return M(this,void 0,void 0,function(){var t,n;return q(this,function(e){switch(e.label){case 0:return(t=mt.configure(kt("","_api/sp.web.getweburlfrompageurl(@v)"),"si.getWebUrlFromPageUrl")).query.set("@v","'"+un(r)+"'"),[4,t()];case 1:return[2,E(n=e.sent(),"GetWebUrlFromPageUrl")?n.GetWebUrlFromPageUrl:n]}})})},dn.prototype.getChanges=function(e){var t=lt({query:P(dt("SP.ChangeQuery"),e)});return Rt(this.clone(mn,"getchanges"),t)},dn.prototype.openWebById=function(n){return M(this,void 0,void 0,function(){var t;return q(this,function(e){switch(e.label){case 0:return[4,Rt(this.clone(pn,"openWebById('"+n+"')"))];case 1:return[2,{data:t=e.sent(),web:mn(vt(Qt(t)))}]}})})},dn.prototype.createCommunicationSite=function(t,n,r,i,o,s,a,u,c){return void 0===n&&(n=1033),void 0===r&&(r=!1),M(this,void 0,void 0,function(){return q(this,function(e){return[2,this.createCommunicationSiteFromProps({Classification:s,Description:o,HubSiteId:u,Lcid:n,Owner:c,ShareByEmailEnabled:r,SiteDesignId:a,Title:t,Url:i})]})})},dn.prototype.createCommunicationSiteFromProps=function(r){return M(this,void 0,void 0,function(){var t,n;return q(this,function(e){return t=Object.assign({},{Classification:"",Description:"",HubSiteId:ht,Lcid:1033,ShareByEmailEnabled:!1,SiteDesignId:ht,WebTemplate:"SITEPAGEPUBLISHING#0",WebTemplateExtensionId:ht},r),n=lt({request:P(dt("Microsoft.SharePoint.Portal.SPSiteCreationRequest"),t)}),[2,Rt(pn(vt(this.toUrl()),"/_api/SPSiteManager/Create"),n)]})})},dn.prototype.exists=function(n){return M(this,void 0,void 0,function(){var t;return q(this,function(e){switch(e.label){case 0:return t=lt({url:n}),[4,Rt(pn(vt(this.toUrl()),"/_api/SP.Site.Exists"),t)];case 1:return[2,e.sent()]}})})},dn.prototype.createModernTeamSite=function(t,n,r,i,o,s,a,u,c){return M(this,void 0,void 0,function(){return q(this,function(e){return[2,this.createModernTeamSiteFromProps({alias:n,classification:s,description:o,displayName:t,hubSiteId:u,isPublic:r,lcid:i,owners:a,siteDesignId:c})]})})},dn.prototype.createModernTeamSiteFromProps=function(r){return M(this,void 0,void 0,function(){var t,n;return q(this,function(e){return t=Object.assign({},{classification:"",description:"",hubSiteId:ht,isPublic:!0,lcid:1033,owners:[]},r),n={alias:t.alias,displayName:t.displayName,isPublic:t.isPublic,optionalParams:{Classification:t.classification,CreationOptions:{results:["SPSiteLanguage:"+t.lcid,"HubSiteId:"+t.hubSiteId]},Description:t.description,Owners:{results:t.owners}}},t.siteDesignId&&n.optionalParams.CreationOptions.results.push("implicit_formula_292aa8a00786498a87a5ca52d9f4214a_"+t.siteDesignId),[2,Rt(pn(vt(this.toUrl()),"/_api/GroupSiteManager/CreateGroupEx"),lt(n))]})})},j([mt("si.getChanges")],dn.prototype,"getChanges",null),j([mt("si.openWebById")],dn.prototype,"openWebById",null),j([Kt("_api/site")],dn)),pn=Dt(ln);function dn(){return null!==cn&&cn.apply(this,arguments)||this}Reflect.defineProperty(on.prototype,"site",{configurable:!0,enumerable:!0,get:function(){return pn(this._baseUrl).configure(this._options)}});var hn,fn,yn=(B(Sn,fn=Ft),Sn.prototype.add=function(r,i,o,s,a,u){return void 0===o&&(o=""),void 0===s&&(s="STS"),void 0===a&&(a=1033),void 0===u&&(u=!0),M(this,void 0,void 0,function(){var t,n;return q(this,function(e){switch(e.label){case 0:return t=lt({parameters:P(dt("SP.WebCreationInformation"),{Description:o,Language:a,Title:r,Url:i,UseSamePermissionsAsParentSite:u,WebTemplate:s})}),[4,Rt(this.clone(gn,"add"),t)];case 1:return[2,{data:n=e.sent(),web:mn(Qt(n).replace(/_api\/web\/?/i,""))}]}})})},j([mt("ws.add")],Sn.prototype,"add",null),j([Kt("webs")],Sn)),gn=Dt(yn),vn=(B(bn,hn=jt),Object.defineProperty(bn.prototype,"webs",{get:function(){return gn(this)},enumerable:!0,configurable:!0}),bn.prototype.getParentWeb=function(){return M(this,void 0,void 0,function(){var t;return q(this,function(e){switch(e.label){case 0:return[4,Et(this.select("ParentWeb/Id").expand("ParentWeb"))];case 1:return[2,(t=e.sent().ParentWeb)?pn(this.parentUrl).openWebById(t.Id):null]}})})},bn.prototype.getSubwebsFilteredForCurrentUser=function(e,t){void 0===e&&(e=-1),void 0===t&&(t=-1);var n=this.clone(gn,"getSubwebsFilteredForCurrentUser(nWebTemplateFilter="+e+",nConfigurationFilter="+t+")");return mt.configure(n,"w.getSubwebsFilteredForCurrentUser")},Object.defineProperty(bn.prototype,"allProperties",{get:function(){return mt.configure(this.clone(Mt,"allproperties"),"w.allprops")},enumerable:!0,configurable:!0}),Object.defineProperty(bn.prototype,"webinfos",{get:function(){return mt.configure(Bt(this,"webinfos"),"w.webinfos")},enumerable:!0,configurable:!0}),bn.prototype.createBatch=function(){return new rn(this.parentUrl)},bn.prototype.update=function(n){return M(this,void 0,void 0,function(){var t;return q(this,function(e){switch(e.label){case 0:return t=lt(P(dt("SP.Web"),n),pt({"X-HTTP-Method":"MERGE"})),[4,Rt(this,t)];case 1:return[2,{data:e.sent(),web:this}]}})})},bn.prototype.applyTheme=function(e,t,n,r){var i=lt({backgroundImageUrl:n,colorPaletteUrl:e,fontSchemeUrl:t,shareGenerated:r});return Rt(this.clone(mn,"applytheme"),i)},bn.prototype.applyWebTemplate=function(e){var t=this.clone(mn,"applywebtemplate");return t.concat("(webTemplate='"+un(e)+"')"),Rt(t)},bn.prototype.availableWebTemplates=function(e,t){return void 0===e&&(e=1033),void 0===t&&(t=!0),mt.configure(Bt(this,"getavailablewebtemplates(lcid="+e+", doincludecrosslanguage="+t+")"),"w.availableWebTemplates")},bn.prototype.getChanges=function(e){var t=lt({query:P(dt("SP.ChangeQuery"),e)});return Rt(this.clone(mn,"getchanges"),t)},bn.prototype.mapToIcon=function(e,t,n){return void 0===t&&(t=0),void 0===n&&(n=""),Et(this.clone(mn,"maptoicon(filename='"+un(e)+"', progid='"+un(n)+"', size="+t+")"))},bn.prototype.getStorageEntity=function(e){return Et(this.clone(mn,"getStorageEntity('"+un(e)+"')"))},bn.prototype.setStorageEntity=function(e,t,n,r){return void 0===n&&(n=""),void 0===r&&(r=""),Rt(this.clone(mn,"setStorageEntity"),lt({comments:r,description:n,key:e,value:t}))},bn.prototype.removeStorageEntity=function(e){return Rt(this.clone(mn,"removeStorageEntity('"+un(e)+"')"))},j([mt("w.getParentWeb")],bn.prototype,"getParentWeb",null),j([mt("w.update")],bn.prototype,"update",null),j([mt("w.applyTheme")],bn.prototype,"applyTheme",null),j([mt("w.applyWebTemplate")],bn.prototype,"applyWebTemplate",null),j([mt("w.getChanges")],bn.prototype,"getChanges",null),j([mt("w.mapToIcon")],bn.prototype,"mapToIcon",null),j([mt("w.getStorageEntity")],bn.prototype,"getStorageEntity",null),j([mt("w.setStorageEntity")],bn.prototype,"setStorageEntity",null),j([mt("w.removeStorageEntity")],bn.prototype,"removeStorageEntity",null),j([Kt("_api/web")],bn)),mn=Dt(vn);function bn(){var e=null!==hn&&hn.apply(this,arguments)||this;return e.delete=Vt("w"),e}function Sn(){return null!==fn&&fn.apply(this,arguments)||this}function Tn(e){return{DecodedUrl:e,__metadata:{type:"SP.ResourcePath"}}}var wn,Pn,In,_n,On,Cn,En=(B(xn,_n=Ft),xn.prototype.getById=function(e){return mt.configure(An(this).concat("('"+e+"')"),"ls.getById")},xn.prototype.getByTitle=function(e){return mt.configure(An(this,"getByTitle('"+un(e)+"')"),"ls.getByTitle")},xn.prototype.add=function(n,r,i,o,s){return void 0===r&&(r=""),void 0===i&&(i=100),void 0===o&&(o=!1),void 0===s&&(s={}),M(this,void 0,void 0,function(){var t;return q(this,function(e){switch(e.label){case 0:return t=Object.assign({AllowContentTypes:o,BaseTemplate:i,ContentTypesEnabled:o,Description:r,Title:n},dt("SP.List"),s),[4,Rt(this,lt(t))];case 1:return[2,{data:e.sent(),list:this.getByTitle(t.Title)}]}})})},xn.prototype.ensure=function(r,i,o,s,a){return void 0===i&&(i=""),void 0===o&&(o=100),void 0===s&&(s=!1),void 0===a&&(a={}),M(this,void 0,void 0,function(){var t,n;return q(this,function(e){switch(e.label){case 0:if(this.hasBatch)throw Error("The ensure list method is not supported for use in a batch.");t=P(a,{Title:r,Description:i,ContentTypesEnabled:s},!0),n=this.getByTitle(t.Title),e.label=1;case 1:return e.trys.push([1,4,,6]),[4,n.select("Title")()];case 2:return e.sent(),[4,n.update(t).then(function(e){return e.data})];case 3:return[2,{created:!1,data:e.sent(),list:this.getByTitle(t.Title)}];case 4:return e.sent(),[4,this.add(r,i,o,s,t).then(function(e){return e.data})];case 5:return[2,{created:!0,data:e.sent(),list:this.getByTitle(t.Title)}];case 6:return[2]}})})},xn.prototype.ensureSiteAssetsLibrary=function(){return M(this,void 0,void 0,function(){var t;return q(this,function(e){switch(e.label){case 0:return[4,Rt(this.clone(Rn,"ensuresiteassetslibrary"))];case 1:return t=e.sent(),[2,An(Qt(t))]}})})},xn.prototype.ensureSitePagesLibrary=function(){return M(this,void 0,void 0,function(){var t;return q(this,function(e){switch(e.label){case 0:return[4,Rt(this.clone(Rn,"ensuresitepageslibrary"))];case 1:return t=e.sent(),[2,An(Qt(t))]}})})},j([mt("ls.add")],xn.prototype,"add",null),j([mt("ls.ensure")],xn.prototype,"ensure",null),j([mt("ls.ensureSiteAssetsLibrary")],xn.prototype,"ensureSiteAssetsLibrary",null),j([mt("ls.ensureSitePagesLibrary")],xn.prototype,"ensureSitePagesLibrary",null),j([Kt("lists")],xn)),Rn=Dt(En),Nn=(B(Un,In=jt),Object.defineProperty(Un.prototype,"effectiveBasePermissions",{get:function(){return mt.configure(kt(this,"EffectiveBasePermissions"),"l.effectiveBasePermissions")},enumerable:!0,configurable:!0}),Object.defineProperty(Un.prototype,"eventReceivers",{get:function(){return mt.configure(Bt(this,"EventReceivers"),"l.eventReceivers")},enumerable:!0,configurable:!0}),Object.defineProperty(Un.prototype,"relatedFields",{get:function(){return mt.configure(kt(this,"getRelatedFields"),"l.relatedFields")},enumerable:!0,configurable:!0}),Object.defineProperty(Un.prototype,"informationRightsManagementSettings",{get:function(){return mt.configure(kt(this,"InformationRightsManagementSettings"),"l.informationRightsManagementSettings")},enumerable:!0,configurable:!0}),Un.prototype.update=function(i,o){return void 0===o&&(o="*"),M(this,void 0,void 0,function(){var t,n,r;return q(this,function(e){switch(e.label){case 0:return t=lt(P(dt("SP.List"),i),pt({"IF-Match":o,"X-HTTP-Method":"MERGE"})),[4,Rt(this,t)];case 1:return n=e.sent(),r=this,E(i,"Title")&&(r=this.getParent(An,this.parentUrl,"getByTitle('"+i.Title+"')")),[2,{data:n,list:r}]}})})},Un.prototype.getChanges=function(e){return Rt(this.clone(An,"getchanges"),lt({query:P(dt("SP.ChangeQuery"),e)}))},Un.prototype.getItemsByCAMLQuery=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=this.clone(An,"getitems");return Rt(r.expand.apply(r,t),lt({query:P(dt("SP.CamlQuery"),e)}))},Un.prototype.getListItemChangesSinceToken=function(e){var t=this.clone(An,"getlistitemchangessincetoken").usingParser({parse:function(e){return e.text()}});return Rt(t,lt({query:P(dt("SP.ChangeLogItemQuery"),e)}))},Un.prototype.recycle=function(){return M(this,void 0,void 0,function(){var t;return q(this,function(e){switch(e.label){case 0:return[4,Rt(this.clone(An,"recycle"))];case 1:return[2,E(t=e.sent(),"Recycle")?t.Recycle:t]}})})},Un.prototype.renderListData=function(r){return M(this,void 0,void 0,function(){var t,n;return q(this,function(e){switch(e.label){case 0:return(t=this.clone(An,"renderlistdata(@viewXml)")).query.set("@viewXml","'"+r+"'"),[4,Rt(t)];case 1:return n=e.sent(),[2,JSON.parse(E(n,"RenderListData")?n.RenderListData:n)]}})})},Un.prototype.renderListDataAsStream=function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=new Map),E(e,"RenderOptions")&&w(e.RenderOptions)&&(e.RenderOptions=e.RenderOptions.reduce(function(e,t){return e+t}));var r=lt({overrideParameters:P(dt("SP.RenderListDataOverrideParameters"),t),parameters:P(dt("SP.RenderListDataParameters"),e)}),i=this.clone(An,"RenderListDataAsStream",!0);return n&&0<n.size&&n.forEach(function(e,t){return i.query.set(t,e)}),Rt(i,r)},Un.prototype.renderListFormData=function(n,r,i){return M(this,void 0,void 0,function(){var t;return q(this,function(e){switch(e.label){case 0:return[4,Rt(this.clone(An,"renderlistformdata(itemid="+n+", formid='"+r+"', mode='"+i+"')"))];case 1:return t=e.sent(),[2,JSON.parse(E(t,"RenderListFormData")?t.RenderListFormData:t)]}})})},Un.prototype.reserveListItemId=function(){return M(this,void 0,void 0,function(){var t;return q(this,function(e){switch(e.label){case 0:return[4,Rt(this.clone(An,"reservelistitemid"))];case 1:return[2,E(t=e.sent(),"ReserveListItemId")?t.ReserveListItemId:t]}})})},Un.prototype.getListItemEntityTypeFullName=function(){return this.clone(An,null,!1).select("ListItemEntityTypeFullName").get().then(function(e){return e.ListItemEntityTypeFullName})},Un.prototype.addValidateUpdateItemUsingPath=function(r,i,o,s,a){return void 0===o&&(o=!1),M(this,void 0,void 0,function(){var t,n;return q(this,function(e){switch(e.label){case 0:return t={FolderPath:Tn(i)},T(a)&&(a.leafName&&(t.LeafName=Tn(a.leafName)),a.objectType&&(t.UnderlyingObjectType=a.objectType)),[4,Rt(this.clone(An,"AddValidateUpdateItemUsingPath()"),lt({bNewDocumentUpdate:o,checkInComment:s,formValues:r,listItemCreateInfo:P(dt("SP.ListItemCreationInformationUsingPath"),t)}))];case 1:return[2,E(n=e.sent(),"AddValidateUpdateItemUsingPath")?n.AddValidateUpdateItemUsingPath:n]}})})},j([mt("l.update")],Un.prototype,"update",null),j([mt("l.getChanges")],Un.prototype,"getChanges",null),j([mt("l.CAMLQuery")],Un.prototype,"getItemsByCAMLQuery",null),j([mt("l.ChangesSinceToken")],Un.prototype,"getListItemChangesSinceToken",null),j([mt("l.recycle")],Un.prototype,"recycle",null),j([mt("l.renderListData")],Un.prototype,"renderListData",null),j([mt("l.AsStream")],Un.prototype,"renderListDataAsStream",null),j([mt("l.renderListFormData")],Un.prototype,"renderListFormData",null),j([mt("l.reserveListItemId")],Un.prototype,"reserveListItemId",null),j([mt("l.getListItemEntityTypeFullName")],Un.prototype,"getListItemEntityTypeFullName",null),j([mt("l.addValidateUpdateItemUsingPath")],Un.prototype,"addValidateUpdateItemUsingPath",null),Un),An=Dt(Nn);function Un(){var e=null!==In&&In.apply(this,arguments)||this;return e.delete=Ht("l"),e}function xn(){return null!==_n&&_n.apply(this,arguments)||this}(Cn=wn=wn||{})[Cn.None=0]="None",Cn[Cn.ContextInfo=1]="ContextInfo",Cn[Cn.ListData=2]="ListData",Cn[Cn.ListSchema=4]="ListSchema",Cn[Cn.MenuView=8]="MenuView",Cn[Cn.ListContentType=16]="ListContentType",Cn[Cn.FileSystemItemId=32]="FileSystemItemId",Cn[Cn.ClientFormSchema=64]="ClientFormSchema",Cn[Cn.QuickLaunch=128]="QuickLaunch",Cn[Cn.Spotlight=256]="Spotlight",Cn[Cn.Visualization=512]="Visualization",Cn[Cn.ViewMetadata=1024]="ViewMetadata",Cn[Cn.DisableAutoHyperlink=2048]="DisableAutoHyperlink",Cn[Cn.EnableMediaTAUrls=4096]="EnableMediaTAUrls",Cn[Cn.ParentInfo=8192]="ParentInfo",Cn[Cn.PageContextInfo=16384]="PageContextInfo",Cn[Cn.ClientSideComponentManifest=32768]="ClientSideComponentManifest",(On=Pn=Pn||{})[On.Display=1]="Display",On[On.Edit=2]="Edit",On[On.New=3]="New",me(vn,"lists",Rn),me(vn,"siteUserInfoList",An,"siteuserinfolist"),me(vn,"defaultDocumentLibrary",An,"DefaultDocumentLibrary"),me(vn,"customListTemplates",Bt,"getcustomlisttemplates"),vn.prototype.getList=function(e){return An(this,"getList('"+un(e)+"')")},vn.prototype.getCatalog=function(n){return M(this,void 0,void 0,function(){var t;return q(this,function(e){switch(e.label){case 0:return[4,this.clone(mn,"getcatalog("+n+")").select("Id").get()];case 1:return t=e.sent(),[2,An(Qt(t))]}})})};var Dn,Ln,kn,Fn,Bn,jn,Mn=(B(rr,jn=Ft),rr.prototype.getById=function(e){return mt.configure(Wn(this).concat("("+e+")"),"is.getById")},rr.prototype.getItemByStringId=function(e){return mt.configure(Wn(this.parentUrl,"getItemByStringId('"+e+"')"),"is.getItemByStringId")},rr.prototype.skip=function(e,t){return void 0===t&&(t=!1),t?this.query.set("$skiptoken",encodeURIComponent("Paged=TRUE&PagedPrev=TRUE&p_ID="+e)):this.query.set("$skiptoken",encodeURIComponent("Paged=TRUE&p_ID="+e)),this},rr.prototype.getPaged=function(){return this.usingParser(new Xn(this))()},rr.prototype.getAll=function(e,t){void 0===e&&(e=2e3),void 0===t&&(t="application/json;odata=nometadata"),y.write("Calling items.getAll should be done sparingly. Ensure this is the correct choice. If you are unsure, it is not.",2);var o=qn(this,"").top(e).configure({headers:{Accept:t}});return this.query.forEach(function(e,t){/^\$select|filter|top|expand$/i.test(t)&&o.query.set(t,e)}),new Promise(function(t,n){var r=[],i=function(e){[].push.apply(r,e.results),e.hasNext?e.getNext().then(i).catch(n):t(r)};o.getPaged().then(i).catch(n)})},rr.prototype.add=function(s,a){return void 0===s&&(s={}),void 0===a&&(a=null),M(this,void 0,void 0,function(){var t,n,r,i,o=this;return q(this,function(e){switch(e.label){case 0:return t=this.addBatchDependency(),[4,this.ensureListItemEntityTypeName(a)];case 1:return n=e.sent(),r=lt(P(dt(n),s)),i=Rt(this.clone(qn,""),r).then(function(e){return{data:e,item:o.getById(e.Id)}}),t(),[2,i]}})})},rr.prototype.ensureListItemEntityTypeName=function(e){return e?Promise.resolve(e):this.getParent(An).getListItemEntityTypeFullName()},j([mt("is.getPaged")],rr.prototype,"getPaged",null),j([mt("is.getAll")],rr.prototype,"getAll",null),j([mt("is.add")],rr.prototype,"add",null),j([Kt("items")],rr)),qn=Dt(Mn),Gn=(B(nr,Bn=jt),Object.defineProperty(nr.prototype,"effectiveBasePermissions",{get:function(){return mt.configure(kt(this,"EffectiveBasePermissions"),"i.effectiveBasePermissions")},enumerable:!0,configurable:!0}),Object.defineProperty(nr.prototype,"effectiveBasePermissionsForUI",{get:function(){return mt.configure(kt(this,"EffectiveBasePermissionsForUI"),"i.effectiveBasePermissionsForUI")},enumerable:!0,configurable:!0}),Object.defineProperty(nr.prototype,"fieldValuesAsHTML",{get:function(){return mt.configure(Mt(this,"FieldValuesAsHTML"),"i.fvHTML")},enumerable:!0,configurable:!0}),Object.defineProperty(nr.prototype,"fieldValuesAsText",{get:function(){return mt.configure(Mt(this,"FieldValuesAsText"),"i.fvText")},enumerable:!0,configurable:!0}),Object.defineProperty(nr.prototype,"fieldValuesForEdit",{get:function(){return mt.configure(Mt(this,"FieldValuesForEdit"),"i.fvEdit")},enumerable:!0,configurable:!0}),Object.defineProperty(nr.prototype,"versions",{get:function(){return mt.configure(Hn(this),"i.versions")},enumerable:!0,configurable:!0}),Object.defineProperty(nr.prototype,"list",{get:function(){return this.getParent(An,this.parentUrl.substr(0,this.parentUrl.lastIndexOf("/")))},enumerable:!0,configurable:!0}),nr.prototype.update=function(o,s,a){return void 0===s&&(s="*"),void 0===a&&(a=null),M(this,void 0,void 0,function(){var t,n,r,i;return q(this,function(e){switch(e.label){case 0:return t=this.addBatchDependency(),[4,this.ensureListItemEntityTypeName(a)];case 1:return n=e.sent(),r=lt(P(dt(n),o),pt({"IF-Match":s,"X-HTTP-Method":"MERGE"})),t(),i=mt.configure(this.clone(Wn).usingParser(new Jn),"i.update"),[4,Rt(i,r)];case 2:return[2,{data:e.sent(),item:this}]}})})},nr.prototype.recycle=function(){return Rt(this.clone(Wn,"recycle"))},nr.prototype.getWopiFrameUrl=function(r){return void 0===r&&(r=0),M(this,void 0,void 0,function(){var t,n;return q(this,function(e){switch(e.label){case 0:return(t=this.clone(Wn,"getWOPIFrameUrl(@action)")).query.set("@action",r),[4,Rt(t)];case 1:return E(n=e.sent(),"GetWOPIFrameUrl")?[2,n.GetWOPIFrameUrl]:[2,n]}})})},nr.prototype.validateUpdateListItem=function(e,t){return void 0===t&&(t=!1),Rt(this.clone(Wn,"validateupdatelistitem"),lt({formValues:e,bNewDocumentUpdate:t}))},nr.prototype.ensureListItemEntityTypeName=function(e){return e?Promise.resolve(e):this.list.getListItemEntityTypeFullName()},j([mt("i.recycle")],nr.prototype,"recycle",null),j([mt("i.getWopiFrameUrl")],nr.prototype,"getWopiFrameUrl",null),j([mt("i.validateUpdateListItem")],nr.prototype,"validateUpdateListItem",null),nr),Wn=Dt(Gn),Vn=(B(tr,Fn=Ft),tr.prototype.getById=function(e){return mt.configure(Qn(this).concat("("+e+")"),"iv.getById")},j([Kt("versions")],tr)),Hn=Dt(Vn),Kn=(B(er,kn=jt),er),Qn=Dt(Kn),zn=(Object.defineProperty(Zn.prototype,"hasNext",{get:function(){return"string"==typeof this.nextUrl&&0<this.nextUrl.length},enumerable:!0,configurable:!0}),Zn.prototype.getNext=function(){return this.hasNext?mt.configure(qn(this.nextUrl,null).configureFrom(this.parent),"ip.getNext").getPaged():new Promise(function(e){return e(null)})},Zn),Xn=(B(Yn,Ln=Be),Yn.prototype.parse=function(t){var r=this;return new Promise(function(n,e){r.handleError(t,e)&&t.json().then(function(e){var t=E(e,"d")&&E(e.d,"__next")?e.d.__next:e["odata.nextLink"];n(new zn(r._parent,t,r.parseODataJSON(e)))})})},Yn),Jn=(B($n,Dn=Be),$n.prototype.parse=function(n){var r=this;return new Promise(function(e,t){r.handleError(n,t)&&e({"odata.etag":n.headers.get("etag")})})},$n);function $n(){return null!==Dn&&Dn.apply(this,arguments)||this}function Yn(e){var t=Ln.call(this)||this;return t._parent=e,t}function Zn(e,t,n){this.parent=e,this.nextUrl=t,this.results=n}function er(){var e=null!==kn&&kn.apply(this,arguments)||this;return e.delete=Ht("iv"),e}function tr(){return null!==Fn&&Fn.apply(this,arguments)||this}function nr(){var e=null!==Bn&&Bn.apply(this,arguments)||this;return e.delete=Ht("i"),e}function rr(){return null!==jn&&jn.apply(this,arguments)||this}me(Nn,"items",qn);var ir,or,sr,ar,ur,cr,lr=(dr.prototype.getConfiguration=function(){var n=this;return this.web.lists.getByTitle(this.listTitle).items.select(this.keyFieldName,this.valueFieldName)().then(function(e){return e.reduce(function(e,t){return e[t[n.keyFieldName]]=t[n.valueFieldName],e},{})})},dr.prototype.asCaching=function(e){return void 0===e&&(e="pnp_configcache_splist_"+this.web.toUrl()+"+"+this.listTitle),new re(this,e)},dr),pr=function(e,t){return(pr=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function dr(e,t,n,r){void 0===t&&(t="config"),void 0===n&&(n="Title"),void 0===r&&(r="Value"),this.web=e,this.listTitle=t,this.keyFieldName=n,this.valueFieldName=r}function hr(t){return P(dt("Collection(SP.KeyValue)"),{results:Object.keys(t).map(function(e){return P(dt("SP.KeyValue"),{Key:e,Value:Reflect.get(t,e),ValueType:"Edm.String"})})})}(cr=ir=ir||{})[cr.None=0]="None",cr[cr.User=1]="User",cr[cr.DistributionList=2]="DistributionList",cr[cr.SecurityGroup=4]="SecurityGroup",cr[cr.SharePointGroup=8]="SharePointGroup",cr[cr.All=15]="All",(ur=or=or||{})[ur.None=0]="None",ur[ur.UserInfoList=1]="UserInfoList",ur[ur.Windows=2]="Windows",ur[ur.MembershipProvider=4]="MembershipProvider",ur[ur.RoleProvider=8]="RoleProvider",ur[ur.All=15]="All",(ar=sr=sr||{})[ar.Invalid=-1]="Invalid",ar[ar.DefaultView=0]="DefaultView",ar[ar.NormalView=1]="NormalView",ar[ar.DialogView=2]="DialogView",ar[ar.View=3]="View",ar[ar.DisplayForm=4]="DisplayForm",ar[ar.DisplayFormDialog=5]="DisplayFormDialog",ar[ar.EditForm=6]="EditForm",ar[ar.EditFormDialog=7]="EditFormDialog",ar[ar.NewForm=8]="NewForm",ar[ar.NewFormDialog=9]="NewFormDialog",ar[ar.SolutionForm=10]="SolutionForm",ar[ar.PAGE_MAXITEMS=11]="PAGE_MAXITEMS";var fr=/["*:<>?/\\|\x00-\x1f\x7f-\x9f]/g,yr=/["#%*:<>?/\\|\x00-\x1f\x7f-\x9f]/g;function gr(e,t){return void 0===t&&(t=!1),t?yr.test(e):fr.test(e)}function vr(e,t,n){return void 0===t&&(t=""),void 0===n&&(n=!1),n?e.replace(yr,t):e.replace(fr,t)}Reflect.defineProperty(on.prototype,"web",{configurable:!0,enumerable:!0,get:function(){return mn(this._baseUrl).configure(this._options)}}),on.prototype.createBatch=function(){return this.web.createBatch()};var mr,br,Sr,Tr=(pr(br=wr,Sr=mr=on),br.prototype=null===Sr?Object.create(Sr):(Pr.prototype=Sr.prototype,new Pr),wr.prototype.crossDomainSite=function(e,t){return this._cdImpl(pn,e,t,"site")},wr.prototype.crossDomainWeb=function(e,t){return this._cdImpl(mn,e,t,"web")},wr.prototype._cdImpl=function(e,t,n,r){if(!I(t))throw Error("The addInWebUrl parameter must be an absolute url.");if(!I(n))throw Error("The hostWebUrl parameter must be an absolute url.");var i=e(v(t,"_api/SP.AppContextSite(@target)"),r);return i.query.set("@target","'"+encodeURIComponent(n)+"'"),i.configure(this._options)},new wr);function wr(){return null!==mr&&mr.apply(this,arguments)||this}function Pr(){this.constructor=br}var Ir,_r=(Rr.ensure=function(e,t){var n=[Rr.Beta,Rr.V1],r=new RegExp(t,"i"),i=n.filter(function(e){return!r.test(e)}).map(function(e){return e.replace(".","\\.")}),r=new RegExp("/?("+i.join("|")+")/","ig");return e.replace(r,"/"+t+"/")},Rr.Beta="beta",Rr.V1="v1.0",Rr),Or=n(1),Cr=(B(Er,Ir=$),Er.fromSPFxContext=function(e){return new Y(e)},Er.prototype.fetch=function(n,r){return M(this,void 0,void 0,function(){var t;return q(this,function(e){switch(e.label){case 0:if(!I(n))throw Error("You must supply absolute urls to AdalClient.fetch.");return[4,this.getToken(Q(n))];case 1:return t=e.sent(),this.token=t,[2,Ir.prototype.fetch.call(this,n,r)]}})})},Er.prototype.getToken=function(t){return M(this,void 0,void 0,function(){var n;return q(this,function(e){switch(e.label){case 0:return[4,this.ensureAuthContext()];case 1:return e.sent(),[4,this.login()];case 2:return e.sent(),n=null,Er._authContext.acquireToken(t,function(e,t){if(e)throw Error(e);n=t}),[2,n]}})})},Er.prototype.ensureAuthContext=function(){var t=this;return new Promise(function(e){null===Er._authContext&&(Er._authContext=Or.inject({clientId:t.clientId,displayCall:function(e){t._displayCallback&&t._displayCallback(e)},navigateToLoginRequestUrl:!1,redirectUri:t.redirectUri,tenant:t.tenant})),e()})},Er.prototype.login=function(){var o=this;return this._loginPromise||(this._loginPromise=new Promise(function(r,i){if(Er._authContext.getCachedUser())return r();o._displayCallback=function(e){var t=window.open(e,"login","width=483, height=600");if(!t)return i(Error("Could not open pop-up window for auth. Likely pop-ups are blocked by the browser."));t&&t.focus&&t.focus();var n=window.setInterval(function(){t&&!t.closed&&void 0!==t.closed||window.clearInterval(n);try{-1!==t.document.URL.indexOf(o.redirectUri)&&(window.clearInterval(n),Er._authContext.handleWindowCallback(t.location.hash),t.close(),r())}catch(e){i(e)}},30)},o.ensureAuthContext().then(function(e){Er._authContext._loginInProgress=!1,Er._authContext.login(),o._displayCallback=null})})),this._loginPromise},Er._authContext=null,Er);function Er(e,t,n){var r=Ir.call(this,null)||this;return r.clientId=e,r.tenant=t,r.redirectUri=n,r._displayCallback=null,r._loginPromise=null,r}function Rr(){}function Nr(s){return function(i,o){return M(this,void 0,void 0,function(){var t,n,r;return q(this,function(e){return t=Ye(i.data),n=T(t.batch)?t.batch.addDependency():function(){},r=i.toUrlAndQuery(),K(t.options,o),[2,s(Object.assign({},t,{batchDependency:n,url:r}))]})})}}function Ar(e,t){return Nr(ti("GET"))(e,t)}function Ur(e,t){return Nr(ti("POST"))(e,t)}function xr(e,t){return Nr(ti("DELETE"))(e,t)}function Dr(e,t){return Nr(ti("PATCH"))(e,t)}function Lr(e,t){return Nr(ti("PUT"))(e,t)}function kr(e){return Fe(e)}var Fr,Br,jr,Mr,qr,Gr,Wr,Vr,Hr,Kr,Qr,zr,Xr,Jr,$r,Yr,Zr=(Object.defineProperty(Ri.prototype,"headers",{get:function(){var e=L.get("graph");return null!=e&&void 0!==e.headers?e.headers:{}},enumerable:!0,configurable:!0}),Object.defineProperty(Ri.prototype,"fetchClientFactory",{get:function(){var e=L.get("graph");if(null!=e&&void 0!==e.fetchClientFactory)return e.fetchClientFactory;if(void 0!==L.spfxContext)return function(){return Cr.fromSPFxContext(L.spfxContext)};throw Error("There is no Graph Client available, either set one using configuraiton or provide a valid SPFx Context using setup.")},enumerable:!0,configurable:!0}),new Ri),ei=(Ei.prototype.fetch=function(e,t){void 0===t&&(t={});var n=new Headers;H(n,Zr.headers),H(n,t.headers),n.has("Content-Type")||n.append("Content-Type","application/json"),n.has("SdkVersion")||n.append("SdkVersion","PnPCoreJS/$$Version$$");var r=P(t,{headers:n});return this.fetchRaw(e,r)},Ei.prototype.fetchRaw=function(e,t){var r=this;void 0===t&&(t={});var n=new Headers;H(n,t.headers),t=P(t,{headers:n});var i=function(n){r._impl.fetch(e,t).then(function(e){return n.resolve(e)}).catch(function(e){429!==e.status&&503!==e.status&&504!==e.status&&n.reject(e);var t=n.delay;n.delay*=2,n.attempts++,n.retryCount<=n.attempts&&n.reject(e),setTimeout(f(r,i,n),t)})};return new Promise(function(e,t){var n={attempts:0,delay:100,reject:t,resolve:e,retryCount:7};i.call(r,n)})},Ei.prototype.get=function(e,t){void 0===t&&(t={});var n=P(t,{method:"GET"});return this.fetch(e,n)},Ei.prototype.post=function(e,t){void 0===t&&(t={});var n=P(t,{method:"POST"});return this.fetch(e,n)},Ei.prototype.patch=function(e,t){void 0===t&&(t={});var n=P(t,{method:"PATCH"});return this.fetch(e,n)},Ei.prototype.delete=function(e,t){void 0===t&&(t={});var n=P(t,{method:"DELETE"});return this.fetch(e,n)},Ei),ti=ct(function(){return new ei}),ni=(B(Ci,Xr=Ze),Ci.prototype.select=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return 0<e.length&&this.query.set("$select",e.join(",")),this},Ci.prototype.expand=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return 0<e.length&&this.query.set("$expand",e.join(",")),this},Ci.prototype.defaultAction=function(e){return Ar(this,e)},Ci.prototype.get=function(e){return Ar(this,e)},Ci.prototype.toUrlAndQuery=function(){var e,t=this.toUrl();return I(t)||(t=v("https://graph.microsoft.com",t)),0<this.query.size&&(e=-1<t.indexOf("?")?"&":"?",t+=e+Array.from(this.query).map(function(e){return e[0]+"="+e[1]}).join("&")),t},Ci.prototype.getParent=function(e,t,n){return void 0===t&&(t=this.parentUrl),new e(t,n)},Ci.prototype.clone=function(e,t,n){return void 0===n&&(n=!0),Xr.prototype.cloneTo.call(this,e(this,t),{includeBatch:n})},Ci.prototype.setEndpoint=function(e){return this.data.url=_r.ensure(this.data.url,e),this},Ci),ri=(kr(ni),B(Oi,zr=ni),Oi.prototype.filter=function(e){return this.query.set("$filter",e),this},Oi.prototype.orderBy=function(e,t){void 0===t&&(t=!0);var n="$orderby",r=this.query.has(n)?this.query.get(n).split(","):[];return r.push(e+" "+(t?"asc":"desc")),this.query.set(n,r.join(",")),this},Oi.prototype.top=function(e){return this.query.set("$top",e.toString()),this},Oi.prototype.skip=function(e){return this.query.set("$skip",e.toString()),this},Oi.prototype.skipToken=function(e){return this.query.set("$skiptoken",e),this},Object.defineProperty(Oi.prototype,"count",{get:function(){return this.query.set("$count","true"),this},enumerable:!0,configurable:!0}),Oi),ii=kr(ri),oi=(kr((B(_i,Qr=ri),_i.prototype.search=function(e){return this.query.set("$search",e),this},_i)),B(Ii,Kr=ni),Ii),si=kr(oi),ai=(B(Pi,Hr=ie),Pi.makeUrlRelative=function(e){if(!I(e))return e;var t=e.indexOf(".com/v1.0/");return t<0?-1<(t=e.indexOf(".com/beta/"))?e.substr(t+10):e:e.substr(t+9)},Pi.formatRequests=function(e){var i=this;return e.map(function(e,t){var n={id:""+ ++t,method:e.method,url:i.makeUrlRelative(e.url)},r={};return void 0!==Zr.headers&&null!==Zr.headers&&(r=P(r,Zr.headers)),void 0!==e.options&&(void 0!==e.options.headers&&null!==e.options.headers&&(r=P(r,e.options.headers)),"GET"!==e.method&&(r["Content-Type"]="application/json"),void 0!==e.options.body&&null!==e.options.body&&(n=P(n,{body:JSON.parse(e.options.body)}))),P(n,{headers:r})})},Pi.parseResponse=function(s,a){return new Promise(function(e,t){if(E(a,"error"))return t(Error("Error Porcessing Batch: ("+a.error.code+") "+a.error.message));for(var n=new Array(s.length).fill(null),r=0;r<a.responses.length;++r){var i=a.responses[r],o=parseInt(i.id,10)-1;204===i.status?n[o]=new Response:n[o]=new Response(JSON.stringify(i.body),i)}e({nextLink:a.nextLink,responses:n})})},Pi.prototype.executeImpl=function(){var e=this;if(y.write("["+this.batchId+"] ("+(new Date).getTime()+") Executing batch with "+this.requests.length+" requests.",1),this.requests.length<1)return y.write("Resolving empty batch.",1),Promise.resolve();var a=new ei,u=this.requests.slice(),c=!1;return new Promise(function(n,s){return M(e,void 0,void 0,function(){var t,r,o=this;return q(this,function(e){switch(e.label){case 0:t=function(){var i,t,n;return q(this,function(e){switch(e.label){case 0:return i=u.splice(0,r.maxRequests),t={requests:Pi.formatRequests(i)},n={body:C(t),headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST"},y.write("["+r.batchId+"] ("+(new Date).getTime()+") Sending batch request.",1),[4,a.fetch(r.batchUrl,n).then(function(e){return e.json()}).then(function(e){return Pi.parseResponse(i,e)}).then(function(e){y.write("["+o.batchId+"] ("+(new Date).getTime()+") Resolving batched requests.",1),e.responses.reduce(function(e,t,n){var r=i[n];return y.write("["+o.batchId+"] ("+(new Date).getTime()+") Resolving batched request "+r.method+" "+r.url+".",0),e.then(function(e){return r.parser.parse(t).then(r.resolve).catch(r.reject)})},Promise.resolve())}).catch(function(e){s(e),c=!0})];case 1:return e.sent(),c?[2,"break"]:[2]}})},r=this,e.label=1;case 1:return 0<u.length?[5,t()]:[3,3];case 2:return"break"===e.sent()?[3,3]:[3,1];case 3:return c||n(),[2]}})})})},Pi),ui=(B(wi,Vr=ni),wi.prototype.createBatch=function(){return new ai},wi.prototype.setup=function(e){L.assign(e)},wi),ci=new ui("v1.0"),li=(B(Ti,Wr=Ft),Ti.prototype.getByName=function(e){if(/\%#/.test(e))throw Error("For file names containing % or # please use web.getFileByServerRelativePath");return mt.configure(hi(this).concat("('"+un(e)+"')"),"fis.getByName")},Ti.prototype.add=function(t,n,r){return void 0===r&&(r=!0),M(this,void 0,void 0,function(){return q(this,function(e){switch(e.label){case 0:return[4,Rt(pi(this,"add(overwrite="+r+",url='"+un(t)+"')"),{body:n})];case 1:return[2,{data:e.sent(),file:this.getByName(t)}]}})})},Ti.prototype.addUsingPath=function(r,i,o){return void 0===o&&(o={Overwrite:!1}),M(this,void 0,void 0,function(){var t,n;return q(this,function(e){switch(e.label){case 0:return t=["AddUsingPath(decodedurl='"+un(r)+"'"],o&&(o.Overwrite&&t.push(",Overwrite=true"),o.AutoCheckoutOnInvalidData&&t.push(",AutoCheckoutOnInvalidData=true"),_(o.XorHash)||t.push(",XorHash="+un(o.XorHash))),t.push(")"),[4,Rt(pi(this,t.join("")),{body:i})];case 1:return[2,{data:n=e.sent(),file:hi(Qt(n))}]}})})},Ti.prototype.addChunked=function(t,n,r,i,o){return void 0===i&&(i=!0),void 0===o&&(o=10485760),M(this,void 0,void 0,function(){return q(this,function(e){switch(e.label){case 0:return[4,Rt(this.clone(pi,"add(overwrite="+i+",url='"+un(t)+"')",!1))];case 1:return e.sent(),[4,this.getByName(t).setContentChunked(n,r,o)];case 2:return[2,e.sent()]}})})},Ti.prototype.addTemplateFile=function(n,r){return M(this,void 0,void 0,function(){var t;return q(this,function(e){switch(e.label){case 0:return[4,Rt(this.clone(pi,"addTemplateFile(urloffile='"+un(n)+"',templatefiletype="+r+")",!1))];case 1:return[2,{data:t=e.sent(),file:hi(Qt(t))}]}})})},j([mt("fis.add")],Ti.prototype,"add",null),j([mt("fis.addUsingPath")],Ti.prototype,"addUsingPath",null),j([mt("fis.addChunked")],Ti.prototype,"addChunked",null),j([mt("fis.addTemplateFile")],Ti.prototype,"addTemplateFile",null),j([Kt("files")],Ti)),pi=Dt(li),di=(B(Si,Gr=jt),Object.defineProperty(Si.prototype,"listItemAllFields",{get:function(){return mt.configure(Mt(this,"listItemAllFields"),"fi.listItemAllFields")},enumerable:!0,configurable:!0}),Object.defineProperty(Si.prototype,"versions",{get:function(){return mt.configure(yi(this),"fi.versions")},enumerable:!0,configurable:!0}),Si.prototype.approve=function(e){return void 0===e&&(e=""),Rt(this.clone(hi,"approve(comment='"+un(e)+"')"))},Si.prototype.cancelUpload=function(e){return Rt(this.clone(hi,"cancelUpload(uploadId=guid'"+e+"')",!1))},Si.prototype.checkin=function(e,t){if(void 0===e&&(e=""),void 0===t&&(t=Fr.Major),1023<e.length)throw Error("The maximum comment length is 1023 characters.");return Rt(this.clone(hi,"checkin(comment='"+un(e)+"',checkintype="+t+")"))},Si.prototype.checkout=function(){return Rt(this.clone(hi,"checkout"))},Si.prototype.copyTo=function(e,t){return void 0===t&&(t=!0),Rt(this.clone(hi,"copyTo(strnewurl='"+un(e)+"',boverwrite="+t+")"))},Si.prototype.copyByPath=function(s,a,u){return void 0===u&&(u=!1),M(this,void 0,void 0,function(){var t,n,r,i,o;return q(this,function(e){switch(e.label){case 0:return[4,this.select("ServerRelativeUrl")()];case 1:return t=e.sent(),n=t.ServerRelativeUrl,r=t["odata.id"],i=vt(r),o=i.replace("://","___").split("/")[0].replace("___","://"),[4,Rt(hi(i,"/_api/SP.MoveCopyUtil.CopyFileByPath(overwrite=@a1)?@a1="+a),lt({destPath:Tn(I(s)?s:""+o+s),options:{KeepBoth:u,ResetAuthorAndCreatedOnCopy:!0,ShouldBypassSharedLocks:!0,__metadata:{type:"SP.MoveCopyOptions"}},srcPath:Tn(I(n)?n:""+o+n)}))];case 2:return e.sent(),[2]}})})},Si.prototype.deny=function(e){if(void 0===e&&(e=""),1023<e.length)throw Error("The maximum comment length is 1023 characters.");return Rt(this.clone(hi,"deny(comment='"+un(e)+"')"))},Si.prototype.moveTo=function(e,t){return void 0===t&&(t=Br.Overwrite),Rt(this.clone(hi,"moveTo(newurl='"+un(e)+"',flags="+t+")"))},Si.prototype.moveByPath=function(s,a,u){return void 0===u&&(u=!1),M(this,void 0,void 0,function(){var t,n,r,i,o;return q(this,function(e){switch(e.label){case 0:return[4,this.select("ServerRelativeUrl")()];case 1:return t=e.sent(),n=t.ServerRelativeUrl,r=t["odata.id"],i=vt(r),o=i.replace("://","___").split("/")[0].replace("___","://"),[4,Rt(hi(i,"/_api/SP.MoveCopyUtil.MoveFileByPath(overwrite=@a1)?@a1="+a),lt({destPath:Tn(I(s)?s:""+o+s),options:{KeepBoth:u,ResetAuthorAndCreatedOnCopy:!1,ShouldBypassSharedLocks:!0,__metadata:{type:"SP.MoveCopyOptions"}},srcPath:Tn(I(n)?n:""+o+n)}))];case 2:return e.sent(),[2]}})})},Si.prototype.publish=function(e){if(void 0===e&&(e=""),1023<e.length)throw Error("The maximum comment length is 1023 characters.");return Rt(this.clone(hi,"publish(comment='"+un(e)+"')"))},Si.prototype.recycle=function(){return Rt(this.clone(hi,"recycle"))},Si.prototype.undoCheckout=function(){return Rt(this.clone(hi,"undoCheckout"))},Si.prototype.unpublish=function(e){if(void 0===e&&(e=""),1023<e.length)throw Error("The maximum comment length is 1023 characters.");return Rt(this.clone(hi,"unpublish(comment='"+un(e)+"')"))},Si.prototype.getText=function(){return this.clone(hi,"$value",!1).usingParser(new je)(pt({binaryStringResponseBody:"true"}))},Si.prototype.getBlob=function(){return this.clone(hi,"$value",!1).usingParser(new Me)(pt({binaryStringResponseBody:"true"}))},Si.prototype.getBuffer=function(){return this.clone(hi,"$value",!1).usingParser(new Ge)(pt({binaryStringResponseBody:"true"}))},Si.prototype.getJSON=function(){return this.clone(hi,"$value",!1).usingParser(new qe)(pt({binaryStringResponseBody:"true"}))},Si.prototype.setContent=function(t){return M(this,void 0,void 0,function(){return q(this,function(e){switch(e.label){case 0:return[4,Rt(this.clone(hi,"$value",!1),{body:t,headers:{"X-HTTP-Method":"PUT"}})];case 1:return e.sent(),[2,hi(this)]}})})},Si.prototype.getItem=function(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];return M(this,void 0,void 0,function(){var t,n;return q(this,function(e){switch(e.label){case 0:return[4,(t=this.listItemAllFields).select.apply(t,r)()];case 1:return n=e.sent(),[2,P(Wn(Qt(n)),n)]}})})},Si.prototype.setContentChunked=function(s,a,u){return void 0===u&&(u=10485760),M(this,void 0,void 0,function(){var t,n,r,i,o;return q(this,function(e){switch(e.label){case 0:return S(a)||(a=function(){return null}),t=s.size,n=parseInt((t/u).toString(),10)+(t%u==0?1:0),r=b(),a({uploadId:r,blockNumber:1,chunkSize:u,currentPointer:0,fileSize:t,stage:"starting",totalBlocks:n}),[4,this.startUpload(r,s.slice(0,u))];case 1:i=e.sent(),o=2,e.label=2;case 2:return o<n?(a({uploadId:r,blockNumber:o,chunkSize:u,currentPointer:i,fileSize:t,stage:"continue",totalBlocks:n}),[4,this.continueUpload(r,i,s.slice(i,i+u))]):[3,5];case 3:i=e.sent(),e.label=4;case 4:return o++,[3,2];case 5:return a({uploadId:r,blockNumber:n,chunkSize:u,currentPointer:i,fileSize:t,stage:"finishing",totalBlocks:n}),[2,this.finishUpload(r,i,s.slice(i))]}})})},Si.prototype.startUpload=function(n,r){return M(this,void 0,void 0,function(){var t;return q(this,function(e){switch(e.label){case 0:return[4,Rt(this.clone(hi,"startUpload(uploadId=guid'"+n+"')",!1),{body:r})];case 1:return"object"==typeof(t=e.sent())&&(t=t.StartUpload),[2,parseFloat(t)]}})})},Si.prototype.continueUpload=function(n,r,i){return M(this,void 0,void 0,function(){var t;return q(this,function(e){switch(e.label){case 0:return[4,Rt(this.clone(hi,"continueUpload(uploadId=guid'"+n+"',fileOffset="+r+")",!1),{body:i})];case 1:return"object"==typeof(t=e.sent())&&(t=t.ContinueUpload),[2,parseFloat(t)]}})})},Si.prototype.finishUpload=function(n,r,i){return M(this,void 0,void 0,function(){var t;return q(this,function(e){switch(e.label){case 0:return[4,Rt(this.clone(hi,"finishUpload(uploadId=guid'"+n+"',fileOffset="+r+")",!1),{body:i})];case 1:return[2,{data:t=e.sent(),file:hi(Qt(t))}]}})})},j([mt("fi.approve")],Si.prototype,"approve",null),j([mt("fi.cancelUpload")],Si.prototype,"cancelUpload",null),j([mt("fi.checkin")],Si.prototype,"checkin",null),j([mt("fi.checkout")],Si.prototype,"checkout",null),j([mt("fi.copyTo")],Si.prototype,"copyTo",null),j([mt("fi.copyByPath")],Si.prototype,"copyByPath",null),j([mt("fi.deny")],Si.prototype,"deny",null),j([mt("fi.moveTo")],Si.prototype,"moveTo",null),j([mt("fi.moveByPath")],Si.prototype,"moveByPath",null),j([mt("fi.publish")],Si.prototype,"publish",null),j([mt("fi.recycle")],Si.prototype,"recycle",null),j([mt("fi.undoCheckout")],Si.prototype,"undoCheckout",null),j([mt("fi.unpublish")],Si.prototype,"unpublish",null),j([mt("fi.getText")],Si.prototype,"getText",null),j([mt("fi.getBlob")],Si.prototype,"getBlob",null),j([mt("fi.getBuffer")],Si.prototype,"getBuffer",null),j([mt("fi.getJSON")],Si.prototype,"getJSON",null),j([mt("fi.setContent")],Si.prototype,"setContent",null),j([mt("fi.getItem")],Si.prototype,"getItem",null),j([mt("fi.startUpload")],Si.prototype,"startUpload",null),j([mt("fi.continueUpload")],Si.prototype,"continueUpload",null),j([mt("fi.finishUpload")],Si.prototype,"finishUpload",null),Si),hi=Dt(di),fi=(B(bi,qr=Ft),bi.prototype.getById=function(e){return mt.configure(vi(this).concat("("+e+")"),"vers.getById")},bi.prototype.deleteAll=function(){return Rt(yi(this,"deleteAll"))},bi.prototype.deleteById=function(e){return Rt(this.clone(yi,"deleteById(vid="+e+")"))},bi.prototype.recycleByID=function(e){return Rt(this.clone(yi,"recycleByID(vid="+e+")"))},bi.prototype.deleteByLabel=function(e){return Rt(this.clone(yi,"deleteByLabel(versionlabel='"+un(e)+"')"))},bi.prototype.recycleByLabel=function(e){return Rt(this.clone(yi,"recycleByLabel(versionlabel='"+un(e)+"')"))},bi.prototype.restoreByLabel=function(e){return Rt(this.clone(yi,"restoreByLabel(versionlabel='"+un(e)+"')"))},j([mt("vers.deleteAll")],bi.prototype,"deleteAll",null),j([mt("vers.deleteById")],bi.prototype,"deleteById",null),j([mt("vers.recycleByID")],bi.prototype,"recycleByID",null),j([mt("vers.deleteByLabel")],bi.prototype,"deleteByLabel",null),j([mt("vers.recycleByLabel")],bi.prototype,"recycleByLabel",null),j([mt("vers.restoreByLabel")],bi.prototype,"restoreByLabel",null),j([Kt("versions")],bi)),yi=Dt(fi),gi=(B(mi,Mr=jt),mi),vi=Dt(gi);function mi(){var e=null!==Mr&&Mr.apply(this,arguments)||this;return e.delete=Ht("ver"),e}function bi(){return null!==qr&&qr.apply(this,arguments)||this}function Si(){var e=null!==Gr&&Gr.apply(this,arguments)||this;return e.delete=Ht("fi"),e}function Ti(){return null!==Wr&&Wr.apply(this,arguments)||this}function wi(){return null!==Vr&&Vr.apply(this,arguments)||this}function Pi(e,t){void 0===e&&(e="https://graph.microsoft.com/v1.0/$batch"),void 0===t&&(t=20);var n=Hr.call(this)||this;return n.batchUrl=e,n.maxRequests=t,n}function Ii(){return null!==Kr&&Kr.apply(this,arguments)||this}function _i(){return null!==Qr&&Qr.apply(this,arguments)||this}function Oi(){return null!==zr&&zr.apply(this,arguments)||this}function Ci(e,t){var n,r=this,i=new Map,o=v(n="string"==typeof e?e:e.toUrl(),t),r=Xr.call(this,{parentUrl:n,query:i,url:o})||this;return"string"!=typeof e&&r.configureFrom(e),r}function Ei(){this._impl=Zr.fetchClientFactory()}function Ri(){}(Yr=Fr=Fr||{})[Yr.Minor=0]="Minor",Yr[Yr.Major=1]="Major",Yr[Yr.Overwrite=2]="Overwrite",($r=Br=Br||{})[$r.Overwrite=1]="Overwrite",$r[$r.AllowBrokenThickets=8]="AllowBrokenThickets",(Jr=jr=jr||{})[Jr.StandardPage=0]="StandardPage",Jr[Jr.WikiPage=1]="WikiPage",Jr[Jr.FormPage=2]="FormPage",Jr[Jr.ClientSidePage=3]="ClientSidePage";var Ni,Ai,Ui=(B(Fi,Ai=Ft),Fi.prototype.getAppById=function(e){return mt.configure(Li(this,"getById('"+e+"')"),"ac.getAppById")},Fi.prototype.syncSolutionToTeams=function(a,u){return void 0===u&&(u=!1),M(this,void 0,void 0,function(){var t,n,r,i,o,s;return q(this,function(e){switch(e.label){case 0:return t=null,n=vt(this.toUrl()),u?(t=a,[3,4]):[3,1];case 1:return[4,(r=mn(n)).lists.select("Id").filter("EntityTypeName eq 'AppCatalog'")()];case 2:return i=e.sent()[0].Id,[4,r.lists.getById(i).items.filter("AppProductID eq '"+a+"'").top(1)()];case 3:if(!((o=e.sent())&&0<o.length))throw Error("Did not find the app with id "+a+" in the appcatalog.");t=o[0].Id,e.label=4;case 4:return s=mt.configure(xi(n,"_api/web/tenantappcatalog/SyncSolutionToTeams(id="+t+")"),"ac.syncSolutionToTeams"),[4,Rt(s,{})];case 5:return[2,e.sent()]}})})},Fi.prototype.add=function(r,i,o){return void 0===o&&(o=!0),M(this,void 0,void 0,function(){var t,n;return q(this,function(e){switch(e.label){case 0:return t=mt.configure(xi(vt(this.toUrl()),"_api/web/tenantappcatalog/add(overwrite="+o+",url='"+r+"')"),"ac.add"),[4,Rt(t,{body:i,headers:{binaryStringRequestBody:"true"}})];case 1:return[2,{data:n=e.sent(),file:hi(Qt(n))}]}})})},Fi),xi=Dt(Ui),Di=(B(ki,Ni=jt),ki.prototype.deploy=function(e){return void 0===e&&(e=!1),this.do("Deploy("+e+")")},ki.prototype.retract=function(){return this.do("Retract")},ki.prototype.install=function(){return this.do("Install")},ki.prototype.uninstall=function(){return this.do("Uninstall")},ki.prototype.upgrade=function(){return this.do("Upgrade")},ki.prototype.remove=function(){return this.do("Remove")},ki.prototype.do=function(e){return Rt(this.clone(Li,e))},j([mt("app.deploy")],ki.prototype,"deploy",null),j([mt("app.retract")],ki.prototype,"retract",null),j([mt("app.install")],ki.prototype,"install",null),j([mt("app.uninstall")],ki.prototype,"uninstall",null),j([mt("app.upgrade")],ki.prototype,"upgrade",null),j([mt("app.remove")],ki.prototype,"remove",null),ki),Li=Dt(Di);function ki(){return null!==Ni&&Ni.apply(this,arguments)||this}function Fi(e,t){return void 0===t&&(t="_api/web/tenantappcatalog/AvailableApps"),Ai.call(this,vt("string"==typeof e?e:e.toUrl()),t)||this}vn.prototype.getAppCatalog=function(e){return xi(e||this)},on.prototype.getTenantAppCatalogWeb=function(){return M(this,void 0,void 0,function(){var t;return q(this,function(e){switch(e.label){case 0:return[4,kt("/","_api/SP_TenantSettings_Current")()];case 1:return t=e.sent(),[2,mn(t.CorporateCatalogUrl)]}})})};var Bi,ji,Mi=(B(Hi,ji=Ft),Hi.prototype.getByName=function(e){var t=mt.configure(Wi(this),"ats.getByName");return t.concat("('"+e+"')"),t},Hi.prototype.add=function(t,n){return M(this,void 0,void 0,function(){return q(this,function(e){switch(e.label){case 0:return[4,Rt(this.clone(qi,"add(FileName='"+t+"')",!1),{body:n})];case 1:return[2,{data:e.sent(),file:this.getByName(t)}]}})})},Hi.prototype.addMultiple=function(n){return M(this,void 0,void 0,function(){var t;return q(this,function(e){switch(e.label){case 0:t=0,e.label=1;case 1:return t<n.length?[4,this.add(n[t].name,n[t].content)]:[3,4];case 2:e.sent(),e.label=3;case 3:return t++,[3,1];case 4:return[2]}})})},Hi.prototype.deleteMultiple=function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return M(this,void 0,void 0,function(){var t;return q(this,function(e){switch(e.label){case 0:t=0,e.label=1;case 1:return t<n.length?[4,this.getByName(n[t]).delete()]:[3,4];case 2:e.sent(),e.label=3;case 3:return t++,[3,1];case 4:return[2]}})})},Hi.prototype.recycleMultiple=function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return M(this,void 0,void 0,function(){var t;return q(this,function(e){switch(e.label){case 0:t=0,e.label=1;case 1:return t<n.length?[4,this.getByName(n[t]).recycle()]:[3,4];case 2:e.sent(),e.label=3;case 3:return t++,[3,1];case 4:return[2]}})})},j([mt("ats.add")],Hi.prototype,"add",null),j([mt("ats.addMultiple")],Hi.prototype,"addMultiple",null),j([mt("ats.deleteMultiple")],Hi.prototype,"deleteMultiple",null),j([mt("ats.recycleMultiple")],Hi.prototype,"recycleMultiple",null),j([Kt("AttachmentFiles")],Hi)),qi=Dt(Mi),Gi=(B(Vi,Bi=jt),Vi.prototype.getText=function(){return this.getParsed(new je)},Vi.prototype.getBlob=function(){return this.getParsed(new Me)},Vi.prototype.getBuffer=function(){return this.getParsed(new Ge)},Vi.prototype.getJSON=function(){return this.getParsed(new qe)},Vi.prototype.setContent=function(t){return M(this,void 0,void 0,function(){return q(this,function(e){switch(e.label){case 0:return[4,Rt(this.clone(Wi,"$value",!1),pt({"X-HTTP-Method":"PUT"},{body:t}))];case 1:return e.sent(),[2,Wi(this)]}})})},Vi.prototype.recycle=function(e){return void 0===e&&(e="*"),Rt(this.clone(Wi,"recycleObject"),pt({"IF-Match":e,"X-HTTP-Method":"DELETE"}))},Vi.prototype.getParsed=function(e){return this.clone(Wi,"$value",!1).usingParser(e)()},j([mt("at.getText")],Vi.prototype,"getText",null),j([mt("at.getBlob")],Vi.prototype,"getBlob",null),j([mt("at.getBuffer")],Vi.prototype,"getBuffer",null),j([mt("at.getJSON")],Vi.prototype,"getJSON",null),j([mt("at.setContent")],Vi.prototype,"setContent",null),j([mt("at.recycle")],Vi.prototype,"recycle",null),Vi),Wi=Dt(Gi);function Vi(){var e=null!==Bi&&Bi.apply(this,arguments)||this;return e.delete=Ht("at"),e}function Hi(){return null!==ji&&ji.apply(this,arguments)||this}function Ki(e){return e.length<1?1:Math.max.apply(null,e.map(function(e){return e.order}))+1}function Qi(e){for(var t=0;t<e.length;t++)e[t].order=t+1,E(e[t],"columns")?Qi(e[t].columns):E(e[t],"controls")&&Qi(e[t].controls)}me(Gn,"attachmentFiles",qi),vn.prototype.getFileByServerRelativeUrl=function(e){return hi(this,"getFileByServerRelativeUrl('"+un(e)+"')")},vn.prototype.getFileByServerRelativePath=function(e){return hi(this,"getFileByServerRelativePath(decodedUrl='"+un(e)+"')")},vn.prototype.getFileById=function(e){return hi(this,"getFileById('"+e+"')")},vn.prototype.getFileByUrl=function(e){return hi(this,"getFileByUrl('!@p1::"+un(e)+"')")};var zi,Xi,Ji,$i,Yi,Zi=(B(ao,$i=Ft),ao.prototype.add=function(r){return M(this,void 0,void 0,function(){var t,n;return q(this,function(e){switch(e.label){case 0:return"string"==typeof r&&(r={text:r}),t=lt(P(dt("Microsoft.SharePoint.Comments.comment"),r)),[4,Rt(this.clone(eo,null),t)];case 1:return n=e.sent(),[2,P(this.getById(n.id),n)]}})})},ao.prototype.getById=function(e){return mt.configure(no(this).concat("("+e+")"),"coms.getById")},ao.prototype.clear=function(){return Rt(mt.configure(this.clone(eo,"DeleteAll"),"coms.clear"))},j([mt("coms.add")],ao.prototype,"add",null),j([Kt("comments")],ao)),eo=Dt(Zi),to=(B(so,Ji=jt),Object.defineProperty(so.prototype,"replies",{get:function(){return mt.configure(io(this),"com.replies")},enumerable:!0,configurable:!0}),so.prototype.like=function(){return Rt(this.clone(no,"Like"))},so.prototype.unlike=function(){return Rt(this.clone(no,"Unlike"))},so.prototype.delete=function(){return Rt(this.clone(no,"DeleteComment"))},j([mt("com.like")],so.prototype,"like",null),j([mt("com.unlike")],so.prototype,"unlike",null),j([mt("com.delete")],so.prototype,"delete",null),so),no=Dt(to),ro=(B(oo,Xi=Ft),oo.prototype.add=function(r){return M(this,void 0,void 0,function(){var t,n;return q(this,function(e){switch(e.label){case 0:return"string"==typeof r&&(r={text:r}),t=lt(P(dt("Microsoft.SharePoint.Comments.comment"),r)),[4,Rt(this.clone(io,null),t)];case 1:return n=e.sent(),[2,P(no(Qt(n)),n)]}})})},j([mt("reps.add")],oo.prototype,"add",null),j([Kt("replies")],oo)),io=Dt(ro);function oo(){return null!==Xi&&Xi.apply(this,arguments)||this}function so(){return null!==Ji&&Ji.apply(this,arguments)||this}function ao(){return null!==$i&&$i.apply(this,arguments)||this}function uo(e,t){return fo(vt(e.toUrl()),t).configureFrom(e)}me(Gn,"comments",eo),Gn.prototype.getLikedBy=function(){return Rt(this.clone(Wn,"likedBy"))},Gn.prototype.like=function(){return Rt(this.clone(Wn,"like"))},Gn.prototype.unlike=function(){return Rt(this.clone(Wn,"unlike"))},Gn.prototype.getLikedByInformation=function(){return this.clone(Wn,"likedByInformation").expand("likedby")()},(Yi=zi=zi||{})[Yi.NotPromoted=0]="NotPromoted",Yi[Yi.PromoteOnPublish=1]="PromoteOnPublish",Yi[Yi.Promoted=2]="Promoted";var co,lo,po,ho=(B(Co,po=Lt),Co.getDefaultLayoutPart=function(){return{dataVersion:"1.4",description:"Title Region Description",id:"cbe7b0a9-3504-44dd-a3a3-0e5cacd07788",instanceId:"cbe7b0a9-3504-44dd-a3a3-0e5cacd07788",properties:{authorByline:[],authors:[],layoutType:"FullWidthImage",showPublishDate:!1,showTopicHeader:!1,textAlignment:"Left",title:"",topicHeader:""},serverProcessedContent:{htmlStrings:{},searchablePlainTexts:{},imageSources:{},links:{}},title:"Title area"}},Object.defineProperty(Co.prototype,"pageLayout",{get:function(){return this.json.PageLayoutType},set:function(e){this.json.PageLayoutType=e},enumerable:!0,configurable:!0}),Object.defineProperty(Co.prototype,"bannerImageUrl",{get:function(){return this.json.BannerImageUrl},set:function(e){this.json.BannerImageUrl=e,this._bannerImageDirty=!0},enumerable:!0,configurable:!0}),Object.defineProperty(Co.prototype,"topicHeader",{get:function(){return T(this.json.TopicHeader)?this.json.TopicHeader:""},set:function(e){this.json.TopicHeader=e,_(this._layoutPart.properties.topicHeader=e)&&(this.showTopicHeader=!1)},enumerable:!0,configurable:!0}),Object.defineProperty(Co.prototype,"title",{get:function(){return this._layoutPart.properties.title},set:function(e){this.json.Title=e,this._layoutPart.properties.title=e},enumerable:!0,configurable:!0}),Object.defineProperty(Co.prototype,"layoutType",{get:function(){return this._layoutPart.properties.layoutType},set:function(e){this._layoutPart.properties.layoutType=e},enumerable:!0,configurable:!0}),Object.defineProperty(Co.prototype,"headerTextAlignment",{get:function(){return this._layoutPart.properties.textAlignment},set:function(e){this._layoutPart.properties.textAlignment=e},enumerable:!0,configurable:!0}),Object.defineProperty(Co.prototype,"showTopicHeader",{get:function(){return this._layoutPart.properties.showTopicHeader},set:function(e){this._layoutPart.properties.showTopicHeader=e},enumerable:!0,configurable:!0}),Object.defineProperty(Co.prototype,"showPublishDate",{get:function(){return this._layoutPart.properties.showPublishDate},set:function(e){this._layoutPart.properties.showPublishDate=e},enumerable:!0,configurable:!0}),Object.defineProperty(Co.prototype,"hasVerticalSection",{get:function(){return-1<this.sections.findIndex(function(e){return 2===e.layoutIndex})},enumerable:!0,configurable:!0}),Object.defineProperty(Co.prototype,"authorByLine",{get:function(){return w(this.json.AuthorByline)&&0<this.json.AuthorByline.length?this.json.AuthorByline[0]:null},enumerable:!0,configurable:!0}),Object.defineProperty(Co.prototype,"verticalSection",{get:function(){return this.hasVerticalSection?this.addVerticalSection():null},enumerable:!0,configurable:!0}),Co.prototype.addSection=function(){var e=new vo(this,Ki(this.sections),1);return this.sections.push(e),e},Co.prototype.addVerticalSection=function(){var e=this.sections.findIndex(function(e){return 2===e.layoutIndex});if(-1<e)return this.sections[e];var t=new vo(this,Ki(this.sections),2);return this.sections.push(t),t},Co.prototype.fromJSON=function(e){this.json=e;var t=JSON.parse(e.CanvasContent1),n=JSON.parse(e.LayoutWebpartsContent);return n&&0<n.length&&(this._layoutPart=n[0]),this.setControls(t),this},Co.prototype.load=function(){return M(this,void 0,void 0,function(){var t,n;return q(this,function(e){switch(e.label){case 0:return[4,this.getItem("Id","CommentsDisabled")];case 1:return t=e.sent(),[4,kt(this,"_api/sitepages/pages("+t.Id+")")()];case 2:return n=e.sent(),this.commentsDisabled=t.CommentsDisabled,[2,this.fromJSON(n)]}})})},Co.prototype.save=function(y){return void 0===y&&(y=!0),M(this,void 0,void 0,function(){var t,n,r,i,o,s,a,u,c,l,p,d,h,f;return q(this,function(e){switch(e.label){case 0:if(null===this.json.Id)throw Error("The id for this page is null. If you want to create a new page, please use ClientSidePage.Create");return this._bannerImageDirty?(I(t=this.json.BannerImageUrl)&&(t=t.replace(/^https?:\/\/[a-z0-9\.]*?\.[a-z]{2,3}\//i,"/")),n=pn(vt(this.toUrl())),r=mn(vt(this.toUrl())),i=r.getFileByServerRelativePath(t),c=u=a=s=o="",l=r.createBatch(),n.select("Id","Url").inBatch(l)().then(function(e){return o=e.Id}),r.select("Id","Url").inBatch(l)().then(function(e){s=e.Id,c=e.Url}),i.listItemAllFields.select("UniqueId","ParentList/Id").expand("ParentList").inBatch(l)().then(function(e){a=e.UniqueId,u=e.ParentList.Id}),[4,l.execute()]):[3,2];case 1:e.sent(),(p=kt(c,"_layouts/15/getpreview.ashx")).query.set("guidSite",""+o),p.query.set("guidWeb",""+s),p.query.set("guidFile",""+a),this.bannerImageUrl=p.toUrlAndQuery(),T(this._layoutPart.serverProcessedContent)||(this._layoutPart.serverProcessedContent={}),this._layoutPart.serverProcessedContent.imageSources={imageSource:t},T(this._layoutPart.serverProcessedContent.customMetadata)||(this._layoutPart.serverProcessedContent.customMetadata={}),this._layoutPart.serverProcessedContent.customMetadata.imageSource={listId:u,siteId:o,uniqueId:a,webId:s},this._layoutPart.properties.webId=s,this._layoutPart.properties.siteId=o,this._layoutPart.properties.listId=u,this._layoutPart.properties.uniqueId=a,e.label=2;case 2:return this.json.IsPageCheckedOutToCurrentUser?[3,4]:[4,Rt(uo(this,"_api/sitepages/pages("+this.json.Id+")/checkoutpage"))];case 3:e.sent(),e.label=4;case 4:return d=Object.assign(dt("SP.Publishing.SitePage"),{AuthorByline:this.json.AuthorByline||[],BannerImageUrl:this.bannerImageUrl,CanvasContent1:this.getCanvasContent1(),LayoutWebpartsContent:this.getLayoutWebpartsContent(),Title:this.title,TopicHeader:this.topicHeader}),h=uo(this,"_api/sitepages/pages("+this.json.Id+")/savepage"),[4,Rt(h,pt({"if-match":"*"},lt(d)))];case 5:return e.sent(),f=!0,y?[4,Rt(uo(this,"_api/sitepages/pages("+this.json.Id+")/publish"))]:[3,7];case 6:(f=e.sent())&&(this.json.IsPageCheckedOutToCurrentUser=!1),e.label=7;case 7:return this._bannerImageDirty=!1,[2,f]}})})},Co.prototype.discardPageCheckout=function(){return M(this,void 0,void 0,function(){var t;return q(this,function(e){switch(e.label){case 0:if(null===this.json.Id)throw Error("The id for this page is null. If you want to create a new page, please use ClientSidePage.Create");return[4,Rt(uo(this,"_api/sitepages/pages("+this.json.Id+")/discardPage"),lt(dt("SP.Publishing.SitePage")))];case 1:return t=e.sent(),this.fromJSON(t),[2]}})})},Co.prototype.promoteToNews=function(){return M(this,void 0,void 0,function(){return q(this,function(e){return[2,this.promoteNewsImpl("promoteToNews")]})})},Co.prototype.findControlById=function(t){return this.findControl(function(e){return e.id===t})},Co.prototype.findControl=function(e){for(var t=0;t<this.sections.length;t++)for(var n=0;n<this.sections[t].columns.length;n++)for(var r=0;r<this.sections[t].columns[n].controls.length;r++)if(e(this.sections[t].columns[n].controls[r]))return this.sections[t].columns[n].controls[r];return null},Co.prototype.copy=function(l,p,d,h,f){return void 0===h&&(h=!0),M(this,void 0,void 0,function(){var t,n,r,i,o,s,a,u,c;return q(this,function(e){switch(e.label){case 0:return[4,go(l,p,d,this.pageLayout,f)];case 1:return(t=e.sent()).setControls(this.getControls()),_(this.json.BannerImageUrl)?[3,5]:(n=new URL(this.json.BannerImageUrl),r=function(e){return e.replace(/(.{8})(.{4})(.{4})(.{4})(.{12})/g,"$1-$2-$3-$4-$5")},n.searchParams.has("guidSite")&&n.searchParams.has("guidWeb")&&n.searchParams.has("guidFile")?(i=r(n.searchParams.get("guidSite")),o=r(n.searchParams.get("guidWeb")),s=r(n.searchParams.get("guidFile")),[4,(a=pn(vt(this.toUrl()))).select("Id")()]):[3,5]);case 2:return e.sent().Id!==i?[3,5]:[4,a.openWebById(o)];case 3:return[4,e.sent().web.getFileById(s).select("ServerRelativeUrl")()];case 4:u=e.sent(),c={},this._layoutPart.properties&&(E(this._layoutPart.properties,"translateX")&&(c.translateX=this._layoutPart.properties.translateX),E(this._layoutPart.properties,"translateY")&&(c.translateY=this._layoutPart.properties.translateY),E(this._layoutPart.properties,"imageSourceType")&&(c.imageSourceType=this._layoutPart.properties.imageSourceType),E(this._layoutPart.properties,"altText")&&(c.altText=this._layoutPart.properties.altText)),t.setBannerImage(u.ServerRelativeUrl,c),e.label=5;case 5:return[4,t.save(h)];case 6:return e.sent(),[2,t]}})})},Co.prototype.setBannerImage=function(e,t){this.bannerImageUrl=e,this._layoutPart.properties.imageSourceType=2,T(t)&&(E(t,"translateX")&&(this._layoutPart.properties.translateX=t.translateX),E(t,"translateY")&&(this._layoutPart.properties.translateY=t.translateY),E(t,"imageSourceType")&&(this._layoutPart.properties.imageSourceType=t.imageSourceType),E(t,"altText")&&(this._layoutPart.properties.altText=t.altText))},Co.prototype.setAuthorById=function(n){return M(this,void 0,void 0,function(){var t;return q(this,function(e){switch(e.label){case 0:return[4,Bt(vt(this.toUrl()),"/_api/web/siteusers").configureFrom(this).filter("Id eq "+n).select("LoginName")()];case 1:if((t=e.sent()).length<1)throw Error("Could not find user with id "+n+".");return[2,this.setAuthorByLoginName(t[0].LoginName)]}})})},Co.prototype.setAuthorByLoginName=function(n){return M(this,void 0,void 0,function(){var t;return q(this,function(e){switch(e.label){case 0:return[4,Bt(vt(this.toUrl()),"/_api/web/siteusers").configureFrom(this).filter("LoginName eq '"+encodeURIComponent(n)+"'").select("UserPrincipalName","Title")()];case 1:if((t=e.sent()).length<1)throw Error("Could not find user with login name '"+n+"'.");return this.json.AuthorByline=[n],this._layoutPart.properties.authorByline=[n],this._layoutPart.properties.authors=[{id:n,name:t[0].Title,role:"",upn:t[0].UserPrincipalName}],[2]}})})},Co.prototype.getItem=function(){for(var o=[],e=0;e<arguments.length;e++)o[e]=arguments[e];return M(this,void 0,void 0,function(){var t,n,r,i;return q(this,function(e){switch(e.label){case 0:return t=uo(this,"/_api/lists/EnsureClientRenderedSitePagesLibrary").select("EnableModeration","EnableMinorVersions","Id"),[4,Rt(t)];case 1:return n=e.sent(),[4,(r=An(n["odata.id"]).configureFrom(this).items.getById(this.json.Id)).select.apply(r,o)()];case 2:return i=e.sent(),[2,P(Wn(Qt(i)).configureFrom(this),i)]}})})},Co.prototype.assign=function(e,t){this.data.parentUrl=e.data.url,this.data.url=v(this.data.parentUrl,t||""),this.configureFrom(e)},Co.prototype.getCanvasContent1=function(){return JSON.stringify(this.getControls())},Co.prototype.getLayoutWebpartsContent=function(){return this._layoutPart?JSON.stringify([this._layoutPart]):JSON.stringify(null)},Co.prototype.setControls=function(e){if(e&&e.length){for(var t=0;t<e.length;t++)switch(E(e[t],"controlType")?e[t].controlType:0){case 0:E(e[t],"pageSettingsSlice")?this._pageSettings=e[t]:this.mergeColumnToTree(new mo(e[t]));break;case 3:var n=new To(e[t]);this.mergePartToTree(n,n.data.position);break;case 4:var r=e[t],i=new So(r.innerHTML,r);this.mergePartToTree(i,i.data.position)}Qi(this.sections)}},Co.prototype.getControls=function(){var n=this;Qi(this.sections);var r=[];return this.sections.forEach(function(t){t.columns.forEach(function(e){e.controls.length<1?r.push({displayMode:e.data.displayMode,emphasis:n.getEmphasisObj(t.emphasis),position:e.data.position}):e.controls.forEach(function(e){e.data.emphasis=n.getEmphasisObj(t.emphasis),r.push(e.data)})})}),r.push(this._pageSettings),r},Co.prototype.getEmphasisObj=function(e){return e<1||3<e?{}:{zoneEmphasis:e}},Co.prototype.promoteNewsImpl=function(t){return M(this,void 0,void 0,function(){return q(this,function(e){switch(e.label){case 0:if(null===this.json.Id)throw Error("The id for this page is null.");return _(this.json.VersionInfo.LastVersionCreatedBy)&&new Date(this.json.VersionInfo.LastVersionCreated).getFullYear()<2e3?[4,this.save(!0)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[4,Rt(uo(this,"_api/sitepages/pages("+this.json.Id+")/"+t),lt(dt("SP.Publishing.SitePage")))];case 3:return[2,e.sent()]}})})},Co.prototype.mergePartToTree=function(e,t){var n,r,i,o=null,s=12,a=0,u=0,c=1;t&&(E(t,"zoneIndex")&&(u=t.zoneIndex),E(t,"sectionIndex")&&(a=t.sectionIndex),E(t,"sectionFactor")&&(s=t.sectionFactor),E(t,"layoutIndex")&&(c=t.layoutIndex));var l=null!=(i=null===(r=null===(n=e.data)||void 0===n?void 0:n.emphasis)||void 0===r?void 0:r.zoneEmphasis)?i:0,p=this.getOrCreateSection(u,c,l),d=p.columns.filter(function(e){return e.order===a}),o=d.length<1?p.addColumn(s,c):d[0];(e.column=o).addControl(e)},Co.prototype.mergeColumnToTree=function(e){var t=E(e.data,"position")&&E(e.data.position,"zoneIndex")?e.data.position.zoneIndex:0,n=E(e.data,"position")&&E(e.data.position,"layoutIndex")?e.data.position.layoutIndex:1,r=this.getOrCreateSection(t,n,e.data.emphasis.zoneEmphasis||0);(e.section=r).columns.push(e)},Co.prototype.getOrCreateSection=function(t,n,e){var r=null,i=this.sections.filter(function(e){return e.order===t&&e.layoutIndex===n});return i.length<1?((r=2===n?this.addVerticalSection():this.addSection()).order=t,r.emphasis=e):r=i[0],r},j([mt("csp.load")],Co.prototype,"load",null),j([mt("csp.save")],Co.prototype,"save",null),j([mt("csp.discardPageCheckout")],Co.prototype,"discardPageCheckout",null),j([mt("csp.promoteToNews")],Co.prototype,"promoteToNews",null),j([mt("csp.copy")],Co.prototype,"copy",null),j([mt("csp.getItem")],Co.prototype,"getItem",null),Co),fo=function(e,t,n,r,i,o){return void 0===r&&(r=!1),void 0===i&&(i=[]),void 0===o&&(o=!1),Fe(ho)(e,t,n,r,i,o)},yo=function(n){return M(void 0,void 0,void 0,function(){var t;return q(this,function(e){switch(e.label){case 0:return[4,n.getItem()];case 1:return t=e.sent(),[2,fo(vt(n.toUrl()),"",{Id:t.Id},!0).configureFrom(n).load()]}})})},go=function(r,i,o,s,a){return void 0===s&&(s="Article"),void 0===a&&(a=0),M(void 0,void 0,void 0,function(){var t,n;return q(this,function(e){switch(e.label){case 0:return i=i.replace(/\.aspx$/i,""),[4,Rt(uo(r,"_api/sitepages/pages"),lt(Object.assign(dt("SP.Publishing.SitePage"),{PageLayoutType:s,PromotedState:a})))];case 1:return t=e.sent(),(n=fo(r,"",t)).title=i,[4,n.save(!1)];case 2:return e.sent(),n.title=o,[2,n]}})})},vo=(Object.defineProperty(Oo.prototype,"order",{get:function(){return this._order},set:function(e){this._order=e;for(var t=0;t<this.columns.length;t++)this.columns[t].data.position.zoneIndex=e},enumerable:!0,configurable:!0}),Object.defineProperty(Oo.prototype,"layoutIndex",{get:function(){return this._layoutIndex},set:function(e){this._layoutIndex=e;for(var t=0;t<this.columns.length;t++)this.columns[t].data.position.layoutIndex=e},enumerable:!0,configurable:!0}),Object.defineProperty(Oo.prototype,"defaultColumn",{get:function(){return this.columns.length<1&&this.addColumn(12),this.columns[0]},enumerable:!0,configurable:!0}),Oo.prototype.addColumn=function(e,t){void 0===t&&(t=1);var n=new mo;return n.section=this,n.data.position.zoneIndex=this.order,n.data.position.layoutIndex=t,n.data.position.sectionFactor=e,n.order=Ki(this.columns),this.columns.push(n),n},Oo.prototype.addControl=function(e){return this.defaultColumn.addControl(e),this},Object.defineProperty(Oo.prototype,"emphasis",{get:function(){return this._emphasis},set:function(e){this._emphasis=e},enumerable:!0,configurable:!0}),Oo.prototype.remove=function(){var t=this;this.page.sections=this.page.sections.filter(function(e){return e._memId!==t._memId}),Qi(this.page.sections)},Oo),mo=(Object.defineProperty(_o.prototype,"data",{get:function(){return this.json},enumerable:!0,configurable:!0}),Object.defineProperty(_o.prototype,"section",{get:function(){return this._section},set:function(e){this._section=e},enumerable:!0,configurable:!0}),Object.defineProperty(_o.prototype,"order",{get:function(){return this.data.position.sectionIndex},set:function(e){this.data.position.sectionIndex=e;for(var t=0;t<this.controls.length;t++)this.controls[t].data.position.zoneIndex=this.data.position.zoneIndex,this.controls[t].data.position.layoutIndex=this.data.position.layoutIndex,this.controls[t].data.position.sectionIndex=e},enumerable:!0,configurable:!0}),Object.defineProperty(_o.prototype,"factor",{get:function(){return this.data.position.sectionFactor},set:function(e){this.data.position.sectionFactor=e},enumerable:!0,configurable:!0}),_o.prototype.addControl=function(e){return(e.column=this).controls.push(e),this},_o.prototype.getControl=function(e){return this.controls[e]},_o.prototype.remove=function(){var t=this;this.section.columns=this.section.columns.filter(function(e){return e._memId!==t._memId}),Qi(this.section.columns)},_o.Default={controlType:0,displayMode:2,emphasis:{},position:{layoutIndex:1,sectionFactor:12,sectionIndex:1,zoneIndex:1}},_o),bo=(Object.defineProperty(Io.prototype,"id",{get:function(){return this.json.id},enumerable:!0,configurable:!0}),Object.defineProperty(Io.prototype,"data",{get:function(){return this.json},enumerable:!0,configurable:!0}),Object.defineProperty(Io.prototype,"column",{get:function(){return this._column},set:function(e){this._column=e,this.onColumnChange(this._column)},enumerable:!0,configurable:!0}),Io.prototype.remove=function(){var t=this;this.column.controls=this.column.controls.filter(function(e){return e.id!==t.id}),Qi(this.column.controls)},Io.prototype.setData=function(e){this.json=e},Io),So=(B(Po,lo=bo),Object.defineProperty(Po.prototype,"text",{get:function(){return this.data.innerHTML},set:function(e){e.startsWith("<p>")||(e="<p>"+e+"</p>"),this.data.innerHTML=e},enumerable:!0,configurable:!0}),Object.defineProperty(Po.prototype,"order",{get:function(){return this.data.position.controlIndex},set:function(e){this.data.position.controlIndex=e},enumerable:!0,configurable:!0}),Po.prototype.onColumnChange=function(e){this.data.position.sectionFactor=e.factor,this.data.position.controlIndex=Ki(e.controls),this.data.position.zoneIndex=e.data.position.zoneIndex,this.data.position.sectionIndex=e.order,this.data.position.layoutIndex=e.data.position.layoutIndex},Po.Default={addedFromPersistedData:!1,anchorComponentId:"",controlType:4,displayMode:2,editorType:"CKEditor",emphasis:{},id:"",innerHTML:"",position:{controlIndex:1,layoutIndex:1,sectionFactor:12,sectionIndex:1,zoneIndex:1}},Po),To=(B(wo,co=bo),wo.fromComponentDef=function(e){var t=new wo;return t.import(e),t},Object.defineProperty(wo.prototype,"title",{get:function(){return this.data.webPartData.title},set:function(e){this.data.webPartData.title=e},enumerable:!0,configurable:!0}),Object.defineProperty(wo.prototype,"description",{get:function(){return this.data.webPartData.description},set:function(e){this.data.webPartData.description=e},enumerable:!0,configurable:!0}),Object.defineProperty(wo.prototype,"order",{get:function(){return this.data.position.controlIndex},set:function(e){this.data.position.controlIndex=e},enumerable:!0,configurable:!0}),Object.defineProperty(wo.prototype,"height",{get:function(){return this.data.reservedHeight},set:function(e){this.data.reservedHeight=e},enumerable:!0,configurable:!0}),Object.defineProperty(wo.prototype,"width",{get:function(){return this.data.reservedWidth},set:function(e){this.data.reservedWidth=e},enumerable:!0,configurable:!0}),Object.defineProperty(wo.prototype,"dataVersion",{get:function(){return this.data.webPartData.dataVersion},set:function(e){this.data.webPartData.dataVersion=e},enumerable:!0,configurable:!0}),wo.prototype.setProperties=function(e){return this.data.webPartData.properties=P(this.data.webPartData.properties,e),this},wo.prototype.getProperties=function(){return this.data.webPartData.properties},wo.prototype.onColumnChange=function(e){this.data.position.sectionFactor=e.factor,this.data.position.controlIndex=Ki(e.controls),this.data.position.zoneIndex=e.data.position.zoneIndex,this.data.position.sectionIndex=e.data.position.sectionIndex,this.data.position.layoutIndex=e.data.position.layoutIndex},wo.prototype.import=function(e){var t=b(),n=e.Id.replace(/^\{|\}$/g,"").toLowerCase(),r=JSON.parse(e.Manifest).preconfiguredEntries[0];this.setData(Object.assign({},this.data,{id:t,webPartData:{dataVersion:"1.0",description:r.description.default,id:n,instanceId:t,properties:r.properties,title:r.title.default},webPartId:n}))},wo.Default={addedFromPersistedData:!1,controlType:3,displayMode:2,emphasis:{},id:null,position:{controlIndex:1,layoutIndex:1,sectionFactor:12,sectionIndex:1,zoneIndex:1},reservedHeight:500,reservedWidth:500,webPartData:null,webPartId:null},wo);function wo(e){return void 0===e&&(e=JSON.parse(JSON.stringify(wo.Default))),co.call(this,e)||this}function Po(e,t){void 0===t&&(t=JSON.parse(JSON.stringify(Po.Default)));var n=this;return _(t.id)&&(t.id=b(),t.anchorComponentId=t.id),(n=lo.call(this,t)||this).text=e,n}function Io(e){this.json=e}function _o(e,t){void 0===e&&(e=JSON.parse(JSON.stringify(_o.Default))),void 0===t&&(t=[]),this.json=e,this.controls=t,this._section=null,this._memId=b()}function Oo(e,t,n,r,i){void 0===r&&(r=[]),void 0===i&&(i=0),this.page=e,this.columns=r,this._emphasis=i,this._memId=b(),this._order=t,this._layoutIndex=n}function Co(e,t,n,r,i,o){void 0===r&&(r=!1),void 0===i&&(i=[]),void 0===o&&(o=!1);var s=po.call(this,e,t)||this;return s.json=n,s.sections=i,s.commentsDisabled=o,s._bannerImageDirty=!1,"string"==typeof e?(s.data.parentUrl="",s.data.url=v(vt(e),t)):s.assign(uo(e,null),t),s._pageSettings={controlType:0,pageSettingsSlice:{isDefaultDescription:!0,isDefaultThumbnail:!0}},s._layoutPart=Co.getDefaultLayoutPart(),void 0===n||r||s.fromJSON(n),s}vn.prototype.getClientsideWebParts=function(){return this.clone(Bt,"GetClientSideWebParts")()},vn.prototype.addClientsidePage=function(e,t,n,r){return void 0===t&&(t=e.replace(/\.[^/.]+$/,"")),go(this,e,t,n,r)},vn.prototype.loadClientsidePage=function(e){return yo(this.getFileByServerRelativePath(e))};var Eo,Ro,No=(B(Lo,Ro=Ft),Lo.prototype.getByName=function(e){return mt.configure(xo(this).concat("('"+un(e)+"')"),"fs.getByName")},Lo.prototype.add=function(t){return M(this,void 0,void 0,function(){return q(this,function(e){switch(e.label){case 0:return[4,Rt(this.clone(Ao,"add('"+un(t)+"')"))];case 1:return[2,{data:e.sent(),folder:this.getByName(t)}]}})})},Lo.prototype.addUsingPath=function(t,n){return void 0===n&&(n=!1),M(this,void 0,void 0,function(){return q(this,function(e){switch(e.label){case 0:return[4,Rt(this.clone(Ao,"addUsingPath(DecodedUrl='"+un(t)+"',overwrite="+n+")"))];case 1:return[2,{data:e.sent(),folder:xo(vt(this.toUrl()),"_api/web/getFolderByServerRelativePath(decodedUrl='"+un(t)+"')")}]}})})},j([mt("fs.add")],Lo.prototype,"add",null),j([mt("fs.addUsingPath")],Lo.prototype,"addUsingPath",null),j([Kt("folders")],Lo)),Ao=Dt(No),Uo=(B(Do,Eo=jt),Object.defineProperty(Do.prototype,"contentTypeOrder",{get:function(){return mt.configure(Bt(this,"contentTypeOrder"),"f.contentTypeOrder")},enumerable:!0,configurable:!0}),Object.defineProperty(Do.prototype,"folders",{get:function(){return Ao(this)},enumerable:!0,configurable:!0}),Object.defineProperty(Do.prototype,"listItemAllFields",{get:function(){return mt.configure(Mt(this,"listItemAllFields"),"f.listItemAllFields")},enumerable:!0,configurable:!0}),Object.defineProperty(Do.prototype,"parentFolder",{get:function(){return mt.configure(xo(this,"parentFolder"),"f.parentFolder")},enumerable:!0,configurable:!0}),Object.defineProperty(Do.prototype,"properties",{get:function(){return mt.configure(Mt(this,"properties"),"f.properties")},enumerable:!0,configurable:!0}),Object.defineProperty(Do.prototype,"serverRelativeUrl",{get:function(){return mt.configure(kt(this,"serverRelativeUrl"),"f.serverRelativeUrl")},enumerable:!0,configurable:!0}),Object.defineProperty(Do.prototype,"uniqueContentTypeOrder",{get:function(){return mt.configure(Bt(this,"uniqueContentTypeOrder"),"f.uniqueContentTypeOrder")},enumerable:!0,configurable:!0}),Do.prototype.recycle=function(){return Rt(this.clone(xo,"recycle"))},Do.prototype.getItem=function(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];return M(this,void 0,void 0,function(){var t,n;return q(this,function(e){switch(e.label){case 0:return[4,(n=this.listItemAllFields).select.apply(n,W(r))()];case 1:return t=e.sent(),[2,P(Wn(Qt(t)),t)]}})})},Do.prototype.moveTo=function(s){return M(this,void 0,void 0,function(){var t,n,r,i,o;return q(this,function(e){switch(e.label){case 0:return[4,this.select("ServerRelativeUrl")()];case 1:return t=e.sent(),n=t.ServerRelativeUrl,r=t["odata.id"],i=vt(r),o=i.replace("://","___").split("/")[0].replace("___","://"),[4,Rt(xo(i,"/_api/SP.MoveCopyUtil.MoveFolder()"),lt({destUrl:I(s)?s:""+o+s,srcUrl:""+o+n}))];case 2:return e.sent(),[2]}})})},Do.prototype.moveByPath=function(s,a){return void 0===a&&(a=!1),M(this,void 0,void 0,function(){var t,n,r,i,o;return q(this,function(e){switch(e.label){case 0:return[4,this.select("ServerRelativeUrl")()];case 1:return t=e.sent(),n=t.ServerRelativeUrl,r=t["odata.id"],i=vt(r),o=i.replace("://","___").split("/")[0].replace("___","://"),[4,Rt(xo(i,"/_api/SP.MoveCopyUtil.MoveFolderByPath()"),lt({destPath:Tn(I(s)?s:""+o+s),options:{KeepBoth:a,ResetAuthorAndCreatedOnCopy:!0,ShouldBypassSharedLocks:!0,__metadata:{type:"SP.MoveCopyOptions"}},srcPath:Tn(I(n)?n:""+o+n)}))];case 2:return e.sent(),[2]}})})},Do.prototype.copyTo=function(s){return M(this,void 0,void 0,function(){var t,n,r,i,o;return q(this,function(e){switch(e.label){case 0:return[4,this.select("ServerRelativeUrl")()];case 1:return t=e.sent(),n=t.ServerRelativeUrl,r=t["odata.id"],i=vt(r),o=i.replace("://","___").split("/")[0].replace("___","://"),[4,Rt(xo(i,"/_api/SP.MoveCopyUtil.CopyFolder()"),lt({destUrl:I(s)?s:""+o+s,srcUrl:""+o+n}))];case 2:return e.sent(),[2]}})})},Do.prototype.copyByPath=function(s,a){return void 0===a&&(a=!1),M(this,void 0,void 0,function(){var t,n,r,i,o;return q(this,function(e){switch(e.label){case 0:return[4,this.select("ServerRelativeUrl")()];case 1:return t=e.sent(),n=t.ServerRelativeUrl,r=t["odata.id"],i=vt(r),o=i.replace("://","___").split("/")[0].replace("___","://"),[4,Rt(xo(i,"/_api/SP.MoveCopyUtil.CopyFolderByPath()"),lt({destPath:Tn(I(s)?s:""+o+s),options:{KeepBoth:a,ResetAuthorAndCreatedOnCopy:!0,ShouldBypassSharedLocks:!0,__metadata:{type:"SP.MoveCopyOptions"}},srcPath:Tn(I(n)?n:""+o+n)}))];case 2:return e.sent(),[2]}})})},Do.prototype.getShareable=function(){return M(this,void 0,void 0,function(){var t,n;return q(this,function(e){switch(e.label){case 0:return[4,this.clone(Mt,"listItemAllFields",!1).select("odata.id")()];case 1:return t=e.sent(),n=Wn(Qt(t)),this.hasBatch&&(n=n.inBatch(this.batch)),[2,n]}})})},j([mt("f.recycle")],Do.prototype,"recycle",null),j([mt("f.getItem")],Do.prototype,"getItem",null),j([mt("f.moveTo")],Do.prototype,"moveTo",null),j([mt("f.moveByPath")],Do.prototype,"moveByPath",null),j([mt("f.copyTo")],Do.prototype,"copyTo",null),j([mt("f.copyByPath")],Do.prototype,"copyByPath",null),j([mt("f.getShareable")],Do.prototype,"getShareable",null),Do),xo=Dt(Uo);function Do(){var t=null!==Eo&&Eo.apply(this,arguments)||this;return t.delete=Ht("f"),t.update=t._update("SP.Folder",function(e){return{data:e,folder:t}}),t}function Lo(){return null!==Ro&&Ro.apply(this,arguments)||this}me(Nn,"rootFolder",xo,"rootFolder"),Nn.prototype.getDefaultColumnValues=function(){return M(this,void 0,void 0,function(){var t,n,r,i,o,s,a;return q(this,function(e){switch(e.label){case 0:return[4,this.rootFolder.select("ServerRelativePath")()];case 1:return t=e.sent(),[4,this.select("ParentWeb/Url").expand("ParentWeb")()];case 2:n=e.sent(),r=v("/",t.ServerRelativePath.DecodedUrl,"Forms/client_LocationBasedDefaults.html"),i=v(n.ParentWeb.Url,"_api/web","getFileByServerRelativePath(decodedUrl='"+un(r)+"')"),o="",e.label=3;case 3:return e.trys.push([3,5,,6]),[4,xo(i,"$value").usingParser(new je)(pt({binaryStringResponseBody:"true"}))];case 4:return o=e.sent(),[3,6];case 5:if((s=e.sent())&&s.status&&404===s.status)return[2,[]];throw s;case 6:return[2,(null===(a=o.match(/<a.*?<\/a>/gi))?[]:a.map(function(e){return e.trim()})).map(function(e){var t=/<a href="(.*?)"><DefaultValue FieldName="(.*?)">(.*?)<\/DefaultValue>/gi.exec(e);return t.length<1?(y.write("Could not parse default column value from '"+e+"'",2),null):{name:t[2],path:decodeURIComponent(t[1]),value:t[3]}}).filter(function(e){return null!==e})]}})})},Nn.prototype.setDefaultColumnValues=function(u){return M(this,void 0,void 0,function(){var i,t,n,r,o,s,a;return q(this,function(e){switch(e.label){case 0:return[4,Bt(this,"fields").select("InternalName","TypeAsString").filter("Hidden ne true")()];case 1:return i=e.sent(),t=u.map(function(t){var e=i.findIndex(function(e){return e.InternalName===t.name});if(e<0)throw Error("Field '"+t.name+"' does not exist in the list. Please check the internal field name. Failed to set defaults.");var n=i[e],r="";switch(n.TypeAsString){case"Boolean":case"Currency":case"Text":case"DateTime":case"Number":case"Choice":case"User":if(w(t.value))throw Error("The type '"+n.TypeAsString+"' does not support multiple values.");r=""+t.value;break;case"MultiChoice":r=w(t.value)?t.value.map(function(e){return""+e}).join(";"):""+t.value;break;case"UserMulti":r=w(t.value)?t.value.map(function(e){return""+e}).join(";#"):""+t.value;break;case"Taxonomy":if(w(t.value))throw Error("The type '"+n.TypeAsString+"' does not support multiple values.");r=t.value.wssId+";#"+t.value.termName+"|"+t.value.termId;break;case"TaxonomyMulti":w(t.value)&&(r=t.value.map(function(e){return e.wssId+";#"+e.termName+"|"+e.termId}).join(";#")),r=t.value.wssId+";#"+t.value.termName+"|"+t.value.termId}return'<a href="'+t.path.replace(/ /gi,"%20")+'"><DefaultValue FieldName="'+t.name+'">'+r+"</DefaultValue></a>"}),n="<MetadataDefaults>"+t.join("")+"</MetadataDefaults>",[4,this.rootFolder.select("ServerRelativePath")()];case 2:return r=e.sent(),[4,this.select("ParentWeb/Url").expand("ParentWeb")()];case 3:return o=e.sent(),s=v("/",r.ServerRelativePath.DecodedUrl,"Forms"),a=v(o.ParentWeb.Url,"_api/web","getFolderByServerRelativePath(decodedUrl='"+un(s)+"')","files"),[4,Rt(xo(a,"add(overwrite=true,url='client_LocationBasedDefaults.html')"),{body:n})];case 4:return e.sent(),[4,this.eventReceivers.filter("ReceiverName eq 'LocationBasedMetadataDefaultsReceiver ItemAdded'").select("ReceiverId")()];case 5:return e.sent().length<1?[4,Rt(An(this.eventReceivers,"add"),lt({eventReceiverCreationInformation:{EventType:10001,ReceiverAssembly:"Microsoft.Office.DocumentManagement, Version=16.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c",ReceiverClass:"Microsoft.Office.DocumentManagement.LocationBasedMetadataDefaultsReceiver",ReceiverName:"LocationBasedMetadataDefaultsReceiver ItemAdded",SequenceNumber:1e3,Synchronization:1}}))]:[3,7];case 6:e.sent(),e.label=7;case 7:return[2]}})})},Uo.prototype.getDefaultColumnValues=function(){return M(this,void 0,void 0,function(){var t,n;return q(this,function(e){switch(e.label){case 0:return[4,xo(this,"Properties").select("vti_x005f_listname")()];case 1:return t=e.sent(),[4,this.select("ServerRelativePath")()];case 2:return n=e.sent().ServerRelativePath,[4,mn(vt(Qt(t))).lists.getById(t.vti_x005f_listname).getDefaultColumnValues()];case 3:return[2,e.sent().filter(function(e){return e.path.toLowerCase()===n.DecodedUrl.toLowerCase()})]}})})},Uo.prototype.setDefaultColumnValues=function(a,u){return void 0===u&&(u=!0),M(this,void 0,void 0,function(){var t,n,r,i,o,s;return q(this,function(e){switch(e.label){case 0:return[4,xo(this,"Properties").select("vti_x005f_listname")()];case 1:return t=e.sent(),n=mn(vt(Qt(t))),r=n.lists.getById(t.vti_x005f_listname),[4,this.select("ServerRelativePath")()];case 2:return i=e.sent().ServerRelativePath.DecodedUrl,[4,r.getDefaultColumnValues()];case 3:return o=e.sent(),s=u?o:o.filter(function(e){return e.path!==i}),a.forEach(function(t){var e=s.find(function(e){return e.name===t.name&&e.path===i});e?e.value=t.value:s.push({name:t.name,path:i,value:t.value})}),[4,r.setDefaultColumnValues(s)];case 4:return e.sent(),[2]}})})},Uo.prototype.clearDefaultColumnValues=function(){return M(this,void 0,void 0,function(){return q(this,function(e){switch(e.label){case 0:return[4,this.setDefaultColumnValues([],!1)];case 1:return e.sent(),[2]}})})};var ko,Fo,Bo,jo,Mo=(B($o,jo=Ft),$o.prototype.addAvailableContentType=function(n){return M(this,void 0,void 0,function(){var t;return q(this,function(e){switch(e.label){case 0:return[4,Rt(this.clone(qo,"addAvailableContentType"),lt({contentTypeId:n}))];case 1:return t=e.sent(),[2,{contentType:this.getById(t.id),data:t}]}})})},$o.prototype.getById=function(e){return mt.configure(Wo(this).concat("('"+e+"')"),"cts.getById")},$o.prototype.add=function(r,i,o,s,a){return void 0===o&&(o=""),void 0===s&&(s="Custom Content Types"),void 0===a&&(a={}),M(this,void 0,void 0,function(){var t,n;return q(this,function(e){switch(e.label){case 0:return t=lt(Object.assign(dt("SP.ContentType"),{Description:o,Group:s,Id:{StringValue:r},Name:i},a)),[4,Rt(this,t)];case 1:return n=e.sent(),[2,{contentType:this.getById(n.id),data:n}]}})})},j([mt("cts.addAvailableContentType")],$o.prototype,"addAvailableContentType",null),j([mt("cts.add")],$o.prototype,"add",null),j([Kt("contenttypes")],$o)),qo=Dt(Mo),Go=(B(Jo,Bo=jt),Object.defineProperty(Jo.prototype,"fieldLinks",{get:function(){return mt.configure(Ho(this),"ct.fieldLinks")},enumerable:!0,configurable:!0}),Object.defineProperty(Jo.prototype,"fields",{get:function(){return mt.configure(Bt(this,"fields"),"ct.fields")},enumerable:!0,configurable:!0}),Object.defineProperty(Jo.prototype,"parent",{get:function(){return mt.configure(Wo(this,"parent"),"ct.parent")},enumerable:!0,configurable:!0}),Object.defineProperty(Jo.prototype,"workflowAssociations",{get:function(){return mt.configure(Bt(this,"workflowAssociations"),"ct.workflowAssociations")},enumerable:!0,configurable:!0}),Jo),Wo=Dt(Go),Vo=(B(Xo,Fo=Ft),Xo.prototype.getById=function(e){return mt.configure(Qo(this).concat("(guid'"+e+"')"),"fls.getById")},j([Kt("fieldlinks")],Xo)),Ho=Dt(Vo),Ko=(B(zo,ko=jt),zo),Qo=Dt(Ko);function zo(){return null!==ko&&ko.apply(this,arguments)||this}function Xo(){return null!==Fo&&Fo.apply(this,arguments)||this}function Jo(){var e=null!==Bo&&Bo.apply(this,arguments)||this;return e.delete=Vt("ct"),e}function $o(){return null!==jo&&jo.apply(this,arguments)||this}me(vn,"contentTypes",qo),me(Gn,"contentType",Wo,"ContentType"),me(Nn,"contentTypes",qo);var Yo,Zo,es=(B(os,Zo=Ft),os.prototype.add=function(t,n){return void 0===n&&(n=!1),M(this,void 0,void 0,function(){return q(this,function(e){switch(e.label){case 0:return[4,Rt(this.clone(ts,"add"),lt({featdefScope:0,featureId:t,force:n}))];case 1:return[2,{data:e.sent(),feature:this.getById(t)}]}})})},os.prototype.getById=function(e){var t=rs(this);return t.concat("('"+e+"')"),mt.configure(t,"fes.getById")},os.prototype.remove=function(e,t){return void 0===t&&(t=!1),Rt(this.clone(ts,"remove"),lt({featureId:e,force:t}))},j([mt("fes.add")],os.prototype,"add",null),j([mt("fes.remove")],os.prototype,"remove",null),j([Kt("features")],os)),ts=Dt(es),ns=(B(is,Yo=jt),is.prototype.deactivate=function(i){return void 0===i&&(i=!1),M(this,void 0,void 0,function(){var t,n,r;return q(this,function(e){switch(e.label){case 0:return t=this.addBatchDependency(),[4,rs(this).select("DefinitionId")()];case 1:return n=e.sent(),r=this.getParent(ts,this.parentUrl,"",this.batch).remove(n.DefinitionId,i),t(),[2,r]}})})},j([mt("fe.deactivate")],is.prototype,"deactivate",null),is),rs=Dt(ns);function is(){return null!==Yo&&Yo.apply(this,arguments)||this}function os(){return null!==Zo&&Zo.apply(this,arguments)||this}me(ln,"features",ts),me(vn,"features",ts);var ss,as,us,cs,ls,ps,ds,hs,fs,ys,gs,vs,ms,bs,Ss,Ts,ws,Ps,Is=(B(Rs,ys=Ft),Rs.prototype.getById=function(e){return mt.configure(Cs(this).concat("('"+e+"')"),"fs.getById")},Rs.prototype.getByTitle=function(e){return mt.configure(Cs(this,"getByTitle('"+e+"')"),"fs.getByTitle")},Rs.prototype.getByInternalNameOrTitle=function(e){return mt.configure(Cs(this,"getByInternalNameOrTitle('"+e+"')"),"fs.getByInternalNameOrTitle")},Rs.prototype.createFieldAsXml=function(r){return M(this,void 0,void 0,function(){var t,n;return q(this,function(e){switch(e.label){case 0:return"string"==typeof r&&(r={SchemaXml:r}),t=lt({parameters:P(dt("SP.XmlSchemaFieldCreationInformation"),r)}),[4,Rt(this.clone(_s,"createfieldasxml"),t)];case 1:return[2,{data:n=e.sent(),field:this.getById(n.Id)}]}})})},Rs.prototype.add=function(r,i,o){return M(this,void 0,void 0,function(){var t,n;return q(this,function(e){switch(e.label){case 0:return t=lt(Object.assign(dt(i),{Title:r},o)),mt.isTagged(this)||mt.configure(this,"fs.add"),[4,Rt(this.clone(_s,null),t)];case 1:return[2,{data:n=e.sent(),field:this.getById(n.Id)}]}})})},Rs.prototype.addText=function(e,t,n){void 0===t&&(t=255);var r={FieldTypeKind:2,MaxLength:t};return this.add(e,"SP.FieldText",P(r,n))},Rs.prototype.addCalculated=function(e,t,n,r,i){void 0===r&&(r=ss.Text);var o={DateFormat:n,FieldTypeKind:17,Formula:t,OutputType:r};return this.add(e,"SP.FieldCalculated",P(o,i))},Rs.prototype.addDateTime=function(e,t,n,r,i){void 0===t&&(t=as.DateOnly),void 0===n&&(n=ls.Gregorian),void 0===r&&(r=us.Unspecified);var o={DateTimeCalendarType:n,DisplayFormat:t,FieldTypeKind:4,FriendlyDisplayFormat:r};return this.add(e,"SP.FieldDateTime",P(o,i))},Rs.prototype.addNumber=function(e,t,n,r){var i={FieldTypeKind:9};return void 0!==t&&(i=P({MinimumValue:t},i)),void 0!==n&&(i=P({MaximumValue:n},i)),this.add(e,"SP.FieldNumber",P(i,r))},Rs.prototype.addCurrency=function(e,t,n,r,i){void 0===r&&(r=1033);var o={CurrencyLocaleId:r,FieldTypeKind:10};return void 0!==t&&(o=P({MinimumValue:t},o)),void 0!==n&&(o=P({MaximumValue:n},o)),this.add(e,"SP.FieldCurrency",P(o,i))},Rs.prototype.addMultilineText=function(e,t,n,r,i,o,s){void 0===t&&(t=6),void 0===n&&(n=!0),void 0===r&&(r=!1),void 0===i&&(i=!1),void 0===o&&(o=!0);var a={AllowHyperlink:o,AppendOnly:i,FieldTypeKind:3,NumberOfLines:t,RestrictedMode:r,RichText:n};return this.add(e,"SP.FieldMultiLineText",P(a,s))},Rs.prototype.addUrl=function(e,t,n){void 0===t&&(t=ps.Hyperlink);var r={DisplayFormat:t,FieldTypeKind:11};return this.add(e,"SP.FieldUrl",P(r,n))},Rs.prototype.addUser=function(e,t,n){var r={FieldTypeKind:20,SelectionMode:t};return this.add(e,"SP.FieldUser",P(r,n))},Rs.prototype.addLookup=function(i,o,s,a){return M(this,void 0,void 0,function(){var t,n,r;return q(this,function(e){switch(e.label){case 0:return t=P({FieldTypeKind:7,LookupFieldName:s,LookupListId:o,Title:i},a),n=lt({parameters:P(dt("SP.FieldCreationInformation"),t)}),[4,Rt(this.clone(_s,"addfield"),n)];case 1:return[2,{data:r=e.sent(),field:this.getById(r.Id)}]}})})},Rs.prototype.addChoice=function(e,t,n,r,i){void 0===n&&(n=hs.Dropdown);var o={Choices:{results:t},EditFormat:n,FieldTypeKind:6,FillInChoice:r};return this.add(e,"SP.FieldChoice",P(o,i))},Rs.prototype.addMultiChoice=function(e,t,n,r){var i={Choices:{results:t},FieldTypeKind:15,FillInChoice:n};return this.add(e,"SP.FieldMultiChoice",P(i,r))},Rs.prototype.addBoolean=function(e,t){return this.add(e,"SP.Field",P({FieldTypeKind:8},t))},Rs.prototype.addDependentLookupField=function(r,i,o){return M(this,void 0,void 0,function(){var t,n;return q(this,function(e){switch(e.label){case 0:return t="adddependentlookupfield(displayName='"+r+"', primarylookupfieldid='"+i+"', showfield='"+o+"')",[4,Rt(this.clone(_s,t))];case 1:return[2,{data:n=e.sent(),field:this.getById(n.Id)}]}})})},Rs.prototype.addLocation=function(e,t){return this.add(e,"SP.FieldLocation",P({FieldTypeKind:33},t))},j([mt("fs.createFieldAsXml")],Rs.prototype,"createFieldAsXml",null),j([mt("fs.addText")],Rs.prototype,"addText",null),j([mt("fs.addCalculated")],Rs.prototype,"addCalculated",null),j([mt("fs.addDateTime")],Rs.prototype,"addDateTime",null),j([mt("fs.addNumber")],Rs.prototype,"addNumber",null),j([mt("fs.addCurrency")],Rs.prototype,"addCurrency",null),j([mt("fs.addMultilineText")],Rs.prototype,"addMultilineText",null),j([mt("fs.addUrl")],Rs.prototype,"addUrl",null),j([mt("fs.addUser")],Rs.prototype,"addUser",null),j([mt("fs.addLookup")],Rs.prototype,"addLookup",null),j([mt("fs.addChoice")],Rs.prototype,"addChoice",null),j([mt("fs.addMultiChoice")],Rs.prototype,"addMultiChoice",null),j([mt("fs.addBoolean")],Rs.prototype,"addBoolean",null),j([mt("fs.addDependentLookupField")],Rs.prototype,"addDependentLookupField",null),j([mt("fs.addLocation")],Rs.prototype,"addLocation",null),j([Kt("fields")],Rs)),_s=Dt(Is),Os=(B(Es,fs=jt),Es.prototype.update=function(r,i){return M(this,void 0,void 0,function(){var t,n;return q(this,function(e){switch(e.label){case 0:return null!=i?[3,2]:[4,this.select("FieldTypeKind")()];case 1:t=e.sent(),i="SP.Field"+ss[t.FieldTypeKind],e.label=2;case 2:return n=lt(P(dt(i),r),pt({"X-HTTP-Method":"MERGE"})),[4,Rt(this,n)];case 3:return[2,{data:e.sent(),field:this}]}})})},Es.prototype.setShowInDisplayForm=function(e){return Rt(this.clone(Cs,"setshowindisplayform("+e+")"))},Es.prototype.setShowInEditForm=function(e){return Rt(this.clone(Cs,"setshowineditform("+e+")"))},Es.prototype.setShowInNewForm=function(e){return Rt(this.clone(Cs,"setshowinnewform("+e+")"))},j([mt("f.update")],Es.prototype,"update",null),j([mt("f.setShowInDisplayForm")],Es.prototype,"setShowInDisplayForm",null),j([mt("f.setShowInEditForm")],Es.prototype,"setShowInEditForm",null),j([mt("f.setShowInNewForm")],Es.prototype,"setShowInNewForm",null),Es),Cs=Dt(Os);function Es(){var e=null!==fs&&fs.apply(this,arguments)||this;return e.delete=Vt("f"),e}function Rs(){return null!==ys&&ys.apply(this,arguments)||this}(Ps=ss=ss||{})[Ps.Invalid=0]="Invalid",Ps[Ps.Integer=1]="Integer",Ps[Ps.Text=2]="Text",Ps[Ps.Note=3]="Note",Ps[Ps.DateTime=4]="DateTime",Ps[Ps.Counter=5]="Counter",Ps[Ps.Choice=6]="Choice",Ps[Ps.Lookup=7]="Lookup",Ps[Ps.Boolean=8]="Boolean",Ps[Ps.Number=9]="Number",Ps[Ps.Currency=10]="Currency",Ps[Ps.URL=11]="URL",Ps[Ps.Computed=12]="Computed",Ps[Ps.Threading=13]="Threading",Ps[Ps.Guid=14]="Guid",Ps[Ps.MultiChoice=15]="MultiChoice",Ps[Ps.GridChoice=16]="GridChoice",Ps[Ps.Calculated=17]="Calculated",Ps[Ps.File=18]="File",Ps[Ps.Attachments=19]="Attachments",Ps[Ps.User=20]="User",Ps[Ps.Recurrence=21]="Recurrence",Ps[Ps.CrossProjectLink=22]="CrossProjectLink",Ps[Ps.ModStat=23]="ModStat",Ps[Ps.Error=24]="Error",Ps[Ps.ContentTypeId=25]="ContentTypeId",Ps[Ps.PageSeparator=26]="PageSeparator",Ps[Ps.ThreadIndex=27]="ThreadIndex",Ps[Ps.WorkflowStatus=28]="WorkflowStatus",Ps[Ps.AllDayEvent=29]="AllDayEvent",Ps[Ps.WorkflowEventType=30]="WorkflowEventType",(ws=as=as||{})[ws.DateOnly=0]="DateOnly",ws[ws.DateTime=1]="DateTime",(Ts=us=us||{})[Ts.Unspecified=0]="Unspecified",Ts[Ts.Disabled=1]="Disabled",Ts[Ts.Relative=2]="Relative",(Ss=cs=cs||{})[Ss.DefaultValue=0]="DefaultValue",Ss[Ss.AddToDefaultContentType=1]="AddToDefaultContentType",Ss[Ss.AddToNoContentType=2]="AddToNoContentType",Ss[Ss.AddToAllContentTypes=4]="AddToAllContentTypes",Ss[Ss.AddFieldInternalNameHint=8]="AddFieldInternalNameHint",Ss[Ss.AddFieldToDefaultView=16]="AddFieldToDefaultView",Ss[Ss.AddFieldCheckDisplayName=32]="AddFieldCheckDisplayName",(bs=ls=ls||{})[bs.Gregorian=1]="Gregorian",bs[bs.Japan=3]="Japan",bs[bs.Taiwan=4]="Taiwan",bs[bs.Korea=5]="Korea",bs[bs.Hijri=6]="Hijri",bs[bs.Thai=7]="Thai",bs[bs.Hebrew=8]="Hebrew",bs[bs.GregorianMEFrench=9]="GregorianMEFrench",bs[bs.GregorianArabic=10]="GregorianArabic",bs[bs.GregorianXLITEnglish=11]="GregorianXLITEnglish",bs[bs.GregorianXLITFrench=12]="GregorianXLITFrench",bs[bs.KoreaJapanLunar=14]="KoreaJapanLunar",bs[bs.ChineseLunar=15]="ChineseLunar",bs[bs.SakaEra=16]="SakaEra",bs[bs.UmAlQura=23]="UmAlQura",(ms=ps=ps||{})[ms.Hyperlink=0]="Hyperlink",ms[ms.Image=1]="Image",(vs=ds=ds||{})[vs.PeopleAndGroups=1]="PeopleAndGroups",vs[vs.PeopleOnly=0]="PeopleOnly",(gs=hs=hs||{})[gs.Dropdown=0]="Dropdown",gs[gs.RadioButtons=1]="RadioButtons",me(vn,"fields",_s),me(vn,"availablefields",_s,"availablefields"),me(Nn,"fields",_s),me(Uo,"files",pi),me(Gn,"file",hi,"file"),me(Gn,"folder",xo,"folder"),me(Nn,"rootFolder",xo,"rootFolder"),me(vn,"folders",Ao),me(vn,"rootFolder",xo,"rootFolder"),vn.prototype.getFolderByServerRelativeUrl=function(e){return xo(this,"getFolderByServerRelativeUrl('"+un(e)+"')")},vn.prototype.getFolderByServerRelativePath=function(e){return xo(this,"getFolderByServerRelativePath(decodedUrl='"+un(e)+"')")},vn.prototype.getFolderById=function(e){return xo(this,"getFolderById('"+e+"')")};var Ns,As,Us=(B(Fs,As=Ft),Fs.prototype.getById=function(e){return mt.configure(Ls(this).concat("('"+e+"')"),"fos.getById")},j([Kt("forms")],Fs)),xs=Dt(Us),Ds=(B(ks,Ns=jt),ks),Ls=Dt(Ds);function ks(){return null!==Ns&&Ns.apply(this,arguments)||this}function Fs(){return null!==As&&As.apply(this,arguments)||this}me(Nn,"forms",xs,"forms");var Bs,js,Ms=(B(Hs,js=Ft),Hs.prototype.getById=function(e){return mt.configure(Ws(this,"GetById?hubSiteId='"+e+"'"),"hss.getById")},j([Kt("_api/hubsites")],Hs)),qs=Dt(Ms),Gs=(B(Vs,Bs=jt),Vs.prototype.getSite=function(){return M(this,void 0,void 0,function(){var t;return q(this,function(e){switch(e.label){case 0:return[4,this.select("SiteUrl")()];case 1:return t=e.sent(),[2,pn(t.SiteUrl)]}})})},j([mt("hs.getSite")],Vs.prototype,"getSite",null),Vs),Ws=Dt(Gs);function Vs(){return null!==Bs&&Bs.apply(this,arguments)||this}function Hs(){return null!==js&&js.apply(this,arguments)||this}ln.prototype.joinHubSite=function(t){return M(this,void 0,void 0,function(){return q(this,function(e){switch(e.label){case 0:return[4,Rt(this.clone(pn,"joinHubSite('"+t+"')"))];case 1:return e.sent(),[2]}})})},ln.prototype.registerHubSite=function(){return M(this,void 0,void 0,function(){return q(this,function(e){switch(e.label){case 0:return[4,Rt(this.clone(pn,"registerHubSite"))];case 1:return e.sent(),[2]}})})},ln.prototype.unRegisterHubSite=function(){return M(this,void 0,void 0,function(){return q(this,function(e){switch(e.label){case 0:return[4,Rt(this.clone(pn,"unRegisterHubSite"))];case 1:return e.sent(),[2]}})})},vn.prototype.hubSiteData=function(n){return void 0===n&&(n=!1),M(this,void 0,void 0,function(){var t;return q(this,function(e){switch(e.label){case 0:return[4,this.clone(mn,"hubSiteData("+n+")")()];case 1:return"string"==typeof(t=e.sent())?[2,JSON.parse(t)]:[2,t]}})})},vn.prototype.syncHubSiteTheme=function(){return Rt(this.clone(mn,"syncHubSiteTheme"))},Reflect.defineProperty(on.prototype,"hubSites",{configurable:!0,enumerable:!0,get:function(){return qs(this._baseUrl).configure(this._options)}});var Ks,Qs,zs,Xs,Js=(B(aa,Xs=Ft),aa.prototype.getById=function(e){return mt.configure(Zs(this).concat("("+e+")"),"nns.getById")},aa.prototype.add=function(r,i,o){return void 0===o&&(o=!0),M(this,void 0,void 0,function(){var t,n;return q(this,function(e){switch(e.label){case 0:return t=lt(P(dt("SP.NavigationNode"),{IsVisible:o,Title:r,Url:i})),[4,Rt(this.clone($s,null),t)];case 1:return[2,{data:n=e.sent(),node:this.getById(n.Id)}]}})})},aa.prototype.moveAfter=function(e,t){var n=lt({nodeId:e,previousNodeId:t});return Rt(this.clone($s,"MoveAfter"),n)},j([mt("nns.add")],aa.prototype,"add",null),j([mt("nns.moveAfter")],aa.prototype,"moveAfter",null),aa),$s=Dt(Js),Ys=(B(sa,zs=jt),Object.defineProperty(sa.prototype,"children",{get:function(){return mt.configure($s(this,"children"),"nn.children")},enumerable:!0,configurable:!0}),sa.prototype.update=function(n){return M(this,void 0,void 0,function(){var t;return q(this,function(e){switch(e.label){case 0:return t=lt(P(dt("SP.NavigationNode"),n),pt({"X-HTTP-Method":"MERGE"})),[4,Rt(this,t)];case 1:return[2,{data:e.sent(),node:this}]}})})},j([mt("nn.update")],sa.prototype,"update",null),sa),Zs=Dt(Ys),ea=(B(oa,Qs=Lt),Object.defineProperty(oa.prototype,"quicklaunch",{get:function(){return mt.configure($s(this,"quicklaunch"),"n.quicklaunch")},enumerable:!0,configurable:!0}),Object.defineProperty(oa.prototype,"topNavigationBar",{get:function(){return mt.configure($s(this,"topnavigationbar"),"n.topnavigationbar")},enumerable:!0,configurable:!0}),j([Kt("navigation")],oa)),ta=Dt(ea),na=(B(ia,Ks=Lt),ia.prototype.getMenuState=function(e,t,n,r){return void 0===e&&(e=null),void 0===t&&(t=10),void 0===n&&(n=null),void 0===r&&(r=null),Rt(ra("MenuState"),lt({customProperties:r,depth:t,mapProviderName:n,menuNodeKey:e}))},ia.prototype.getMenuNodeKey=function(e,t){return void 0===t&&(t=null),Rt(ra("MenuNodeKey"),lt({currentUrl:e,mapProviderName:t}))},j([mt("ns.getMenuState")],ia.prototype,"getMenuState",null),j([mt("ns.getMenuNodeKey")],ia.prototype,"getMenuNodeKey",null),ia),ra=function(e){return new na(e)};function ia(e){return void 0===e&&(e=null),Ks.call(this,"_api/navigation",e)||this}function oa(){return null!==Qs&&Qs.apply(this,arguments)||this}function sa(){var e=null!==zs&&zs.apply(this,arguments)||this;return e.delete=Vt("nn"),e}function aa(){return null!==Xs&&Xs.apply(this,arguments)||this}me(vn,"navigation",ta),Reflect.defineProperty(on.prototype,"navigation",{configurable:!0,enumerable:!0,get:function(){return ra().configure(this._options)}});var ua,ca,la,pa,da,ha=(B(Ta,pa=jt),Object.defineProperty(Ta.prototype,"editProfileLink",{get:function(){return this.clone(fa,"EditProfileLink").get()},enumerable:!0,configurable:!0}),Object.defineProperty(Ta.prototype,"isMyPeopleListPublic",{get:function(){return this.clone(fa,"IsMyPeopleListPublic").get()},enumerable:!0,configurable:!0}),Ta.prototype.amIFollowedBy=function(e){var t=this.clone(fa,"amifollowedby(@v)");return t.query.set("@v","'"+encodeURIComponent(e)+"'"),t.get()},Ta.prototype.amIFollowing=function(e){var t=this.clone(fa,"amifollowing(@v)");return t.query.set("@v","'"+encodeURIComponent(e)+"'"),t.get()},Ta.prototype.getFollowedTags=function(e){return void 0===e&&(e=20),this.clone(fa,"getfollowedtags("+e+")").get()},Ta.prototype.getFollowersFor=function(e){var t=this.clone(fa,"getfollowersfor(@v)");return t.query.set("@v","'"+encodeURIComponent(e)+"'"),t.get()},Object.defineProperty(Ta.prototype,"myFollowers",{get:function(){return Bt(this,"getmyfollowers")},enumerable:!0,configurable:!0}),Object.defineProperty(Ta.prototype,"myProperties",{get:function(){return new Ta(this,"getmyproperties")},enumerable:!0,configurable:!0}),Ta.prototype.getPeopleFollowedBy=function(e){var t=this.clone(fa,"getpeoplefollowedby(@v)");return t.query.set("@v","'"+encodeURIComponent(e)+"'"),t.get()},Ta.prototype.getPropertiesFor=function(e){var t=this.clone(fa,"getpropertiesfor(@v)");return t.query.set("@v","'"+encodeURIComponent(e)+"'"),t.get()},Object.defineProperty(Ta.prototype,"trendingTags",{get:function(){var e=this.clone(fa,null);return e.concat(".gettrendingtags"),e.get()},enumerable:!0,configurable:!0}),Ta.prototype.getUserProfilePropertyFor=function(e,t){var n=this.clone(fa,"getuserprofilepropertyfor(accountname=@v, propertyname='"+t+"')");return n.query.set("@v","'"+encodeURIComponent(e)+"'"),n.get()},Ta.prototype.hideSuggestion=function(e){var t=this.clone(fa,"hidesuggestion(@v)");return t.query.set("@v","'"+encodeURIComponent(e)+"'"),Rt(t)},Ta.prototype.isFollowing=function(e,t){var n=this.clone(fa,null);return n.concat(".isfollowing(possiblefolloweraccountname=@v, possiblefolloweeaccountname=@y)"),n.query.set("@v","'"+encodeURIComponent(e)+"'"),n.query.set("@y","'"+encodeURIComponent(t)+"'"),n.get()},Ta.prototype.setMyProfilePic=function(e){var t=null,n=new FileReader;n.onload=function(e){return t=e.target.result},n.readAsArrayBuffer(e);var r=new Ta(this,"setmyprofilepicture");return Rt(r,lt(String.fromCharCode.apply(null,new Uint16Array(t))))},Ta.prototype.setSingleValueProfileProperty=function(e,t,n){return Rt(this.clone(fa,"SetSingleValueProfileProperty"),lt({accountName:e,propertyName:t,propertyValue:n}))},Ta.prototype.setMultiValuedProfileProperty=function(e,t,n){return Rt(this.clone(fa,"SetMultiValuedProfileProperty"),lt({accountName:e,propertyName:t,propertyValues:n}))},Ta.prototype.createPersonalSiteEnqueueBulk=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.profileLoader.createPersonalSiteEnqueueBulk(e)},Object.defineProperty(Ta.prototype,"ownerUserProfile",{get:function(){return this.profileLoader.ownerUserProfile},enumerable:!0,configurable:!0}),Object.defineProperty(Ta.prototype,"userProfile",{get:function(){return this.profileLoader.userProfile},enumerable:!0,configurable:!0}),Ta.prototype.createPersonalSite=function(e){return void 0===e&&(e=!1),this.profileLoader.createPersonalSite(e)},Ta.prototype.shareAllSocialData=function(e){return this.profileLoader.shareAllSocialData(e)},Ta.prototype.clientPeoplePickerResolveUser=function(e){return this.clientPeoplePickerQuery.clientPeoplePickerResolveUser(e)},Ta.prototype.clientPeoplePickerSearchUser=function(e){return this.clientPeoplePickerQuery.clientPeoplePickerSearchUser(e)},Ta),fa=Dt(ha),ya=(B(Sa,la=Lt),Sa.prototype.createPersonalSiteEnqueueBulk=function(e){return Rt(this.clone(ga,"createpersonalsiteenqueuebulk",!1),lt({emailIDs:e}))},Object.defineProperty(Sa.prototype,"ownerUserProfile",{get:function(){var e=this.getParent(ga,this.parentUrl,"_api/sp.userprofiles.profileloader.getowneruserprofile");return this.hasBatch&&(e=e.inBatch(this.batch)),Rt(e)},enumerable:!0,configurable:!0}),Object.defineProperty(Sa.prototype,"userProfile",{get:function(){return Rt(this.clone(ga,"getuserprofile"))},enumerable:!0,configurable:!0}),Sa.prototype.createPersonalSite=function(e){return void 0===e&&(e=!1),Rt(this.clone(ga,"getuserprofile/createpersonalsiteenque("+e+")"))},Sa.prototype.shareAllSocialData=function(e){return Rt(this.clone(ga,"getuserprofile/shareallsocialdata("+e+")"))},j([Kt("_api/sp.userprofiles.profileloader.getprofileloader")],Sa)),ga=function(e,t){return new ya(e,t)},va=(B(ba,ca=Lt),ba.prototype.clientPeoplePickerResolveUser=function(r){return M(this,void 0,void 0,function(){var t,n;return q(this,function(e){switch(e.label){case 0:return(t=this.clone(ma,null)).concat(".clientpeoplepickerresolveuser"),[4,Rt(t,this.getBodyFrom(r))];case 1:return n=e.sent(),[2,JSON.parse("object"==typeof n?n.ClientPeoplePickerResolveUser:n)]}})})},ba.prototype.clientPeoplePickerSearchUser=function(r){return M(this,void 0,void 0,function(){var t,n;return q(this,function(e){switch(e.label){case 0:return(t=this.clone(ma,null)).concat(".clientpeoplepickersearchuser"),[4,Rt(t,this.getBodyFrom(r))];case 1:return n=e.sent(),[2,JSON.parse("object"==typeof n?n.ClientPeoplePickerSearchUser:n)]}})})},ba.prototype.getBodyFrom=function(e){return lt({queryParams:P(dt("SP.UI.ApplicationPages.ClientPeoplePickerQueryParameters"),e)})},j([Kt("_api/sp.ui.applicationpages.clientpeoplepickerwebserviceinterface")],ba)),ma=function(e,t){return new va(e,t)};function ba(){return null!==ca&&ca.apply(this,arguments)||this}function Sa(){return null!==la&&la.apply(this,arguments)||this}function Ta(e,t){void 0===t&&(t="_api/sp.userprofiles.peoplemanager");var n=pa.call(this,e,t)||this;return n.clientPeoplePickerQuery=new va(e).configureFrom(n),n.profileLoader=new ya(e).configureFrom(n),n}(da=ua=ua||{})[da.DefaultZone=0]="DefaultZone",da[da.Intranet=1]="Intranet",da[da.Internet=2]="Internet",da[da.Custom=3]="Custom",da[da.Extranet=4]="Extranet",Reflect.defineProperty(on.prototype,"profiles",{configurable:!0,enumerable:!0,get:function(){return fa(this._baseUrl)}});var wa,Pa,Ia,_a=(B(xa,Ia=jt),Object.defineProperty(xa.prototype,"installedLanguages",{get:function(){return console.warn("Deprecated: RegionalSettings.installedLanguages is deprecated, please use RegionalSettings.getInstalledLanguages"),mt.configure(Bt(this,"installedlanguages"),"rs.installedLanguages")},enumerable:!0,configurable:!0}),Object.defineProperty(xa.prototype,"timeZone",{get:function(){return mt.configure(Ea(this),"rs.tz")},enumerable:!0,configurable:!0}),Object.defineProperty(xa.prototype,"timeZones",{get:function(){return mt.configure(Na(this),"rs.tzs")},enumerable:!0,configurable:!0}),xa.prototype.getInstalledLanguages=function(){return M(this,void 0,void 0,function(){return q(this,function(e){switch(e.label){case 0:return[4,mt.configure(Bt(this,"installedlanguages"),"rs.getInstalledLanguages")()];case 1:return[2,e.sent().Items]}})})},j([Kt("regionalsettings")],xa)),Oa=Dt(_a),Ca=(B(Ua,Pa=jt),Ua.prototype.utcToLocalTime=function(r){return M(this,void 0,void 0,function(){var t,n;return q(this,function(e){switch(e.label){case 0:return t="string"==typeof r?r:r.toISOString(),[4,Rt(this.clone(Ea,"utctolocaltime('"+t+"')"))];case 1:return[2,E(n=e.sent(),"UTCToLocalTime")?n.UTCToLocalTime:n]}})})},Ua.prototype.localTimeToUTC=function(r){return M(this,void 0,void 0,function(){var t,n;return q(this,function(e){switch(e.label){case 0:return t="string"==typeof r?r:g(r,"minute",-1*r.getTimezoneOffset()).toISOString(),[4,Rt(this.clone(Ea,"localtimetoutc('"+t+"')"))];case 1:return[2,E(n=e.sent(),"LocalTimeToUTC")?n.LocalTimeToUTC:n]}})})},j([mt("tz.utcToLocalTime")],Ua.prototype,"utcToLocalTime",null),j([mt("tz.localTimeToUTC")],Ua.prototype,"localTimeToUTC",null),j([Kt("timezone")],Ua)),Ea=Dt(Ca),Ra=(B(Aa,wa=Ft),Aa.prototype.getById=function(e){return Rt(this.clone(Na,"GetById("+e+")").usingParser(en(Ea)))},j([mt("tzs.getById")],Aa.prototype,"getById",null),j([Kt("timezones")],Aa)),Na=Dt(Ra);function Aa(){return null!==wa&&wa.apply(this,arguments)||this}function Ua(){return null!==Pa&&Pa.apply(this,arguments)||this}function xa(){return null!==Ia&&Ia.apply(this,arguments)||this}function Da(t){return function(e){return Rt(this.clone(kt,t+"/getValueForUICulture"),lt({cultureName:e}))}}me(vn,"regionalSettings",Oa),vn.prototype.titleResource=Da("titleResource"),vn.prototype.descriptionResource=Da("descriptionResource");var La,ka,Fa,Ba,ja,Ma,qa=(B(Ka,Ba=Ft),Ka.prototype.getById=function(e){return mt.configure(Va(this).concat("('"+e+"')"),"ucas.getById")},Ka.prototype.add=function(n){return M(this,void 0,void 0,function(){var t;return q(this,function(e){switch(e.label){case 0:return[4,Rt(this,lt(P(dt("SP.UserCustomAction"),n)))];case 1:return t=e.sent(),[2,{action:this.getById(t.Id),data:t}]}})})},Ka.prototype.clear=function(){return Rt(this.clone(Ga,"clear"))},j([mt("ucas.add")],Ka.prototype,"add",null),j([mt("ucas.clear")],Ka.prototype,"clear",null),j([Kt("usercustomactions")],Ka)),Ga=Dt(qa),Wa=(B(Ha,Fa=jt),Ha),Va=Dt(Wa);function Ha(){var t=null!==Fa&&Fa.apply(this,arguments)||this;return t.delete=Vt("uca"),t.update=t._update("SP.UserCustomAction",function(e){return{data:e,action:t}}),t}function Ka(){return null!==Ba&&Ba.apply(this,arguments)||this}(Ma=La=La||{})[Ma.None=0]="None",Ma[Ma.List=1]="List",Ma[Ma.ContentType=2]="ContentType",Ma[Ma.ProgId=3]="ProgId",Ma[Ma.FileType=4]="FileType",(ja=ka=ka||{})[ja.Unknown=0]="Unknown",ja[ja.Site=2]="Site",ja[ja.Web=3]="Web",ja[ja.List=4]="List",Wa.prototype.titleResource=Da("titleResource"),Wa.prototype.descriptionResource=Da("descriptionResource"),Nn.prototype.titleResource=Da("titleResource"),Nn.prototype.descriptionResource=Da("descriptionResource"),Os.prototype.titleResource=Da("titleResource"),Os.prototype.descriptionResource=Da("descriptionResource"),Go.prototype.titleResource=Da("titleResource"),Go.prototype.descriptionResource=Da("descriptionResource");var Qa,za=(B(Ya,Qa=Lt),Ya.prototype.getRelatedItems=function(e,t){var n=this.clone(Xa,null);return n.concat(".GetRelatedItems"),Rt(n,lt({SourceItemID:t,SourceListName:e}))},Ya.prototype.getPageOneRelatedItems=function(e,t){var n=this.clone(Xa,null);return n.concat(".GetPageOneRelatedItems"),Rt(n,lt({SourceItemID:t,SourceListName:e}))},Ya.prototype.addSingleLink=function(e,t,n,r,i,o,s){void 0===s&&(s=!1);var a=this.clone(Xa,null);return a.concat(".AddSingleLink"),Rt(a,lt({SourceItemID:t,SourceListName:e,SourceWebUrl:n,TargetItemID:i,TargetListName:r,TargetWebUrl:o,TryAddReverseLink:s}))},Ya.prototype.addSingleLinkToUrl=function(e,t,n,r){void 0===r&&(r=!1);var i=this.clone(Xa,null);return i.concat(".AddSingleLinkToUrl"),Rt(i,lt({SourceItemID:t,SourceListName:e,TargetItemUrl:n,TryAddReverseLink:r}))},Ya.prototype.addSingleLinkFromUrl=function(e,t,n,r){void 0===r&&(r=!1);var i=this.clone(Xa,null);return i.concat(".AddSingleLinkFromUrl"),Rt(i,lt({SourceItemUrl:e,TargetItemID:n,TargetListName:t,TryAddReverseLink:r}))},Ya.prototype.deleteSingleLink=function(e,t,n,r,i,o,s){void 0===s&&(s=!1);var a=this.clone(Xa,null);return a.concat(".DeleteSingleLink"),Rt(a,lt({SourceItemID:t,SourceListName:e,SourceWebUrl:n,TargetItemID:i,TargetListName:r,TargetWebUrl:o,TryDeleteReverseLink:s}))},j([mt("rim.getRelatedItems")],Ya.prototype,"getRelatedItems",null),j([mt("rim.getPageOneRelatedItems")],Ya.prototype,"getPageOneRelatedItems",null),j([mt("rim.addSingleLink")],Ya.prototype,"addSingleLink",null),j([mt("rim.ToUrl")],Ya.prototype,"addSingleLinkToUrl",null),j([mt("rim.FromUrl")],Ya.prototype,"addSingleLinkFromUrl",null),j([mt("rim.deleteSingleLink")],Ya.prototype,"deleteSingleLink",null),j([Kt("_api/SP.RelatedItemManager")],Ya)),Xa=function(e){return new za(vt("string"==typeof e?e:e.toUrl()))},Ja=new Map([["text","Querytext"],["template","QueryTemplate"],["sourceId","SourceId"],["trimDuplicatesIncludeId",""],["startRow",""],["rowLimit",""],["rankingModelId",""],["rowsPerPage",""],["selectProperties",""],["culture",""],["timeZoneId",""],["refinementFilters",""],["refiners",""],["hiddenConstraints",""],["sortList",""],["timeout",""],["hithighlightedProperties",""],["clientType",""],["personalizationData",""],["resultsURL",""],["queryTag",""],["properties",""],["queryTemplatePropertiesUrl",""],["reorderingRules",""],["hitHighlightedMultivaluePropertyLimit",""],["collapseSpecification",""],["uiLanguage",""],["desiredSnippetLength",""],["maxSnippetLength",""],["summaryLength",""]]),$a=new Map([]);function Ya(){return null!==Qa&&Qa.apply(this,arguments)||this}function Za(e){return e.replace(/^(.)/,function(e){return e.toUpperCase()})}function eu(e,t){return void 0===e&&(e=""),void 0===t&&(t={}),new Proxy({query:Object.assign({Querytext:e},t)},{get:function(r,e,i){var o=e.toString();if("toSearchQuery"===o)return function(){return r.query};if(Ja.has(o))return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=Ja.get(o);return r.query[0<n.length?n:Za(o)]=1<e.length?e:e[0],i};var t=$a.has(o)?$a.get(o):Za(o);return r.query[t]=!0,i}})}var tu,nu,ru,iu,ou,su,au,uu,cu=/_api\/search\/postquery$/i,lu=(B(vu,ou=jt),vu.prototype.execute=function(o){return M(this,void 0,void 0,function(){var t,n,r,i;return q(this,function(e){switch(e.label){case 0:return t=this.parseQuery(o),n=lt({request:P(dt("Microsoft.Office.Server.Search.REST.SearchRequest"),Object.assign({},t,{HitHighlightedProperties:this.fixArrProp(t.HitHighlightedProperties),Properties:this.fixArrProp(t.Properties),RefinementFilters:this.fixArrProp(t.RefinementFilters),ReorderingRules:this.fixArrProp(t.ReorderingRules),SelectProperties:this.fixArrProp(t.SelectProperties),SortList:this.fixArrProp(t.SortList)}))}),this.data.useCaching&&(this._forceCaching=!0,r="PnPjs.SearchWithCaching("+R(n.body)+")",T(this.data.cachingOptions)?cu.test(this.data.cachingOptions.key)&&(this.data.cachingOptions.key=r):this.data.cachingOptions=new oe(r)),[4,Rt(this,n)];case 1:return i=e.sent(),[2,new du(i,this.toUrl(),t)]}})})},vu.prototype.fixArrProp=function(e){return void 0===e?{results:[]}:{results:w(e)?e:[e]}},vu.prototype.parseQuery=function(e){return"string"==typeof e?{Querytext:e}:e.toSearchQuery?e.toSearchQuery():e},j([mt("se.execute")],vu.prototype,"execute",null),j([Kt("_api/search/postquery")],vu)),pu=function(t,n){return void 0===n&&(n={}),function(e){return new lu(t).configure(n).execute(e)}},du=(Object.defineProperty(gu.prototype,"ElapsedTime",{get:function(){var e;return(null===(e=null==this?void 0:this.RawSearchResults)||void 0===e?void 0:e.ElapsedTime)||0},enumerable:!0,configurable:!0}),Object.defineProperty(gu.prototype,"RowCount",{get:function(){var e,t,n;return(null===(n=null===(t=null===(e=null==this?void 0:this.RawSearchResults)||void 0===e?void 0:e.PrimaryQueryResult)||void 0===t?void 0:t.RelevantResults)||void 0===n?void 0:n.RowCount)||0},enumerable:!0,configurable:!0}),Object.defineProperty(gu.prototype,"TotalRows",{get:function(){var e,t,n;return(null===(n=null===(t=null===(e=null==this?void 0:this.RawSearchResults)||void 0===e?void 0:e.PrimaryQueryResult)||void 0===t?void 0:t.RelevantResults)||void 0===n?void 0:n.TotalRows)||0},enumerable:!0,configurable:!0}),Object.defineProperty(gu.prototype,"TotalRowsIncludingDuplicates",{get:function(){var e,t,n;return(null===(n=null===(t=null===(e=null==this?void 0:this.RawSearchResults)||void 0===e?void 0:e.PrimaryQueryResult)||void 0===t?void 0:t.RelevantResults)||void 0===n?void 0:n.TotalRowsIncludingDuplicates)||0},enumerable:!0,configurable:!0}),Object.defineProperty(gu.prototype,"RawSearchResults",{get:function(){return this._raw},enumerable:!0,configurable:!0}),Object.defineProperty(gu.prototype,"PrimarySearchResults",{get:function(){var e,t,n,r;return null===this._primary&&(this._primary=this.formatSearchResults((null===(r=null===(n=null===(t=null===(e=this._raw)||void 0===e?void 0:e.PrimaryQueryResult)||void 0===t?void 0:t.RelevantResults)||void 0===n?void 0:n.Table)||void 0===r?void 0:r.Rows)||null)),this._primary},enumerable:!0,configurable:!0}),gu.prototype.getPage=function(e,t){if(this.TotalRows<this.RowCount)return Promise.resolve(null);var n=void 0!==t?t:E(this._query,"RowLimit")?this._query.RowLimit:10,r=P(this._query,{RowLimit:n,StartRow:n*(e-1)});return r.StartRow>this.TotalRows?Promise.resolve(null):pu(this._url)(r)},gu.prototype.formatSearchResults=function(e){var t,n,r=new Array;if(void 0===e||null==e)return[];var i,o,s,a=e.results?e.results:e;try{for(var u=(i=a,o="function"==typeof Symbol&&i[Symbol.iterator],s=0,o?o.call(i):{next:function(){return i&&s>=i.length&&(i=void 0),{value:i&&i[s++],done:!i}}}),c=u.next();!c.done;c=u.next()){var l=c.value,p=l.Cells.results?l.Cells.results:l.Cells;r.push(p.reduce(function(e,t){return Reflect.defineProperty(e,t.Key,{configurable:!1,enumerable:!0,value:t.Value,writable:!1}),e},{}))}}catch(e){t={error:e}}finally{try{c&&!c.done&&(n=u.return)&&n.call(u)}finally{if(t)throw t.error}}return r},gu),hu=(B(yu,iu=jt),yu.prototype.execute=function(r){return M(this,void 0,void 0,function(){var t,n;return q(this,function(e){switch(e.label){case 0:return this.mapQueryToQueryString(r),[4,this.get()];case 1:return t=e.sent(),[2,{PeopleNames:(n=E(t,"suggest")?function(e){return t.suggest[e].results}:function(e){return t[e]})("PeopleNames"),PersonalResults:n("PersonalResults"),Queries:n("Queries")}]}})})},yu.prototype.mapQueryToQueryString=function(e){var n=this;this.query.set("querytext","'"+e.querytext+"'");var r,t=(r=e,function(t){return function(e){E(r,t)&&n.query.set(e,r[t].toString())}});t("count")("inumberofquerysuggestions"),t("personalCount")("inumberofresultsuggestions"),t("preQuery")("fprequerysuggestions"),t("hitHighlighting")("fhithighlighting"),t("capitalize")("fcapitalizefirstletters"),t("culture")("culture"),t("stemming")("enablestemming"),t("includePeople")("showpeoplenamesuggestions"),t("queryRules")("enablequeryrules"),t("prefixMatch")("fprefixmatchallterms")},j([mt("su.execute")],yu.prototype,"execute",null),j([Kt("_api/search/suggest")],yu)),fu=function(t,n){return void 0===n&&(n={}),function(e){return new hu(t).configure(n).execute(e)}};function yu(){return null!==iu&&iu.apply(this,arguments)||this}function gu(e,t,n,r,i){void 0===r&&(r=null),void 0===i&&(i=null),this._url=t,this._query=n,this._raw=r,this._primary=i,this._url=this._url.replace(cu,""),this._raw=e.postquery?e.postquery:e}function vu(){return null!==ou&&ou.apply(this,arguments)||this}(uu=tu=tu||{})[uu.Ascending=0]="Ascending",uu[uu.Descending=1]="Descending",uu[uu.FQLFormula=2]="FQLFormula",(au=nu=nu||{})[au.ResultContainsKeyword=0]="ResultContainsKeyword",au[au.TitleContainsKeyword=1]="TitleContainsKeyword",au[au.TitleMatchesKeyword=2]="TitleMatchesKeyword",au[au.UrlStartsWith=3]="UrlStartsWith",au[au.UrlExactlyMatches=4]="UrlExactlyMatches",au[au.ContentTypeIs=5]="ContentTypeIs",au[au.FileExtensionMatches=6]="FileExtensionMatches",au[au.ResultHasTag=7]="ResultHasTag",au[au.ManualCondition=8]="ManualCondition",(su=ru=ru||{})[su.None=0]="None",su[su.StringType=1]="StringType",su[su.Int32Type=2]="Int32Type",su[su.BooleanType=3]="BooleanType",su[su.StringArrayType=4]="StringArrayType",su[su.UnSupportedType=5]="UnSupportedType";var mu=(bu.Documents="e7ec8cee-ded8-43c9-beb5-436b54b31e84",bu.ItemsMatchingContentType="5dc9f503-801e-4ced-8a2c-5d1237132419",bu.ItemsMatchingTag="e1327b9c-2b8c-4b23-99c9-3730cb29c3f7",bu.ItemsRelatedToCurrentUser="48fec42e-4a92-48ce-8363-c2703a40e67d",bu.ItemsWithSameKeywordAsThisItem="5c069288-1d17-454a-8ac6-9c642a065f48",bu.LocalPeopleResults="b09a7990-05ea-4af9-81ef-edfab16c4e31",bu.LocalReportsAndDataResults="203fba36-2763-4060-9931-911ac8c0583b",bu.LocalSharePointResults="8413cd39-2156-4e00-b54d-11efd9abdb89",bu.LocalVideoResults="78b793ce-7956-4669-aa3b-451fc5defebf",bu.Pages="5e34578e-4d08-4edc-8bf3-002acf3cdbcc",bu.Pictures="38403c8c-3975-41a8-826e-717f2d41568a",bu.Popular="97c71db1-58ce-4891-8b64-585bc2326c12",bu.RecentlyChangedItems="ba63bbae-fa9c-42c0-b027-9a878f16557c",bu.RecommendedItems="ec675252-14fa-4fbe-84dd-8d098ed74181",bu.Wiki="9479bf85-e257-4318-b5a8-81a180f5faa1",bu);function bu(){}on.prototype.search=function(e){return pu(this._baseUrl,this._options)(e)},on.prototype.searchWithCaching=function(e,t){return new lu(this._baseUrl).configure(this._options).usingCaching(t).execute(e)},on.prototype.searchSuggest=function(e){return fu(this._baseUrl,this._options)("string"==typeof e?{querytext:e}:e)};var Su,Tu,wu,Pu,Iu,_u,Ou,Cu,Eu,Ru,Nu,Au,Uu,xu,Du,Lu,ku,Fu,Bu,ju,Mu,qu,Gu=(B(pc,Du=Ft),pc.prototype.getById=function(e){return mt.configure(Hu(this,"getById("+e+")"),"sus.getById")},pc.prototype.getByEmail=function(e){return mt.configure(Hu(this,"getByEmail('"+e+"')"),"sus.getByEmail")},pc.prototype.getByLoginName=function(e){return mt.configure(Hu(this).concat("('!@v::"+encodeURIComponent(e)+"')"),"sus.getByLoginName")},pc.prototype.removeById=function(e){return Rt(this.clone(Wu,"removeById("+e+")"))},pc.prototype.removeByLoginName=function(e){var t=this.clone(Wu,"removeByLoginName(@v)");return t.query.set("@v","'"+encodeURIComponent(e)+"'"),Rt(t)},pc.prototype.add=function(t){return M(this,void 0,void 0,function(){return q(this,function(e){switch(e.label){case 0:return[4,Rt(this,lt(P(dt("SP.User"),{LoginName:t})))];case 1:return e.sent(),[2,this.getByLoginName(t)]}})})},j([mt("sus.remId")],pc.prototype,"removeById",null),j([mt("sus.remLoginName")],pc.prototype,"removeByLoginName",null),j([mt("sus.add")],pc.prototype,"add",null),j([Kt("siteusers")],pc)),Wu=Dt(Gu),Vu=(B(lc,xu=jt),Object.defineProperty(lc.prototype,"groups",{get:function(){return mt.configure(Qu(this,"groups"),"su.groups")},enumerable:!0,configurable:!0}),lc),Hu=Dt(Vu),Ku=(B(cc,Uu=Ft),cc.prototype.getById=function(e){return mt.configure(Xu(this).concat("("+e+")"),"sgs.getById")},cc.prototype.add=function(r){return M(this,void 0,void 0,function(){var t,n;return q(this,function(e){switch(e.label){case 0:return t=lt(P(dt("SP.Group"),r)),[4,Rt(mt.configure(this,"sgs.add"),t)];case 1:return[2,{data:n=e.sent(),group:this.getById(n.Id)}]}})})},cc.prototype.getByName=function(e){return mt.configure(Xu(this,"getByName('"+e+"')"),"sgs.getByName")},cc.prototype.removeById=function(e){return Rt(this.clone(Qu,"removeById('"+e+"')"))},cc.prototype.removeByLoginName=function(e){return Rt(this.clone(Qu,"removeByLoginName('"+e+"')"))},j([mt("sgs.removeById")],cc.prototype,"removeById",null),j([mt("sgs.removeByLoginName")],cc.prototype,"removeByLoginName",null),j([Kt("sitegroups")],cc)),Qu=Dt(Ku),zu=(B(uc,Au=jt),Object.defineProperty(uc.prototype,"users",{get:function(){return mt.configure(Wu(this,"users"),"sg.users")},enumerable:!0,configurable:!0}),uc.prototype.setUserAsOwner=function(e){return Rt(this.clone(Xu,"SetUserAsOwner("+e+")"))},j([mt("sg.setUserAsOwner")],uc.prototype,"setUserAsOwner",null),uc),Xu=Dt(zu),Ju=(B(ac,Nu=Ft),ac.prototype.getById=function(e){return Zu(this).concat("("+e+")")},ac.prototype.add=function(t,n){return M(this,void 0,void 0,function(){return q(this,function(e){switch(e.label){case 0:return[4,Rt(this.clone($u,"addroleassignment(principalid="+t+", roledefid="+n+")"))];case 1:return e.sent(),[2]}})})},ac.prototype.remove=function(t,n){return M(this,void 0,void 0,function(){return q(this,function(e){switch(e.label){case 0:return[4,Rt(this.clone($u,"removeroleassignment(principalid="+t+", roledefid="+n+")"))];case 1:return e.sent(),[2]}})})},j([Kt("roleassignments")],ac)),$u=Dt(Ju),Yu=(B(sc,Ru=jt),Object.defineProperty(sc.prototype,"groups",{get:function(){return mt.configure(Qu(this,"groups"),"ra.groups")},enumerable:!0,configurable:!0}),Object.defineProperty(sc.prototype,"bindings",{get:function(){return Bt(this,"roledefinitionbindings")},enumerable:!0,configurable:!0}),sc),Zu=Dt(Yu),ec=(B(oc,Eu=Ft),oc.prototype.getById=function(e){return rc(this,"getById("+e+")")},oc.prototype.getByName=function(e){return rc(this,"getbyname('"+e+"')")},oc.prototype.getByType=function(e){return rc(this,"getbytype("+e+")")},oc.prototype.add=function(r,i,o,s){return M(this,void 0,void 0,function(){var t,n;return q(this,function(e){switch(e.label){case 0:return t=lt({BasePermissions:P(dt("SP.BasePermissions"),s),Description:i,Name:r,Order:o,__metadata:{type:"SP.RoleDefinition"}}),[4,Rt(this,t)];case 1:return[2,{data:n=e.sent(),definition:this.getById(n.Id)}]}})})},j([Kt("roledefinitions")],oc)),tc=Dt(ec),nc=(B(ic,Cu=jt),ic.prototype.update=function(s){return M(this,void 0,void 0,function(){var t,n,r,i,o;return q(this,function(e){switch(e.label){case 0:return void 0!==E(s,(t=["BasePermissions"])[0])&&(s[t[0]]=P(dt("SP."+t[0]),s[t[0]])),n=lt(P(dt("SP.RoleDefinition"),s),pt({"X-HTTP-Method":"MERGE"})),[4,Rt(this,n)];case 1:return r=e.sent(),i=this,E(s,"Name")&&(o=this.getParent(tc,this.parentUrl,""),i=o.getByName(s.Name)),[2,{data:r,definition:i}]}})})},ic),rc=Dt(nc);function ic(){var e=null!==Cu&&Cu.apply(this,arguments)||this;return e.delete=Vt("rd"),e}function oc(){return null!==Eu&&Eu.apply(this,arguments)||this}function sc(){var e=null!==Ru&&Ru.apply(this,arguments)||this;return e.delete=Vt("ra"),e}function ac(){return null!==Nu&&Nu.apply(this,arguments)||this}function uc(){var r=null!==Au&&Au.apply(this,arguments)||this;return r.update=r._update("SP.Group",function(e,t){var n=r;return E(t,"Title")&&(n=r.getParent(Xu,r.parentUrl,"getByName('"+t.Title+"')")),{data:e,group:n}}),r}function cc(){return null!==Uu&&Uu.apply(this,arguments)||this}function lc(){var t=null!==xu&&xu.apply(this,arguments)||this;return t.delete=Vt("su"),t.update=t._update("SP.User",function(e){return{data:e,user:t}}),t}function pc(){return null!==Du&&Du.apply(this,arguments)||this}function dc(r){return M(this,void 0,void 0,function(){var t,n;return q(this,function(e){switch(e.label){case 0:return(t=this.clone(Mt,"getUserEffectivePermissions(@user)")).query.set("@user","'"+encodeURIComponent(r)+"'"),[4,t.get()];case 1:return[2,E(n=e.sent(),"GetUserEffectivePermissions")?n.GetUserEffectivePermissions:n]}})})}function hc(){return M(this,void 0,void 0,function(){return q(this,function(e){return[2,this.clone(kt,"EffectiveBasePermissions").get().then(function(e){return E(e,"EffectiveBasePermissions")?e.EffectiveBasePermissions:e})]})})}function fc(t,n){return void 0===t&&(t=!1),void 0===n&&(n=!1),M(this,void 0,void 0,function(){return q(this,function(e){switch(e.label){case 0:return[4,Rt(this.clone(kt,"breakroleinheritance(copyroleassignments="+t+", clearsubscopes="+n+")"))];case 1:return e.sent(),[2]}})})}function yc(){return M(this,void 0,void 0,function(){return q(this,function(e){switch(e.label){case 0:return[4,Rt(this.clone(kt,"resetroleinheritance"))];case 1:return e.sent(),[2]}})})}function gc(n,r){return M(this,void 0,void 0,function(){var t;return q(this,function(e){switch(e.label){case 0:return[4,dc.call(this,n)];case 1:return t=e.sent(),[2,this.hasPermissions(t,r)]}})})}function vc(n){return M(this,void 0,void 0,function(){var t;return q(this,function(e){switch(e.label){case 0:return[4,hc.call(this)];case 1:return t=e.sent(),[2,this.hasPermissions(t,n)]}})})}function mc(e,t){if(!t)return!0;if(t===Su.FullMask)return 32767==(32767&e.High)&&65535===e.Low;var n=1;return 0<=--t&&t<32?(n<<=t,0!=(e.Low&n)):32<=t&&t<64&&(n<<=t-32,0!=(e.High&n))}function bc(i,o,s){return void 0===s&&(s=!1),M(this,void 0,void 0,function(){var t,n,r;return q(this,function(e){switch(e.label){case 0:return s?[2,Ec(i,o)]:[4,function(r,i){return M(this,void 0,void 0,function(){var t,n;return q(this,function(e){switch(e.label){case 0:if(null==i)return[3,7];switch(i){case Ou.Contributor:return[3,1];case Ou.Reader:case Ou.Guest:return[3,3]}return[3,5];case 1:return[4,mn("_api/web","associatedmembergroup").select("Id")()];case 2:return[2,"group: "+e.sent().Id];case 3:return[4,mn("_api/web","associatedvisitorgroup").select("Id")()];case 4:return[2,"group: "+e.sent().Id];case 5:throw Error("Could not determine role value for supplied value. Contributor, Reader, and Guest are supported");case 6:return[3,9];case 7:return t=r===Tu.Edit?Ou.Contributor:Ou.Reader,[4,tc("_api/web").select("Id").top(1).filter("RoleTypeKind eq "+t)()];case 8:if((n=e.sent()).length<1)throw Error("Could not locate associated role definition for supplied role. Edit and View are supported");return[2,"role: "+n[0].Id];case 9:return[2]}})})}((o=P(o,{group:null,includeAnonymousLinkInEmail:!1,propagateAcl:!1,useSimplifiedRoles:!0},!0)).role,o.group)];case 1:return t=e.sent(),Array.isArray(o.loginNames)||(o.loginNames=[o.loginNames]),n=C(o.loginNames.map(function(e){return{Key:e}})),r={peoplePickerInput:n,roleValue:t,url:o.url},void 0!==o.emailData&&null!==o.emailData&&(r=P(r,{emailBody:o.emailData.body,emailSubject:void 0!==o.emailData.subject?o.emailData.subject:"Shared with you.",sendEmail:!0})),[2,Ec(i,r)]}})})}function Sc(e,t){void 0===t&&(t=null);var n=null!==t?t.toISOString():null,r=mt.configure(this.clone(Mt,"shareLink"),"sh.getShareLink");return Rt(r,lt({request:{createLink:!0,emailData:null,settings:{expiration:n,linkKind:e}}}))}function Tc(e){var t=mt.configure(this.clone(Mt,"checkPermissions"),"sh.checkPermissions");return Rt(t,lt({recipients:e}))}function wc(e,t){void 0===e&&(e=null),void 0===t&&(t=[]);var n=mt.configure(this.clone(Mt,"getSharingInformation"),"sh.getSharingInformation");return Rt(n.expand.apply(n,W(t)),lt({request:e}))}function Pc(e){void 0===e&&(e=!0);var t=mt.configure(this.clone(Mt,"getObjectSharingSettings"),"sh.getObjectSharingSettings");return Rt(t,lt({useSimplifiedRoles:e}))}function Ic(){return Rt(mt.configure(this.clone(Mt,"unshareObject"),"sh.unshareObject"))}function _c(e){return Rt(mt.configure(this.clone(Mt,"deleteLinkByKind"),"sh.deleteLinkByKind"),lt({linkKind:e}))}function Oc(e,t){return void 0===t&&(t=ht),Rt(mt.configure(this.clone(Mt,"unshareLink"),"sh.unshareLink"),lt({linkKind:e,shareId:t}))}function Cc(o,s,a,u,c,l){return void 0===u&&(u=!1),void 0===c&&(c=!1),M(this,void 0,void 0,function(){var t,n,r,i;return q(this,function(e){switch(e.label){case 0:return Array.isArray(s)||(s=[s]),t=C(s.map(function(e){return{Key:e}})),n=a===Tu.Edit?Ou.Contributor:Ou.Reader,[4,Bt("_api/web","roledefinitions").select("Id").filter("RoleTypeKind eq "+n).get()];case 1:if(r=e.sent(),!Array.isArray(r)||r.length<1)throw Error("Could not locate a role defintion with RoleTypeKind "+n);return i={includeAnonymousLinkInEmail:u,peoplePickerInput:t,propagateAcl:c,roleValue:"role:"+r[0].Id,useSimplifiedRoles:!0},void 0!==l&&(i=P(i,{emailBody:l.body,emailSubject:void 0!==l.subject?l.subject:"",sendEmail:!0})),[2,Rt(mt.configure(o.clone(Mt,"shareObject"),"sh.shareWith"),lt(i))]}})})}function Ec(e,t){var n=mt.configure(mn(vt(e.toUrl()),"/_api/SP.Web.ShareObject"),"sh.sendShareObjectRequest");return Rt(n.expand("UsersWithAccessRequests","GroupsSharedWith"),lt(t))}(qu=Su=Su||{})[qu.EmptyMask=0]="EmptyMask",qu[qu.ViewListItems=1]="ViewListItems",qu[qu.AddListItems=2]="AddListItems",qu[qu.EditListItems=3]="EditListItems",qu[qu.DeleteListItems=4]="DeleteListItems",qu[qu.ApproveItems=5]="ApproveItems",qu[qu.OpenItems=6]="OpenItems",qu[qu.ViewVersions=7]="ViewVersions",qu[qu.DeleteVersions=8]="DeleteVersions",qu[qu.CancelCheckout=9]="CancelCheckout",qu[qu.ManagePersonalViews=10]="ManagePersonalViews",qu[qu.ManageLists=12]="ManageLists",qu[qu.ViewFormPages=13]="ViewFormPages",qu[qu.AnonymousSearchAccessList=14]="AnonymousSearchAccessList",qu[qu.Open=17]="Open",qu[qu.ViewPages=18]="ViewPages",qu[qu.AddAndCustomizePages=19]="AddAndCustomizePages",qu[qu.ApplyThemeAndBorder=20]="ApplyThemeAndBorder",qu[qu.ApplyStyleSheets=21]="ApplyStyleSheets",qu[qu.ViewUsageData=22]="ViewUsageData",qu[qu.CreateSSCSite=23]="CreateSSCSite",qu[qu.ManageSubwebs=24]="ManageSubwebs",qu[qu.CreateGroups=25]="CreateGroups",qu[qu.ManagePermissions=26]="ManagePermissions",qu[qu.BrowseDirectories=27]="BrowseDirectories",qu[qu.BrowseUserInfo=28]="BrowseUserInfo",qu[qu.AddDelPrivateWebParts=29]="AddDelPrivateWebParts",qu[qu.UpdatePersonalWebParts=30]="UpdatePersonalWebParts",qu[qu.ManageWeb=31]="ManageWeb",qu[qu.AnonymousSearchAccessWebLists=32]="AnonymousSearchAccessWebLists",qu[qu.UseClientIntegration=37]="UseClientIntegration",qu[qu.UseRemoteAPIs=38]="UseRemoteAPIs",qu[qu.ManageAlerts=39]="ManageAlerts",qu[qu.CreateAlerts=40]="CreateAlerts",qu[qu.EditMyUserInfo=41]="EditMyUserInfo",qu[qu.EnumeratePermissions=63]="EnumeratePermissions",qu[qu.FullMask=65]="FullMask",me(Gn,"roleAssignments",$u),me(Gn,"firstUniqueAncestorSecurableObject",Mt),Gn.prototype.getUserEffectivePermissions=dc,Gn.prototype.getCurrentUserEffectivePermissions=hc,Gn.prototype.breakRoleInheritance=fc,Gn.prototype.resetRoleInheritance=yc,Gn.prototype.userHasPermissions=gc,Gn.prototype.currentUserHasPermissions=vc,Gn.prototype.hasPermissions=mc,me(Nn,"roleAssignments",$u),me(Nn,"firstUniqueAncestorSecurableObject",Mt),Nn.prototype.getUserEffectivePermissions=dc,Nn.prototype.getCurrentUserEffectivePermissions=hc,Nn.prototype.breakRoleInheritance=fc,Nn.prototype.resetRoleInheritance=yc,Nn.prototype.userHasPermissions=gc,Nn.prototype.currentUserHasPermissions=vc,Nn.prototype.hasPermissions=mc,me(vn,"roleDefinitions",tc),me(vn,"roleAssignments",$u),me(vn,"firstUniqueAncestorSecurableObject",Mt),vn.prototype.getUserEffectivePermissions=dc,vn.prototype.getCurrentUserEffectivePermissions=hc,vn.prototype.breakRoleInheritance=fc,vn.prototype.resetRoleInheritance=yc,vn.prototype.userHasPermissions=gc,vn.prototype.currentUserHasPermissions=vc,vn.prototype.hasPermissions=mc,(Mu=Tu=Tu||{})[Mu.None=0]="None",Mu[Mu.View=1]="View",Mu[Mu.Edit=2]="Edit",Mu[Mu.Owner=3]="Owner",(ju=wu=wu||{})[ju.Unknown=0]="Unknown",ju[ju.File=1]="File",ju[ju.Folder=2]="Folder",ju[ju.Item=3]="Item",ju[ju.List=4]="List",ju[ju.Web=5]="Web",ju[ju.Max=6]="Max",(Bu=Pu=Pu||{})[Bu.None=0]="None",Bu[Bu.AllowList=1]="AllowList",Bu[Bu.BlockList=2]="BlockList",(Fu=Iu=Iu||{})[Fu.CompletedSuccessfully=0]="CompletedSuccessfully",Fu[Fu.AccessRequestsQueued=1]="AccessRequestsQueued",Fu[Fu.NoResolvedUsers=-1]="NoResolvedUsers",Fu[Fu.AccessDenied=-2]="AccessDenied",Fu[Fu.CrossSiteRequestNotSupported=-3]="CrossSiteRequestNotSupported",Fu[Fu.UnknowError=-4]="UnknowError",Fu[Fu.EmailBodyTooLong=-5]="EmailBodyTooLong",Fu[Fu.ListUniqueScopesExceeded=-6]="ListUniqueScopesExceeded",Fu[Fu.CapabilityDisabled=-7]="CapabilityDisabled",Fu[Fu.ObjectNotSupported=-8]="ObjectNotSupported",Fu[Fu.NestedGroupsNotSupported=-9]="NestedGroupsNotSupported",(ku=_u=_u||{})[ku.Uninitialized=0]="Uninitialized",ku[ku.Direct=1]="Direct",ku[ku.OrganizationView=2]="OrganizationView",ku[ku.OrganizationEdit=3]="OrganizationEdit",ku[ku.AnonymousView=4]="AnonymousView",ku[ku.AnonymousEdit=5]="AnonymousEdit",ku[ku.Flexible=6]="Flexible",(Lu=Ou=Ou||{})[Lu.None=0]="None",Lu[Lu.Guest=1]="Guest",Lu[Lu.Reader=2]="Reader",Lu[Lu.Contributor=3]="Contributor",Lu[Lu.WebDesigner=4]="WebDesigner",Lu[Lu.Administrator=5]="Administrator",di.prototype.shareWith=function(e,t,n,r){return void 0===t&&(t=Tu.View),void 0===n&&(n=!1),Cc(this,e,t,n,!1,r)},di.prototype.getShareLink=Sc,di.prototype.checkSharingPermissions=Tc,di.prototype.getSharingInformation=wc,di.prototype.getObjectSharingSettings=Pc,di.prototype.unshare=Ic,di.prototype.deleteSharingLinkByKind=_c,di.prototype.unshareLink=Oc,Uo.prototype.shareWith=function(r,i,o,s,a){return void 0===i&&(i=Tu.View),void 0===o&&(o=!1),void 0===s&&(s=!1),M(this,void 0,void 0,function(){var t,n;return q(this,function(e){switch(e.label){case 0:return t=this.addBatchDependency(),[4,this.getShareable()];case 1:return n=e.sent(),t(),[2,n.shareWith(r,i,o,s,a)]}})})},Uo.prototype.getShareLink=function(r,i){return void 0===i&&(i=null),M(this,void 0,void 0,function(){var t,n;return q(this,function(e){switch(e.label){case 0:return t=this.addBatchDependency(),[4,this.getShareable()];case 1:return n=e.sent(),t(),[2,n.getShareLink(r,i)]}})})},Uo.prototype.checkSharingPermissions=function(r){return M(this,void 0,void 0,function(){var t,n;return q(this,function(e){switch(e.label){case 0:return t=this.addBatchDependency(),[4,this.getShareable()];case 1:return n=e.sent(),t(),[2,n.checkSharingPermissions(r)]}})})},Uo.prototype.getSharingInformation=function(r,i){return M(this,void 0,void 0,function(){var t,n;return q(this,function(e){switch(e.label){case 0:return t=this.addBatchDependency(),[4,this.getShareable()];case 1:return n=e.sent(),t(),[2,n.getSharingInformation(r,i)]}})})},Uo.prototype.getObjectSharingSettings=function(r){return void 0===r&&(r=!0),M(this,void 0,void 0,function(){var t,n;return q(this,function(e){switch(e.label){case 0:return t=this.addBatchDependency(),[4,this.getShareable()];case 1:return n=e.sent(),t(),[2,n.getObjectSharingSettings(r)]}})})},Uo.prototype.unshare=function(){return M(this,void 0,void 0,function(){var t,n;return q(this,function(e){switch(e.label){case 0:return t=this.addBatchDependency(),[4,this.getShareable()];case 1:return n=e.sent(),t(),[2,n.unshare()]}})})},Uo.prototype.deleteSharingLinkByKind=function(r){return M(this,void 0,void 0,function(){var t,n;return q(this,function(e){switch(e.label){case 0:return t=this.addBatchDependency(),[4,this.getShareable()];case 1:return n=e.sent(),t(),[2,n.deleteSharingLinkByKind(r)]}})})},Uo.prototype.unshareLink=function(r,i){return M(this,void 0,void 0,function(){var t,n;return q(this,function(e){switch(e.label){case 0:return t=this.addBatchDependency(),[4,this.getShareable()];case 1:return n=e.sent(),t(),[2,n.unshareLink(r,i)]}})})},Gn.prototype.shareWith=function(e,t,n,r){return void 0===t&&(t=Tu.View),void 0===n&&(n=!1),Cc(this,e,t,n,!1,r)},Gn.prototype.getShareLink=Sc,Gn.prototype.checkSharingPermissions=Tc,Gn.prototype.getSharingInformation=wc,Gn.prototype.getObjectSharingSettings=Pc,Gn.prototype.unshare=Ic,Gn.prototype.deleteSharingLinkByKind=_c,Gn.prototype.unshareLink=Oc,vn.prototype.shareWith=function(r,i,o){return void 0===i&&(i=Tu.View),M(this,void 0,void 0,function(){var t,n;return q(this,function(e){switch(e.label){case 0:return t=this.addBatchDependency(),[4,new jt(vt(this.toUrl()),"/_api/web/url").get()];case 1:return n=e.sent(),t(),[2,this.shareObject(v(n,"/_layouts/15/aclinv.aspx?forSharing=1&mbypass=1"),r,i,o)]}})})},vn.prototype.shareObject=function(e,t,n,r,i,o,s,a){return void 0===o&&(o=!1),void 0===s&&(s=!1),void 0===a&&(a=!0),bc(this,{emailData:r,group:i,includeAnonymousLinkInEmail:s,loginNames:t,propagateAcl:o,role:n,url:e,useSimplifiedRoles:a})},vn.prototype.shareObjectRaw=function(e){return bc(this,e,!0)},vn.prototype.unshareObject=function(e){return Rt(mn(this,"unshareObject"),lt({url:e}))};var Rc,Nc=(B(xc,Rc=Lt),xc.prototype.execute=function(e){return Rt(this,lt(e,pt({"Content-Type":"application/json;charset=utf-8"})))},xc.prototype.createSiteDesign=function(e){return this.clone(Uc,"CreateSiteDesign").execute({info:e})},xc.prototype.applySiteDesign=function(e,t){return this.clone(Uc,"ApplySiteDesign").execute({siteDesignId:e,webUrl:t})},xc.prototype.getSiteDesigns=function(){return this.clone(Uc,"GetSiteDesigns").execute({})},xc.prototype.getSiteDesignMetadata=function(e){return this.clone(Uc,"GetSiteDesignMetadata").execute({id:e})},xc.prototype.updateSiteDesign=function(e){return this.clone(Uc,"UpdateSiteDesign").execute({updateInfo:e})},xc.prototype.deleteSiteDesign=function(e){return this.clone(Uc,"DeleteSiteDesign").execute({id:e})},xc.prototype.getSiteDesignRights=function(e){return this.clone(Uc,"GetSiteDesignRights").execute({id:e})},xc.prototype.grantSiteDesignRights=function(e,t,n){return void 0===n&&(n=1),this.clone(Uc,"GrantSiteDesignRights").execute({grantedRights:n.toString(),id:e,principalNames:t})},xc.prototype.revokeSiteDesignRights=function(e,t){return this.clone(Uc,"RevokeSiteDesignRights").execute({id:e,principalNames:t})},xc.prototype.addSiteDesignTask=function(e,t){return this.clone(Uc,"AddSiteDesignTask").execute({webUrl:e,siteDesignId:t})},xc.prototype.addSiteDesignTaskToCurrentWeb=function(e){return this.clone(Uc,"AddSiteDesignTaskToCurrentWeb").execute({siteDesignId:e})},xc.prototype.getSiteDesignTask=function(n){return M(this,void 0,void 0,function(){var t;return q(this,function(e){switch(e.label){case 0:return[4,this.clone(Uc,"GetSiteDesignTask").execute({taskId:n})];case 1:return[2,E(t=e.sent(),"ID")?t:null]}})})},xc.prototype.getSiteDesignRun=function(e,t){return this.clone(Uc,"GetSiteDesignRun").execute({webUrl:e,siteDesignId:t})},xc.prototype.getSiteDesignRunStatus=function(e,t){return this.clone(Uc,"GetSiteDesignRunStatus").execute({webUrl:e,runId:t})},j([mt("sd.createSiteDesign")],xc.prototype,"createSiteDesign",null),j([mt("sd.applySiteDesign")],xc.prototype,"applySiteDesign",null),j([mt("sd.getSiteDesigns")],xc.prototype,"getSiteDesigns",null),j([mt("sd.getSiteDesignMetadata")],xc.prototype,"getSiteDesignMetadata",null),j([mt("sd.updateSiteDesign")],xc.prototype,"updateSiteDesign",null),j([mt("sd.deleteSiteDesign")],xc.prototype,"deleteSiteDesign",null),j([mt("sd.getSiteDesignRights")],xc.prototype,"getSiteDesignRights",null),j([mt("sd.grantSiteDesignRights")],xc.prototype,"grantSiteDesignRights",null),j([mt("sd.revokeSiteDesignRights")],xc.prototype,"revokeSiteDesignRights",null),j([mt("sd.addSiteDesignTask")],xc.prototype,"addSiteDesignTask",null),j([mt("sd.addSiteDesignTaskToCurrentWeb")],xc.prototype,"addSiteDesignTaskToCurrentWeb",null),j([mt("sd.getSiteDesignTask")],xc.prototype,"getSiteDesignTask",null),j([mt("sd.getSiteDesignRun")],xc.prototype,"getSiteDesignRun",null),j([mt("sd.getSiteDesignRunStatus")],xc.prototype,"getSiteDesignRunStatus",null),xc),Ac=function(e,t){return new Nc(e,t)},Uc=function(e,t){return void 0===t&&(t=""),Ac(e,t)};function xc(e,t){void 0===t&&(t="");var n="string"==typeof e?e:e.toUrl();return Rc.call(this,vt(n),"_api/Microsoft.Sharepoint.Utilities.WebTemplateExtensions.SiteScriptUtility."+t)||this}vn.prototype.getSiteDesignRuns=function(e){return Ac(this,"").getSiteDesignRun(void 0,e)},vn.prototype.addSiteDesignTask=function(e){return Ac(this,"").addSiteDesignTaskToCurrentWeb(e)},vn.prototype.getSiteDesignRunStatus=function(e){return Ac(this,"").getSiteDesignRunStatus(void 0,e)},Reflect.defineProperty(on.prototype,"siteDesigns",{configurable:!0,enumerable:!0,get:function(){return Ac(this._baseUrl)}}),me(vn,"siteGroups",Qu),me(vn,"associatedOwnerGroup",Qu,"associatedownergroup"),me(vn,"associatedMemberGroup",Qu,"associatedmembergroup"),me(vn,"associatedVisitorGroup",Qu,"associatedvisitorgroup"),vn.prototype.createDefaultAssociatedGroups=function(n,r,i,o,s){return void 0===i&&(i=!1),void 0===o&&(o=!0),M(this,void 0,void 0,function(){var t;return q(this,function(e){switch(e.label){case 0:return[4,this.breakRoleInheritance(i,o)];case 1:return e.sent(),(t=this.clone(mn,"createDefaultAssociatedGroups(userLogin=@u,userLogin2=@v,groupNameSeed=@s)")).query.set("@u","'"+un(r||"")+"'"),t.query.set("@v","'"+un(s||"")+"'"),t.query.set("@s","'"+un(n||"")+"'"),[2,Rt(t)]}})})};var Dc,Lc,kc,Fc=(B(Mc,Lc=Lt),Mc.prototype.execute=function(e){return Rt(this,lt(e))},Mc.prototype.getSiteScripts=function(){return this.clone(jc,"GetSiteScripts",!0).execute({})},Mc.prototype.createSiteScript=function(e,t,n){return this.clone(jc,"CreateSiteScript(Title=@title,Description=@desc)?@title='"+un(e)+"'&@desc='"+un(t)+"'").execute(n)},Mc.prototype.getSiteScriptMetadata=function(e){return this.clone(jc,"GetSiteScriptMetadata").execute({id:e})},Mc.prototype.deleteSiteScript=function(e){return this.clone(jc,"DeleteSiteScript").execute({id:e})},Mc.prototype.updateSiteScript=function(e,t){return t&&(e.Content=JSON.stringify(t)),this.clone(jc,"UpdateSiteScript").execute({updateInfo:e})},Mc.prototype.getSiteScriptFromList=function(e){return this.clone(jc,"GetSiteScriptFromList").execute({listUrl:e})},Mc.prototype.getSiteScriptFromWeb=function(e,t){return this.clone(jc,"getSiteScriptFromWeb").execute({webUrl:e,info:t})},Mc.prototype.executeSiteScriptAction=function(e){return this.clone(jc,"executeSiteScriptAction").execute({actionDefinition:e})},j([mt("ss.getSiteScripts")],Mc.prototype,"getSiteScripts",null),j([mt("ss.createSiteScript")],Mc.prototype,"createSiteScript",null),j([mt("ss.getSiteScriptMetadata")],Mc.prototype,"getSiteScriptMetadata",null),j([mt("ss.deleteSiteScript")],Mc.prototype,"deleteSiteScript",null),j([mt("ss.updateSiteScript")],Mc.prototype,"updateSiteScript",null),j([mt("ss.getSiteScriptFromList")],Mc.prototype,"getSiteScriptFromList",null),j([mt("ss.getSiteScriptFromWeb")],Mc.prototype,"getSiteScriptFromWeb",null),j([mt("ss.executeSiteScriptAction")],Mc.prototype,"executeSiteScriptAction",null),Mc),Bc=function(e,t){return new Fc(e,t)},jc=function(e,t){return void 0===t&&(t=""),Bc(e,t)};function Mc(e,t){void 0===t&&(t="");var n="string"==typeof e?e:e.toUrl();return Lc.call(this,vt(n),"_api/Microsoft.Sharepoint.Utilities.WebTemplateExtensions.SiteScriptUtility."+t)||this}(kc=Dc=Dc||{})[kc.Success=0]="Success",kc[kc.Failure=1]="Failure",kc[kc.NoOp=2]="NoOp",kc[kc.SucceededWithException=3]="SucceededWithException",vn.prototype.getSiteScript=function(e){return Bc(this.toUrl(),"").getSiteScriptFromWeb(void 0,e)},Nn.prototype.getSiteScript=function(){return M(this,void 0,void 0,function(){var t,n,r;return q(this,function(e){switch(e.label){case 0:return[4,this.clone(An).rootFolder.get()];case 1:return t=e.sent(),[4,mn(vt(this.toUrl())).select("Url").get()];case 2:return n=e.sent(),r=v(n.Url,"Lists",t.Name),[2,Bc(this,"").getSiteScriptFromList(r)]}})})},Reflect.defineProperty(on.prototype,"siteScripts",{configurable:!0,enumerable:!0,get:function(){return Bc(this._baseUrl)}}),me(vn,"siteUsers",Wu),me(vn,"currentUser",Hu,"currentuser"),vn.prototype.ensureUser=function(n){return M(this,void 0,void 0,function(){var t;return q(this,function(e){switch(e.label){case 0:return[4,Rt(this.clone(mn,"ensureuser"),lt({logonName:n}))];case 1:return[2,{data:t=e.sent(),user:Hu(Qt(t))}]}})})},vn.prototype.getUserById=function(e){return Hu(this,"getUserById("+e+")")};var qc,Gc,Wc,Vc,Hc,Kc,Qc,zc,Xc,Jc,$c=(B(il,Kc=jt),Object.defineProperty(il.prototype,"my",{get:function(){return tl(this)},enumerable:!0,configurable:!0}),il.prototype.getFollowedSitesUri=function(){return M(this,void 0,void 0,function(){var t;return q(this,function(e){switch(e.label){case 0:return[4,this.clone(Zc,"FollowedSitesUri").get()];case 1:return[2,(t=e.sent()).FollowedSitesUri||t]}})})},il.prototype.getFollowedDocumentsUri=function(){return M(this,void 0,void 0,function(){var t;return q(this,function(e){switch(e.label){case 0:return[4,this.clone(Zc,"FollowedDocumentsUri").get()];case 1:return[2,(t=e.sent()).FollowedDocumentsUri||t]}})})},il.prototype.follow=function(t){return M(this,void 0,void 0,function(){return q(this,function(e){switch(e.label){case 0:return[4,Rt(this.clone(Zc,"follow"),this.createSocialActorInfoRequestBody(t))];case 1:return[2,e.sent()]}})})},il.prototype.isFollowed=function(t){return M(this,void 0,void 0,function(){return q(this,function(e){switch(e.label){case 0:return[4,Rt(this.clone(Zc,"isfollowed"),this.createSocialActorInfoRequestBody(t))];case 1:return[2,e.sent()]}})})},il.prototype.stopFollowing=function(t){return M(this,void 0,void 0,function(){return q(this,function(e){switch(e.label){case 0:return[4,Rt(this.clone(Zc,"stopfollowing"),this.createSocialActorInfoRequestBody(t))];case 1:return[2,e.sent()]}})})},il.prototype.createSocialActorInfoRequestBody=function(e){return lt({actor:Object.assign(dt("SP.Social.SocialActorInfo"),{Id:null},e)})},j([mt("soc.getFollowedSitesUri")],il.prototype,"getFollowedSitesUri",null),j([mt("soc.getFollowedDocumentsUri")],il.prototype,"getFollowedDocumentsUri",null),j([mt("soc.follow")],il.prototype,"follow",null),j([mt("soc.isFollowed")],il.prototype,"isFollowed",null),j([mt("soc.stopFollowing")],il.prototype,"stopFollowing",null),j([Kt("_api/social.following")],il)),Yc=function(e){return new $c(e)},Zc=function(e,t){return new $c(e,t)},el=(B(rl,Hc=jt),rl.prototype.followed=function(n){return M(this,void 0,void 0,function(){var t;return q(this,function(e){switch(e.label){case 0:return[4,this.clone(nl,"followed(types="+n+")")()];case 1:return[2,E(t=e.sent(),"Followed")?t.Followed.results:t]}})})},rl.prototype.followedCount=function(n){return M(this,void 0,void 0,function(){var t;return q(this,function(e){switch(e.label){case 0:return[4,this.clone(nl,"followedcount(types="+n+")")()];case 1:return[2,(t=e.sent()).FollowedCount||t]}})})},rl.prototype.followers=function(){return M(this,void 0,void 0,function(){var t;return q(this,function(e){switch(e.label){case 0:return[4,this.clone(nl,"followers")()];case 1:return[2,E(t=e.sent(),"Followers")?t.Followers.results:t]}})})},rl.prototype.suggestions=function(){return M(this,void 0,void 0,function(){var t;return q(this,function(e){switch(e.label){case 0:return[4,this.clone(nl,"suggestions")()];case 1:return[2,E(t=e.sent(),"Suggestions")?t.Suggestions.results:t]}})})},j([mt("msoc.followed")],rl.prototype,"followed",null),j([mt("msoc.followedCount")],rl.prototype,"followedCount",null),j([mt("msoc.followers")],rl.prototype,"followers",null),j([mt("msoc.suggestions")],rl.prototype,"suggestions",null),j([Kt("my")],rl)),tl=Dt(el),nl=function(e,t){return tl(e,t)};function rl(){return null!==Hc&&Hc.apply(this,arguments)||this}function il(){return null!==Kc&&Kc.apply(this,arguments)||this}(Jc=qc=qc||{})[Jc.User=0]="User",Jc[Jc.Document=1]="Document",Jc[Jc.Site=2]="Site",Jc[Jc.Tag=3]="Tag",(Xc=Gc=Gc||{})[Xc.None=0]="None",Xc[Xc.User=1]="User",Xc[Xc.Document=2]="Document",Xc[Xc.Site=4]="Site",Xc[Xc.Tag=8]="Tag",Xc[Xc.ExcludeContentWithoutFeeds=268435456]="ExcludeContentWithoutFeeds",Xc[Xc.IncludeGroupsSites=536870912]="IncludeGroupsSites",Xc[Xc.WithinLast24Hours=1073741824]="WithinLast24Hours",(zc=Wc=Wc||{})[zc.Ok=0]="Ok",zc[zc.AlreadyFollowing=1]="AlreadyFollowing",zc[zc.LimitReached=2]="LimitReached",zc[zc.InternalError=3]="InternalError",(Qc=Vc=Vc||{})[Qc.OK=0]="OK",Qc[Qc.InvalidRequest=1]="InvalidRequest",Qc[Qc.AccessDenied=2]="AccessDenied",Qc[Qc.ItemNotFound=3]="ItemNotFound",Qc[Qc.InvalidOperation=4]="InvalidOperation",Qc[Qc.ItemNotModified=5]="ItemNotModified",Qc[Qc.InternalError=6]="InternalError",Qc[Qc.CacheReadError=7]="CacheReadError",Qc[Qc.CacheUpdateError=8]="CacheUpdateError",Qc[Qc.PersonalSiteNotFound=9]="PersonalSiteNotFound",Qc[Qc.FailedToCreatePersonalSite=10]="FailedToCreatePersonalSite",Qc[Qc.NotAuthorizedToCreatePersonalSite=11]="NotAuthorizedToCreatePersonalSite",Qc[Qc.CannotCreatePersonalSite=12]="CannotCreatePersonalSite",Qc[Qc.LimitReached=13]="LimitReached",Qc[Qc.AttachmentError=14]="AttachmentError",Qc[Qc.PartialData=15]="PartialData",Qc[Qc.FeatureDisabled=16]="FeatureDisabled",Qc[Qc.StorageQuotaExceeded=17]="StorageQuotaExceeded",Qc[Qc.DatabaseError=18]="DatabaseError",Reflect.defineProperty(on.prototype,"social",{configurable:!0,enumerable:!0,get:function(){return Yc(this._baseUrl)}});var ol,sl=(B(cl,ol=Lt),cl.prototype.excute=function(e){return Rt(this,lt(e))},cl.prototype.sendEmail=function(e){var t={properties:P(dt("SP.Utilities.EmailProperties"),{Body:e.Body,From:e.From,Subject:e.Subject})};return e.To&&0<e.To.length&&(t.properties=P(t.properties,{To:{results:e.To}})),e.CC&&0<e.CC.length&&(t.properties=P(t.properties,{CC:{results:e.CC}})),e.BCC&&0<e.BCC.length&&(t.properties=P(t.properties,{BCC:{results:e.BCC}})),e.AdditionalHeaders&&(t.properties=P(t.properties,{AdditionalHeaders:hr(e.AdditionalHeaders)})),mt.configure(this.clone(ul,"SendEmail",!0),"u.sendEmail").excute(t)},cl.prototype.getCurrentUserEmailAddresses=function(){return mt.configure(this.clone(ul,"GetCurrentUserEmailAddresses",!0),"u.getCurrentUserEmailAddresses").excute({})},cl.prototype.resolvePrincipal=function(e,t,n,r,i,o){void 0===o&&(o=!1);var s={addToUserInfoList:i,input:e,inputIsEmailOnly:r,matchUserInfoList:o,scopes:t,sources:n},a=this.clone(ul,"ResolvePrincipalInCurrentContext",!0);return mt.configure(a,"u.ResolvePrincipalInCurrentContext").excute(s)},cl.prototype.searchPrincipals=function(e,t,n,r,i){var o={groupName:r,input:e,maxCount:i,scopes:t,sources:n},s=this.clone(ul,"SearchPrincipalsUsingContextWeb",!0);return mt.configure(s,"u.SearchPrincipalsUsingContextWeb").excute(o)},cl.prototype.createEmailBodyForInvitation=function(e){var t={pageAddress:e},n=this.clone(ul,"CreateEmailBodyForInvitation",!0);return mt.configure(n,"u.CreateEmailBodyForInvitation").excute(t)},cl.prototype.expandGroupsToPrincipals=function(e,t){void 0===t&&(t=30);var n={inputs:e,maxCount:t},r=this.clone(ul,"ExpandGroupsToPrincipals",!0);return mt.configure(r,"u.ExpandGroupsToPrincipals").excute(n)},cl.prototype.createWikiPage=function(r){return M(this,void 0,void 0,function(){var t,n;return q(this,function(e){switch(e.label){case 0:return t=this.clone(ul,"CreateWikiPageInContextWeb",!0),[4,mt.configure(t,"u.CreateWikiPageInContextWeb").excute({parameters:r})];case 1:return[2,{data:n=e.sent(),file:hi(Qt(n))}]}})})},cl),al=Dt(sl),ul=function(e,t){return al(e,t)};function cl(e,t){var n="string"==typeof e?e:e.toUrl();return ol.call(this,vt(n),"_api/SP.Utilities.Utility."+t)||this}Reflect.defineProperty(on.prototype,"utility",{configurable:!0,enumerable:!0,get:function(){return al(this._baseUrl,"")}});var ll,pl,dl=(B(vl,pl=Ft),vl.prototype.getById=function(e){return mt.configure(yl(this).concat("('"+e+"')"),"subs.getById")},vl.prototype.add=function(r,i,o){return M(this,void 0,void 0,function(){var t,n;return q(this,function(e){switch(e.label){case 0:return t={expirationDateTime:i,notificationUrl:r,resource:this.toUrl()},o&&(t.clientState=o),[4,Rt(this,lt(t,pt({"Content-Type":"application/json"})))];case 1:return[2,{data:n=e.sent(),subscription:this.getById(n.id)}]}})})},j([mt("subs.add")],vl.prototype,"add",null),j([Kt("subscriptions")],vl)),hl=Dt(dl),fl=(B(gl,ll=jt),gl.prototype.update=function(n,r,i){return M(this,void 0,void 0,function(){var t;return q(this,function(e){switch(e.label){case 0:return t={},n&&(t.expirationDateTime=n),r&&(t.notificationUrl=r),i&&(t.clientState=i),[4,At(this,lt(t,pt({"Content-Type":"application/json"})))];case 1:return[2,{data:e.sent(),subscription:this}]}})})},gl.prototype.delete=function(){return Nt(this)},j([mt("sub.update")],gl.prototype,"update",null),j([mt("sub.delete")],gl.prototype,"delete",null),gl),yl=Dt(fl);function gl(){return null!==ll&&ll.apply(this,arguments)||this}function vl(){return null!==pl&&pl.apply(this,arguments)||this}me(Nn,"subscriptions",hl),me(Nn,"userCustomActions",Ga),me(vn,"userCustomActions",Ga),me(ln,"userCustomActions",Ga);var ml,bl,Sl,Tl,wl,Pl=(B(Al,Tl=Ft),Al.prototype.getById=function(e){return Ol(this).concat("('"+e+"')")},Al.prototype.getByTitle=function(e){return Ol(this,"getByTitle('"+e+"')")},Al.prototype.add=function(r,i,o){return void 0===i&&(i=!1),void 0===o&&(o={}),M(this,void 0,void 0,function(){var t,n;return q(this,function(e){switch(e.label){case 0:return t=lt(Object.assign(dt("SP.View"),{PersonalView:i,Title:r},o)),[4,Rt(this.clone(Il,null),t)];case 1:return[2,{data:n=e.sent(),view:this.getById(n.Id)}]}})})},j([mt("vs.add")],Al.prototype,"add",null),j([Kt("views")],Al)),Il=Dt(Pl),_l=(B(Nl,Sl=jt),Object.defineProperty(Nl.prototype,"fields",{get:function(){return El(this)},enumerable:!0,configurable:!0}),Nl.prototype.renderAsHtml=function(){return this.clone(Ol,"renderashtml")()},Nl.prototype.setViewXml=function(e){return Rt(this.clone(Ol,"SetViewXml"),lt({viewXml:e}))},j([mt("v.renderAsHtml")],Nl.prototype,"renderAsHtml",null),j([mt("v.setViewXml")],Nl.prototype,"setViewXml",null),Nl),Ol=Dt(_l),Cl=(B(Rl,bl=Ft),Rl.prototype.getSchemaXml=function(){return this.clone(El,"schemaxml")()},Rl.prototype.add=function(e){return Rt(this.clone(El,"addviewfield('"+e+"')"))},Rl.prototype.move=function(e,t){return Rt(this.clone(El,"moveviewfieldto"),lt({field:e,index:t}))},Rl.prototype.removeAll=function(){return Rt(this.clone(El,"removeallviewfields"))},Rl.prototype.remove=function(e){return Rt(this.clone(El,"removeviewfield('"+e+"')"))},j([mt("vfs.getSchemaXml")],Rl.prototype,"getSchemaXml",null),j([mt("vfs.add")],Rl.prototype,"add",null),j([mt("vfs.move")],Rl.prototype,"move",null),j([mt("vfs.removeAll")],Rl.prototype,"removeAll",null),j([mt("vfs.remove")],Rl.prototype,"remove",null),j([Kt("viewfields")],Rl)),El=Dt(Cl);function Rl(){return null!==bl&&bl.apply(this,arguments)||this}function Nl(){var t=null!==Sl&&Sl.apply(this,arguments)||this;return t.delete=Vt("vw"),t.update=t._update("SP.View",function(e){return{data:e,view:t}}),t}function Al(){return null!==Tl&&Tl.apply(this,arguments)||this}(wl=ml=ml||{})[wl.DefaultValue=0]="DefaultValue",wl[wl.Recursive=1]="Recursive",wl[wl.RecursiveAll=2]="RecursiveAll",wl[wl.FilesOnly=3]="FilesOnly",me(Nn,"views",Il),me(Nn,"defaultView",Ol,"DefaultView"),Nn.prototype.getView=function(e){return Ol(this,"getView('"+e+"')")};var Ul,xl,Dl,Ll,kl,Fl=(B(Kl,Ll=Lt),Object.defineProperty(Kl.prototype,"scope",{get:function(){return mt.configure(kt(this,"Scope"),"f.scope")},enumerable:!0,configurable:!0}),Object.defineProperty(Kl.prototype,"webparts",{get:function(){return ql(this,"webparts")},enumerable:!0,configurable:!0}),Kl.prototype.export=function(e){return Rt(this.clone(jl,"ExportWebPart"),lt({webPartId:e}))},Kl.prototype.import=function(e){return Rt(this.clone(jl,"ImportWebPart"),lt({webPartXml:e}))},Kl),Bl=function(e,t){return new Fl(e,t)},jl=function(e,t){return Bl(e,t)},Ml=(B(Hl,Dl=Ft),Hl.prototype.getById=function(e){return Wl(this,"getbyid('"+e+"')")},Hl.prototype.getByControlId=function(e){return Wl(this,"getByControlId('"+e+"')")},Hl),ql=Dt(Ml),Gl=(B(Vl,xl=jt),Object.defineProperty(Vl.prototype,"webpart",{get:function(){return Mt(this,"webpart")},enumerable:!0,configurable:!0}),Vl.prototype.saveChanges=function(){return Rt(this.clone(Wl,"SaveWebPartChanges"))},Vl.prototype.moveTo=function(e,t){return Rt(this.clone(Wl,"MoveWebPartTo(zoneID='"+e+"', zoneIndex="+t+")"))},Vl.prototype.close=function(){return Rt(this.clone(Wl,"CloseWebPart"))},Vl.prototype.open=function(){return Rt(this.clone(Wl,"OpenWebPart"))},Vl.prototype.delete=function(){return Rt(this.clone(Wl,"DeleteWebPart"))},Vl),Wl=Dt(Gl);function Vl(){return null!==xl&&xl.apply(this,arguments)||this}function Hl(){return null!==Dl&&Dl.apply(this,arguments)||this}function Kl(){return null!==Ll&&Ll.apply(this,arguments)||this}(kl=Ul=Ul||{})[kl.User=0]="User",kl[kl.Shared=1]="Shared",di.prototype.getLimitedWebPartManager=function(e){return void 0===e&&(e=Ul.Shared),Bl(this,"getLimitedWebPartManager(scope="+e+")")};var Ql=new on;function zl(r){return function(e){return B(t,n=e),t;function t(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return n.call(this,e[0],1<e.length&&void 0!==e[1]?e[1]:r)||this}var n}}function Xl(){return function(e){return B(t,n=e),t.prototype.delete=function(){return xr(this)},t;function t(){return null!==n&&n.apply(this,arguments)||this}var n}}function Jl(){return function(e){return B(t,n=e),t.prototype.delete=function(e){return void 0===e&&(e="*"),xr(this,pt({"If-Match":e}))},t;function t(){return null!==n&&n.apply(this,arguments)||this}var n}}function $l(){return function(e){return B(t,n=e),t.prototype.update=function(e){return Dr(this,lt(e))},t;function t(){return null!==n&&n.apply(this,arguments)||this}var n}}function Yl(){return function(e){return B(t,n=e),t.prototype.update=function(e,t){return void 0===t&&(t="*"),Dr(this,lt(e,pt({"If-Match":t})))},t;function t(){return null!==n&&n.apply(this,arguments)||this}var n}}function Zl(){return function(e){return B(t,n=e),t.prototype.add=function(e){return Ur(this,lt(e))},t;function t(){return null!==n&&n.apply(this,arguments)||this}var n}}function ep(r){return function(e){return B(t,n=e),t.prototype.getById=function(e){return r(this,e)},t;function t(){return null!==n&&n.apply(this,arguments)||this}var n}}var tp,np,rp,ip,op,sp,ap,up=kr((B(wp,ap=oi),Object.defineProperty(wp.prototype,"threads",{get:function(){return pp(this)},enumerable:!0,configurable:!0}),j([$l(),Xl()],wp))),cp=kr((B(Tp,sp=ri),j([zl("conversations"),Zl(),ep(up)],Tp))),lp=kr((B(Sp,op=oi),Object.defineProperty(Sp.prototype,"posts",{get:function(){return fp(this)},enumerable:!0,configurable:!0}),Sp.prototype.reply=function(e){return Ur(this.clone(lp,"reply"),lt(e))},j([Xl()],Sp))),pp=kr((B(bp,ip=ri),j([zl("threads"),Zl(),ep(lp)],bp))),dp=(B(mp,rp=oi),mp.prototype.forward=function(e){return Ur(this.clone(hp,"forward"),lt(e))},mp.prototype.reply=function(e){return Ur(this.clone(hp,"reply"),lt(e))},j([Xl()],mp)),hp=kr(dp),fp=kr((B(vp,np=ri),j([zl("posts"),Zl(),ep(hp)],vp))),yp=kr((B(gp,tp=ri),gp.prototype.add=function(e){return Ur(this.clone(yp,"$ref"),lt({"@odata.id":e}))},gp.prototype.remove=function(e){var t=this.clone(yp,"$ref");return t.query.set("$id",e),xr(t)},gp));function gp(){return null!==tp&&tp.apply(this,arguments)||this}function vp(){return null!==np&&np.apply(this,arguments)||this}function mp(){return null!==rp&&rp.apply(this,arguments)||this}function bp(){return null!==ip&&ip.apply(this,arguments)||this}function Sp(){return null!==op&&op.apply(this,arguments)||this}function Tp(){return null!==sp&&sp.apply(this,arguments)||this}function wp(){return null!==ap&&ap.apply(this,arguments)||this}var Pp,Ip,_p=kr((B(Ep,Ip=oi),Ep)),Op=kr((B(Cp,Pp=ri),Cp.prototype.addFile=function(e,t){return Ur(this,lt((n={contentBytes:t,name:e},Object.assign({"@odata.type":"#microsoft.graph.fileAttachment"},n))));var n},j([zl("attachments"),ep(_p)],Cp)));function Cp(){return null!==Pp&&Pp.apply(this,arguments)||this}function Ep(){return null!==Ip&&Ip.apply(this,arguments)||this}me(dp,"attachments",Op);var Rp,Np,Ap,Up,xp,Dp,Lp=(B(jp,Up=oi),jp.prototype.getMemberObjects=function(e){return void 0===e&&(e=!1),Ur(this.clone(kp,"getMemberObjects"),lt({securityEnabledOnly:e}))},jp.prototype.getMemberGroups=function(e){return void 0===e&&(e=!1),Ur(this.clone(kp,"getMemberGroups"),lt({securityEnabledOnly:e}))},jp.prototype.checkMemberGroups=function(e){return Ur(this.clone(kp,"checkMemberGroups"),lt({groupIds:e}))},j([Xl()],jp)),kp=kr(Lp),Fp=kr((B(Bp,Ap=ri),Bp.prototype.getByIds=function(e,t){return void 0===t&&(t=Rp.directoryObject),Ur(this.clone(Fp,"getByIds"),lt({ids:e,type:t}))},j([zl("directoryObjects"),ep(kp)],Bp)));function Bp(){return null!==Ap&&Ap.apply(this,arguments)||this}function jp(){return null!==Up&&Up.apply(this,arguments)||this}(Dp=Rp=Rp||{})[Dp.directoryObject=0]="directoryObject",Dp[Dp.user=1]="user",Dp[Dp.group=2]="group",Dp[Dp.device=3]="device",(xp=Np=Np||{})[xp.Office365=0]="Office365",xp[xp.Dynamic=1]="Dynamic",xp[xp.Security=2]="Security";var Mp,qp,Gp,Wp,Vp,Hp,Kp=(B(id,Hp=Lp),id.prototype.addFavorite=function(){return Ur(this.clone(Qp,"addFavorite"))},id.prototype.removeFavorite=function(){return Ur(this.clone(Qp,"removeFavorite"))},id.prototype.resetUnseenCount=function(){return Ur(this.clone(Qp,"resetUnseenCount"))},id.prototype.subscribeByMail=function(){return Ur(this.clone(Qp,"subscribeByMail"))},id.prototype.unsubscribeByMail=function(){return Ur(this.clone(Qp,"unsubscribeByMail"))},id.prototype.getCalendarView=function(e,t){var n=this.clone(Qp,"calendarView");return n.query.set("startDateTime",e.toISOString()),n.query.set("endDateTime",t.toISOString()),n()},j([Xl(),$l()],id)),Qp=kr(Kp),zp=kr((B(rd,Vp=ri),rd.prototype.add=function(r,i,o,s){return void 0===s&&(s={}),M(this,void 0,void 0,function(){var t,n;return q(this,function(e){switch(e.label){case 0:return t=P({displayName:r,mailEnabled:o===Np.Office365,mailNickname:i,securityEnabled:o!==Np.Office365},s),o!==Np.Security&&(t=P(t,{groupTypes:o===Np.Office365?["Unified"]:["DynamicMembership"]})),[4,Ur(this,lt(t))];case 1:return[2,{data:n=e.sent(),group:this.getById(n.id)}]}})})},j([zl("groups"),ep(Qp)],rd))),Xp=kr((B(nd,Wp=ri),j([zl("calendars")],nd))),Jp=kr((B(td,Gp=oi),Object.defineProperty(td.prototype,"events",{get:function(){return Yp(this)},enumerable:!0,configurable:!0}),td)),$p=kr((B(ed,qp=oi),j([Xl(),$l()],ed))),Yp=kr((B(Zp,Mp=ri),Zp.prototype.add=function(n){return M(this,void 0,void 0,function(){var t;return q(this,function(e){switch(e.label){case 0:return[4,Ur(this,lt(n))];case 1:return[2,{data:t=e.sent(),event:this.getById(t.id)}]}})})},j([zl("events"),ep($p)],Zp)));function Zp(){return null!==Mp&&Mp.apply(this,arguments)||this}function ed(){return null!==qp&&qp.apply(this,arguments)||this}function td(){return null!==Gp&&Gp.apply(this,arguments)||this}function nd(){return null!==Wp&&Wp.apply(this,arguments)||this}function rd(){return null!==Vp&&Vp.apply(this,arguments)||this}function id(){return null!==Hp&&Hp.apply(this,arguments)||this}me(Kp,"calendar",Jp,"calendar"),me(Kp,"events",Yp);var od,sd,ad,ud,cd,ld,pd,dd=(B(Od,pd=Lp),Object.defineProperty(Od.prototype,"memberOf",{get:function(){return Fp(this,"memberOf")},enumerable:!0,configurable:!0}),Object.defineProperty(Od.prototype,"people",{get:function(){return yd(this)},enumerable:!0,configurable:!0}),j([$l(),Xl()],Od)),hd=kr(dd),fd=kr((B(_d,ld=ri),j([zl("users"),ep(hd)],_d))),yd=kr((B(Id,cd=ri),j([zl("people")],Id))),gd=kr((B(Pd,ud=oi),j([$l(),Xl()],Pd))),vd=kr((B(wd,ad=ri),wd.prototype.add=function(r,i,o,s,a){return void 0===a&&(a={}),M(this,void 0,void 0,function(){var t,n;return q(this,function(e){switch(e.label){case 0:return t=P({businessPhones:s,emailAddresses:o,givenName:r,surName:i},a),[4,Ur(this,lt(t))];case 1:return n=e.sent(),[2,{contact:this.getById(n.id),data:n}]}})})},j([zl("contacts"),ep(gd)],wd))),md=kr((B(Td,sd=oi),Object.defineProperty(Td.prototype,"contacts",{get:function(){return vd(this)},enumerable:!0,configurable:!0}),Object.defineProperty(Td.prototype,"childFolders",{get:function(){return bd(this,"childFolders")},enumerable:!0,configurable:!0}),j([Xl(),$l()],Td))),bd=kr((B(Sd,od=ri),Sd.prototype.add=function(n,r){return M(this,void 0,void 0,function(){var t;return q(this,function(e){switch(e.label){case 0:return[4,Ur(this,lt({displayName:n,parentFolderId:r}))];case 1:return t=e.sent(),[2,{contactFolder:this.getById(t.id),data:t}]}})})},j([zl("contactFolders"),ep(md)],Sd)));function Sd(){return null!==od&&od.apply(this,arguments)||this}function Td(){return null!==sd&&sd.apply(this,arguments)||this}function wd(){return null!==ad&&ad.apply(this,arguments)||this}function Pd(){return null!==ud&&ud.apply(this,arguments)||this}function Id(){return null!==cd&&cd.apply(this,arguments)||this}function _d(){return null!==ld&&ld.apply(this,arguments)||this}function Od(){return null!==pd&&pd.apply(this,arguments)||this}me(dd,"contacts",vd),me(dd,"contactFolders",bd),me(Kp,"conversations",cp),me(Kp,"acceptedSenders",yp,"acceptedsenders"),me(Kp,"rejectedSenders",yp,"rejectedsenders"),Reflect.defineProperty(ui.prototype,"directoryObjects",{configurable:!0,enumerable:!0,get:function(){return Fp(this)}}),Reflect.defineProperty(ui.prototype,"groups",{configurable:!0,enumerable:!0,get:function(){return zp(this)}});var Cd,Ed,Rd,Nd,Ad,Ud,xd,Dd,Ld=kr((B(Jd,Dd=oi),Object.defineProperty(Jd.prototype,"trending",{get:function(){return Fd(this)},enumerable:!0,configurable:!0}),Object.defineProperty(Jd.prototype,"used",{get:function(){return jd(this)},enumerable:!0,configurable:!0}),Object.defineProperty(Jd.prototype,"shared",{get:function(){return qd(this)},enumerable:!0,configurable:!0}),j([zl("insights")],Jd))),kd=kr((B(Xd,xd=oi),Object.defineProperty(Xd.prototype,"resource",{get:function(){return Gd(this)},enumerable:!0,configurable:!0}),Xd)),Fd=kr((B(zd,Ud=ri),j([zl("trending"),ep(kd)],zd))),Bd=kr((B(Qd,Ad=oi),Object.defineProperty(Qd.prototype,"resource",{get:function(){return Gd(this)},enumerable:!0,configurable:!0}),Qd)),jd=kr((B(Kd,Nd=ri),j([zl("used"),ep(Bd)],Kd))),Md=kr((B(Hd,Rd=oi),Object.defineProperty(Hd.prototype,"resource",{get:function(){return Gd(this)},enumerable:!0,configurable:!0}),Hd)),qd=kr((B(Vd,Ed=ri),j([zl("shared"),ep(Md)],Vd))),Gd=kr((B(Wd,Cd=oi),j([zl("resource")],Wd)));function Wd(){return null!==Cd&&Cd.apply(this,arguments)||this}function Vd(){return null!==Ed&&Ed.apply(this,arguments)||this}function Hd(){return null!==Rd&&Rd.apply(this,arguments)||this}function Kd(){return null!==Nd&&Nd.apply(this,arguments)||this}function Qd(){return null!==Ad&&Ad.apply(this,arguments)||this}function zd(){return null!==Ud&&Ud.apply(this,arguments)||this}function Xd(){return null!==xd&&xd.apply(this,arguments)||this}function Jd(){return null!==Dd&&Dd.apply(this,arguments)||this}me(dd,"insights",Ld);var $d,Yd=kr((B(Zd,$d=ri),Zd.prototype.create=function(n,r,i){return void 0===i&&(i={}),M(this,void 0,void 0,function(){var t;return q(this,function(e){switch(e.label){case 0:return t=P({inviteRedirectUrl:r,invitedUserEmailAddress:n},i),[4,Ur(this,lt(t))];case 1:return[2,{data:e.sent()}]}})})},j([zl("invitations")],Zd)));function Zd(){return null!==$d&&$d.apply(this,arguments)||this}Reflect.defineProperty(ui.prototype,"invitations",{configurable:!0,enumerable:!0,get:function(){return Yd(this)}});var eh,th,nh=kr((B(oh,th=oi),oh.prototype.remove=function(){return xr(this.clone(nh,"$ref"))},oh)),rh=kr((B(ih,eh=ri),ih.prototype.add=function(e){return Ur(this.clone(rh,"$ref"),lt({"@odata.id":e}))},j([zl("members"),ep(nh)],ih)));function ih(){return null!==eh&&eh.apply(this,arguments)||this}function oh(){return null!==th&&th.apply(this,arguments)||this}me(Kp,"owners",rh,"owners"),me(Kp,"members",rh);var sh,ah,uh,ch,lh,ph=kr((B(Sh,lh=oi),Sh)),dh=kr((B(bh,ch=ri),j([zl("messages"),ep(ph),Zl()],bh))),hh=kr((B(mh,uh=oi),mh)),fh=kr((B(vh,ah=ri),j([zl("mailFolders"),ep(hh),Zl()],vh))),yh=kr((B(gh,sh=oi),j([zl("mailboxSettings"),$l()],gh)));function gh(){return null!==sh&&sh.apply(this,arguments)||this}function vh(){return null!==ah&&ah.apply(this,arguments)||this}function mh(){return null!==uh&&uh.apply(this,arguments)||this}function bh(){return null!==ch&&ch.apply(this,arguments)||this}function Sh(){return null!==lh&&lh.apply(this,arguments)||this}me(dd,"messages",dh),me(dd,"mailboxSettings",yh),me(dd,"mailFolders",fh),dd.prototype.sendMail=function(e){return Ur(this.clone(hd,"sendMail"),lt(e))};var Th,wh,Ph,Ih,_h,Oh=kr((B(Lh,_h=oi),Object.defineProperty(Lh.prototype,"root",{get:function(){return Eh(this)},enumerable:!0,configurable:!0}),Object.defineProperty(Lh.prototype,"list",{get:function(){return si(this,"list")},enumerable:!0,configurable:!0}),Object.defineProperty(Lh.prototype,"recent",{get:function(){return Nh(this,"recent")},enumerable:!0,configurable:!0}),Object.defineProperty(Lh.prototype,"sharedWithMe",{get:function(){return Nh(this,"sharedWithMe")},enumerable:!0,configurable:!0}),Lh.prototype.getItemById=function(e){return Rh(this,v("items",e))},j([zl("drive")],Lh))),Ch=kr((B(Dh,Ih=ri),j([zl("drives"),ep(Oh)],Dh))),Eh=kr((B(xh,Ph=oi),Object.defineProperty(xh.prototype,"children",{get:function(){return Nh(this,"children")},enumerable:!0,configurable:!0}),xh.prototype.search=function(e){var t=this.clone(Eh);return t.query.set("search","'"+e+"'"),t()},Object.defineProperty(xh.prototype,"thumbnails",{get:function(){return ii(this,"thumbnails")},enumerable:!0,configurable:!0}),j([zl("root")],xh))),Rh=kr((B(Uh,wh=oi),Object.defineProperty(Uh.prototype,"children",{get:function(){return Nh(this,"children")},enumerable:!0,configurable:!0}),Object.defineProperty(Uh.prototype,"thumbnails",{get:function(){return ii(this,"thumbnails")},enumerable:!0,configurable:!0}),Object.defineProperty(Uh.prototype,"versions",{get:function(){return ii(this,"versions")},enumerable:!0,configurable:!0}),Uh.prototype.move=function(e,t){return Dr(this,lt(P(e,{name:t})))},Uh.prototype.getContent=function(){return Ar(this.clone(Rh,"content"))},Uh.prototype.setContent=function(e){return Lr(this.clone(Rh,"content"),{body:e})},j([Xl(),$l()],Uh))),Nh=kr((B(Ah,Th=ri),j([ep(Rh)],Ah)));function Ah(){return null!==Th&&Th.apply(this,arguments)||this}function Uh(){return null!==wh&&wh.apply(this,arguments)||this}function xh(){return null!==Ph&&Ph.apply(this,arguments)||this}function Dh(){return null!==Ih&&Ih.apply(this,arguments)||this}function Lh(){return null!==_h&&_h.apply(this,arguments)||this}me(dd,"drive",Oh),me(dd,"drives",Ch);var kh,Fh,Bh,jh,Mh,qh=kr((B(Jh,Mh=oi),Object.defineProperty(Jh.prototype,"notebooks",{get:function(){return Wh(this)},enumerable:!0,configurable:!0}),Object.defineProperty(Jh.prototype,"sections",{get:function(){return Hh(this)},enumerable:!0,configurable:!0}),Object.defineProperty(Jh.prototype,"pages",{get:function(){return ii(this,"pages")},enumerable:!0,configurable:!0}),j([zl("onenote")],Jh))),Gh=kr((B(Xh,jh=oi),Object.defineProperty(Xh.prototype,"sections",{get:function(){return Hh(this)},enumerable:!0,configurable:!0}),Xh)),Wh=kr((B(zh,Bh=ri),zh.prototype.add=function(n){return M(this,void 0,void 0,function(){var t;return q(this,function(e){switch(e.label){case 0:return[4,Ur(this,lt({displayName:n}))];case 1:return[2,{data:t=e.sent(),notebook:this.getById(t.id)}]}})})},j([zl("notebooks"),ep(Gh)],zh))),Vh=kr((B(Qh,Fh=oi),Qh)),Hh=kr((B(Kh,kh=ri),Kh.prototype.add=function(n){return M(this,void 0,void 0,function(){var t;return q(this,function(e){switch(e.label){case 0:return[4,Ur(this,lt({displayName:n}))];case 1:return[2,{data:t=e.sent(),section:this.getById(t.id)}]}})})},j([zl("sections"),ep(Vh)],Kh)));function Kh(){return null!==kh&&kh.apply(this,arguments)||this}function Qh(){return null!==Fh&&Fh.apply(this,arguments)||this}function zh(){return null!==Bh&&Bh.apply(this,arguments)||this}function Xh(){return null!==jh&&jh.apply(this,arguments)||this}function Jh(){return null!==Mh&&Mh.apply(this,arguments)||this}me(dd,"onenote",qh);var $h,Yh=kr((B(Zh,$h=oi),Zh.prototype.getBlob=function(){return this.clone(Yh,"$value",!1).usingParser(new Me)()},Zh.prototype.getBuffer=function(){return this.clone(Yh,"$value",!1).usingParser(new Ge)()},Zh.prototype.setContent=function(e){return Dr(this.clone(Yh,"$value",!1),{body:e})},j([zl("photo")],Zh)));function Zh(){return null!==$h&&$h.apply(this,arguments)||this}me(Kp,"photo",Yh);var ef,tf,nf,rf,of,sf,af,uf=kr((B(Tf,af=oi),Object.defineProperty(Tf.prototype,"plans",{get:function(){return lf(this)},enumerable:!0,configurable:!0}),Object.defineProperty(Tf.prototype,"tasks",{get:function(){return df(this)},enumerable:!0,configurable:!0}),Object.defineProperty(Tf.prototype,"buckets",{get:function(){return ff(this)},enumerable:!0,configurable:!0}),j([zl("planner")],Tf))),cf=kr((B(Sf,sf=oi),Object.defineProperty(Sf.prototype,"tasks",{get:function(){return df(this)},enumerable:!0,configurable:!0}),Object.defineProperty(Sf.prototype,"buckets",{get:function(){return ff(this)},enumerable:!0,configurable:!0}),j([Yl(),Jl()],Sf))),lf=kr((B(bf,of=ri),bf.prototype.add=function(n,r){return M(this,void 0,void 0,function(){var t;return q(this,function(e){switch(e.label){case 0:return[4,Ur(this,lt({owner:n,title:r}))];case 1:return[2,{data:t=e.sent(),plan:this.getById(t.id)}]}})})},j([zl("plans"),ep(cf)],bf))),pf=kr((B(mf,rf=oi),j([Yl(),Jl()],mf))),df=kr((B(vf,nf=ri),vf.prototype.add=function(r,i,o,s){return M(this,void 0,void 0,function(){var t,n;return q(this,function(e){switch(e.label){case 0:return t=P({planId:r,title:i},o),s&&(t=P(t,{bucketId:s})),[4,Ur(this,lt(t))];case 1:return[2,{data:n=e.sent(),task:this.getById(n.id)}]}})})},j([zl("tasks"),ep(pf)],vf))),hf=kr((B(gf,tf=oi),Object.defineProperty(gf.prototype,"tasks",{get:function(){return df(this)},enumerable:!0,configurable:!0}),j([Yl(),Jl()],gf))),ff=kr((B(yf,ef=ri),yf.prototype.add=function(n,r,i){return M(this,void 0,void 0,function(){var t;return q(this,function(e){switch(e.label){case 0:return[4,Ur(this,lt({name:n,orderHint:i||"",planId:r}))];case 1:return t=e.sent(),[2,{bucket:this.getById(t.id),data:t}]}})})},j([zl("buckets"),ep(hf)],yf)));function yf(){return null!==ef&&ef.apply(this,arguments)||this}function gf(){return null!==tf&&tf.apply(this,arguments)||this}function vf(){return null!==nf&&nf.apply(this,arguments)||this}function mf(){return null!==rf&&rf.apply(this,arguments)||this}function bf(){return null!==of&&of.apply(this,arguments)||this}function Sf(){return null!==sf&&sf.apply(this,arguments)||this}function Tf(){return null!==af&&af.apply(this,arguments)||this}me(Kp,"plans",lf,"planner/plans"),me(dd,"tasks",df,"planner/tasks"),Reflect.defineProperty(ui.prototype,"planner",{configurable:!0,enumerable:!0,get:function(){return uf(this)}});var wf,Pf,If=kr((B(Cf,Pf=oi),j([Xl(),$l()],Cf))),_f=kr((B(Of,wf=ri),Of.prototype.add=function(r,i,o,s,a){return void 0===a&&(a={}),M(this,void 0,void 0,function(){var t,n;return q(this,function(e){switch(e.label){case 0:return t=P({changeType:r,expirationDateTime:s,notificationUrl:i,resource:o},a),[4,Ur(this,lt(t))];case 1:return[2,{data:n=e.sent(),subscription:this.getById(n.id)}]}})})},j([zl("subscriptions"),ep(If)],Of)));function Of(){return null!==wf&&wf.apply(this,arguments)||this}function Cf(){return null!==Pf&&Pf.apply(this,arguments)||this}Reflect.defineProperty(ui.prototype,"subscriptions",{configurable:!0,enumerable:!0,get:function(){return _f(this)}});var Ef,Rf,Nf,Af,Uf,xf,Df=kr((B(Hf,xf=oi),Object.defineProperty(Hf.prototype,"channels",{get:function(){return Ff(this)},enumerable:!0,configurable:!0}),Hf.prototype.archive=function(e){return void 0===e&&(e=!1),Ur(this.clone(Df,"archive"),lt({shouldSetSpoSiteReadOnlyForMembers:e}))},Hf.prototype.unarchive=function(){return Ur(this.clone(Df,"unarchive"))},Hf.prototype.cloneTeam=function(e,t,n,r){void 0===t&&(t=""),void 0===n&&(n="apps,tabs,settings,channels,members"),void 0===r&&(r="private");var i={description:t||"",displayName:e,mailNickname:e,partsToClone:n,visibility:r};return Ur(this.clone(Df,"clone"),lt(i))},j([zl("team"),$l()],Hf))),Lf=kr((B(Vf,Uf=ri),j([zl("teams"),ep(Df)],Vf))),kf=kr((B(Wf,Af=oi),Object.defineProperty(Wf.prototype,"tabs",{get:function(){return jf(this)},enumerable:!0,configurable:!0}),Wf)),Ff=kr((B(Gf,Nf=ri),Gf.prototype.add=function(n,r){return void 0===r&&(r=""),M(this,void 0,void 0,function(){var t;return q(this,function(e){switch(e.label){case 0:return[4,Ur(this,lt({description:r,displayName:n}))];case 1:return t=e.sent(),[2,{channel:this.getById(t.id),data:t}]}})})},j([zl("channels"),ep(kf)],Gf))),Bf=kr((B(qf,Rf=oi),j([zl("tab"),$l(),Xl()],qf))),jf=kr((B(Mf,Ef=ri),Mf.prototype.add=function(r,i,o){return M(this,void 0,void 0,function(){var t,n;return q(this,function(e){switch(e.label){case 0:return t=P({displayName:r,"teamsApp@odata.bind":i},o),[4,Ur(this,lt(t))];case 1:return[2,{data:n=e.sent(),tab:this.getById(n.id)}]}})})},j([zl("tabs"),ep(Bf)],Mf)));function Mf(){return null!==Ef&&Ef.apply(this,arguments)||this}function qf(){return null!==Rf&&Rf.apply(this,arguments)||this}function Gf(){return null!==Nf&&Nf.apply(this,arguments)||this}function Wf(){return null!==Af&&Af.apply(this,arguments)||this}function Vf(){return null!==Uf&&Uf.apply(this,arguments)||this}function Hf(){return null!==xf&&xf.apply(this,arguments)||this}me(dd,"joinedTeams",Lf,"joinedTeams"),me(Kp,"team",Df),Kp.prototype.createTeam=function(t){return M(this,void 0,void 0,function(){return q(this,function(e){switch(e.label){case 0:return[4,Lr(this.clone(Qp,"team"),lt(t))];case 1:return[2,{data:e.sent(),team:this.team}]}})})},Reflect.defineProperty(ui.prototype,"teams",{configurable:!0,enumerable:!0,get:function(){return Lf(this)}}),Reflect.defineProperty(ui.prototype,"me",{configurable:!0,enumerable:!0,get:function(){return hd(this,"me")}}),Reflect.defineProperty(ui.prototype,"users",{configurable:!0,enumerable:!0,get:function(){return fd(this)}}),n.d(t,"util",function(){return Kf}),n.d(t,"sp",function(){return Qf}),n.d(t,"graph",function(){return zf}),n.d(t,"storage",function(){return Xf}),n.d(t,"config",function(){return Jf}),n.d(t,"log",function(){return $f}),n.d(t,"setup",function(){return Yf}),n.d(t,"objectToMap",function(){return A}),n.d(t,"mergeMaps",function(){return U}),n.d(t,"RuntimeConfigImpl",function(){return D}),n.d(t,"RuntimeConfig",function(){return L}),n.d(t,"mergeHeaders",function(){return H}),n.d(t,"mergeOptions",function(){return K}),n.d(t,"getADALResource",function(){return Q}),n.d(t,"FetchClient",function(){return J}),n.d(t,"BearerTokenFetchClient",function(){return $}),n.d(t,"SPFxAdalClient",function(){return Y}),n.d(t,"PnPClientStorageWrapper",function(){return Z}),n.d(t,"PnPClientStorage",function(){return te}),n.d(t,"getCtxCallback",function(){return f}),n.d(t,"dateAdd",function(){return g}),n.d(t,"combine",function(){return v}),n.d(t,"getRandomString",function(){return m}),n.d(t,"getGUID",function(){return b}),n.d(t,"isFunc",function(){return S}),n.d(t,"objectDefinedNotNull",function(){return T}),n.d(t,"isArray",function(){return w}),n.d(t,"assign",function(){return P}),n.d(t,"isUrlAbsolute",function(){return I}),n.d(t,"stringIsNullOrEmpty",function(){return _}),n.d(t,"sanitizeGuid",function(){return O}),n.d(t,"jsS",function(){return C}),n.d(t,"hOP",function(){return E}),n.d(t,"getHashCode",function(){return R}),n.d(t,"safeGlobal",function(){return V.a}),n.d(t,"Logger",function(){return y}),n.d(t,"LogLevel",function(){return o}),n.d(t,"ConsoleListener",function(){return l}),n.d(t,"FunctionListener",function(){return p}),n.d(t,"Settings",function(){return ne}),n.d(t,"CachingConfigurationProvider",function(){return re}),n.d(t,"SPListConfigurationProvider",function(){return lr}),n.d(t,"Batch",function(){return ie}),n.d(t,"CachingOptions",function(){return oe}),n.d(t,"CachingParserWrapper",function(){return se}),n.d(t,"addProp",function(){return me}),n.d(t,"invokableFactory",function(){return Fe}),n.d(t,"pipelineBinder",function(){return ut}),n.d(t,"defaultPipelineBinder",function(){return ct}),n.d(t,"ODataParser",function(){return Be}),n.d(t,"TextParser",function(){return je}),n.d(t,"BlobParser",function(){return Me}),n.d(t,"JSONParser",function(){return qe}),n.d(t,"BufferParser",function(){return Ge}),n.d(t,"LambdaParser",function(){return We}),n.d(t,"HttpRequestError",function(){return Ve}),n.d(t,"setResult",function(){return tt}),n.d(t,"pipe",function(){return rt}),n.d(t,"requestPipelineMethod",function(){return it}),n.d(t,"PipelineMethods",function(){return ot}),n.d(t,"getDefaultPipeline",function(){return at}),n.d(t,"cloneQueryableData",function(){return Ye}),n.d(t,"Queryable",function(){return Ze}),n.d(t,"body",function(){return lt}),n.d(t,"headers",function(){return pt}),n.d(t,"extendGlobal",function(){return be}),n.d(t,"extendObj",function(){return Se}),n.d(t,"extendFactory",function(){return Te}),n.d(t,"clearGlobalExtensions",function(){return Oe}),n.d(t,"enableExtensions",function(){return Ee}),n.d(t,"disableExtensions",function(){return Ce}),n.d(t,"SPNS",function(){return r}),n.d(t,"GraphNS",function(){return i});var Kf={assign:P,combine:v,dateAdd:g,getCtxCallback:f,getGUID:b,getRandomString:m,isArray:w,isFunc:S,isUrlAbsolute:I,objectDefinedNotNull:T,sanitizeGuid:O,stringIsNullOrEmpty:_},Qf=Tr,zf=ci,Xf=new te,Jf=new ne,$f=y,Yf=function(e){L.assign(e)},Zf={config:Jf,graph:zf,log:$f,setup:Yf,sp:Qf,storage:Xf,util:Kf};t.default=Zf}],i.c=r,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(n,r,function(e){return t[e]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=3);function i(e){if(r[e])return r[e].exports;var t=r[e]={i:e,l:!1,exports:{}};return n[e].call(t.exports,t,t.exports,i),t.l=!0,t.exports}var n,r});