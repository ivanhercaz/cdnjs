"use strict";const supportedHooks=["onRequest","preParsing","preValidation","preSerialization","preHandler","onResponse","onSend","onError","onRoute","onRegister","onClose"],{codes:{FST_ERR_HOOK_INVALID_TYPE:FST_ERR_HOOK_INVALID_TYPE,FST_ERR_HOOK_INVALID_HANDLER:FST_ERR_HOOK_INVALID_HANDLER}}=require("./errors");function Hooks(){this.onRequest=[],this.preParsing=[],this.preValidation=[],this.preSerialization=[],this.preHandler=[],this.onResponse=[],this.onSend=[],this.onError=[]}function buildHooks(o){const n=new Hooks;return n.onRequest=o.onRequest.slice(),n.preParsing=o.preParsing.slice(),n.preValidation=o.preValidation.slice(),n.preSerialization=o.preSerialization.slice(),n.preHandler=o.preHandler.slice(),n.onSend=o.onSend.slice(),n.onResponse=o.onResponse.slice(),n.onError=o.onError.slice(),n}function hookRunner(o,n,e,r,t){var i=0;function s(a){if(a||i===o.length)return void t(a,e,r);const l=n(o[i++],e,r,s);l&&"function"==typeof l.then&&l.then(u,p)}function u(){s()}function p(o){t(o,e,r)}s()}function onSendHookRunner(o,n,e,r,t){var i=0;function s(a,l){if(a)return void t(a,n,e,r);if(void 0!==l&&(r=l),i===o.length)return void t(null,n,e,r);const d=o[i++](n,e,r,s);d&&"function"==typeof d.then&&d.then(u,p)}function u(o){s(null,o)}function p(o){t(o,n,e,r)}s()}function hookIterator(o,n,e,r){if(!0!==e.sent)return o(n,e,r)}Hooks.prototype.validate=function(o,n){if("string"!=typeof o)throw new FST_ERR_HOOK_INVALID_TYPE;if("function"!=typeof n)throw new FST_ERR_HOOK_INVALID_HANDLER;if(-1===supportedHooks.indexOf(o))throw new Error(`${o} hook not supported!`)},Hooks.prototype.add=function(o,n){this.validate(o,n),this[o].push(n)},module.exports={Hooks:Hooks,buildHooks:buildHooks,hookRunner:hookRunner,onSendHookRunner:onSendHookRunner,hookIterator:hookIterator};