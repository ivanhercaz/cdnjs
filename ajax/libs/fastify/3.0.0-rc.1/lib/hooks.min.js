"use strict";const applicationHooks=["onRoute","onRegister","onClose"],lifecycleHooks=["onRequest","preParsing","preValidation","preSerialization","preHandler","onSend","onResponse","onError"],supportedHooks=lifecycleHooks.concat(applicationHooks),{codes:{FST_ERR_HOOK_INVALID_TYPE:FST_ERR_HOOK_INVALID_TYPE,FST_ERR_HOOK_INVALID_HANDLER:FST_ERR_HOOK_INVALID_HANDLER,FST_ERR_SEND_UNDEFINED_ERR:FST_ERR_SEND_UNDEFINED_ERR}}=require("./errors"),{kReplyIsError:kReplyIsError}=require("./symbols");function Hooks(){this.onRequest=[],this.preParsing=[],this.preValidation=[],this.preSerialization=[],this.preHandler=[],this.onResponse=[],this.onSend=[],this.onError=[],this.onRoute=[],this.onRegister=[]}function buildHooks(o){const n=new Hooks;return n.onRequest=o.onRequest.slice(),n.preParsing=o.preParsing.slice(),n.preValidation=o.preValidation.slice(),n.preSerialization=o.preSerialization.slice(),n.preHandler=o.preHandler.slice(),n.onSend=o.onSend.slice(),n.onResponse=o.onResponse.slice(),n.onError=o.onError.slice(),n.onRoute=o.onRoute.slice(),n.onRegister=o.onRegister.slice(),n}function hookRunner(o,n,e,r,i){var t=0;function s(u){if(u||t===o.length)return void i(u,e,r);const c=n(o[t++],e,r,s);c&&"function"==typeof c.then&&c.then(R,l)}function R(){s()}function l(o){o?o instanceof Error||(r[kReplyIsError]=!0):o=new FST_ERR_SEND_UNDEFINED_ERR,i(o,e,r)}s()}function onSendHookRunner(o,n,e,r,i){var t=0;function s(u,c){if(u)return void i(u,n,e,r);if(void 0!==c&&(r=c),t===o.length)return void i(null,n,e,r);const p=o[t++](n,e,r,s);p&&"function"==typeof p.then&&p.then(R,l)}function R(o){s(null,o)}function l(o){i(o,n,e,r)}s()}function hookIterator(o,n,e,r){if(!0!==e.sent)return o(n,e,r)}Hooks.prototype.validate=function(o,n){if("string"!=typeof o)throw new FST_ERR_HOOK_INVALID_TYPE;if("function"!=typeof n)throw new FST_ERR_HOOK_INVALID_HANDLER;if(-1===supportedHooks.indexOf(o))throw new Error(`${o} hook not supported!`)},Hooks.prototype.add=function(o,n){this.validate(o,n),this[o].push(n)},module.exports={Hooks:Hooks,buildHooks:buildHooks,hookRunner:hookRunner,onSendHookRunner:onSendHookRunner,hookIterator:hookIterator,lifecycleHooks:lifecycleHooks};