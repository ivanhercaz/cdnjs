!function(t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):("undefined"==typeof window?"undefined"==typeof global?"undefined"==typeof self?this:self:global:window).WebTorrent=t()}(function(){var eo=Math.ceil,to=Math.max,no=Math.pow,ro=String.fromCharCode,oo=Math.abs,ao=Math.min,io=Math.floor;function tt(){this._events&&Object.prototype.hasOwnProperty.call(this,"_events")||(this._events=c(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0}function v(t){return void 0===t._maxListeners?tt.defaultMaxListeners:t._maxListeners}function C(d,e,t,n){var r,l,u;if("function"!=typeof t)throw new TypeError("\"listener\" argument must be a function");if((l=d._events)?(l.newListener&&(d.emit("newListener",e,t.listener?t.listener:t),l=d._events),u=l[e]):(l=d._events=c(null),d._eventsCount=0),!u)u=l[e]=t,++d._eventsCount;else if("function"==typeof u?u=l[e]=n?[t,u]:[u,t]:n?u.unshift(t):u.push(t),!u.warned&&(r=v(d))&&0<r&&u.length>r){u.warned=!0;var f=new Error("Possible EventEmitter memory leak detected. "+u.length+" \""+(e+"\" listeners added. Use emitter.setMaxListeners() to increase limit."));f.name="MaxListenersExceededWarning",f.emitter=d,f.type=e,f.count=u.length,"object"==typeof console&&console.warn&&console.warn("%s: %s",f.name,f.message)}return d}function x(){if(!this.fired)switch(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length){case 0:return this.listener.call(this.target);case 1:return this.listener.call(this.target,arguments[0]);case 2:return this.listener.call(this.target,arguments[0],arguments[1]);case 3:return this.listener.call(this.target,arguments[0],arguments[1],arguments[2]);default:for(var n=Array(arguments.length),e=0;e<n.length;++e)n[e]=arguments[e];this.listener.apply(this.target,n);}}function T(o,e,t){var n={fired:!1,wrapFn:void 0,target:o,type:e,listener:t},r=s.call(x,n);return r.listener=t,n.wrapFn=r,r}function A(o,e,t){var n=o._events;if(!n)return[];var r=n[e];return r?"function"==typeof r?t?[r.listener||r]:[r]:t?function(r){for(var e=Array(r.length),t=0;t<e.length;++t)e[t]=r[t].listener||r[t];return e}(r):R(r,r.length):[]}function I(r){var e=this._events;if(e){var t=e[r];if("function"==typeof t)return 1;if(t)return t.length}return 0}function R(o,e){for(var t=Array(e),n=0;n<e;++n)t[n]=o[n];return t}function B(r){var e=r.length;if(0<e%4)throw new Error("Invalid string. Length must be a multiple of 4");var t=r.indexOf("=");return-1===t&&(t=e),[t,t===e?0:4-t%4]}function D(d,e,t){for(var n,a,l=[],s=e;s<t;s+=3)n=(16711680&d[s]<<16)+(65280&d[s+1]<<8)+(255&d[s+2]),l.push(w[63&(a=n)>>18]+w[63&a>>12]+w[63&a>>6]+w[63&a]);return l.join("")}function H(r,e){for(var t in r)e[t]=r[t]}function V(r,e,t){return z(r,e,t)}function G(o,e,t){var n=[],r=null;return G._encode(n,o),r=mo.concat(n),G.bytes=r.length,mo.isBuffer(e)?(r.copy(e,t),e):r}function J(d,e,t){for(var n,a=0,l=1,c=e;c<t;c++)if(n=d[c],58>n&&48<=n)a=10*a+(n-48);else if(c!==e||43!==n){if(c!==e||45!==n){if(46===n)break;throw new Error("not a number: buffer["+c+"] = "+n)}l=-1}return a*l}function ne(o,e,d,a){return null==o||0===o.length?null:("number"!=typeof e&&null==a&&(a=e,e=void 0),"number"!=typeof d&&null==a&&(a=d,d=void 0),ne.position=0,ne.encoding=a||null,ne.data=_o.isBuffer(o)?o.slice(e,d):_o.from(o),ne.bytes=ne.data.length,ne.next())}function re(r,e,t){return e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function he(){throw new Error("setTimeout has not been defined")}function _e(){throw new Error("clearTimeout has not been defined")}function ye(n){if(se===setTimeout)return setTimeout(n,0);if((se===he||!se)&&setTimeout)return se=setTimeout,setTimeout(n,0);try{return se(n,0)}catch(e){try{return se.call(null,n,0)}catch(e){return se.call(this,n,0)}}}function be(){ko&&me&&(ko=!1,me.length?So=me.concat(So):Eo=-1,So.length&&Se())}function Se(){if(!ko){var n=ye(be);ko=!0;for(var e=So.length;e;){for(me=So,So=[];++Eo<e;)me&&me[Eo].run();Eo=-1,e=So.length}me=null,ko=!1,function(n){if(bo===clearTimeout)return clearTimeout(n);if((bo===_e||!bo)&&clearTimeout)return bo=clearTimeout,clearTimeout(n);try{bo(n)}catch(e){try{return bo.call(null,n)}catch(e){return bo.call(this,n)}}}(n)}}function Ce(n,e){this.fun=n,this.array=e}function xe(){}function Te(o,d,e){e||(e=Error);var t=function(t){function e(e,n,r){return t.call(this,function(t,e,n){return"string"==typeof d?d:d(t,e,n)}(e,n,r))||this}var o,a;return a=t,(o=e).prototype=Object.create(a.prototype),o.prototype.constructor=o,o.__proto__=a,e}(e);t.prototype.name=e.name,t.prototype.code=o,Ie[o]=t}function Be(r,o){if(Array.isArray(r)){var t=r.length;return r=r.map(function(t){return t+""}),2<t?"one of ".concat(o," ").concat(r.slice(0,t-1).join(", "),", or ")+r[t-1]:2===t?"one of ".concat(o," ").concat(r[0]," or ").concat(r[1]):"of ".concat(o," ").concat(r[0])}return"of ".concat(o," ").concat(r+"")}function Le(r,e){for(var t in r)e[t]=r[t]}function qe(r,e,t){return De(r,e,t)}function Fe(o,e){var t=this._transformState;t.transforming=!1;var n=t.writecb;if(null===n)return this.emit("error",new $e);t.writechunk=null,t.writecb=null,null!=e&&this.push(e),n(o);var r=this._readableState;r.reading=!1,(r.needReadable||r.length<r.highWaterMark)&&this._read(r.highWaterMark)}function Je(t){return this instanceof Je?void(Ke.call(this,t),this._transformState={afterTransform:Fe.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,t&&("function"==typeof t.transform&&(this._transform=t.transform),"function"==typeof t.flush&&(this._flush=t.flush)),this.on("prefinish",Xe)):new Je(t)}function Xe(){var r=this;"function"!=typeof this._flush||this._readableState.destroyed?Ze(this,null,null):this._flush(function(e,t){Ze(r,e,t)})}function Ze(r,e,t){if(e)return r.emit("error",e);if(null!=t&&r.push(t),r._writableState.length)throw new Ge;if(r._transformState.transforming)throw new Ve;return r.push(null)}function Qe(t){return this instanceof Qe?void He.call(this,t):new Qe(t)}function nt(t){if(t)throw t}function ot(t){t()}function at(n,e){return n.pipe(e)}function ht(t){return bt(t)||wt(t)}function bt(t){return t instanceof Int8Array||t instanceof Int16Array||t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray||t instanceof Uint16Array||t instanceof Uint32Array||t instanceof Float32Array||t instanceof Float64Array}function wt(t){return _t[Uo.call(t)]}function vt(t){return St.existsSync(t)&&St.statSync(t).isFile()}function Tt(r,e){var t=this;return t instanceof Tt?void(st.Readable.call(t,e),t.destroyed=!1,t._drained=!1,t._forwarding=!1,t._current=null,t._toStreams2=e&&e.objectMode?It:Bt,"function"==typeof r?t._queue=r:(t._queue=r.map(t._toStreams2),t._queue.forEach(function(n){"function"!=typeof n&&t._attachErrorListener(n)})),t._next()):new Tt(r,e)}function It(t){return Lt(t,{objectMode:!0,highWaterMark:16})}function Bt(t){return Lt(t)}function Lt(r,e){if(!r||"function"==typeof r||r._readableState)return r;var t=new st.Readable(e).wrap(r);return r.destroy&&(t.destroy=r.destroy.bind(r)),t}function Rt(n){var e=function(){return e.called?e.value:(e.called=!0,e.value=n.apply(this,arguments))};return e.called=!1,e}function Ut(r){var e=function(){if(e.called)throw new Error(e.onceError);return e.called=!0,e.value=r.apply(this,arguments)},t=r.name||"Function wrapped with `once`";return e.onceError=t+" shouldn't be called more than once",e.called=!1,e}function Pt(t){return Fo.digest(t)}function Nt(r,e){for(var t in r)e[t]=r[t]}function Gt(r,e,t){return rn(r,e,t)}function on(t){return!!t.constructor&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)}function an(n,e){n.emit("error",e)}function ln(o,e){var t=this._transformState;t.transforming=!1;var n=t.writecb;if(!n)return this.emit("error",new Error("write callback called multiple times"));t.writechunk=null,t.writecb=null,null!=e&&this.push(e),n(o);var r=this._readableState;r.reading=!1,(r.needReadable||r.length<r.highWaterMark)&&this._read(r.highWaterMark)}function hn(t){return this instanceof hn?void(pn.call(this,t),this._transformState={afterTransform:ln.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,t&&("function"==typeof t.transform&&(this._transform=t.transform),"function"==typeof t.flush&&(this._flush=t.flush)),this.on("prefinish",mn)):new hn(t)}function mn(){var r=this;"function"==typeof this._flush?this._flush(function(e,t){_n(r,e,t)}):_n(this,null,null)}function _n(r,e,t){if(e)return r.emit("error",e);if(null!=t&&r.push(t),r._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(r._transformState.transforming)throw new Error("Calling transform done when still transforming");return r.push(null)}function bn(t){return this instanceof bn?void fn.call(this,t):new bn(t)}function yn(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function wn(o,e){if(o.map)return o.map(e);for(var t=[],n=0;n<o.length;n++)t.push(e(o[n],n));return t}function vn(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}function Bn(o,e,t){if(o&&Qo.isObject(o)&&o instanceof vn)return o;var n=new vn;return n.parse(o,e,t),n}function Mn(t){if("string"==typeof t&&(t=Nn.parse(t)),t.protocol||(t.protocol="https:"),"https:"!==t.protocol)throw new Error("Protocol \""+t.protocol+"\" not supported. Expected \"https:\"");return t}function Dn(n){let e=n>>3;return 0!=n%8&&e++,e}function Zn(){}function rr(t){return Lr(t,{objectMode:!0,highWaterMark:16})}function Er(t){return Lr(t)}function Lr(r,e){if(!r||"function"==typeof r||r._readableState)return r;var t=new st.Readable(e).wrap(r);return r.destroy&&(t.destroy=r.destroy.bind(r)),t}function Br(r,e){var o=this;if(!(o instanceof Br))return new Br(r,e);if(!wd)throw new Error("web browser lacks MediaSource support");e||(e={}),o._debug=e.debug,o._bufferDuration=e.bufferDuration||60,o._elem=r,o._mediaSource=new wd,o._streams=[],o.detailedError=null,o._errorHandler=function(){o._elem.removeEventListener("error",o._errorHandler),o._streams.slice().forEach(function(t){t.destroy(o._elem.error)})},o._elem.addEventListener("error",o._errorHandler),o._elem.src=window.URL.createObjectURL(o._mediaSource)}function Rr(r,e){var t=this;if(st.Writable.call(t),t._wrapper=r,t._elem=r._elem,t._mediaSource=r._mediaSource,t._allStreams=r._streams,t._allStreams.push(t),t._bufferDuration=r._bufferDuration,t._sourceBuffer=null,t._debugBuffers=[],t._openHandler=function(){t._onSourceOpen()},t._flowHandler=function(){t._flow()},t._errorHandler=function(n){t.destroyed||t.emit("error",n)},"string"==typeof e)t._type=e,"open"===t._mediaSource.readyState?t._createSourceBuffer():t._mediaSource.addEventListener("sourceopen",t._openHandler);else if(null===e._sourceBuffer)e.destroy(),t._type=e._type,t._mediaSource.addEventListener("sourceopen",t._openHandler);else{if(!e._sourceBuffer)throw new Error("The argument to MediaElementWrapper.createWriteStream must be a string or a previous stream returned from that function");e.destroy(),t._type=e._type,t._sourceBuffer=e._sourceBuffer,t._debugBuffers=e._debugBuffers,t._sourceBuffer.addEventListener("updateend",t._flowHandler),t._sourceBuffer.addEventListener("error",t._errorHandler)}t._elem.addEventListener("timeupdate",t._flowHandler),t.on("error",function(n){t._wrapper.error(n)}),t.on("finish",function(){if(!t.destroyed&&(t._finished=!0,t._allStreams.every(function(t){return t._finished}))){t._wrapper._dumpDebugData();try{t._mediaSource.endOfStream()}catch(e){}}})}function Ur(r,e,t={}){return this instanceof Ur?void(this.detailedError=null,this._elem=e,this._elemWrapper=new Qr(e),this._waitingFired=!1,this._trackMeta=null,this._file=r,this._tracks=null,"none"!==this._elem.preload&&this._createMuxer(),this._onError=()=>{this.detailedError=this._elemWrapper.detailedError,this.destroy()},this._onWaiting=()=>{this._waitingFired=!0,this._muxer?this._tracks&&this._pump():this._createMuxer()},e.autoplay&&(e.preload="auto"),e.addEventListener("waiting",this._onWaiting),e.addEventListener("error",this._onError)):(console.warn("don't invoked VideoStream without 'new'"),new Ur(r,e,t))}function Mr(p,f,e,g){function t(){return!("number"==typeof p.length&&p.length>e.maxBlobLength&&(Nd("File length too large for Blob URL approach: %d (max: %d)",p.length,e.maxBlobLength),d(new Error("File length too large for Blob URL approach: "+p.length+" (max: "+e.maxBlobLength+")")),1))}function n(e){t()&&(l=f(e),qr(p,function(n,e){return n?d(n):void(l.addEventListener("error",d),l.addEventListener("loadstart",a),l.addEventListener("canplay",c),l.src=e)}))}function a(){l.removeEventListener("loadstart",a),e.autoplay&&l.play()}function c(){l.removeEventListener("canplay",c),g(null,l)}function r(){qr(p,function(t,e){return t?d(t):void(".pdf"===u?((l=f("object")).setAttribute("typemustmatch",!0),l.setAttribute("type","application/pdf"),l.setAttribute("data",e)):((l=f("iframe")).sandbox="allow-forms allow-scripts",l.src=e),g(null,l))})}function d(e){e.message="Error rendering file \""+p.name+"\": "+e.message,Nd(e.message),g(e)}var l,u=pt.extname(p.name).toLowerCase(),s=0;0<=qd.indexOf(u)?function(){function o(){Nd("Use MediaSource API for "+p.name),e(),l.addEventListener("error",i),l.addEventListener("loadstart",a),l.addEventListener("canplay",c);var r,o=new Qr(l).createWriteStream((r=p.name,{".m4a":"audio/mp4; codecs=\"mp4a.40.5\"",".m4b":"audio/mp4; codecs=\"mp4a.40.5\"",".m4p":"audio/mp4; codecs=\"mp4a.40.5\"",".m4v":"video/mp4; codecs=\"avc1.640029, mp4a.40.5\"",".mkv":"video/webm; codecs=\"avc1.640029, mp4a.40.5\"",".mp3":"audio/mpeg",".mp4":"video/mp4; codecs=\"avc1.640029, mp4a.40.5\"",".webm":"video/webm; codecs=\"vorbis, vp8\""}[pt.extname(r).toLowerCase()]));p.createReadStream().pipe(o),s&&(l.currentTime=s)}function r(){Nd("Use Blob URL for "+p.name),e(),l.addEventListener("error",d),l.addEventListener("loadstart",a),l.addEventListener("canplay",c),qr(p,function(n,e){return n?d(n):void(l.src=e,s&&(l.currentTime=s))})}function i(n){Nd("MediaSource API error: fallback to Blob URL: %o",n.message||n),t()&&(l.removeEventListener("error",i),l.removeEventListener("canplay",c),r())}function e(){l||(l=f(h)).addEventListener("progress",function(){s=l.currentTime})}var h=0<=Dd.indexOf(u)?"video":"audio";Vd?0<=Hd.indexOf(u)?(Nd("Use `videostream` package for "+p.name),e(),l.addEventListener("error",function n(e){Nd("videostream error: fallback to MediaSource API: %o",e.message||e),l.removeEventListener("error",n),l.removeEventListener("canplay",c),o()}),l.addEventListener("loadstart",a),l.addEventListener("canplay",c),Md(p,l)):o():r()}():0<=Fd.indexOf(u)?n("video"):0<=Wd.indexOf(u)?n("audio"):0<=jd.indexOf(u)?(l=f("img"),qr(p,function(e,t){return e?d(e):void(l.src=t,l.alt=p.name,g(null,l))})):0<=zd.indexOf(u)?r():function(){Nd("Unknown file extension \"%s\" - will attempt to render into iframe",u);var n="";p.createReadStream({start:0,end:1e3}).setEncoding("utf8").on("data",function(t){n+=t}).on("end",function(){Zr(n)?(Nd("File extension \"%s\" appears ascii, so will render.",u),r()):(Nd("File extension \"%s\" appears non-ascii, will not render.",u),g(new Error("Unsupported file type \""+u+"\": Cannot append to DOM")))}).on("error",g)}()}function qr(r,e){var t=pt.extname(r.name).toLowerCase();Sd(r.createReadStream(),Od.mime[t],e)}function Fr(t){if(null==t)throw new Error("file cannot be null or undefined");if("string"!=typeof t.name)throw new Error("missing or invalid file.name property");if("function"!=typeof t.createReadStream)throw new Error("missing or invalid file.createReadStream property")}function Wr(t){null==t.autoplay&&(t.autoplay=!1),null==t.muted&&(t.muted=!1),null==t.controls&&(t.controls=!0),null==t.maxBlobLength&&(t.maxBlobLength=200000000)}var so=function(r){var e;return function(t){return e||r(e={exports:{},parent:t},e.exports),e.exports}},lo=so(function(n,o){(function(p){var g=co({}),m=o,r={moov:["mvhd","meta","traks","mvex"],trak:["tkhd","tref","trgr","edts","meta","mdia","udta"],edts:["elst"],mdia:["mdhd","hdlr","elng","minf"],minf:["vmhd","smhd","hmhd","sthd","nmhd","dinf","stbl"],dinf:["dref"],stbl:["stsd","stts","ctts","cslg","stsc","stsz","stz2","stco","co64","stss","stsh","padb","stdp","sdtp","sbgps","sgpds","subss","saizs","saios"],mvex:["mehd","trexs","leva"],moof:["mfhd","meta","trafs"],traf:["tfhd","tfdt","trun","sbgps","sgpds","subss","saizs","saios","meta"]};m.encode=function(e,t,o){return m.encodingLength(e),o=o||0,t=t||p.alloc(e.length),m._encode(e,t,o)},m._encode=function(d,i,e){var t=d.type,n=d.length;4294967295<n&&(n=1),i.writeUInt32BE(n,e),i.write(d.type,e+4,4,"ascii");var o=e+8;if(1===n&&(Cd.encode(d.length,i,o),o+=8),g.fullBoxes[t]&&(i.writeUInt32BE(d.flags||0,o),i.writeUInt8(d.version||0,o),o+=4),r[t])r[t].forEach(function(e){if(5===e.length){var t=d[e]||[];e=e.substr(0,4),t.forEach(function(t){m._encode(t,i,o),o+=m.encode.bytes})}else d[e]&&(m._encode(d[e],i,o),o+=m.encode.bytes)}),d.otherBoxes&&d.otherBoxes.forEach(function(t){m._encode(t,i,o),o+=m.encode.bytes});else if(g[t]){var s=g[t].encode;s(d,i,o),o+=s.bytes}else{if(!d.buffer)throw new Error("Either `type` must be set to a known type (not'"+t+"') or `buffer` must be set");d.buffer.copy(i,o),o+=d.buffer.length}return m.encode.bytes=o-e,i},m.readHeaders=function(r,e,d){if(e=e||0,8>(d=d||r.length)-e)return 8;var l,c,u=r.readUInt32BE(e),f=r.toString("ascii",e+4,e+8),a=e+8;if(1===u){if(16>d-e)return 16;u=Cd.decode(r,a),a+=8}return g.fullBoxes[f]&&(l=r.readUInt8(a),c=16777215&r.readUInt32BE(a),a+=4),{length:u,headersLen:a-e,contentLen:u-(a-e),type:f,version:l,flags:c}},m.decode=function(o,e,d){e=e||0,d=d||o.length;var a=m.readHeaders(o,e,d);if(!a||a.length>d-e)throw new Error("Data too short");return m.decodeWithoutHeaders(a,o,e+a.headersLen,e+a.length)},m.decodeWithoutHeaders=function(e,t,n,i){n=n||0,i=i||t.length;var s=e.type,h={};if(r[s]){h.otherBoxes=[];for(var _,b=r[s],u=n;8<=i-u;)if(_=m.decode(t,u,i),u+=_.length,0<=b.indexOf(_.type))h[_.type]=_;else if(0<=b.indexOf(_.type+"s")){var y=_.type+"s";(h[y]=h[y]||[]).push(_)}else h.otherBoxes.push(_)}else g[s]?h=(0,g[s].decode)(t,n,i):h.buffer=p.from(t.slice(n,i));return h.length=e.length,h.contentLen=e.contentLen,h.type=e.type,h.version=e.version,h.flags=e.flags,h},m.encodingLength=function(o){var e=o.type,d=8;if(g.fullBoxes[e]&&(d+=4),r[e])r[e].forEach(function(n){if(5===n.length){var e=o[n]||[];n=n.substr(0,4),e.forEach(function(t){t.type=n,d+=m.encodingLength(t)})}else if(o[n]){var r=o[n];r.type=n,d+=m.encodingLength(r)}}),o.otherBoxes&&o.otherBoxes.forEach(function(t){d+=m.encodingLength(t)});else if(g[e])d+=g[e].encodingLength(o);else{if(!o.buffer)throw new Error("Either `type` must be set to a known type (not'"+e+"') or `buffer` must be set");d+=o.buffer.length}return 4294967295<d&&(d+=8),o.length=d,d}}).call(this,p({}).Buffer)}),co=so(function(t,m){(function(_){function e(o,e,t){for(var n=e;n<t;n++)o[n]=0}function n(r,e,t){e.writeUInt32BE(io((r.getTime()+2082844800000)/1e3),t)}function o(r,e,t){e.writeUIntBE(io((r.getTime()+2082844800000)/1e3),t,6)}function b(r,e,t){e.writeUInt16BE(io(r)%65536,t),e.writeUInt16BE(io(256*(256*r))%65536,t+2)}function a(o,d,t){o||(o=[0,0,0,0,0,0,0,0,0]);for(var n=0;n<o.length;n++)b(o[n],d,t+4*n)}function i(r){for(var e=Array(r.length/4),t=0;t<e.length;t++)e[t]=l(r,4*t);return e}function s(n,e){return new Date(1e3*n.readUIntBE(e,6)-2082844800000)}function d(n,e){return new Date(1e3*n.readUInt32BE(e)-2082844800000)}function l(n,e){return n.readUInt16BE(e)+n.readUInt16BE(e+2)/65536}function c(n,e){return n[e]+n[e+1]/256}function u(o,e,t){var n;for(n=0;n<t&&0!==o[e+n];n++);return o.toString("utf8",e,e+n)}var f=lo({});m.fullBoxes={},["mvhd","tkhd","mdhd","vmhd","smhd","stsd","esds","stsz","stco","co64","stss","stts","ctts","stsc","dref","elst","hdlr","mehd","trex","mfhd","tfhd","tfdt","trun"].forEach(function(t){m.fullBoxes[t]=!0}),m.ftyp={},m.ftyp.encode=function(e,t,n){t=t?t.slice(n):_.alloc(m.ftyp.encodingLength(e));var d=e.compatibleBrands||[];t.write(e.brand,0,4,"ascii"),t.writeUInt32BE(e.brandVersion,4);for(var a=0;a<d.length;a++)t.write(d[a],8+4*a,4,"ascii");return m.ftyp.encode.bytes=8+4*d.length,t},m.ftyp.decode=function(o,d){for(var t=(o=o.slice(d)).toString("ascii",0,4),n=o.readUInt32BE(4),r=[],a=8;a<o.length;a+=4)r.push(o.toString("ascii",a,a+4));return{brand:t,brandVersion:n,compatibleBrands:r}},m.ftyp.encodingLength=function(t){return 8+4*(t.compatibleBrands||[]).length},m.mvhd={},m.mvhd.encode=function(o,t,d){return t=t?t.slice(d):_.alloc(96),n(o.ctime||new Date,t,0),n(o.mtime||new Date,t,4),t.writeUInt32BE(o.timeScale||0,8),t.writeUInt32BE(o.duration||0,12),b(o.preferredRate||0,t,16),function(n,e){e[20]=io(n)%256,e[21]=io(256*n)%256}(o.preferredVolume||0,t),e(t,22,32),a(o.matrix,t,32),t.writeUInt32BE(o.previewTime||0,68),t.writeUInt32BE(o.previewDuration||0,72),t.writeUInt32BE(o.posterTime||0,76),t.writeUInt32BE(o.selectionTime||0,80),t.writeUInt32BE(o.selectionDuration||0,84),t.writeUInt32BE(o.currentTime||0,88),t.writeUInt32BE(o.nextTrackId||0,92),m.mvhd.encode.bytes=96,t},m.mvhd.decode=function(n,r){return{ctime:d(n=n.slice(r),0),mtime:d(n,4),timeScale:n.readUInt32BE(8),duration:n.readUInt32BE(12),preferredRate:l(n,16),preferredVolume:c(n,20),matrix:i(n.slice(32,68)),previewTime:n.readUInt32BE(68),previewDuration:n.readUInt32BE(72),posterTime:n.readUInt32BE(76),selectionTime:n.readUInt32BE(80),selectionDuration:n.readUInt32BE(84),currentTime:n.readUInt32BE(88),nextTrackId:n.readUInt32BE(92)}},m.mvhd.encodingLength=function(){return 96},m.tkhd={},m.tkhd.encode=function(o,t,d){return t=t?t.slice(d):_.alloc(80),n(o.ctime||new Date,t,0),n(o.mtime||new Date,t,4),t.writeUInt32BE(o.trackId||0,8),e(t,12,16),t.writeUInt32BE(o.duration||0,16),e(t,20,28),t.writeUInt16BE(o.layer||0,28),t.writeUInt16BE(o.alternateGroup||0,30),t.writeUInt16BE(o.volume||0,32),a(o.matrix,t,36),t.writeUInt32BE(o.trackWidth||0,72),t.writeUInt32BE(o.trackHeight||0,76),m.tkhd.encode.bytes=80,t},m.tkhd.decode=function(n,r){return{ctime:d(n=n.slice(r),0),mtime:d(n,4),trackId:n.readUInt32BE(8),duration:n.readUInt32BE(16),layer:n.readUInt16BE(28),alternateGroup:n.readUInt16BE(30),volume:n.readUInt16BE(32),matrix:i(n.slice(36,72)),trackWidth:n.readUInt32BE(72),trackHeight:n.readUInt32BE(76)}},m.tkhd.encodingLength=function(){return 80},m.mdhd={},m.mdhd.encode=function(e,t,d){return 1===e.version?(t=t?t.slice(d):_.alloc(32),o(e.ctime||new Date,t,0),o(e.mtime||new Date,t,8),t.writeUInt32BE(e.timeScale||0,16),t.writeUIntBE(e.duration||0,20,6),t.writeUInt16BE(e.language||0,28),t.writeUInt16BE(e.quality||0,30),m.mdhd.encode.bytes=32,t):(t=t?t.slice(d):_.alloc(20),n(e.ctime||new Date,t,0),n(e.mtime||new Date,t,4),t.writeUInt32BE(e.timeScale||0,8),t.writeUInt32BE(e.duration||0,12),t.writeUInt16BE(e.language||0,16),t.writeUInt16BE(e.quality||0,18),m.mdhd.encode.bytes=20,t)},m.mdhd.decode=function(r,o,t){return r=r.slice(o),20==t-o?{ctime:d(r,0),mtime:d(r,4),timeScale:r.readUInt32BE(8),duration:r.readUInt32BE(12),language:r.readUInt16BE(16),quality:r.readUInt16BE(18)}:{ctime:s(r,0),mtime:s(r,8),timeScale:r.readUInt32BE(16),duration:r.readUIntBE(20,6),language:r.readUInt16BE(28),quality:r.readUInt16BE(30)}},m.mdhd.encodingLength=function(t){return 1===t.version?32:20},m.vmhd={},m.vmhd.encode=function(e,t,n){(t=t?t.slice(n):_.alloc(8)).writeUInt16BE(e.graphicsMode||0,0);var o=e.opcolor||[0,0,0];return t.writeUInt16BE(o[0],2),t.writeUInt16BE(o[1],4),t.writeUInt16BE(o[2],6),m.vmhd.encode.bytes=8,t},m.vmhd.decode=function(n,r){return{graphicsMode:(n=n.slice(r)).readUInt16BE(0),opcolor:[n.readUInt16BE(2),n.readUInt16BE(4),n.readUInt16BE(6)]}},m.vmhd.encodingLength=function(){return 8},m.smhd={},m.smhd.encode=function(n,t,o){return(t=t?t.slice(o):_.alloc(4)).writeUInt16BE(n.balance||0,0),e(t,2,4),m.smhd.encode.bytes=4,t},m.smhd.decode=function(n,r){return{balance:(n=n.slice(r)).readUInt16BE(0)}},m.smhd.encodingLength=function(){return 4},m.stsd={},m.stsd.encode=function(e,t,n){t=t?t.slice(n):_.alloc(m.stsd.encodingLength(e));var r=e.entries||[];t.writeUInt32BE(r.length,0);for(var o,d=4,s=0;s<r.length;s++)o=r[s],f.encode(o,t,d),d+=f.encode.bytes;return m.stsd.encode.bytes=d,t},m.stsd.decode=function(r,d,t){for(var n,l=(r=r.slice(d)).readUInt32BE(0),i=Array(l),s=4,c=0;c<l;c++)n=f.decode(r,s,t),i[c]=n,s+=n.length;return{entries:i}},m.stsd.encodingLength=function(r){var e=4;if(!r.entries)return e;for(var o=0;o<r.entries.length;o++)e+=f.encodingLength(r.entries[o]);return e},m.avc1=m.VisualSampleEntry={},m.VisualSampleEntry.encode=function(n,t,r){e(t=t?t.slice(r):_.alloc(m.VisualSampleEntry.encodingLength(n)),0,6),t.writeUInt16BE(n.dataReferenceIndex||0,6),e(t,8,24),t.writeUInt16BE(n.width||0,24),t.writeUInt16BE(n.height||0,26),t.writeUInt32BE(n.hResolution||4718592,28),t.writeUInt32BE(n.vResolution||4718592,32),e(t,36,40),t.writeUInt16BE(n.frameCount||1,40);var o=n.compressorName||"",d=ao(o.length,31);t.writeUInt8(d,42),t.write(o,43,d,"utf8"),t.writeUInt16BE(n.depth||24,74),t.writeInt16BE(-1,76);var a=78;(n.children||[]).forEach(function(n){f.encode(n,t,a),a+=f.encode.bytes}),m.VisualSampleEntry.encode.bytes=a},m.VisualSampleEntry.decode=function(r,d,t){r=r.slice(d);for(var n,l=t-d,i=ao(r.readUInt8(42),31),s={dataReferenceIndex:r.readUInt16BE(6),width:r.readUInt16BE(24),height:r.readUInt16BE(26),hResolution:r.readUInt32BE(28),vResolution:r.readUInt32BE(32),frameCount:r.readUInt16BE(40),compressorName:r.toString("utf8",43,43+i),depth:r.readUInt16BE(74),children:[]},o=78;8<=l-o;)n=f.decode(r,o,l),s.children.push(n),s[n.type]=n,o+=n.length;return s},m.VisualSampleEntry.encodingLength=function(n){var r=78;return(n.children||[]).forEach(function(t){r+=f.encodingLength(t)}),r},m.avcC={},m.avcC.encode=function(e,t,n){t=t?t.slice(n):_.alloc(e.buffer.length),e.buffer.copy(t),m.avcC.encode.bytes=e.buffer.length},m.avcC.decode=function(e,o,n){return{mimeCodec:(e=e.slice(o,n)).toString("hex",1,4),buffer:_.from(e)}},m.avcC.encodingLength=function(t){return t.buffer.length},m.mp4a=m.AudioSampleEntry={},m.AudioSampleEntry.encode=function(n,t,r){e(t=t?t.slice(r):_.alloc(m.AudioSampleEntry.encodingLength(n)),0,6),t.writeUInt16BE(n.dataReferenceIndex||0,6),e(t,8,16),t.writeUInt16BE(n.channelCount||2,16),t.writeUInt16BE(n.sampleSize||16,18),e(t,20,24),t.writeUInt32BE(n.sampleRate||0,24);var o=28;(n.children||[]).forEach(function(n){f.encode(n,t,o),o+=f.encode.bytes}),m.AudioSampleEntry.encode.bytes=o},m.AudioSampleEntry.decode=function(r,d,t){for(var n,l=t-d,i={dataReferenceIndex:(r=r.slice(d,t)).readUInt16BE(6),channelCount:r.readUInt16BE(16),sampleSize:r.readUInt16BE(18),sampleRate:r.readUInt32BE(24),children:[]},s=28;8<=l-s;)n=f.decode(r,s,l),i.children.push(n),i[n.type]=n,s+=n.length;return i},m.AudioSampleEntry.encodingLength=function(n){var r=28;return(n.children||[]).forEach(function(t){r+=f.encodingLength(t)}),r},m.esds={},m.esds.encode=function(e,t,n){t=t?t.slice(n):_.alloc(e.buffer.length),e.buffer.copy(t,0),m.esds.encode.bytes=e.buffer.length},m.esds.decode=function(e,d,n){e=e.slice(d,n);var r=Ld.Descriptor.decode(e,0,e.length),i=("ESDescriptor"===r.tagName?r:{}).DecoderConfigDescriptor||{},s=i.oti||0,o=i.DecoderSpecificInfo,a=o?(248&o.buffer.readUInt8(0))>>3:0,l=null;return s&&(l=s.toString(16),a&&(l+="."+a)),{mimeCodec:l,buffer:_.from(e.slice(0))}},m.esds.encodingLength=function(t){return t.buffer.length},m.stsz={},m.stsz.encode=function(e,t,n){var d=e.entries||[];(t=t?t.slice(n):_.alloc(m.stsz.encodingLength(e))).writeUInt32BE(0,0),t.writeUInt32BE(d.length,4);for(var a=0;a<d.length;a++)t.writeUInt32BE(d[a],4*a+8);return m.stsz.encode.bytes=8+4*d.length,t},m.stsz.decode=function(o,d){for(var t=(o=o.slice(d)).readUInt32BE(0),n=o.readUInt32BE(4),r=Array(n),a=0;a<n;a++)r[a]=0===t?o.readUInt32BE(4*a+8):t;return{entries:r}},m.stsz.encodingLength=function(t){return 8+4*t.entries.length},m.stss=m.stco={},m.stco.encode=function(e,t,n){var d=e.entries||[];(t=t?t.slice(n):_.alloc(m.stco.encodingLength(e))).writeUInt32BE(d.length,0);for(var a=0;a<d.length;a++)t.writeUInt32BE(d[a],4*a+4);return m.stco.encode.bytes=4+4*d.length,t},m.stco.decode=function(o,d){for(var t=(o=o.slice(d)).readUInt32BE(0),n=Array(t),r=0;r<t;r++)n[r]=o.readUInt32BE(4*r+4);return{entries:n}},m.stco.encodingLength=function(t){return 4+4*t.entries.length},m.co64={},m.co64.encode=function(e,t,n){var d=e.entries||[];(t=t?t.slice(n):_.alloc(m.co64.encodingLength(e))).writeUInt32BE(d.length,0);for(var a=0;a<d.length;a++)Cd.encode(d[a],t,8*a+4);return m.co64.encode.bytes=4+8*d.length,t},m.co64.decode=function(o,d){for(var t=(o=o.slice(d)).readUInt32BE(0),n=Array(t),r=0;r<t;r++)n[r]=Cd.decode(o,8*r+4);return{entries:n}},m.co64.encodingLength=function(t){return 4+8*t.entries.length},m.stts={},m.stts.encode=function(e,t,n){var d=e.entries||[];(t=t?t.slice(n):_.alloc(m.stts.encodingLength(e))).writeUInt32BE(d.length,0);for(var i,s=0;s<d.length;s++)i=8*s+4,t.writeUInt32BE(d[s].count||0,i),t.writeUInt32BE(d[s].duration||0,i+4);return m.stts.encode.bytes=4+8*e.entries.length,t},m.stts.decode=function(o,d){for(var t,a=(o=o.slice(d)).readUInt32BE(0),n=Array(a),r=0;r<a;r++)t=8*r+4,n[r]={count:o.readUInt32BE(t),duration:o.readUInt32BE(t+4)};return{entries:n}},m.stts.encodingLength=function(t){return 4+8*t.entries.length},m.ctts={},m.ctts.encode=function(e,t,n){var d=e.entries||[];(t=t?t.slice(n):_.alloc(m.ctts.encodingLength(e))).writeUInt32BE(d.length,0);for(var i,s=0;s<d.length;s++)i=8*s+4,t.writeUInt32BE(d[s].count||0,i),t.writeUInt32BE(d[s].compositionOffset||0,i+4);return m.ctts.encode.bytes=4+8*d.length,t},m.ctts.decode=function(o,d){for(var t,a=(o=o.slice(d)).readUInt32BE(0),n=Array(a),r=0;r<a;r++)t=8*r+4,n[r]={count:o.readUInt32BE(t),compositionOffset:o.readInt32BE(t+4)};return{entries:n}},m.ctts.encodingLength=function(t){return 4+8*t.entries.length},m.stsc={},m.stsc.encode=function(e,t,n){var d=e.entries||[];(t=t?t.slice(n):_.alloc(m.stsc.encodingLength(e))).writeUInt32BE(d.length,0);for(var i,s=0;s<d.length;s++)i=12*s+4,t.writeUInt32BE(d[s].firstChunk||0,i),t.writeUInt32BE(d[s].samplesPerChunk||0,i+4),t.writeUInt32BE(d[s].sampleDescriptionId||0,i+8);return m.stsc.encode.bytes=4+12*d.length,t},m.stsc.decode=function(o,d){for(var t,a=(o=o.slice(d)).readUInt32BE(0),n=Array(a),r=0;r<a;r++)t=12*r+4,n[r]={firstChunk:o.readUInt32BE(t),samplesPerChunk:o.readUInt32BE(t+4),sampleDescriptionId:o.readUInt32BE(t+8)};return{entries:n}},m.stsc.encodingLength=function(t){return 4+12*t.entries.length},m.dref={},m.dref.encode=function(e,t,n){t=t?t.slice(n):_.alloc(m.dref.encodingLength(e));var d=e.entries||[];t.writeUInt32BE(d.length,0);for(var i=4,s=0;s<d.length;s++){var l=d[s],u=(l.buf?l.buf.length:0)+4+4;t.writeUInt32BE(u,i),i+=4,t.write(l.type,i,4,"ascii"),i+=4,l.buf&&(l.buf.copy(t,i),i+=l.buf.length)}return m.dref.encode.bytes=i,t},m.dref.decode=function(d,l){for(var t=(d=d.slice(l)).readUInt32BE(0),n=Array(t),r=4,c=0;c<t;c++){var u=d.readUInt32BE(r),o=d.toString("ascii",r+4,r+8),a=d.slice(r+8,r+u);r+=u,n[c]={type:o,buf:a}}return{entries:n}},m.dref.encodingLength=function(o){var e=4;if(!o.entries)return e;for(var d,a=0;a<o.entries.length;a++)d=o.entries[a].buf,e+=(d?d.length:0)+4+4;return e},m.elst={},m.elst.encode=function(e,t,n){var d=e.entries||[];(t=t?t.slice(n):_.alloc(m.elst.encodingLength(e))).writeUInt32BE(d.length,0);for(var i,s=0;s<d.length;s++)i=12*s+4,t.writeUInt32BE(d[s].trackDuration||0,i),t.writeUInt32BE(d[s].mediaTime||0,i+4),b(d[s].mediaRate||0,t,i+8);return m.elst.encode.bytes=4+12*d.length,t},m.elst.decode=function(o,d){for(var t,a=(o=o.slice(d)).readUInt32BE(0),n=Array(a),r=0;r<a;r++)t=12*r+4,n[r]={trackDuration:o.readUInt32BE(t),mediaTime:o.readInt32BE(t+4),mediaRate:l(o,t+8)};return{entries:n}},m.elst.encodingLength=function(t){return 4+12*t.entries.length},m.hdlr={},m.hdlr.encode=function(e,t,n){t=t?t.slice(n):_.alloc(m.hdlr.encodingLength(e));var o=21+(e.name||"").length;return t.fill(0,0,o),t.write(e.handlerType||"",4,4,"ascii"),function(e,t){var n=_.from(e,"utf8");n.copy(t,20),t[20+n.length]=0}(e.name||"",t),m.hdlr.encode.bytes=o,t},m.hdlr.decode=function(r,o,t){return{handlerType:(r=r.slice(o)).toString("ascii",4,8),name:u(r,20,t)}},m.hdlr.encodingLength=function(t){return 21+(t.name||"").length},m.mehd={},m.mehd.encode=function(e,t,n){return(t=t?t.slice(n):_.alloc(4)).writeUInt32BE(e.fragmentDuration||0,0),m.mehd.encode.bytes=4,t},m.mehd.decode=function(n,r){return{fragmentDuration:(n=n.slice(r)).readUInt32BE(0)}},m.mehd.encodingLength=function(){return 4},m.trex={},m.trex.encode=function(e,t,n){return(t=t?t.slice(n):_.alloc(20)).writeUInt32BE(e.trackId||0,0),t.writeUInt32BE(e.defaultSampleDescriptionIndex||0,4),t.writeUInt32BE(e.defaultSampleDuration||0,8),t.writeUInt32BE(e.defaultSampleSize||0,12),t.writeUInt32BE(e.defaultSampleFlags||0,16),m.trex.encode.bytes=20,t},m.trex.decode=function(n,r){return{trackId:(n=n.slice(r)).readUInt32BE(0),defaultSampleDescriptionIndex:n.readUInt32BE(4),defaultSampleDuration:n.readUInt32BE(8),defaultSampleSize:n.readUInt32BE(12),defaultSampleFlags:n.readUInt32BE(16)}},m.trex.encodingLength=function(){return 20},m.mfhd={},m.mfhd.encode=function(e,t,n){return(t=t?t.slice(n):_.alloc(4)).writeUInt32BE(e.sequenceNumber||0,0),m.mfhd.encode.bytes=4,t},m.mfhd.decode=function(t){return{sequenceNumber:t.readUInt32BE(0)}},m.mfhd.encodingLength=function(){return 4},m.tfhd={},m.tfhd.encode=function(e,t,n){return(t=t?t.slice(n):_.alloc(4)).writeUInt32BE(e.trackId,0),m.tfhd.encode.bytes=4,t},m.tfhd.decode=function(){},m.tfhd.encodingLength=function(){return 4},m.tfdt={},m.tfdt.encode=function(e,t,n){return(t=t?t.slice(n):_.alloc(4)).writeUInt32BE(e.baseMediaDecodeTime||0,0),m.tfdt.encode.bytes=4,t},m.tfdt.decode=function(){},m.tfdt.encodingLength=function(){return 4},m.trun={},m.trun.encode=function(e,t,n){(t=t?t.slice(n):_.alloc(8+16*e.entries.length)).writeUInt32BE(e.entries.length,0),t.writeInt32BE(e.dataOffset,4);for(var d,i=8,l=0;l<e.entries.length;l++)d=e.entries[l],t.writeUInt32BE(d.sampleDuration,i),i+=4,t.writeUInt32BE(d.sampleSize,i),i+=4,t.writeUInt32BE(d.sampleFlags,i),i+=4,0===(e.version||0)?t.writeUInt32BE(d.sampleCompositionTimeOffset,i):t.writeInt32BE(d.sampleCompositionTimeOffset,i),i+=4;m.trun.encode.bytes=i},m.trun.decode=function(){},m.trun.encodingLength=function(t){return 8+16*t.entries.length},m.mdat={},m.mdat.encode=function(n,e,t){n.buffer?(n.buffer.copy(e,t),m.mdat.encode.bytes=n.buffer.length):m.mdat.encode.bytes=m.mdat.encodingLength(n)},m.mdat.decode=function(e,t,n){return{buffer:_.from(e.slice(t,n))}},m.mdat.encodingLength=function(t){return t.buffer?t.buffer.length:t.contentLength}}).call(this,p({}).Buffer)}),t=so(function(i){(function(_,e){"use strict";function t(r,d){r=r||{};var t=d instanceof(L=L||fo({}));this.objectMode=!!r.objectMode,t&&(this.objectMode=this.objectMode||!!r.readableObjectMode);var n=r.highWaterMark,o=r.readableHighWaterMark,a=this.objectMode?16:16384;this.highWaterMark=n||0===n?n:t&&(o||0===o)?o:a,this.highWaterMark=io(this.highWaterMark),this.buffer=new cn,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=r.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,r.encoding&&(I||(I=uo({}).StringDecoder),this.decoder=new I(r.encoding),this.encoding=r.encoding)}function n(r){return(L=L||fo({}),!(this instanceof n))?new n(r):void(this._readableState=new t(r,this),this.readable=!0,r&&("function"==typeof r.read&&(this._read=r.read),"function"==typeof r.destroy&&(this._destroy=r.destroy)),en.call(this))}function s(d,e,a,n,r){var i,c=d._readableState;return null===e?(c.reading=!1,function(r,e){if(!e.ended){if(e.decoder){var t=e.decoder.end();t&&t.length&&(e.buffer.push(t),e.length+=e.objectMode?1:t.length)}e.ended=!0,p(r)}}(d,c)):(r||(i=function(d,e){var t,a;return a=e,B.isBuffer(a)||a instanceof o||"string"==typeof e||void 0===e||d.objectMode||(t=new TypeError("Invalid non-string/buffer chunk")),t}(c,e)),i?d.emit("error",i):c.objectMode||e&&0<e.length?("string"==typeof e||c.objectMode||Object.getPrototypeOf(e)===B.prototype||(e=function(t){return B.from(t)}(e)),n?c.endEmitted?d.emit("error",new Error("stream.unshift() after end event")):l(d,c,e,!0):c.ended?d.emit("error",new Error("stream.push() after EOF")):(c.reading=!1,c.decoder&&!a?(e=c.decoder.write(e),c.objectMode||0!==e.length?l(d,c,e,!1):b(d,c)):l(d,c,e,!1))):n||(c.reading=!1)),function(t){return!t.ended&&(t.needReadable||t.length<t.highWaterMark||0===t.length)}(c)}function l(o,e,t,n){e.flowing&&0===e.length&&!e.sync?(o.emit("data",t),o.read(0)):(e.length+=e.objectMode?1:t.length,n?e.buffer.unshift(t):e.buffer.push(t),e.needReadable&&p(o)),b(o,e)}function f(n,e){return 0>=n||0===e.length&&e.ended?0:e.objectMode?1:n==n?(n>e.highWaterMark&&(e.highWaterMark=function(t){return t>=8388608?t=8388608:(t--,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t++),t}(n)),n<=e.length?n:e.ended?e.length:(e.needReadable=!0,0)):e.flowing&&e.length?e.buffer.head.data.length:e.length}function p(n){var e=n._readableState;e.needReadable=!1,e.emittedReadable||(R("emitReadable",e.flowing),e.emittedReadable=!0,e.sync?Xt.nextTick(g,n):g(n))}function g(t){R("emit readable"),t.emit("readable"),S(t)}function b(n,e){e.readingMore||(e.readingMore=!0,Xt.nextTick(y,n,e))}function y(r,e){for(var t=e.length;!e.reading&&!e.flowing&&!e.ended&&e.length<e.highWaterMark&&(R("maybeReadMore read 0"),r.read(0),t!==e.length);)t=e.length;e.readingMore=!1}function w(t){R("readable nexttick read 0"),t.read(0)}function k(n,e){e.reading||(R("resume read 0"),n.read(0)),e.resumeScheduled=!1,e.awaitDrain=0,n.emit("resume"),S(n),e.flowing&&!e.reading&&n.read(0)}function S(n){var e=n._readableState;for(R("flow",e.flowing);e.flowing&&null!==n.read(););}function E(r,e){return 0===e.length?null:(e.objectMode?t=e.buffer.shift():!r||r>=e.length?(t=e.decoder?e.buffer.join(""):1===e.buffer.length?e.buffer.head.data:e.buffer.concat(e.length),e.buffer.clear()):t=function(o,e,t){var n;return o<e.head.data.length?(n=e.head.data.slice(0,o),e.head.data=e.head.data.slice(o)):n=o===e.head.data.length?e.shift():t?function(d,a){var t=a.head,l=1,c=t.data;for(d-=c.length;t=t.next;){var u=t.data,s=d>u.length?u.length:d;if(c+=s===u.length?u:u.slice(0,d),0==(d-=s)){s===u.length?(++l,a.head=t.next?t.next:a.tail=null):(a.head=t,t.data=u.slice(s));break}++l}return a.length-=l,c}(o,e):function(d,a){var t=B.allocUnsafe(d),n=a.head,l=1;for(n.data.copy(t),d-=n.data.length;n=n.next;){var c=n.data,s=d>c.length?c.length:d;if(c.copy(t,t.length-d,0,s),0==(d-=s)){s===c.length?(++l,a.head=n.next?n.next:a.tail=null):(a.head=n,n.data=c.slice(s));break}++l}return a.length-=l,t}(o,e),n}(r,e.buffer,e.decoder),t);var t}function v(n){var e=n._readableState;if(0<e.length)throw new Error("\"endReadable()\" called on non-empty stream");e.endEmitted||(e.ended=!0,Xt.nextTick(C,e,n))}function C(n,e){n.endEmitted||0!==n.length||(n.endEmitted=!0,e.readable=!1,e.emit("end"))}function x(o,e){for(var t=0,d=o.length;t<d;t++)if(o[t]===e)return t;return-1}var L;i.exports=n,n.ReadableState=t,m.EventEmitter;var T=function(n,e){return n.listeners(e).length},B=tn.Buffer,o=e.Uint8Array||function(){};sn.inherits=Me;var I,R;R=oe&&oe.debuglog?oe.debuglog("stream"):function(){},sn.inherits(n,en);var a=["error","close","destroy","pause","resume"];Object.defineProperty(n.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(t){this._readableState&&(this._readableState.destroyed=t)}}),n.prototype.destroy=dn.destroy,n.prototype._undestroy=dn.undestroy,n.prototype._destroy=function(n,e){this.push(null),e(n)},n.prototype.push=function(o,d){var a,i=this._readableState;return i.objectMode?a=!0:"string"==typeof o&&((d=d||i.defaultEncoding)!==i.encoding&&(o=B.from(o,d),d=""),a=!0),s(this,o,d,!1,a)},n.prototype.unshift=function(t){return s(this,t,null,!0,!1)},n.prototype.isPaused=function(){return!1===this._readableState.flowing},n.prototype.setEncoding=function(t){return I||(I=uo({}).StringDecoder),this._readableState.decoder=new I(t),this._readableState.encoding=t,this};n.prototype.read=function(o){R("read",o),o=parseInt(o,10);var d=this._readableState,t=o;if(0!==o&&(d.emittedReadable=!1),0===o&&d.needReadable&&(d.length>=d.highWaterMark||d.ended))return R("read: emitReadable",d.length,d.ended),0===d.length&&d.ended?v(this):p(this),null;if(0===(o=f(o,d))&&d.ended)return 0===d.length&&v(this),null;var n,a=d.needReadable;return R("need readable",a),(0===d.length||d.length-o<d.highWaterMark)&&R("length less than watermark",a=!0),d.ended||d.reading?R("reading or ended",a=!1):a&&(R("do read"),d.reading=!0,d.sync=!0,0===d.length&&(d.needReadable=!0),this._read(d.highWaterMark),d.sync=!1,d.reading||(o=f(t,d))),null===(n=0<o?E(o,d):null)?(d.needReadable=!0,o=0):d.length-=o,0===d.length&&(d.ended||(d.needReadable=!0),t!==o&&d.ended&&v(this)),null!==n&&this.emit("data",n),n},n.prototype._read=function(){this.emit("error",new Error("_read() is not implemented"))},n.prototype.pipe=function(o,e){function u(){R("onend"),o.end()}function a(e){R("ondata"),n=!1,!1!==o.write(e)||n||((1===r.pipesCount&&r.pipes===o||1<r.pipesCount&&-1!==x(r.pipes,o))&&!h&&(R("false write response, pause",m._readableState.awaitDrain),m._readableState.awaitDrain++,n=!0),m.pause())}function l(e){R("onerror",e),g(),o.removeListener("error",l),0===T(o,"error")&&o.emit("error",e)}function f(){o.removeListener("finish",p),g()}function p(){R("onfinish"),o.removeListener("close",f),g()}function g(){R("unpipe"),m.unpipe(o)}var m=this,r=this._readableState;switch(r.pipesCount){case 0:r.pipes=o;break;case 1:r.pipes=[r.pipes,o];break;default:r.pipes.push(o);}r.pipesCount+=1,R("pipe count=%d opts=%j",r.pipesCount,e);var t=e&&!1===e.end||o===_.stdout||o===_.stderr?g:u;r.endEmitted?Xt.nextTick(t):m.once("end",t),o.on("unpipe",function e(t,n){R("onunpipe"),t===m&&n&&!1===n.hasUnpiped&&(n.hasUnpiped=!0,R("cleanup"),o.removeListener("close",f),o.removeListener("finish",p),o.removeListener("drain",i),o.removeListener("error",l),o.removeListener("unpipe",e),m.removeListener("end",u),m.removeListener("end",g),m.removeListener("data",a),h=!0,!r.awaitDrain||o._writableState&&!o._writableState.needDrain||i())});var i=function(n){return function(){var e=n._readableState;R("pipeOnDrain",e.awaitDrain),e.awaitDrain&&e.awaitDrain--,0===e.awaitDrain&&T(n,"data")&&(e.flowing=!0,S(n))}}(m);o.on("drain",i);var h=!1,n=!1;return m.on("data",a),function(r,e,t){return"function"==typeof r.prependListener?r.prependListener("error",t):void(r._events&&r._events.error?Qt(r._events.error)?r._events.error.unshift(t):r._events.error=[t,r._events.error]:r.on("error",t))}(o,0,l),o.once("close",f),o.once("finish",p),o.emit("pipe",m),r.flowing||(R("pipe resume"),m.resume()),o},n.prototype.unpipe=function(d){var a=this._readableState,t={hasUnpiped:!1};if(0===a.pipesCount)return this;if(1===a.pipesCount)return d&&d!==a.pipes?this:(d||(d=a.pipes),a.pipes=null,a.pipesCount=0,a.flowing=!1,d&&d.emit("unpipe",this,t),this);if(!d){var n=a.pipes,r=a.pipesCount;a.pipes=null,a.pipesCount=0,a.flowing=!1;for(var i=0;i<r;i++)n[i].emit("unpipe",this,t);return this}var l=x(a.pipes,d);return-1===l?this:(a.pipes.splice(l,1),a.pipesCount-=1,1===a.pipesCount&&(a.pipes=a.pipes[0]),d.emit("unpipe",this,t),this)},n.prototype.on=function(o,e){var t=en.prototype.on.call(this,o,e);if("data"===o)!1!==this._readableState.flowing&&this.resume();else if("readable"===o){var n=this._readableState;n.endEmitted||n.readableListening||(n.readableListening=n.needReadable=!0,n.emittedReadable=!1,n.reading?n.length&&p(this):Xt.nextTick(w,this))}return t},n.prototype.addListener=n.prototype.on,n.prototype.resume=function(){var t=this._readableState;return t.flowing||(R("resume"),t.flowing=!0,function(n,e){e.resumeScheduled||(e.resumeScheduled=!0,Xt.nextTick(k,n,e))}(this,t)),this},n.prototype.pause=function(){return R("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(R("pause"),this._readableState.flowing=!1,this.emit("pause")),this},n.prototype.wrap=function(o){var d=this,t=this._readableState,e=!1;for(var n in o.on("end",function(){if(R("wrapped end"),t.decoder&&!t.ended){var n=t.decoder.end();n&&n.length&&d.push(n)}d.push(null)}),o.on("data",function(n){R("wrapped data"),t.decoder&&(n=t.decoder.write(n)),t.objectMode&&null==n||(t.objectMode||n&&n.length)&&(d.push(n)||(e=!0,o.pause()))}),o)void 0===this[n]&&"function"==typeof o[n]&&(this[n]=function(e){return function(){return o[e].apply(o,arguments)}}(n));for(var i=0;i<a.length;i++)o.on(a[i],this.emit.bind(this,a[i]));return this._read=function(n){R("wrapped _read",n),e&&(e=!1,o.resume())},this},Object.defineProperty(n.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),n._fromList=E}).call(this,pe,"undefined"==typeof global?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:global)}),uo=so(function(f,e){"use strict";function t(r){var e;switch(this.encoding=function(r){var e=function(n){if(!n)return"utf8";for(var r;;)switch(n){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return n;default:if(r)return;n=(""+n).toLowerCase(),r=!0;}}(r);if("string"!=typeof e&&(l.isEncoding===n||!n(r)))throw new Error("Unknown encoding: "+r);return e||r}(r),this.encoding){case"utf16le":this.text=o,this.end=a,e=4;break;case"utf8":this.fillLast=i,e=4;break;case"base64":this.text=s,this.end=c,e=3;break;default:return this.write=u,void(this.end=d);}this.lastNeed=0,this.lastTotal=0,this.lastChar=l.allocUnsafe(e)}function p(t){return 127>=t?0:6==t>>5?2:14==t>>4?3:30==t>>3?4:2==t>>6?-1:-2}function i(r){var e=this.lastTotal-this.lastNeed,t=function(n,e){if(128!=(192&e[0]))return n.lastNeed=0,"\uFFFD";if(1<n.lastNeed&&1<e.length){if(128!=(192&e[1]))return n.lastNeed=1,"\uFFFD";if(2<n.lastNeed&&2<e.length&&128!=(192&e[2]))return n.lastNeed=2,"\uFFFD"}}(this,r);return void 0===t?this.lastNeed<=r.length?(r.copy(this.lastChar,e,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(r.copy(this.lastChar,e,0,r.length),void(this.lastNeed-=r.length)):t}function o(o,e){if(0==(o.length-e)%2){var t=o.toString("utf16le",e);if(t){var n=t.charCodeAt(t.length-1);if(55296<=n&&56319>=n)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=o[o.length-2],this.lastChar[1]=o[o.length-1],t.slice(0,-1)}return t}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=o[o.length-1],o.toString("utf16le",e,o.length-1)}function a(r){var e=r&&r.length?this.write(r):"";if(this.lastNeed){var t=this.lastTotal-this.lastNeed;return e+this.lastChar.toString("utf16le",0,t)}return e}function s(r,e){var t=(r.length-e)%3;return 0==t?r.toString("base64",e):(this.lastNeed=3-t,this.lastTotal=3,1==t?this.lastChar[0]=r[r.length-1]:(this.lastChar[0]=r[r.length-2],this.lastChar[1]=r[r.length-1]),r.toString("base64",e,r.length-t))}function c(n){var e=n&&n.length?this.write(n):"";return this.lastNeed?e+this.lastChar.toString("base64",0,3-this.lastNeed):e}function u(t){return t.toString(this.encoding)}function d(t){return t&&t.length?this.write(t):""}var l=tn.Buffer,n=l.isEncoding||function(t){switch((t=""+t)&&t.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1;}};e.StringDecoder=t,t.prototype.write=function(r){if(0===r.length)return"";var e,o;if(this.lastNeed){if(void 0===(e=this.fillLast(r)))return"";o=this.lastNeed,this.lastNeed=0}else o=0;return o<r.length?e?e+this.text(r,o):this.text(r,o):e||""},t.prototype.end=function(n){var e=n&&n.length?this.write(n):"";return this.lastNeed?e+"\uFFFD":e},t.prototype.text=function(o,e){var t=function(o,e,t){var n=e.length-1;if(n<t)return 0;var d=p(e[n]);return 0<=d?(0<d&&(o.lastNeed=d-1),d):--n<t||-2===d?0:0<=(d=p(e[n]))?(0<d&&(o.lastNeed=d-2),d):--n<t||-2===d?0:0<=(d=p(e[n]))?(0<d&&(2===d?d=0:o.lastNeed=d-3),d):0}(this,o,e);if(!this.lastNeed)return o.toString("utf8",e);this.lastTotal=t;var n=o.length-(t-this.lastNeed);return o.copy(this.lastChar,0,n),o.toString("utf8",e,n)},t.prototype.fillLast=function(t){return this.lastNeed<=t.length?(t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):void(t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,t.length),this.lastNeed-=t.length)}}),fo=so(function(o){"use strict";function f(t){return this instanceof f?void(n.call(this,t),i.call(this,t),t&&!1===t.readable&&(this.readable=!1),t&&!1===t.writable&&(this.writable=!1),this.allowHalfOpen=!0,t&&!1===t.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",u)):new f(t)}function u(){this.allowHalfOpen||this._writableState.ended||Xt.nextTick(e,this)}function e(t){t.end()}var d=Object.keys||function(r){var e=[];for(var t in r)e.push(t);return e};o.exports=f,sn.inherits=Me;var n=t({}),i=r({});sn.inherits(f,n);for(var s,l=d(i.prototype),a=0;a<l.length;a++)s=l[a],f.prototype[s]||(f.prototype[s]=i.prototype[s]);Object.defineProperty(f.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(f.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&this._readableState.destroyed&&this._writableState.destroyed},set:function(t){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=t,this._writableState.destroyed=t)}}),f.prototype._destroy=function(n,e){this.push(null),this.end(),Xt.nextTick(e,n)}}),r=so(function(s){(function(e,t,n){"use strict";function S(n){var e=this;this.next=null,this.entry=null,this.finish=function(){!function(n,e){var t=n.entry;for(n.entry=null;t;){var o=t.callback;e.pendingcb--,o(void 0),t=t.next}e.corkedRequestsFree?e.corkedRequestsFree.next=n:e.corkedRequestsFree=n}(e,n)}}function k(){}function r(o,d){b=b||fo({}),o=o||{};var t=d instanceof b;this.objectMode=!!o.objectMode,t&&(this.objectMode=this.objectMode||!!o.writableObjectMode);var n=o.highWaterMark,r=o.writableHighWaterMark,a=this.objectMode?16:16384;this.highWaterMark=n||0===n?n:t&&(r||0===r)?r:a,this.highWaterMark=io(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var i=!1===o.decodeStrings;this.decodeStrings=!i,this.defaultEncoding=o.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(t){!function(o,e){var t=o._writableState,n=t.sync,r=t.writecb;if(function(t){t.writing=!1,t.writecb=null,t.length-=t.writelen,t.writelen=0}(t),e)!function(o,e,t,n,r){--e.pendingcb,t?(Xt.nextTick(r,n),Xt.nextTick(_,o,e),o._writableState.errorEmitted=!0,o.emit("error",n)):(r(n),o._writableState.errorEmitted=!0,o.emit("error",n),_(o,e))}(o,t,n,e,r);else{var d=g(t);d||t.corked||t.bufferProcessing||!t.bufferedRequest||p(o,t),n?y(f,o,t,d,r):f(o,t,d,r)}}(d,t)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new S(this)}function i(t){return(b=b||fo({}),!(a.call(i,this)||this instanceof b))?new i(t):void(this._writableState=new r(t,this),this.writable=!0,t&&("function"==typeof t.write&&(this._write=t.write),"function"==typeof t.writev&&(this._writev=t.writev),"function"==typeof t.destroy&&(this._destroy=t.destroy),"function"==typeof t.final&&(this._final=t.final)),en.call(this))}function l(d,e,t,n,r,a,i){e.writelen=n,e.writecb=i,e.writing=!0,e.sync=!0,t?d._writev(r,e.onwrite):d._write(r,a,e.onwrite),e.sync=!1}function f(o,e,t,n){t||function(n,e){0===e.length&&e.needDrain&&(e.needDrain=!1,n.emit("drain"))}(o,e),e.pendingcb--,n(),_(o,e)}function p(i,e){e.bufferProcessing=!0;var t=e.bufferedRequest;if(i._writev&&t&&t.next){var f=e.bufferedRequestCount,r=Array(f),s=e.corkedRequestsFree;s.entry=t;for(var o=0,p=!0;t;)r[o]=t,t.isBuf||(p=!1),t=t.next,o+=1;r.allBuffers=p,l(i,e,!0,e.length,r,"",s.finish),e.pendingcb++,e.lastBufferedRequest=null,s.next?(e.corkedRequestsFree=s.next,s.next=null):e.corkedRequestsFree=new S(e),e.bufferedRequestCount=0}else{for(;t;){var g=t.chunk,c=t.encoding,u=t.callback;if(l(i,e,!1,e.objectMode?1:g.length,g,c,u),t=t.next,e.bufferedRequestCount--,e.writing)break}null===t&&(e.lastBufferedRequest=null)}e.bufferedRequest=t,e.bufferProcessing=!1}function g(t){return t.ending&&0===t.length&&null===t.bufferedRequest&&!t.finished&&!t.writing}function m(r,e){r._final(function(t){e.pendingcb--,t&&r.emit("error",t),e.prefinished=!0,r.emit("prefinish"),_(r,e)})}function _(r,e){var t=g(e);return t&&(function(n,e){e.prefinished||e.finalCalled||("function"==typeof n._final?(e.pendingcb++,e.finalCalled=!0,Xt.nextTick(m,n,e)):(e.prefinished=!0,n.emit("prefinish")))}(r,e),0===e.pendingcb&&(e.finished=!0,r.emit("finish"))),t}s.exports=i;var b,y=!e.browser&&-1<["v0.10","v0.9."].indexOf(e.version.slice(0,5))?n:Xt.nextTick;i.WritableState=r,sn.inherits=Me;var a,w={deprecate:xo},c=tn.Buffer,u=t.Uint8Array||function(){};sn.inherits(i,en),r.prototype.getBuffer=function(){for(var n=this.bufferedRequest,r=[];n;)r.push(n),n=n.next;return r},function(){try{Object.defineProperty(r.prototype,"buffer",{get:w.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(t){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(a=Function.prototype[Symbol.hasInstance],Object.defineProperty(i,Symbol.hasInstance,{value:function(t){return!!a.call(this,t)||this===i&&t&&t._writableState instanceof r}})):a=function(t){return t instanceof this},i.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},i.prototype.write=function(d,a,f){var p,h=this._writableState,i=!1,g=!h.objectMode&&(p=d,c.isBuffer(p)||p instanceof u);return g&&!c.isBuffer(d)&&(d=function(t){return c.from(t)}(d)),"function"==typeof a&&(f=a,a=null),g?a="buffer":a||(a=h.defaultEncoding),"function"!=typeof f&&(f=k),h.ended?function(r,e){var t=new Error("write after end");r.emit("error",t),Xt.nextTick(e,t)}(this,f):(g||function(o,e,t,n){var r=!0,d=!1;return null===t?d=new TypeError("May not write null values to stream"):"string"==typeof t||void 0===t||e.objectMode||(d=new TypeError("Invalid non-string/buffer chunk")),d&&(o.emit("error",d),Xt.nextTick(n,d),r=!1),r}(this,h,d,f))&&(h.pendingcb++,i=function(d,e,t,u,f,p){if(!t){var s=function(r,e,o){return r.objectMode||!1===r.decodeStrings||"string"!=typeof e||(e=c.from(e,o)),e}(e,u,f);u!==s&&(t=!0,f="buffer",u=s)}var o=e.objectMode?1:u.length;e.length+=o;var a=e.length<e.highWaterMark;if(a||(e.needDrain=!0),e.writing||e.corked){var h=e.lastBufferedRequest;e.lastBufferedRequest={chunk:u,encoding:f,isBuf:t,callback:p,next:null},h?h.next=e.lastBufferedRequest:e.bufferedRequest=e.lastBufferedRequest,e.bufferedRequestCount+=1}else l(d,e,!1,o,u,f,p);return a}(this,h,g,d,a,f)),i},i.prototype.cork=function(){this._writableState.corked++},i.prototype.uncork=function(){var t=this._writableState;t.corked&&(t.corked--,t.writing||t.corked||t.finished||t.bufferProcessing||!t.bufferedRequest||p(this,t))},i.prototype.setDefaultEncoding=function(t){if("string"==typeof t&&(t=t.toLowerCase()),!(-1<["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((t+"").toLowerCase())))throw new TypeError("Unknown encoding: "+t);return this._writableState.defaultEncoding=t,this},Object.defineProperty(i.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),i.prototype._write=function(r,e,t){t(new Error("_write() is not implemented"))},i.prototype._writev=null,i.prototype.end=function(o,d,a){var i=this._writableState;"function"==typeof o?(a=o,o=null,d=null):"function"==typeof d&&(a=d,d=null),null!=o&&this.write(o,d),i.corked&&(i.corked=1,this.uncork()),i.ending||i.finished||function(r,e,t){e.ending=!0,_(r,e),t&&(e.finished?Xt.nextTick(t):r.once("finish",t)),e.ended=!0,r.writable=!1}(this,i,a)},Object.defineProperty(i.prototype,"destroyed",{get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(t){this._writableState&&(this._writableState.destroyed=t)}}),i.prototype.destroy=dn.destroy,i.prototype._undestroy=dn.undestroy,i.prototype._destroy=function(n,e){this.end(),e(n)}}).call(this,pe,"undefined"==typeof global?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:global,o({}).setImmediate)}),o=so(function(n,d){(function(t,e){function n(n,e){this._id=n,this._clearFn=e}var l=pe.nextTick,r=(Function.prototype.apply,Array.prototype.slice),i={},s=0;n.prototype.unref=n.prototype.ref=function(){},n.prototype.close=function(){this._clearFn.call(window,this._id)},d.setImmediate="function"==typeof t?t:function(t){var e=s++,n=!(2>arguments.length)&&r.call(arguments,1);return i[e]=!0,l(function(){i[e]&&(n?t.apply(null,n):t.call(null),d.clearImmediate(e))}),e},d.clearImmediate="function"==typeof e?e:function(t){delete i[t]}}).call(this,o({}).setImmediate,o({}).clearImmediate)}),a=so(function(t){var o=Math.round;function n(d,e,t,n){return o(d/t)+" "+n+(e>=1.5*t?"s":"")}t.exports=function(r,e){e=e||{};var d,i,s=typeof r;if("string"==s&&0<r.length)return function(n){if(!(100<(n=n+"").length)){var r=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(n);if(r){var t=parseFloat(r[1]);switch((r[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*t;case"weeks":case"week":case"w":return 6048e5*t;case"days":case"day":case"d":return t*86400000;case"hours":case"hour":case"hrs":case"hr":case"h":return t*3600000;case"minutes":case"minute":case"mins":case"min":case"m":return t*60000;case"seconds":case"second":case"secs":case"sec":case"s":return t*1000;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return t;default:}}}}(r);if("number"==s&&isFinite(r))return e.long?(d=r,86400000<=(i=oo(d))?n(d,i,86400000,"day"):3600000<=i?n(d,i,3600000,"hour"):60000<=i?n(d,i,60000,"minute"):1000<=i?n(d,i,1000,"second"):d+" ms"):function(n){var e=oo(n);return 86400000<=e?o(n/86400000)+"d":3600000<=e?o(n/3600000)+"h":60000<=e?o(n/60000)+"m":1000<=e?o(n/1000)+"s":n+"ms"}(r);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(r))}}),e=so(function(t){t.exports=function(n,e,t){for(var r,d,l,u=1/0,f=0,p=e.length-1;f<=p&&(0>(l=e[r=f+(p-f>>1)]-n)?f=r+1:0<l&&(p=r-1),(l=oo(l))<u&&(u=l,d=r),e[r]!==n););return t?d:e[d]}}),po=so(function(f){(function(_,e){"use strict";function n(r,o,t){H=H||l({}),r=r||{},"boolean"!=typeof t&&(t=o instanceof H),this.objectMode=!!r.objectMode,t&&(this.objectMode=this.objectMode||!!r.readableObjectMode),this.highWaterMark=W(this,r,"readableHighWaterMark",t),this.buffer=new fe,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=!1!==r.emitClose,this.destroyed=!1,this.defaultEncoding=r.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,r.encoding&&(a||(a=d({}).StringDecoder),this.decoder=new a(r.encoding),this.encoding=r.encoding)}function k(r){if(H=H||l({}),!(this instanceof k))return new k(r);var e=this instanceof H;this._readableState=new n(r,this,e),this.readable=!0,r&&("function"==typeof r.read&&(this._read=r.read),"function"==typeof r.destroy&&(this._destroy=r.destroy)),yo.call(this)}function S(d,e,a,n,r){D("readableAddChunk",e);var i,s=d._readableState;if(null===e)s.reading=!1,function(r,e){if(!e.ended){if(e.decoder){var t=e.decoder.end();t&&t.length&&(e.buffer.push(t),e.length+=e.objectMode?1:t.length)}e.ended=!0,e.sync?T(r):(e.needReadable=!1,e.emittedReadable||(e.emittedReadable=!0,I(r)))}}(d,s);else if(r||(i=function(d,e){var t,a;return a=e,F.isBuffer(a)||a instanceof o||"string"==typeof e||void 0===e||d.objectMode||(t=new j("chunk",["string","Buffer","Uint8Array"],e)),t}(s,e)),i)d.emit("error",i);else if(!(s.objectMode||e&&0<e.length))n||(s.reading=!1,R(d,s));else if("string"==typeof e||s.objectMode||Object.getPrototypeOf(e)===F.prototype||(e=function(t){return F.from(t)}(e)),n)s.endEmitted?d.emit("error",new b):C(d,s,e,!0);else if(s.ended)d.emit("error",new g);else{if(s.destroyed)return!1;s.reading=!1,s.decoder&&!a?(e=s.decoder.write(e),s.objectMode||0!==e.length?C(d,s,e,!1):R(d,s)):C(d,s,e,!1)}return!s.ended&&(s.length<s.highWaterMark||0===s.length)}function C(o,e,t,n){e.flowing&&0===e.length&&!e.sync?(e.awaitDrain=0,o.emit("data",t)):(e.length+=e.objectMode?1:t.length,n?e.buffer.unshift(t):e.buffer.push(t),e.needReadable&&T(o)),R(o,e)}function x(n,e){return 0>=n||0===e.length&&e.ended?0:e.objectMode?1:n==n?(n>e.highWaterMark&&(e.highWaterMark=function(t){return t>=8388608?t=8388608:(t--,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t++),t}(n)),n<=e.length?n:e.ended?e.length:(e.needReadable=!0,0)):e.flowing&&e.length?e.buffer.head.data.length:e.length}function T(t){var e=t._readableState;e.needReadable=!1,e.emittedReadable||(D("emitReadable",e.flowing),e.emittedReadable=!0,_.nextTick(I,t))}function I(n){var e=n._readableState;D("emitReadable_",e.destroyed,e.length,e.ended),!e.destroyed&&(e.length||e.ended)&&n.emit("readable"),e.needReadable=!e.flowing&&!e.ended&&e.length<=e.highWaterMark,U(n)}function R(r,e){e.readingMore||(e.readingMore=!0,_.nextTick(t,r,e))}function t(r,e){for(;!e.reading&&!e.ended&&(e.length<e.highWaterMark||e.flowing&&0===e.length);){var t=e.length;if(D("maybeReadMore read 0"),r.read(0),t===e.length)break}e.readingMore=!1}function L(n){var e=n._readableState;e.readableListening=0<n.listenerCount("readable"),e.resumeScheduled&&!e.paused?e.flowing=!0:0<n.listenerCount("data")&&n.resume()}function B(t){D("readable nexttick read 0"),t.read(0)}function A(n,e){D("resume",e.reading),e.reading||n.read(0),e.resumeScheduled=!1,n.emit("resume"),U(n),e.flowing&&!e.reading&&n.read(0)}function U(n){var e=n._readableState;for(D("flow",e.flowing);e.flowing&&null!==n.read(););}function P(r,e){return 0===e.length?null:(e.objectMode?t=e.buffer.shift():!r||r>=e.length?(t=e.decoder?e.buffer.join(""):1===e.buffer.length?e.buffer.first():e.buffer.concat(e.length),e.buffer.clear()):t=e.buffer.consume(r,e.decoder),t);var t}function M(t){var e=t._readableState;D("endReadable",e.endEmitted),e.endEmitted||(e.ended=!0,_.nextTick(O,e,t))}function O(n,e){D("endReadableNT",n.endEmitted,n.length),n.endEmitted||0!==n.length||(n.endEmitted=!0,e.readable=!1,e.emit("end"))}function N(o,e){for(var t=0,d=o.length;t<d;t++)if(o[t]===e)return t;return-1}var H;f.exports=k,k.ReadableState=n,m.EventEmitter;var D,q=function(n,e){return n.listeners(e).length},F=p({}).Buffer,o=e.Uint8Array||function(){};D=oe&&oe.debuglog?oe.debuglog("stream"):function(){};var a,s,W=Ue.getHighWaterMark,u=Co.codes,j=u.ERR_INVALID_ARG_TYPE,g=u.ERR_STREAM_PUSH_AFTER_EOF,y=u.ERR_METHOD_NOT_IMPLEMENTED,b=u.ERR_STREAM_UNSHIFT_AFTER_END_EVENT,w=Oe.emitExperimentalWarning;Me(k,yo);var v=["error","close","destroy","pause","resume"];Object.defineProperty(k.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(t){this._readableState&&(this._readableState.destroyed=t)}}),k.prototype.destroy=vo.destroy,k.prototype._undestroy=vo.undestroy,k.prototype._destroy=function(n,e){e(n)},k.prototype.push=function(o,d){var a,i=this._readableState;return i.objectMode?a=!0:"string"==typeof o&&((d=d||i.defaultEncoding)!==i.encoding&&(o=F.from(o,d),d=""),a=!0),S(this,o,d,!1,a)},k.prototype.unshift=function(t){return S(this,t,null,!0,!1)},k.prototype.isPaused=function(){return!1===this._readableState.flowing},k.prototype.setEncoding=function(t){return a||(a=d({}).StringDecoder),this._readableState.decoder=new a(t),this._readableState.encoding=this._readableState.decoder.encoding,this};k.prototype.read=function(o){D("read",o),o=parseInt(o,10);var d=this._readableState,t=o;if(0!==o&&(d.emittedReadable=!1),0===o&&d.needReadable&&((0===d.highWaterMark?0<d.length:d.length>=d.highWaterMark)||d.ended))return D("read: emitReadable",d.length,d.ended),0===d.length&&d.ended?M(this):T(this),null;if(0===(o=x(o,d))&&d.ended)return 0===d.length&&M(this),null;var n,a=d.needReadable;return D("need readable",a),(0===d.length||d.length-o<d.highWaterMark)&&D("length less than watermark",a=!0),d.ended||d.reading?D("reading or ended",a=!1):a&&(D("do read"),d.reading=!0,d.sync=!0,0===d.length&&(d.needReadable=!0),this._read(d.highWaterMark),d.sync=!1,d.reading||(o=x(t,d))),null===(n=0<o?P(o,d):null)?(d.needReadable=!0,o=0):(d.length-=o,d.awaitDrain=0),0===d.length&&(d.ended||(d.needReadable=!0),t!==o&&d.ended&&M(this)),null!==n&&this.emit("data",n),n},k.prototype._read=function(){this.emit("error",new y("_read()"))},k.prototype.pipe=function(i,e){function m(){D("onend"),i.end()}function h(e){D("ondata");var t=i.write(e);D("dest.write",t),!1===t&&((1===r.pipesCount&&r.pipes===i||1<r.pipesCount&&-1!==N(r.pipes,i))&&!a&&(D("false write response, pause",r.awaitDrain),r.awaitDrain++),g.pause())}function d(e){D("onerror",e),p(),i.removeListener("error",d),0===q(i,"error")&&i.emit("error",e)}function l(){i.removeListener("finish",f),p()}function f(){D("onfinish"),i.removeListener("close",l),p()}function p(){D("unpipe"),g.unpipe(i)}var g=this,r=this._readableState;switch(r.pipesCount){case 0:r.pipes=i;break;case 1:r.pipes=[r.pipes,i];break;default:r.pipes.push(i);}r.pipesCount+=1,D("pipe count=%d opts=%j",r.pipesCount,e);var t=e&&!1===e.end||i===_.stdout||i===_.stderr?p:m;r.endEmitted?_.nextTick(t):g.once("end",t),i.on("unpipe",function e(t,n){D("onunpipe"),t===g&&n&&!1===n.hasUnpiped&&(n.hasUnpiped=!0,D("cleanup"),i.removeListener("close",l),i.removeListener("finish",f),i.removeListener("drain",o),i.removeListener("error",d),i.removeListener("unpipe",e),g.removeListener("end",m),g.removeListener("end",p),g.removeListener("data",h),a=!0,!r.awaitDrain||i._writableState&&!i._writableState.needDrain||o())});var o=function(n){return function(){var e=n._readableState;D("pipeOnDrain",e.awaitDrain),e.awaitDrain&&e.awaitDrain--,0===e.awaitDrain&&q(n,"data")&&(e.flowing=!0,U(n))}}(g);i.on("drain",o);var a=!1;return g.on("data",h),function(r,e,t){return"function"==typeof r.prependListener?r.prependListener("error",t):void(r._events&&r._events.error?Array.isArray(r._events.error)?r._events.error.unshift(t):r._events.error=[t,r._events.error]:r.on("error",t))}(i,0,d),i.once("close",l),i.once("finish",f),i.emit("pipe",g),r.flowing||(D("pipe resume"),g.resume()),i},k.prototype.unpipe=function(d){var a=this._readableState,t={hasUnpiped:!1};if(0===a.pipesCount)return this;if(1===a.pipesCount)return d&&d!==a.pipes?this:(d||(d=a.pipes),a.pipes=null,a.pipesCount=0,a.flowing=!1,d&&d.emit("unpipe",this,t),this);if(!d){var n=a.pipes,r=a.pipesCount;a.pipes=null,a.pipesCount=0,a.flowing=!1;for(var i=0;i<r;i++)n[i].emit("unpipe",this,{hasUnpiped:!1});return this}var l=N(a.pipes,d);return-1===l?this:(a.pipes.splice(l,1),a.pipesCount-=1,1===a.pipesCount&&(a.pipes=a.pipes[0]),d.emit("unpipe",this,t),this)},k.prototype.on=function(t,e){var n=yo.prototype.on.call(this,t,e),r=this._readableState;return"data"===t?(r.readableListening=0<this.listenerCount("readable"),!1!==r.flowing&&this.resume()):"readable"==t&&(r.endEmitted||r.readableListening||(r.readableListening=r.needReadable=!0,r.flowing=!1,r.emittedReadable=!1,D("on readable",r.length,r.reading),r.length?T(this):r.reading||_.nextTick(B,this))),n},k.prototype.addListener=k.prototype.on,k.prototype.removeListener=function(t,e){var n=yo.prototype.removeListener.call(this,t,e);return"readable"===t&&_.nextTick(L,this),n},k.prototype.removeAllListeners=function(t){var e=yo.prototype.removeAllListeners.apply(this,arguments);return"readable"!==t&&void 0!==t||_.nextTick(L,this),e},k.prototype.resume=function(){var t=this._readableState;return t.flowing||(D("resume"),t.flowing=!t.readableListening,function(t,e){e.resumeScheduled||(e.resumeScheduled=!0,_.nextTick(A,t,e))}(this,t)),t.paused=!1,this},k.prototype.pause=function(){return D("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(D("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},k.prototype.wrap=function(d){var a=this,t=this._readableState,e=!1;for(var n in d.on("end",function(){if(D("wrapped end"),t.decoder&&!t.ended){var n=t.decoder.end();n&&n.length&&a.push(n)}a.push(null)}),d.on("data",function(n){D("wrapped data"),t.decoder&&(n=t.decoder.write(n)),t.objectMode&&null==n||(t.objectMode||n&&n.length)&&(a.push(n)||(e=!0,d.pause()))}),d)void 0===this[n]&&"function"==typeof d[n]&&(this[n]=function(e){return function(){return d[e].apply(d,arguments)}}(n));for(var i=0;i<v.length;i++)d.on(v[i],this.emit.bind(this,v[i]));return this._read=function(n){D("wrapped _read",n),e&&(e=!1,d.resume())},this},"function"==typeof Symbol&&(k.prototype[Symbol.asyncIterator]=function(){return w("Readable[Symbol.asyncIterator]"),void 0===s&&(s=i({})),s(this)}),Object.defineProperty(k.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(k.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(k.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(t){this._readableState&&(this._readableState.flowing=t)}}),k._fromList=P,Object.defineProperty(k.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}})}).call(this,pe,"undefined"==typeof global?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:global)}),i=so(function(l){(function(_){"use strict";function t(r,e,t){return e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function b(n,e){return{value:n,done:e}}function r(r){var e=r[i];if(null!==e){var t=r[u].read();null!==t&&(r[p]=null,r[i]=null,r[s]=null,e(b(t,!1)))}}var e,f=ho({}),i=Symbol("lastResolve"),s=Symbol("lastReject"),o=Symbol("error"),a=Symbol("ended"),p=Symbol("lastPromise"),c=Symbol("handlePromise"),u=Symbol("stream"),d=Object.getPrototypeOf(function(){}),h=Object.setPrototypeOf((t(e={get stream(){return this[u]},next:function(){var t=this,e=this[o];if(null!==e)return Promise.reject(e);if(this[a])return Promise.resolve(b(void 0,!0));if(this[u].destroyed)return new Promise(function(e,n){_.nextTick(function(){t[o]?n(t[o]):e(b(void 0,!0))})});var n,d=this[p];if(d)n=new Promise(function(o,e){return function(t,n){o.then(function(){e[a]?t(b(void 0,!0)):e[c](t,n)},n)}}(d,this));else{var i=this[u].read();if(null!==i)return Promise.resolve(b(i,!1));n=new Promise(this[c])}return this[p]=n,n}},Symbol.asyncIterator,function(){return this}),t(e,"return",function(){var r=this;return new Promise(function(o,t){r[u].destroy(null,function(n){n?t(n):o(b(void 0,!0))})})}),e),d);l.exports=function(d){var e,g=Object.create(h,(t(e={},u,{value:d,writable:!0}),t(e,i,{value:null,writable:!0}),t(e,s,{value:null,writable:!0}),t(e,o,{value:null,writable:!0}),t(e,a,{value:d._readableState.endEmitted,writable:!0}),t(e,c,{value:function(r,e){var t=g[u].read();t?(g[p]=null,g[i]=null,g[s]=null,r(b(t,!1))):(g[i]=r,g[s]=e)},writable:!0}),e));return g[p]=null,f(d,function(r){if(r&&"ERR_STREAM_PREMATURE_CLOSE"!==r.code){var e=g[s];return null!==e&&(g[p]=null,g[i]=null,g[s]=null,e(r)),void(g[o]=r)}var t=g[i];null!==t&&(g[p]=null,g[i]=null,g[s]=null,t(b(void 0,!0))),g[a]=!0}),d.on("readable",function(t){_.nextTick(r,t)}.bind(null,g)),g}}).call(this,pe)}),ho=so(function(t){"use strict";function m(){}var r=Co.codes.ERR_STREAM_PREMATURE_CLOSE;t.exports=function n(_,e,t){if("function"==typeof e)return n(_,null,e);e||(e={}),t=function(o){var e=!1;return function(){if(!e){e=!0;for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];o.apply(this,n)}}}(t||m);var b=e.readable||!1!==e.readable&&_.readable,y=e.writable||!1!==e.writable&&_.writable,w=function(){_.writable||S()},h=_._writableState&&_._writableState.finished,S=function(){y=!1,h=!0,b||t.call(_)},u=_._readableState&&_._readableState.endEmitted,k=function(){b=!1,u=!0,y||t.call(_)},l=function(n){t.call(_,n)},f=function(){var n;return b&&!u?(_._readableState&&_._readableState.ended||(n=new r),t.call(_,n)):y&&!h?(_._writableState&&_._writableState.ended||(n=new r),t.call(_,n)):void 0},p=function(){_.req.on("finish",S)};return function(t){return t.setHeader&&"function"==typeof t.abort}(_)?(_.on("complete",S),_.on("abort",f),_.req?p():_.on("request",p)):y&&!_._writableState&&(_.on("end",w),_.on("close",w)),_.on("end",k),_.on("finish",S),!1!==e.error&&_.on("error",l),_.on("close",f),function(){_.removeListener("complete",S),_.removeListener("abort",f),_.removeListener("request",p),_.req&&_.req.removeListener("finish",S),_.removeListener("end",w),_.removeListener("close",w),_.removeListener("finish",S),_.removeListener("end",k),_.removeListener("error",l),_.removeListener("close",f)}}}),d=so(function(f,e){"use strict";function t(r){var e;switch(this.encoding=function(r){var e=function(n){if(!n)return"utf8";for(var r;;)switch(n){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return n;default:if(r)return;n=(""+n).toLowerCase(),r=!0;}}(r);if("string"!=typeof e&&(l.isEncoding===n||!n(r)))throw new Error("Unknown encoding: "+r);return e||r}(r),this.encoding){case"utf16le":this.text=o,this.end=a,e=4;break;case"utf8":this.fillLast=i,e=4;break;case"base64":this.text=s,this.end=c,e=3;break;default:return this.write=u,void(this.end=d);}this.lastNeed=0,this.lastTotal=0,this.lastChar=l.allocUnsafe(e)}function p(t){return 127>=t?0:6==t>>5?2:14==t>>4?3:30==t>>3?4:2==t>>6?-1:-2}function i(r){var e=this.lastTotal-this.lastNeed,t=function(n,e){if(128!=(192&e[0]))return n.lastNeed=0,"\uFFFD";if(1<n.lastNeed&&1<e.length){if(128!=(192&e[1]))return n.lastNeed=1,"\uFFFD";if(2<n.lastNeed&&2<e.length&&128!=(192&e[2]))return n.lastNeed=2,"\uFFFD"}}(this,r);return void 0===t?this.lastNeed<=r.length?(r.copy(this.lastChar,e,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(r.copy(this.lastChar,e,0,r.length),void(this.lastNeed-=r.length)):t}function o(o,e){if(0==(o.length-e)%2){var t=o.toString("utf16le",e);if(t){var n=t.charCodeAt(t.length-1);if(55296<=n&&56319>=n)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=o[o.length-2],this.lastChar[1]=o[o.length-1],t.slice(0,-1)}return t}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=o[o.length-1],o.toString("utf16le",e,o.length-1)}function a(r){var e=r&&r.length?this.write(r):"";if(this.lastNeed){var t=this.lastTotal-this.lastNeed;return e+this.lastChar.toString("utf16le",0,t)}return e}function s(r,e){var t=(r.length-e)%3;return 0==t?r.toString("base64",e):(this.lastNeed=3-t,this.lastTotal=3,1==t?this.lastChar[0]=r[r.length-1]:(this.lastChar[0]=r[r.length-2],this.lastChar[1]=r[r.length-1]),r.toString("base64",e,r.length-t))}function c(n){var e=n&&n.length?this.write(n):"";return this.lastNeed?e+this.lastChar.toString("base64",0,3-this.lastNeed):e}function u(t){return t.toString(this.encoding)}function d(t){return t&&t.length?this.write(t):""}var l=Lo.Buffer,n=l.isEncoding||function(t){switch((t=""+t)&&t.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1;}};e.StringDecoder=t,t.prototype.write=function(r){if(0===r.length)return"";var e,o;if(this.lastNeed){if(void 0===(e=this.fillLast(r)))return"";o=this.lastNeed,this.lastNeed=0}else o=0;return o<r.length?e?e+this.text(r,o):this.text(r,o):e||""},t.prototype.end=function(n){var e=n&&n.length?this.write(n):"";return this.lastNeed?e+"\uFFFD":e},t.prototype.text=function(o,e){var t=function(o,e,t){var n=e.length-1;if(n<t)return 0;var d=p(e[n]);return 0<=d?(0<d&&(o.lastNeed=d-1),d):--n<t||-2===d?0:0<=(d=p(e[n]))?(0<d&&(o.lastNeed=d-2),d):--n<t||-2===d?0:0<=(d=p(e[n]))?(0<d&&(2===d?d=0:o.lastNeed=d-3),d):0}(this,o,e);if(!this.lastNeed)return o.toString("utf8",e);this.lastTotal=t;var n=o.length-(t-this.lastNeed);return o.copy(this.lastChar,0,n),o.toString("utf8",e,n)},t.prototype.fillLast=function(t){return this.lastNeed<=t.length?(t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):void(t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,t.length),this.lastNeed-=t.length)}}),l=so(function(l){(function(e){"use strict";function t(o){return this instanceof t?void(n.call(this,o),r.call(this,o),this.allowHalfOpen=!0,o&&(!1===o.readable&&(this.readable=!1),!1===o.writable&&(this.writable=!1),!1===o.allowHalfOpen&&(this.allowHalfOpen=!1,this.once("end",f)))):new t(o)}function f(){this._writableState.ended||e.nextTick(c,this)}function c(t){t.end()}var d=Object.keys||function(r){var e=[];for(var t in r)e.push(t);return e};l.exports=t;var n=po({}),r=u({});Me(t,n);for(var i,p=d(r.prototype),s=0;s<p.length;s++)i=p[s],t.prototype[i]||(t.prototype[i]=r.prototype[i]);Object.defineProperty(t.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(t.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(t.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(t.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&this._readableState.destroyed&&this._writableState.destroyed},set:function(t){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=t,this._writableState.destroyed=t)}})}).call(this,pe)}),u=so(function(m){(function(L,e){"use strict";function B(n){var e=this;this.next=null,this.entry=null,this.finish=function(){!function(n,e){var t=n.entry;for(n.entry=null;t;){var o=t.callback;e.pendingcb--,o(void 0),t=t.next}e.corkedRequestsFree.next=n}(e,n)}}function t(){}function n(t,r,n){T=T||l({}),t=t||{},"boolean"!=typeof n&&(n=r instanceof T),this.objectMode=!!t.objectMode,n&&(this.objectMode=this.objectMode||!!t.writableObjectMode),this.highWaterMark=h(this,t,"writableHighWaterMark",n),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var d=!1===t.decodeStrings;this.decodeStrings=!d,this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(t){!function(t,e){var n=t._writableState,r=n.sync,d=n.writecb;if("function"!=typeof d)throw new u;if(function(t){t.writing=!1,t.writecb=null,t.length-=t.writelen,t.writelen=0}(n),e)!function(t,e,n,r,o){--e.pendingcb,n?(L.nextTick(o,r),L.nextTick(x,t,e),t._writableState.errorEmitted=!0,t.emit("error",r)):(o(r),t._writableState.errorEmitted=!0,t.emit("error",r),x(t,e))}(t,n,r,e,d);else{var a=v(n)||t.destroyed;a||n.corked||n.bufferProcessing||!n.bufferedRequest||E(t,n),r?L.nextTick(S,t,n,a,d):S(t,n,a,d)}}(r,t)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!1!==t.emitClose,this.bufferedRequestCount=0,this.corkedRequestsFree=new B(this)}function r(o){var e=this instanceof(T=T||l({}));return e||I.call(r,this)?void(this._writableState=new n(o,this,e),this.writable=!0,o&&("function"==typeof o.write&&(this._write=o.write),"function"==typeof o.writev&&(this._writev=o.writev),"function"==typeof o.destroy&&(this._destroy=o.destroy),"function"==typeof o.final&&(this._final=o.final)),yo.call(this)):new r(o)}function k(d,e,t,n,r,a,i){e.writelen=n,e.writecb=i,e.writing=!0,e.sync=!0,e.destroyed?e.onwrite(new g("write")):t?d._writev(r,e.onwrite):d._write(r,a,e.onwrite),e.sync=!1}function S(o,e,t,n){t||function(n,e){0===e.length&&e.needDrain&&(e.needDrain=!1,n.emit("drain"))}(o,e),e.pendingcb--,n(),x(o,e)}function E(r,e){e.bufferProcessing=!0;var t=e.bufferedRequest;if(r._writev&&t&&t.next){var l=e.bufferedRequestCount,i=Array(l),s=e.corkedRequestsFree;s.entry=t;for(var o=0,f=!0;t;)i[o]=t,t.isBuf||(f=!1),t=t.next,o+=1;i.allBuffers=f,k(r,e,!0,e.length,i,"",s.finish),e.pendingcb++,e.lastBufferedRequest=null,s.next?(e.corkedRequestsFree=s.next,s.next=null):e.corkedRequestsFree=new B(e),e.bufferedRequestCount=0}else{for(;t;){var p=t.chunk,c=t.encoding,u=t.callback;if(k(r,e,!1,e.objectMode?1:p.length,p,c,u),t=t.next,e.bufferedRequestCount--,e.writing)break}null===t&&(e.lastBufferedRequest=null)}e.bufferedRequest=t,e.bufferProcessing=!1}function v(t){return t.ending&&0===t.length&&null===t.bufferedRequest&&!t.finished&&!t.writing}function C(r,e){r._final(function(t){e.pendingcb--,t&&r.emit("error",t),e.prefinished=!0,r.emit("prefinish"),x(r,e)})}function x(t,e){var n=v(e);return n&&(function(t,e){e.prefinished||e.finalCalled||("function"!=typeof t._final||e.destroyed?(e.prefinished=!0,t.emit("prefinish")):(e.pendingcb++,e.finalCalled=!0,L.nextTick(C,t,e)))}(t,e),0===e.pendingcb&&(e.finished=!0,t.emit("finish"))),n}var T;m.exports=r,r.WritableState=n;var I,R={deprecate:xo},A=p({}).Buffer,a=e.Uint8Array||function(){},h=Ue.getHighWaterMark,o=Co.codes,c=o.ERR_INVALID_ARG_TYPE,d=o.ERR_METHOD_NOT_IMPLEMENTED,u=o.ERR_MULTIPLE_CALLBACK,f=o.ERR_STREAM_CANNOT_PIPE,g=o.ERR_STREAM_DESTROYED,_=o.ERR_STREAM_NULL_VALUES,y=o.ERR_STREAM_WRITE_AFTER_END,b=o.ERR_UNKNOWN_ENCODING;Me(r,yo),n.prototype.getBuffer=function(){for(var n=this.bufferedRequest,r=[];n;)r.push(n),n=n.next;return r},function(){try{Object.defineProperty(n.prototype,"buffer",{get:R.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(t){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(I=Function.prototype[Symbol.hasInstance],Object.defineProperty(r,Symbol.hasInstance,{value:function(t){return!!I.call(this,t)||this===r&&t&&t._writableState instanceof n}})):I=function(t){return t instanceof this},r.prototype.pipe=function(){this.emit("error",new f)},r.prototype.write=function(d,l,u){var f,p=this._writableState,s=!1,h=!p.objectMode&&(f=d,A.isBuffer(f)||f instanceof a);return h&&!A.isBuffer(d)&&(d=function(t){return A.from(t)}(d)),"function"==typeof l&&(u=l,l=null),h?l="buffer":l||(l=p.defaultEncoding),"function"!=typeof u&&(u=t),p.ending?function(t,e){var n=new y;t.emit("error",n),L.nextTick(e,n)}(this,u):(h||function(t,e,n,r){var o;return null===n?o=new _:"string"==typeof n||e.objectMode||(o=new c("chunk",["string","Buffer"],n)),!o||(t.emit("error",o),L.nextTick(r,o),!1)}(this,p,d,u))&&(p.pendingcb++,s=function(d,e,t,a,l,f){if(!t){var s=function(r,e,o){return r.objectMode||!1===r.decodeStrings||"string"!=typeof e||(e=A.from(e,o)),e}(e,a,l);a!==s&&(t=!0,l="buffer",a=s)}var o=e.objectMode?1:a.length;e.length+=o;var p=e.length<e.highWaterMark;if(p||(e.needDrain=!0),e.writing||e.corked){var c=e.lastBufferedRequest;e.lastBufferedRequest={chunk:a,encoding:l,isBuf:t,callback:f,next:null},c?c.next=e.lastBufferedRequest:e.bufferedRequest=e.lastBufferedRequest,e.bufferedRequestCount+=1}else k(d,e,!1,o,a,l,f);return p}(this,p,h,d,l,u)),s},r.prototype.cork=function(){this._writableState.corked++},r.prototype.uncork=function(){var t=this._writableState;t.corked&&(t.corked--,t.writing||t.corked||t.bufferProcessing||!t.bufferedRequest||E(this,t))},r.prototype.setDefaultEncoding=function(t){if("string"==typeof t&&(t=t.toLowerCase()),!(-1<["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((t+"").toLowerCase())))throw new b(t);return this._writableState.defaultEncoding=t,this},Object.defineProperty(r.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(r.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),r.prototype._write=function(r,e,t){t(new d("_write()"))},r.prototype._writev=null,r.prototype.end=function(t,o,d){var a=this._writableState;return"function"==typeof t?(d=t,t=null,o=null):"function"==typeof o&&(d=o,o=null),null!=t&&this.write(t,o),a.corked&&(a.corked=1,this.uncork()),a.ending||function(t,e,n){e.ending=!0,x(t,e),n&&(e.finished?L.nextTick(n):t.once("finish",n)),e.ended=!0,t.writable=!1}(this,a,d),this},Object.defineProperty(r.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(r.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(t){this._writableState&&(this._writableState.destroyed=t)}}),r.prototype.destroy=vo.destroy,r.prototype._undestroy=vo.undestroy,r.prototype._destroy=function(n,e){e(n)}}).call(this,pe,"undefined"==typeof global?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:global)}),p=so(function(n,L){(function(H){"use strict";function D(e){if(e>N)throw new RangeError("The value \""+e+"\" is invalid for option \"size\"");var t=new Uint8Array(e);return t.__proto__=H.prototype,t}function H(o,e,t){if("number"==typeof o){if("string"==typeof e)throw new TypeError("The \"string\" argument must be of type string. Received type number");return s(o)}return r(o,e,t)}function r(e,t,n){if("string"==typeof e)return function(e,t){if("string"==typeof t&&""!==t||(t="utf8"),!H.isEncoding(t))throw new TypeError("Unknown encoding: "+t);var r=0|a(e,t),d=D(r),i=d.write(e,t);return i!==r&&(d=d.slice(0,i)),d}(e,t);if(ArrayBuffer.isView(e))return q(e);if(null==e)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(M(e,ArrayBuffer)||e&&M(e.buffer,ArrayBuffer))return function(e,t,n){if(0>t||e.byteLength<t)throw new RangeError("\"offset\" is outside of buffer bounds");if(e.byteLength<t+(n||0))throw new RangeError("\"length\" is outside of buffer bounds");var r;return(r=void 0===t&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,t):new Uint8Array(e,t,n)).__proto__=H.prototype,r}(e,t,n);if("number"==typeof e)throw new TypeError("The \"value\" argument must not be of type number. Received type number");var r=e.valueOf&&e.valueOf();if(null!=r&&r!==e)return H.from(r,t,n);var d=function(e){if(H.isBuffer(e)){var t=0|o(e.length),n=D(t);return 0===n.length?n:(e.copy(n,0,0,t),n)}return void 0===e.length?"Buffer"===e.type&&Array.isArray(e.data)?q(e.data):void 0:"number"!=typeof e.length||P(e.length)?D(0):q(e)}(e);if(d)return d;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return H.from(e[Symbol.toPrimitive]("string"),t,n);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function i(t){if("number"!=typeof t)throw new TypeError("\"size\" argument must be of type number");if(0>t)throw new RangeError("The value \""+t+"\" is invalid for option \"size\"")}function s(t){return i(t),D(0>t?0:0|o(t))}function q(r){for(var e=0>r.length?0:0|o(r.length),t=D(e),n=0;n<e;n+=1)t[n]=255&r[n];return t}function o(t){if(t>=N)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+N.toString(16)+" bytes");return 0|t}function a(e,t){if(H.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||M(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError("The \"string\" argument must be one of type string, Buffer, or ArrayBuffer. Received type "+typeof e);var o=e.length,r=2<arguments.length&&!0===arguments[2];if(!r&&0===o)return 0;for(var d=!1;;)switch(t){case"ascii":case"latin1":case"binary":return o;case"utf8":case"utf-8":return R(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*o;case"hex":return o>>>1;case"base64":return U(e).length;default:if(d)return r?-1:R(e).length;t=(""+t).toLowerCase(),d=!0;}}function c(o,e,t){var n=o[e];o[e]=o[t],o[t]=n}function u(e,t,o,a,l){if(0===e.length)return-1;if("string"==typeof o?(a=o,o=0):2147483647<o?o=2147483647:-2147483648>o&&(o=-2147483648),P(o=+o)&&(o=l?0:e.length-1),0>o&&(o=e.length+o),o>=e.length){if(l)return-1;o=e.length-1}else if(0>o){if(!l)return-1;o=0}if("string"==typeof t&&(t=H.from(t,a)),H.isBuffer(t))return 0===t.length?-1:d(e,t,o,a,l);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?l?Uint8Array.prototype.indexOf.call(e,t,o):Uint8Array.prototype.lastIndexOf.call(e,t,o):d(e,[t],o,a,l);throw new TypeError("val must be string, number or Buffer")}function d(f,e,t,p,g){function i(n,e){return 1===m?n[e]:n.readUInt16BE(e*m)}var c,m=1,_=f.length,b=e.length;if(void 0!==p&&("ucs2"===(p=(p+"").toLowerCase())||"ucs-2"===p||"utf16le"===p||"utf-16le"===p)){if(2>f.length||2>e.length)return-1;m=2,_/=2,b/=2,t/=2}if(g){var y=-1;for(c=t;c<_;c++)if(i(f,c)!==i(e,-1===y?0:c-y))-1!==y&&(c-=c-y),y=-1;else if(-1===y&&(y=c),c-y+1===b)return y*m}else for(t+b>_&&(t=_-b),c=t;0<=c;c--){for(var w=!0,S=0;S<b;S++)if(i(f,c+S)!==i(e,S)){w=!1;break}if(w)return c}return-1}function l(d,e,t,l){t=+t||0;var c=d.length-t;l?(l=+l)>c&&(l=c):l=c;var i=e.length;l>i/2&&(l=i/2);for(var s,u=0;u<l;++u){if(s=parseInt(e.substr(2*u,2),16),P(s))return u;d[t+u]=s}return u}function f(o,e,t,n){return F(R(e,o.length-t),o,t,n)}function p(o,e,t,n){return F(function(r){for(var e=[],t=0;t<r.length;++t)e.push(255&r.charCodeAt(t));return e}(e),o,t,n)}function h(o,e,t,n){return p(o,e,t,n)}function g(o,e,t,n){return F(U(e),o,t,n)}function m(o,e,t,n){return F(function(d,e){for(var a,l,c,u=[],s=0;s<d.length&&!(0>(e-=2));++s)l=(a=d.charCodeAt(s))>>8,c=a%256,u.push(c),u.push(l);return u}(e,o.length-t),o,t,n)}function _(r,e,t){return 0===e&&t===r.length?y.fromByteArray(r):y.fromByteArray(r.slice(e,t))}function b(l,e,t){t=ao(l.length,t);for(var f=[],r=e;r<t;){var p,g,m,_,b=l[r],c=null,y=239<b?4:223<b?3:191<b?2:1;r+y<=t&&(1==y?128>b&&(c=b):2==y?128==(192&(p=l[r+1]))&&127<(_=(31&b)<<6|63&p)&&(c=_):3==y?(p=l[r+1],g=l[r+2],128==(192&p)&&128==(192&g)&&2047<(_=(15&b)<<12|(63&p)<<6|63&g)&&(55296>_||57343<_)&&(c=_)):4==y?(p=l[r+1],g=l[r+2],m=l[r+3],128==(192&p)&&128==(192&g)&&128==(192&m)&&65535<(_=(15&b)<<18|(63&p)<<12|(63&g)<<6|63&m)&&1114112>_&&(c=_)):void 0);null===c?(c=65533,y=1):65535<c&&(c-=65536,f.push(55296|1023&c>>>10),c=56320|1023&c),f.push(c),r+=y}return function(o){var e=o.length;if(e<=W)return ro.apply(String,o);for(var t="",d=0;d<e;)t+=ro.apply(String,o.slice(d,d+=W));return t}(f)}function w(o,e,t){var d="";t=ao(o.length,t);for(var a=e;a<t;++a)d+=ro(127&o[a]);return d}function E(o,e,t){var d="";t=ao(o.length,t);for(var a=e;a<t;++a)d+=ro(o[a]);return d}function k(d,e,a){var l,c=d.length;(!e||0>e)&&(e=0),(!a||0>a||a>c)&&(a=c);for(var i="",u=e;u<a;++u)i+=16>(l=d[u])?"0"+l.toString(16):l.toString(16);return i}function S(o,e,t){for(var n=o.slice(e,t),r="",d=0;d<n.length;d+=2)r+=ro(n[d]+256*n[d+1]);return r}function C(r,e,t){if(0!=r%1||0>r)throw new RangeError("offset is not uint");if(r+e>t)throw new RangeError("Trying to access beyond buffer length")}function x(e,t,n,r,d,a){if(!H.isBuffer(e))throw new TypeError("\"buffer\" argument must be a Buffer instance");if(t>d||t<a)throw new RangeError("\"value\" argument is out of bounds");if(n+r>e.length)throw new RangeError("Index out of range")}function T(o,e,t,n){if(t+n>o.length)throw new RangeError("Index out of range");if(0>t)throw new RangeError("Index out of range")}function A(o,e,d,a,r){return e=+e,d>>>=0,r||T(o,0,d,4),O.write(o,e,d,a,23,4),d+4}function I(o,e,d,a,r){return e=+e,d>>>=0,r||T(o,0,d,8),O.write(o,e,d,a,52,8),d+8}function R(d,e){var a;e=e||1/0;for(var l=d.length,r=null,c=[],s=0;s<l;++s){if(55295<(a=d.charCodeAt(s))&&57344>a){if(!r){if(56319<a){-1<(e-=3)&&c.push(239,191,189);continue}if(s+1===l){-1<(e-=3)&&c.push(239,191,189);continue}r=a;continue}if(56320>a){-1<(e-=3)&&c.push(239,191,189),r=a;continue}a=65536+(r-55296<<10|a-56320)}else r&&-1<(e-=3)&&c.push(239,191,189);if(r=null,128>a){if(0>(e-=1))break;c.push(a)}else if(2048>a){if(0>(e-=2))break;c.push(192|a>>6,128|63&a)}else if(65536>a){if(0>(e-=3))break;c.push(224|a>>12,128|63&a>>6,128|63&a)}else{if(!(1114112>a))throw new Error("Invalid code point");if(0>(e-=4))break;c.push(240|a>>18,128|63&a>>12,128|63&a>>6,128|63&a)}}return c}function U(n){return y.toByteArray(function(n){if(2>(n=(n=n.split("=")[0]).trim().replace(t,"")).length)return"";for(;0!=n.length%4;)n+="=";return n}(n))}function F(o,e,t,n){for(var r=0;r<n&&!(r+t>=e.length||r>=o.length);++r)e[r+t]=o[r];return r}function M(n,e){return n instanceof e||null!=n&&null!=n.constructor&&null!=n.constructor.name&&n.constructor.name===e.name}function P(t){return t!=t}L.Buffer=H,L.SlowBuffer=function(e){return+e!=e&&(e=0),H.alloc(+e)},L.INSPECT_MAX_BYTES=50;var N=2147483647;L.kMaxLength=N,H.TYPED_ARRAY_SUPPORT=function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()}catch(e){return!1}}(),H.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(H.prototype,"parent",{enumerable:!0,get:function(){if(H.isBuffer(this))return this.buffer}}),Object.defineProperty(H.prototype,"offset",{enumerable:!0,get:function(){if(H.isBuffer(this))return this.byteOffset}}),"undefined"!=typeof Symbol&&null!=Symbol.species&&H[Symbol.species]===H&&Object.defineProperty(H,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),H.poolSize=8192,H.from=function(o,e,t){return r(o,e,t)},H.prototype.__proto__=Uint8Array.prototype,H.__proto__=Uint8Array,H.alloc=function(r,e,t){return function(r,e,t){return i(r),0>=r?D(r):void 0===e?D(r):"string"==typeof t?D(r).fill(e,t):D(r).fill(e)}(r,e,t)},H.allocUnsafe=function(t){return s(t)},H.allocUnsafeSlow=function(t){return s(t)},H.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==H.prototype},H.compare=function(e,d){if(M(e,Uint8Array)&&(e=H.from(e,e.offset,e.byteLength)),M(d,Uint8Array)&&(d=H.from(d,d.offset,d.byteLength)),!H.isBuffer(e)||!H.isBuffer(d))throw new TypeError("The \"buf1\", \"buf2\" arguments must be one of type Buffer or Uint8Array");if(e===d)return 0;for(var a=e.length,l=d.length,c=0,u=ao(a,l);c<u;++c)if(e[c]!==d[c]){a=e[c],l=d[c];break}return a<l?-1:l<a?1:0},H.isEncoding=function(t){switch((t+"").toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1;}},H.concat=function(e,t){if(!Array.isArray(e))throw new TypeError("\"list\" argument must be an Array of Buffers");if(0===e.length)return H.alloc(0);var d;if(void 0===t)for(t=0,d=0;d<e.length;++d)t+=e[d].length;var a=H.allocUnsafe(t),i=0;for(d=0;d<e.length;++d){var l=e[d];if(M(l,Uint8Array)&&(l=H.from(l)),!H.isBuffer(l))throw new TypeError("\"list\" argument must be an Array of Buffers");l.copy(a,i),i+=l.length}return a},H.byteLength=a,H.prototype._isBuffer=!0,H.prototype.swap16=function(){var n=this.length;if(0!=n%2)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<n;e+=2)c(this,e,e+1);return this},H.prototype.swap32=function(){var n=this.length;if(0!=n%4)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<n;e+=4)c(this,e,e+3),c(this,e+1,e+2);return this},H.prototype.swap64=function(){var n=this.length;if(0!=n%8)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<n;e+=8)c(this,e,e+7),c(this,e+1,e+6),c(this,e+2,e+5),c(this,e+3,e+4);return this},H.prototype.toString=function(){var t=this.length;return 0===t?"":0===arguments.length?b(this,0,t):function(o,d,a){var i=!1;if((void 0===d||0>d)&&(d=0),d>this.length)return"";if((void 0===a||a>this.length)&&(a=this.length),0>=a)return"";if((a>>>=0)<=(d>>>=0))return"";for(o||(o="utf8");;)switch(o){case"hex":return k(this,d,a);case"utf8":case"utf-8":return b(this,d,a);case"ascii":return w(this,d,a);case"latin1":case"binary":return E(this,d,a);case"base64":return _(this,d,a);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return S(this,d,a);default:if(i)throw new TypeError("Unknown encoding: "+o);o=(o+"").toLowerCase(),i=!0;}}.apply(this,arguments)},H.prototype.toLocaleString=H.prototype.toString,H.prototype.equals=function(e){if(!H.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===H.compare(this,e)},H.prototype.inspect=function(){var t="",r=L.INSPECT_MAX_BYTES;return t=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(t+=" ... "),"<Buffer "+t+">"},H.prototype.compare=function(e,l,f,p,g){if(M(e,Uint8Array)&&(e=H.from(e,e.offset,e.byteLength)),!H.isBuffer(e))throw new TypeError("The \"target\" argument must be one of type Buffer or Uint8Array. Received type "+typeof e);if(void 0===l&&(l=0),void 0===f&&(f=e?e.length:0),void 0===p&&(p=0),void 0===g&&(g=this.length),0>l||f>e.length||0>p||g>this.length)throw new RangeError("out of range index");if(p>=g&&l>=f)return 0;if(p>=g)return-1;if(l>=f)return 1;if(this===e)return 0;for(var m=(g>>>=0)-(p>>>=0),_=(f>>>=0)-(l>>>=0),b=ao(m,_),h=this.slice(p,g),c=e.slice(l,f),u=0;u<b;++u)if(h[u]!==c[u]){m=h[u],_=c[u];break}return m<_?-1:_<m?1:0},H.prototype.includes=function(r,e,t){return-1!==this.indexOf(r,e,t)},H.prototype.indexOf=function(r,e,t){return u(this,r,e,t,!0)},H.prototype.lastIndexOf=function(r,e,t){return u(this,r,e,t,!1)},H.prototype.write=function(o,e,d,a){if(void 0===e)a="utf8",d=this.length,e=0;else if(void 0===d&&"string"==typeof e)a=e,d=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e>>>=0,isFinite(d)?(d>>>=0,void 0===a&&(a="utf8")):(a=d,d=void 0)}var c=this.length-e;if((void 0===d||d>c)&&(d=c),0<o.length&&(0>d||0>e)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");a||(a="utf8");for(var i=!1;;)switch(a){case"hex":return l(this,o,e,d);case"utf8":case"utf-8":return f(this,o,e,d);case"ascii":return p(this,o,e,d);case"latin1":case"binary":return h(this,o,e,d);case"base64":return g(this,o,e,d);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return m(this,o,e,d);default:if(i)throw new TypeError("Unknown encoding: "+a);a=(""+a).toLowerCase(),i=!0;}},H.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var W=4096;H.prototype.slice=function(e,o){var d=this.length;0>(e=~~e)?0>(e+=d)&&(e=0):e>d&&(e=d),0>(o=void 0===o?d:~~o)?0>(o+=d)&&(o=0):o>d&&(o=d),o<e&&(o=e);var r=this.subarray(e,o);return r.__proto__=H.prototype,r},H.prototype.readUIntLE=function(o,d,a){o>>>=0,d>>>=0,a||C(o,d,this.length);for(var n=this[o],l=1,c=0;++c<d&&(l*=256);)n+=this[o+c]*l;return n},H.prototype.readUIntBE=function(o,d,a){o>>>=0,d>>>=0,a||C(o,d,this.length);for(var n=this[o+--d],s=1;0<d&&(s*=256);)n+=this[o+--d]*s;return n},H.prototype.readUInt8=function(n,r){return n>>>=0,r||C(n,1,this.length),this[n]},H.prototype.readUInt16LE=function(n,r){return n>>>=0,r||C(n,2,this.length),this[n]|this[n+1]<<8},H.prototype.readUInt16BE=function(n,r){return n>>>=0,r||C(n,2,this.length),this[n]<<8|this[n+1]},H.prototype.readUInt32LE=function(n,r){return n>>>=0,r||C(n,4,this.length),(this[n]|this[n+1]<<8|this[n+2]<<16)+16777216*this[n+3]},H.prototype.readUInt32BE=function(n,r){return n>>>=0,r||C(n,4,this.length),16777216*this[n]+(this[n+1]<<16|this[n+2]<<8|this[n+3])},H.prototype.readIntLE=function(o,d,a){o>>>=0,d>>>=0,a||C(o,d,this.length);for(var n=this[o],l=1,c=0;++c<d&&(l*=256);)n+=this[o+c]*l;return n>=(l*=128)&&(n-=no(2,8*d)),n},H.prototype.readIntBE=function(o,d,a){o>>>=0,d>>>=0,a||C(o,d,this.length);for(var n=d,l=1,c=this[o+--n];0<n&&(l*=256);)c+=this[o+--n]*l;return c>=(l*=128)&&(c-=no(2,8*d)),c},H.prototype.readInt8=function(n,r){return n>>>=0,r||C(n,1,this.length),128&this[n]?-1*(255-this[n]+1):this[n]},H.prototype.readInt16LE=function(r,o){r>>>=0,o||C(r,2,this.length);var t=this[r]|this[r+1]<<8;return 32768&t?4294901760|t:t},H.prototype.readInt16BE=function(r,o){r>>>=0,o||C(r,2,this.length);var t=this[r+1]|this[r]<<8;return 32768&t?4294901760|t:t},H.prototype.readInt32LE=function(n,r){return n>>>=0,r||C(n,4,this.length),this[n]|this[n+1]<<8|this[n+2]<<16|this[n+3]<<24},H.prototype.readInt32BE=function(n,r){return n>>>=0,r||C(n,4,this.length),this[n]<<24|this[n+1]<<16|this[n+2]<<8|this[n+3]},H.prototype.readFloatLE=function(n,r){return n>>>=0,r||C(n,4,this.length),O.read(this,n,!0,23,4)},H.prototype.readFloatBE=function(n,r){return n>>>=0,r||C(n,4,this.length),O.read(this,n,!1,23,4)},H.prototype.readDoubleLE=function(n,r){return n>>>=0,r||C(n,8,this.length),O.read(this,n,!0,52,8)},H.prototype.readDoubleBE=function(n,r){return n>>>=0,r||C(n,8,this.length),O.read(this,n,!1,52,8)},H.prototype.writeUIntLE=function(o,d,a,l){o=+o,d>>>=0,a>>>=0,l||x(this,o,d,a,no(2,8*a)-1,0);var r=1,c=0;for(this[d]=255&o;++c<a&&(r*=256);)this[d+c]=255&o/r;return d+a},H.prototype.writeUIntBE=function(o,d,a,l){o=+o,d>>>=0,a>>>=0,l||x(this,o,d,a,no(2,8*a)-1,0);var r=a-1,c=1;for(this[d+r]=255&o;0<=--r&&(c*=256);)this[d+r]=255&o/c;return d+a},H.prototype.writeUInt8=function(r,o,d){return r=+r,o>>>=0,d||x(this,r,o,1,255,0),this[o]=255&r,o+1},H.prototype.writeUInt16LE=function(r,o,d){return r=+r,o>>>=0,d||x(this,r,o,2,65535,0),this[o]=255&r,this[o+1]=r>>>8,o+2},H.prototype.writeUInt16BE=function(r,o,d){return r=+r,o>>>=0,d||x(this,r,o,2,65535,0),this[o]=r>>>8,this[o+1]=255&r,o+2},H.prototype.writeUInt32LE=function(r,o,d){return r=+r,o>>>=0,d||x(this,r,o,4,4294967295,0),this[o+3]=r>>>24,this[o+2]=r>>>16,this[o+1]=r>>>8,this[o]=255&r,o+4},H.prototype.writeUInt32BE=function(r,o,d){return r=+r,o>>>=0,d||x(this,r,o,4,4294967295,0),this[o]=r>>>24,this[o+1]=r>>>16,this[o+2]=r>>>8,this[o+3]=255&r,o+4},H.prototype.writeIntLE=function(d,l,c,n){if(d=+d,l>>>=0,!n){var r=no(2,8*c-1);x(this,d,l,c,r-1,-r)}var i=0,u=1,f=0;for(this[l]=255&d;++i<c&&(u*=256);)0>d&&0==f&&0!==this[l+i-1]&&(f=1),this[l+i]=255&(d/u>>0)-f;return l+c},H.prototype.writeIntBE=function(d,l,c,n){if(d=+d,l>>>=0,!n){var r=no(2,8*c-1);x(this,d,l,c,r-1,-r)}var i=c-1,u=1,f=0;for(this[l+i]=255&d;0<=--i&&(u*=256);)0>d&&0==f&&0!==this[l+i+1]&&(f=1),this[l+i]=255&(d/u>>0)-f;return l+c},H.prototype.writeInt8=function(r,o,d){return r=+r,o>>>=0,d||x(this,r,o,1,127,-128),0>r&&(r=255+r+1),this[o]=255&r,o+1},H.prototype.writeInt16LE=function(r,o,d){return r=+r,o>>>=0,d||x(this,r,o,2,32767,-32768),this[o]=255&r,this[o+1]=r>>>8,o+2},H.prototype.writeInt16BE=function(r,o,d){return r=+r,o>>>=0,d||x(this,r,o,2,32767,-32768),this[o]=r>>>8,this[o+1]=255&r,o+2},H.prototype.writeInt32LE=function(r,o,d){return r=+r,o>>>=0,d||x(this,r,o,4,2147483647,-2147483648),this[o]=255&r,this[o+1]=r>>>8,this[o+2]=r>>>16,this[o+3]=r>>>24,o+4},H.prototype.writeInt32BE=function(r,o,d){return r=+r,o>>>=0,d||x(this,r,o,4,2147483647,-2147483648),0>r&&(r=4294967295+r+1),this[o]=r>>>24,this[o+1]=r>>>16,this[o+2]=r>>>8,this[o+3]=255&r,o+4},H.prototype.writeFloatLE=function(r,e,t){return A(this,r,e,!0,t)},H.prototype.writeFloatBE=function(r,e,t){return A(this,r,e,!1,t)},H.prototype.writeDoubleLE=function(r,e,t){return I(this,r,e,!0,t)},H.prototype.writeDoubleBE=function(r,e,t){return I(this,r,e,!1,t)},H.prototype.copy=function(e,t,d,a){if(!H.isBuffer(e))throw new TypeError("argument should be a Buffer");if(d||(d=0),a||0===a||(a=this.length),t>=e.length&&(t=e.length),t||(t=0),0<a&&a<d&&(a=d),a===d)return 0;if(0===e.length||0===this.length)return 0;if(0>t)throw new RangeError("targetStart out of bounds");if(0>d||d>=this.length)throw new RangeError("Index out of range");if(0>a)throw new RangeError("sourceEnd out of bounds");a>this.length&&(a=this.length),e.length-t<a-d&&(a=e.length-t+d);var l=a-d;if(this===e&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(t,d,a);else if(this===e&&d<t&&t<a)for(var s=l-1;0<=s;--s)e[s+t]=this[s+d];else Uint8Array.prototype.set.call(e,this.subarray(d,a),t);return l},H.prototype.fill=function(e,d,l,c){if("string"==typeof e){if("string"==typeof d?(c=d,d=0,l=this.length):"string"==typeof l&&(c=l,l=this.length),void 0!==c&&"string"!=typeof c)throw new TypeError("encoding must be a string");if("string"==typeof c&&!H.isEncoding(c))throw new TypeError("Unknown encoding: "+c);if(1===e.length){var u=e.charCodeAt(0);("utf8"===c&&128>u||"latin1"===c)&&(e=u)}}else"number"==typeof e&&(e&=255);if(0>d||this.length<d||this.length<l)throw new RangeError("Out of range index");if(l<=d)return this;var s;if(d>>>=0,l=void 0===l?this.length:l>>>0,e||(e=0),"number"==typeof e)for(s=d;s<l;++s)this[s]=e;else{var f=H.isBuffer(e)?e:H.from(e,c),a=f.length;if(0===a)throw new TypeError("The value \""+e+"\" is invalid for argument \"value\"");for(s=0;s<l-d;++s)this[s+d]=f[s%a]}return this};var t=/[^+\/0-9A-Za-z-_]/g}).call(this,p({}).Buffer)}),m={},c=Object.create||function(n){var e=function(){};return e.prototype=n,new e},f=Object.keys||function(r){var e=[];for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&e.push(t);return t},s=Function.prototype.bind||function(n){var e=this;return function(){return e.apply(n,arguments)}};m=tt,tt.EventEmitter=tt,tt.prototype._events=void 0,tt.prototype._maxListeners=void 0;var h,g=10;try{var b={};Object.defineProperty&&Object.defineProperty(b,"x",{value:0}),h=0===b.x}catch(e){h=!1}h?Object.defineProperty(tt,"defaultMaxListeners",{enumerable:!0,get:function(){return g},set:function(t){if("number"!=typeof t||0>t||t!=t)throw new TypeError("\"defaultMaxListeners\" must be a positive number");g=t}}):tt.defaultMaxListeners=g,tt.prototype.setMaxListeners=function(t){if("number"!=typeof t||0>t||isNaN(t))throw new TypeError("\"n\" argument must be a positive number");return this._maxListeners=t,this},tt.prototype.getMaxListeners=function(){return v(this)},tt.prototype.emit=function(d){var e,l,u,f,p,g,m="error"===d;if(g=this._events)m=m&&null==g.error;else if(!m)return!1;if(m){if(1<arguments.length&&(e=arguments[1]),e instanceof Error)throw e;var _=new Error("Unhandled \"error\" event. ("+e+")");throw _.context=e,_}if(!(l=g[d]))return!1;var h="function"==typeof l;switch(u=arguments.length){case 1:!function(o,e,t){if(e)o.call(t);else for(var n=o.length,r=R(o,n),d=0;d<n;++d)r[d].call(t)}(l,h,this);break;case 2:!function(d,e,t,n){if(e)d.call(t,n);else for(var r=d.length,a=R(d,r),i=0;i<r;++i)a[i].call(t,n)}(l,h,this,arguments[1]);break;case 3:!function(d,e,t,n,r){if(e)d.call(t,n,r);else for(var i=d.length,s=R(d,i),o=0;o<i;++o)s[o].call(t,n,r)}(l,h,this,arguments[1],arguments[2]);break;case 4:!function(d,e,t,n,r,i){if(e)d.call(t,n,r,i);else for(var s=d.length,o=R(d,s),a=0;a<s;++a)o[a].call(t,n,r,i)}(l,h,this,arguments[1],arguments[2],arguments[3]);break;default:for(f=Array(u-1),p=1;p<u;p++)f[p-1]=arguments[p];!function(d,e,t,n){if(e)d.apply(t,n);else for(var r=d.length,a=R(d,r),i=0;i<r;++i)a[i].apply(t,n)}(l,h,this,f);}return!0},tt.prototype.addListener=function(n,e){return C(this,n,e,!1)},tt.prototype.on=tt.prototype.addListener,tt.prototype.prependListener=function(n,e){return C(this,n,e,!0)},tt.prototype.once=function(n,e){if("function"!=typeof e)throw new TypeError("\"listener\" argument must be a function");return this.on(n,T(this,n,e)),this},tt.prototype.prependOnceListener=function(n,e){if("function"!=typeof e)throw new TypeError("\"listener\" argument must be a function");return this.prependListener(n,T(this,n,e)),this},tt.prototype.removeListener=function(d,e){var t,a,l,u,f;if("function"!=typeof e)throw new TypeError("\"listener\" argument must be a function");if(!(a=this._events))return this;if(!(t=a[d]))return this;if(t===e||t.listener===e)0==--this._eventsCount?this._events=c(null):(delete a[d],a.removeListener&&this.emit("removeListener",d,t.listener||e));else if("function"!=typeof t){for(l=-1,u=t.length-1;0<=u;u--)if(t[u]===e||t[u].listener===e){f=t[u].listener,l=u;break}if(0>l)return this;0===l?t.shift():function(t){for(var e=l,o=e+1,d=t.length;o<d;e+=1,o+=1)t[e]=t[o];t.pop()}(t),1===t.length&&(a[d]=t[0]),a.removeListener&&this.emit("removeListener",d,f||e)}return this},tt.prototype.removeAllListeners=function(o){var e,d,a;if(!(d=this._events))return this;if(!d.removeListener)return 0===arguments.length?(this._events=c(null),this._eventsCount=0):d[o]&&(0==--this._eventsCount?this._events=c(null):delete d[o]),this;if(0===arguments.length){var l,u=f(d);for(a=0;a<u.length;++a)"removeListener"!==(l=u[a])&&this.removeAllListeners(l);return this.removeAllListeners("removeListener"),this._events=c(null),this._eventsCount=0,this}if("function"==typeof(e=d[o]))this.removeListener(o,e);else if(e)for(a=e.length-1;0<=a;a--)this.removeListener(o,e[a]);return this},tt.prototype.listeners=function(t){return A(this,t,!0)},tt.prototype.rawListeners=function(t){return A(this,t,!1)},tt.listenerCount=function(n,e){return"function"==typeof n.listenerCount?n.listenerCount(e):I.call(n,e)},tt.prototype.listenerCount=I,tt.prototype.eventNames=function(){return 0<this._eventsCount?Reflect.ownKeys(this._events):[]};for(var y={toByteArray:function(d){var e,l,c=B(d),r=c[0],i=c[1],s=new L(function(r,e,t){return 3*(e+t)/4-t}(0,r,i)),o=0,u=0<i?r-4:r;for(l=0;l<u;l+=4)e=S[d.charCodeAt(l)]<<18|S[d.charCodeAt(l+1)]<<12|S[d.charCodeAt(l+2)]<<6|S[d.charCodeAt(l+3)],s[o++]=255&e>>16,s[o++]=255&e>>8,s[o++]=255&e;return 2===i&&(e=S[d.charCodeAt(l)]<<2|S[d.charCodeAt(l+1)]>>4,s[o++]=255&e),1===i&&(e=S[d.charCodeAt(l)]<<10|S[d.charCodeAt(l+1)]<<4|S[d.charCodeAt(l+2)]>>2,s[o++]=255&e>>8,s[o++]=255&e),s},fromByteArray:function(d){for(var e,a=d.length,n=a%3,r=[],i=0,l=a-n;i<l;i+=16383)r.push(D(d,i,i+16383>l?l:i+16383));return 1==n?(e=d[a-1],r.push(w[e>>2]+w[63&e<<4]+"==")):2==n&&(e=(d[a-2]<<8)+d[a-1],r.push(w[e>>10]+w[63&e>>4]+w[63&e<<2]+"=")),r.join("")}},w=[],S=[],L="undefined"==typeof Uint8Array?Array:Uint8Array,U="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",P=0,M=U.length;P<M;++P)w[P]=U[P],S[U.charCodeAt(P)]=P;S[45]=62,S[95]=63;var O={read:function(p,e,t,n,r){var i,g,m=8*r-n-1,a=(1<<m)-1,h=a>>1,c=-7,_=t?r-1:0,b=t?-1:1,l=p[e+_];for(_+=b,i=l&(1<<-c)-1,l>>=-c,c+=m;0<c;i=256*i+p[e+_],_+=b,c-=8);for(g=i&(1<<-c)-1,i>>=-c,c+=n;0<c;g=256*g+p[e+_],_+=b,c-=8);if(0===i)i=1-h;else{if(i===a)return g?NaN:1/0*(l?-1:1);g+=no(2,n),i-=h}return(l?-1:1)*g*no(2,i-n)},write:function(m,e,_,n,r,b){var s,y,w,S=8*b-r-1,k=(1<<S)-1,u=k>>1,d=23===r?no(2,-24)-no(2,-77):0,l=n?0:b-1,E=n?1:-1,p=0>e||0===e&&0>1/e?1:0;for(e=oo(e),isNaN(e)||e===1/0?(y=isNaN(e)?1:0,s=k):(s=io(Math.log(e)/Math.LN2),1>e*(w=no(2,-s))&&(s--,w*=2),2<=(e+=1<=s+u?d/w:d*no(2,1-u))*w&&(s++,w/=2),s+u>=k?(y=0,s=k):1<=s+u?(y=(e*w-1)*no(2,r),s+=u):(y=e*no(2,u-1)*no(2,r),s=0));8<=r;m[_+l]=255&y,l+=E,y/=256,r-=8);for(s=s<<r|y,S+=r;0<S;m[_+l]=255&s,l+=E,s/=256,S-=8);m[_+l-E]|=128*p}},q={};(function(t){q=function(e,o){var d=[];e.on("data",function(t){d.push(t)}),e.once("end",function(){o&&o(null,t.concat(d)),o=null}),e.once("error",function(t){o&&o(t),o=null})}}).call(this,p({}).Buffer);var j={},go=p({}),z=go.Buffer;z.from&&z.alloc&&z.allocUnsafe&&z.allocUnsafeSlow?j=go:(H(go,j),j.Buffer=V),V.prototype=Object.create(z.prototype),H(z,V),V.from=function(r,e,t){if("number"==typeof r)throw new TypeError("Argument must not be a number");return z(r,e,t)},V.alloc=function(o,e,t){if("number"!=typeof o)throw new TypeError("Argument must be a number");var n=z(o);return void 0===e?n.fill(0):"string"==typeof t?n.fill(e,t):n.fill(e),n},V.allocUnsafe=function(t){if("number"!=typeof t)throw new TypeError("Argument must be a number");return z(t)},V.allocUnsafeSlow=function(t){if("number"!=typeof t)throw new TypeError("Argument must be a number");return go.SlowBuffer(t)};var $,mo=j.Buffer;G.bytes=-1,G._floatConversionDetected=!1,G.getType=function(t){return mo.isBuffer(t)?"buffer":Array.isArray(t)?"array":ArrayBuffer.isView(t)?"arraybufferview":t instanceof Number?"number":t instanceof Boolean?"boolean":t instanceof ArrayBuffer?"arraybuffer":typeof t},G._encode=function(n,e){if(null!=e)switch(G.getType(e)){case"buffer":G.buffer(n,e);break;case"object":G.dict(n,e);break;case"array":G.list(n,e);break;case"string":G.string(n,e);break;case"number":case"boolean":G.number(n,e);break;case"arraybufferview":G.buffer(n,mo.from(e.buffer,e.byteOffset,e.byteLength));break;case"arraybuffer":G.buffer(n,mo.from(e));}};var Y=mo.from("e"),X=mo.from("d"),Z=mo.from("l");G.buffer=function(n,e){n.push(mo.from(e.length+":"),e)},G.string=function(n,e){n.push(mo.from(mo.byteLength(e)+":"+e))},G.number=function(r,e){var t=2147483648*(e/2147483648<<0)+(e%2147483648<<0);r.push(mo.from("i"+t+"e")),t===e||G._floatConversionDetected||(G._floatConversionDetected=!0,console.warn("WARNING: Possible data corruption detected with value \""+e+"\":","Bencoding only defines support for integers, value was converted to \""+t+"\""),console.trace())},G.dict=function(o,e){o.push(X);for(var t,d=0,a=Object.keys(e).sort(),i=a.length;d<i;d++)null!=e[t=a[d]]&&(G.string(o,t),G._encode(o,e[t]));o.push(Y)},G.list=function(o,e){var t=0,d=e.length;for(o.push(Z);t<d;t++)null!=e[t]&&G._encode(o,e[t]);o.push(Y)},$=G;var Q,_o=j.Buffer;ne.bytes=0,ne.position=0,ne.data=null,ne.encoding=null,ne.next=function(){switch(ne.data[ne.position]){case 100:return ne.dictionary();case 108:return ne.list();case 105:return ne.integer();default:return ne.buffer();}},ne.find=function(o){for(var e=ne.position,d=ne.data.length,n=ne.data;e<d;){if(n[e]===o)return e;e++}throw new Error("Invalid data: Missing delimiter \""+ro(o)+"\" [0x"+o.toString(16)+"]")},ne.dictionary=function(){ne.position++;for(var t={};101!==ne.data[ne.position];)t[ne.buffer()]=ne.next();return ne.position++,t},ne.list=function(){ne.position++;for(var t=[];101!==ne.data[ne.position];)t.push(ne.next());return ne.position++,t},ne.integer=function(){var n=ne.find(101),e=J(ne.data,ne.position+1,n);return ne.position+=n+1-ne.position,e},ne.buffer=function(){var r=ne.find(58),o=J(ne.data,ne.position,r),t=++r+o;return ne.position=t,ne.encoding?ne.data.toString(ne.encoding,r,t):ne.data.slice(r,t)},Q=ne;var te={},ie=te;ie.encode=$,ie.decode=Q,ie.byteLength=ie.encodingLength=function(t){return ie.encode(t).length};var se,bo,yo=m.EventEmitter,oe={},ae=p({}).Buffer,de=oe.inspect,le=de&&de.custom||"inspect",fe=function(){function n(){this.head=null,this.tail=null,this.length=0}var e=n.prototype;return e.push=function(n){var e={data:n,next:null};0<this.length?this.tail.next=e:this.head=e,this.tail=e,++this.length},e.unshift=function(n){var e={data:n,next:this.head};0===this.length&&(this.tail=e),this.head=e,++this.length},e.shift=function(){if(0!==this.length){var t=this.head.data;return this.head=1===this.length?this.tail=null:this.head.next,--this.length,t}},e.clear=function(){this.head=this.tail=null,this.length=0},e.join=function(r){if(0===this.length)return"";for(var e=this.head,o=""+e.data;e=e.next;)o+=r+e.data;return o},e.concat=function(d){if(0===this.length)return ae.alloc(0);for(var e,a,l,c=ae.allocUnsafe(d>>>0),i=this.head,u=0;i;)e=i.data,a=c,l=u,ae.prototype.copy.call(e,a,l),u+=i.data.length,i=i.next;return c},e.consume=function(r,e){var t;return r<this.head.data.length?(t=this.head.data.slice(0,r),this.head.data=this.head.data.slice(r)):t=r===this.head.data.length?this.shift():e?this._getString(r):this._getBuffer(r),t},e.first=function(){return this.head.data},e._getString=function(o){var d=this.head,a=1,l=d.data;for(o-=l.length;d=d.next;){var c=d.data,i=o>c.length?c.length:o;if(l+=i===c.length?c:c.slice(0,o),0==(o-=i)){i===c.length?(++a,this.head=d.next?d.next:this.tail=null):(this.head=d,d.data=c.slice(i));break}++a}return this.length-=a,l},e._getBuffer=function(o){var d=ae.allocUnsafe(o),t=this.head,a=1;for(t.data.copy(d),o-=t.data.length;t=t.next;){var l=t.data,i=o>l.length?l.length:o;if(l.copy(d,d.length-o,0,i),0==(o-=i)){i===l.length?(++a,this.head=t.next?t.next:this.tail=null):(this.head=t,t.data=l.slice(i));break}++a}return this.length-=a,d},e[le]=function(n,e){return de(this,function(o){for(var e=1;e<arguments.length;e++){var d=null==arguments[e]?{}:arguments[e],n=Object.keys(d);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(d).filter(function(t){return Object.getOwnPropertyDescriptor(d,t).enumerable}))),n.forEach(function(e){re(o,e,d[e])})}return o}({},e,{depth:0,customInspect:!1}))},n}(),pe={},wo=pe={};!function(){try{se="function"==typeof setTimeout?setTimeout:he}catch(t){se=he}try{bo="function"==typeof clearTimeout?clearTimeout:_e}catch(t){bo=_e}}();var me,So=[],ko=!1,Eo=-1;wo.nextTick=function(r){var e=Array(arguments.length-1);if(1<arguments.length)for(var t=1;t<arguments.length;t++)e[t-1]=arguments[t];So.push(new Ce(r,e)),1!==So.length||ko||ye(Se)},Ce.prototype.run=function(){this.fun.apply(null,this.array)},wo.title="browser",wo.browser=!0,wo.env={},wo.argv=[],wo.version="",wo.versions={},wo.on=xe,wo.addListener=xe,wo.once=xe,wo.off=xe,wo.removeListener=xe,wo.removeAllListeners=xe,wo.emit=xe,wo.prependListener=xe,wo.prependOnceListener=xe,wo.listeners=function(){return[]},wo.binding=function(){throw new Error("process.binding is not supported")},wo.cwd=function(){return"/"},wo.chdir=function(){throw new Error("process.chdir is not supported")},wo.umask=function(){return 0};var vo={};(function(d){"use strict";function e(r,e){n(r,e),a(r)}function a(t){t._writableState&&!t._writableState.emitClose||t._readableState&&!t._readableState.emitClose||t.emit("close")}function n(n,e){n.emit("error",e)}vo={destroy:function(t,i){var s=this,r=this._readableState&&this._readableState.destroyed,o=this._writableState&&this._writableState.destroyed;return r||o?(i?i(t):!t||this._writableState&&this._writableState.errorEmitted||d.nextTick(n,this,t),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(t||null,function(t){!i&&t?(d.nextTick(e,s,t),s._writableState&&(s._writableState.errorEmitted=!0)):i?(d.nextTick(a,s),i(t)):d.nextTick(a,s)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}}}).call(this,pe);var Co={},Ie={};Te("ERR_INVALID_OPT_VALUE",function(n,e){return"The value \""+e+"\" is invalid for option \""+n+"\""},TypeError),Te("ERR_INVALID_ARG_TYPE",function(d,e,l){var n,c,u,f;if("string"==typeof e&&("not ","not "===e.substr(0,4))?(n="must not be",e=e.replace(/^not /,"")):n="must be",u=d,(void 0===f||f>u.length)&&(f=u.length)," argument"===u.substring(f-9,f))c="The ".concat(d," ").concat(n," ").concat(Be(e,"type"));else{var p=function(r,e,t){return"number"!=typeof t&&(t=0),!(t+1>r.length)&&-1!==r.indexOf(".",t)}(d)?"property":"argument";c="The \"".concat(d,"\" ").concat(p," ").concat(n," ").concat(Be(e,"type"))}return c+". Received type ".concat(typeof l)},TypeError),Te("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),Te("ERR_METHOD_NOT_IMPLEMENTED",function(t){return"The "+t+" method is not implemented"}),Te("ERR_STREAM_PREMATURE_CLOSE","Premature close"),Te("ERR_STREAM_DESTROYED",function(t){return"Cannot call "+t+" after a stream was destroyed"}),Te("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),Te("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),Te("ERR_STREAM_WRITE_AFTER_END","write after end"),Te("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),Te("ERR_UNKNOWN_ENCODING",function(t){return"Unknown encoding: "+t},TypeError),Te("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),Co.codes=Ie;var Re=Co.codes.ERR_INVALID_OPT_VALUE,Ue={getHighWaterMark:function(o,e,t,n){var r=function(r,e,t){return null==r.highWaterMark?e?r[t]:null:r.highWaterMark}(e,n,t);if(null!=r){if(!isFinite(r)||io(r)!==r||0>r)throw new Re(n?t:"highWaterMark",r);return io(r)}return o.objectMode?16:16384}},Oe={};(function(r){"use strict";var e=new Set;Oe.emitExperimentalWarning=r.emitWarning?function(t){if(!e.has(t)){e.add(t),r.emitWarning(t+" is an experimental feature. This feature could change at any time","ExperimentalWarning")}}:function(){}}).call(this,pe);var Me={};Me="function"==typeof Object.create?function(n,e){e&&(n.super_=e,n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}))}:function(r,e){if(e){r.super_=e;var t=function(){};t.prototype=e.prototype,r.prototype=new t,r.prototype.constructor=r}};var xo={};(function(r){function o(e){try{if(!r.localStorage)return!1}catch(e){return!1}var t=r.localStorage[e];return null!=t&&"true"===(t+"").toLowerCase()}xo=function(t,e){if(o("noDeprecation"))return t;var n=!1;return function(){if(!n){if(o("throwDeprecation"))throw new Error(e);o("traceDeprecation")?console.trace(e):console.warn(e),n=!0}return t.apply(this,arguments)}}}).call(this,"undefined"==typeof global?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:global);var Lo={},To=p({}),De=To.Buffer;De.from&&De.alloc&&De.allocUnsafe&&De.allocUnsafeSlow?Lo=To:(Le(To,Lo),Lo.Buffer=qe),Le(De,qe),qe.from=function(r,e,t){if("number"==typeof r)throw new TypeError("Argument must not be a number");return De(r,e,t)},qe.alloc=function(o,e,t){if("number"!=typeof o)throw new TypeError("Argument must be a number");var n=De(o);return void 0===e?n.fill(0):"string"==typeof t?n.fill(e,t):n.fill(e),n},qe.allocUnsafe=function(t){if("number"!=typeof t)throw new TypeError("Argument must be a number");return De(t)},qe.allocUnsafeSlow=function(t){if("number"!=typeof t)throw new TypeError("Argument must be a number");return To.SlowBuffer(t)};var He=Je,We=Co.codes,ze=We.ERR_METHOD_NOT_IMPLEMENTED,$e=We.ERR_MULTIPLE_CALLBACK,Ve=We.ERR_TRANSFORM_ALREADY_TRANSFORMING,Ge=We.ERR_TRANSFORM_WITH_LENGTH_0,Ke=l({});Me(Je,Ke),Je.prototype.push=function(n,e){return this._transformState.needTransform=!1,Ke.prototype.push.call(this,n,e)},Je.prototype._transform=function(r,e,t){t(new ze("_transform()"))},Je.prototype._write=function(o,e,t){var n=this._transformState;if(n.writecb=t,n.writechunk=o,n.writeencoding=e,!n.transforming){var r=this._readableState;(n.needTransform||r.needReadable||r.length<r.highWaterMark)&&this._read(r.highWaterMark)}},Je.prototype._read=function(){var e=this._transformState;null===e.writechunk||e.transforming?e.needTransform=!0:(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform))},Je.prototype._destroy=function(n,r){Ke.prototype._destroy.call(this,n,function(t){r(t)})};var Ye;Me(Qe,He),Qe.prototype._transform=function(r,e,t){t(null,r)};var Bo=Co.codes,rt=Bo.ERR_MISSING_ARGS,it=Bo.ERR_STREAM_DESTROYED,st={};(st=st=po({})).Stream=st,st.Readable=st,st.Writable=u({}),st.Duplex=l({}),st.Transform=He,st.PassThrough=Qe,st.finished=ho({}),st.pipeline=function(){for(var o=arguments.length,d=Array(o),e=0;e<o;e++)d[e]=arguments[e];var a,l=function(t){return t.length?"function"==typeof t[t.length-1]?t.pop():nt:nt}(d);if(Array.isArray(d[0])&&(d=d[0]),2>d.length)throw new rt("streams");var i=d.map(function(t,e){var n=e<d.length-1;return function(o,e,t,n){n=function(n){var e=!1;return function(){e||(e=!0,n.apply(void 0,arguments))}}(n);var d=!1;o.on("close",function(){d=!0}),void 0===Ye&&(Ye=ho({})),Ye(o,{readable:e,writable:t},function(t){return t?n(t):void(d=!0,n())});var a=!1;return function(e){if(!d&&!a)return a=!0,function(t){return t.setHeader&&"function"==typeof t.abort}(o)?o.abort():"function"==typeof o.destroy?o.destroy():void n(e||new it("pipe"))}}(t,n,0<e,function(t){a||(a=t),t&&i.forEach(ot),n||(i.forEach(ot),l(a))})});return d.reduce(at)};var Io={};(function(n){const{Transform:e}=st;Io=class extends e{constructor(o,d={}){super(d),"object"==typeof o&&(o=(d=o).size),this.size=o||512;const{nopad:a,zeroPadding:n=!0}=d;this._zeroPadding=!a&&!!n,this._buffered=[],this._bufferedBytes=0}_transform(e,t,o){for(this._bufferedBytes+=e.length,this._buffered.push(e);this._bufferedBytes>=this.size;){const e=n.concat(this._buffered);this._bufferedBytes-=this.size,this.push(e.slice(0,this.size)),this._buffered=[e.slice(this.size,e.length)]}o()}_flush(){if(this._bufferedBytes&&this._zeroPadding){const e=n.alloc(this.size-this._bufferedBytes);this._buffered.push(e),this.push(n.concat(this._buffered)),this._buffered=null}else this._bufferedBytes&&(this.push(n.concat(this._buffered)),this._buffered=null);this.push(null)}}}).call(this,p({}).Buffer);for(var Ro=e({}),dt=no(2,10),lt=13,Ao=[];22>lt++;)Ao.push(no(2,lt));var pt={};(function(){function o(o,e){for(var t,d=0,a=o.length-1;0<=a;a--)t=o[a],"."===t?o.splice(a,1):".."===t?(o.splice(a,1),d++):d&&(o.splice(a,1),d--);if(e)for(;d--;d)o.unshift("..");return o}function t(o,e){if(o.filter)return o.filter(e);for(var t=[],n=0;n<o.length;n++)e(o[n],n,o)&&t.push(o[n]);return t}pt.normalize=function(r){var d=pt.isAbsolute(r),a="/"===n(r,-1);return(r=o(t(r.split("/"),function(t){return!!t}),!d).join("/"))||d||(r="."),r&&a&&(r+="/"),(d?"/":"")+r},pt.isAbsolute=function(t){return"/"===t.charAt(0)},pt.join=function(){var n=Array.prototype.slice.call(arguments,0);return pt.normalize(t(n,function(t){if("string"!=typeof t)throw new TypeError("Arguments to path.join must be strings");return t}).join("/"))},pt.sep="/",pt.dirname=function(o){if("string"!=typeof o&&(o+=""),0===o.length)return".";for(var d=o.charCodeAt(0),a=47===d,n=-1,l=!0,c=o.length-1;1<=c;--c)if(!(47===(d=o.charCodeAt(c))))l=!1;else if(!l){n=c;break}return-1==n?a?"/":".":a&&1==n?"/":o.slice(0,n)},pt.basename=function(r,e){var t=function(o){"string"!=typeof o&&(o+="");var d,a=0,s=-1,l=!0;for(d=o.length-1;0<=d;--d)if(!(47===o.charCodeAt(d)))-1===s&&(l=!1,s=d+1);else if(!l){a=d+1;break}return-1===s?"":o.slice(a,s)}(r);return e&&t.substr(-1*e.length)===e&&(t=t.substr(0,t.length-e.length)),t},pt.extname=function(d){"string"!=typeof d&&(d+="");for(var l,c=-1,u=0,f=-1,p=!0,h=0,g=d.length-1;0<=g;--g)if(l=d.charCodeAt(g),47!==l)-1==f&&(p=!1,f=g+1),46===l?-1==c?c=g:1!=h&&(h=1):-1!=c&&(h=-1);else if(!p){u=g+1;break}return-1==c||-1==f||0==h||1==h&&c==f-1&&c==u+1?"":d.slice(c,f)};var n=function(r,e,t){return r.substr(e,t)}}).call(this,pe);var gt;gt=ht,ht.strict=bt,ht.loose=wt;var Uo=Object.prototype.toString,_t={"[object Int8Array]":!0,"[object Int16Array]":!0,"[object Int32Array]":!0,"[object Uint8Array]":!0,"[object Uint8ClampedArray]":!0,"[object Uint16Array]":!0,"[object Uint32Array]":!0,"[object Float32Array]":!0,"[object Float64Array]":!0},yt={};(function(o){var e=gt.strict;yt=function(t){if(e(t)){var n=o.from(t.buffer);return t.byteLength!==t.buffer.byteLength&&(n=n.slice(t.byteOffset,t.byteOffset+t.byteLength)),n}return o.from(t)}}).call(this,p({}).Buffer);const{Readable:Po}=st;var kt=class extends Po{constructor(r,e={}){super(e),this._offset=0,this._ready=!1,this._file=r,this._size=r.size,this._chunkSize=e.chunkSize||to(this._size/1e3,204800);const t=new FileReader;t.onload=()=>{this.push(yt(t.result))},t.onerror=()=>{this.emit("error",t.error)},this.reader=t,this._generateHeaderBlocks(r,e,(n,e)=>n?this.emit("error",n):void(Array.isArray(e)&&e.forEach(t=>this.push(t)),this._ready=!0,this.emit("_ready")))}_generateHeaderBlocks(r,e,t){t(null,[])}_read(){if(!this._ready)return void this.once("_ready",this._read.bind(this));const n=this._offset;let e=this._offset+this._chunkSize;return(e>this._size&&(e=this._size),n===this._size)?(this.destroy(),void this.push(null)):void(this.reader.readAsArrayBuffer(this._file.slice(n,e)),this._offset=e)}destroy(){if(this._file=null,this.reader){this.reader.onload=null,this.reader.onerror=null;try{this.reader.abort()}catch(t){}}this.reader=null}},St={},Ct={};(Ct=function(n,r){return r?void St.stat(n,function(t,e){return t?r(t):r(null,e.isFile())}):vt(n)}).sync=vt;var Mo={};Mo.regex=new RegExp("^npm-debug\\.log$|^\\..*\\.swp$|^\\.DS_Store$|^\\.AppleDouble$|^\\.LSOverride$|^Icon\\r$|^\\._.*|^\\.Spotlight-V100(?:$|\\/)|\\.Trashes|^__MACOSX$|~$|^Thumbs\\.db$|^ehthumbs\\.db$|^Desktop\\.ini$|@eaDir$"),Mo.is=t=>Mo.regex.test(t),Mo.not=t=>!Mo.is(t);Me(Tt,st.Readable),Tt.obj=function(t){return new Tt(t,{objectMode:!0,highWaterMark:16})},Tt.prototype._read=function(){this._drained=!0,this._forward()},Tt.prototype._forward=function(){if(!this._forwarding&&this._drained&&this._current){var t;for(this._forwarding=!0;null!==(t=this._current.read())&&this._drained;)this._drained=this.push(t);this._forwarding=!1}},Tt.prototype.destroy=function(t){this.destroyed||(this.destroyed=!0,this._current&&this._current.destroy&&this._current.destroy(),"function"!=typeof this._queue&&this._queue.forEach(function(t){t.destroy&&t.destroy()}),t&&this.emit("error",t),this.emit("close"))},Tt.prototype._next=function(){var r=this;if(r._current=null,"function"==typeof r._queue)r._queue(function(e,t){return e?r.destroy(e):void(t=r._toStreams2(t),r._attachErrorListener(t),r._gotNextStream(t))});else{var e=r._queue.shift();"function"==typeof e&&(e=r._toStreams2(e()),r._attachErrorListener(e)),r._gotNextStream(e)}},Tt.prototype._gotNextStream=function(o){function e(){r._forward()}function n(){o._readableState.ended||r.destroy()}var r=this;return o?void(r._current=o,r._forward(),o.on("readable",e),o.once("end",function t(){r._current=null,o.removeListener("readable",e),o.removeListener("end",t),o.removeListener("close",n),r._next()}),o.once("close",n)):(r.push(null),void r.destroy())},Tt.prototype._attachErrorListener=function(o){var e=this;o&&o.once("error",function t(n){o.removeListener("error",t),e.destroy(n)})};var At=function o(d,e){function t(){for(var t=Array(arguments.length),e=0;e<t.length;e++)t[e]=arguments[e];var o=d.apply(this,t),r=t[t.length-1];return"function"==typeof o&&o!==r&&Object.keys(r).forEach(function(t){o[t]=r[t]}),o}if(d&&e)return o(d)(e);if("function"!=typeof d)throw new TypeError("need wrapper function");return Object.keys(d).forEach(function(n){t[n]=d[n]}),t},Ot={};(Ot=At(Rt)).strict=At(Ut),Rt.proto=Rt(function(){Object.defineProperty(Function.prototype,"once",{value:function(){return Rt(this)},configurable:!0}),Object.defineProperty(Function.prototype,"onceStrict",{value:function(){return Ut(this)},configurable:!0})});var Oo={};(function(d){Oo=function(l,e){function c(n){function t(){e&&e(n,u),e=null}p?d.nextTick(t):t()}function a(r,e,t){u[r]=t,(0==--f||e)&&c(e)}var u,f,t,p=!0;Array.isArray(l)?(u=[],f=l.length):(t=Object.keys(l),u={},f=t.length),f?t?t.forEach(function(r){l[r](function(e,t){a(r,e,t)})}):l.forEach(function(n,r){n(function(t,e){a(r,t,e)})}):c(null),p=!1}}).call(this,pe);var No,Ho,Do={exports:{}};No="undefined"==typeof self?this:self,Ho=function(){return function(o){function d(t){if(e[t])return e[t].exports;var n=e[t]={i:t,l:!1,exports:{}};return o[t].call(n.exports,n,n.exports,d),n.l=!0,n.exports}var e={};return d.m=o,d.c=e,d.d=function(n,e,t){d.o(n,e)||Object.defineProperty(n,e,{configurable:!1,enumerable:!0,get:t})},d.n=function(n){var e=n&&n.__esModule?function(){return n.default}:function(){return n};return d.d(e,"a",e),e},d.o=function(n,e){return Object.prototype.hasOwnProperty.call(n,e)},d.p="",d(d.s=3)}([function(d,e,t){var n=t(5),r=t(1),i=r.toHex,s=r.ceilHeapSize,o=t(6),a=function(t){for(t+=9;0<t%64;t+=1);return t},l=function(o,e){var t=new Int32Array(o,e+320,5),n=new Int32Array(5),r=new DataView(n.buffer);return r.setInt32(0,t[0],!1),r.setInt32(4,t[1],!1),r.setInt32(8,t[2],!1),r.setInt32(12,t[3],!1),r.setInt32(16,t[4],!1),n},c=function(){function r(e){if(function(e){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}(this),0<(e=e||65536)%64)throw new Error("Chunk size must be a multiple of 128 bit");this._offset=0,this._maxChunkLen=e,this._padMaxChunkLen=a(e),this._heap=new ArrayBuffer(s(this._padMaxChunkLen+320+20)),this._h32=new Int32Array(this._heap),this._h8=new Int8Array(this._heap),this._core=new n({Int32Array:Int32Array},{},this._heap)}return r.prototype._initState=function(r,e){this._offset=0;var t=new Int32Array(r,e+320,5);t[0]=1732584193,t[1]=-271733879,t[2]=-1732584194,t[3]=271733878,t[4]=-1009589776},r.prototype._padChunk=function(o,e){var t=a(o),n=new Int32Array(this._heap,0,t>>2);return function(o,e){var t=new Uint8Array(o.buffer),n=e%4,r=e-n;switch(n){case 0:t[r+3]=0;case 1:t[r+2]=0;case 2:t[r+1]=0;case 3:t[r+0]=0;}for(var d=1+(e>>2);d<o.length;d++)o[d]=0}(n,o),function(r,e,t){r[e>>2]|=128<<24-(e%4<<3),r[14+(-16&2+(e>>2))]=0|t/536870912,r[15+(-16&2+(e>>2))]=t<<3}(n,o,e),t},r.prototype._write=function(d,e,t,n){o(d,this._h8,this._h32,e,t,n||0)},r.prototype._coreCall=function(o,e,t,n,r){var d=t;this._write(o,e,t),r&&(d=this._padChunk(t,n)),this._core.hash(d,this._padMaxChunkLen)},r.prototype.rawDigest=function(o){var e=o.byteLength||o.length||o.size||0;this._initState(this._heap,this._padMaxChunkLen);var t=0,d=this._maxChunkLen;for(t=0;e>t+d;t+=d)this._coreCall(o,t,d,e,!1);return this._coreCall(o,t,e-t,e,!0),l(this._heap,this._padMaxChunkLen)},r.prototype.digest=function(t){return i(this.rawDigest(t).buffer)},r.prototype.digestFromString=function(t){return this.digest(t)},r.prototype.digestFromBuffer=function(t){return this.digest(t)},r.prototype.digestFromArrayBuffer=function(t){return this.digest(t)},r.prototype.resetState=function(){return this._initState(this._heap,this._padMaxChunkLen),this},r.prototype.append=function(o){var e,d=0,a=o.byteLength||o.length||o.size||0,n=this._offset%this._maxChunkLen;for(this._offset+=a;d<a;)e=ao(a-d,this._maxChunkLen-n),this._write(o,d,e,n),d+=e,(n+=e)===this._maxChunkLen&&(this._core.hash(this._maxChunkLen,this._padMaxChunkLen),n=0);return this},r.prototype.getState=function(){var n;if(this._offset%this._maxChunkLen)n=this._heap.slice(0);else{var r=new Int32Array(this._heap,this._padMaxChunkLen+320,5);n=r.buffer.slice(r.byteOffset,r.byteOffset+r.byteLength)}return{offset:this._offset,heap:n}},r.prototype.setState=function(t){return this._offset=t.offset,20===t.heap.byteLength?new Int32Array(this._heap,this._padMaxChunkLen+320,5).set(new Int32Array(t.heap)):this._h32.set(new Int32Array(t.heap)),this},r.prototype.rawEnd=function(){var o=this._offset,e=o%this._maxChunkLen,t=this._padChunk(e,o);this._core.hash(t,this._padMaxChunkLen);var n=l(this._heap,this._padMaxChunkLen);return this._initState(this._heap,this._padMaxChunkLen),n},r.prototype.end=function(){return i(this.rawEnd().buffer)},r}();d.exports=c,d.exports._core=n},function(t){for(var o=Array(256),e=0;256>e;e++)o[e]=(16>e?"0":"")+e.toString(16);t.exports.toHex=function(n){for(var e=new Uint8Array(n),t=Array(n.byteLength),r=0;r<t.length;r++)t[r]=o[e[r]];return t.join("")},t.exports.ceilHeapSize=function(n){var e=0;if(65536>=n)return 65536;if(16777216>n)for(e=1;e<n;e<<=1);else for(e=16777216;e<n;e+=16777216);return e},t.exports.isDedicatedWorkerScope=function(o){var e="WorkerGlobalScope"in o&&o instanceof o.WorkerGlobalScope,t="SharedWorkerGlobalScope"in o&&o instanceof o.SharedWorkerGlobalScope,n="ServiceWorkerGlobalScope"in o&&o instanceof o.ServiceWorkerGlobalScope;return e&&!t&&!n}},function(r,e,o){r.exports=function(){var d=o(0),l=function(t,e,d,r,i){var s=new self.FileReader;s.onloadend=function(){if(s.error)return i(s.error);var n=s.result;e+=s.result.byteLength;try{t.append(n)}catch(e){return void i(e)}e<r.size?l(t,e,d,r,i):i(null,t.end())},s.readAsArrayBuffer(r.slice(e,e+d))},e=!0;return self.onmessage=function(t){if(e){var n=t.data.data,r=t.data.file,i=t.data.id;if(void 0!==i&&(r||n)){var o=t.data.blockSize||4194304,a=new d(o);a.resetState();var s=function(n,e){n?self.postMessage({id:i,error:n.name}):self.postMessage({id:i,hash:e})};n&&function(r,e,t){try{t(null,r.digest(e))}catch(e){return t(e)}}(a,n,s),r&&l(a,0,o,r,s)}}},function(){e=!1}}},function(d,e,t){var n=t(4),r=t(0),i=t(7),s=t(2),o=t(1).isDedicatedWorkerScope,a="undefined"!=typeof self&&o(self);r.disableWorkerBehaviour=a?s():function(){},r.createWorker=function(){var r=n(2),e=r.terminate;return r.terminate=function(){URL.revokeObjectURL(r.objectURL),e.call(r)},r},r.createHash=i,d.exports=r},function(d,e,f){function n(o){function d(t){if(e[t])return e[t].exports;var n=e[t]={i:t,l:!1,exports:{}};return o[t].call(n.exports,n,n.exports,d),n.l=!0,n.exports}var e={};d.m=o,d.c=e,d.i=function(t){return t},d.d=function(n,e,t){d.o(n,e)||Object.defineProperty(n,e,{configurable:!1,enumerable:!0,get:t})},d.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},d.n=function(n){var e=n&&n.__esModule?function(){return n.default}:function(){return n};return d.d(e,"a",e),e},d.o=function(n,e){return Object.prototype.hasOwnProperty.call(n,e)},d.p="/",d.oe=function(t){throw console.error(t),t};var t=d(d.s=ENTRY_MODULE);return t.default||t}function t(t){return(t+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function r(n,e,o){var r={};r[o]=[];var a=e.toString(),i=a.match(/^function\s?\(\w+,\s*\w+,\s*(\w+)\)/);if(!i)return r;for(var s,c=i[1],d=new RegExp("(\\\\n|\\W)"+t(c)+"\\((/\\*.*?\\*/)?s?.*?([\\.|\\-|\\+|\\w|/|@]+).*?\\)","g");s=d.exec(a);)"dll-reference"!==s[3]&&r[o].push(s[3]);for(d=new RegExp("\\("+t(c)+"\\(\"(dll-reference\\s("+"[\\.|\\-|\\+|\\w|/|@]+"+"))\"\\)\\)"+"\\((/\\*.*?\\*/)?s?.*?([\\.|\\-|\\+|\\w|/|@]+).*?\\)","g");s=d.exec(a);)n[s[2]]||(r[o].push(s[1]),n[s[2]]=f(s[1]).m),r[s[2]]=r[s[2]]||[],r[s[2]].push(s[4]);return r}function a(r){return Object.keys(r).reduce(function(e,t){return e||0<r[t].length},!1)}d.exports=function(l,e){e=e||{};var p={main:f.m},i=e.all?{main:Object.keys(p)}:function(p,e){for(var t={main:[e]},n={main:[]},h={main:{}};a(t);)for(var i=Object.keys(t),s=0;s<i.length;s++){var g=i[s],c=t[g].pop();if(h[g]=h[g]||{},!h[g][c]&&p[g][c]){h[g][c]=!0,n[g]=n[g]||[],n[g].push(c);for(var u=r(p,p[g][c],g),d=Object.keys(u),l=0;l<d.length;l++)t[d[l]]=t[d[l]]||[],t[d[l]]=t[d[l]].concat(u[d[l]])}}return n}(p,l),s="";Object.keys(i).filter(function(t){return"main"!==t}).forEach(function(r){for(var e=0;i[r][e];)e++;i[r].push(e),p[r][e]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",s=s+"var "+r+" = ("+n.toString().replace("ENTRY_MODULE",JSON.stringify(e))+")({"+i[r].map(function(e){return JSON.stringify(e)+": "+p[r][e].toString()}).join(",")+"});\n"}),s=s+"("+n.toString().replace("ENTRY_MODULE",JSON.stringify(l))+")({"+i.main.map(function(t){return JSON.stringify(t)+": "+p.main[t].toString()}).join(",")+"})(self);";var h=new window.Blob([s],{type:"text/javascript"});if(e.bare)return h;var c=(window.URL||window.webkitURL||window.mozURL||window.msURL).createObjectURL(h),u=new window.Worker(c);return u.objectURL=c,u}},function(t){t.exports=function(o,e,t){"use asm";function n(r,b){r|=0,b|=0;var y=0,w=0,S=0,k=0,E=0,v=0,C=0,x=0,L=0,T=0,B=0,I=0,R=0,A=0;for(S=0|_[b+320>>2],E=0|_[b+324>>2],C=0|_[b+328>>2],L=0|_[b+332>>2],B=0|_[b+336>>2],y=0;(0|y)<(0|r);y=0|y+64){for(k=S,v=E,x=C,T=L,I=B,w=0;64>(0|w);w=0|w+4)A=0|_[y+w>>2],R=0|(0|(S<<5|S>>>27)+(E&C|~E&L))+(0|(0|A+B)+1518500249),B=L,L=C,C=E<<30|E>>>2,E=S,S=R,_[r+w>>2]=A;for(w=0|r+64;(0|w)<(0|r+80);w=0|w+4)A=(_[w-12>>2]^_[w-32>>2]^_[w-56>>2]^_[w-64>>2])<<1|(_[w-12>>2]^_[w-32>>2]^_[w-56>>2]^_[w-64>>2])>>>31,R=0|(0|(S<<5|S>>>27)+(E&C|~E&L))+(0|(0|A+B)+1518500249),B=L,L=C,C=E<<30|E>>>2,E=S,S=R,_[w>>2]=A;for(w=0|r+80;(0|w)<(0|r+160);w=0|w+4)A=(_[w-12>>2]^_[w-32>>2]^_[w-56>>2]^_[w-64>>2])<<1|(_[w-12>>2]^_[w-32>>2]^_[w-56>>2]^_[w-64>>2])>>>31,R=0|(0|(S<<5|S>>>27)+(E^C^L))+(0|(0|A+B)+1859775393),B=L,L=C,C=E<<30|E>>>2,E=S,S=R,_[w>>2]=A;for(w=0|r+160;(0|w)<(0|r+240);w=0|w+4)A=(_[w-12>>2]^_[w-32>>2]^_[w-56>>2]^_[w-64>>2])<<1|(_[w-12>>2]^_[w-32>>2]^_[w-56>>2]^_[w-64>>2])>>>31,R=0|(0|(S<<5|S>>>27)+(E&C|E&L|C&L))+(0|(0|A+B)-1894007588),B=L,L=C,C=E<<30|E>>>2,E=S,S=R,_[w>>2]=A;for(w=0|r+240;(0|w)<(0|r+320);w=0|w+4)A=(_[w-12>>2]^_[w-32>>2]^_[w-56>>2]^_[w-64>>2])<<1|(_[w-12>>2]^_[w-32>>2]^_[w-56>>2]^_[w-64>>2])>>>31,R=0|(0|(S<<5|S>>>27)+(E^C^L))+(0|(0|A+B)-899497514),B=L,L=C,C=E<<30|E>>>2,E=S,S=R,_[w>>2]=A;S=0|S+k,E=0|E+v,C=0|C+x,L=0|L+T,B=0|B+I}_[b+320>>2]=S,_[b+324>>2]=E,_[b+328>>2]=C,_[b+332>>2]=L,_[b+336>>2]=B}var _=new o.Int32Array(t);return{hash:n}}},function(t){var l,d=this;"undefined"!=typeof self&&void 0!==self.FileReaderSync&&(l=new self.FileReaderSync);var n=function(d,e,t,n,r,i){var s,l=i%4,a=(r+l)%4,u=r-a;switch(l){case 0:e[i]=d[n+3];case 1:e[0|i+1-(l<<1)]=d[n+2];case 2:e[0|i+2-(l<<1)]=d[n+1];case 3:e[0|i+3-(l<<1)]=d[n];}if(!(r<a+(4-l))){for(s=4-l;s<u;s=0|s+4)t[0|i+s>>2]=d[n+s]<<24|d[n+s+1]<<16|d[n+s+2]<<8|d[n+s+3];switch(a){case 3:e[0|i+u+1]=d[n+u+2];case 2:e[0|i+u+2]=d[n+u+1];case 1:e[0|i+u+3]=d[n+u];}}};t.exports=function(r,e,t,i,o,a){if("string"==typeof r)return function(d,e,t,n,r,i){var s,l=i%4,a=(r+l)%4,u=r-a;switch(l){case 0:e[i]=d.charCodeAt(n+3);case 1:e[0|i+1-(l<<1)]=d.charCodeAt(n+2);case 2:e[0|i+2-(l<<1)]=d.charCodeAt(n+1);case 3:e[0|i+3-(l<<1)]=d.charCodeAt(n);}if(!(r<a+(4-l))){for(s=4-l;s<u;s=0|s+4)t[i+s>>2]=d.charCodeAt(n+s)<<24|d.charCodeAt(n+s+1)<<16|d.charCodeAt(n+s+2)<<8|d.charCodeAt(n+s+3);switch(a){case 3:e[0|i+u+1]=d.charCodeAt(n+u+2);case 2:e[0|i+u+2]=d.charCodeAt(n+u+1);case 1:e[0|i+u+3]=d.charCodeAt(n+u);}}}(r,e,t,i,o,a);if(r instanceof Array)return n(r,e,t,i,o,a);if(d&&d.Buffer&&d.Buffer.isBuffer(r))return n(r,e,t,i,o,a);if(r instanceof ArrayBuffer)return n(new Uint8Array(r),e,t,i,o,a);if(r.buffer instanceof ArrayBuffer)return n(new Uint8Array(r.buffer,r.byteOffset,r.byteLength),e,t,i,o,a);if(r instanceof Blob)return function(r,e,t,n,i,s){var o,f=s%4,p=(i+f)%4,c=i-p,u=new Uint8Array(l.readAsArrayBuffer(r.slice(n,n+i)));switch(f){case 0:e[s]=u[3];case 1:e[0|s+1-(f<<1)]=u[2];case 2:e[0|s+2-(f<<1)]=u[1];case 3:e[0|s+3-(f<<1)]=u[0];}if(!(i<p+(4-f))){for(o=4-f;o<c;o=0|o+4)t[0|s+o>>2]=u[o]<<24|u[o+1]<<16|u[o+2]<<8|u[o+3];switch(p){case 3:e[0|s+c+1]=u[c+2];case 2:e[0|s+c+2]=u[c+1];case 1:e[0|s+c+3]=u[c];}}}(r,e,t,i,o,a);throw new Error("Unsupported data type.")}},function(o,e,t){var n=t(0),r=t(1).toHex,d=function(){function o(){!function(e){if(!(e instanceof o))throw new TypeError("Cannot call a class as a function")}(this),this._rusha=new n,this._rusha.resetState()}return o.prototype.update=function(t){return this._rusha.append(t),this},o.prototype.digest=function(n){var e=this._rusha.rawEnd().buffer;if(!n)return e;if("hex"===n)return r(e);throw new Error("unsupported digest encoding")},o}();o.exports=function(){return new d}}])},"object"==typeof Do.exports?Do.exports=Ho():"object"==typeof Do.exports?Do.exports.Rusha=Ho():No.Rusha=Ho(),Do=Do.exports;var qo={},Fo=new Do,Wt="undefined"==typeof window?self:window,zt=Wt.crypto||Wt.msCrypto||{},$t=zt.subtle||zt.webkitSubtle;try{$t.digest({name:"sha-1"},new Uint8Array).catch(function(){$t=!1})}catch(e){$t=!1}(qo=function(n,r){$t?("string"==typeof n&&(n=function(o){for(var e=o.length,t=new Uint8Array(e),n=0;n<e;n++)t[n]=o.charCodeAt(n);return t}(n)),$t.digest({name:"sha-1"},n).then(function(t){r(function(o){for(var e,d=o.length,t=[],n=0;n<d;n++)e=o[n],t.push((e>>>4).toString(16)),t.push((15&e).toString(16));return t.join("")}(new Uint8Array(t)))},function(){r(Pt(n))})):setTimeout(r,0,Pt(n))}).sync=Pt;var Wo={};(function(p,d,u){function f(t){return t.reduce((n,e)=>Array.isArray(e)?n.concat(f(e)):n.concat(e),[])}function l(s,c,i){function a(){Oo(s.map(a=>e=>{const t={};if(n(a))t.getStream=function(t){return()=>new kt(t)}(a),t.length=a.size;else if(u.isBuffer(a))t.getStream=function(n){return()=>{const e=new st.PassThrough;return e.end(n),e}}(a),t.length=a.length;else{if(!o(a)){if("string"==typeof a){if("function"!=typeof St.stat)throw new Error("filesystem paths do not work in the browser");return void function(o,d,t){!function o(e,t,n){St.stat(e,(r,d)=>r?n(r):void(d.isDirectory()?St.readdir(e,(r,d)=>r?n(r):void Oo(d.filter(g).filter(Mo.not).map(n=>r=>{o(pt.join(e,n),t,r)}),n)):d.isFile()&&t(e,n)))}(o,r,(e,n)=>e?t(e):void(n=Array.isArray(n)?f(n):[n],o=pt.normalize(o),d&&(o=o.slice(0,o.lastIndexOf(pt.sep)+1)),o[o.length-1]!==pt.sep&&(o+=pt.sep),n.forEach(e=>{e.getStream=function(t){return()=>St.createReadStream(t)}(e.path),e.path=e.path.replace(o,"").split(pt.sep)}),t(null,n)))}(a,1<m||d,e)}throw new Error("invalid input type")}t.getStream=function(r,o){return()=>{const e=new st.Transform;return e._transform=function(t,e,n){o.length+=t.length,this.push(t),n()},r.pipe(e),e}}(a,t),t.length=0}t.path=a.path,e(null,t)}),(n,e)=>n?i(n):void(e=f(e),i(null,e,d)))}if("undefined"!=typeof FileList&&s instanceof FileList&&(s=Array.from(s)),Array.isArray(s)||(s=[s]),0===s.length)throw new Error("invalid input type");s.forEach(t=>{if(null==t)throw new Error(`invalid input type: ${t}`)}),1!==(s=s.map(t=>n(t)&&"string"==typeof t.path&&"function"==typeof St.stat?t.path:t)).length||"string"==typeof s[0]||s[0].name||(s[0].name=c.name);let h=null;s.forEach((t,e)=>{if("string"==typeof t)return;let n=t.fullPath||t.name;n||(n=`Unknown File ${e+1}`,t.unknownName=!0),t.path=n.split("/"),t.path[0]||t.path.shift(),2>t.path.length?h=null:0===e&&1<s.length?h=t.path[0]:t.path[0]!==h&&(h=null)}),s=s.filter(n=>{if("string"==typeof n)return!0;const e=n.path[n.path.length-1];return g(e)&&Mo.not(e)}),h&&s.forEach(n=>{const e=(u.isBuffer(n)||o(n))&&!n.path;"string"==typeof n||e||n.path.shift()}),!c.name&&h&&(c.name=h),c.name||s.some(t=>"string"==typeof t?(c.name=pt.basename(t),!0):t.unknownName?void 0:(c.name=t.path[t.path.length-1],!0)),c.name||(c.name=`Unnamed Torrent ${Date.now()}`);const m=s.reduce((n,e)=>n+ +("string"==typeof e),0);let d=1===s.length;if(1===s.length&&"string"==typeof s[0]){if("function"!=typeof St.stat)throw new Error("filesystem paths do not work in the browser");Ct(s[0],(n,e)=>n?i(n):void(d=e,a()))}else p.nextTick(()=>{a()})}function r(o,e){e=Ot(e),St.stat(o,(t,n)=>{if(t)return e(t);const r={length:n.size,path:o};e(null,r)})}function g(t){return"."!==t[0]}function t(n,e){return n+e.length}function n(t){return"undefined"!=typeof Blob&&t instanceof Blob}function o(t){return"object"==typeof t&&null!=t&&"function"==typeof t.pipe}(Wo=function(n,a,c){"function"==typeof a&&([a,c]=[c,a]),l(n,a=a?Object.assign({},a):{},(n,e,r)=>n?c(n):void(a.singleFileTorrent=r,function(a,e,r){let n=e.announceList;n||("string"==typeof e.announce?n=[[e.announce]]:Array.isArray(e.announce)&&(n=e.announce.map(t=>[t]))),n||(n=[]),d.WEBTORRENT_ANNOUNCE&&("string"==typeof d.WEBTORRENT_ANNOUNCE?n.push([[d.WEBTORRENT_ANNOUNCE]]):Array.isArray(d.WEBTORRENT_ANNOUNCE)&&(n=n.concat(d.WEBTORRENT_ANNOUNCE.map(t=>[t])))),void 0===e.announce&&void 0===e.announceList&&(n=n.concat(Wo.announceList)),"string"==typeof e.urlList&&(e.urlList=[e.urlList]);const i={info:{name:e.name},"creation date":eo((+e.creationDate||Date.now())/1e3),encoding:"UTF-8"};0!==n.length&&(i.announce=n[0][0],i["announce-list"]=n),void 0!==e.comment&&(i.comment=e.comment),void 0!==e.createdBy&&(i["created by"]=e.createdBy),void 0!==e.private&&(i.info.private=+e.private),void 0!==e.sslCert&&(i.info["ssl-cert"]=e.sslCert),void 0!==e.urlList&&(i["url-list"]=e.urlList);const o=e.pieceLength||(l=a.reduce(t,0),Ro(l/dt,Ao));var l;i.info["piece length"]=o,function(n,e,t){function _(n){i+=n.length;const r=y;qo(n,t=>{m[r]=t,o-=1,g()}),o+=1,y+=1}function l(){w=!0,g()}function f(n){p(),t(n)}function p(){S.removeListener("error",f),k.removeListener("data",_),k.removeListener("end",l),k.removeListener("error",f)}function g(){w&&0==o&&(p(),t(null,u.from(m.join(""),"hex"),i))}t=Ot(t);const m=[];let i=0;const b=n.map(t=>t.getStream);let o=0,y=0,w=!1;const S=new Tt(b),k=new Io(e,{zeroPadding:!1});S.on("error",f),S.pipe(k).on("data",_).on("end",l).on("error",f)}(a,o,(o,t,n)=>o?r(o):void(i.info.pieces=t,a.forEach(t=>{delete t.getStream}),e.singleFileTorrent?i.info.length=n:i.info.files=a,r(null,te.encode(i))))}(e,a,c)))}).parseInput=function(r,e,o){"function"==typeof e&&([e,o]=[o,e]),l(r,e=e?Object.assign({},e):{},o)},Wo.announceList=[["udp://tracker.leechers-paradise.org:6969"],["udp://tracker.coppersurfer.tk:6969"],["udp://tracker.opentrackr.org:1337"],["udp://explodie.org:6969"],["udp://tracker.empire-js.us:1337"],["wss://tracker.btorrent.xyz"],["wss://tracker.openwebtorrent.com"],["wss://tracker.fastcast.nz"]]}).call(this,pe,"undefined"==typeof global?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:global,p({}).Buffer);var jo={};(function(n){jo.log=function(...t){return"object"==typeof console&&console.log&&console.log(...t)},jo.formatArgs=function(o){if(o[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+o[0]+(this.useColors?"%c ":" ")+"+"+jo.humanize(this.diff),!this.useColors)return;const e="color: "+this.color;o.splice(1,0,e,"color: inherit");let t=0,d=0;o[0].replace(/%[a-zA-Z%]/g,n=>{"%%"!==n&&(t++,"%c"===n&&(d=t))}),o.splice(d,0,e)},jo.save=function(t){try{t?jo.storage.setItem("debug",t):jo.storage.removeItem("debug")}catch(e){}},jo.load=function(){let e;try{e=jo.storage.getItem("debug")}catch(e){}return!e&&void 0!==n&&"env"in n&&(e=n.env.DEBUG),e},jo.useColors=function(){return"undefined"!=typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&31<=parseInt(RegExp.$1,10)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},jo.storage=function(){try{return localStorage}catch(t){}}(),jo.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],jo=function(o){function d(r){let e=0;for(let t=0;t<r.length;t++)e=(e<<5)-e+r.charCodeAt(t),e|=0;return l.colors[oo(e)%l.colors.length]}function l(r){function c(...d){if(!c.enabled)return;const e=c,t=+new Date,n=t-(o||t);e.diff=n,e.prev=o,e.curr=t,o=t,d[0]=l.coerce(d[0]),"string"!=typeof d[0]&&d.unshift("%O");let u=0;d[0]=d[0].replace(/%([a-zA-Z%])/g,(t,n)=>{if("%%"===t)return t;u++;const o=l.formatters[n];if("function"==typeof o){const r=d[u];t=o.call(e,r),d.splice(u,1),u--}return t}),l.formatArgs.call(e,d),(e.log||l.log).apply(e,d)}let o;return c.namespace=r,c.enabled=l.enabled(r),c.useColors=l.useColors(),c.color=d(r),c.destroy=t,c.extend=n,"function"==typeof l.init&&l.init(c),l.instances.push(c),c}function t(){const t=l.instances.indexOf(this);return-1!==t&&(l.instances.splice(t,1),!0)}function n(n,e){const t=l(this.namespace+(void 0===e?":":e)+n);return t.log=this.log,t}function r(t){return t.toString().substring(2,t.toString().length-2).replace(/\.\*\?$/,"*")}return l.debug=l,l.default=l,l.coerce=function(t){return t instanceof Error?t.stack||t.message:t},l.disable=function(){const t=[...l.names.map(r),...l.skips.map(r).map(t=>"-"+t)].join(",");return l.enable(""),t},l.enable=function(n){let o;l.save(n),l.names=[],l.skips=[];const d=("string"==typeof n?n:"").split(/[\s,]+/),r=d.length;for(o=0;o<r;o++)d[o]&&("-"===(n=d[o].replace(/\*/g,".*?"))[0]?l.skips.push(new RegExp("^"+n.substr(1)+"$")):l.names.push(new RegExp("^"+n+"$")));for(o=0;o<l.instances.length;o++){const t=l.instances[o];t.enabled=l.enabled(t.namespace)}},l.enabled=function(n){if("*"===n[n.length-1])return!0;let e,o;for(e=0,o=l.skips.length;e<o;e++)if(l.skips[e].test(n))return!1;for(e=0,o=l.names.length;e<o;e++)if(l.names[e].test(n))return!0;return!1},l.humanize=a({}),Object.keys(o).forEach(e=>{l[e]=o[e]}),l.instances=[],l.names=[],l.skips=[],l.formatters={},l.selectColor=d,l.enable(l.load()),l}(jo);const{formatters:e}=jo;e.j=function(t){try{return JSON.stringify(t)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}}).call(this,pe);var zo={};(function(o){zo=function(e,d){if("undefined"==typeof Blob||!(e instanceof Blob))throw new Error("first argument must be a Blob");if("function"!=typeof d)throw new Error("second argument must be a function");var n=new FileReader;n.addEventListener("loadend",function e(t){n.removeEventListener("loadend",e,!1),t.error?d(t.error):d(null,o.from(n.result))},!1),n.readAsArrayBuffer(e)}}).call(this,p({}).Buffer);var Vo={};(function(d){function a(){if(void 0!==r)return r;if(d.XMLHttpRequest){r=new d.XMLHttpRequest;try{r.open("GET",d.XDomainRequest?"/":"https://example.com")}catch(e){r=null}}else r=null;return r}function e(n){var e=a();if(!e)return!1;try{return e.responseType=n,e.responseType===n}catch(e){}return!1}function n(t){return"function"==typeof t}Vo.fetch=n(d.fetch)&&n(d.ReadableStream),Vo.writableStream=n(d.WritableStream),Vo.abortController=n(d.AbortController),Vo.blobConstructor=!1;try{new Blob([new ArrayBuffer(1)]),Vo.blobConstructor=!0}catch(e){}var r,o=void 0!==d.ArrayBuffer,i=o&&n(d.ArrayBuffer.prototype.slice);Vo.arraybuffer=Vo.fetch||o&&e("arraybuffer"),Vo.msstream=!Vo.fetch&&i&&e("ms-stream"),Vo.mozchunkedarraybuffer=!Vo.fetch&&o&&e("moz-chunked-arraybuffer"),Vo.overrideMimeType=Vo.fetch||!!a()&&n(a().overrideMimeType),Vo.vbArray=n(d.VBArray),r=null}).call(this,"undefined"==typeof global?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:global);var Xt={};(function(d){"use strict";Xt=void 0!==d&&d.version&&0!==d.version.indexOf("v0.")&&(0!==d.version.indexOf("v1.")||0===d.version.indexOf("v1.8."))?d:{nextTick:function(e,t,n,r){if("function"!=typeof e)throw new TypeError("\"callback\" argument must be a function");var i,l,c=arguments.length;switch(c){case 0:case 1:return d.nextTick(e);case 2:return d.nextTick(function(){e.call(null,t)});case 3:return d.nextTick(function(){e.call(null,t,n)});case 4:return d.nextTick(function(){e.call(null,t,n,r)});default:for(i=Array(c-1),l=0;l<i.length;)i[l++]=arguments[l];return d.nextTick(function(){e.apply(null,i)});}}}}).call(this,pe);var Go={}.toString,Qt=Array.isArray||function(t){return"[object Array]"==Go.call(t)},en=m.EventEmitter,tn={},Ko=p({}),rn=Ko.Buffer;rn.from&&rn.alloc&&rn.allocUnsafe&&rn.allocUnsafeSlow?tn=Ko:(Nt(Ko,tn),tn.Buffer=Gt),Nt(rn,Gt),Gt.from=function(r,e,t){if("number"==typeof r)throw new TypeError("Argument must not be a number");return rn(r,e,t)},Gt.alloc=function(o,e,t){if("number"!=typeof o)throw new TypeError("Argument must be a number");var n=rn(o);return void 0===e?n.fill(0):"string"==typeof t?n.fill(e,t):n.fill(e),n},Gt.allocUnsafe=function(t){if("number"!=typeof t)throw new TypeError("Argument must be a number");return rn(t)},Gt.allocUnsafeSlow=function(t){if("number"!=typeof t)throw new TypeError("Argument must be a number");return Ko.SlowBuffer(t)};var sn={};(function(n){function r(t){return Object.prototype.toString.call(t)}sn.isArray=function(t){return Array.isArray?Array.isArray(t):"[object Array]"===r(t)},sn.isBoolean=function(t){return"boolean"==typeof t},sn.isNull=function(t){return null===t},sn.isNullOrUndefined=function(t){return null==t},sn.isNumber=function(t){return"number"==typeof t},sn.isString=function(t){return"string"==typeof t},sn.isSymbol=function(t){return"symbol"==typeof t},sn.isUndefined=function(t){return void 0===t},sn.isRegExp=function(t){return"[object RegExp]"===r(t)},sn.isObject=function(t){return"object"==typeof t&&null!==t},sn.isDate=function(t){return"[object Date]"===r(t)},sn.isError=function(t){return"[object Error]"===r(t)||t instanceof Error},sn.isFunction=function(t){return"function"==typeof t},sn.isPrimitive=function(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||void 0===t},sn.isBuffer=n.isBuffer}).call(this,{isBuffer:function(t){return null!=t&&(on(t)||function(t){return"function"==typeof t.readFloatLE&&"function"==typeof t.slice&&on(t.slice(0,0))}(t)||!!t._isBuffer)}});var cn={},Yo=tn.Buffer;cn=function(){function n(){!function(e){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this),this.head=null,this.tail=null,this.length=0}return n.prototype.push=function(n){var e={data:n,next:null};0<this.length?this.tail.next=e:this.head=e,this.tail=e,++this.length},n.prototype.unshift=function(n){var e={data:n,next:this.head};0===this.length&&(this.tail=e),this.head=e,++this.length},n.prototype.shift=function(){if(0!==this.length){var t=this.head.data;return this.head=1===this.length?this.tail=null:this.head.next,--this.length,t}},n.prototype.clear=function(){this.head=this.tail=null,this.length=0},n.prototype.join=function(r){if(0===this.length)return"";for(var e=this.head,o=""+e.data;e=e.next;)o+=r+e.data;return o},n.prototype.concat=function(o){if(0===this.length)return Yo.alloc(0);if(1===this.length)return this.head.data;for(var e,d,a=Yo.allocUnsafe(o>>>0),r=this.head,l=0;r;)e=a,d=l,r.data.copy(e,d),l+=r.data.length,r=r.next;return a},n}(),oe.inspect&&oe.inspect.custom&&(cn.prototype[oe.inspect.custom]=function(){var t=oe.inspect({length:this.length});return this.constructor.name+" "+t});var dn={destroy:function(o,d){var t=this,e=this._readableState&&this._readableState.destroyed,n=this._writableState&&this._writableState.destroyed;return e||n?(d?d(o):!o||this._writableState&&this._writableState.errorEmitted||Xt.nextTick(an,this,o),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(o||null,function(n){!d&&n?(Xt.nextTick(an,t,n),t._writableState&&(t._writableState.errorEmitted=!0)):d&&d(n)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}},fn=hn,pn=fo({});sn.inherits=Me,sn.inherits(hn,pn),hn.prototype.push=function(n,e){return this._transformState.needTransform=!1,pn.prototype.push.call(this,n,e)},hn.prototype._transform=function(){throw new Error("_transform() is not implemented")},hn.prototype._write=function(o,e,t){var n=this._transformState;if(n.writecb=t,n.writechunk=o,n.writeencoding=e,!n.transforming){var r=this._readableState;(n.needTransform||r.needReadable||r.length<r.highWaterMark)&&this._read(r.highWaterMark)}},hn.prototype._read=function(){var e=this._transformState;null!==e.writechunk&&e.writecb&&!e.transforming?(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform)):e.needTransform=!0},hn.prototype._destroy=function(r,o){var t=this;pn.prototype._destroy.call(this,r,function(n){o(n),t.emit("close")})};sn.inherits=Me,sn.inherits(bn,fn),bn.prototype._transform=function(r,e,t){t(null,r)};var gn={};(gn=gn=t({})).Stream=gn,gn.Readable=gn,gn.Writable=r({}),gn.Duplex=fo({}),gn.Transform=fn,gn.PassThrough=bn;var $o={};(function(o,d,l){var t=$o.readyStates={UNSENT:0,OPENED:1,HEADERS_RECEIVED:2,LOADING:3,DONE:4},e=$o.IncomingMessage=function(e,t,n,i){var s=this;if(gn.Readable.call(s),s._mode=n,s.headers={},s.rawHeaders=[],s.trailers={},s.rawTrailers=[],s.on("end",function(){o.nextTick(function(){s.emit("close")})}),"fetch"===n){if(s._fetchResponse=t,s.url=t.url,s.statusCode=t.status,s.statusMessage=t.statusText,t.headers.forEach(function(n,e){s.headers[e.toLowerCase()]=n,s.rawHeaders.push(e,n)}),Vo.writableStream){var r=new WritableStream({write:function(n){return new Promise(function(e,t){s._destroyed?t():s.push(new l(n))?e():s._resumeFetch=e})},close:function(){d.clearTimeout(i),s._destroyed||s.push(null)},abort:function(t){s._destroyed||s.emit("error",t)}});try{return void t.body.pipeTo(r).catch(function(t){d.clearTimeout(i),s._destroyed||s.emit("error",t)})}catch(e){}}var a=t.body.getReader();!function t(){a.read().then(function(e){if(!s._destroyed){if(e.done)return d.clearTimeout(i),void s.push(null);s.push(new l(e.value)),t()}}).catch(function(t){d.clearTimeout(i),s._destroyed||s.emit("error",t)})}()}else if(s._xhr=e,s._pos=0,s.url=e.responseURL,s.statusCode=e.status,s.statusMessage=e.statusText,e.getAllResponseHeaders().split(/\r?\n/).forEach(function(r){var e=r.match(/^([^:]+):\s*(.*)/);if(e){var t=e[1].toLowerCase();"set-cookie"===t?(void 0===s.headers[t]&&(s.headers[t]=[]),s.headers[t].push(e[2])):void 0===s.headers[t]?s.headers[t]=e[2]:s.headers[t]+=", "+e[2],s.rawHeaders.push(e[1],e[2])}}),s._charset="x-user-defined",!Vo.overrideMimeType){var c=s.rawHeaders["mime-type"];if(c){var u=c.match(/;\s*charset=([^;])(;|$)/);u&&(s._charset=u[1].toLowerCase())}s._charset||(s._charset="utf-8")}};Me(e,gn.Readable),e.prototype._read=function(){var t=this._resumeFetch;t&&(this._resumeFetch=null,t())},e.prototype._onXHRProgress=function(){var n=this,e=n._xhr,r=null;switch(n._mode){case"text:vbarray":if(e.readyState!==t.DONE)break;try{r=new d.VBArray(e.responseBody).toArray()}catch(e){}if(null!==r){n.push(new l(r));break}case"text":try{r=e.responseText}catch(e){n._mode="text:vbarray";break}if(r.length>n._pos){var i=r.substr(n._pos);if("x-user-defined"===n._charset){for(var o=new l(i.length),a=0;a<i.length;a++)o[a]=255&i.charCodeAt(a);n.push(o)}else n.push(i,n._charset);n._pos=r.length}break;case"arraybuffer":if(e.readyState!==t.DONE||!e.response)break;r=e.response,n.push(new l(new Uint8Array(r)));break;case"moz-chunked-arraybuffer":if(r=e.response,e.readyState!==t.LOADING||!r)break;n.push(new l(new Uint8Array(r)));break;case"ms-stream":if(r=e.response,e.readyState!==t.LOADING)break;var u=new d.MSStreamReader;u.onprogress=function(){u.result.byteLength>n._pos&&(n.push(new l(new Uint8Array(u.result.slice(n._pos)))),n._pos=u.result.byteLength)},u.onload=function(){n.push(null)},u.readAsArrayBuffer(r);}n._xhr.readyState===t.DONE&&"ms-stream"!==n._mode&&n.push(null)}}).call(this,pe,"undefined"==typeof global?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:global,p({}).Buffer);var kn=p({}).Buffer,Sn=function(o){if(o instanceof Uint8Array){if(0===o.byteOffset&&o.byteLength===o.buffer.byteLength)return o.buffer;if("function"==typeof o.buffer.slice)return o.buffer.slice(o.byteOffset,o.byteOffset+o.byteLength)}if(kn.isBuffer(o)){for(var e=new Uint8Array(o.length),t=o.length,n=0;n<t;n++)e[n]=o[n];return e.buffer}throw new Error("Argument must be a Buffer")},Cn={};(function(d,l,f){var t=$o.IncomingMessage,e=$o.readyStates,n=Cn=function(n){var e,o=this;gn.Writable.call(o),o._opts=n,o._body=[],o._headers={},n.auth&&o.setHeader("Authorization","Basic "+new f(n.auth).toString("base64")),Object.keys(n.headers).forEach(function(e){o.setHeader(e,n.headers[e])});var r=!0;if("disable-fetch"===n.mode||"requestTimeout"in n&&!Vo.abortController)r=!1,e=!0;else if("prefer-streaming"===n.mode)e=!1;else if("allow-wrong-content-type"===n.mode)e=!Vo.overrideMimeType;else{if(n.mode&&"default"!==n.mode&&"prefer-fast"!==n.mode)throw new Error("Invalid value for opts.mode");e=!0}o._mode=function(n,e){return Vo.fetch&&e?"fetch":Vo.mozchunkedarraybuffer?"moz-chunked-arraybuffer":Vo.msstream?"ms-stream":Vo.arraybuffer&&n?"arraybuffer":Vo.vbArray&&n?"text:vbarray":"text"}(e,r),o._fetchTimer=null,o.on("finish",function(){o._onFinish()})};Me(n,gn.Writable),n.prototype.setHeader=function(o,e){var t=o.toLowerCase();-1===r.indexOf(t)&&(this._headers[t]={name:o,value:e})},n.prototype.getHeader=function(n){var e=this._headers[n.toLowerCase()];return e?e.value:null},n.prototype.removeHeader=function(t){delete this._headers[t.toLowerCase()]},n.prototype._onFinish=function(){var t=this;if(!t._destroyed){var n=t._opts,r=t._headers,o=null;"GET"!==n.method&&"HEAD"!==n.method&&(o=Vo.arraybuffer?Sn(f.concat(t._body)):Vo.blobConstructor?new l.Blob(t._body.map(function(t){return Sn(t)}),{type:(r["content-type"]||{}).value||""}):f.concat(t._body).toString());var i=[];if(Object.keys(r).forEach(function(o){var d=r[o].name,e=r[o].value;Array.isArray(e)?e.forEach(function(t){i.push([d,t])}):i.push([d,e])}),"fetch"===t._mode){var s=null;if(Vo.abortController){var p=new AbortController;s=p.signal,t._fetchAbortController=p,"requestTimeout"in n&&0!==n.requestTimeout&&(t._fetchTimer=l.setTimeout(function(){t.emit("requestTimeout"),t._fetchAbortController&&t._fetchAbortController.abort()},n.requestTimeout))}l.fetch(t._opts.url,{method:t._opts.method,headers:i,body:o||void 0,mode:"cors",credentials:n.withCredentials?"include":"same-origin",signal:s}).then(function(n){t._fetchResponse=n,t._connect()},function(n){l.clearTimeout(t._fetchTimer),t._destroyed||t.emit("error",n)})}else{var u=t._xhr=new l.XMLHttpRequest;try{u.open(t._opts.method,t._opts.url,!0)}catch(e){return void d.nextTick(function(){t.emit("error",e)})}"responseType"in u&&(u.responseType=t._mode.split(":")[0]),"withCredentials"in u&&(u.withCredentials=!!n.withCredentials),"text"===t._mode&&"overrideMimeType"in u&&u.overrideMimeType("text/plain; charset=x-user-defined"),"requestTimeout"in n&&(u.timeout=n.requestTimeout,u.ontimeout=function(){t.emit("requestTimeout")}),i.forEach(function(t){u.setRequestHeader(t[0],t[1])}),t._response=null,u.onreadystatechange=function(){switch(u.readyState){case e.LOADING:case e.DONE:t._onXHRProgress();}},"moz-chunked-arraybuffer"===t._mode&&(u.onprogress=function(){t._onXHRProgress()}),u.onerror=function(){t._destroyed||t.emit("error",new Error("XHR error"))};try{u.send(o)}catch(e){return void d.nextTick(function(){t.emit("error",e)})}}}},n.prototype._onXHRProgress=function(){(function(n){try{var e=n.status;return null!==e&&0!==e}catch(e){return!1}})(this._xhr)&&!this._destroyed&&(this._response||this._connect(),this._response._onXHRProgress())},n.prototype._connect=function(){var n=this;n._destroyed||(n._response=new t(n._xhr,n._fetchResponse,n._mode,n._fetchTimer),n._response.on("error",function(e){n.emit("error",e)}),n.emit("response",n._response))},n.prototype._write=function(r,e,t){this._body.push(r),t()},n.prototype.abort=n.prototype.destroy=function(){this._destroyed=!0,l.clearTimeout(this._fetchTimer),this._response&&(this._response._destroyed=!0),this._xhr?this._xhr.abort():this._fetchAbortController&&this._fetchAbortController.abort()},n.prototype.end=function(r,o,t){"function"==typeof r&&(t=r,r=void 0),gn.Writable.prototype.end.call(this,r,o,t)},n.prototype.flushHeaders=function(){},n.prototype.setTimeout=function(){},n.prototype.setNoDelay=function(){},n.prototype.setSocketKeepAlive=function(){};var r=["accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","cookie","cookie2","date","dnt","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","via"]}).call(this,pe,"undefined"==typeof global?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:global,p({}).Buffer);var Xo=Object.prototype.hasOwnProperty,Tn={100:"Continue",101:"Switching Protocols",102:"Processing",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",208:"Already Reported",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",307:"Temporary Redirect",308:"Permanent Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Payload Too Large",414:"URI Too Long",415:"Unsupported Media Type",416:"Range Not Satisfiable",417:"Expectation Failed",418:"I'm a teapot",421:"Misdirected Request",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",425:"Unordered Collection",426:"Upgrade Required",428:"Precondition Required",429:"Too Many Requests",431:"Request Header Fields Too Large",451:"Unavailable For Legal Reasons",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",508:"Loop Detected",509:"Bandwidth Limit Exceeded",510:"Not Extended",511:"Network Authentication Required"},An={exports:{}};(function(d){!function(e){function a(t){throw new RangeError(y[t])}function l(o,e){for(var t=o.length,d=[];t--;)d[t]=e(o[t]);return d}function c(o,d){var t=o.split("@"),n="";return 1<t.length&&(n=t[0]+"@",o=t[1]),n+l((o=o.replace(_,".")).split("."),d).join(".")}function u(o){for(var e,d,a=[],r=0,l=o.length;r<l;)55296<=(e=o.charCodeAt(r++))&&56319>=e&&r<l?56320==(64512&(d=o.charCodeAt(r++)))?a.push(((1023&e)<<10)+(1023&d)+65536):(a.push(e),r--):a.push(e);return a}function f(t){return l(t,function(n){var r="";return 65535<n&&(r+=v(55296|1023&(n-=65536)>>>10),n=56320|1023&n),r+v(n)}).join("")}function p(n,e){return n+22+75*(26>n)-((0!=e)<<5)}function h(o,d,t){var n=0;for(o=t?x(o/700):o>>1,o+=x(o/d);o>455;n+=36)o=x(o/35);return x(n+36*o/(o+38))}function g(c){var e,u,p,g,k,v,L,T,B,I,R,A=[],b=c.length,w=0,U=128,P=72;for(0>(u=c.lastIndexOf("-"))&&(u=0),p=0;p<u;++p)128<=c.charCodeAt(p)&&a("not-basic"),A.push(c.charCodeAt(p));for(g=0<u?u+1:0;g<b;){for(k=w,v=1,L=36;g>=b&&a("invalid-input"),((T=10>(R=c.charCodeAt(g++))-48?R-22:26>R-65?R-65:26>R-97?R-97:36)>=36||T>x((2147483647-w)/v))&&a("overflow"),w+=T*v,!(T<(B=L<=P?1:L>=P+26?26:L-P));L+=36)v>x(2147483647/(I=36-B))&&a("overflow"),v*=I;P=h(w-k,e=A.length+1,0==k),x(w/e)>2147483647-U&&a("overflow"),U+=x(w/e),w%=e,A.splice(w++,0,U)}return f(A)}function w(c){var f,g,k,E,L,B,I,R,A,U,P,M,O,N,H,D=[];for(M=(c=u(c)).length,f=128,g=0,L=72,B=0;B<M;++B)128>(P=c[B])&&D.push(v(P));for(k=E=D.length,E&&D.push("-");k<M;){for(I=2147483647,B=0;B<M;++B)(P=c[B])>=f&&P<I&&(I=P);for(I-f>x((2147483647-g)/(O=k+1))&&a("overflow"),g+=(I-f)*O,f=I,B=0;B<M;++B)if((P=c[B])<f&&++g>2147483647&&a("overflow"),P==f){for(R=g,A=36;!(R<(U=A<=L?1:A>=L+26?26:A-L));A+=36)H=R-U,N=36-U,D.push(v(p(U+H%N,0))),R=x(H/N);D.push(v(p(R,0))),L=h(g,O,k==E),g=0,++k}++g,++f}return D.join("")}var S="object"==typeof An.exports&&An.exports&&!An.exports.nodeType&&An.exports,n=An&&!An.nodeType&&An,r="object"==typeof d&&d;r.global!==r&&r.window!==r&&r.self!==r||(e=r);var i,k,C=/^xn--/,m=/[^\x20-\x7E]/,_=/[\x2E\u3002\uFF0E\uFF61]/g,y={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},x=io,v=ro;if(!(i={version:"1.4.1",ucs2:{decode:u,encode:f},decode:g,encode:w,toASCII:function(t){return c(t,function(t){return m.test(t)?"xn--"+w(t):t})},toUnicode:function(t){return c(t,function(t){return C.test(t)?g(t.slice(4).toLowerCase()):t})}},S&&n))e.punycode=i;else if(An.exports==S)n.exports=i;else for(k in i)i.hasOwnProperty(k)&&(S[k]=i[k])}(this)}).call(this,"undefined"==typeof global?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:global),An=An.exports;var Qo={isString:function(t){return"string"==typeof t},isObject:function(t){return"object"==typeof t&&null!==t},isNull:function(t){return null===t},isNullOrUndefined:function(t){return null==t}},Rn=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},Ln=function(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return"";}},Un=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},On=Object.keys||function(r){var e=[];for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&e.push(t);return e},Pn={parse:function(g,m,_,b){m=m||"&",_=_||"=";var r={};if("string"!=typeof g||0===g.length)return r;var i=/\+/g;g=g.split(m);var s=1e3;b&&"number"==typeof b.maxKeys&&(s=b.maxKeys);var y=g.length;0<s&&y>s&&(y=s);for(var w=0;w<y;++w){var S,k,E,v,C=g[w].replace(i,"%20"),f=C.indexOf(_);0<=f?(S=C.substr(0,f),k=C.substr(f+1)):(S=C,k=""),E=decodeURIComponent(S),v=decodeURIComponent(k),yn(r,E)?Rn(r[E])?r[E].push(v):r[E]=[r[E],v]:r[E]=v}return r},stringify:function(o,d,a,i){return d=d||"&",a=a||"=",null===o&&(o=void 0),"object"==typeof o?wn(On(o),function(e){var t=encodeURIComponent(Ln(e))+a;return Un(o[e])?wn(o[e],function(n){return t+encodeURIComponent(Ln(n))}).join(d):t+encodeURIComponent(Ln(o[e]))}).join(d):i?encodeURIComponent(Ln(i))+a+encodeURIComponent(Ln(o)):""}},Nn={};Nn.parse=Bn;var jn=/^([a-z0-9.+-]+:)/i,Hn=/:[0-9]*$/,qn=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,Fn=["{","}","|","\\","^","`"].concat(["<",">","\"","`"," ","\r","\n","\t"]),Wn=["'"].concat(Fn),zn=["%","/","?",";","#"].concat(Wn),$n=["/","?","#"],Vn=/^[+a-z0-9A-Z_-]{0,63}$/,Gn=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,Kn={javascript:!0,"javascript:":!0},Yn={javascript:!0,"javascript:":!0},Jn={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0};vn.prototype.parse=function(U,P,t){if(!Qo.isString(U))throw new TypeError("Parameter 'url' must be a string, not "+typeof U);var n=U.indexOf("?"),r=-1!==n&&n<U.indexOf("#")?"?":"#",i=U.split(r);i[0]=i[0].replace(/\\/g,"/");var s=U=i.join(r);if(s=s.trim(),!t&&1===U.split("#").length){var M=qn.exec(s);if(M)return this.path=s,this.href=s,this.pathname=M[1],M[2]?(this.search=M[2],this.query=P?Pn.parse(this.search.substr(1)):this.search.substr(1)):P&&(this.search="",this.query={}),this}var a=jn.exec(s);if(a){var O=(a=a[0]).toLowerCase();this.protocol=O,s=s.substr(a.length)}if(t||a||s.match(/^\/\/[^@\/]+@[^@\/]+/)){var c="//"===s.substr(0,2);!c||a&&Yn[a]||(s=s.substr(2),this.slashes=!0)}if(!Yn[a]&&(c||a&&!Jn[a])){for(var u,N,H=-1,D=0;D<$n.length;D++)-1!==(q=s.indexOf($n[D]))&&(-1===H||q<H)&&(H=q);for(-1!==(N=-1===H?s.lastIndexOf("@"):s.lastIndexOf("@",H))&&(u=s.slice(0,N),s=s.slice(N+1),this.auth=decodeURIComponent(u)),H=-1,D=0;D<zn.length;D++){var q;-1!==(q=s.indexOf(zn[D]))&&(-1===H||q<H)&&(H=q)}-1===H&&(H=s.length),this.host=s.slice(0,H),s=s.slice(H),this.parseHost(),this.hostname=this.hostname||"";var F="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!F)for(var m,W=this.hostname.split(/\./),_=(D=0,W.length);D<_;D++)if(m=W[D],m&&!m.match(Vn)){for(var j="",z=0,V=m.length;z<V;z++)j+=127<m.charCodeAt(z)?"x":m[z];if(!j.match(Vn)){var E=W.slice(0,D),k=W.slice(D+1),S=m.match(Gn);S&&(E.push(S[1]),k.unshift(S[2])),k.length&&(s="/"+k.join(".")+s),this.hostname=E.join(".");break}}this.hostname=255<this.hostname.length?"":this.hostname.toLowerCase(),F||(this.hostname=An.toASCII(this.hostname));var C=this.port?":"+this.port:"",G=this.hostname||"";this.host=G+C,this.href+=this.host,F&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==s[0]&&(s="/"+s))}if(!Kn[O])for(D=0,_=Wn.length;D<_;D++){var T=Wn[D];if(-1!==s.indexOf(T)){var A=encodeURIComponent(T);A===T&&(A=escape(T)),s=s.split(T).join(A)}}var K=s.indexOf("#");-1!==K&&(this.hash=s.substr(K),s=s.slice(0,K));var R=s.indexOf("?");if(-1===R?P&&(this.search="",this.query={}):(this.search=s.substr(R),this.query=s.substr(R+1),P&&(this.query=Pn.parse(this.query)),s=s.slice(0,R)),s&&(this.pathname=s),Jn[O]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){C=this.pathname||"";var B=this.search||"";this.path=C+B}return this.href=this.format(),this},vn.prototype.format=function(){var d=this.auth||"";d&&(d=(d=encodeURIComponent(d)).replace(/%3A/i,":"),d+="@");var a=this.protocol||"",l=this.pathname||"",c=this.hash||"",u=!1,f="";this.host?u=d+this.host:this.hostname&&(u=d+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(u+=":"+this.port)),this.query&&Qo.isObject(this.query)&&Object.keys(this.query).length&&(f=Pn.stringify(this.query));var p=this.search||f&&"?"+f||"";return a&&":"!==a.substr(-1)&&(a+=":"),this.slashes||(!a||Jn[a])&&!1!==u?(u="//"+(u||""),l&&"/"!==l.charAt(0)&&(l="/"+l)):u||(u=""),c&&"#"!==c.charAt(0)&&(c="#"+c),p&&"?"!==p.charAt(0)&&(p="?"+p),a+u+(l=l.replace(/[?#]/g,function(t){return encodeURIComponent(t)}))+(p=p.replace("#","%23"))+c},vn.prototype.resolve=function(t){return this.resolveObject(Bn(t,!1,!0)).format()},vn.prototype.resolveObject=function(L){if(Qo.isString(L)){var T=new vn;T.parse(L,!1,!0),L=T}for(var t,B=new vn,n=Object.keys(this),r=0;r<n.length;r++)t=n[r],B[t]=this[t];if(B.hash=L.hash,""===L.href)return B.href=B.format(),B;if(L.slashes&&!L.protocol){for(var I,R=Object.keys(L),o=0;o<R.length;o++)I=R[o],"protocol"!==I&&(B[I]=L[I]);return Jn[B.protocol]&&B.hostname&&!B.pathname&&(B.path=B.pathname="/"),B.href=B.format(),B}if(L.protocol&&L.protocol!==B.protocol){if(!Jn[L.protocol]){for(var A,U=Object.keys(L),c=0;c<U.length;c++)A=U[c],B[A]=L[A];return B.href=B.format(),B}if(B.protocol=L.protocol,L.host||Yn[L.protocol])B.pathname=L.pathname;else{for(var P=(L.pathname||"").split("/");P.length&&!(L.host=P.shift()););L.host||(L.host=""),L.hostname||(L.hostname=""),""!==P[0]&&P.unshift(""),2>P.length&&P.unshift(""),B.pathname=P.join("/")}if(B.search=L.search,B.query=L.query,B.host=L.host||"",B.auth=L.auth,B.hostname=L.hostname||L.host,B.port=L.port,B.pathname||B.search){var M=B.pathname||"",f=B.search||"";B.path=M+f}return B.slashes=B.slashes||L.slashes,B.href=B.format(),B}var p=B.pathname&&"/"===B.pathname.charAt(0),g=L.host||L.pathname&&"/"===L.pathname.charAt(0),m=g||p||B.host&&L.pathname,O=m,y=B.pathname&&B.pathname.split("/")||[],N=(P=L.pathname&&L.pathname.split("/")||[],B.protocol&&!Jn[B.protocol]);if(N&&(B.hostname="",B.port=null,B.host&&(""===y[0]?y[0]=B.host:y.unshift(B.host)),B.host="",L.protocol&&(L.hostname=null,L.port=null,L.host&&(""===P[0]?P[0]=L.host:P.unshift(L.host)),L.host=null),m=m&&(""===P[0]||""===y[0])),g)B.host=L.host||""===L.host?L.host:B.host,B.hostname=L.hostname||""===L.hostname?L.hostname:B.hostname,B.search=L.search,B.query=L.query,y=P;else if(P.length)y||(y=[]),y.pop(),y=y.concat(P),B.search=L.search,B.query=L.query;else if(!Qo.isNullOrUndefined(L.search))return N&&(B.hostname=B.host=y.shift(),(q=!!(B.host&&0<B.host.indexOf("@"))&&B.host.split("@"))&&(B.auth=q.shift(),B.host=B.hostname=q.shift())),B.search=L.search,B.query=L.query,Qo.isNull(B.pathname)&&Qo.isNull(B.search)||(B.path=(B.pathname?B.pathname:"")+(B.search?B.search:"")),B.href=B.format(),B;if(!y.length)return B.pathname=null,B.path=B.search?"/"+B.search:null,B.href=B.format(),B;for(var w=y.slice(-1)[0],H=(B.host||L.host||1<y.length)&&("."===w||".."===w)||""===w,E=0,D=y.length;0<=D;D--)"."===(w=y[D])?y.splice(D,1):".."===w?(y.splice(D,1),E++):E&&(y.splice(D,1),E--);if(!m&&!O)for(;E--;E)y.unshift("..");!m||""===y[0]||y[0]&&"/"===y[0].charAt(0)||y.unshift(""),H&&"/"!==y.join("/").substr(-1)&&y.push("");var q,F=""===y[0]||y[0]&&"/"===y[0].charAt(0);return N&&(B.hostname=B.host=F?"":y.length?y.shift():"",(q=!!(B.host&&0<B.host.indexOf("@"))&&B.host.split("@"))&&(B.auth=q.shift(),B.host=B.hostname=q.shift())),(m=m||B.host&&y.length)&&!F&&y.unshift(""),y.length?B.pathname=y.join("/"):(B.pathname=null,B.path=null),Qo.isNull(B.pathname)&&Qo.isNull(B.search)||(B.path=(B.pathname?B.pathname:"")+(B.search?B.search:"")),B.auth=L.auth||B.auth,B.slashes=B.slashes||L.slashes,B.href=B.format(),B},vn.prototype.parseHost=function(){var n=this.host,r=Hn.exec(n);r&&(":"!==(r=r[0])&&(this.port=r.substr(1)),n=n.substr(0,n.length-r.length)),n&&(this.hostname=n)};var Xn={};(function(d){var o=Xn;o.request=function(e,l){e="string"==typeof e?Nn.parse(e):function(){for(var o,d={},e=0;e<arguments.length;e++)for(var a in o=arguments[e],o)Xo.call(o,a)&&(d[a]=o[a]);return d}(e);var n=-1===d.location.protocol.search(/^https?:$/)?"http:":"",r=e.protocol||n,i=e.hostname||e.host,c=e.port,o=e.path||"/";i&&-1!==i.indexOf(":")&&(i="["+i+"]"),e.url=(i?r+"//"+i:"")+(c?":"+c:"")+o,e.method=(e.method||"GET").toUpperCase(),e.headers=e.headers||{};var a=new Cn(e);return l&&a.on("response",l),a},o.get=function(t,e){var n=o.request(t,e);return n.end(),n},o.ClientRequest=Cn,o.IncomingMessage=$o.IncomingMessage,o.Agent=function(){},o.Agent.defaultMaxSockets=4,o.globalAgent=new o.Agent,o.STATUS_CODES=Tn,o.METHODS=["CHECKOUT","CONNECT","COPY","DELETE","GET","HEAD","LOCK","M-SEARCH","MERGE","MKACTIVITY","MKCOL","MOVE","NOTIFY","OPTIONS","PATCH","POST","PROPFIND","PROPPATCH","PURGE","PUT","REPORT","SEARCH","SUBSCRIBE","TRACE","UNLOCK","UNSUBSCRIBE"]}).call(this,"undefined"==typeof global?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:global);var Qn={},er=Qn;for(var tr in Xn)Xn.hasOwnProperty(tr)&&(er[tr]=Xn[tr]);er.request=function(n,r){return n=Mn(n),Xn.request.call(this,n,r)},er.get=function(n,r){return n=Mn(n),Xn.get.call(this,n,r)};var nr={};(function(d){function o(l,t){if(l=Object.assign({maxRedirects:10},"string"==typeof l?{url:l}:l),t=Ot(t),l.url){const{hostname:r,port:e,protocol:t,auth:n,path:o}=Nn.parse(l.url);delete l.url,r||e||t||n?Object.assign(l,{hostname:r,port:e,protocol:t,auth:n,path:o}):l.path=o}const n={"accept-encoding":"gzip, deflate"};let s;l.headers&&Object.keys(l.headers).forEach(t=>n[t.toLowerCase()]=l.headers[t]),l.headers=n,l.body?s=l.json&&!e(l.body)?JSON.stringify(l.body):l.body:l.form&&(s="string"==typeof l.form?l.form:Pn.stringify(l.form),l.headers["content-type"]="application/x-www-form-urlencoded"),s&&(l.method||(l.method="POST"),e(s)||(l.headers["content-length"]=d.byteLength(s)),l.json&&!l.form&&(l.headers["content-type"]="application/json")),delete l.body,delete l.form,l.json&&(l.headers.accept="application/json"),l.method&&(l.method=l.method.toUpperCase());const c=("https:"===l.protocol?Qn:Xn).request(l,n=>{if(300<=n.statusCode&&400>n.statusCode&&n.headers.location)return l.url=n.headers.location,delete l.headers.host,n.resume(),"POST"===l.method&&[301,302].includes(n.statusCode)&&(l.method="GET",delete l.headers["content-length"],delete l.headers["content-type"]),0==l.maxRedirects--?t(new Error("too many redirects")):o(l,t);t(null,n)});return c.on("timeout",()=>{c.abort(),t(new Error("Request timed out"))}),c.on("error",t),e(s)?s.on("error",t).pipe(c):c.end(s),c}nr=o;const e=t=>null!==t&&"object"==typeof t&&"function"==typeof t.pipe;o.concat=(d,e)=>o(d,(t,o)=>t?e(t):void q(o,(t,r)=>{if(t)return e(t);if(d.json)try{r=JSON.parse(r.toString())}catch(t){return e(t,o,r)}e(null,o,r)})),["get","post","put","patch","head","delete"].forEach(n=>{o[n]=(e,t)=>("string"==typeof e&&(e={url:e}),o(Object.assign({method:n.toUpperCase()},e),t))})}).call(this,p({}).Buffer);var Jo={};(function(d){"use strict";var e=[255,255,26,27,28,29,30,31,255,255,255,255,255,255,255,255,255,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,255,255,255,255,255,255,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,255,255,255,255,255];Jo.decode=function(t){var l,u=0,f=0,p=0;d.isBuffer(t)||(t=new d(t));for(var g,m=new d(eo(5*t.length/8)),a=0;a<t.length&&61!==t[a];a++){if(g=t[a]-48,!(g<e.length))throw new Error("Invalid input - it is not base32 encoded string");f=e[g],3>=u?0==(u=(u+5)%8)?(l|=f,m[p]=l,p++,l=0):l|=255&f<<8-u:(l|=255&f>>>(u=(u+5)%8),m[p]=l,p++,l=255&f<<8-u)}return m.slice(0,p)}}).call(this,p({}).Buffer);var sr={};Jo.encode,sr.decode=Jo.decode;var or=function(r,e,t){return 0===r.length?r:e?(t||r.sort(e),function(d,e){for(var t=1,a=d.length,r=d[0],l=d[0],c=1;c<a;++c)if(l=r,e(r=d[c],l)){if(c==t){t++;continue}d[t++]=r}return d.length=t,d}(r,e)):(t||r.sort(),function(o){for(var e=1,d=o.length,n=o[0],a=o[0],l=1;l<d;++l,a=n)if(a=n,(n=o[l])!==a){if(l==e){e++;continue}o[e++]=n}return o.length=e,o}(r))},ar={};(function(o){function e(e){const d={},t=e.split("magnet:?")[1];let n;return(t&&0<=t.length?t.split("&"):[]).forEach(n=>{const e=n.split("=");if(2!==e.length)return;const t=e[0];let r=e[1];if(!("dn"===t&&(r=decodeURIComponent(r).replace(/\+/g," ")),"tr"!==t&&"xs"!==t&&"as"!==t&&"ws"!==t||(r=decodeURIComponent(r)),"kt"===t&&(r=decodeURIComponent(r).split("+")),"ix"===t&&(r=+r),d[t]))d[t]=r;else if(Array.isArray(d[t]))d[t].push(r);else{const n=d[t];d[t]=[n,r]}}),d.xt&&(Array.isArray(d.xt)?d.xt:[d.xt]).forEach(e=>{if(n=e.match(/^urn:btih:(.{40})/))d.infoHash=n[1].toLowerCase();else if(n=e.match(/^urn:btih:(.{32})/)){const e=sr.decode(n[1]);d.infoHash=o.from(e,"binary").toString("hex")}}),d.infoHash&&(d.infoHashBuffer=o.from(d.infoHash,"hex")),d.dn&&(d.name=d.dn),d.kt&&(d.keywords=d.kt),d.announce="string"==typeof d.tr?[d.tr]:Array.isArray(d.tr)?d.tr:[],d.urlList=[],("string"==typeof d.as||Array.isArray(d.as))&&(d.urlList=d.urlList.concat(d.as)),("string"==typeof d.ws||Array.isArray(d.ws))&&(d.urlList=d.urlList.concat(d.ws)),or(d.announce),or(d.urlList),d}(ar=e).decode=e,ar.encode=function(o){(o=Object.assign({},o)).infoHashBuffer&&(o.xt=`urn:btih:${o.infoHashBuffer.toString("hex")}`),o.infoHash&&(o.xt=`urn:btih:${o.infoHash}`),o.name&&(o.dn=o.name),o.keywords&&(o.kt=o.keywords),o.announce&&(o.tr=o.announce),o.urlList&&(o.ws=o.urlList,delete o.as);let d="magnet:?";return Object.keys(o).filter(t=>2===t.length).forEach((t,n)=>{(Array.isArray(o[t])?o[t]:[o[t]]).forEach((r,o)=>{(0<n||0<o)&&("kt"!==t||0===o)&&(d+="&"),"dn"===t&&(r=encodeURIComponent(r).replace(/%20/g,"+")),"tr"!==t&&"xs"!==t&&"as"!==t&&"ws"!==t||(r=encodeURIComponent(r)),"kt"===t&&(r=encodeURIComponent(r)),d+="kt"===t&&0<o?`+${r}`:`${t}=${r}`})}),d}}).call(this,p({}).Buffer);var Zo={};(function(o,d){function a(n){if("string"==typeof n&&/^(stream-)?magnet:/.test(n))return ar(n);if("string"==typeof n&&(/^[a-f0-9]{40}$/i.test(n)||/^[a-z2-7]{32}$/i.test(n)))return ar(`magnet:?xt=urn:btih:${n}`);if(d.isBuffer(n)&&20===n.length)return ar(`magnet:?xt=urn:btih:${n.toString("hex")}`);if(d.isBuffer(n))return function(r){d.isBuffer(r)&&(r=te.decode(r)),t(r.info,"info"),t(r.info["name.utf-8"]||r.info.name,"info.name"),t(r.info["piece length"],"info['piece length']"),t(r.info.pieces,"info.pieces"),r.info.files?r.info.files.forEach(n=>{t("number"==typeof n.length,"info.files[0].length"),t(n["path.utf-8"]||n.path,"info.files[0].path")}):t("number"==typeof r.info.length,"info.length");const a={info:r.info,infoBuffer:te.encode(r.info),name:(r.info["name.utf-8"]||r.info.name).toString(),announce:[]};a.infoHash=qo.sync(a.infoBuffer),a.infoHashBuffer=d.from(a.infoHash,"hex"),void 0!==r.info.private&&(a.private=!!r.info.private),r["creation date"]&&(a.created=new Date(1e3*r["creation date"])),r["created by"]&&(a.createdBy=r["created by"].toString()),d.isBuffer(r.comment)&&(a.comment=r.comment.toString()),Array.isArray(r["announce-list"])&&0<r["announce-list"].length?r["announce-list"].forEach(t=>{t.forEach(t=>{a.announce.push(t.toString())})}):r.announce&&a.announce.push(r.announce.toString()),d.isBuffer(r["url-list"])&&(r["url-list"]=0<r["url-list"].length?[r["url-list"]]:[]),a.urlList=(r["url-list"]||[]).map(t=>t.toString()),or(a.announce),or(a.urlList);const n=r.info.files||[r.info];a.files=n.map((r,e)=>{const t=[].concat(a.name,r["path.utf-8"]||r.path||[]).map(t=>t.toString());return{path:pt.join.apply(null,[pt.sep].concat(t)).slice(1),name:t[t.length-1],length:r.length,offset:n.slice(0,e).reduce(l,0)}}),a.length=n.reduce(l,0);const i=a.files[a.files.length-1];return a.pieceLength=r.info["piece length"],a.lastPieceLength=(i.offset+i.length)%a.pieceLength||a.pieceLength,a.pieces=function(r){const e=[];for(let t=0;t<r.length;t+=20)e.push(r.slice(t,t+20).toString("hex"));return e}(r.info.pieces),a}(n);if(n&&n.infoHash)return n.infoHash=n.infoHash.toLowerCase(),n.announce||(n.announce=[]),"string"==typeof n.announce&&(n.announce=[n.announce]),n.urlList||(n.urlList=[]),n;throw new Error("Invalid torrent identifier")}function l(n,e){return n+e.length}function t(n,e){if(!n)throw new Error(`Torrent is missing required field: ${e}`)}(Zo=a).remote=function(e,d){function r(n){try{t=a(n)}catch(e){return d(e)}t&&t.infoHash?d(null,t):d(new Error("Invalid torrent identifier"))}let t;if("function"!=typeof d)throw new Error("second argument must be a Function");try{t=a(e)}catch(e){}t&&t.infoHash?o.nextTick(()=>{d(null,t)}):"undefined"!=typeof Blob&&e instanceof Blob?zo(e,(n,e)=>n?d(new Error(`Error converting Blob: ${n.message}`)):void r(e)):"function"==typeof nr&&/^https?:/.test(e)?nr.concat({url:e,timeout:3e4,headers:{"user-agent":"WebTorrent (https://webtorrent.io)"}},(o,e,t)=>o?d(new Error(`Error downloading torrent: ${o.message}`)):void r(t)):"function"==typeof St.readFile&&"string"==typeof e?St.readFile(e,(n,e)=>n?d(new Error("Invalid torrent identifier")):void r(e)):o.nextTick(()=>{d(new Error("Invalid torrent identifier"))})},Zo.toMagnetURI=ar.encode,Zo.toTorrentFile=function(t){const r={info:t.info};return r["announce-list"]=(t.announce||[]).map(t=>(r.announce||(r.announce=t),[t=d.from(t,"utf8")])),r["url-list"]=t.urlList||[],void 0!==t.private&&(r.private=+t.private),t.created&&(r["creation date"]=0|t.created.getTime()/1e3),t.createdBy&&(r["created by"]=t.createdBy),t.comment&&(r.comment=t.comment),te.encode(r)},d.alloc(0)}).call(this,pe,p({}).Buffer);var ed=function(){if("undefined"==typeof window)return null;var t={RTCPeerConnection:window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection,RTCSessionDescription:window.RTCSessionDescription||window.mozRTCSessionDescription||window.webkitRTCSessionDescription,RTCIceCandidate:window.RTCIceCandidate||window.mozRTCIceCandidate||window.webkitRTCIceCandidate};return t.RTCPeerConnection?t:null},ur={};(function(d,e){"use strict";var a=j.Buffer,n=e.crypto||e.msCrypto;ur=n&&n.getRandomValues?function(e,t){if(4294967295<e)throw new RangeError("requested too many random bytes");var r=a.allocUnsafe(e);if(0<e)if(65536<e)for(var i=0;i<e;i+=65536)n.getRandomValues(r.slice(i,i+65536));else n.getRandomValues(r);return"function"==typeof t?d.nextTick(function(){t(null,r)}):r}:function(){throw new Error("Secure random number generation is not supported by this browser.\nUse Chrome, Firefox or Internet Explorer 11")}}).call(this,pe,"undefined"==typeof global?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:global);var td={};(function(o){function n(r){var o=this;if(!(o instanceof n))return new n(r);if(o._id=ur(4).toString("hex").slice(0,7),o._debug("new peer %o",r),r=Object.assign({allowHalfOpen:!1},r),st.Duplex.call(o,r),o.channelName=r.initiator?r.channelName||ur(20).toString("hex"):null,o.initiator=r.initiator||!1,o.channelConfig=r.channelConfig||n.channelConfig,o.config=Object.assign({},n.config,r.config),o.offerOptions=r.offerOptions||{},o.answerOptions=r.answerOptions||{},o.sdpTransform=r.sdpTransform||function(t){return t},o.streams=r.streams||(r.stream?[r.stream]:[]),o.trickle=void 0===r.trickle||r.trickle,o.allowHalfTrickle=void 0!==r.allowHalfTrickle&&r.allowHalfTrickle,o.iceCompleteTimeout=r.iceCompleteTimeout||5000,o.destroyed=!1,o._connected=!1,o.remoteAddress=void 0,o.remoteFamily=void 0,o.remotePort=void 0,o.localAddress=void 0,o.localFamily=void 0,o.localPort=void 0,o._wrtc=r.wrtc&&"object"==typeof r.wrtc?r.wrtc:ed(),!o._wrtc)throw"undefined"==typeof window?d("No WebRTC support: Specify `opts.wrtc` option in this environment","ERR_WEBRTC_SUPPORT"):d("No WebRTC support: Not a supported browser","ERR_WEBRTC_SUPPORT");o._pcReady=!1,o._channelReady=!1,o._iceComplete=!1,o._iceCompleteTimer=null,o._channel=null,o._pendingCandidates=[],o._isNegotiating=!o.initiator,o._batchedNegotiation=!1,o._queuedNegotiation=!1,o._sendersAwaitingStable=[],o._senderMap=new Map,o._firstStable=!0,o._closingInterval=null,o._remoteTracks=[],o._remoteStreams=[],o._chunk=null,o._cb=null,o._interval=null;try{o._pc=new o._wrtc.RTCPeerConnection(o.config)}catch(e){return void setTimeout(()=>o.destroy(e),0)}o._isReactNativeWebrtc="number"==typeof o._pc._peerConnectionId,o._pc.oniceconnectionstatechange=function(){o._onIceStateChange()},o._pc.onicegatheringstatechange=function(){o._onIceStateChange()},o._pc.onsignalingstatechange=function(){o._onSignalingStateChange()},o._pc.onicecandidate=function(t){o._onIceCandidate(t)},o.initiator?o._setupData({channel:o._pc.createDataChannel(o.channelName,o.channelConfig)}):o._pc.ondatachannel=function(t){o._setupData(t)},o.streams&&o.streams.forEach(function(t){o.addStream(t)}),o._pc.ontrack=function(t){o._onTrack(t)},o.initiator&&o._needsNegotiation(),o._onFinishBound=function(){o._onFinish()},o.once("finish",o._onFinishBound)}function r(t){return t.replace(/a=ice-options:trickle\s\n/g,"")}function d(r,e){var t=new Error(r);return t.code=e,t}td=n;var a=jo("simple-peer");Me(n,st.Duplex),n.WEBRTC_SUPPORT=!!ed(),n.config={iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:"stun:global.stun.twilio.com:3478?transport=udp"}],sdpSemantics:"unified-plan"},n.channelConfig={},Object.defineProperty(n.prototype,"bufferSize",{get:function(){return this._channel&&this._channel.bufferedAmount||0}}),Object.defineProperty(n.prototype,"connected",{get:function(){return this._connected&&"open"===this._channel.readyState}}),n.prototype.address=function(){return{port:this.localPort,family:this.localFamily,address:this.localAddress}},n.prototype.signal=function(n){var r=this;if(r.destroyed)throw d("cannot signal after peer is destroyed","ERR_SIGNALING");if("string"==typeof n)try{n=JSON.parse(n)}catch(e){n={}}r._debug("signal()"),n.renegotiate&&r.initiator&&(r._debug("got request to renegotiate"),r._needsNegotiation()),n.transceiverRequest&&r.initiator&&(r._debug("got request for transceiver"),r.addTransceiver(n.transceiverRequest.kind,n.transceiverRequest.init)),n.candidate&&(r._pc.localDescription&&r._pc.localDescription.type&&r._pc.remoteDescription&&r._pc.remoteDescription.type?r._addIceCandidate(n.candidate):r._pendingCandidates.push(n.candidate)),n.sdp&&r._pc.setRemoteDescription(new r._wrtc.RTCSessionDescription(n)).then(function(){r.destroyed||(r._pendingCandidates.forEach(function(t){r._addIceCandidate(t)}),r._pendingCandidates=[],"offer"===r._pc.remoteDescription.type&&r._createAnswer())}).catch(function(t){r.destroy(d(t,"ERR_SET_REMOTE_DESCRIPTION"))}),n.sdp||n.candidate||n.renegotiate||n.transceiverRequest||r.destroy(d("signal() called with invalid signal data","ERR_SIGNALING"))},n.prototype._addIceCandidate=function(r){var o=this,t=new o._wrtc.RTCIceCandidate(r);o._pc.addIceCandidate(t).catch(function(n){!t.address||t.address.endsWith(".local")?("Ignoring unsupported ICE candidate.",console.warn("Ignoring unsupported ICE candidate.")):o.destroy(d(n,"ERR_ADD_ICE_CANDIDATE"))})},n.prototype.send=function(t){this._channel.send(t)},n.prototype.addTransceiver=function(n,e){if(this._debug("addTransceiver()"),this.initiator)try{this._pc.addTransceiver(n,e),this._needsNegotiation()}catch(e){this.destroy(e)}else this.emit("signal",{transceiverRequest:{kind:n,init:e}})},n.prototype.addStream=function(r){var e=this;e._debug("addStream()"),r.getTracks().forEach(function(t){e.addTrack(t,r)})},n.prototype.addTrack=function(o,e){this._debug("addTrack()");var t=this._senderMap.get(o)||new Map,n=t.get(e);n?n.removed?this.destroy(d("Track has been removed. You should enable/disable tracks that you want to re-add.","ERR_SENDER_REMOVED")):this.destroy(d("Track has already been added to that stream.","ERR_SENDER_ALREADY_ADDED")):(n=this._pc.addTrack(o,e),t.set(e,n),this._senderMap.set(o,t),this._needsNegotiation())},n.prototype.replaceTrack=function(o,e,t){this._debug("replaceTrack()");var n=this._senderMap.get(o),r=n?n.get(t):null;r||this.destroy(d("Cannot replace track that was never added.","ERR_TRACK_NOT_ADDED")),e&&this._senderMap.set(e,n),null==r.replaceTrack?this.destroy(d("replaceTrack is not supported in this browser","ERR_UNSUPPORTED_REPLACETRACK")):r.replaceTrack(e)},n.prototype.removeTrack=function(o,e){this._debug("removeSender()");var t=this._senderMap.get(o),n=t?t.get(e):null;n||this.destroy(d("Cannot remove track that was never added.","ERR_TRACK_NOT_ADDED"));try{n.removed=!0,this._pc.removeTrack(n)}catch(e){"NS_ERROR_UNEXPECTED"===e.name?this._sendersAwaitingStable.push(n):this.destroy(e)}this._needsNegotiation()},n.prototype.removeStream=function(r){var e=this;e._debug("removeSenders()"),r.getTracks().forEach(function(t){e.removeTrack(t,r)})},n.prototype._needsNegotiation=function(){var t=this;t._debug("_needsNegotiation"),t._batchedNegotiation||(t._batchedNegotiation=!0,setTimeout(function(){t._batchedNegotiation=!1,t._debug("starting batched negotiation"),t.negotiate()},0))},n.prototype.negotiate=function(){var t=this;t.initiator?t._isNegotiating?(t._queuedNegotiation=!0,t._debug("already negotiating, queueing")):(t._debug("start negotiation"),setTimeout(()=>{t._createOffer()},0)):t._isNegotiating||(t._debug("requesting negotiation from initiator"),t.emit("signal",{renegotiate:!0})),t._isNegotiating=!0},n.prototype.destroy=function(t){this._destroy(t,function(){})},n.prototype._destroy=function(n,e){if(!this.destroyed){if(this._debug("destroy (error: %s)",n&&(n.message||n)),this.readable=this.writable=!1,this._readableState.ended||this.push(null),this._writableState.finished||this.end(),this.destroyed=!0,this._connected=!1,this._pcReady=!1,this._channelReady=!1,this._remoteTracks=null,this._remoteStreams=null,this._senderMap=null,clearInterval(this._closingInterval),this._closingInterval=null,clearInterval(this._interval),this._interval=null,this._chunk=null,this._cb=null,this._onFinishBound&&this.removeListener("finish",this._onFinishBound),this._onFinishBound=null,this._channel){try{this._channel.close()}catch(t){}this._channel.onmessage=null,this._channel.onopen=null,this._channel.onclose=null,this._channel.onerror=null}if(this._pc){try{this._pc.close()}catch(t){}this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.onsignalingstatechange=null,this._pc.onicecandidate=null,this._pc.ontrack=null,this._pc.ondatachannel=null}this._pc=null,this._channel=null,n&&this.emit("error",n),this.emit("close"),e()}},n.prototype._setupData=function(r){var o=this;if(!r.channel)return o.destroy(d("Data channel event is missing `channel` property","ERR_DATA_CHANNEL"));o._channel=r.channel,o._channel.binaryType="arraybuffer","number"==typeof o._channel.bufferedAmountLowThreshold&&(o._channel.bufferedAmountLowThreshold=65536),o.channelName=o._channel.label,o._channel.onmessage=function(t){o._onChannelMessage(t)},o._channel.onbufferedamountlow=function(){o._onChannelBufferedAmountLow()},o._channel.onopen=function(){o._onChannelOpen()},o._channel.onclose=function(){o._onChannelClose()},o._channel.onerror=function(t){o.destroy(d(t,"ERR_DATA_CHANNEL"))};var e=!1;o._closingInterval=setInterval(function(){o._channel&&"closing"===o._channel.readyState?(e&&o._onChannelClose(),e=!0):e=!1},5e3)},n.prototype._read=function(){},n.prototype._write=function(r,e,t){if(this.destroyed)return t(d("cannot write after peer is destroyed","ERR_DATA_CHANNEL"));if(this._connected){try{this.send(r)}catch(e){return this.destroy(d(e,"ERR_DATA_CHANNEL"))}65536<this._channel.bufferedAmount?(this._debug("start backpressure: bufferedAmount %d",this._channel.bufferedAmount),this._cb=t):t(null)}else this._debug("write before connect"),this._chunk=r,this._cb=t},n.prototype._onFinish=function(){function n(){setTimeout(function(){t.destroy()},1e3)}var t=this;t.destroyed||(t._connected?n():t.once("connect",n))},n.prototype._startIceCompleteTimeout=function(){var t=this;t.destroyed||t._iceCompleteTimer||(t._debug("started iceComplete timeout"),t._iceCompleteTimer=setTimeout(function(){t._iceComplete||(t._iceComplete=!0,t._debug("iceComplete timeout completed"),t.emit("iceTimeout"),t.emit("_iceComplete"))},t.iceCompleteTimeout))},n.prototype._createOffer=function(){var o=this;o.destroyed||o._pc.createOffer(o.offerOptions).then(function(e){function t(){if(!o.destroyed){var t=o._pc.localDescription||e;o._debug("signal"),o.emit("signal",{type:t.type,sdp:t.sdp})}}o.destroyed||(o.trickle||o.allowHalfTrickle||(e.sdp=r(e.sdp)),e.sdp=o.sdpTransform(e.sdp),o._pc.setLocalDescription(e).then(function(){o._debug("createOffer success"),o.destroyed||(o.trickle||o._iceComplete?t():o.once("_iceComplete",t))}).catch(function(e){o.destroy(d(e,"ERR_SET_LOCAL_DESCRIPTION"))}))}).catch(function(e){o.destroy(d(e,"ERR_CREATE_OFFER"))})},n.prototype._requestMissingTransceivers=function(){var n=this;n._pc.getTransceivers&&n._pc.getTransceivers().forEach(e=>{e.mid||!e.sender.track||e.requested||(e.requested=!0,n.addTransceiver(e.sender.track.kind))})},n.prototype._createAnswer=function(){var o=this;o.destroyed||o._pc.createAnswer(o.answerOptions).then(function(e){function t(){if(!o.destroyed){var t=o._pc.localDescription||e;o._debug("signal"),o.emit("signal",{type:t.type,sdp:t.sdp}),o.initiator||o._requestMissingTransceivers()}}o.destroyed||(o.trickle||o.allowHalfTrickle||(e.sdp=r(e.sdp)),e.sdp=o.sdpTransform(e.sdp),o._pc.setLocalDescription(e).then(function(){o.destroyed||(o.trickle||o._iceComplete?t():o.once("_iceComplete",t))}).catch(function(e){o.destroy(d(e,"ERR_SET_LOCAL_DESCRIPTION"))}))}).catch(function(e){o.destroy(d(e,"ERR_CREATE_ANSWER"))})},n.prototype._onIceStateChange=function(){if(!this.destroyed){var n=this._pc.iceConnectionState,e=this._pc.iceGatheringState;this._debug("iceStateChange (connection: %s) (gathering: %s)",n,e),this.emit("iceStateChange",n,e),"connected"!==n&&"completed"!==n||(this._pcReady=!0,this._maybeReady()),"failed"===n&&this.destroy(d("Ice connection failed.","ERR_ICE_CONNECTION_FAILURE")),"closed"===n&&this.destroy(d("Ice connection closed.","ERR_ICE_CONNECTION_CLOSED"))}},n.prototype.getStats=function(o){function d(n){return"[object Array]"===Object.prototype.toString.call(n.values)&&n.values.forEach(function(e){Object.assign(n,e)}),n}var e=this;0===e._pc.getStats.length?e._pc.getStats().then(function(e){var t=[];e.forEach(function(n){t.push(d(n))}),o(null,t)},function(e){o(e)}):e._isReactNativeWebrtc?e._pc.getStats(null,function(e){var t=[];e.forEach(function(n){t.push(d(n))}),o(null,t)},function(e){o(e)}):0<e._pc.getStats.length?e._pc.getStats(function(t){if(!e.destroyed){var n=[];t.result().forEach(function(r){var e={};r.names().forEach(function(t){e[t]=r.stat(t)}),e.id=r.id,e.type=r.type,e.timestamp=r.timestamp,n.push(d(e))}),o(null,n)}},function(e){o(e)}):o(null,[])},n.prototype._maybeReady=function(){var s=this;s._debug("maybeReady pc %s channel %s",s._pcReady,s._channelReady),!s._connected&&!s._connecting&&s._pcReady&&s._channelReady&&(s._connecting=!0,function e(){s.destroyed||s.getStats(function(t,n){function l(e){a=!0;var t=i[e.localCandidateId];t&&(t.ip||t.address)?(s.localAddress=t.ip||t.address,s.localPort=+t.port):t&&t.ipAddress?(s.localAddress=t.ipAddress,s.localPort=+t.portNumber):"string"==typeof e.googLocalAddress&&(t=e.googLocalAddress.split(":"),s.localAddress=t[0],s.localPort=+t[1]),s.localAddress&&(s.localFamily=s.localAddress.includes(":")?"IPv6":"IPv4");var o=u[e.remoteCandidateId];o&&(o.ip||o.address)?(s.remoteAddress=o.ip||o.address,s.remotePort=+o.port):o&&o.ipAddress?(s.remoteAddress=o.ipAddress,s.remotePort=+o.portNumber):"string"==typeof e.googRemoteAddress&&(o=e.googRemoteAddress.split(":"),s.remoteAddress=o[0],s.remotePort=+o[1]),s.remoteAddress&&(s.remoteFamily=s.remoteAddress.includes(":")?"IPv6":"IPv4"),s._debug("connect local: %s:%s remote: %s:%s",s.localAddress,s.localPort,s.remoteAddress,s.remotePort)}if(!s.destroyed){t&&(n=[]);var u={},i={},o={},a=!1;if(n.forEach(function(t){"remotecandidate"!==t.type&&"remote-candidate"!==t.type||(u[t.id]=t),"localcandidate"!==t.type&&"local-candidate"!==t.type||(i[t.id]=t),"candidatepair"!==t.type&&"candidate-pair"!==t.type||(o[t.id]=t)}),n.forEach(function(t){"transport"===t.type&&t.selectedCandidatePairId&&l(o[t.selectedCandidatePairId]),("googCandidatePair"===t.type&&"true"===t.googActiveConnection||("candidatepair"===t.type||"candidate-pair"===t.type)&&t.selected)&&l(t)}),a||Object.keys(o).length&&!Object.keys(i).length){if(s._connecting=!1,s._connected=!0,s._chunk){try{s.send(s._chunk)}catch(e){return s.destroy(d(e,"ERR_DATA_CHANNEL"))}s._chunk=null,s._debug("sent chunk from \"write before connect\"");var f=s._cb;s._cb=null,f(null)}"number"!=typeof s._channel.bufferedAmountLowThreshold&&(s._interval=setInterval(function(){s._onInterval()},150),s._interval.unref&&s._interval.unref()),s._debug("connect"),s.emit("connect")}else setTimeout(e,100)}})}())},n.prototype._onInterval=function(){this._cb&&this._channel&&!(65536<this._channel.bufferedAmount)&&this._onChannelBufferedAmountLow()},n.prototype._onSignalingStateChange=function(){var n=this;n.destroyed||("stable"!==n._pc.signalingState||n._firstStable||(n._isNegotiating=!1,n._debug("flushing sender queue",n._sendersAwaitingStable),n._sendersAwaitingStable.forEach(function(e){n._pc.removeTrack(e),n._queuedNegotiation=!0}),n._sendersAwaitingStable=[],n._queuedNegotiation&&(n._debug("flushing negotiation queue"),n._queuedNegotiation=!1,n._needsNegotiation()),n._debug("negotiate"),n.emit("negotiate")),n._firstStable=!1,n._debug("signalingStateChange %s",n._pc.signalingState),n.emit("signalingStateChange",n._pc.signalingState))},n.prototype._onIceCandidate=function(t){this.destroyed||(t.candidate&&this.trickle?this.emit("signal",{candidate:{candidate:t.candidate.candidate,sdpMLineIndex:t.candidate.sdpMLineIndex,sdpMid:t.candidate.sdpMid}}):t.candidate||this._iceComplete||(this._iceComplete=!0,this.emit("_iceComplete")),t.candidate&&this._startIceCompleteTimeout())},n.prototype._onChannelMessage=function(e){if(!this.destroyed){var t=e.data;t instanceof ArrayBuffer&&(t=o.from(t)),this.push(t)}},n.prototype._onChannelBufferedAmountLow=function(){if(!this.destroyed&&this._cb){this._debug("ending backpressure: bufferedAmount %d",this._channel.bufferedAmount);var t=this._cb;this._cb=null,t(null)}},n.prototype._onChannelOpen=function(){this._connected||this.destroyed||(this._debug("on channel open"),this._channelReady=!0,this._maybeReady())},n.prototype._onChannelClose=function(){this.destroyed||(this._debug("on channel close"),this.destroy())},n.prototype._onTrack=function(r){var e=this;e.destroyed||r.streams.forEach(function(t){e._debug("on track"),e.emit("track",r.track,t),e._remoteTracks.push({track:r.track,stream:t}),e._remoteStreams.some(function(n){return n.id===t.id})||(e._remoteStreams.push(t),setTimeout(function(){e.emit("stream",t)},0))})},n.prototype._debug=function(){var t=[].slice.call(arguments);t[0]="["+this._id+"] "+t[0],a.apply(null,t)}}).call(this,p({}).Buffer);var nd,rd=1,od=function(){rd=65535&rd+1},gr=function(o){nd||(nd=setInterval(od,250)).unref&&nd.unref();var d=4*(o||5),t=[0],n=1,l=65535&rd-1;return function(r){var e=65535&rd-l;for(e>d&&(e=d),l=rd;e--;)n==d&&(n=0),t[n]=t[0==n?d-1:n-1],n++;r&&(t[n-1]+=r);var i=t[n-1],o=t.length<d?0:t[n==d?0:n];return 4>t.length?i:4*(i-o)/t.length}},mr={};const dd=/^\[?([^\]]+)\]?:(\d+)$/;let yr={},ad=0;(mr=function(n){if(1e5==ad&&mr.reset(),!yr[n]){const e=dd.exec(n);if(!e)throw new Error(`invalid addr: ${n}`);yr[n]=[e[1],+e[2]],ad+=1}return yr[n]}).reset=function(){yr={},ad=0};var id={exports:{}};id.exports=class{constructor(r=0,e){const t=null!=e&&e.grow;this.grow=t&&isFinite(t)&&Dn(t)||t||0,this.buffer="number"==typeof r?new Uint8Array(Dn(r)):r}get(n){const e=n>>3;return e<this.buffer.length&&!!(this.buffer[e]&128>>n%8)}set(r,e=!0){const t=r>>3;if(e){if(this.buffer.length<t+1){const n=to(t+1,ao(2*this.buffer.length,this.grow));if(n<=this.grow){const e=new Uint8Array(n);e.set(this.buffer),this.buffer=e}}this.buffer[t]|=128>>r%8}else t<this.buffer.length&&(this.buffer[t]&=~(128>>r%8))}},id=id.exports;var sd=class extends st.Writable{constructor(o,e,d={}){if(super(d),!o||!o.put||!o.get)throw new Error("First argument must be an abstract-chunk-store compliant store");if(!(e=+e))throw new Error("Second argument must be a chunk length");this._blockstream=new Io(e,{zeroPadding:!1}),this._outstandingPuts=0;let n=0;this._blockstream.on("data",e=>{this.destroyed||(this._outstandingPuts+=1,o.put(n,e,()=>{this._outstandingPuts-=1,0===this._outstandingPuts&&"function"==typeof this._finalCb&&(this._finalCb(null),this._finalCb=null)}),n+=1)}).on("error",t=>{this.destroy(t)})}_write(r,e,t){this._blockstream.write(r,e,t)}_final(t){this._blockstream.end(),this._blockstream.once("end",()=>{0===this._outstandingPuts?t(null):this._finalCb=t})}destroy(t){this.destroyed||(this.destroyed=!0,t&&this.emit("error",t),this.emit("close"))}},kr={};(function(n){kr.DEFAULT_ANNOUNCE_PEERS=50,kr.binaryToHex=function(e){return"string"!=typeof e&&(e=e+""),n.from(e,"binary").toString("hex")},kr.hexToBinary=function(e){return"string"!=typeof e&&(e=e+""),n.from(e,"hex").toString("binary")},Object.assign(kr,oe)}).call(this,p({}).Buffer);var Sr={};(function(o,d){const t=jo("simple-websocket"),e=WebSocket,r=65536;class n extends st.Duplex{constructor(n={}){if("string"==typeof n&&(n={url:n}),super(n=Object.assign({allowHalfOpen:!1},n)),null==n.url&&null==n.socket)throw new Error("Missing required `url` or `socket` option");if(null!=n.url&&null!=n.socket)throw new Error("Must specify either `url` or `socket` option, not both");if(this._id=ur(4).toString("hex").slice(0,7),this._debug("new websocket: %o",n),this.connected=!1,this.destroyed=!1,this._chunk=null,this._cb=null,this._interval=null,n.socket)this.url=n.socket.url,this._ws=n.socket;else{this.url=n.url;try{this._ws=new e(n.url)}catch(e){return void o.nextTick(()=>this.destroy(e))}}this._ws.binaryType="arraybuffer",this._ws.onopen=()=>{this._onOpen()},this._ws.onmessage=t=>{this._onMessage(t)},this._ws.onclose=()=>{this._onClose()},this._ws.onerror=()=>{this.destroy(new Error("connection error to "+this.url))},this._onFinishBound=()=>{this._onFinish()},this.once("finish",this._onFinishBound)}send(t){this._ws.send(t)}destroy(t){this._destroy(t,()=>{})}_destroy(n,r){if(!this.destroyed){if(this._debug("destroy (error: %s)",n&&(n.message||n)),this.readable=this.writable=!1,this._readableState.ended||this.push(null),this._writableState.finished||this.end(),this.connected=!1,this.destroyed=!0,clearInterval(this._interval),this._interval=null,this._chunk=null,this._cb=null,this._onFinishBound&&this.removeListener("finish",this._onFinishBound),this._onFinishBound=null,this._ws){const r=this._ws,t=()=>{r.onclose=null};if(r.readyState===e.CLOSED)t();else try{r.onclose=t,r.close()}catch(n){t()}r.onopen=null,r.onmessage=null,r.onerror=()=>{}}if(this._ws=null,n){if("undefined"!=typeof DOMException&&n instanceof DOMException){const e=n.code;(n=new Error(n.message)).code=e}this.emit("error",n)}this.emit("close"),r()}}_read(){}_write(o,e,t){if(this.destroyed)return t(new Error("cannot write after socket is destroyed"));if(this.connected){try{this.send(o)}catch(e){return this.destroy(e)}this._ws.bufferedAmount>r?(this._debug("start backpressure: bufferedAmount %d",this._ws.bufferedAmount),this._cb=t):t(null)}else this._debug("write before connect"),this._chunk=o,this._cb=t}_onFinish(){if(!this.destroyed){const t=()=>{setTimeout(()=>this.destroy(),1e3)};this.connected?t():this.once("connect",t)}}_onMessage(t){if(this.destroyed)return;let e=t.data;e instanceof ArrayBuffer&&(e=d.from(e)),this.push(e)}_onOpen(){if(!this.connected&&!this.destroyed){if(this.connected=!0,this._chunk){try{this.send(this._chunk)}catch(e){return this.destroy(e)}this._chunk=null,this._debug("sent chunk from \"write before connect\"");const t=this._cb;this._cb=null,t(null)}this._interval=setInterval(()=>this._onInterval(),150),this._interval.unref&&this._interval.unref(),this._debug("connect"),this.emit("connect")}}_onInterval(){if(this._cb&&this._ws&&!(this._ws.bufferedAmount>r)){this._debug("ending backpressure: bufferedAmount %d",this._ws.bufferedAmount);const t=this._cb;this._cb=null,t(null)}}_onClose(){this.destroyed||(this._debug("on close"),this.destroy())}_debug(){const n=[].slice.call(arguments);n[0]="["+this._id+"] "+n[0],t.apply(null,n)}}n.WEBSOCKET_SUPPORT=!!e,Sr=n}).call(this,pe,p({}).Buffer);var ld=class extends m{constructor(n,e){super(),this.client=n,this.announceUrl=e,this.interval=null,this.destroyed=!1}setInterval(t){null==t&&(t=this.DEFAULT_ANNOUNCE_INTERVAL),clearInterval(this.interval),t&&(this.interval=setInterval(()=>{this.announce(this.client._defaultAnnounceOpts())},t),this.interval.unref&&this.interval.unref())}},xr={};const cd=jo("bittorrent-tracker:websocket-tracker"),Ar={};class Ir extends ld{constructor(r,e,t){super(r,e),cd("new websocket tracker %s",e),this.peers={},this.socket=null,this.reconnecting=!1,this.retries=0,this.reconnectTimer=null,this.expectingResponse=!1,this._openSocket()}announce(r){if(this.destroyed||this.reconnecting)return;if(!this.socket.connected)return void this.socket.once("connect",()=>{this.announce(r)});const o=Object.assign({},r,{action:"announce",info_hash:this.client._infoHashBinary,peer_id:this.client._peerIdBinary});if(this._trackerId&&(o.trackerid=this._trackerId),"stopped"===r.event||"completed"===r.event)this._send(o);else{const t=ao(r.numwant,10);this._generateOffers(t,n=>{o.numwant=t,o.offers=n,this._send(o)})}}scrape(n){if(!(this.destroyed||this.reconnecting)){if(!this.socket.connected)return void this.socket.once("connect",()=>{this.scrape(n)});const e={action:"scrape",info_hash:Array.isArray(n.infoHash)&&0<n.infoHash.length?n.infoHash.map(t=>t.toString("binary")):n.infoHash&&n.infoHash.toString("binary")||this.client._infoHashBinary};this._send(e)}}destroy(o=Zn){function e(){d&&(clearTimeout(d),d=null),r.removeListener("data",e),r.destroy(),r=null}if(this.destroyed)return o(null);for(const t in this.destroyed=!0,clearInterval(this.interval),clearTimeout(this.reconnectTimer),this.peers){const n=this.peers[t];clearTimeout(n.trackerTimeout),n.destroy()}if(this.peers=null,this.socket&&(this.socket.removeListener("connect",this._onSocketConnectBound),this.socket.removeListener("data",this._onSocketDataBound),this.socket.removeListener("close",this._onSocketCloseBound),this.socket.removeListener("error",this._onSocketErrorBound),this.socket=null),this._onSocketConnectBound=null,this._onSocketErrorBound=null,this._onSocketDataBound=null,this._onSocketCloseBound=null,Ar[this.announceUrl]&&(Ar[this.announceUrl].consumers-=1),0<Ar[this.announceUrl].consumers)return o();let r=Ar[this.announceUrl];if(delete Ar[this.announceUrl],r.on("error",Zn),r.once("close",o),!this.expectingResponse)return e();var d=setTimeout(e,kr.DESTROY_TIMEOUT);r.once("data",e)}_openSocket(){this.destroyed=!1,this.peers||(this.peers={}),this._onSocketConnectBound=()=>{this._onSocketConnect()},this._onSocketErrorBound=t=>{this._onSocketError(t)},this._onSocketDataBound=t=>{this._onSocketData(t)},this._onSocketCloseBound=()=>{this._onSocketClose()},this.socket=Ar[this.announceUrl],this.socket?Ar[this.announceUrl].consumers+=1:(this.socket=Ar[this.announceUrl]=new Sr(this.announceUrl),this.socket.consumers=1,this.socket.once("connect",this._onSocketConnectBound)),this.socket.on("data",this._onSocketDataBound),this.socket.once("close",this._onSocketCloseBound),this.socket.once("error",this._onSocketErrorBound)}_onSocketConnect(){this.destroyed||this.reconnecting&&(this.reconnecting=!1,this.retries=0,this.announce(this.client._defaultAnnounceOpts()))}_onSocketData(t){if(!this.destroyed){this.expectingResponse=!1;try{t=JSON.parse(t)}catch(e){return void this.client.emit("warning",new Error("Invalid tracker response"))}"announce"===t.action?this._onAnnounceResponse(t):"scrape"===t.action?this._onScrapeResponse(t):this._onSocketError(new Error(`invalid action in WS response: ${t.action}`))}}_onAnnounceResponse(o){if(o.info_hash!==this.client._infoHashBinary)return void cd("ignoring websocket data from %s for %s (looking for %s: reused socket)",this.announceUrl,kr.binaryToHex(o.info_hash),this.client.infoHash);if(o.peer_id&&o.peer_id===this.client._peerIdBinary)return;cd("received %s from %s for %s",JSON.stringify(o),this.announceUrl,this.client.infoHash);const e=o["failure reason"];if(e)return this.client.emit("warning",new Error(e));const t=o["warning message"];t&&this.client.emit("warning",new Error(t));const n=o.interval||o["min interval"];n&&this.setInterval(1e3*n);const r=o["tracker id"];if(r&&(this._trackerId=r),null!=o.complete){const e=Object.assign({},o,{announce:this.announceUrl,infoHash:kr.binaryToHex(o.info_hash)});this.client.emit("update",e)}let d;if(o.offer&&o.peer_id&&(cd("creating peer (from remote offer)"),(d=this._createPeer()).id=kr.binaryToHex(o.peer_id),d.once("signal",e=>{const t={action:"announce",info_hash:this.client._infoHashBinary,peer_id:this.client._peerIdBinary,to_peer_id:o.peer_id,answer:e,offer_id:o.offer_id};this._trackerId&&(t.trackerid=this._trackerId),this._send(t)}),d.signal(o.offer),this.client.emit("peer",d)),o.answer&&o.peer_id){const e=kr.binaryToHex(o.offer_id);(d=this.peers[e])?(d.id=kr.binaryToHex(o.peer_id),d.signal(o.answer),this.client.emit("peer",d),clearTimeout(d.trackerTimeout),d.trackerTimeout=null,delete this.peers[e]):cd(`got unexpected answer: ${JSON.stringify(o.answer)}`)}}_onScrapeResponse(r){r=r.files||{};const n=Object.keys(r);0===n.length?this.client.emit("warning",new Error("invalid scrape response")):n.forEach(e=>{const t=Object.assign(r[e],{announce:this.announceUrl,infoHash:kr.binaryToHex(e)});this.client.emit("scrape",t)})}_onSocketClose(){this.destroyed||(this.destroy(),this._startReconnectTimer())}_onSocketError(t){this.destroyed||(this.destroy(),this.client.emit("warning",t),this._startReconnectTimer())}_startReconnectTimer(){const t=io(Math.random()*12e4)+ao(no(2,this.retries)*1e4,18e5);this.reconnecting=!0,clearTimeout(this.reconnectTimer),this.reconnectTimer=setTimeout(()=>{this.retries++,this._openSocket()},t),this.reconnectTimer.unref&&this.reconnectTimer.unref(),cd("reconnecting socket in %s ms",t)}_send(n){if(!this.destroyed){this.expectingResponse=!0;const e=JSON.stringify(n);cd("send %s",e),this.socket.send(e)}}_generateOffers(d,e){function t(){const r=ur(20).toString("hex");cd("creating peer (from _generateOffers)");const e=a.peers[r]=a._createPeer({initiator:!0});e.once("signal",e=>{n.push({offer:e,offer_id:kr.hexToBinary(r)}),o()}),e.trackerTimeout=setTimeout(()=>{cd("tracker timeout: destroying peer"),e.trackerTimeout=null,delete a.peers[r],e.destroy()},5e4),e.trackerTimeout.unref&&e.trackerTimeout.unref()}function o(){n.length===d&&(cd("generated %s offers",d),e(n))}const a=this,n=[];cd("generating %s offers",d);for(let n=0;n<d;++n)t();o()}_createPeer(o){function d(n){r.client.emit("warning",new Error(`Connection error: ${n.message}`)),t.destroy()}const r=this;o=Object.assign({trickle:!1,config:r.client._rtcConfig,wrtc:r.client._wrtc},o);const t=new td(o);return t.once("error",d),t.once("connect",function n(){t.removeListener("error",d),t.removeListener("connect",n)}),t}}Ir.prototype.DEFAULT_ANNOUNCE_INTERVAL=3e4,Ir._socketPool=Ar,xr=Ir;var Or={};(function(d,l){const a=jo("bittorrent-tracker:client");class t extends m{constructor(e={}){if(super(),!e.peerId)throw new Error("Option `peerId` is required");if(!e.infoHash)throw new Error("Option `infoHash` is required");if(!e.announce)throw new Error("Option `announce` is required");if(!d.browser&&!e.port)throw new Error("Option `port` is required");this.peerId="string"==typeof e.peerId?e.peerId:e.peerId.toString("hex"),this._peerIdBuffer=l.from(this.peerId,"hex"),this._peerIdBinary=this._peerIdBuffer.toString("binary"),this.infoHash="string"==typeof e.infoHash?e.infoHash.toLowerCase():e.infoHash.toString("hex"),this._infoHashBuffer=l.from(this.infoHash,"hex"),this._infoHashBinary=this._infoHashBuffer.toString("binary"),a("new client %s",this.infoHash),this.destroyed=!1,this._port=e.port,this._getAnnounceOpts=e.getAnnounceOpts,this._rtcConfig=e.rtcConfig,this._userAgent=e.userAgent,this._wrtc="function"==typeof e.wrtc?e.wrtc():e.wrtc;let t="string"==typeof e.announce?[e.announce]:null==e.announce?[]:e.announce;t=t.map(t=>("/"===(t=t.toString())[t.length-1]&&(t=t.substring(0,t.length-1)),t)),t=or(t);const c=!1!==this._wrtc&&(!!this._wrtc||td.WEBRTC_SUPPORT),s=e=>{d.nextTick(()=>{this.emit("warning",e)})};this._trackers=t.map(o=>{let e;try{e=new URL(o)}catch(e){return s(new Error(`Invalid tracker URL: ${o}`)),null}const d=e.port;if(0>d||65535<d)return s(new Error(`Invalid tracker port: ${o}`)),null;const n=e.protocol;return"http:"!==n&&"https:"!==n||!0?"udp:"===n&&!1?new oe(this,o):("ws:"===n||"wss:"===n)&&c?"ws:"===n&&"undefined"!=typeof window&&"https:"===window.location.protocol?(s(new Error(`Unsupported tracker protocol: ${o}`)),null):new xr(this,o):(s(new Error(`Unsupported tracker protocol: ${o}`)),null):new oe(this,o)}).filter(Boolean)}start(t){a("send `start`"),(t=this._defaultAnnounceOpts(t)).event="started",this._announce(t),this._trackers.forEach(t=>{t.setInterval()})}stop(t){a("send `stop`"),(t=this._defaultAnnounceOpts(t)).event="stopped",this._announce(t)}complete(t){a("send `complete`"),t||(t={}),(t=this._defaultAnnounceOpts(t)).event="completed",this._announce(t)}update(t){a("send `update`"),(t=this._defaultAnnounceOpts(t)).event&&delete t.event,this._announce(t)}_announce(n){this._trackers.forEach(e=>{e.announce(n)})}scrape(n){a("send `scrape`"),n||(n={}),this._trackers.forEach(e=>{e.scrape(n)})}setInterval(n){a("setInterval %d",n),this._trackers.forEach(e=>{e.setInterval(n)})}destroy(n){if(!this.destroyed){this.destroyed=!0,a("destroy");const e=this._trackers.map(n=>e=>{n.destroy(e)});Oo(e,n),this._trackers=[],this._getAnnounceOpts=null}}_defaultAnnounceOpts(t={}){return null==t.numwant&&(t.numwant=kr.DEFAULT_ANNOUNCE_PEERS),null==t.uploaded&&(t.uploaded=0),null==t.downloaded&&(t.downloaded=0),this._getAnnounceOpts&&(t=Object.assign({},t,this._getAnnounceOpts())),t}}t.scrape=(r,d)=>{if(d=Ot(d),!r.infoHash)throw new Error("Option `infoHash` is required");if(!r.announce)throw new Error("Option `announce` is required");const e=Object.assign({},r,{infoHash:Array.isArray(r.infoHash)?r.infoHash[0]:r.infoHash,peerId:l.from("01234567890123456789"),port:6881}),i=new t(e);i.once("error",d),i.once("warning",d);let s=Array.isArray(r.infoHash)?r.infoHash.length:1;const c={};return i.on("scrape",t=>{if(s-=1,c[t.infoHash]=t,0===s){i.destroy();const t=Object.keys(c);1===t.length?d(null,c[t[0]]):d(null,c)}}),r.infoHash=Array.isArray(r.infoHash)?r.infoHash.map(t=>l.from(t,"hex")):l.from(r.infoHash,"hex"),i.scrape({infoHash:r.infoHash}),i},Or=t}).call(this,pe,p({}).Buffer);var ud={};(function(r){const o=jo("torrent-discovery"),e=m.EventEmitter;ud=class extends e{constructor(e){if(super(),!e.peerId)throw new Error("Option `peerId` is required");if(!e.infoHash)throw new Error("Option `infoHash` is required");if(!r.browser&&!e.port)throw new Error("Option `port` is required");this.peerId="string"==typeof e.peerId?e.peerId:e.peerId.toString("hex"),this.infoHash="string"==typeof e.infoHash?e.infoHash.toLowerCase():e.infoHash.toString("hex"),this._port=e.port,this._userAgent=e.userAgent,this.destroyed=!1,this._announce=e.announce||[],this._intervalMs=e.intervalMs||9e5,this._trackerOpts=null,this._dhtAnnouncing=!1,this._dhtTimeout=!1,this._internalDHT=!1,this._onWarning=t=>{this.emit("warning",t)},this._onError=t=>{this.emit("error",t)},this._onDHTPeer=(n,e)=>{e.toString("hex")===this.infoHash&&this.emit("peer",`${n.host}:${n.port}`,"dht")},this._onTrackerPeer=t=>{this.emit("peer",t,"tracker")},this._onTrackerAnnounce=()=>{this.emit("trackerAnnounce")};const t=(r,e)=>{const t=new oe(e);return t.on("warning",this._onWarning),t.on("error",this._onError),t.listen(r),this._internalDHT=!0,t};!1===e.tracker?this.tracker=null:e.tracker&&"object"==typeof e.tracker?(this._trackerOpts=Object.assign({},e.tracker),this.tracker=this._createTracker()):this.tracker=this._createTracker(),this.dht=!1!==e.dht&&0?e.dht&&"function"==typeof e.dht.addNode?e.dht:e.dht&&"object"==typeof e.dht?t(e.dhtPort,e.dht):t(e.dhtPort):null,this.dht&&(this.dht.on("peer",this._onDHTPeer),this._dhtAnnounce())}updatePort(t){t!==this._port&&(this._port=t,this.dht&&this._dhtAnnounce(),this.tracker&&(this.tracker.stop(),this.tracker.destroy(()=>{this.tracker=this._createTracker()})))}complete(t){this.tracker&&this.tracker.complete(t)}destroy(n){if(!this.destroyed){this.destroyed=!0,clearTimeout(this._dhtTimeout);const e=[];this.tracker&&(this.tracker.stop(),this.tracker.removeListener("warning",this._onWarning),this.tracker.removeListener("error",this._onError),this.tracker.removeListener("peer",this._onTrackerPeer),this.tracker.removeListener("update",this._onTrackerAnnounce),e.push(t=>{this.tracker.destroy(t)})),this.dht&&this.dht.removeListener("peer",this._onDHTPeer),this._internalDHT&&(this.dht.removeListener("warning",this._onWarning),this.dht.removeListener("error",this._onError),e.push(t=>{this.dht.destroy(t)})),Oo(e,n),this.dht=null,this.tracker=null,this._announce=null}}_createTracker(){const n=Object.assign({},this._trackerOpts,{infoHash:this.infoHash,announce:this._announce,peerId:this.peerId,port:this._port,userAgent:this._userAgent}),e=new Or(n);return e.on("warning",this._onWarning),e.on("error",this._onError),e.on("peer",this._onTrackerPeer),e.on("update",this._onTrackerAnnounce),e.setInterval(this._intervalMs),e.start(),e}_dhtAnnounce(){this._dhtAnnouncing||(o("dht announce"),this._dhtAnnouncing=!0,clearTimeout(this._dhtTimeout),this.dht.announce(this.infoHash,this._port,t=>{this._dhtAnnouncing=!1,o("dht announce complete"),t&&this.emit("warning",t),this.emit("dhtAnnounce"),this.destroyed||(this._dhtTimeout=setTimeout(()=>{this._dhtAnnounce()},this._intervalMs+io(Math.random()*this._intervalMs/5)),this._dhtTimeout.unref&&this._dhtTimeout.unref())}))}}}).call(this,pe);var fd={};(function(o){function r(t,e){if(!(this instanceof r))return new r(t,e);if(e||(e={}),this.chunkLength=+t,!this.chunkLength)throw new Error("First argument must be a chunk length");this.chunks=[],this.closed=!1,this.length=+e.length||1/0,this.length!==1/0&&(this.lastChunkLength=this.length%this.chunkLength||this.chunkLength,this.lastChunkIndex=eo(this.length/this.chunkLength)-1)}function d(e,t,n){o.nextTick(function(){e&&e(t,n)})}fd=r,r.prototype.put=function(n,e,t){if(this.closed)return d(t,new Error("Storage is closed"));var r=n===this.lastChunkIndex;return r&&e.length!==this.lastChunkLength?d(t,new Error("Last chunk length must be "+this.lastChunkLength)):r||e.length===this.chunkLength?(this.chunks[n]=e,void d(t,null)):d(t,new Error("Chunk length must be "+this.chunkLength))},r.prototype.get=function(n,e,t){if("function"==typeof e)return this.get(n,null,e);if(this.closed)return d(t,new Error("Storage is closed"));var r=this.chunks[n];if(!r){var i=new Error("Chunk not found");return i.notFound=!0,d(t,i)}if(!e)return d(t,null,r);var s=e.offset||0,o=e.length||r.length-s;d(t,null,r.slice(s,o+s))},r.prototype.close=r.prototype.destroy=function(t){return this.closed?d(t,new Error("Storage is closed")):void(this.closed=!0,this.chunks=null,d(t,null))}}).call(this,pe);var pd={};(function(o){pd=class{constructor(t){if(this.store=t,this.chunkLength=t.chunkLength,!this.store||!this.store.get||!this.store.put)throw new Error("First argument must be abstract-chunk-store compliant");this.mem=[]}put(r,e,o){this.mem[r]=e,this.store.put(r,e,e=>{this.mem[r]=null,o&&o(e)})}get(e,t,n){if("function"==typeof t)return this.get(e,null,t);const r=t&&t.offset||0,d=t&&t.length&&r+t.length,a=this.mem[e];return a?function(e,t,n){o.nextTick(()=>{e&&e(null,n)})}(n,0,t?a.slice(r,d):a):void this.store.get(e,t,n)}close(t){this.store.close(t)}destroy(t){this.store.destroy(t)}}}).call(this,pe);var hd={};class gd extends st.Readable{constructor(n,e){super(e),this.destroyed=!1,this._drained=!1,this._forwarding=!1,this._current=null,this._toStreams2=e&&e.objectMode?rr:Er,"function"==typeof n?this._queue=n:(this._queue=n.map(this._toStreams2),this._queue.forEach(t=>{"function"!=typeof t&&this._attachErrorListener(t)})),this._next()}_read(){this._drained=!0,this._forward()}_forward(){if(!this._forwarding&&this._drained&&this._current){var t;for(this._forwarding=!0;null!==(t=this._current.read())&&this._drained;)this._drained=this.push(t);this._forwarding=!1}}destroy(t){this.destroyed||(this.destroyed=!0,this._current&&this._current.destroy&&this._current.destroy(),"function"!=typeof this._queue&&this._queue.forEach(t=>{t.destroy&&t.destroy()}),t&&this.emit("error",t),this.emit("close"))}_next(){if(this._current=null,"function"==typeof this._queue)this._queue((n,e)=>n?this.destroy(n):void(e=this._toStreams2(e),this._attachErrorListener(e),this._gotNextStream(e)));else{var t=this._queue.shift();"function"==typeof t&&(t=this._toStreams2(t()),this._attachErrorListener(t)),this._gotNextStream(t)}}_gotNextStream(o){if(!o)return this.push(null),void this.destroy();this._current=o,this._forward();const e=()=>{this._forward()},t=()=>{o._readableState.ended||this.destroy()},n=()=>{this._current=null,o.removeListener("readable",e),o.removeListener("end",n),o.removeListener("close",t),this._next()};o.on("readable",e),o.once("end",n),o.once("close",t)}_attachErrorListener(r){if(!r)return;const e=t=>{r.removeListener("error",e),this.destroy(t)};r.once("error",e)}}gd.obj=t=>new gd(t,{objectMode:!0,highWaterMark:16}),hd=gd;var zr={};(function(o){zr=function(f,p,e){function t(r){function t(){e&&e(r,d),e=null}b?o.nextTick(t):t()}function u(o,e,a){if(d[o]=a,e&&(_=!0),0==--m||e)t(e);else if(!_&&y<g){var r;n?(r=n[y],y+=1,f[r](function(n,e){u(r,n,e)})):(r=y,y+=1,f[r](function(n,e){u(r,n,e)}))}}if("number"!=typeof p)throw new Error("second argument must be a Number");var d,g,m,n,_,b=!0;Array.isArray(f)?(d=[],m=g=f.length):(n=Object.keys(f),d={},m=g=n.length);var y=p;m?n?n.some(function(o,e){if(f[o](function(e,t){u(o,e,t)}),e===p-1)return!0}):f.some(function(n,r){if(n(function(t,e){u(r,t,e)}),r===p-1)return!0}):t(null),b=!1}}).call(this,pe);var md={};(function(r){const d=16384;class e{constructor(t){this.length=t,this.missing=t,this.sources=null,this._chunks=eo(t/d),this._remainder=t%d||d,this._buffered=0,this._buffer=null,this._cancellations=null,this._reservations=0,this._flushed=!1}chunkLength(t){return t===this._chunks-1?this._remainder:d}chunkLengthRemaining(t){return this.length-t*d}chunkOffset(t){return t*d}reserve(){return this.init()?this._cancellations.length?this._cancellations.pop():this._reservations<this._chunks?this._reservations++:-1:-1}reserveRemaining(){if(!this.init())return-1;if(this._reservations<this._chunks){const t=this._reservations;return this._reservations=this._chunks,t}return-1}cancel(t){this.init()&&this._cancellations.push(t)}cancelRemaining(t){this.init()&&(this._reservations=t)}get(t){return this.init()?this._buffer[t]:null}set(t,e,n){if(!this.init())return!1;const r=e.length,a=eo(r/d);for(let r=0;r<a;r++)if(!this._buffer[t+r]){const o=r*d,a=e.slice(o,o+d);this._buffered++,this._buffer[t+r]=a,this.missing-=a.length,this.sources.includes(n)||this.sources.push(n)}return this._buffered===this._chunks}flush(){if(!this._buffer||this._chunks!==this._buffered)return null;const e=r.concat(this._buffer,this.length);return this._buffer=null,this._cancellations=null,this.sources=null,this._flushed=!0,e}init(){return!(this._flushed||!this._buffer&&(this._buffer=Array(this._chunks),this._cancellations=[],this.sources=[],0))}}Object.defineProperty(e,"BLOCK_LENGTH",{value:16384}),md=e}).call(this,p({}).Buffer);var _d=function(){},Gr=function(p,e,g){if("function"==typeof e)return Gr(p,null,e);e||(e={}),g=Ot(g||_d);var m=p._writableState,r=p._readableState,i=e.readable||!1!==e.readable&&p.readable,_=e.writable||!1!==e.writable&&p.writable,b=function(){p.writable||a()},a=function(){_=!1,i||g.call(p)},h=function(){i=!1,_||g.call(p)},c=function(e){g.call(p,e?new Error("exited with error code: "+e):null)},u=function(e){g.call(p,e)},d=function(){return(!i||r&&r.ended)&&(!_||m&&m.ended)?void 0:g.call(p,new Error("premature close"))},l=function(){p.req.on("finish",a)};return function(t){return t.setHeader&&"function"==typeof t.abort}(p)?(p.on("complete",a),p.on("abort",d),p.req?l():p.on("request",l)):_&&!m&&(p.on("end",b),p.on("close",b)),function(t){return t.stdio&&Array.isArray(t.stdio)&&3===t.stdio.length}(p)&&p.on("exit",c),p.on("end",h),p.on("finish",a),!1!==e.error&&p.on("error",u),p.on("close",d),function(){p.removeListener("complete",a),p.removeListener("abort",d),p.removeListener("request",l),p.req&&p.req.removeListener("finish",a),p.removeListener("end",b),p.removeListener("close",b),p.removeListener("finish",a),p.removeListener("exit",c),p.removeListener("end",h),p.removeListener("error",u),p.removeListener("close",d)}},Kr=Gr,Yr={};(function(o){var d=function(){},t=/^v?\.0/.test(o.version),n=function(t){return"function"==typeof t},r=function(t){t()},i=function(n,e){return n.pipe(e)};Yr=function(){var s,l=Array.prototype.slice.call(arguments),c=n(l[l.length-1]||d)&&l.pop()||d;if(Array.isArray(l[0])&&(l=l[0]),2>l.length)throw new Error("pump requires two streams per minimum");var a=l.map(function(e,o){var i=o<l.length-1;return function(r,e,i,s){s=Ot(s);var l=!1;r.on("close",function(){l=!0}),Kr(r,{readable:e,writable:i},function(t){return t?s(t):void(l=!0,s())});var c=!1;return function(e){if(!l&&!c)return c=!0,function(r){return!!t&&!0&&(r instanceof(oe.ReadStream||d)||r instanceof(oe.WriteStream||d))&&n(r.close)}(r)?r.close(d):function(t){return t.setHeader&&n(t.abort)}(r)?r.abort():n(r.destroy)?r.destroy():void s(e||new Error("stream was destroyed"))}}(e,i,0<o,function(e){s||(s=e),e&&a.forEach(r),i||(a.forEach(r),c(s))})});return l.reduce(i)}}).call(this,pe);var bd={};(function(d){const{EventEmitter:e}=m,t=jo("ut_metadata"),n=1e3,o=16384;bd=r=>{class i extends e{constructor(e){super(),this._wire=e,this._fetching=!1,this._metadataComplete=!1,this._metadataSize=null,this._remainingRejects=null,this._bitfield=new id(0,{grow:n}),d.isBuffer(r)&&this.setMetadata(r)}onHandshake(r,e,t){this._infoHash=r}onExtendedHandshake(t){return t.m&&t.m.ut_metadata?t.metadata_size?"number"!=typeof t.metadata_size||1e7<t.metadata_size||0>=t.metadata_size?this.emit("warning",new Error("Peer gave invalid metadata size")):(this._metadataSize=t.metadata_size,this._numPieces=eo(this._metadataSize/o),this._remainingRejects=2*this._numPieces,void(this._fetching&&this._requestPieces())):this.emit("warning",new Error("Peer does not have metadata")):this.emit("warning",new Error("Peer does not support ut_metadata"))}onMessage(o){let e,d;try{const t=o.toString(),n=t.indexOf("ee")+2;e=te.decode(t.substring(0,n)),d=o.slice(n)}catch(e){return}switch(e.msg_type){case 0:this._onRequest(e.piece);break;case 1:this._onData(e.piece,d,e.total_size);break;case 2:this._onReject(e.piece);}}fetch(){this._metadataComplete||(this._fetching=!0,this._metadataSize&&this._requestPieces())}cancel(){this._fetching=!1}setMetadata(n){if(this._metadataComplete)return!0;t("set metadata");try{const e=te.decode(n).info;e&&(n=te.encode(e))}catch(e){}return!(this._infoHash&&this._infoHash!==qo.sync(n)||(this.cancel(),this.metadata=n,this._metadataComplete=!0,this._metadataSize=this.metadata.length,this._wire.extendedHandshake.metadata_size=this._metadataSize,this.emit("metadata",te.encode({info:te.decode(this.metadata)})),0))}_send(e,t){let n=te.encode(e);d.isBuffer(t)&&(n=d.concat([n,t])),this._wire.extended("ut_metadata",n)}_request(t){this._send({msg_type:0,piece:t})}_data(o,e,t){const n={msg_type:1,piece:o};"number"==typeof t&&(n.total_size=t),this._send(n,e)}_reject(t){this._send({msg_type:2,piece:t})}_onRequest(d){if(!this._metadataComplete)return void this._reject(d);const e=d*o;let t=e+o;t>this._metadataSize&&(t=this._metadataSize);const a=this.metadata.slice(e,t);this._data(d,a,this._metadataSize)}_onData(r,e,t){e.length>o||(e.copy(this.metadata,r*o),this._bitfield.set(r),this._checkDone())}_onReject(t){0<this._remainingRejects&&this._fetching?(this._request(t),this._remainingRejects-=1):this.emit("warning",new Error("Peer sent \"reject\" too much"))}_requestPieces(){this.metadata=d.alloc(this._metadataSize);for(let t=0;t<this._numPieces;t++)this._request(t)}_checkDone(){let t=!0;for(let e=0;e<this._numPieces;e++)if(!this._bitfield.get(e)){t=!1;break}t&&(this.setMetadata(this.metadata)||this._failedMetadata())}_failedMetadata(){this._bitfield=new id(0,{grow:n}),this._remainingRejects-=this._numPieces,0<this._remainingRejects?this._requestPieces():this.emit("warning",new Error("Peer sent invalid metadata"))}}return i.prototype.name="ut_metadata",i}}).call(this,p({}).Buffer);var yd={parse:function(n){var e=n.split(",").map(function(t){return function(d){if(/^-?\d+$/.test(d))return parseInt(d,10);var e;if(e=d.match(/^(-?\d+)(-|\.\.\.?|\u2025|\u2026|\u22EF)(-?\d+)$/)){var l=e[1],c=e[2],r=e[3];if(l&&r){var u=[],s=(l=parseInt(l))<(r=parseInt(r))?1:-1;"-"!=c&&".."!=c&&"\u2025"!=c||(r+=s);for(var o=l;o!=r;o+=s)u.push(o);return u}}return[]}(t)});return 0===e.length?[]:1===e.length?Array.isArray(e[0])?e[0]:e:e.reduce(function(n,r){return Array.isArray(n)||(n=[n]),Array.isArray(r)||(r=[r]),n.concat(r)})}},Zr=function(r){for(var e=0,o=r.length;e<o;++e)if(127<r.charCodeAt(e))return!1;return!0},Qr=Br,wd="undefined"!=typeof window&&window.MediaSource;Br.prototype.createWriteStream=function(t){return new Rr(this,t)},Br.prototype.error=function(t){this.detailedError||(this.detailedError=t),this._dumpDebugData();try{this._mediaSource.endOfStream("decode")}catch(t){}try{window.URL.revokeObjectURL(this._elem.src)}catch(t){}},Br.prototype._dumpDebugData=function(){this._debug&&(this._debug=!1,this._streams.forEach(function(o,e){var t,d,a;t=o._debugBuffers,d="mediasource-stream-"+e,(a=document.createElement("a")).href=window.URL.createObjectURL(new window.Blob(t)),a.download=d,a.click()}))},Me(Rr,st.Writable),Rr.prototype._onSourceOpen=function(){this.destroyed||(this._mediaSource.removeEventListener("sourceopen",this._openHandler),this._createSourceBuffer())},Rr.prototype.destroy=function(t){this.destroyed||(this.destroyed=!0,this._allStreams.splice(this._allStreams.indexOf(this),1),this._mediaSource.removeEventListener("sourceopen",this._openHandler),this._elem.removeEventListener("timeupdate",this._flowHandler),this._sourceBuffer&&(this._sourceBuffer.removeEventListener("updateend",this._flowHandler),this._sourceBuffer.removeEventListener("error",this._errorHandler),"open"===this._mediaSource.readyState&&this._sourceBuffer.abort()),t&&this.emit("error",t),this.emit("close"))},Rr.prototype._createSourceBuffer=function(){if(!this.destroyed)if(!wd.isTypeSupported(this._type))this.destroy(new Error("The provided type is not supported"));else if(this._sourceBuffer=this._mediaSource.addSourceBuffer(this._type),this._sourceBuffer.addEventListener("updateend",this._flowHandler),this._sourceBuffer.addEventListener("error",this._errorHandler),this._cb){var t=this._cb;this._cb=null,t()}},Rr.prototype._write=function(o,e,t){var n=this;if(!n.destroyed)if(n._sourceBuffer){if(n._sourceBuffer.updating)return t(new Error("Cannot append buffer while source buffer updating"));var r=Sn(o);n._wrapper._debug&&n._debugBuffers.push(r);try{n._sourceBuffer.appendBuffer(r)}catch(e){return void n.destroy(e)}n._cb=t}else n._cb=function(r){return r?t(r):void n._write(o,e,t)}},Rr.prototype._flow=function(){if(!this.destroyed&&this._sourceBuffer&&!this._sourceBuffer.updating&&!("open"===this._mediaSource.readyState&&this._getBufferDuration()>this._bufferDuration)&&this._cb){var t=this._cb;this._cb=null,t()}},Rr.prototype._getBufferDuration=function(){for(var d=this._sourceBuffer.buffered,e=this._elem.currentTime,t=-1,a=0;a<d.length;a++){var l=d.start(a),i=d.end(a)+0;if(l>e)break;(0<=t||e<=i)&&(t=i)}var s=t-e;return 0>s&&(s=0),s};var Sd=function o(e,t,d){return"function"==typeof t?o(e,null,t):void!function o(e,t,n){if("function"==typeof t)return o(e,null,t);n=Ot(n);var d=[];e.on("data",function(t){d.push(t)}).on("end",function(){var r=t?new Blob(d,{type:t}):new Blob(d);n(null,r)}).on("error",n)}(e,t,function(r,e){if(r)return d(r);var t=URL.createObjectURL(e);d(null,t)})},kd={};(function(d){function e(o,e,t,d){if(0>t||d>o.length)throw new RangeError("Out of range index");return t>>>=0,(d=void 0===d?o.length:d>>>0)>t&&o.fill(e,t,d),o}var n=function(){try{if(!d.isEncoding("latin1"))return!1;var e=d.alloc?d.alloc(4):new d(4);return e.fill("ab","ucs2"),"61006200"===e.toString("hex")}catch(e){return!1}}();kd=function(t,r,l,c,u){if(n)return t.fill(r,l,c,u);if("number"==typeof r)return e(t,r,l,c);if("string"==typeof r){if("string"==typeof l?(u=l,l=0,c=t.length):"string"==typeof c&&(u=c,c=t.length),void 0!==u&&"string"!=typeof u)throw new TypeError("encoding must be a string");if("latin1"===u&&(u="binary"),"string"==typeof u&&!d.isEncoding(u))throw new TypeError("Unknown encoding: "+u);if(""===r)return e(t,0,l,c);if(function(t){return 1===t.length&&256>t.charCodeAt(0)}(r))return e(t,r.charCodeAt(0),l,c);r=new d(r,u)}return d.isBuffer(r)?function(o,e,t,d){if(0>t||d>o.length)throw new RangeError("Out of range index");if(d<=t)return o;t>>>=0,d=void 0===d?o.length:d>>>0;for(var a=t,l=e.length;a<=d-l;)e.copy(o,a),a+=l;return a!==d&&e.copy(o,a,0,d-a),o}(t,r,l,c):e(t,0,l,c)}}).call(this,p({}).Buffer);var Ed={};(function(n){Ed=function(e){if("number"!=typeof e)throw new TypeError("\"size\" argument must be a number");if(0>e)throw new RangeError("\"size\" argument must not be negative");return n.allocUnsafe?n.allocUnsafe(e):new n(e)}}).call(this,p({}).Buffer);var vd={};(function(o){vd=function(e,t,n){if("number"!=typeof e)throw new TypeError("\"size\" argument must be a number");if(0>e)throw new RangeError("\"size\" argument must not be negative");if(o.alloc)return o.alloc(e,t,n);var d=Ed(e);return 0===e?d:void 0===t?kd(d,0):("string"!=typeof n&&(n=void 0),kd(d,t,n))}}).call(this,p({}).Buffer);var Cd={},xd=no(2,32);Cd.encode=function(o,e,d){e||(e=vd(8)),d||(d=0);var a=io(o/4294967296);return e.writeUInt32BE(a,d),e.writeUInt32BE(o-a*4294967296,d+4),e},Cd.decode=function(o,e){e||(e=0);var d=o.readUInt32BE(e),n=o.readUInt32BE(e+4);return d*4294967296+n},Cd.encode.bytes=8,Cd.decode.bytes=8;var Ld={};(function(d){var l={3:"ESDescriptor",4:"DecoderConfigDescriptor",5:"DecoderSpecificInfo",6:"SLConfigDescriptor"};Ld.Descriptor={},Ld.Descriptor.decode=function(e,t,n){var r,i,f=e.readUInt8(t),a=t+1,p=0;do p=p<<7|127&(r=e.readUInt8(a++));while(128&r);var g=l[f];return(i=Ld[g]?Ld[g].decode(e,a,n):{buffer:d.from(e.slice(a,a+p))}).tag=f,i.tagName=g,i.length=a-t+p,i.contentsLen=p,i},Ld.DescriptorArray={},Ld.DescriptorArray.decode=function(t,e,n){for(var r,d=e,a={};d+2<=n;)r=Ld.Descriptor.decode(t,d,n),d+=r.length,a[l[r.tag]||"Descriptor"+r.tag]=r;return a},Ld.ESDescriptor={},Ld.ESDescriptor.decode=function(o,e,t){var n=o.readUInt8(e+2),r=e+3;return 128&n&&(r+=2),64&n&&(r+=o.readUInt8(r)+1),32&n&&(r+=2),Ld.DescriptorArray.decode(o,r,t)},Ld.DecoderConfigDescriptor={},Ld.DecoderConfigDescriptor.decode=function(o,e,t){var n=o.readUInt8(e),r=Ld.DescriptorArray.decode(o,e+13,t);return r.oti=n,r}}).call(this,p({}).Buffer);var Td={};(function(o){var d=lo({}),t=o.alloc(0);class a extends st.PassThrough{constructor(t){super(),this._parent=t,this.destroyed=!1}destroy(t){this.destroyed||(this.destroyed=!0,this._parent.destroy(t),t&&this.emit("error",t),this.emit("close"))}}Td=class extends st.Writable{constructor(t){super(t),this.destroyed=!1,this._pending=0,this._missing=0,this._ignoreEmpty=!1,this._buf=null,this._str=null,this._cb=null,this._ondrain=null,this._writeBuffer=null,this._writeCb=null,this._ondrain=null,this._kick()}destroy(t){this.destroyed||(this.destroyed=!0,t&&this.emit("error",t),this.emit("close"))}_write(r,d,l){if(!this.destroyed){for(var n=!this._str||!this._str._writableState.needDrain;r.length&&!this.destroyed;){if(!this._missing&&!this._ignoreEmpty)return this._writeBuffer=r,void(this._writeCb=l);var c=r.length<this._missing?r.length:this._missing;if(this._buf?r.copy(this._buf,this._buf.length-this._missing):this._str&&(n=this._str.write(c===r.length?r:r.slice(0,c))),this._missing-=c,!this._missing){var s=this._buf,o=this._cb,a=this._str;this._buf=this._cb=this._str=this._ondrain=null,n=!0,this._ignoreEmpty=!1,a&&a.end(),o&&o(s)}r=c===r.length?t:r.slice(c)}if(this._pending&&!this._missing)return this._writeBuffer=r,void(this._writeCb=l);n?l():this._ondrain(l)}}_buffer(e,t){this._missing=e,this._buf=o.alloc(e),this._cb=t}_stream(o,e){return this._missing=o,this._str=new a(this),this._ondrain=(t=this._str,d="drain",i=null,t.on(d,function(n){if(i){var e=i;i=null,e(n)}}),function(t){i=t}),this._pending++,this._str.on("end",()=>{this._pending--,this._kick()}),this._cb=e,this._str;var t,d,i}_readBox(){const e=(t,n)=>{this._buffer(t,t=>{n=n?o.concat([n,t]):t;var r=d.readHeaders(n);"number"==typeof r?e(r-n.length,n):(this._pending++,this._headers=r,this.emit("box",r))})};e(8)}stream(){if(!this._headers)throw new Error("this function can only be called once after 'box' is emitted");var t=this._headers;return this._headers=null,this._stream(t.contentLen,null)}decode(n){if(!this._headers)throw new Error("this function can only be called once after 'box' is emitted");var e=this._headers;this._headers=null,this._buffer(e.contentLen,t=>{var r=d.decodeWithoutHeaders(e,t);n(r),this._pending--,this._kick()})}ignore(){if(!this._headers)throw new Error("this function can only be called once after 'box' is emitted");var t=this._headers;this._headers=null,this._missing=t.contentLen,0===this._missing&&(this._ignoreEmpty=!0),this._cb=()=>{this._pending--,this._kick()}}_kick(){if(!this._pending&&(this._buf||this._str||this._readBox(),this._writeBuffer)){var n=this._writeCb,e=this._writeBuffer;this._writeBuffer=null,this._writeCb=null,this._write(e,null,n)}}}}).call(this,p({}).Buffer);var Bd={};(function(d,e){function n(){}var a=lo({});class r extends st.PassThrough{constructor(t){super(),this._parent=t,this.destroyed=!1}destroy(t){this.destroyed||(this.destroyed=!0,this._parent.destroy(t),t&&this.emit("error",t),this.emit("close"))}}Bd=class extends st.Readable{constructor(t){super(t),this.destroyed=!1,this._finalized=!1,this._reading=!1,this._stream=null,this._drain=null,this._want=!1,this._onreadable=()=>{this._want&&(this._want=!1,this._read())},this._onend=()=>{this._stream=null}}mdat(n,e){this.mediaData(n,e)}mediaData(o,e){var t=new r(this);return this.box({type:"mdat",contentLength:o,encodeBufferLen:8,stream:t},e),t}box(r,t){if(t||(t=n),this.destroyed)return t(new Error("Encoder is destroyed"));var i;if(r.encodeBufferLen&&(i=e.alloc(r.encodeBufferLen)),r.stream)r.buffer=null,i=a.encode(r,i),this.push(i),this._stream=r.stream,this._stream.on("readable",this._onreadable),this._stream.on("end",this._onend),this._stream.on("end",t),this._forward();else{if(i=a.encode(r,i),this.push(i))return d.nextTick(t);this._drain=t}}destroy(n){if(!this.destroyed){if(this.destroyed=!0,this._stream&&this._stream.destroy&&this._stream.destroy(),this._stream=null,this._drain){var e=this._drain;this._drain=null,e(n)}n&&this.emit("error",n),this.emit("close")}}finalize(){this._finalized=!0,this._stream||this._drain||this.push(null)}_forward(){if(this._stream)for(;!this.destroyed;){var t=this._stream.read();if(!t)return void(this._want=!!this._stream);if(!this.push(t))return}}_read(){if(!this._reading&&!this.destroyed){if(this._reading=!0,this._stream&&this._forward(),this._drain){var t=this._drain;this._drain=null,t()}this._reading=!1,this._finalized&&this.push(null)}}}}).call(this,pe,p({}).Buffer);var Id={decode:t=>new Td(t),encode:t=>new Bd(t)};const{Writable:Rd,PassThrough:Ad}=st;var Ud=class extends Rd{constructor(n,e={}){super(e),this.destroyed=!1,this._queue=[],this._position=n||0,this._cb=null,this._buffer=null,this._out=null}_write(d,o,a){let n=!0;for(;;){if(this.destroyed)return;if(0===this._queue.length)return this._buffer=d,void(this._cb=a);this._buffer=null;var l=this._queue[0];const e=to(l.start-this._position,0),t=l.end-this._position;if(e>=d.length)return this._position+=d.length,a(null);let r;if(t>d.length){this._position+=d.length,r=0===e?d:d.slice(e),n=l.stream.write(r)&&n;break}this._position+=t,r=0===e&&t===d.length?d:d.slice(e,t),n=l.stream.write(r)&&n,l.last&&l.stream.end(),d=d.slice(t),this._queue.shift()}n?a(null):l.stream.once("drain",a.bind(null,null))}slice(o){if(this.destroyed)return null;Array.isArray(o)||(o=[o]);const d=new Ad;return o.forEach((e,t)=>{this._queue.push({start:e.start,end:e.end,stream:d,last:t===o.length-1})}),this._buffer&&this._write(this._buffer,null,this._cb),d}destroy(t){this.destroyed||(this.destroyed=!0,t&&this.emit("error",t))}},Pd={};(function(d){const l=lo({});class w{constructor(n,e){this._entries=n,this._countName=e||"count",this._index=0,this._offset=0,this.value=this._entries[0]}inc(){this._offset++,this._offset>=this._entries[this._index][this._countName]&&(this._index++,this._offset=0),this.value=this._entries[this._index]}}Pd=class extends m{constructor(t){super(),this._tracks=[],this._file=t,this._decoder=null,this._findMoov(0)}_findMoov(o){this._decoder&&this._decoder.destroy();let e=0;this._decoder=Id.decode();const d=this._file.createReadStream({start:o});d.pipe(this._decoder);const n=t=>{"moov"===t.type?(this._decoder.removeListener("box",n),this._decoder.decode(t=>{d.destroy();try{this._processMoov(t)}catch(e){e.message=`Cannot parse mp4 file: ${e.message}`,this.emit("error",e)}})):4096>t.length?(e+=t.length,this._decoder.ignore()):(this._decoder.removeListener("box",n),e+=t.length,d.destroy(),this._decoder.destroy(),this._findMoov(o+e))};this._decoder.on("box",n)}_processMoov(r){const t=r.traks;this._tracks=[],this._hasVideo=!1,this._hasAudio=!1;for(let i=0;i<t.length;i++){const e=t[i],s=e.mdia.minf.stbl,n=s.stsd.entries[0],o=e.mdia.hdlr.handlerType;let a,c;if("vide"===o&&"avc1"===n.type){if(this._hasVideo)continue;this._hasVideo=!0,a="avc1",n.avcC&&(a+=`.${n.avcC.mimeCodec}`),c=`video/mp4; codecs="${a}"`}else{if("soun"!==o||"mp4a"!==n.type)continue;if(this._hasAudio)continue;this._hasAudio=!0,a="mp4a",n.esds&&n.esds.mimeCodec&&(a+=`.${n.esds.mimeCodec}`),c=`audio/mp4; codecs="${a}"`}const u=[];let d=0,l=0,f=0,p=0,h=0,g=0;const m=new w(s.stts.entries);let _=null;s.ctts&&(_=new w(s.ctts.entries));for(let o=0;;){var S=s.stsc.entries[h];const a=s.stsz.entries[d],e=m.value.duration,t=_?_.value.compositionOffset:0;let n=!0;s.stss&&(n=s.stss.entries[o]===d+1);const r=s.stco||s.co64;if(u.push({size:a,duration:e,dts:g,presentationOffset:t,sync:n,offset:p+r.entries[f]}),++d>=s.stsz.entries.length)break;if(p+=a,++l>=S.samplesPerChunk){l=0,p=0,f++;const t=s.stsc.entries[h+1];t&&f+1>=t.firstChunk&&h++}g+=e,m.inc(),_&&_.inc(),n&&o++}e.mdia.mdhd.duration=0,e.tkhd.duration=0;const b=S.sampleDescriptionId,y={type:"moov",mvhd:r.mvhd,traks:[{tkhd:e.tkhd,mdia:{mdhd:e.mdia.mdhd,hdlr:e.mdia.hdlr,elng:e.mdia.elng,minf:{vmhd:e.mdia.minf.vmhd,smhd:e.mdia.minf.smhd,dinf:e.mdia.minf.dinf,stbl:{stsd:s.stsd,stts:{version:0,flags:0,entries:[]},ctts:{version:0,flags:0,entries:[]},stsc:{version:0,flags:0,entries:[]},stsz:{version:0,flags:0,entries:[]},stco:{version:0,flags:0,entries:[]},stss:{version:0,flags:0,entries:[]}}}}}],mvex:{mehd:{fragmentDuration:r.mvhd.duration},trexs:[{trackId:e.tkhd.trackId,defaultSampleDescriptionIndex:b,defaultSampleDuration:0,defaultSampleSize:0,defaultSampleFlags:0}]}};this._tracks.push({fragmentSequence:1,trackId:e.tkhd.trackId,timeScale:e.mdia.mdhd.timeScale,samples:u,currSample:null,currTime:null,moov:y,mime:c})}if(0===this._tracks.length)return void this.emit("error",new Error("no playable tracks"));r.mvhd.duration=0,this._ftyp={type:"ftyp",brand:"iso5",brandVersion:0,compatibleBrands:["iso5"]};const e=l.encode(this._ftyp),n=this._tracks.map(n=>{const t=l.encode(n.moov);return{mime:n.mime,init:d.concat([e,t])}});this.emit("ready",n)}seek(d){if(!this._tracks)throw new Error("Not ready yet; wait for 'ready' event");this._fileStream&&(this._fileStream.destroy(),this._fileStream=null);let a=-1;if(this._tracks.map((l,e)=>{l.outStream&&l.outStream.destroy(),l.inStream&&(l.inStream.destroy(),l.inStream=null);const n=l.outStream=Id.encode(),t=this._generateFragment(e,d);if(!t)return n.finalize();(-1===a||t.ranges[0].start<a)&&(a=t.ranges[0].start);const r=o=>{n.destroyed||n.box(o.moof,d=>d?this.emit("error",d):void(n.destroyed||l.inStream.slice(o.ranges).pipe(n.mediaData(o.length,t=>{if(t)return this.emit("error",t);if(!n.destroyed){const o=this._generateFragment(e);return o?void r(o):n.finalize()}}))))};r(t)}),0<=a){const t=this._fileStream=this._file.createReadStream({start:a});this._tracks.forEach(e=>{e.inStream=new Ud(a,{highWaterMark:1e7}),t.pipe(e.inStream)})}return this._tracks.map(t=>t.outStream)}_findSampleBefore(o,e){const t=this._tracks[o],n=io(t.timeScale*e);let r=function(d,e,t,n,a){var l,c;if(void 0===n)n=0;else if(0>(n|=0)||n>=d.length)throw new RangeError("invalid lower bound");if(void 0===a)a=d.length-1;else if((a|=0)<n||a>=d.length)throw new RangeError("invalid upper bound");for(;n<=a;)if(0>(c=+t(d[l=n+(a-n>>>1)],e,l,d)))n=l+1;else{if(!(0<c))return l;a=l-1}return~n}(t.samples,n,(n,e)=>n.dts+n.presentationOffset-e);for(-1===r?r=0:0>r&&(r=-r-2);!t.samples[r].sync;)r--;return r}_generateFragment(d,e){const l=this._tracks[d];let t;if((t=void 0===e?l.currSample:this._findSampleBefore(d,e))>=l.samples.length)return null;const n=l.samples[t].dts;let i=0;const c=[];for(var o=t;o<l.samples.length;o++){const r=l.samples[o];if(r.sync&&r.dts-n>=1*l.timeScale)break;i+=r.size;const e=c.length-1;0>e||c[e].end!==r.offset?c.push({start:r.offset,end:r.offset+r.size}):c[e].end+=r.size}return l.currSample=o,{moof:this._generateMoof(d,t,o),ranges:c,length:i}}_generateMoof(n,e,t){const r=this._tracks[n],d=[];let i=0;for(let o=e;o<t;o++){const t=r.samples[o];0>t.presentationOffset&&(i=1),d.push({sampleDuration:t.duration,sampleSize:t.size,sampleFlags:t.sync?33554432:16842752,sampleCompositionTimeOffset:t.presentationOffset})}const s={type:"moof",mfhd:{sequenceNumber:r.fragmentSequence++},trafs:[{tfhd:{flags:131072,trackId:r.trackId},tfdt:{baseMediaDecodeTime:r.samples[e].dts},trun:{flags:3841,dataOffset:8,entries:d,version:i}}]};return s.trafs[0].trun.dataOffset+=l.encodingLength(s),s}}}).call(this,p({}).Buffer);var Md={};Ur.prototype={_createMuxer(){this._muxer=new Pd(this._file),this._muxer.on("ready",t=>{this._tracks=t.map(r=>{const e=this._elemWrapper.createWriteStream(r.mime);e.on("error",t=>{this._elemWrapper.error(t)});const t={muxed:null,mediaSource:e,initFlushed:!1,onInitFlushed:null};return e.write(r.init,n=>{t.initFlushed=!0,t.onInitFlushed&&t.onInitFlushed(n)}),t}),(this._waitingFired||"auto"===this._elem.preload)&&this._pump()}),this._muxer.on("error",t=>{this._elemWrapper.error(t)})},_pump(){const r=this._muxer.seek(this._elem.currentTime,!this._tracks);this._tracks.forEach((e,t)=>{const n=()=>{e.muxed&&(e.muxed.destroy(),e.mediaSource=this._elemWrapper.createWriteStream(e.mediaSource),e.mediaSource.on("error",t=>{this._elemWrapper.error(t)})),e.muxed=r[t],Yr(e.muxed,e.mediaSource)};e.initFlushed?n():e.onInitFlushed=t=>{t?this._elemWrapper.error(t):n()}})},destroy(){this.destroyed||(this.destroyed=!0,this._elem.removeEventListener("waiting",this._onWaiting),this._elem.removeEventListener("error",this._onError),this._tracks&&this._tracks.forEach(t=>{t.muxed&&t.muxed.destroy()}),this._elem.src="")}},Md=Ur;var Od={render:function(o,e,d,a){"function"==typeof d&&(a=d,d={}),d||(d={}),a||(a=function(){}),Fr(o),Wr(d),"string"==typeof e&&(e=document.querySelector(e)),Mr(o,function(t){if(e.nodeName!==t.toUpperCase()){var n=pt.extname(o.name).toLowerCase();throw new Error("Cannot render \""+n+"\" inside a \""+e.nodeName.toLowerCase()+"\" element, expected \""+t+"\"")}return e},d,a)},append:function(o,d,a,s){function l(t){var e=document.createElement(t);return d.appendChild(e),e}if("function"==typeof a&&(s=a,a={}),a||(a={}),s||(s=function(){}),Fr(o),Wr(a),"string"==typeof d&&(d=document.querySelector(d)),d&&("VIDEO"===d.nodeName||"AUDIO"===d.nodeName))throw new Error("Invalid video/audio node argument. Argument must be root element that video/audio tag will be appended to.");Mr(o,function(t){return"video"===t||"audio"===t?function(t){var e=l(t);return a.autoplay&&(e.autoplay=!0),a.muted&&(e.muted=!0),a.controls&&(e.controls=!0),d.appendChild(e),e}(t):l(t)},a,function(n,e){n&&e&&e.remove(),s(n,e)})},mime:{".3gp":"video/3gpp",".aac":"audio/aac",".aif":"audio/x-aiff",".aiff":"audio/x-aiff",".atom":"application/atom+xml",".avi":"video/x-msvideo",".bmp":"image/bmp",".bz2":"application/x-bzip2",".conf":"text/plain",".css":"text/css",".csv":"text/plain",".diff":"text/x-diff",".doc":"application/msword",".flv":"video/x-flv",".gif":"image/gif",".gz":"application/x-gzip",".htm":"text/html",".html":"text/html",".ico":"image/vnd.microsoft.icon",".ics":"text/calendar",".iso":"application/octet-stream",".jar":"application/java-archive",".jpeg":"image/jpeg",".jpg":"image/jpeg",".js":"application/javascript",".json":"application/json",".less":"text/css",".log":"text/plain",".m3u":"audio/x-mpegurl",".m4a":"audio/x-m4a",".m4b":"audio/mp4",".m4p":"audio/mp4",".m4v":"video/x-m4v",".manifest":"text/cache-manifest",".markdown":"text/x-markdown",".mathml":"application/mathml+xml",".md":"text/x-markdown",".mid":"audio/midi",".midi":"audio/midi",".mov":"video/quicktime",".mp3":"audio/mpeg",".mp4":"video/mp4",".mp4v":"video/mp4",".mpeg":"video/mpeg",".mpg":"video/mpeg",".odp":"application/vnd.oasis.opendocument.presentation",".ods":"application/vnd.oasis.opendocument.spreadsheet",".odt":"application/vnd.oasis.opendocument.text",".oga":"audio/ogg",".ogg":"application/ogg",".pdf":"application/pdf",".png":"image/png",".pps":"application/vnd.ms-powerpoint",".ppt":"application/vnd.ms-powerpoint",".ps":"application/postscript",".psd":"image/vnd.adobe.photoshop",".qt":"video/quicktime",".rar":"application/x-rar-compressed",".rdf":"application/rdf+xml",".rss":"application/rss+xml",".rtf":"application/rtf",".svg":"image/svg+xml",".svgz":"image/svg+xml",".swf":"application/x-shockwave-flash",".tar":"application/x-tar",".tbz":"application/x-bzip-compressed-tar",".text":"text/plain",".tif":"image/tiff",".tiff":"image/tiff",".torrent":"application/x-bittorrent",".ttf":"application/x-font-ttf",".txt":"text/plain",".wav":"audio/wav",".webm":"video/webm",".wma":"audio/x-ms-wma",".wmv":"video/x-ms-wmv",".xls":"application/vnd.ms-excel",".xml":"application/xml",".yaml":"text/yaml",".yml":"text/yaml",".zip":"application/zip"}},Nd=jo("render-media"),Hd=[".m4a",".m4b",".m4p",".m4v",".mp4"],Dd=[".m4v",".mkv",".mp4",".webm"],qd=[].concat(Dd,[".m4a",".m4b",".m4p",".mp3"]),Fd=[".mov",".ogv"],Wd=[".aac",".oga",".ogg",".wav",".flac"],jd=[".bmp",".gif",".jpeg",".jpg",".png",".svg"],zd=[".css",".html",".js",".md",".pdf",".txt"],Vd="undefined"!=typeof window&&window.MediaSource,Gd={};(function(o){Gd=function(e,t,n){n=Ot(n);var d=o.alloc(t),a=0;e.on("data",function(t){t.copy(d,a),a+=t.length}).on("end",function(){n(null,d)}).on("error",n)}}).call(this,p({}).Buffer);const Kd=jo("webtorrent:file-stream");var Yd=class extends st.Readable{constructor(o,e){super(e),this.destroyed=!1,this._torrent=o._torrent;const t=e&&e.start||0,n=e&&e.end&&e.end<o.length?e.end:o.length-1,r=o._torrent.pieceLength;this._startPiece=0|(t+o.offset)/r,this._endPiece=0|(n+o.offset)/r,this._piece=this._startPiece,this._offset=t+o.offset-this._startPiece*r,this._missing=n-t+1,this._reading=!1,this._notifying=!1,this._criticalLength=ao(0|1048576/r,2)}_read(){this._reading||(this._reading=!0,this._notify())}_notify(){if(!this._reading||0===this._missing)return;if(!this._torrent.bitfield.get(this._piece))return this._torrent.critical(this._piece,this._piece+this._criticalLength);if(this._notifying)return;if(this._notifying=!0,this._torrent.destroyed)return this._destroy(new Error("Torrent removed"));const r=this._piece;this._torrent.store.get(r,(e,t)=>{if(this._notifying=!1,!this.destroyed){if(e)return this._destroy(e);Kd("read %s (length %s) (err %s)",r,t.length,e&&e.message),this._offset&&(t=t.slice(this._offset),this._offset=0),this._missing<t.length&&(t=t.slice(0,this._missing)),this._missing-=t.length,Kd("pushing buffer of length %s",t.length),this._reading=!1,this.push(t),0===this._missing&&this.push(null)}}),this._piece+=1}destroy(t){this._destroy(null,t)}_destroy(n,e){this.destroyed||(this.destroyed=!0,this._torrent.destroyed||this._torrent.deselect(this._startPiece,this._endPiece,!0),n&&this.emit("error",n),this.emit("close"),e&&e())}},$d={};(function(r){const{EventEmitter:e}=m,{PassThrough:o}=st;$d=class extends e{constructor(o,e){super(),this._torrent=o,this._destroyed=!1,this.name=e.name,this.path=e.path,this.length=e.length,this.offset=e.offset,this.done=!1;const t=e.offset,n=t+e.length-1;this._startPiece=0|t/this._torrent.pieceLength,this._endPiece=0|n/this._torrent.pieceLength,0===this.length&&(this.done=!0,this.emit("done"))}get downloaded(){if(!this._torrent.bitfield)return 0;const{pieces:d,bitfield:e,pieceLength:t}=this._torrent,{_startPiece:n,_endPiece:r}=this,a=d[n];let i=e.get(n)?t-this.offset%t:to(a.length-a.missing-this.offset,0);for(let o=n+1;o<=r;++o)if(e.get(o))i+=t;else{const e=d[o];i+=e.length-e.missing}return ao(i,this.length)}get progress(){return this.length?this.downloaded/this.length:0}select(t){0!==this.length&&this._torrent.select(this._startPiece,this._endPiece,t)}deselect(){0!==this.length&&this._torrent.deselect(this._startPiece,this._endPiece,!1)}createReadStream(e){if(0===this.length){const e=new o;return r.nextTick(()=>{e.end()}),e}const t=new Yd(this,e);return this._torrent.select(t._startPiece,t._endPiece,!0,()=>{t._notify()}),Kr(t,()=>{this._destroyed||this._torrent.destroyed||this._torrent.deselect(t._startPiece,t._endPiece,!0)}),t}getBuffer(t){Gd(this.createReadStream(),this.length,t)}getBlob(n){if("undefined"==typeof window)throw new Error("browser-only method");(function(o,r){if(null!=r&&"string"!=typeof r)throw new Error("Invalid mimetype, expected string.");return new Promise((t,e)=>{const n=[];o.on("data",t=>n.push(t)).once("end",()=>{const o=null==r?new Blob(n):new Blob(n,{type:r});t(o)}).once("error",e)})})(this.createReadStream(),this._getMimeType()).then(e=>n(null,e),n)}getBlobURL(t){if("undefined"==typeof window)throw new Error("browser-only method");Sd(this.createReadStream(),this._getMimeType(),t)}appendTo(r,e,t){if("undefined"==typeof window)throw new Error("browser-only method");Od.append(this,r,e,t)}renderTo(r,e,t){if("undefined"==typeof window)throw new Error("browser-only method");Od.render(this,r,e,t)}_getMimeType(){return Od.mime[pt.extname(this.name).toLowerCase()]}_destroy(){this._destroyed=!0,this._torrent=null}}}).call(this,pe);var Xd=function(o,e){if(!(e>=o.length||0>e)){var t=o.pop();if(e<o.length){var n=o[e];return o[e]=t,n}return t}},Qd={};(function(d){const l=jo("bittorrent-protocol"),e=d.from("\x13BitTorrent protocol"),t=d.from([0,0,0,0]),n=d.from([0,0,0,1,0]),r=d.from([0,0,0,1,1]),i=d.from([0,0,0,1,2]),o=d.from([0,0,0,1,3]),f=[0,0,0,0,0,0,0,0],a=[0,0,0,3,9,0,0];class s{constructor(o,e,t,n){this.piece=o,this.offset=e,this.length=t,this.callback=n}}Qd=class extends st.Duplex{constructor(){super(),this._debugId=ur(4).toString("hex"),this._debug("new wire"),this.peerId=null,this.peerIdBuffer=null,this.type=null,this.amChoking=!0,this.amInterested=!1,this.peerChoking=!0,this.peerInterested=!1,this.peerPieces=new id(0,{grow:4e5}),this.peerExtensions={},this.requests=[],this.peerRequests=[],this.extendedMapping={},this.peerExtendedMapping={},this.extendedHandshake={},this.peerExtendedHandshake={},this._ext={},this._nextExt=1,this.uploaded=0,this.downloaded=0,this.uploadSpeed=gr(),this.downloadSpeed=gr(),this._keepAliveInterval=null,this._timeout=null,this._timeoutMs=0,this.destroyed=!1,this._finished=!1,this._parserSize=0,this._parser=null,this._buffer=[],this._bufferSize=0,this.on("finish",this._onFinish),this._parseHandshake()}setKeepAlive(t){this._debug("setKeepAlive %s",t),clearInterval(this._keepAliveInterval),!1!==t&&(this._keepAliveInterval=setInterval(()=>{this.keepAlive()},55e3))}setTimeout(n,e){this._debug("setTimeout ms=%d unref=%s",n,e),this._clearTimeout(),this._timeoutMs=n,this._timeoutUnref=!!e,this._updateTimeout()}destroy(){this.destroyed||(this.destroyed=!0,this._debug("destroy"),this.emit("close"),this.end())}end(...t){this._debug("end"),this._onUninterested(),this._onChoke(),super.end(...t)}use(o){function e(){}const d=o.prototype.name;if(!d)throw new Error("Extension class requires a \"name\" property on the prototype");this._debug("use extension.name=%s",d);const t=this._nextExt,n=new o(this);"function"!=typeof n.onHandshake&&(n.onHandshake=e),"function"!=typeof n.onExtendedHandshake&&(n.onExtendedHandshake=e),"function"!=typeof n.onMessage&&(n.onMessage=e),this.extendedMapping[t]=d,this._ext[d]=n,this[d]=n,this._nextExt+=1}keepAlive(){this._debug("keep-alive"),this._push(t)}handshake(n,l,c){let i,u;if("string"==typeof n?(n=n.toLowerCase(),i=d.from(n,"hex")):n=(i=n).toString("hex"),"string"==typeof l?u=d.from(l,"hex"):l=(u=l).toString("hex"),20!==i.length||20!==u.length)throw new Error("infoHash and peerId MUST have length 20");this._debug("handshake i=%s p=%s exts=%o",n,l,c);const p=d.from(f);p[5]|=16,c&&c.dht&&(p[7]|=1),this._push(d.concat([e,p,i,u])),this._handshakeSent=!0,this.peerExtensions.extended&&!this._extendedHandshakeSent&&this._sendExtendedHandshake()}_sendExtendedHandshake(){const r=Object.assign({},this.extendedHandshake);for(const e in r.m={},this.extendedMapping){const t=this.extendedMapping[e];r.m[t]=+e}this.extended(0,te.encode(r)),this._extendedHandshakeSent=!0}choke(){if(!this.amChoking){for(this.amChoking=!0,this._debug("choke");this.peerRequests.length;)this.peerRequests.pop();this._push(n)}}unchoke(){this.amChoking&&(this.amChoking=!1,this._debug("unchoke"),this._push(r))}interested(){this.amInterested||(this.amInterested=!0,this._debug("interested"),this._push(i))}uninterested(){this.amInterested&&(this.amInterested=!1,this._debug("uninterested"),this._push(o))}have(t){this._debug("have %d",t),this._message(4,[t],null)}bitfield(e){this._debug("bitfield"),d.isBuffer(e)||(e=e.buffer),this._message(5,[],e)}request(o,e,t,n){return n||(n=()=>{}),this._finished?n(new Error("wire is closed")):this.peerChoking?n(new Error("peer is choking")):(this._debug("request index=%d offset=%d length=%d",o,e,t),this.requests.push(new s(o,e,t,n)),this._updateTimeout(),void this._message(6,[o,e,t],null))}piece(r,e,t){this._debug("piece index=%d offset=%d",r,e),this.uploaded+=t.length,this.uploadSpeed(t.length),this.emit("upload",t.length),this._message(7,[r,e],t)}cancel(r,e,t){this._debug("cancel index=%d offset=%d length=%d",r,e,t),this._callback(this._pull(this.requests,r,e,t),new Error("request was cancelled"),null),this._message(8,[r,e,t],null)}port(e){this._debug("port %d",e);const t=d.from(a);t.writeUInt16BE(e,5),this._push(t)}extended(e,o){if(this._debug("extended ext=%s",e),"string"==typeof e&&this.peerExtendedMapping[e]&&(e=this.peerExtendedMapping[e]),"number"!=typeof e)throw new Error(`Unrecognized extension: ${e}`);{const t=d.from([e]),n=d.isBuffer(o)?o:te.encode(o);this._message(20,[],d.concat([t,n]))}}_read(){}_message(e,t,n){const r=n?n.length:0,o=d.allocUnsafe(5+4*t.length);o.writeUInt32BE(o.length+r-4,0),o[4]=e;for(let r=0;r<t.length;r++)o.writeUInt32BE(t[r],5+4*r);this._push(o),n&&this._push(n)}_push(t){if(!this._finished)return this.push(t)}_onKeepAlive(){this._debug("got keep-alive"),this.emit("keep-alive")}_onHandshake(o,e,t){const n=o.toString("hex"),r=e.toString("hex");for(var d in this._debug("got handshake i=%s p=%s exts=%o",n,r,t),this.peerId=r,this.peerIdBuffer=e,this.peerExtensions=t,this.emit("handshake",n,r,t),this._ext)this._ext[d].onHandshake(n,r,t);t.extended&&this._handshakeSent&&!this._extendedHandshakeSent&&this._sendExtendedHandshake()}_onChoke(){for(this.peerChoking=!0,this._debug("got choke"),this.emit("choke");this.requests.length;)this._callback(this.requests.pop(),new Error("peer is choking"),null)}_onUnchoke(){this.peerChoking=!1,this._debug("got unchoke"),this.emit("unchoke")}_onInterested(){this.peerInterested=!0,this._debug("got interested"),this.emit("interested")}_onUninterested(){this.peerInterested=!1,this._debug("got uninterested"),this.emit("uninterested")}_onHave(t){this.peerPieces.get(t)||(this._debug("got have %d",t),this.peerPieces.set(t,!0),this.emit("have",t))}_onBitField(t){this.peerPieces=new id(t),this._debug("got bitfield"),this.emit("bitfield",this.peerPieces)}_onRequest(o,e,t){if(!this.amChoking){this._debug("got request index=%d offset=%d length=%d",o,e,t);const d=(d,r)=>{if(n===this._pull(this.peerRequests,o,e,t))return d?this._debug("error satisfying request index=%d offset=%d length=%d (%s)",o,e,t,d.message):void this.piece(o,e,r)};var n=new s(o,e,t,d);this.peerRequests.push(n),this.emit("request",o,e,t,d)}}_onPiece(r,e,t){this._debug("got piece index=%d offset=%d",r,e),this._callback(this._pull(this.requests,r,e,t.length),null,t),this.downloaded+=t.length,this.downloadSpeed(t.length),this.emit("download",t.length),this.emit("piece",r,e,t)}_onCancel(r,e,t){this._debug("got cancel index=%d offset=%d length=%d",r,e,t),this._pull(this.peerRequests,r,e,t),this.emit("cancel",r,e,t)}_onPort(t){this._debug("got port %d",t),this.emit("port",t)}_onExtended(n,r){if(0===n){let t,e;try{t=te.decode(r)}catch(e){this._debug("ignoring invalid extended handshake: %s",e.message||e)}if(!t)return;if(this.peerExtendedHandshake=t,"object"==typeof t.m)for(e in t.m)this.peerExtendedMapping[e]=+t.m[e].toString();for(e in this._ext)this.peerExtendedMapping[e]&&this._ext[e].onExtendedHandshake(this.peerExtendedHandshake);this._debug("got extended handshake"),this.emit("extended","handshake",this.peerExtendedHandshake)}else this.extendedMapping[n]&&(n=this.extendedMapping[n],this._ext[n]&&this._ext[n].onMessage(r)),this._debug("got extended message ext=%s",n),this.emit("extended",n,r)}_onTimeout(){this._debug("request timed out"),this._callback(this.requests.shift(),new Error("request has timed out"),null),this.emit("timeout")}_write(e,t,n){for(this._bufferSize+=e.length,this._buffer.push(e);this._bufferSize>=this._parserSize;){const e=1===this._buffer.length?this._buffer[0]:d.concat(this._buffer);this._bufferSize-=this._parserSize,this._buffer=this._bufferSize?[e.slice(this._parserSize)]:[],this._parser(e.slice(0,this._parserSize))}n(null)}_callback(r,e,t){r&&(this._clearTimeout(),this.peerChoking||this._finished||this._updateTimeout(),r.callback(e,t))}_clearTimeout(){this._timeout&&(clearTimeout(this._timeout),this._timeout=null)}_updateTimeout(){this._timeoutMs&&this.requests.length&&!this._timeout&&(this._timeout=setTimeout(()=>this._onTimeout(),this._timeoutMs),this._timeoutUnref&&this._timeout.unref&&this._timeout.unref())}_parse(n,e){this._parserSize=n,this._parser=e}_onMessageLength(n){const e=n.readUInt32BE(0);0<e?this._parse(e,this._onMessage):(this._onKeepAlive(),this._parse(4,this._onMessageLength))}_onMessage(t){switch(this._parse(4,this._onMessageLength),t[0]){case 0:return this._onChoke();case 1:return this._onUnchoke();case 2:return this._onInterested();case 3:return this._onUninterested();case 4:return this._onHave(t.readUInt32BE(1));case 5:return this._onBitField(t.slice(1));case 6:return this._onRequest(t.readUInt32BE(1),t.readUInt32BE(5),t.readUInt32BE(9));case 7:return this._onPiece(t.readUInt32BE(1),t.readUInt32BE(5),t.slice(9));case 8:return this._onCancel(t.readUInt32BE(1),t.readUInt32BE(5),t.readUInt32BE(9));case 9:return this._onPort(t.readUInt16BE(1));case 20:return this._onExtended(t.readUInt8(1),t.slice(2));default:return this._debug("got unknown message"),this.emit("unknownmessage",t);}}_parseHandshake(){this._parse(1,n=>{const r=n.readUInt8(0);this._parse(r+48,t=>{const o=t.slice(0,r);return"BitTorrent protocol"===o.toString()?void(t=t.slice(r),this._onHandshake(t.slice(8,28),t.slice(28,48),{dht:!!(1&t[7]),extended:!!(16&t[5])}),this._parse(4,this._onMessageLength)):(this._debug("Error: wire not speaking BitTorrent protocol (%s)",o.toString()),void this.end())})})}_onFinish(){for(this._finished=!0,this.push(null);this.read(););for(clearInterval(this._keepAliveInterval),this._parse(Number.MAX_VALUE,()=>{});this.peerRequests.length;)this.peerRequests.pop();for(;this.requests.length;)this._callback(this.requests.pop(),new Error("wire was closed"),null)}_debug(...t){t[0]=`[${this._debugId}] ${t[0]}`,l(...t)}_pull(o,e,t,n){for(let r=0;r<o.length;r++){const d=o[r];if(d.piece===e&&d.offset===t&&d.length===n)return Xd(o,r),d}return null}}}).call(this,p({}).Buffer);var Jd={};(function(n){const m=jo("webtorrent:webconn");Jd=class extends Qd{constructor(n,e){super(),this.url=n,this.webPeerId=qo.sync(n),this._torrent=e,this._init()}_init(){this.setKeepAlive(!0),this.once("handshake",t=>{if(!this.destroyed){this.handshake(t,this.webPeerId);const e=this._torrent.pieces.length,n=new id(e);for(let t=0;t<=e;t++)n.set(t,!0);this.bitfield(n)}}),this.once("interested",()=>{m("interested"),this.unchoke()}),this.on("uninterested",()=>{m("uninterested")}),this.on("choke",()=>{m("choke")}),this.on("unchoke",()=>{m("unchoke")}),this.on("bitfield",()=>{m("bitfield")}),this.on("request",(t,e,n,r)=>{m("request pieceIndex=%d offset=%d length=%d",t,e,n),this.httpRequest(t,e,n,r)})}httpRequest(t,r,i,s){const o=t*this._torrent.pieceLength+r,a=o+i-1,p=this._torrent.files;let c;if(1>=p.length)c=[{url:this.url,start:o,end:a}];else{const t=p.filter(t=>t.offset<=a&&t.offset+t.length>o);if(1>t.length)return s(new Error("Could not find file corresponnding to web seed range request"));c=t.map(n=>{const e=n.offset+n.length-1;return{url:this.url+("/"===this.url[this.url.length-1]?"":"/")+n.path,fileOffsetInRange:to(n.offset-o,0),start:to(o-n.offset,0),end:ao(e,a-n.offset)}})}let h,g=0,_=!1;1<c.length&&(h=n.alloc(i)),c.forEach(o=>{function d(e,t){return 200>e.statusCode||300<=e.statusCode?(_=!0,s(new Error(`Unexpected HTTP status code ${e.statusCode}`))):void(m("Got data of length %d",t.length),1===c.length?s(null,t):(t.copy(h,o.fileOffsetInRange),++g===c.length&&s(null,h)))}const l=o.url,e=o.start,n=o.end;m("Requesting url=%s pieceIndex=%d offset=%d length=%d start=%d end=%d",l,t,r,i,e,n);const a={url:l,method:"GET",headers:{"user-agent":`WebTorrent/${"0.107.0"} (https://webtorrent.io)`,range:`bytes=${e}-${n}`}};nr.concat(a,(r,e,t)=>{if(!_)return r?"undefined"==typeof window||l.startsWith(`${window.location.origin}/`)?(_=!0,s(r)):nr.head(l,(e,t)=>{if(!_){if(e)return _=!0,s(e);if(200>t.statusCode||300<=t.statusCode)return _=!0,s(new Error(`Unexpected HTTP status code ${t.statusCode}`));if(t.url===l)return _=!0,s(r);a.url=t.url,nr.concat(a,(r,e,t)=>{if(!_)return r?(_=!0,s(r)):void d(e,t)})}}):void d(e,t)})})}destroy(){super.destroy(),this._torrent=null}}}).call(this,p({}).Buffer);var Zd={};const ea=jo("webtorrent:peer");Zd.createWebRTCPeer=(r,e)=>{const t=new ta(r.id,"webrtc");return t.conn=r,t.swarm=e,t.conn.connected?t.onConnect():(t.conn.once("connect",()=>{t.onConnect()}),t.conn.once("error",n=>{t.destroy(n)}),t.startConnectTimeout()),t},Zd.createTCPOutgoingPeer=(r,e)=>{const t=new ta(r,"tcpOutgoing");return t.addr=r,t.swarm=e,t},Zd.createWebSeedPeer=(r,e)=>{const t=new ta(r,"webSeed");return t.swarm=e,t.conn=new Jd(r,e),t.onConnect(),t};class ta{constructor(n,e){this.id=n,this.type=e,ea("new %s Peer %s",e,n),this.addr=null,this.conn=null,this.swarm=null,this.wire=null,this.connected=!1,this.destroyed=!1,this.timeout=null,this.retries=0,this.sentHandshake=!1}onConnect(){if(!this.destroyed){this.connected=!0,ea("Peer %s connected",this.id),clearTimeout(this.connectTimeout);const n=this.conn;n.once("end",()=>{this.destroy()}),n.once("close",()=>{this.destroy()}),n.once("finish",()=>{this.destroy()}),n.once("error",t=>{this.destroy(t)});const e=this.wire=new Qd;e.type=this.type,e.once("end",()=>{this.destroy()}),e.once("close",()=>{this.destroy()}),e.once("finish",()=>{this.destroy()}),e.once("error",t=>{this.destroy(t)}),e.once("handshake",(n,e)=>{this.onHandshake(n,e)}),this.startHandshakeTimeout(),n.pipe(e).pipe(n),this.swarm&&!this.sentHandshake&&this.handshake()}}onHandshake(r,e){if(!this.swarm)return;if(this.destroyed)return;if(this.swarm.destroyed)return this.destroy(new Error("swarm already destroyed"));if(r!==this.swarm.infoHash)return this.destroy(new Error("unexpected handshake info hash for this swarm"));if(e===this.swarm.peerId)return this.destroy(new Error("refusing to connect to ourselves"));ea("Peer %s got handshake %s",this.id,r),clearTimeout(this.handshakeTimeout),this.retries=0;let t=this.addr;!t&&this.conn.remoteAddress&&this.conn.remotePort&&(t=`${this.conn.remoteAddress}:${this.conn.remotePort}`),this.swarm._onWire(this.wire,t),this.swarm&&!this.swarm.destroyed&&(this.sentHandshake||this.handshake())}handshake(){const t={dht:!this.swarm.private&&!!this.swarm.client.dht};this.wire.handshake(this.swarm.infoHash,this.swarm.client.peerId,t),this.sentHandshake=!0}startConnectTimeout(){clearTimeout(this.connectTimeout),this.connectTimeout=setTimeout(()=>{this.destroy(new Error("connect timeout"))},"webrtc"===this.type?25e3:5e3),this.connectTimeout.unref&&this.connectTimeout.unref()}startHandshakeTimeout(){clearTimeout(this.handshakeTimeout),this.handshakeTimeout=setTimeout(()=>{this.destroy(new Error("handshake timeout"))},25e3),this.handshakeTimeout.unref&&this.handshakeTimeout.unref()}destroy(o){if(!this.destroyed){this.destroyed=!0,this.connected=!1,ea("destroy %s (error: %s)",this.id,o&&(o.message||o)),clearTimeout(this.connectTimeout),clearTimeout(this.handshakeTimeout);const e=this.swarm,t=this.conn,n=this.wire;this.swarm=null,this.conn=null,this.wire=null,e&&n&&Xd(e.wires,e.wires.indexOf(n)),t&&(t.on("error",()=>{}),t.destroy()),n&&n.destroy(),e&&e.removePeer(this.id)}}}var na={};(function(d,a){function g(n,e){return 2+eo(e*n.downloadSpeed()/md.BLOCK_LENGTH)}function l(){}const t=jo("webtorrent:torrent"),e=m.EventEmitter,u=3*md.BLOCK_LENGTH,n=d.browser?1/0:2,r=[1e3,5e3,15e3];let o;try{o=pt.join(St.statSync("/tmp")&&"/tmp","webtorrent")}catch(e){o=pt.join("function"==typeof oe.tmpdir?oe.tmpdir():"/","webtorrent")}na=class extends e{constructor(r,e,t){super(),this._debugId="unknown infohash",this.client=e,this.announce=t.announce,this.urlList=t.urlList,this.path=t.path,this.skipVerify=!!t.skipVerify,this._store=t.store||fd,this._getAnnounceOpts=t.getAnnounceOpts,this.strategy=t.strategy||"sequential",this.maxWebConns=t.maxWebConns||4,this._rechokeNumSlots=!1===t.uploads||0===t.uploads?0:+t.uploads||10,this._rechokeOptimisticWire=null,this._rechokeOptimisticTime=0,this._rechokeIntervalId=null,this.ready=!1,this.destroyed=!1,this.paused=!1,this.done=!1,this.metadata=null,this.store=null,this.files=[],this.pieces=[],this._amInterested=!1,this._selections=[],this._critical=[],this.wires=[],this._queue=[],this._peers={},this._peersLength=0,this.received=0,this.uploaded=0,this._downloadSpeed=gr(),this._uploadSpeed=gr(),this._servers=[],this._xsRequests=[],this._fileModtimes=t.fileModtimes,null!==r&&this._onTorrentId(r),this._debug("new torrent")}get timeRemaining(){return this.done?0:0===this.downloadSpeed?1/0:1e3*((this.length-this.downloaded)/this.downloadSpeed)}get downloaded(){if(!this.bitfield)return 0;let r=0;for(let e=0,t=this.pieces.length;e<t;++e)if(this.bitfield.get(e))r+=e==t-1?this.lastPieceLength:this.pieceLength;else{const t=this.pieces[e];r+=t.length-t.missing}return r}get downloadSpeed(){return this._downloadSpeed()}get uploadSpeed(){return this._uploadSpeed()}get progress(){return this.length?this.downloaded/this.length:0}get ratio(){return this.uploaded/(this.received||1)}get numPeers(){return this.wires.length}get torrentFileBlobURL(){if("undefined"==typeof window)throw new Error("browser-only property");return this.torrentFile?URL.createObjectURL(new Blob([this.torrentFile],{type:"application/x-bittorrent"})):null}get _numQueued(){return this._queue.length+(this._peersLength-this._numConns)}get _numConns(){let n=0;for(const e in this._peers)this._peers[e].connected&&(n+=1);return n}get swarm(){return console.warn("WebTorrent: `torrent.swarm` is deprecated. Use `torrent` directly instead."),this}_onTorrentId(e){if(this.destroyed)return;let t;try{t=Zo(e)}catch(e){}t?(this.infoHash=t.infoHash,this._debugId=t.infoHash.toString("hex").substring(0,7),d.nextTick(()=>{this.destroyed||this._onParsedTorrent(t)})):Zo.remote(e,(n,e)=>{if(!this.destroyed)return n?this._destroy(n):void this._onParsedTorrent(e)})}_onParsedTorrent(t){if(!this.destroyed){if(this._processParsedTorrent(t),!this.infoHash)return this._destroy(new Error("Malformed torrent data: No info hash"));this.path||(this.path=pt.join(o,this.infoHash)),this._rechokeIntervalId=setInterval(()=>{this._rechoke()},1e4),this._rechokeIntervalId.unref&&this._rechokeIntervalId.unref(),this.emit("_infoHash",this.infoHash),this.destroyed||(this.emit("infoHash",this.infoHash),this.destroyed||(this.client.listening?this._onListening():this.client.once("listening",()=>{this._onListening()})))}}_processParsedTorrent(t){this._debugId=t.infoHash.toString("hex").substring(0,7),this.announce&&(t.announce=t.announce.concat(this.announce)),this.client.tracker&&a.WEBTORRENT_ANNOUNCE&&!this.private&&(t.announce=t.announce.concat(a.WEBTORRENT_ANNOUNCE)),this.urlList&&(t.urlList=t.urlList.concat(this.urlList)),or(t.announce),or(t.urlList),Object.assign(this,t),this.magnetURI=Zo.toMagnetURI(t),this.torrentFile=Zo.toTorrentFile(t)}_onListening(){if(this.discovery||this.destroyed)return;let t=this.client.tracker;t&&(t=Object.assign({},this.client.tracker,{getAnnounceOpts:()=>{const t={uploaded:this.uploaded,downloaded:this.downloaded,left:to(this.length-this.downloaded,0)};return this.client.tracker.getAnnounceOpts&&Object.assign(t,this.client.tracker.getAnnounceOpts()),this._getAnnounceOpts&&Object.assign(t,this._getAnnounceOpts()),t}})),this.discovery=new ud({infoHash:this.infoHash,announce:this.announce,peerId:this.client.peerId,dht:!this.private&&this.client.dht,tracker:t,port:this.client.torrentPort,userAgent:`WebTorrent/${"0.107.0"} (https://webtorrent.io)`}),this.discovery.on("error",t=>{this._destroy(t)}),this.discovery.on("peer",t=>{"string"==typeof t&&this.done||this.addPeer(t)}),this.discovery.on("trackerAnnounce",()=>{this.emit("trackerAnnounce"),0===this.numPeers&&this.emit("noPeers","tracker")}),this.discovery.on("dhtAnnounce",()=>{this.emit("dhtAnnounce"),0===this.numPeers&&this.emit("noPeers","dht")}),this.discovery.on("warning",t=>{this.emit("warning",t)}),this.info?this._onMetadata(this):this.xs&&this._getMetadataFromServer()}_getMetadataFromServer(){const d=this,e=(Array.isArray(this.xs)?this.xs:[this.xs]).map(e=>t=>{!function(e,t){if(0!==e.indexOf("http://")&&0!==e.indexOf("https://"))return d.emit("warning",new Error(`skipping non-http xs param: ${e}`)),t(null);let n;try{n=nr.concat({url:e,method:"GET",headers:{"user-agent":"WebTorrent/0.107.0 (https://webtorrent.io)"}},function(n,r,a){if(d.destroyed)return t(null);if(d.metadata)return t(null);if(n)return d.emit("warning",new Error(`http error from xs param: ${e}`)),t(null);if(200!==r.statusCode)return d.emit("warning",new Error(`non-200 status code ${r.statusCode} from xs param: ${e}`)),t(null);let i;try{i=Zo(a)}catch(e){}return i?i.infoHash===d.infoHash?(d._onMetadata(i),void t(null)):(d.emit("warning",new Error(`got torrent file with incorrect info hash from xs param: ${e}`)),t(null)):(d.emit("warning",new Error(`got invalid torrent file from xs param: ${e}`)),t(null))})}catch(n){return d.emit("warning",new Error(`skipping invalid url xs param: ${e}`)),t(null)}d._xsRequests.push(n)}(e,t)});Oo(e)}_onMetadata(n){if(this.metadata||this.destroyed)return;let e;if(this._debug("got metadata"),this._xsRequests.forEach(t=>{t.abort()}),this._xsRequests=[],n&&n.infoHash)e=n;else try{e=Zo(n)}catch(e){return this._destroy(e)}if(this._processParsedTorrent(e),this.metadata=this.torrentFile,this.client.enableWebSeeds&&this.urlList.forEach(t=>{this.addWebSeed(t)}),this._rarityMap=new class{constructor(t){this._torrent=t,this._numPieces=t.pieces.length,this._pieces=Array(this._numPieces),this._onWire=t=>{this.recalculate(),this._initWire(t)},this._onWireHave=t=>{this._pieces[t]+=1},this._onWireBitfield=()=>{this.recalculate()},this._torrent.wires.forEach(t=>{this._initWire(t)}),this._torrent.on("wire",this._onWire),this.recalculate()}getRarestPiece(o){let e=[],d=1/0;for(let t=0;t<this._numPieces;++t){if(o&&!o(t))continue;const n=this._pieces[t];n===d?e.push(t):n<d&&(e=[t],d=n)}return e.length?e[0|Math.random()*e.length]:-1}destroy(){this._torrent.removeListener("wire",this._onWire),this._torrent.wires.forEach(t=>{this._cleanupWireEvents(t)}),this._torrent=null,this._pieces=null,this._onWire=null,this._onWireHave=null,this._onWireBitfield=null}_initWire(n){n._onClose=()=>{this._cleanupWireEvents(n);for(let e=0;e<this._numPieces;++e)this._pieces[e]-=n.peerPieces.get(e)},n.on("have",this._onWireHave),n.on("bitfield",this._onWireBitfield),n.once("close",n._onClose)}recalculate(){this._pieces.fill(0);for(const n of this._torrent.wires)for(let e=0;e<this._numPieces;++e)this._pieces[e]+=n.peerPieces.get(e)}_cleanupWireEvents(t){t.removeListener("have",this._onWireHave),t.removeListener("bitfield",this._onWireBitfield),t._onClose&&t.removeListener("close",t._onClose),t._onClose=null}}(this),this.store=new pd(new this._store(this.pieceLength,{torrent:{infoHash:this.infoHash},files:this.files.map(t=>({path:pt.join(this.path,t.path),length:t.length,offset:t.offset})),length:this.length,name:this.infoHash})),this.files=this.files.map(t=>new $d(this,t)),this.so){const r=yd.parse(this.so);this.files.forEach((e,t)=>{r.includes(t)&&this.files[t].select(!0)})}else 0!==this.pieces.length&&this.select(0,this.pieces.length-1,!1);if(this._hashes=this.pieces,this.pieces=this.pieces.map((r,e)=>{const t=e===this.pieces.length-1?this.lastPieceLength:this.pieceLength;return new md(t)}),this._reservations=this.pieces.map(()=>[]),this.bitfield=new id(this.pieces.length),this.wires.forEach(t=>{t.ut_metadata&&t.ut_metadata.setMetadata(this.metadata),this._onWireWithMetadata(t)}),this.skipVerify)this._markAllVerified(),this._onStore();else{const r=t=>t?this._destroy(t):void(this._debug("done verifying"),this._onStore());this._debug("verifying existing torrent data"),this._fileModtimes&&this._store===fd?this.getFileModtimes((e,o)=>e?this._destroy(e):void(this.files.map((n,e)=>o[e]===this._fileModtimes[e]).every(t=>t)?(this._markAllVerified(),this._onStore()):this._verifyPieces(r))):this._verifyPieces(r)}this.emit("metadata")}getFileModtimes(r){const o=[];zr(this.files.map((t,d)=>n=>{St.stat(pt.join(this.path,t.path),(t,e)=>t&&"ENOENT"!==t.code?n(t):void(o[d]=e&&e.mtime.getTime(),n(null)))}),n,e=>{this._debug("done getting file modtimes"),r(e,o)})}_verifyPieces(e){zr(this.pieces.map((e,r)=>n=>this.destroyed?n(new Error("torrent is destroyed")):void this.store.get(r,(e,t)=>this.destroyed?n(new Error("torrent is destroyed")):e?d.nextTick(n,null):void qo(t,t=>{if(this.destroyed)return n(new Error("torrent is destroyed"));if(t===this._hashes[r]){if(!this.pieces[r])return;this._debug("piece verified %s",r),this._markVerified(r)}else this._debug("piece invalid %s",r);n(null)}))),n,e)}rescanFiles(n){if(this.destroyed)throw new Error("torrent is destroyed");n||(n=l),this._verifyPieces(e=>e?(this._destroy(e),n(e)):void(this._checkDone(),n(null)))}_markAllVerified(){for(let t=0;t<this.pieces.length;t++)this._markVerified(t)}_markVerified(t){this.pieces[t]=null,this._reservations[t]=null,this.bitfield.set(t,!0)}_onStore(){this.destroyed||(this._debug("on store"),this.ready=!0,this.emit("ready"),this._checkDone(),this._updateSelections())}destroy(t){this._destroy(null,t)}_destroy(r,e){if(!this.destroyed){for(const e in this.destroyed=!0,this._debug("destroy"),this.client._remove(this),clearInterval(this._rechokeIntervalId),this._xsRequests.forEach(t=>{t.abort()}),this._rarityMap&&this._rarityMap.destroy(),this._peers)this.removePeer(e);this.files.forEach(t=>{t instanceof $d&&t._destroy()});const t=this._servers.map(n=>e=>{n.destroy(e)});this.discovery&&t.push(t=>{this.discovery.destroy(t)}),this.store&&t.push(t=>{this.store.close(t)}),Oo(t,e),r&&(0===this.listenerCount("error")?this.client.emit("error",r):this.emit("error",r)),this.emit("close"),this.client=null,this.files=[],this.discovery=null,this.store=null,this._rarityMap=null,this._peers=null,this._servers=null,this._xsRequests=null}}addPeer(r){if(this.destroyed)throw new Error("torrent is destroyed");if(!this.infoHash)throw new Error("addPeer() must not be called before the `infoHash` event");if(this.client.blocked){let e;if("string"==typeof r){let t;try{t=mr(r)}catch(e){return this._debug("ignoring peer: invalid %s",r),this.emit("invalidPeer",r),!1}e=t[0]}else"string"==typeof r.remoteAddress&&(e=r.remoteAddress);if(e&&this.client.blocked.contains(e))return this._debug("ignoring peer: blocked %s",r),"string"!=typeof r&&r.destroy(),this.emit("blockedPeer",r),!1}const e=!!this._addPeer(r);return e?this.emit("peer",r):this.emit("invalidPeer",r),e}_addPeer(r){if(this.destroyed)return"string"!=typeof r&&r.destroy(),null;if("string"==typeof r&&!this._validAddr(r))return this._debug("ignoring peer: invalid %s",r),null;const e=r&&r.id||r;if(this._peers[e])return this._debug("ignoring peer: duplicate (%s)",e),"string"!=typeof r&&r.destroy(),null;if(this.paused)return this._debug("ignoring peer: torrent is paused"),"string"!=typeof r&&r.destroy(),null;let t;return this._debug("add peer %s",e),t="string"==typeof r?Zd.createTCPOutgoingPeer(r,this):Zd.createWebRTCPeer(r,this),this._peers[t.id]=t,this._peersLength+=1,"string"==typeof r&&(this._queue.push(t),this._drain()),t}addWebSeed(n){if(this.destroyed)throw new Error("torrent is destroyed");if(!/^https?:\/\/.+/.test(n))return this.emit("warning",new Error(`ignoring invalid web seed: ${n}`)),void this.emit("invalidPeer",n);if(this._peers[n])return this.emit("warning",new Error(`ignoring duplicate web seed: ${n}`)),void this.emit("invalidPeer",n);this._debug("add web seed %s",n);const e=Zd.createWebSeedPeer(n,this);this._peers[e.id]=e,this._peersLength+=1,this.emit("peer",n)}_addIncomingPeer(t){return this.destroyed?t.destroy(new Error("torrent is destroyed")):this.paused?t.destroy(new Error("torrent is paused")):(this._debug("add incoming peer %s",t.id),this._peers[t.id]=t,void(this._peersLength+=1))}removePeer(n){const r=n&&n.id||n;(n=this._peers[r])&&(this._debug("removePeer %s",r),delete this._peers[r],this._peersLength-=1,n.destroy(),this._drain())}select(o,e,t,d){if(this.destroyed)throw new Error("torrent is destroyed");if(0>o||e<o||this.pieces.length<=e)throw new Error(`invalid selection ${o} : ${e}`);t=+t||0,this._debug("select %s-%s (priority %s)",o,e,t),this._selections.push({from:o,to:e,offset:0,priority:t,notify:d||l}),this._selections.sort((n,e)=>e.priority-n.priority),this._updateSelections()}deselect(o,e,t){if(this.destroyed)throw new Error("torrent is destroyed");t=+t||0,this._debug("deselect %s-%s (priority %s)",o,e,t);for(let n=0;n<this._selections.length;++n){const r=this._selections[n];if(r.from===o&&r.to===e&&r.priority===t){this._selections.splice(n,1);break}}this._updateSelections()}critical(r,e){if(this.destroyed)throw new Error("torrent is destroyed");this._debug("critical %s-%s",r,e);for(let t=r;t<=e;++t)this._critical[t]=!0;this._updateSelections()}_onWire(r,t){if(this._debug("got wire %s (%s)",r._debugId,t||"Unknown"),r.on("download",t=>{this.destroyed||(this.received+=t,this._downloadSpeed(t),this.client._downloadSpeed(t),this.emit("download",t),this.client.emit("download",t))}),r.on("upload",t=>{this.destroyed||(this.uploaded+=t,this._uploadSpeed(t),this.client._uploadSpeed(t),this.emit("upload",t),this.client.emit("upload",t))}),this.wires.push(r),t){const n=mr(t);r.remoteAddress=n[0],r.remotePort=n[1]}this.client.dht&&this.client.dht.listening&&r.on("port",n=>{if(!this.destroyed&&!this.client.dht.destroyed){if(!r.remoteAddress)return this._debug("ignoring PORT from peer with no address");if(0===n||65536<n)return this._debug("ignoring invalid PORT from peer");this._debug("port: %s (from %s)",n,t),this.client.dht.addNode({host:r.remoteAddress,port:n})}}),r.on("timeout",()=>{this._debug("wire timeout (%s)",t),r.destroy()}),r.setTimeout(3e4,!0),r.setKeepAlive(!0),r.use(bd(this.metadata)),r.ut_metadata.on("warning",t=>{this._debug("ut_metadata warning: %s",t.message)}),this.metadata||(r.ut_metadata.on("metadata",t=>{this._debug("got metadata via ut_metadata"),this._onMetadata(t)}),r.ut_metadata.fetch()),!0,this.emit("wire",r,t),this.metadata&&d.nextTick(()=>{this._onWireWithMetadata(r)})}_onWireWithMetadata(o){let e=null;const d=()=>{this.destroyed||o.destroyed||(this._numQueued>2*(this._numConns-this.numPeers)&&o.amInterested?o.destroy():(e=setTimeout(d,5e3)).unref&&e.unref())};let n;const a=()=>{if(o.peerPieces.buffer.length===this.bitfield.buffer.length){for(n=0;n<this.pieces.length;++n)if(!o.peerPieces.get(n))return;o.isSeeder=!0,o.choke()}};o.on("bitfield",()=>{a(),this._update()}),o.on("have",()=>{a(),this._update()}),o.once("interested",()=>{o.unchoke()}),o.once("close",()=>{clearTimeout(e)}),o.on("choke",()=>{clearTimeout(e),(e=setTimeout(d,5e3)).unref&&e.unref()}),o.on("unchoke",()=>{clearTimeout(e),this._update()}),o.on("request",(e,t,n,r)=>131072<n?o.destroy():void(this.pieces[e]||this.store.get(e,{offset:t,length:n},r))),o.bitfield(this.bitfield),o.uninterested(),o.peerExtensions.dht&&this.client.dht&&this.client.dht.listening&&o.port(this.client.dht.address().port),"webSeed"!==o.type&&(e=setTimeout(d,5e3)).unref&&e.unref(),o.isSeeder=!1,a()}_updateSelections(){this.ready&&!this.destroyed&&(d.nextTick(()=>{this._gcSelections()}),this._updateInterest(),this._update())}_gcSelections(){for(let r=0;r<this._selections.length;++r){const e=this._selections[r],t=e.offset;for(;this.bitfield.get(e.from+e.offset)&&e.from+e.offset<e.to;)e.offset+=1;t!==e.offset&&e.notify(),e.to===e.from+e.offset&&this.bitfield.get(e.from+e.offset)&&(this._selections.splice(r,1),r-=1,e.notify(),this._updateInterest())}this._selections.length||this.emit("idle")}_updateInterest(){const t=this._amInterested;this._amInterested=!!this._selections.length,this.wires.forEach(r=>{let e=!1;for(let t=0;t<this.pieces.length;++t)if(this.pieces[t]&&r.peerPieces.get(t)){e=!0;break}e?r.interested():r.uninterested()}),t!==this._amInterested&&(this._amInterested?this.emit("interested"):this.emit("uninterested"))}_update(){if(!this.destroyed){const t=(o=this.wires,d=0,function(){if(d===o.length)return null;var t=o.length-d,e=0|Math.random()*t,n=o[d+e],r=o[d];return o[d]=n,o[d+e]=r,d++,n});var o,d;for(let e;e=t();)this._updateWireWrapper(e)}}_updateWireWrapper(n){const e=this;"undefined"!=typeof window&&"function"==typeof window.requestIdleCallback?window.requestIdleCallback(function(){e._updateWire(n)}):e._updateWire(n)}_updateWire(d){function e(e,t,n,r){return o=>o>=e&&o<=t&&!(o in n)&&d.peerPieces.get(o)&&(!r||r(o))}function s(t){let e=t;for(let n=t;n<l._selections.length&&l._selections[n].priority;n++)e=n;const o=l._selections[t];l._selections[t]=l._selections[e],l._selections[e]=o}function o(t){if(d.requests.length>=m)return!0;const n=function(){const t=d.downloadSpeed()||1;if(t>u)return()=>!0;const n=to(1,d.requests.length)*md.BLOCK_LENGTH/t;let r=10,i=0;return o=>{if(!r||l.bitfield.get(o))return!0;for(let e=l.pieces[o].missing;i<l.wires.length;i++){const d=l.wires[i],a=d.downloadSpeed();if(!(a<u)&&!(a<=t)&&d.peerPieces.get(o)&&!(0<(e-=a*n)))return r--,!1}return!0}}();for(let r=0;r<l._selections.length;r++){const o=l._selections[r];let a;if("rarest"===l.strategy){const i=o.from+o.offset,c=o.to,u={};let f=0;for(const p=e(i,c,u,n);f<c-i+1&&!(0>(a=l._rarityMap.getRarestPiece(p)));){for(;l._request(d,a,l._critical[a]||t););if(!(d.requests.length<m))return o.priority&&s(r),!0;u[a]=!0,f++}}else for(a=o.from+o.offset;a<=o.to;a++)if(d.peerPieces.get(a)&&n(a)){for(;l._request(d,a,l._critical[a]||t););if(!(d.requests.length<m))return o.priority&&s(r),!0}}return!1}const l=this;if(d.peerChoking)return;if(!d.downloaded)return function(){if(!d.requests.length)for(let t=l._selections.length;t--;){const a=l._selections[t];let r;if("rarest"===l.strategy){const t=a.from+a.offset,n=a.to,o={};let i=0;for(const a=e(t,n,o);i<n-t+1&&!(0>(r=l._rarityMap.getRarestPiece(a)));){if(l._request(d,r,!1))return;o[r]=!0,i+=1}}else for(r=a.to;r>=a.from+a.offset;--r)if(d.peerPieces.get(r)&&l._request(d,r,!1))return}}();const t=g(d,.5);if(d.requests.length>=t)return;const m=g(d,1);o(!1)||o(!0)}_rechoke(){if(!this.ready)return;0<this._rechokeOptimisticTime?this._rechokeOptimisticTime-=1:this._rechokeOptimisticWire=null;const o=[];this.wires.forEach(e=>{e.isSeeder||e===this._rechokeOptimisticWire||o.push({wire:e,downloadSpeed:e.downloadSpeed(),uploadSpeed:e.uploadSpeed(),salt:Math.random(),isChoked:!0})}),o.sort(function(n,e){return n.downloadSpeed===e.downloadSpeed?n.uploadSpeed===e.uploadSpeed?n.wire.amChoking===e.wire.amChoking?n.salt-e.salt:n.wire.amChoking?1:-1:e.uploadSpeed-n.uploadSpeed:e.downloadSpeed-n.downloadSpeed});let e=0,d=0;for(;d<o.length&&e<this._rechokeNumSlots;++d)o[d].isChoked=!1,o[d].wire.peerInterested&&(e+=1);if(!this._rechokeOptimisticWire&&d<o.length&&this._rechokeNumSlots){const e=o.slice(d).filter(t=>t.wire.peerInterested),t=e[(a=e.length,0|Math.random()*a)];t&&(t.isChoked=!1,this._rechokeOptimisticWire=t.wire,this._rechokeOptimisticTime=2)}var a;o.forEach(t=>{t.wire.amChoking!==t.isChoked&&(t.isChoked?t.wire.choke():t.wire.unchoke())})}_hotswap(d,i){const e=d.downloadSpeed();if(e<md.BLOCK_LENGTH)return!1;if(!this._reservations[i])return!1;const n=this._reservations[i];if(!n)return!1;let r,l,c=1/0;for(l=0;l<n.length;l++){const o=n[l];if(!o||o===d)continue;const t=o.downloadSpeed();t>=u||2*t>e||t>c||(r=o,c=t)}if(!r)return!1;for(l=0;l<n.length;l++)n[l]===r&&(n[l]=null);for(l=0;l<r.requests.length;l++){const t=r.requests[l];t.piece===i&&this.pieces[i].cancel(0|t.offset/md.BLOCK_LENGTH)}return this.emit("hotswap",r,d,i),!0}_request(m,t,e){function n(){d.nextTick(()=>{p._update()})}const p=this,r=m.requests.length,i="webSeed"===m.type;if(p.bitfield.get(t))return!1;if(r>=(i?ao(function(r,e,t){return 1+eo(1*r.downloadSpeed()/t)}(m,0,p.pieceLength),p.maxWebConns):g(m,1)))return!1;const o=p.pieces[t];let a=i?o.reserveRemaining():o.reserve();if(-1===a&&e&&p._hotswap(m,t)&&(a=i?o.reserveRemaining():o.reserve()),-1===a)return!1;let _=p._reservations[t];_||(_=p._reservations[t]=[]);let b=_.indexOf(null);-1===b&&(b=_.length),_[b]=m;const y=o.chunkOffset(a),l=i?o.chunkLengthRemaining(a):o.chunkLength(a);return m.request(t,y,l,function d(e,r){if(p.destroyed)return;if(!p.ready)return p.once("ready",()=>{d(e,r)});if(_[b]===m&&(_[b]=null),o!==p.pieces[t])return n();if(e)return p._debug("error getting piece %s (offset: %s length: %s) from %s: %s",t,y,l,`${m.remoteAddress}:${m.remotePort}`,e.message),i?o.cancelRemaining(a):o.cancel(a),void n();if(p._debug("got piece %s (offset: %s length: %s) from %s",t,y,l,`${m.remoteAddress}:${m.remotePort}`),!o.set(a,r,m))return n();const s=o.flush();qo(s,r=>{if(!p.destroyed){if(r===p._hashes[t]){if(!p.pieces[t])return;p._debug("piece verified %s",t),p.pieces[t]=null,p._reservations[t]=null,p.bitfield.set(t,!0),p.store.put(t,s),p.wires.forEach(n=>{n.have(t)}),p._checkDone()&&!p.destroyed&&p.discovery.complete()}else p.pieces[t]=new md(o.length),p.emit("warning",new Error(`Piece ${t} failed verification`));n()}})}),!0}_checkDone(){if(this.destroyed)return;this.files.forEach(n=>{if(!n.done){for(let e=n._startPiece;e<=n._endPiece;++e)if(!this.bitfield.get(e))return;n.done=!0,n.emit("done"),this._debug(`file done: ${n.name}`)}});let r=!0;for(let e=0;e<this._selections.length;e++){const o=this._selections[e];for(let e=o.from;e<=o.to;e++)if(!this.bitfield.get(e)){r=!1;break}if(!r)break}return!this.done&&r&&(this.done=!0,this._debug(`torrent done: ${this.infoHash}`),this.emit("done")),this._gcSelections(),r}load(o,d){if(this.destroyed)throw new Error("torrent is destroyed");if(!this.ready)return this.once("ready",()=>{this.load(o,d)});Array.isArray(o)||(o=[o]),d||(d=l);const a=new hd(o),n=new sd(this.store,this.pieceLength);Yr(a,n,t=>t?d(t):void(this._markAllVerified(),this._checkDone(),d(null)))}createServer(t){throw new Error("node.js-only method")}pause(){this.destroyed||(this._debug("pause"),this.paused=!0)}resume(){this.destroyed||(this._debug("resume"),this.paused=!1,this._drain())}_debug(){const n=[].slice.call(arguments);n[0]=`[${this.client._debugId}] [${this._debugId}] ${n[0]}`,t(...n)}_drain(){if(this._debug("_drain numConns %s maxConns %s",this._numConns,this.client.maxConns),"function"!=typeof oe.connect||this.destroyed||this.paused||this._numConns>=this.client.maxConns)return;this._debug("drain (%s queued, %s/%s peers)",this._numQueued,this.numPeers,this.client.maxConns);const o=this._queue.shift();if(o){this._debug("tcp connect attempt to %s",o.addr);const e=mr(o.addr),t={host:e[0],port:e[1]},n=o.conn=oe.connect(t);n.once("connect",()=>{o.onConnect()}),n.once("error",e=>{o.destroy(e)}),o.startConnectTimeout(),n.on("close",()=>{if(!this.destroyed){if(o.retries>=r.length)return void this._debug("conn %s closed: will not re-add (max %s attempts)",o.addr,r.length);const e=r[o.retries];this._debug("conn %s closed: will re-add to queue in %sms (attempt %s)",o.addr,e,o.retries+1);const t=setTimeout(()=>{const e=this._addPeer(o.addr);e&&(e.retries=o.retries+1)},e);t.unref&&t.unref()}})}}_validAddr(o){let e;try{e=mr(o)}catch(e){return!1}const d=e[0],n=e[1];return 0<n&&65535>n&&("127.0.0.1"!==d||n!==this.client.torrentPort)}}}).call(this,pe,"undefined"==typeof global?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:global);var ra={};return function(d,e,t){const{EventEmitter:n}=m,r=jo("webtorrent"),l="0.107.0".replace(/\d*./g,t=>`0${t%100}`.slice(-2)).slice(0,4);class o extends n{constructor(n={}){super(),this.peerId="string"==typeof n.peerId?n.peerId:t.isBuffer(n.peerId)?n.peerId.toString("hex"):t.from(`-WW${l}-`+ur(9).toString("base64")).toString("hex"),this.peerIdBuffer=t.from(this.peerId,"hex"),this.nodeId="string"==typeof n.nodeId?n.nodeId:t.isBuffer(n.nodeId)?n.nodeId.toString("hex"):ur(20).toString("hex"),this.nodeIdBuffer=t.from(this.nodeId,"hex"),this._debugId=this.peerId.toString("hex").substring(0,7),this.destroyed=!1,this.listening=!1,this.torrentPort=n.torrentPort||0,this.dhtPort=n.dhtPort||0,this.tracker=void 0===n.tracker?{}:n.tracker,this.torrents=[],this.maxConns=+n.maxConns||55,this._debug("new webtorrent (peerId %s, nodeId %s, port %s)",this.peerId,this.nodeId,this.torrentPort),this.tracker&&("object"!=typeof this.tracker&&(this.tracker={}),n.rtcConfig&&(console.warn("WebTorrent: opts.rtcConfig is deprecated. Use opts.tracker.rtcConfig instead"),this.tracker.rtcConfig=n.rtcConfig),n.wrtc&&(console.warn("WebTorrent: opts.wrtc is deprecated. Use opts.tracker.wrtc instead"),this.tracker.wrtc=n.wrtc),e.WRTC&&!this.tracker.wrtc&&(this.tracker.wrtc=e.WRTC)),d.nextTick(()=>{this._onListening()}),this._downloadSpeed=gr(),this._uploadSpeed=gr(),!1!==n.dht&&!1?(this.dht=new oe(Object.assign({},{nodeId:this.nodeId},n.dht)),this.dht.once("error",t=>{this._destroy(t)}),this.dht.once("listening",()=>{const t=this.dht.address();t&&(this.dhtPort=t.port)}),this.dht.setMaxListeners(0),this.dht.listen(this.dhtPort)):this.dht=!1,this.enableWebSeeds=!1!==n.webSeeds;const r=()=>{this.destroyed||(this.ready=!0,this.emit("ready"))};d.nextTick(r)}get downloadSpeed(){return this._downloadSpeed()}get uploadSpeed(){return this._uploadSpeed()}get progress(){const t=this.torrents.filter(t=>1!==t.progress);return t.reduce((n,e)=>n+e.downloaded,0)/(t.reduce((n,e)=>n+(e.length||0),0)||1)}get ratio(){return this.torrents.reduce((n,e)=>n+e.uploaded,0)/(this.torrents.reduce((n,e)=>n+e.received,0)||1)}get(t){if(!(t instanceof na)){let n;try{n=Zo(t)}catch(e){}if(!n)return null;if(!n.infoHash)throw new Error("Invalid torrent identifier");for(const t of this.torrents)if(t.infoHash===n.infoHash)return t}else if(this.torrents.includes(t))return t;return null}download(r,e,t){return console.warn("WebTorrent: client.download() is deprecated. Use client.add() instead"),this.add(r,e,t)}add(o,e={},d){if(this.destroyed)throw new Error("client is destroyed");"function"==typeof e&&([e,d]=[{},e]);const a=()=>{if(!this.destroyed)for(const t of this.torrents)if(t.infoHash===i.infoHash&&t!==i)return void i._destroy(new Error(`Cannot add duplicate torrent ${i.infoHash}`))},r=()=>{this.destroyed||("function"==typeof d&&d(i),this.emit("torrent",i))};this._debug("add"),e=e?Object.assign({},e):{};const i=new na(o,this,e);return this.torrents.push(i),i.once("_infoHash",a),i.once("ready",r),i.once("close",function t(){i.removeListener("_infoHash",a),i.removeListener("ready",r),i.removeListener("close",t)}),i}seed(o,d,c){if(this.destroyed)throw new Error("client is destroyed");"function"==typeof d&&([d,c]=[{},d]),this._debug("seed"),(d=d?Object.assign({},d):{}).skipVerify=!0;const u="string"==typeof o;u&&(d.path=pt.dirname(o)),d.createdBy||(d.createdBy=`WebTorrent/${l}`);const r=t=>{this._debug("on seed"),"function"==typeof c&&c(t),t.emit("seed"),this.emit("seed",t)},i=this.add(null,d,n=>{const e=[e=>u?e():void n.load(s,e)];this.dht&&e.push(e=>{n.once("dhtAnnounce",e)}),Oo(e,e=>{if(!this.destroyed)return e?n._destroy(e):void r(n)})});let s;return"undefined"!=typeof FileList&&o instanceof FileList?o=Array.from(o):Array.isArray(o)||(o=[o]),Oo(o.map(n=>e=>{(function(){return"object"==typeof n&&null!=n&&"function"==typeof n.pipe})()?q(n,e):e(null,n)}),(t,o)=>{if(!this.destroyed)return t?i._destroy(t):void Wo.parseInput(o,d,(t,e)=>{if(!this.destroyed){if(t)return i._destroy(t);s=e.map(t=>t.getStream),Wo(o,d,(r,e)=>{if(!this.destroyed){if(r)return i._destroy(r);const t=this.get(e);t?i._destroy(new Error(`Cannot add duplicate torrent ${t.infoHash}`)):i._onTorrentId(e)}})}})}),i}remove(n,e){if(this._debug("remove"),!this.get(n))throw new Error(`No torrent with id ${n}`);this._remove(n,e)}_remove(r,e){const t=this.get(r);t&&(this.torrents.splice(this.torrents.indexOf(t),1),t.destroy(e))}address(){return this.listening?this._tcpPool?this._tcpPool.server.address():{address:"0.0.0.0",family:"IPv4",port:0}:null}destroy(t){if(this.destroyed)throw new Error("client already destroyed");this._destroy(null,t)}_destroy(r,e){this._debug("client destroy"),this.destroyed=!0;const t=this.torrents.map(n=>e=>{n.destroy(e)});this._tcpPool&&t.push(t=>{this._tcpPool.destroy(t)}),this.dht&&t.push(t=>{this.dht.destroy(t)}),Oo(t,e),r&&this.emit("error",r),this.torrents=[],this._tcpPool=null,this.dht=null}_onListening(){if(this._debug("listening"),this.listening=!0,this._tcpPool){const t=this._tcpPool.server.address();t&&(this.torrentPort=t.port)}this.emit("listening")}_debug(){const t=[].slice.call(arguments);t[0]=`[${this._debugId}] ${t[0]}`,r(...t)}}o.WEBRTC_SUPPORT=td.WEBRTC_SUPPORT,o.VERSION="0.107.0",ra=o}.call(this,pe,"undefined"==typeof global?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:global,p({}).Buffer),ra});