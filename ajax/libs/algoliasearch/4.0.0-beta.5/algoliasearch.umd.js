!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).algoliasearch=t()}(this,(function(){"use strict";function e(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function t(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function r(r){for(var n=1;n<arguments.length;n++){var o=null!=arguments[n]?arguments[n]:{};n%2?t(Object(o),!0).forEach((function(t){e(r,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):t(Object(o)).forEach((function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(o,e))}))}return r}function n(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},u=Object.keys(e);for(n=0;n<u.length;n++)r=u[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);for(n=0;n<u.length;n++)r=u[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var r=[],n=!0,o=!1,u=void 0;try{for(var a,i=e[Symbol.iterator]();!(n=(a=i.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,u=e}finally{try{n||null==i.return||i.return()}finally{if(o)throw u}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var u={Debug:1,Info:2,Error:3};function a(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{debug:function(e,t){return Promise.resolve()},info:function(e,t){return Promise.resolve()},error:function(e,t){return Promise.resolve()}},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:window.localStorage,n="algoliasearch-client-js-".concat(e),o="LocalStorage is not available or json could not be decoded.",u=function(){return JSON.parse(r.getItem(n)||"{}")};return{get:function(e,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{miss:function(){return Promise.resolve()}};try{var a=JSON.stringify(e),i=u()[a];if(void 0!==i)return Promise.resolve(i)}catch(e){t.debug(o)}var s=r();return s.then((function(e){return n.miss(e)})).then((function(){return s}))},set:function(e,a){try{var i=u();i[JSON.stringify(e)]=a,r.setItem(n,JSON.stringify(i))}catch(e){t.debug(o)}return Promise.resolve(a)},delete:function(e){try{var a=u();delete a[JSON.stringify(e)],r.setItem(n,JSON.stringify(a))}catch(e){t.debug(o)}return Promise.resolve()},clear:function(){try{r.removeItem(n)}catch(e){t.debug(o)}return Promise.resolve()}}}function i(){var e={};return{get:function(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{miss:function(){return Promise.resolve()}},o=JSON.stringify(t);if(o in e)return Promise.resolve(e[o]);var u=r(),a=n&&n.miss||function(){return Promise.resolve()};return u.then((function(e){return a(e)})).then((function(){return u}))},set:function(t,r){return e[JSON.stringify(t)]=r,Promise.resolve(r)},delete:function(t){return delete e[JSON.stringify(t)],Promise.resolve()},clear:function(){return e={},Promise.resolve()}}}function s(e,t,r){var n={"x-algolia-api-key":r,"x-algolia-application-id":t};return{headers:function(){return e===p.WithinHeaders?n:{}},queryParameters:function(){return e===p.WithinQueryParameters?n:{}}}}function c(e){var t=0;return e((function r(){return t++,new Promise((function(n){setTimeout((function(){n(e(r))}),Math.min(100*t,1e3))}))}))}function f(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e,t){return Promise.resolve()};return Object.assign(e,{wait:function(r){return f(e.then((function(e){return Promise.all([t(e,r),e])})).then((function(e){return e[1]})))}})}function d(e,t){return Object.keys(void 0!==t?t:{}).forEach((function(r){e[r]=t[r](e)})),e}function l(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var o=0;return e.replace(/%s/g,(function(){return encodeURIComponent(r[o++])}))}var h="4.0.0-beta.5",p={WithinQueryParameters:0,WithinHeaders:1},m=3e5;var y=function(e,t,r){return function(e){var t=e.status;return e.isTimedOut||function(e){var t=e.isTimedOut,r=e.status;return!t&&0==~~r}(e)||2!=~~(t/100)&&4!=~~(t/100)}(t)?(t.isTimedOut||e.setAsDown(),r.onRetry(t)):2==~~(t.status/100)?r.onSucess(t):r.onFail(t)};function g(e,t,n,o){var u=[],a=0,i=function(e,t){var n=Array.isArray(e.data)?e.data:r({},e.data,{},t.data);if(n.constructor===Object&&0===Object.entries(n).length)return"";return JSON.stringify(n)}(n,o),s=r({},e.headers,{},o.headers),c=n.method,f=function t(f){var d=f.pop();if(void 0===d)throw function(e){return{name:"RetryError",message:"Unreachable hosts - your application id may be incorrect. If the error persists, contact support@algolia.com.",stackTrace:e}}(u);var l=a+1,h={data:i,headers:s,method:c,url:P(d,n.path,r({},e.queryParameters,{},o.queryParameters,{"x-algolia-agent":e.userAgent.value})),connectTimeout:l*e.timeouts.connect,socketTimeout:l*(o.timeout||0)},p={onSucess:function(e){return function(e){try{return JSON.parse(e.content)}catch(t){throw function(e,t){return{name:"DeserializationError",message:e,response:t}}(t.message,e)}}(e)},onRetry:function(r){var n={request:h,response:r,host:d,triesLeft:f.length,timeoutRetries:a};return u.push(n),r.isTimedOut&&a++,Promise.all([e.logger.debug("Retryable failure",n),e.hostsCache.set({url:d.url},d)]).then((function(){return t(f)}))},onFail:function(e){throw function(e){var t=e.content,r=e.status,n=t;try{n=JSON.parse(t).message}catch(e){}return function(e,t){return{name:"ApiError",message:e,status:t}}(n,r)}(e)}};return e.requester.send(h).then((function(e){return y(d,e,p)}))};return function(e,t){return Promise.all(t.map((function(t){return e.get({url:t.url},(function(){return Promise.resolve(t)})).then((function(e){return Object.assign(t,{downDate:e.downDate,up:e.up})}))}))).then((function(e){return e.filter((function(e){return e.isUp()})).reverse()}))}(e.hostsCache,t).then((function(e){return f(e)}))}function v(e){var t={hostsCache:e.hostsCache,logger:e.logger,requester:e.requester,requestsCache:e.requestsCache,responsesCache:e.responsesCache,timeouts:e.timeouts,userAgent:e.userAgent,headers:{},queryParameters:{},hosts:[],addHeaders:function(e){Object.assign(t.headers,e)},addQueryParameters:function(e){Object.assign(t.queryParameters,e)},setHosts:function(e){t.hosts=e.map((function(e){return function(e){var t={protocol:e.protocol||"https",url:e.url,accept:e.accept,downDate:0,up:!0,setAsDown:function(){t.downDate=Date.now(),t.up=!1},isUp:function(){return!t.up&&Date.now()-t.downDate>m&&(t.up=!0),t.up}};return t}(e)}))},read:function(e,r){var n=O(r,t.timeouts.read),o={request:e,mappedRequestOptions:n},u=function(){return g(t,t.hosts.filter((function(e){return 0!=(e.accept&w.Read)})),e,n)};return!0!==(void 0!==n.cacheable?n.cacheable:e.cacheable)?u():t.responsesCache.get(o,(function(){return t.requestsCache.get(o,(function(){return t.requestsCache.set(o,u()).then((function(e){return Promise.all([t.requestsCache.delete(o),e])}),(function(e){return Promise.all([t.requestsCache.delete(o),Promise.reject(e)])})).then((function(e){return e[1]}))}))}),{miss:function(e){return t.responsesCache.set(o,e)}})},write:function(e,r){return g(t,t.hosts.filter((function(e){return 0!=(e.accept&w.Write)})),e,O(r,t.timeouts.write))}};return t}function b(e){var t={value:"Algolia for JavaScript (".concat(e,")"),add:function(e){return t.value="".concat(t.value,"; ").concat(e.segment).concat(void 0!==e.version?" (".concat(e.version,")"):""),t}};return t}function O(e,t){var r=e||{},n={};return Object.keys(r).forEach((function(e){-1===["timeout","headers","queryParameters","data","cacheable"].indexOf(e)&&(n[e]=r[e])})),{data:n,timeout:r.timeout||t,headers:r.headers||{},queryParameters:r.queryParameters||{},cacheable:r.cacheable}}function j(e,t,r){if(void 0!==e&&t in e){var n=e[t];return delete e[t],n}return r}function P(e,t,r){var n=x(r),o="".concat(e.protocol,"://").concat(e.url,"/").concat("/"===t.charAt(0)?t.substr(1):t);return n.length&&(o+="?".concat(n)),o}function x(e){return Object.keys(e).map((function(t){return l("%s=%s",t,(r=e[t],"[object Object]"===Object.prototype.toString.call(r)||"[object Array]"===Object.prototype.toString.call(r)?JSON.stringify(e[t]):e[t]));var r})).join("&")}var w={Read:1,Write:2,Any:3},I=function(e){var t=e.region||"us",n=s(p.WithinHeaders,e.appId,e.apiKey),o=v(e),u=e.appId;return o.setHosts([{url:"analytics.".concat(t,".algolia.com"),accept:w.Any}]),o.addHeaders(r({},n.headers(),{},{"content-type":"application/json"})),o.addQueryParameters(n.queryParameters()),d({appId:u,transporter:o},e.methods)},D="DELETE",S="GET",k="POST",q="PUT",N=function(e){return function(t,r){return e.transporter.write({method:k,path:"2/abtests",data:t},r)}},A=function(e){return function(t,r){return e.transporter.write({method:D,path:l("2/abtests/%s",t)},r)}},T=function(e){return function(t,r){return e.transporter.read({method:S,path:l("2/abtests/%s",t)},r)}},R=function(e){return function(t){return e.transporter.read({method:S,path:"2/abtests"},t)}},E=function(e){return function(t,r){return e.transporter.write({method:k,path:l("2/abtests/%s/stop",t)},r)}};function C(e){return new Promise((function(t){var r={page:0};return function n(){return e.request(r).then((function(o){return void 0!==e.batch&&e.batch(o.hits),e.shouldStop(o)?t():(r.page++,n())}))}()}))}var U=function(e){var t=e.appId,n=v(e);n.setHosts([{url:"".concat(t,"-dsn.algolia.net"),accept:w.Read},{url:"".concat(t,".algolia.net"),accept:w.Write}].concat(function(e){for(var t=e.length-1;t>0;t--){var r=Math.floor(Math.random()*(t+1)),n=e[t];e[t]=e[r],e[r]=n}return e}([{url:"".concat(t,"-1.algolianet.com"),accept:w.Any},{url:"".concat(t,"-2.algolianet.com"),accept:w.Any},{url:"".concat(t,"-3.algolianet.com"),accept:w.Any}])));var o=s(void 0!==e.authMode?e.authMode:p.WithinHeaders,t,e.apiKey);return n.addHeaders(r({},o.headers(),{},{"content-type":"application/x-www-form-urlencoded"})),n.addQueryParameters(o.queryParameters()),d({transporter:n,appId:t,addAlgoliaAgent:function(e,t){n.userAgent.add({segment:e,version:t})}},e.methods)};var H=function(e){return function(t,n){var o=j(n,"queryParameters"),u=r({acl:t},void 0!==o?{queryParameters:o}:{});return f(e.transporter.write({method:k,path:"1/keys",data:u},n),(function(t,r){return c((function(n){return K(e)(t.key,r).catch((function(e){if(404===e.status)throw e;return n()}))}))}))}},J=function(e){return function(t,r,n){return f(e.transporter.write({method:k,path:l("1/indexes/%s/operation",t),data:{operation:"copy",destination:r}},n),(function(r,n){return z(e)(t,{methods:{waitTask:Be}}).waitTask(r.taskID,n)}))}},F=function(e){return function(t,n,o){return J(e)(t,n,r({},void 0===o?{}:o,{scope:[We.Settings]}))}},Q=function(e){return function(t,n,o){return J(e)(t,n,r({},void 0===o?{}:o,{scope:[We.Synonyms]}))}},B=function(e){return function(t,r){return f(e.transporter.write({method:D,path:l("1/keys/%s",t)},r),(function(r,n){return c((function(r){return K(e)(t,n).catch((function(e){if(404!==e.status)throw e})).then(r)}))}))}},K=function(e){return function(t,r){return e.transporter.read({method:S,path:l("1/keys/%s",t)},r)}},W=function(e){return function(t){var r=j(t,"length"),n=j(t,"offset"),o=j(t,"type"),u=O(t);return void 0!==r&&(u.queryParameters.length=r),void 0!==n&&(u.queryParameters.offset=n),void 0!==o&&(u.queryParameters.type=o),e.transporter.read({method:S,path:"1/logs"},u)}},M=function(e){return function(t){return e.transporter.read({method:S,path:"1/recommendation/personalization/strategy"},t)}},z=function(e){return function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n={transporter:e.transporter,appId:e.appId,indexName:t};return d(n,r.methods)}},L=function(e){return function(t){return e.transporter.read({method:S,path:"1/keys"},t)}},V=function(e){return function(t){return e.transporter.read({method:S,path:"1/clusters"},t)}},G=function(e){return function(t){return e.transporter.read({method:S,path:"1/indexes"},t)}},_=function(e){return function(t,r,n){return f(e.transporter.write({method:k,path:l("1/indexes/%s/operation",t),data:{operation:"move",destination:r}},n),(function(r,n){return z(e)(t,{methods:{waitTask:Be}}).waitTask(r.taskID,n)}))}},X=function(e){return function(t,r){return f(e.transporter.write({method:k,path:"1/indexes/*/batch",data:{requests:t}},r),(function(t,r){return Promise.all(Object.keys(t.taskID).map((function(n){return z(e)(n,{methods:{waitTask:Be}}).waitTask(t.taskID[n],r)})))}))}},Y=function(e){return function(t,r){return e.transporter.read({method:k,path:"1/indexes/*/objects",data:{requests:t}},r)}},Z=function(e){return function(t,n){var o=t.map((function(e){return r({},e,{params:x(e.params||{})})}));return e.transporter.read({method:k,path:"1/indexes/*/queries",data:{requests:o},cacheable:!0},n)}},$=function(e){return function(t,o){return Promise.all(t.map((function(t){var u=t.params,a=u.facetName,i=u.facetQuery,s=n(u,["facetName","facetQuery"]);return z(e)(t.indexName,{methods:{searchForFacetValues:He}}).searchForFacetValues(a,i,r({},o,{},s))})))}},ee=function(e){return function(t,r){return f(e.transporter.write({method:k,path:l("1/keys/%s/restore",t)},r),(function(r,n){return c((function(r){return K(e)(t,n).catch((function(e){if(404!==e.status)throw e;return r()}))}))}))}},te=function(e){return function(t,r){return e.transporter.write({method:k,path:"1/recommendation/personalization/strategy",data:t},r)}},re=function(e){return function(t,r){var n=Object.assign({},r),o=j(r,"queryParameters"),u=o?{queryParameters:o}:{},a=["acl","indexes","referers","restrictSources","queryParameters","description","maxQueriesPerIPPerHour","maxHitsPerQuery"];return f(e.transporter.write({method:q,path:l("1/keys/%s",t),data:u},r),(function(r,o){return c((function(r){return K(e)(t,o).then((function(e){return function(e){return Object.keys(n).filter((function(e){return-1!==a.indexOf(e)})).every((function(t){return e[t]===n[t]}))}(e)?Promise.resolve():r()}))}))}))}},ne=function(e){return function(t,r){return f(e.transporter.write({method:k,path:l("1/indexes/%s/batch",e.indexName),data:{requests:t}},r),(function(t,r){return Be(e)(t.taskID,r)}))}},oe=function(e){return function(t){return C(r({},t,{shouldStop:function(e){return void 0===e.cursor},request:function(r){return e.transporter.read({method:k,path:l("1/indexes/%s/browse",e.indexName),data:r},t)}}))}},ue=function(e){return function(t){var n=r({hitsPerPage:1e3},t);return C(r({},n,{shouldStop:function(e){return e.hits.length<n.hitsPerPage},request:function(n){return Je(e)("",r({},t,{},n)).then((function(e){return r({},e,{hits:e.hits.map((function(e){return delete e._highlightResult,e}))})}))}}))}},ae=function(e){return function(t){var n=r({hitsPerPage:1e3},t);return C(r({},n,{shouldStop:function(e){return e.hits.length<n.hitsPerPage},request:function(n){return Fe(e)("",r({},t,{},n)).then((function(e){return r({},e,{hits:e.hits.map((function(e){return delete e._highlightResult,e}))})}))}}))}},ie=function(e){return function(t,r,n){var o=j(n,"batchSize",1e3),u=[];return f(function a(){var i,s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,c=[];for(i=s;i<t.length&&(c.push(t[i]),c.length!==o);i++);return 0===c.length?Promise.resolve(u):ne(e)(c.map((function(e){return{action:r,body:e}})),n).then((function(e){return u.push(e),i++,a(i)}))}(),(function(t,r){return Promise.all(t.map((function(t){return Be(e)(t.taskID,r)})))}))}},se=function(e){return function(t){return f(e.transporter.write({method:k,path:l("1/indexes/%s/clear",e.indexName)},t),(function(t,r){return Be(e)(t.taskID,r)}))}},ce=function(e){return function(t){return f(e.transporter.write({method:k,path:l("1/indexes/%s/rules/clear",e.indexName)},t),(function(t,r){return Be(e)(t.taskID,r)}))}},fe=function(e){return function(t){return f(e.transporter.write({method:k,path:l("1/indexes/%s/synonyms/clear",e.indexName)},t),(function(t,r){return Be(e)(t.taskID,r)}))}},de=function(e){return function(t,r){return f(e.transporter.write({method:k,path:l("1/indexes/%s/deleteByQuery",e.indexName),data:t},r),(function(t,r){return Be(e)(t.taskID,r)}))}},le=function(e){return function(t){return f(e.transporter.write({method:D,path:l("1/indexes/%s",e.indexName)},t),(function(t,r){return Be(e)(t.taskID,r)}))}},he=function(e){return function(t,r){return f(pe(e)([t],r).then((function(e){return{taskID:e[0].taskID}})),(function(t,r){return Be(e)(t.taskID,r)}))}},pe=function(e){return function(t,r){var n=t.map((function(e){return{objectID:e}}));return ie(e)(n,Ke.DeleteObject,r)}},me=function(e){return function(t,r){return f(e.transporter.write({method:D,path:l("1/indexes/%s/rules/%s",e.indexName,t)},r),(function(t,r){return Be(e)(t.taskID,r)}))}},ye=function(e){return function(t,r){return f(e.transporter.write({method:D,path:l("1/indexes/%s/synonyms/%s",e.indexName,t)},r),(function(t,r){return Be(e)(t.taskID,r)}))}},ge=function(e){return function(t){return xe(e)(t).then((function(){return!0})).catch((function(e){if(404!==e.status)throw e;return!1}))}},ve=function(e){return function(t,n){var u=j(n,"paginate",!0),a=j(n,"query",""),i=0;return function s(){return Ue(e)(a,r({},n,{page:i})).then((function(e){for(var r=0,n=Object.entries(e.hits);r<n.length;r++){var a=o(n[r],2),c=a[0],f=a[1];if(t(f))return{object:f,position:parseInt(c,10),page:i}}if(i++,!u||i>=e.nbPages)throw{name:"ObjectNotFoundError",message:"Object not found."};return s()}))}()}},be=function(e){return function(t,r){return e.transporter.read({method:S,path:l("1/indexes/%s/%s",e.indexName,t)},r)}},Oe=function(){return function(e,t){for(var r=0,n=Object.entries(e.hits);r<n.length;r++){var u=o(n[r],2),a=u[0];if(u[1].objectID===t)return parseInt(a,10)}return-1}},je=function(e){return function(t,r){var n=t.map((function(t){return{indexName:e.indexName,objectID:t,attributesToRetrieve:j(r,"attributesToRetrieve","*")}}));return e.transporter.read({method:k,path:"1/indexes/*/objects",data:{requests:n}},r)}},Pe=function(e){return function(t,r){return e.transporter.read({method:S,path:l("1/indexes/%s/rules/%s",e.indexName,t)},r)}},xe=function(e){return function(t){var r=O(t);return r.queryParameters.getVersion="2",e.transporter.read({method:S,path:l("1/indexes/%s/settings",e.indexName)},r)}},we=function(e){return function(t,r){return e.transporter.read({method:S,path:l("1/indexes/%s/synonyms/%s",e.indexName,t)},r)}},Ie=function(e){return function(t,r){return f(De(e)([t],r).then((function(e){return{objectID:e[0].objectIDs[0],taskID:e[0].taskID}})),(function(t,r){return Be(e)(t.taskID,r)}))}},De=function(e){return function(t,r){var n=j(r,"createIfNotExists",!1)?Ke.PartialUpdateObject:Ke.PartialUpdateObjectNoCreate;return ie(e)(t,n,r)}},Se=function(e){return function(t,n){var o=function(t,r,n,o){return f(e.transporter.write({method:k,path:l("1/indexes/%s/operation",t),data:{operation:n,destination:r}},o),(function(t,r){return Be(e)(t.taskID,r)}))},u=j(n,"safe",!1),a=Math.random().toString(36).substring(7),i="".concat(e.indexName,"_tmp_").concat(a),s=Ne({appId:e.appId,transporter:e.transporter,indexName:i}),c=[],d=o(e.indexName,i,"copy",r({},n,{scope:["settings","synonyms","rules"]}));return c.push(d),f((u?d.wait(n):d).then((function(){var e=s(t,n);return c.push(e),u?e.wait(n):e})).then((function(){var t=o(i,e.indexName,"move",n);return c.push(t),u?t.wait(n):t})).then((function(){return Promise.resolve()})),(function(e,t){return Promise.all(c.map((function(e){return e.wait(t)})))}))}},ke=function(e){return function(t,n){return Re(e)(t,r({},n,{clearExistingRules:!0}))}},qe=function(e){return function(t,n){return Ce(e)(t,r({},void 0===n?{}:n,{replaceExistingSynonyms:!0}))}},Ne=function(e){return function(t,r){var n=j(r,"autoGenerateObjectIDIfNotExist",!1)?Ke.AddObject:Ke.UpdateObject;if(n===Ke.UpdateObject){var o=!0,u=!1,a=void 0;try{for(var i,s=t[Symbol.iterator]();!(o=(i=s.next()).done);o=!0){if(void 0===i.value.objectID)return f(Promise.reject({name:"MissingObjectIDError",message:"All objects must have an unique objectID (like a primary key) to be valid. Algolia is also able to generate objectIDs automatically but *it's not recommended*. To do it, use `saveObjects(objects, {'autoGenerateObjectIDIfNotExist': true})`."}))}}catch(e){u=!0,a=e}finally{try{o||null==s.return||s.return()}finally{if(u)throw a}}}return ie(e)(t,n,r)}},Ae=function(e){return function(t,r){return f(Ne(e)([t],r).then((function(e){return{objectID:e[0].objectIDs[0],taskID:e[0].taskID}})),(function(t,r){return Be(e)(t.taskID,r)}))}},Te=function(e){return function(t,r){return f(e.transporter.write({method:q,path:l("1/indexes/%s/rules/%s",e.indexName,t.objectID),data:t},r),(function(t,r){return Be(e)(t.taskID,r)}))}},Re=function(e){return function(t,r){var n=O(r);return!0===j(r,"clearExistingRules",!1)&&(n.queryParameters.clearExistingRules="true"),f(e.transporter.write({method:k,path:l("1/indexes/%s/rules/batch",e.indexName),data:t},n),(function(t,r){return Be(e)(t.taskID,r)}))}},Ee=function(e){return function(t,r){return Ce(e)([t],r)}},Ce=function(e){return function(t,r){var n=j(r,"forwardToReplicas",void 0),o=j(r,"replaceExistingSynonyms",void 0),u=O(r);return!0===n&&(u.queryParameters.forwardToReplicas="1"),!0===o&&(u.queryParameters.replaceExistingSynonyms="1"),f(e.transporter.write({method:k,path:l("1/indexes/%s/synonyms/batch",e.indexName),data:t},u),(function(t,r){return Be(e)(t.taskID,r)}))}},Ue=function(e){return function(t,r){return e.transporter.read({method:k,path:l("1/indexes/%s/query",e.indexName),data:{query:t},cacheable:!0},r)}},He=function(e){return function(t,r,n){return e.transporter.read({method:k,path:l("1/indexes/%s/facets/%s/query",e.indexName,t),data:{facetQuery:r},cacheable:!0},n)}},Je=function(e){return function(t,r){return e.transporter.read({method:k,path:l("1/indexes/%s/rules/search",e.indexName),data:{query:t}},r)}},Fe=function(e){return function(t,r){return e.transporter.read({method:k,path:l("1/indexes/%s/synonyms/search",e.indexName),data:{query:t}},r)}},Qe=function(e){return function(t,r){return f(e.transporter.write({method:q,path:l("1/indexes/%s/settings",e.indexName),data:t},r),(function(t,r){return Be(e)(t.taskID,r)}))}},Be=function(e){return function(t,r){return c((function(n){return function(e){return function(t,r){return e.transporter.read({method:S,path:l("1/indexes/%s/task/%s",e.indexName,t.toString())},r)}}(e)(t,r).then((function(e){return"published"!==e.status?n():void 0}))}))}},Ke={AddObject:"addObject",UpdateObject:"updateObject",PartialUpdateObject:"partialUpdateObject",PartialUpdateObjectNoCreate:"partialUpdateObjectNoCreate",DeleteObject:"deleteObject"},We={Settings:"settings",Synonyms:"synonyms",Rules:"rules"};return function(e,t){var n,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=(n=o.logLevel||u.Error,{debug:function(e,t){return u.Debug>=n&&console.debug(e,t),Promise.resolve()},info:function(e,t){return u.Info>=n&&console.info(e,t),Promise.resolve()},error:function(e,t){return console.error(e,t),Promise.resolve()}}),c={appId:e,apiKey:t,timeouts:{connect:1,read:2,write:30},requester:{send:function(e){return new Promise((function(t){var r=new XMLHttpRequest;r.open(e.method,e.url,!0),Object.keys(e.headers).forEach((function(t){return r.setRequestHeader(t,e.headers[t])}));var n,o=function(e,n){return setTimeout((function(){r.abort(),t({status:0,content:n,isTimedOut:!0})}),1e3*e)},u=o(e.connectTimeout,"Connection timeout");r.onreadystatechange=function(){r.readyState>r.OPENED&&void 0===n&&(clearTimeout(u),n=o(e.socketTimeout,"Socket timeout"))},r.onerror=function(){0===r.status&&(clearTimeout(u),clearTimeout(n),t({content:r.responseText||"Network request failed",status:r.status,isTimedOut:!1}))},r.onload=function(){clearTimeout(u),clearTimeout(n),t({content:r.responseText,status:r.status,isTimedOut:!1})},r.send(e.data)}))}},logger:s,responsesCache:i(),requestsCache:i(),hostsCache:a(h,s),userAgent:b(h).add({segment:"Browser"})};return U(r({},c,{methods:{search:Z,searchForFacetValues:$,multipleBatch:X,multipleGetObjects:Y,multipleQueries:Z,copyIndex:J,copySettings:F,copySynonyms:Q,moveIndex:_,getPersonalizationStrategy:M,setPersonalizationStrategy:te,listIndices:G,getLogs:W,listClusters:V,multipleSearchForFacetValues:$,getApiKey:K,addApiKey:H,listApiKeys:L,updateApiKey:re,deleteApiKey:B,restoreApiKey:ee,initIndex:function(e){return function(t){return z(e)(t,{methods:{batch:ne,delete:le,getObject:be,getObjects:je,saveObject:Ae,saveObjects:Ne,search:Ue,searchForFacetValues:He,waitTask:Be,setSettings:Qe,getSettings:xe,partialUpdateObject:Ie,partialUpdateObjects:De,deleteObject:he,deleteObjects:pe,deleteBy:de,clearObjects:se,browseObjects:oe,getObjectPosition:Oe,findObject:ve,exists:ge,saveSynonym:Ee,saveSynonyms:Ce,getSynonym:we,searchSynonyms:Fe,browseSynonyms:ae,deleteSynonym:ye,clearSynonyms:fe,replaceAllObjects:Se,replaceAllSynonyms:qe,searchRules:Je,getRule:Pe,deleteRule:me,saveRule:Te,saveRules:Re,replaceAllRules:ke,browseRules:ue,clearRules:ce}})}},initAnalytics:function(){return function(e){return I(r({},c,{region:e,methods:{addABTest:N,getABTest:T,getABTests:R,stopABTest:E,deleteABTest:A}}))}}}}))}}));
