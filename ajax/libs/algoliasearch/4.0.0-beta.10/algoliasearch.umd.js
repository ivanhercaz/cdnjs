/*! algoliasearch.umd.js | 4.0.0-beta.10 | Â© Algolia, inc. | https://github.com/algolia/algoliasearch-client-javascript */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).algoliasearch=t()}(this,(function(){"use strict";function e(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function t(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function r(r){for(var n=1;n<arguments.length;n++){var o=null!=arguments[n]?arguments[n]:{};n%2?t(Object(o),!0).forEach((function(t){e(r,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):t(Object(o)).forEach((function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(o,e))}))}return r}function n(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var r=[],n=!0,o=!1,a=void 0;try{for(var u,i=e[Symbol.iterator]();!(n=(u=i.next()).done)&&(r.push(u.value),!t||r.length!==t);n=!0);}catch(e){o=!0,a=e}finally{try{n||null==i.return||i.return()}finally{if(o)throw a}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function a(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function u(e){var t=e.localStorage||window.localStorage,r="algoliasearch-client-js-".concat(e.key),n=function(){return JSON.parse(t.getItem(r)||"{}")};return{get:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{miss:function(){return Promise.resolve()}};return Promise.resolve().then((function(){var r=JSON.stringify(e),o=n()[r];return Promise.all([o||t(),void 0!==o])})).then((function(e){var t=o(e,2),n=t[0],a=t[1];return Promise.all([n,a||r.miss(n)])})).then((function(e){return o(e,1)[0]}))},set:function(e,o){return Promise.resolve().then((function(){var a=n();return a[JSON.stringify(e)]=o,t.setItem(r,JSON.stringify(a)),o}))},delete:function(e){return Promise.resolve().then((function(){var o=n();delete o[JSON.stringify(e)],t.setItem(r,JSON.stringify(o))}))}}}function i(e){var t=a(e.caches),r=t.shift();return void 0===r?s():{get:function(e,n){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{miss:function(){return Promise.resolve()}};return r.get(e,n,o).catch((function(){return i({caches:t}).get(e,n,o)}))},set:function(e,n){return r.set(e,n).catch((function(){return i({caches:t}).set(e,n)}))},delete:function(e){return r.delete(e).catch((function(){return i({caches:t}).delete(e)}))}}}function s(){return{get:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{miss:function(){return Promise.resolve()}},n=t();return n.then((function(e){return Promise.all([e,r.miss(e)])})).then((function(e){return o(e,1)[0]}))},set:function(e,t){return Promise.resolve(t)},delete:function(e){return Promise.resolve()}}}function c(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{serializable:!0},t={};return{get:function(r,n){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{miss:function(){return Promise.resolve()}},a=JSON.stringify(r);if(a in t)return Promise.resolve(e.serializable?JSON.parse(t[a]):t[a]);var u=n(),i=o&&o.miss||function(){return Promise.resolve()};return u.then((function(e){return i(e)})).then((function(){return u}))},set:function(r,n){return t[JSON.stringify(r)]=e.serializable?JSON.stringify(n):n,Promise.resolve(n)},delete:function(e){return delete t[JSON.stringify(e)],Promise.resolve()}}}function f(e,t,r){var n={"x-algolia-api-key":r,"x-algolia-application-id":t};return{headers:function(){return e===y.WithinHeaders?n:{}},queryParameters:function(){return e===y.WithinQueryParameters?n:{}}}}function d(e){var t=0;return e((function r(){return t++,new Promise((function(n){setTimeout((function(){n(e(r))}),Math.min(100*t,1e3))}))}))}function l(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e,t){return Promise.resolve()};return Object.assign(e,{wait:function(r){return l(e.then((function(e){return Promise.all([t(e,r),e])})).then((function(e){return e[1]})))}})}function p(e,t){return Object.keys(void 0!==t?t:{}).forEach((function(r){e[r]=t[r](e)})),e}function h(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var o=0;return e.replace(/%s/g,(function(){return encodeURIComponent(r[o++])}))}var m="4.0.0-beta.10",y={WithinQueryParameters:0,WithinHeaders:1};function g(e,t){var r=e||{},n={};return Object.keys(r).forEach((function(e){-1===["timeout","headers","queryParameters","data","cacheable"].indexOf(e)&&(n[e]=r[e])})),{data:n,timeout:r.timeout||t,headers:r.headers||{},queryParameters:r.queryParameters||{},cacheable:r.cacheable}}var v={Read:1,Write:2,Any:3},b={Up:1,Down:2,Timeouted:3},O=12e4;function P(e){return r({},e,{status:arguments.length>1&&void 0!==arguments[1]?arguments[1]:b.Up,lastUpdate:Date.now()})}function w(e){return{protocol:e.protocol||"https",url:e.url,accept:e.accept}}function j(e,t){return Promise.all(t.map((function(t){return e.get(t,(function(){return Promise.resolve(P(t))}))}))).then((function(e){var r=e.filter((function(e){return function(e){return e.status===b.Up||Date.now()-e.lastUpdate>O}(e)})),n=e.filter((function(e){return function(e){return e.status===b.Timeouted&&Date.now()-e.lastUpdate<=O}(e)})),o=[].concat(a(r),a(n));return{getTimeout:function(e,t){return(0===n.length&&0===e?1:n.length+3+e)*t},statelessHosts:o.length>0?o.map((function(e){return w(e)})):t}}))}var x=function(e,t){return function(e){var t=e.status;return e.isTimedOut||function(e){var t=e.isTimedOut,r=e.status;return!t&&0==~~r}(e)||2!=~~(t/100)&&4!=~~(t/100)}(e)?t.onRetry(e):2==~~(e.status/100)?t.onSucess(e):t.onFail(e)};function I(e,t,n,o){var u=[],i=function(e,t){var n=Array.isArray(e.data)?e.data:r({},e.data,{},t.data);if(n.constructor===Object&&0===Object.entries(n).length)return"";return JSON.stringify(n)}(n,o),s=r({},e.headers,{},o.headers),c=n.method,f=r({},e.queryParameters,{},o.queryParameters,{"x-algolia-agent":e.userAgent.value}),d=0,l=function t(r,a){var l=r.pop();if(void 0===l)throw function(e){return{name:"RetryError",message:"Unreachable hosts - your application id may be incorrect. If the error persists, contact support@algolia.com.",stackTrace:e}}(u);var p={data:i,headers:s,method:c,url:S(l,n.path,f),connectTimeout:a(d,e.timeouts.connect),responseTimeout:a(d,o.timeout)},h={onSucess:function(e){return function(e){try{return JSON.parse(e.content)}catch(t){throw function(e,t){return{name:"DeserializationError",message:e,response:t}}(t.message,e)}}(e)},onRetry:function(n){var o={request:p,response:n,host:l,triesLeft:r.length};return u.push(o),n.isTimedOut&&d++,Promise.all([e.logger.debug("Retryable failure",o),e.hostsCache.set(l,P(l,n.isTimedOut?b.Timeouted:b.Down))]).then((function(){return t(r,a)}))},onFail:function(e){throw function(e){var t=e.content,r=e.status,n=t;try{n=JSON.parse(t).message}catch(e){}return function(e,t){return{name:"ApiError",message:e,status:t}}(n,r)}(e)}};return e.requester.send(p).then((function(e){return x(e,h)}))};return j(e.hostsCache,t).then((function(e){return l(a(e.statelessHosts).reverse(),e.getTimeout)}))}function T(e){var t={hostsCache:e.hostsCache,logger:e.logger,requester:e.requester,requestsCache:e.requestsCache,responsesCache:e.responsesCache,timeouts:e.timeouts,userAgent:e.userAgent,headers:{},queryParameters:{},hosts:[],addHeaders:function(e){Object.assign(t.headers,e)},addQueryParameters:function(e){Object.assign(t.queryParameters,e)},setHosts:function(e){t.hosts=e.map((function(e){return w(e)}))},read:function(e,r){var n=g(r,t.timeouts.read),a=function(){return I(t,t.hosts.filter((function(e){return 0!=(e.accept&v.Read)})),e,n)};if(!0!==(void 0!==n.cacheable?n.cacheable:e.cacheable))return a();var u={request:e,mappedRequestOptions:n,transporter:{queryParameters:t.queryParameters,headers:t.headers}};return t.responsesCache.get(u,(function(){return t.requestsCache.get(u,(function(){return t.requestsCache.set(u,a()).then((function(e){return Promise.all([t.requestsCache.delete(u),e])}),(function(e){return Promise.all([t.requestsCache.delete(u),Promise.reject(e)])})).then((function(e){var t=o(e,2);t[0];return t[1]}))}))}),{miss:function(e){return t.responsesCache.set(u,e)}})},write:function(e,r){return I(t,t.hosts.filter((function(e){return 0!=(e.accept&v.Write)})),e,g(r,t.timeouts.write))}};return t}function q(e){var t={value:"Algolia for JavaScript (".concat(e,")"),add:function(e){var r="; ".concat(e.segment).concat(void 0!==e.version?" (".concat(e.version,")"):"");return-1===t.value.indexOf(r)&&(t.value="".concat(t.value).concat(r)),t}};return t}function S(e,t,r){var n=k(r),o="".concat(e.protocol,"://").concat(e.url,"/").concat("/"===t.charAt(0)?t.substr(1):t);return n.length&&(o+="?".concat(n)),o}function k(e){return Object.keys(e).map((function(t){return h("%s=%s",t,(r=e[t],"[object Object]"===Object.prototype.toString.call(r)||"[object Array]"===Object.prototype.toString.call(r)?JSON.stringify(e[t]):e[t]));var r})).join("&")}var N=function(e){var t=e.region||"us",n=f(y.WithinHeaders,e.appId,e.apiKey),o=T(r({},e,{hostsCache:s()})),a=e.appId;return o.setHosts([{url:"analytics.".concat(t,".algolia.com"),accept:v.Any}]),o.addHeaders(r({},n.headers(),{},{"content-type":"application/json"})),o.addQueryParameters(n.queryParameters()),p({appId:a,transporter:o},e.methods)},D="DELETE",R="GET",A="POST",E="PUT",C=function(e){return function(t,r){return e.transporter.write({method:A,path:"2/abtests",data:t},r)}},U=function(e){return function(t,r){return e.transporter.write({method:D,path:h("2/abtests/%s",t)},r)}},H=function(e){return function(t,r){return e.transporter.read({method:R,path:h("2/abtests/%s",t)},r)}},J=function(e){return function(t){return e.transporter.read({method:R,path:"2/abtests"},t)}},F=function(e){return function(t,r){return e.transporter.write({method:A,path:h("2/abtests/%s/stop",t)},r)}},Q=function(e){var t=e.region||"us",n=f(y.WithinHeaders,e.appId,e.apiKey),o=T(r({},e,{hostsCache:s()})),a=e.appId;return o.setHosts([{url:"recommendation.".concat(t,".algolia.com"),accept:v.Any}]),o.addHeaders(r({},n.headers(),{},{"content-type":"application/json"})),o.addQueryParameters(n.queryParameters()),p({appId:a,transporter:o},e.methods)},z=function(e){return function(t){return e.transporter.read({method:R,path:"1/strategies/personalization"},t)}},K=function(e){return function(t,r){return e.transporter.write({method:A,path:"1/strategies/personalization",data:t},r)}};function W(e){return new Promise((function(t){var r={page:0};return function n(){return e.request(r).then((function(o){return void 0!==e.batch&&e.batch(o.hits),e.shouldStop(o)?t():(r.page++,n())}))}()}))}var B=function(e){var t=e.appId,n=T(e);n.setHosts([{url:"".concat(t,"-dsn.algolia.net"),accept:v.Read},{url:"".concat(t,".algolia.net"),accept:v.Write}].concat(function(e){for(var t=e.length-1;t>0;t--){var r=Math.floor(Math.random()*(t+1)),n=e[t];e[t]=e[r],e[r]=n}return e}([{url:"".concat(t,"-1.algolianet.com"),accept:v.Any},{url:"".concat(t,"-2.algolianet.com"),accept:v.Any},{url:"".concat(t,"-3.algolianet.com"),accept:v.Any}])));var o=f(void 0!==e.authMode?e.authMode:y.WithinHeaders,t,e.apiKey);return n.addHeaders(r({},o.headers(),{},{"content-type":"application/x-www-form-urlencoded"})),n.addQueryParameters(o.queryParameters()),p({transporter:n,appId:t,addAlgoliaAgent:function(e,t){n.userAgent.add({segment:e,version:t})}},e.methods)};var M=function(e){return function(t,o){var a=o||{},u=a.queryParameters,i=n(a,["queryParameters"]),s=r({acl:t},void 0!==u?{queryParameters:u}:{});return l(e.transporter.write({method:A,path:"1/keys",data:s},i),(function(t,r){return d((function(n){return X(e)(t.key,r).catch((function(e){if(404===e.status)throw e;return n()}))}))}))}},V=function(e){return function(t,r,n){return l(e.transporter.write({method:A,path:h("1/indexes/%s/operation",t),data:{operation:"copy",destination:r}},n),(function(r,n){return Z(e)(t,{methods:{waitTask:Ge}}).waitTask(r.taskID,n)}))}},G=function(e){return function(t,n,o){return V(e)(t,n,r({},void 0===o?{}:o,{scope:[_e.Settings]}))}},L=function(e){return function(t,n,o){return V(e)(t,n,r({},void 0===o?{}:o,{scope:[_e.Synonyms]}))}},_=function(e){return function(t,r){return l(e.transporter.write({method:D,path:h("1/keys/%s",t)},r),(function(r,n){return d((function(r){return X(e)(t,n).catch((function(e){if(404!==e.status)throw e})).then(r)}))}))}},X=function(e){return function(t,r){return e.transporter.read({method:R,path:h("1/keys/%s",t)},r)}},Y=function(e){return function(t){var r=t||{},o=r.length,a=r.offset,u=r.type,i=g(n(r,["length","offset","type"]));return o&&(i.queryParameters.length=o),a&&(i.queryParameters.offset=a),u&&(i.queryParameters.type=u),e.transporter.read({method:R,path:"1/logs"},i)}},Z=function(e){return function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n={transporter:e.transporter,appId:e.appId,indexName:t};return p(n,r.methods)}},$=function(e){return function(t){return e.transporter.read({method:R,path:"1/keys"},t)}},ee=function(e){return function(t){return e.transporter.read({method:R,path:"1/clusters"},t)}},te=function(e){return function(t){return e.transporter.read({method:R,path:"1/indexes"},t)}},re=function(e){return function(t,r,n){return l(e.transporter.write({method:A,path:h("1/indexes/%s/operation",t),data:{operation:"move",destination:r}},n),(function(r,n){return Z(e)(t,{methods:{waitTask:Ge}}).waitTask(r.taskID,n)}))}},ne=function(e){return function(t,r){return l(e.transporter.write({method:A,path:"1/indexes/*/batch",data:{requests:t}},r),(function(t,r){return Promise.all(Object.keys(t.taskID).map((function(n){return Z(e)(n,{methods:{waitTask:Ge}}).waitTask(t.taskID[n],r)})))}))}},oe=function(e){return function(t,r){return e.transporter.read({method:A,path:"1/indexes/*/objects",data:{requests:t}},r)}},ae=function(e){return function(t,n){var o=t.map((function(e){return r({},e,{params:k(e.params||{})})}));return e.transporter.read({method:A,path:"1/indexes/*/queries",data:{requests:o},cacheable:!0},n)}},ue=function(e){return function(t,o){return Promise.all(t.map((function(t){var a=t.params,u=a.facetName,i=a.facetQuery,s=n(a,["facetName","facetQuery"]);return Z(e)(t.indexName,{methods:{searchForFacetValues:We}}).searchForFacetValues(u,i,r({},o,{},s))})))}},ie=function(e){return function(t,r){return l(e.transporter.write({method:A,path:h("1/keys/%s/restore",t)},r),(function(r,n){return d((function(r){return X(e)(t,n).catch((function(e){if(404!==e.status)throw e;return r()}))}))}))}},se=function(e){return function(t,r){var o=Object.assign({},r),a=r||{},u=a.queryParameters,i=n(a,["queryParameters"]),s=u?{queryParameters:u}:{},c=["acl","indexes","referers","restrictSources","queryParameters","description","maxQueriesPerIPPerHour","maxHitsPerQuery"];return l(e.transporter.write({method:E,path:h("1/keys/%s",t),data:s},i),(function(r,n){return d((function(r){return X(e)(t,n).then((function(e){return function(e){return Object.keys(o).filter((function(e){return-1!==c.indexOf(e)})).every((function(t){return e[t]===o[t]}))}(e)?Promise.resolve():r()}))}))}))}},ce=function(e){return function(t,r){return l(e.transporter.write({method:A,path:h("1/indexes/%s/batch",e.indexName),data:{requests:t}},r),(function(t,r){return Ge(e)(t.taskID,r)}))}},fe=function(e){return function(t){return W(r({},t,{shouldStop:function(e){return void 0===e.cursor},request:function(r){return e.transporter.read({method:A,path:h("1/indexes/%s/browse",e.indexName),data:r},t)}}))}},de=function(e){return function(t){var n=r({hitsPerPage:1e3},t);return W(r({},n,{shouldStop:function(e){return e.hits.length<n.hitsPerPage},request:function(n){return Be(e)("",r({},t,{},n)).then((function(e){return r({},e,{hits:e.hits.map((function(e){return delete e._highlightResult,e}))})}))}}))}},le=function(e){return function(t){var n=r({hitsPerPage:1e3},t);return W(r({},n,{shouldStop:function(e){return e.hits.length<n.hitsPerPage},request:function(n){return Me(e)("",r({},t,{},n)).then((function(e){return r({},e,{hits:e.hits.map((function(e){return delete e._highlightResult,e}))})}))}}))}},pe=function(e){return function(t,r,o){var a=o||{},u=a.batchSize,i=n(a,["batchSize"]),s=[];return l(function n(){var o,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,c=[];for(o=a;o<t.length&&(c.push(t[o]),c.length!==(u||1e3));o++);return 0===c.length?Promise.resolve(s):ce(e)(c.map((function(e){return{action:r,body:e}})),i).then((function(e){return s.push(e),o++,n(o)}))}(),(function(t,r){return Promise.all(t.map((function(t){return Ge(e)(t.taskID,r)})))}))}},he=function(e){return function(t){return l(e.transporter.write({method:A,path:h("1/indexes/%s/clear",e.indexName)},t),(function(t,r){return Ge(e)(t.taskID,r)}))}},me=function(e){return function(t){var r=t||{},o=r.forwardToReplicas,a=g(n(r,["forwardToReplicas"]));return o&&(a.queryParameters.forwardToReplicas=1),l(e.transporter.write({method:A,path:h("1/indexes/%s/rules/clear",e.indexName)},a),(function(t,r){return Ge(e)(t.taskID,r)}))}},ye=function(e){return function(t){var r=t||{},o=r.forwardToReplicas,a=g(n(r,["forwardToReplicas"]));return o&&(a.queryParameters.forwardToReplicas=1),l(e.transporter.write({method:A,path:h("1/indexes/%s/synonyms/clear",e.indexName)},a),(function(t,r){return Ge(e)(t.taskID,r)}))}},ge=function(e){return function(t,r){return l(e.transporter.write({method:A,path:h("1/indexes/%s/deleteByQuery",e.indexName),data:t},r),(function(t,r){return Ge(e)(t.taskID,r)}))}},ve=function(e){return function(t){return l(e.transporter.write({method:D,path:h("1/indexes/%s",e.indexName)},t),(function(t,r){return Ge(e)(t.taskID,r)}))}},be=function(e){return function(t,r){return l(Oe(e)([t],r).then((function(e){return{taskID:e[0].taskID}})),(function(t,r){return Ge(e)(t.taskID,r)}))}},Oe=function(e){return function(t,r){var n=t.map((function(e){return{objectID:e}}));return pe(e)(n,Le.DeleteObject,r)}},Pe=function(e){return function(t,r){var o=r||{},a=o.forwardToReplicas,u=g(n(o,["forwardToReplicas"]));return a&&(u.queryParameters.forwardToReplicas=1),l(e.transporter.write({method:D,path:h("1/indexes/%s/rules/%s",e.indexName,t)},u),(function(t,r){return Ge(e)(t.taskID,r)}))}},we=function(e){return function(t,r){var o=r||{},a=o.forwardToReplicas,u=g(n(o,["forwardToReplicas"]));return a&&(u.queryParameters.forwardToReplicas=1),l(e.transporter.write({method:D,path:h("1/indexes/%s/synonyms/%s",e.indexName,t)},u),(function(t,r){return Ge(e)(t.taskID,r)}))}},je=function(e){return function(t){return ke(e)(t).then((function(){return!0})).catch((function(e){if(404!==e.status)throw e;return!1}))}},xe=function(e){return function(t,a){var u=a||{},i=u.query,s=u.paginate,c=n(u,["query","paginate"]),f=0;return function n(){return Ke(e)(i||"",r({},c,{page:f})).then((function(e){for(var r=0,a=Object.entries(e.hits);r<a.length;r++){var u=o(a[r],2),i=u[0],c=u[1];if(t(c))return{object:c,position:parseInt(i,10),page:f}}if(f++,!1===s||f>=e.nbPages)throw{name:"ObjectNotFoundError",message:"Object not found."};return n()}))}()}},Ie=function(e){return function(t,r){var o=r||{},a=o.attributesToRetrieve,u=g(n(o,["attributesToRetrieve"]));return a&&(u.queryParameters.attributesToRetrieve=a),e.transporter.read({method:R,path:h("1/indexes/%s/%s",e.indexName,t)},u)}},Te=function(){return function(e,t){for(var r=0,n=Object.entries(e.hits);r<n.length;r++){var a=o(n[r],2),u=a[0];if(a[1].objectID===t)return parseInt(u,10)}return-1}},qe=function(e){return function(t,o){var a=o||{},u=a.attributesToRetrieve,i=n(a,["attributesToRetrieve"]),s=t.map((function(t){return r({indexName:e.indexName,objectID:t},u?{attributesToRetrieve:u}:{})}));return e.transporter.read({method:A,path:"1/indexes/*/objects",data:{requests:s}},i)}},Se=function(e){return function(t,r){return e.transporter.read({method:R,path:h("1/indexes/%s/rules/%s",e.indexName,t)},r)}},ke=function(e){return function(t){var r=g(t);return r.queryParameters.getVersion="2",e.transporter.read({method:R,path:h("1/indexes/%s/settings",e.indexName)},r)}},Ne=function(e){return function(t,r){return e.transporter.read({method:R,path:h("1/indexes/%s/synonyms/%s",e.indexName,t)},r)}},De=function(e){return function(t,r){return l(Re(e)([t],r).then((function(e){return{objectID:e[0].objectIDs[0],taskID:e[0].taskID}})),(function(t,r){return Ge(e)(t.taskID,r)}))}},Re=function(e){return function(t,r){var o=r||{},a=o.createIfNotExists,u=n(o,["createIfNotExists"]),i=a?Le.PartialUpdateObject:Le.PartialUpdateObjectNoCreate;return pe(e)(t,i,u)}},Ae=function(e){return function(t,o){var a=o||{},u=a.safe,i=n(a,["safe"]),s=function(t,r,n,o){return l(e.transporter.write({method:A,path:h("1/indexes/%s/operation",t),data:{operation:n,destination:r}},o),(function(t,r){return Ge(e)(t.taskID,r)}))},c=Math.random().toString(36).substring(7),f="".concat(e.indexName,"_tmp_").concat(c),d=He({appId:e.appId,transporter:e.transporter,indexName:f}),p=[],m=s(e.indexName,f,"copy",r({},i,{scope:["settings","synonyms","rules"]}));return p.push(m),l((u?m.wait(i):m).then((function(){var e=d(t,i);return p.push(e),u?e.wait(i):e})).then((function(){var t=s(f,e.indexName,"move",i);return p.push(t),u?t.wait(i):t})).then((function(){return Promise.resolve()})),(function(e,t){return Promise.all(p.map((function(e){return e.wait(t)})))}))}},Ee=function(e){return function(t,n){return Fe(e)(t,r({},n,{clearExistingRules:!0}))}},Ce=function(e){return function(t,n){return ze(e)(t,r({},void 0===n?{}:n,{replaceExistingSynonyms:!0}))}},Ue=function(e){return function(t,r){return l(He(e)([t],r).then((function(e){return{objectID:e[0].objectIDs[0],taskID:e[0].taskID}})),(function(t,r){return Ge(e)(t.taskID,r)}))}},He=function(e){return function(t,r){var o=r||{},a=o.autoGenerateObjectIDIfNotExist,u=n(o,["autoGenerateObjectIDIfNotExist"]),i=a?Le.AddObject:Le.UpdateObject;if(i===Le.UpdateObject){var s=!0,c=!1,f=void 0;try{for(var d,p=t[Symbol.iterator]();!(s=(d=p.next()).done);s=!0){if(void 0===d.value.objectID)return l(Promise.reject({name:"MissingObjectIDError",message:"All objects must have an unique objectID (like a primary key) to be valid. Algolia is also able to generate objectIDs automatically but *it's not recommended*. To do it, use `saveObjects(objects, {'autoGenerateObjectIDIfNotExist': true})`."}))}}catch(e){c=!0,f=e}finally{try{s||null==p.return||p.return()}finally{if(c)throw f}}}return pe(e)(t,i,u)}},Je=function(e){return function(t,r){return Fe(e)([t],r)}},Fe=function(e){return function(t,r){var o=r||{},a=o.forwardToReplicas,u=o.clearExistingRules,i=g(n(o,["forwardToReplicas","clearExistingRules"]));return a&&(i.queryParameters.forwardToReplicas=1),u&&(i.queryParameters.clearExistingRules=1),l(e.transporter.write({method:A,path:h("1/indexes/%s/rules/batch",e.indexName),data:t},i),(function(t,r){return Ge(e)(t.taskID,r)}))}},Qe=function(e){return function(t,r){return ze(e)([t],r)}},ze=function(e){return function(t,r){var o=r||{},a=o.forwardToReplicas,u=o.replaceExistingSynonyms,i=g(n(o,["forwardToReplicas","replaceExistingSynonyms"]));return a&&(i.queryParameters.forwardToReplicas=1),u&&(i.queryParameters.replaceExistingSynonyms=1),l(e.transporter.write({method:A,path:h("1/indexes/%s/synonyms/batch",e.indexName),data:t},i),(function(t,r){return Ge(e)(t.taskID,r)}))}},Ke=function(e){return function(t,r){return e.transporter.read({method:A,path:h("1/indexes/%s/query",e.indexName),data:{query:t},cacheable:!0},r)}},We=function(e){return function(t,r,n){return e.transporter.read({method:A,path:h("1/indexes/%s/facets/%s/query",e.indexName,t),data:{facetQuery:r},cacheable:!0},n)}},Be=function(e){return function(t,r){return e.transporter.read({method:A,path:h("1/indexes/%s/rules/search",e.indexName),data:{query:t}},r)}},Me=function(e){return function(t,r){return e.transporter.read({method:A,path:h("1/indexes/%s/synonyms/search",e.indexName),data:{query:t}},r)}},Ve=function(e){return function(t,r){var o=r||{},a=o.forwardToReplicas,u=g(n(o,["forwardToReplicas"]));return a&&(u.queryParameters.forwardToReplicas=1),l(e.transporter.write({method:E,path:h("1/indexes/%s/settings",e.indexName),data:t},u),(function(t,r){return Ge(e)(t.taskID,r)}))}},Ge=function(e){return function(t,r){return d((function(n){return function(e){return function(t,r){return e.transporter.read({method:R,path:h("1/indexes/%s/task/%s",e.indexName,t.toString())},r)}}(e)(t,r).then((function(e){return"published"!==e.status?n():void 0}))}))}},Le={AddObject:"addObject",UpdateObject:"updateObject",PartialUpdateObject:"partialUpdateObject",PartialUpdateObjectNoCreate:"partialUpdateObjectNoCreate",DeleteObject:"deleteObject"},_e={Settings:"settings",Synonyms:"synonyms",Rules:"rules"},Xe={Debug:1,Info:2,Error:3};return function(e,t){var n,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a={appId:e,apiKey:t,timeouts:{connect:1,read:2,write:30},requester:{send:function(e){return new Promise((function(t){var r=new XMLHttpRequest;r.open(e.method,e.url,!0),Object.keys(e.headers).forEach((function(t){return r.setRequestHeader(t,e.headers[t])}));var n,o=function(e,n){return setTimeout((function(){r.abort(),t({status:0,content:n,isTimedOut:!0})}),1e3*e)},a=o(e.connectTimeout,"Connection timeout");r.onreadystatechange=function(){r.readyState>r.OPENED&&void 0===n&&(clearTimeout(a),n=o(e.responseTimeout,"Socket timeout"))},r.onerror=function(){0===r.status&&(clearTimeout(a),clearTimeout(n),t({content:r.responseText||"Network request failed",status:r.status,isTimedOut:!1}))},r.onload=function(){clearTimeout(a),clearTimeout(n),t({content:r.responseText,status:r.status,isTimedOut:!1})},r.send(e.data)}))}},logger:(n=o.logLevel||Xe.Error,{debug:function(e,t){return Xe.Debug>=n&&console.debug(e,t),Promise.resolve()},info:function(e,t){return Xe.Info>=n&&console.info(e,t),Promise.resolve()},error:function(e,t){return console.error(e,t),Promise.resolve()}}),responsesCache:c(),requestsCache:c({serializable:!1}),hostsCache:i({caches:[u({key:"".concat(m,"-").concat(e)}),c()]}),userAgent:q(m).add({segment:"Browser"})};return B(r({},a,{methods:{search:ae,searchForFacetValues:ue,multipleBatch:ne,multipleGetObjects:oe,multipleQueries:ae,copyIndex:V,copySettings:G,copySynonyms:L,moveIndex:re,listIndices:te,getLogs:Y,listClusters:ee,multipleSearchForFacetValues:ue,getApiKey:X,addApiKey:M,listApiKeys:$,updateApiKey:se,deleteApiKey:_,restoreApiKey:ie,initIndex:function(e){return function(t){return Z(e)(t,{methods:{batch:ce,delete:ve,getObject:Ie,getObjects:qe,saveObject:Ue,saveObjects:He,search:Ke,searchForFacetValues:We,waitTask:Ge,setSettings:Ve,getSettings:ke,partialUpdateObject:De,partialUpdateObjects:Re,deleteObject:be,deleteObjects:Oe,deleteBy:ge,clearObjects:he,browseObjects:fe,getObjectPosition:Te,findObject:xe,exists:je,saveSynonym:Qe,saveSynonyms:ze,getSynonym:Ne,searchSynonyms:Me,browseSynonyms:le,deleteSynonym:we,clearSynonyms:ye,replaceAllObjects:Ae,replaceAllSynonyms:Ce,searchRules:Be,getRule:Se,deleteRule:Pe,saveRule:Je,saveRules:Fe,replaceAllRules:Ee,browseRules:de,clearRules:me}})}},initAnalytics:function(){return function(e){return N(r({},a,{region:e,methods:{addABTest:C,getABTest:H,getABTests:J,stopABTest:F,deleteABTest:U}}))}},initRecommendation:function(){return function(e){return Q(r({},a,{region:e,methods:{getPersonalizationStrategy:z,setPersonalizationStrategy:K}}))}}}}))}}));
