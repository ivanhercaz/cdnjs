!function(g){function b(){g.fn.ajaxSubmit.debug&&window.console&&window.console.log&&window.console.log("[jquery.form] "+Array.prototype.join.call(arguments,""))}g.fn.ajaxSubmit=function(h){if(!this.length)return b("ajaxSubmit: skipping submit process - no element selected"),this;"function"==typeof h&&(h={success:h});var e=g.trim(this.attr("action"));e=(e=e&&(e.match(/^([^#]+)/)||[])[1])||window.location.href||"",h=g.extend({url:e,type:this.attr("method")||"GET"},h||{});var t={};if(this.trigger("form-pre-serialize",[this,h,t]),t.veto)return b("ajaxSubmit: submit vetoed via form-pre-serialize trigger"),this;if(h.beforeSerialize&&!1===h.beforeSerialize(this,h))return b("ajaxSubmit: submit aborted via beforeSerialize callback"),this;var a=this.formToArray(h.semantic);if(h.data)for(var r in h.extraData=h.data,h.data)if(h.data[r]instanceof Array)for(var n in h.data[r])a.push({name:r,value:h.data[r][n]});else a.push({name:r,value:h.data[r]});if(h.beforeSubmit&&!1===h.beforeSubmit(a,this,h))return b("ajaxSubmit: submit aborted via beforeSubmit callback"),this;if(this.trigger("form-submit-validate",[a,this,h,t]),t.veto)return b("ajaxSubmit: submit vetoed via form-submit-validate trigger"),this;var i=g.param(a);"GET"==h.type.toUpperCase()?(h.url+=(0<=h.url.indexOf("?")?"&":"?")+i,h.data=null):h.data=i;var v=this,o=[];if(h.resetForm&&o.push(function(){v.resetForm()}),h.clearForm&&o.push(function(){v.clearForm()}),!h.dataType&&h.target){var s=h.success||function(){};o.push(function(e){g(h.target).html(e).each(s,arguments)})}else h.success&&o.push(h.success);h.success=function(e,t){for(var a=0,r=o.length;a<r;a++)o[a].apply(h,[e,t,v])};for(var u=g("input:file",this).fieldValue(),l=!1,c=0;c<u.length;c++)u[c]&&(l=!0);return h.iframe||l?h.closeKeepAlive?g.get(h.closeKeepAlive,f):f():g.ajax(h),this.trigger("form-submit-notify",[this,h]),this;function f(){var n=v[0];if(g(":input[name=submit]",n).length)alert('Error: Form elements must not be named "submit".');else{var o=g.extend({},g.ajaxSettings,h),e=g.extend(!0,{},g.extend(!0,{},g.ajaxSettings),o),i="jqFormIO"+(new Date).getTime(),s=g('<iframe id="'+i+'" name="'+i+'" src="about:blank" />'),u=s[0];s.css({position:"absolute",top:"-1000px",left:"-1000px"});var l={aborted:0,responseText:null,responseXML:null,status:0,statusText:"n/a",getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){},abort:function(){this.aborted=1,s.attr("src","about:blank")}},c=o.global;if(c&&!g.active++&&g.event.trigger("ajaxStart"),c&&g.event.trigger("ajaxSend",[l,o]),e.beforeSend&&!1===e.beforeSend(l,e))e.global&&g.active--;else if(!l.aborted){var f=0,m=0,t=n.clk;if(t){var a=t.name;a&&!t.disabled&&(h.extraData=h.extraData||{},h.extraData[a]=t.value,"image"==t.type&&(h.extraData[name+".x"]=n.clk_x,h.extraData[name+".y"]=n.clk_y))}setTimeout(function(){var e=v.attr("target"),t=v.attr("action");n.setAttribute("target",i),"POST"!=n.getAttribute("method")&&n.setAttribute("method","POST"),n.getAttribute("action")!=o.url&&n.setAttribute("action",o.url),h.skipEncodingOverride||v.attr({encoding:"multipart/form-data",enctype:"multipart/form-data"}),o.timeout&&setTimeout(function(){m=!0,p()},o.timeout);var a=[];try{if(h.extraData)for(var r in h.extraData)a.push(g('<input type="hidden" name="'+r+'" value="'+h.extraData[r]+'" />').appendTo(n)[0]);s.appendTo("body"),u.attachEvent?u.attachEvent("onload",p):u.addEventListener("load",p,!1),n.submit()}finally{n.setAttribute("action",t),e?n.setAttribute("target",e):v.removeAttr("target"),g(a).remove()}},10);var d=50}}function p(){if(!f++){u.detachEvent?u.detachEvent("onload",p):u.removeEventListener("load",p,!1);var t=!0;try{if(m)throw"timeout";var e,a;a=u.contentWindow?u.contentWindow.document:u.contentDocument?u.contentDocument:u.document;var r="xml"==o.dataType||a.XMLDocument||g.isXMLDoc(a);if(b("isXml="+r),!r&&(null==a.body||""==a.body.innerHTML))return--d?(f=0,void setTimeout(p,100)):void b("Could not access iframe DOM after 50 tries.");if(l.responseText=a.body?a.body.innerHTML:null,l.responseXML=a.XMLDocument?a.XMLDocument:a,l.getResponseHeader=function(e){return{"content-type":o.dataType}[e]},"json"==o.dataType||"script"==o.dataType){var n=a.getElementsByTagName("textarea")[0];if(n)l.responseText=n.value;else{var i=a.getElementsByTagName("pre")[0];i&&(l.responseText=i.innerHTML)}}else"xml"!=o.dataType||l.responseXML||null==l.responseText||(l.responseXML=function(e,t){window.ActiveXObject?((t=new ActiveXObject("Microsoft.XMLDOM")).async="false",t.loadXML(e)):t=(new DOMParser).parseFromString(e,"text/xml");return t&&t.documentElement&&"parsererror"!=t.documentElement.tagName?t:null}(l.responseText));e=g.httpData(l,o.dataType)}catch(e){t=!1,g.handleError(o,l,"error",e)}t&&(o.success(e,"success"),c&&g.event.trigger("ajaxSuccess",[l,o])),c&&g.event.trigger("ajaxComplete",[l,o]),c&&!--g.active&&g.event.trigger("ajaxStop"),o.complete&&o.complete(l,t?"success":"error"),setTimeout(function(){s.remove(),l.responseXML=null},100)}}}},g.fn.ajaxForm=function(e){return this.ajaxFormUnbind().bind("submit.form-plugin",function(){return g(this).ajaxSubmit(e),!1}).bind("click.form-plugin",function(e){var t=g(e.target);if(t.is(":submit,input:image")){var a=this;if(a.clk=e.target,"image"==e.target.type)if(null!=e.offsetX)a.clk_x=e.offsetX,a.clk_y=e.offsetY;else if("function"==typeof g.fn.offset){var r=t.offset();a.clk_x=e.pageX-r.left,a.clk_y=e.pageY-r.top}else a.clk_x=e.pageX-e.target.offsetLeft,a.clk_y=e.pageY-e.target.offsetTop;setTimeout(function(){a.clk=a.clk_x=a.clk_y=null},10)}})},g.fn.ajaxFormUnbind=function(){return this.unbind("submit.form-plugin click.form-plugin")},g.fn.formToArray=function(e){var t=[];if(0==this.length)return t;var a=this[0],r=e?a.getElementsByTagName("*"):a.elements;if(!r)return t;for(var n=0,i=r.length;n<i;n++){var o=r[n];if(c=o.name)if(e&&a.clk&&"image"==o.type)o.disabled||a.clk!=o||(t.push({name:c,value:g(o).val()}),t.push({name:c+".x",value:a.clk_x},{name:c+".y",value:a.clk_y}));else{var s=g.fieldValue(o,!0);if(s&&s.constructor==Array)for(var u=0,l=s.length;u<l;u++)t.push({name:c,value:s[u]});else null!=s&&t.push({name:c,value:s})}}if(!e&&a.clk){var c,f=g(a.clk),m=f[0];(c=m.name)&&!m.disabled&&"image"==m.type&&(t.push({name:c,value:f.val()}),t.push({name:c+".x",value:a.clk_x},{name:c+".y",value:a.clk_y}))}return t},g.fn.formSerialize=function(e){return g.param(this.formToArray(e))},g.fn.fieldSerialize=function(n){var i=[];return this.each(function(){var e=this.name;if(e){var t=g.fieldValue(this,n);if(t&&t.constructor==Array)for(var a=0,r=t.length;a<r;a++)i.push({name:e,value:t[a]});else null!=t&&i.push({name:this.name,value:t})}}),g.param(i)},g.fn.fieldValue=function(e){for(var t=[],a=0,r=this.length;a<r;a++){var n=this[a],i=g.fieldValue(n,e);null==i||i.constructor==Array&&!i.length||(i.constructor==Array?g.merge(t,i):t.push(i))}return t},g.fieldValue=function(e,t){var a=e.name,r=e.type,n=e.tagName.toLowerCase();if(void 0===t&&(t=!0),t&&(!a||e.disabled||"reset"==r||"button"==r||("checkbox"==r||"radio"==r)&&!e.checked||("submit"==r||"image"==r)&&e.form&&e.form.clk!=e||"select"==n&&-1==e.selectedIndex))return null;if("select"!=n)return e.value;var i=e.selectedIndex;if(i<0)return null;for(var o=[],s=e.options,u="select-one"==r,l=u?i+1:s.length,c=u?i:0;c<l;c++){var f=s[c];if(f.selected){var m=f.value;if(m=m||(f.attributes&&f.attributes.value&&!f.attributes.value.specified?f.text:f.value),u)return m;o.push(m)}}return o},g.fn.clearForm=function(){return this.each(function(){g("input,select,textarea",this).clearFields()})},g.fn.clearFields=g.fn.clearInputs=function(){return this.each(function(){var e=this.type,t=this.tagName.toLowerCase();"text"==e||"password"==e||"textarea"==t?this.value="":"checkbox"==e||"radio"==e?this.checked=!1:"select"==t&&(this.selectedIndex=-1)})},g.fn.resetForm=function(){return this.each(function(){"function"!=typeof this.reset&&("object"!=typeof this.reset||this.reset.nodeType)||this.reset()})},g.fn.enable=function(e){return null==e&&(e=!0),this.each(function(){this.disabled=!e})},g.fn.selected=function(a){return null==a&&(a=!0),this.each(function(){var e=this.type;if("checkbox"==e||"radio"==e)this.checked=a;else if("option"==this.tagName.toLowerCase()){var t=g(this).parent("select");a&&t[0]&&"select-one"==t[0].type&&t.find("option").selected(!1),this.selected=a}})}}(jQuery);