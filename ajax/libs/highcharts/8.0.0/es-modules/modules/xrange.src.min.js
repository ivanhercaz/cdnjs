"use strict";import H from"../parts/Globals.js";import U from"../parts/Utilities.js";var clamp=U.clamp,correctFloat=U.correctFloat,defined=U.defined,isNumber=U.isNumber,isObject=U.isObject,pick=U.pick,addEvent=H.addEvent,color=H.color,columnType=H.seriesTypes.column,find=H.find,merge=H.merge,seriesType=H.seriesType,seriesTypes=H.seriesTypes,Axis=H.Axis,Point=H.Point,Series=H.Series;function getColorByCategory(t,i){var e=t.options.colors||t.chart.options.colors,o=e?e.length:t.chart.options.chart.colorCount,r=i.y%o;return{colorIndex:r,color:e&&e[r]}}seriesType("xrange","column",{colorByPoint:!0,dataLabels:{formatter:function(){var t=this.point.partialFill;if(isObject(t)&&(t=t.amount),isNumber(t)&&t>0)return correctFloat(100*t)+"%"},inside:!0,verticalAlign:"middle"},tooltip:{headerFormat:'<span style="font-size: 10px">{point.x} - {point.x2}</span><br/>',pointFormat:'<span style="color:{point.color}">‚óè</span> {series.name}: <b>{point.yCategory}</b><br/>'},borderRadius:3,pointRange:0},{type:"xrange",parallelArrays:["x","x2","y"],requireSorting:!1,animate:seriesTypes.line.prototype.animate,cropShoulder:1,getExtremesFromAll:!0,autoIncrement:H.noop,buildKDTree:H.noop,getColumnMetrics:function(){var t,i=this.chart;function e(){i.series.forEach(function(t){var i=t.xAxis;t.xAxis=t.yAxis,t.yAxis=i})}return e(),t=columnType.prototype.getColumnMetrics.call(this),e(),t},cropData:function(t,i,e,o){var r=Series.prototype.cropData.call(this,this.x2Data,i,e,o);return r.xData=t.slice(r.start,r.end),r},findPointIndex:function(t){var i,e,o=this.cropped,r=this.cropStart,s=this.points,a=t.id;a&&(i=(e=find(s,function(t){return t.id===a}))?e.index:void 0);void 0===i&&(i=(e=find(s,function(i){return i.x===t.x&&i.x2===t.x2&&!i.touched}))?e.index:void 0);return o&&isNumber(i)&&isNumber(r)&&i>=r&&(i-=r),i},translatePoint:function(t){var i,e,o,r,s,a,n,l=this.xAxis,p=this.yAxis,c=this.columnMetrics,h=this.options,d=h.minPointLength||0,u=t.plotX,m=pick(t.x2,t.x+(t.len||0)),g=l.translate(m,0,0,0,1),x=Math.abs(g-u),y=this.chart.inverted,f=pick(h.borderWidth,1)%2/2,b=c.offset,A=Math.round(c.width);d&&((i=d-x)<0&&(i=0),u-=i/2,g+=i/2),u=Math.max(u,-10),g=clamp(g,-10,l.len+10),defined(t.options.pointWidth)&&(b-=(Math.ceil(t.options.pointWidth)-A)/2,A=Math.ceil(t.options.pointWidth)),h.pointPlacement&&isNumber(t.plotY)&&p.categories&&(t.plotY=p.translate(t.y,0,1,0,1,h.pointPlacement)),t.shapeArgs={x:Math.floor(Math.min(u,g))+f,y:Math.floor(t.plotY+b)+f,width:Math.round(Math.abs(g-u)),height:A,r:this.options.borderRadius},s=(r=t.shapeArgs.x)+t.shapeArgs.width,r<0||s>l.len?(r=clamp(r,0,l.len),a=(s=clamp(s,0,l.len))-r,t.dlBox=merge(t.shapeArgs,{x:r,width:s-r,centerX:a?a/2:null})):t.dlBox=null;var v=t.tooltipPos,C=y?1:0,M=y?0:1;v[C]=clamp(v[C]+(y?-1:1)*(l.reversed?-1:1)*(x/2),0,l.len-1),v[M]=clamp(v[M]+(y?1:-1)*(c.width/2),0,p.len-1),(o=t.partialFill)&&(isObject(o)&&(o=o.amount),isNumber(o)||(o=0),e=t.shapeArgs,t.partShapeArgs={x:e.x,y:e.y,width:e.width,height:e.height,r:this.options.borderRadius},n=Math.max(Math.round(x*o+t.plotX-u),0),t.clipRectArgs={x:l.reversed?e.x+x-n:e.x,y:e.y,width:n,height:e.height})},translate:function(){columnType.prototype.translate.apply(this,arguments),this.points.forEach(function(t){this.translatePoint(t)},this)},drawPoint:function(t,i){var e,o=this.options,r=this.chart.renderer,s=t.graphic,a=t.shapeType,n=t.shapeArgs,l=t.partShapeArgs,p=t.clipRectArgs,c=t.partialFill,h=o.stacking&&!o.borderRadius,d=t.state,u=o.states[d||"normal"]||{},m=void 0===d?"attr":i,g=this.pointAttribs(t,d),x=pick(this.chart.options.chart.animation,u.animation);t.isNull?s&&(t.graphic=s.destroy()):(s?s.rect[i](n):(t.graphic=s=r.g("point").addClass(t.getClassName()).add(t.group||this.group),s.rect=r[a](merge(n)).addClass(t.getClassName()).addClass("highcharts-partfill-original").add(s)),l&&(s.partRect?(s.partRect[i](merge(l)),s.partialClipRect[i](merge(p))):(s.partialClipRect=r.clipRect(p.x,p.y,p.width,p.height),s.partRect=r[a](l).addClass("highcharts-partfill-overlay").add(s).clip(s.partialClipRect))),this.chart.styledMode||(s.rect[i](g,x).shadow(o.shadow,null,h),l&&(isObject(c)||(c={}),isObject(o.partialFill)&&(c=merge(c,o.partialFill)),e=c.fill||color(g.fill).brighten(-.3).get()||color(t.color||this.color).brighten(-.3).get(),g.fill=e,s.partRect[m](g,x).shadow(o.shadow,null,h))))},drawPoints:function(){var t=this,i=t.getAnimationVerb();t.points.forEach(function(e){t.drawPoint(e,i)})},getAnimationVerb:function(){return this.chart.pointCount<(this.options.animationLimit||250)?"animate":"attr"}},{resolveColor:function(){var t,i=this.series;i.options.colorByPoint&&!this.options.color?(t=getColorByCategory(i,this),i.chart.styledMode||(this.color=t.color),this.options.colorIndex||(this.colorIndex=t.colorIndex)):this.color||(this.color=i.color)},init:function(){return Point.prototype.init.apply(this,arguments),this.y||(this.y=0),this},setState:function(){Point.prototype.setState.apply(this,arguments),this.series.drawPoint(this,this.series.getAnimationVerb())},getLabelConfig:function(){var t=Point.prototype.getLabelConfig.call(this),i=this.series.yAxis.categories;return t.x2=this.x2,t.yCategory=this.yCategory=i&&i[this.y],t},tooltipDateKeys:["x","x2"],isValid:function(){return"number"==typeof this.x&&"number"==typeof this.x2}}),addEvent(Axis,"afterGetSeriesExtremes",function(){var t,i,e=this.series;this.isXAxis&&(t=pick(this.dataMax,-Number.MAX_VALUE),e.forEach(function(e){e.x2Data&&e.x2Data.forEach(function(e){e>t&&(t=e,i=!0)})}),i&&(this.dataMax=t))});