"use strict";import H from"../../parts/Globals.js";import U from"../../parts/Utilities.js";var pick=U.pick;function stringTrim(t){return t.trim&&t.trim()||t.replace(/^\s+|\s+$/g,"")}function formatExtendedStatement(t,e){var n,r,i=t.indexOf("#each("),s=t.indexOf("#plural("),a=t.indexOf("["),u=t.indexOf("]");if(i>-1){var o,f=t.slice(i).indexOf(")")+i,l=t.substring(0,i),c=t.substring(f+1),g=t.substring(i+6,f).split(","),m=Number(g[1]);if(r="",n=e[g[0]]){o=(m=isNaN(m)?n.length:m)<0?n.length+m:Math.min(m,n.length);for(var p=0;p<o;++p)r+=l+n[p]+c}return r.length?r:""}if(s>-1){var d=t.slice(s).indexOf(")")+s,h=t.substring(s+8,d).split(",");switch(Number(e[h[0]])){case 0:r=pick(h[4],h[1]);break;case 1:r=pick(h[2],h[1]);break;case 2:r=pick(h[3],h[1]);break;default:r=h[1]}return r?stringTrim(r):""}if(a>-1){var b,v=t.substring(0,a),x=Number(t.substring(a+1,u));return n=e[v],!isNaN(x)&&n&&(x<0?void 0===(b=n[n.length+x])&&(b=n[0]):void 0===(b=n[x])&&(b=n[n.length-1])),void 0!==b?b:""}return"{"+t+"}"}H.i18nFormat=function(t,e,n){var r,i,s=function(t,e){var n=t.slice(e||0),r=n.indexOf("{"),i=n.indexOf("}");if(r>-1&&i>r)return{statement:n.substring(r+1,i),begin:e+r+1,end:e+i}},a=[],u=0;do{r=s(t,u),(i=t.substring(u,r&&r.begin-1)).length&&a.push({value:i,type:"constant"}),r&&a.push({value:r.statement,type:"statement"}),u=r?r.end+1:u+1}while(r);return a.forEach(function(t){"statement"===t.type&&(t.value=formatExtendedStatement(t.value,e))}),H.format(a.reduce(function(t,e){return t+e.value},""),e,n)},H.Chart.prototype.langFormat=function(t,e){for(var n=t.split("."),r=this.options.lang,i=0;i<n.length;++i)r=r&&r[n[i]];return"string"==typeof r?H.i18nFormat(r,e,this):""};