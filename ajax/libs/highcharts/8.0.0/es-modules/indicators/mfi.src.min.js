"use strict";import H from"../parts/Globals.js";import U from"../parts/Utilities.js";var isArray=U.isArray;function sumArray(e){return e.reduce(function(e,a){return e+a})}function toFixed(e,a){return parseFloat(e.toFixed(a))}function calculateTypicalPrice(e){return(e[1]+e[2]+e[3])/3}function calculateRawMoneyFlow(e,a){return e*a}H.seriesType("mfi","sma",{params:{period:14,volumeSeriesID:"volume",decimals:4}},{nameBase:"Money Flow Index",getValues:function(e,a){var r,t,i,l,s,u,c=a.period,o=e.xData,n=e.yData,p=n?n.length:0,m=a.decimals,y=1,f=e.chart.get(a.volumeSeriesID),h=f&&f.yData,d=[],D=!1,v=[],F=[],w=[],x=[];if(f){if(!(o.length<=c)&&isArray(n[0])&&4===n[0].length&&h){for(r=calculateTypicalPrice(n[y]);y<c+1;)t=r,D=(r=calculateTypicalPrice(n[y]))>=t,i=calculateRawMoneyFlow(r,h[y]),w.push(D?i:0),x.push(D?0:i),y++;for(u=y-1;u<p;u++)u>y-1&&(w.shift(),x.shift(),t=r,D=(r=calculateTypicalPrice(n[u]))>t,i=calculateRawMoneyFlow(r,h[u]),w.push(D?i:0),x.push(D?0:i)),l=sumArray(x),s=toFixed(100-100/(1+sumArray(w)/l),m),d.push([o[u],s]),v.push(o[u]),F.push(s);return{values:d,xData:v,yData:F}}}else H.error("Series "+a.volumeSeriesID+" not found! Check `volumeSeriesID`.",!0,e.chart)}});