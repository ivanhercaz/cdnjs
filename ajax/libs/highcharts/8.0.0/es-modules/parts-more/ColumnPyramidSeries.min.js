"use strict";import H from"../parts/Globals.js";import U from"../parts/Utilities.js";var clamp=U.clamp,pick=U.pick,seriesType=H.seriesType,seriesTypes=H.seriesTypes,colProto=seriesTypes.column.prototype;seriesType("columnpyramid","column",{},{translate:function(){var t=this,e=t.chart,o=t.options,i=t.dense=t.closestPointRange*t.xAxis.transA<2,s=t.borderWidth=pick(o.borderWidth,i?0:1),p=t.yAxis,r=o.threshold,a=t.translatedThreshold=p.getThreshold(r),l=pick(o.minPointLength,5),n=t.getColumnMetrics(),h=n.width,c=t.barW=Math.max(h,1+2*s),d=t.pointXOffset=n.offset;e.inverted&&(a-=.5),o.pointPadding&&(c=Math.ceil(c)),colProto.translate.apply(t),t.points.forEach(function(i){var s,n,m,y,f,g,T,x,u,M,P,b,k=pick(i.yBottom,a),v=999+Math.abs(k),W=clamp(i.plotY,-v,p.len+v),A=i.plotX+d,H=c/2,U=Math.min(W,k),L=Math.max(W,k)-U;i.barX=A,i.pointWidth=h,i.tooltipPos=e.inverted?[p.len+p.pos-e.plotLeft-W,t.xAxis.len-A-H,L]:[A+H,W+p.pos-e.plotTop,L],s=r+(i.total||i.y),"percent"===o.stacking&&(s=r+(i.y<0)?-100:100),T=A-(y=H*(U-(m=p.toPixels(s,!0)))/(n=e.plotHeight-m-(e.plotHeight-a)))+H,x=A+y+H,u=A+(f=H*(U+L-m)/n)+H,M=A-f+H,P=U-l,b=U+L,i.y<0&&(P=U,b=U+L+l),e.inverted&&(x=(T=A+H+(y=H*(m-(g=e.plotWidth-U))/(n=m-(e.plotWidth-a))))-2*y,u=A-(f=H*(m-(g-L))/n)+H,M=A+f+H,P=U,b=U+L-l,i.y<0&&(b=U+L+l)),i.shapeType="path",i.shapeArgs={x:T,y:P,width:x-T,height:L,d:["M",T,P,"L",x,P,u,b,M,b,"Z"]}})}});