"use strict";import H from"../parts/Globals.js";import Color from"../parts/Color.js";var color=Color.parse;import U from"../parts/Utilities.js";var merge=U.merge,pick=U.pick,seriesType=U.seriesType;import"../parts/ColumnSeries.js";import"../parts/SvgRenderer.js";var cylinderMethods,charts=H.charts,deg2rad=H.deg2rad,perspective=H.perspective,RendererProto=H.Renderer.prototype,cuboidPath=RendererProto.cuboidPath;seriesType("cylinder","column",{},{},{shapeType:"cylinder",hasNewShapeType:H.seriesTypes.column.prototype.pointClass.prototype.hasNewShapeType}),cylinderMethods=merge(RendererProto.elements3d.cuboid,{parts:["top","bottom","front","back"],pathType:"cylinder",fillSetter:function(e){return this.singleSetterForParts("fill",null,{front:e,back:e,top:color(e).brighten(.1).get(),bottom:color(e).brighten(-.1).get()}),this.color=this.fill=e,this}}),RendererProto.elements3d.cylinder=cylinderMethods,RendererProto.cylinder=function(e){return this.element3d("cylinder",e)},RendererProto.cylinderPath=function(e){var t=charts[this.chartIndex],r=cuboidPath.call(this,e),o=!r.isTop,i=!r.isFront,n=this.getCylinderEnd(t,e),s=this.getCylinderEnd(t,e,!0);return{front:this.getCylinderFront(n,s),back:this.getCylinderBack(n,s),top:n,bottom:s,zIndexes:{top:o?3:0,bottom:o?0:3,front:i?2:1,back:i?1:2,group:r.zIndexes.group}}},RendererProto.getCylinderFront=function(e,t){var r=e.slice(0,e.simplified?9:17);return r.push("L"),t.simplified?(r=r.concat(t.slice(7,9)).concat(t.slice(3,6)).concat(t.slice(0,3)))[r.length-3]="L":r.push(t[15],t[16],"C",t[13],t[14],t[11],t[12],t[8],t[9],"C",t[6],t[7],t[4],t[5],t[1],t[2]),r.push("Z"),r},RendererProto.getCylinderBack=function(e,t){var r=["M"];return e.simplified?(r=r.concat(e.slice(7,12))).push("L",e[1],e[2]):r=r.concat(e.slice(15)),r.push("L"),t.simplified?r=r.concat(t.slice(1,3)).concat(t.slice(9,12)).concat(t.slice(6,9)):r.push(t[29],t[30],"C",t[27],t[28],t[25],t[26],t[22],t[23],"C",t[20],t[21],t[18],t[19],t[15],t[16]),r.push("Z"),r},RendererProto.getCylinderEnd=function(e,t,r){var o,i,n,s,c=pick(t.depth,t.width),a=Math.min(t.width,c)/2,p=deg2rad*(e.options.chart.options3d.beta-90+(t.alphaCorrection||0)),d=t.y+(r?t.height:0),l=.5519*a,h=t.width/2+t.x,y=c/2+t.z,u=[{x:0,y:d,z:a},{x:l,y:d,z:a},{x:a,y:d,z:l},{x:a,y:d,z:0},{x:a,y:d,z:-l},{x:l,y:d,z:-a},{x:0,y:d,z:-a},{x:-l,y:d,z:-a},{x:-a,y:d,z:-l},{x:-a,y:d,z:0},{x:-a,y:d,z:l},{x:-l,y:d,z:a},{x:0,y:d,z:a}],m=Math.cos(p),g=Math.sin(p);return u.forEach(function(e,t){n=e.x,s=e.z,u[t].x=n*m-s*g+h,u[t].z=s*m+n*g+y}),o=perspective(u,e,!0),Math.abs(o[3].y-o[9].y)<2.5&&Math.abs(o[0].y-o[6].y)<2.5?(i=this.toLinePath([o[0],o[3],o[6],o[9]],!0)).simplified=!0:i=this.getCurvedPath(o),i},RendererProto.getCurvedPath=function(e){var t,r=["M",e[0].x,e[0].y],o=e.length-2;for(t=1;t<o;t+=3)r.push("C",e[t].x,e[t].y,e[t+1].x,e[t+1].y,e[t+2].x,e[t+2].y);return r};