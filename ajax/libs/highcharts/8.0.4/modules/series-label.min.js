!function(e){"object"==typeof module&&module.exports?module.exports=e.default=e:"function"==typeof define&&define.amd?define("highcharts/modules/series-label",["highcharts"],function(t){return e(t),e.Highcharts=t,e}):e("undefined"!=typeof Highcharts?Highcharts:void 0)}(function(t){function e(t,e,o,r){t.hasOwnProperty(e)||(t[e]=r.apply(null,o))}e(t=t?t._modules:{},"modules/series-label.src.js",[t["parts/Globals.js"],t["parts/Utilities.js"]],function(e,t){function s(t,e,o,r,i,a){return 0<(t=(a-e)*(o-t)-(r-e)*(i-t))||!(t<0)}function l(t,e,o,r,i,a,h,n){return s(t,e,i,a,h,n)!==s(o,r,i,a,h,n)&&s(t,e,o,r,i,a)!==s(t,e,o,r,h,n)}function g(t,e,o,r,i,a,h,n){return l(t,e,t+o,e,i,a,h,n)||l(t+o,e,t+o,e+r,i,a,h,n)||l(t,e+r,t+o,e+r,i,a,h,n)||l(t,e,t,e+r,i,a,h,n)}function o(i){var a=this,h=Y(a.renderer.globalAnimation).duration;a.labelSeries=[],a.labelSeriesMaxSum=0,t.clearTimeout(a.seriesLabelTimer),a.series.forEach(function(t){var e=t.options.label,o=t.labelBySeries,r=o&&o.closest;e.enabled&&t.visible&&(t.graph||t.area)&&!t.isSeriesBoosting&&(a.labelSeries.push(t),e.minFontSize&&e.maxFontSize&&(t.sum=t.yData.reduce(function(t,e){return(t||0)+(e||0)},0),a.labelSeriesMaxSum=Math.max(a.labelSeriesMaxSum,t.sum)),"load"===i.type&&(h=Math.max(h,Y(t.options.animation).duration)),r&&(void 0!==r[0].plotX?o.animate({x:r[0].plotX+r[1],y:r[0].plotY+r[2]}):o.attr({opacity:0})))}),a.seriesLabelTimer=n(function(){a.series&&a.labelSeries&&a.drawSeriesLabels()},a.renderer.forExport||!h?0:h)}var r=t.addEvent,Y=t.animObject,X=t.extend,x=t.isNumber,w=t.pick,n=t.syncTimeout,i=e.Series,a=e.SVGRenderer,h=e.Chart;e.setOptions({plotOptions:{series:{label:{enabled:!0,connectorAllowed:!1,connectorNeighbourDistance:24,minFontSize:null,maxFontSize:null,onArea:null,style:{fontWeight:"bold"},boxesToAvoid:[]}}}}),a.prototype.symbols.connector=function(t,e,o,r,i){var a=i&&i.anchorX;i=i&&i.anchorY;var h=o/2;if(x(a)&&x(i)){var n=["M",a,i],s=e-i;s<0&&(s=-r-s),s<o&&(h=a<t+o/2?s:o-s),e+r<i?n.push("L",t+h,e+r):i<e?n.push("L",t+h,e):a<t?n.push("L",t,e+r/2):t+o<a&&n.push("L",t+o,e+r/2)}return n||[]},i.prototype.getPointsOnGraph=function(){function t(t){var e=Math.round(t.plotX/8)+","+Math.round(t.plotY/8);p[e]||(p[e]=1,r.push(t))}if(this.xAxis||this.yAxis){var e,o=this.points,r=[],i=this.graph||this.area,a=i.element,h=this.chart.inverted,n=this.xAxis,s=this.yAxis,l=h?s.pos:n.pos;h=h?n.pos:s.pos,n=w(this.options.label.onArea,!!this.area);var c=s.getThreshold(this.options.threshold),p={};if(this.getPointSpline&&a.getPointAtLength&&!n&&o.length<this.chart.plotSizeX/16){if(i.toD){var d=i.attr("d");i.attr({d:i.toD})}var u=a.getTotalLength();for(e=0;e<u;e+=16)t({chartX:l+(s=a.getPointAtLength(e)).x,chartY:h+s.y,plotX:s.x,plotY:s.y});d&&i.attr({d:d}),(s=o[o.length-1]).chartX=l+s.plotX,s.chartY=h+s.plotY,t(s)}else for(u=o.length,e=0;e<u;e+=1){if(s=o[e],d=o[e-1],s.chartX=l+s.plotX,s.chartY=h+s.plotY,n&&(s.chartCenterY=h+(s.plotY+w(s.yBottom,c))/2),0<e&&(i=Math.abs(s.chartX-d.chartX),a=Math.abs(s.chartY-d.chartY),16<(i=Math.max(i,a))))for(i=Math.ceil(i/16),a=1;a<i;a+=1)t({chartX:d.chartX+a/i*(s.chartX-d.chartX),chartY:d.chartY+a/i*(s.chartY-d.chartY),chartCenterY:d.chartCenterY+a/i*(s.chartCenterY-d.chartCenterY),plotX:d.plotX+a/i*(s.plotX-d.plotX),plotY:d.plotY+a/i*(s.plotY-d.plotY)});x(s.plotY)&&t(s)}return r}},i.prototype.labelFontSize=function(t,e){return t+this.sum/this.chart.labelSeriesMaxSum*(e-t)+"px"},i.prototype.checkClearPoint=function(t,e,o,r){var i,a,h=Number.MAX_VALUE,n=Number.MAX_VALUE,s=w(this.options.label.onArea,!!this.area),l=s||this.options.label.connectorAllowed,c=this.chart;for(a=0;a<c.boxesToAvoid.length;a+=1){var p=c.boxesToAvoid[a],d=t+o.width,u=e,x=e+o.height;if(!(t>p.right||d<p.left||u>p.bottom||x<p.top))return!1}for(a=0;a<c.series.length;a+=1)if(p=(u=c.series[a]).interpolatedPoints,u.visible&&p){for(d=1;d<p.length;d+=1){if(p[d].chartX>=t-16&&p[d-1].chartX<=t+o.width+16){if(g(t,e,o.width,o.height,p[d-1].chartX,p[d-1].chartY,p[d].chartX,p[d].chartY))return!1;this===u&&!i&&r&&(i=g(t-16,e-16,o.width+32,o.height+32,p[d-1].chartX,p[d-1].chartY,p[d].chartX,p[d].chartY))}if((l||i)&&(this!==u||s)){x=t+o.width/2-p[d].chartX;var f=e+o.height/2-p[d].chartY;h=Math.min(h,x*x+f*f)}}if(!s&&l&&this===u&&(r&&!i||h<Math.pow(this.options.label.connectorNeighbourDistance,2))){for(d=1;d<p.length;d+=1)if((i=Math.min(Math.pow(t+o.width/2-p[d].chartX,2)+Math.pow(e+o.height/2-p[d].chartY,2),Math.pow(t-p[d].chartX,2)+Math.pow(e-p[d].chartY,2),Math.pow(t+o.width-p[d].chartX,2)+Math.pow(e-p[d].chartY,2),Math.pow(t+o.width-p[d].chartX,2)+Math.pow(e+o.height-p[d].chartY,2),Math.pow(t-p[d].chartX,2)+Math.pow(e+o.height-p[d].chartY,2)))<n){n=i;var b=p[d]}i=!0}}return!(r&&!i)&&{x:t,y:e,weight:h-(b?n:0),connectorPoint:b}},h.prototype.drawSeriesLabels=function(){var m=this,t=this.labelSeries;m.boxesToAvoid=[],t.forEach(function(t){t.interpolatedPoints=t.getPointsOnGraph(),(t.options.label.boxesToAvoid||[]).forEach(function(t){m.boxesToAvoid.push(t)})}),m.series.forEach(function(t){function e(t,e,o){var r=Math.max(h,w(g,-1/0)),i=Math.min(h+s,w(y,1/0));return r<t&&t<=i-o.width&&n<=e&&e<=n+l-o.height}if(t.xAxis||t.yAxis){var o,r,i=[],a=t.options.label,h=(r=m.inverted)?t.yAxis.pos:t.xAxis.pos,n=r?t.xAxis.pos:t.yAxis.pos,s=m.inverted?t.yAxis.len:t.xAxis.len,l=m.inverted?t.xAxis.len:t.yAxis.len,c=t.interpolatedPoints,p=w(a.onArea,!!t.area),d=t.labelBySeries,u=!d,x=a.minFontSize,f=a.maxFontSize,b="highcharts-color-"+w(t.colorIndex,"none");if(p&&!r){r=[t.xAxis.toPixels(t.xData[0]),t.xAxis.toPixels(t.xData[t.xData.length-1])];var g=Math.min.apply(Math,r),y=Math.max.apply(Math,r)}if(t.visible&&!t.isSeriesBoosting&&c){for(d||(t.labelBySeries=d=m.renderer.label(t.name,0,-9999,"connector").addClass("highcharts-series-label highcharts-series-label-"+t.index+" "+(t.options.className||"")+b),m.renderer.styledMode||d.css(X({color:p?m.renderer.getContrast(t.color):t.color},t.options.label.style)),x&&f&&d.css({fontSize:t.labelFontSize(x,f)}),d.attr({padding:0,opacity:m.renderer.forExport?1:0,stroke:t.color,"stroke-width":1,zIndex:3}).add()),(x=d.getBBox()).width=Math.round(x.width),r=c.length-1;0<r;--r)p?e(f=c[r].chartX-x.width/2,b=c[r].chartCenterY-x.height/2,x)&&(o=t.checkClearPoint(f,b,x)):(e(f=c[r].chartX+3,b=c[r].chartY-x.height-3,x)&&(o=t.checkClearPoint(f,b,x,!0)),o&&i.push(o),e(f=c[r].chartX+3,b=c[r].chartY+3,x)&&(o=t.checkClearPoint(f,b,x,!0)),o&&i.push(o),e(f=c[r].chartX-x.width-3,b=c[r].chartY+3,x)&&(o=t.checkClearPoint(f,b,x,!0)),o&&i.push(o),e(f=c[r].chartX-x.width-3,b=c[r].chartY-x.height-3,x)&&(o=t.checkClearPoint(f,b,x,!0))),o&&i.push(o);if(a.connectorAllowed&&!i.length&&!p)for(f=h+s-x.width;h<=f;f-=16)for(b=n;b<n+l-x.height;b+=16)(o=t.checkClearPoint(f,b,x,!0))&&i.push(o);i.length?(i.sort(function(t,e){return e.weight-t.weight}),o=i[0],m.boxesToAvoid.push({left:o.x,right:o.x+x.width,top:o.y,bottom:o.y+x.height}),(i=Math.sqrt(Math.pow(Math.abs(o.x-d.x),2),Math.pow(Math.abs(o.y-d.y),2)))&&(a={opacity:m.renderer.forExport?1:0,x:o.x,y:o.y},c={opacity:1},i<=10&&(c={x:a.x,y:a.y},a={}),t.labelBySeries.attr(X(a,{anchorX:o.connectorPoint&&o.connectorPoint.plotX+h,anchorY:o.connectorPoint&&o.connectorPoint.plotY+n})).animate(c,u?.2*Y(t.options.animation).duration:m.renderer.globalAnimation),t.options.kdNow=!0,t.buildKDTree(),t=t.searchPoint({chartX:o.x,chartY:o.y},!0),d.closest=[t,o.x-t.plotX,o.y-t.plotY])):d&&(t.labelBySeries=d.destroy())}else d&&(t.labelBySeries=d.destroy())}}),e.fireEvent(m,"afterDrawSeriesLabels")},r(h,"load",o),r(h,"redraw",o)}),e(t,"masters/modules/series-label.src.js",[],function(){})});