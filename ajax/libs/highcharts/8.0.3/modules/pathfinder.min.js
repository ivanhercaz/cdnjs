!function(n){"object"==typeof module&&module.exports?module.exports=n.default=n:"function"==typeof define&&define.amd?define("highcharts/modules/pathfinder",["highcharts"],function(t){return n(t),n.Highcharts=t,n}):n("undefined"!=typeof Highcharts?Highcharts:void 0)}(function(t){function n(t,n,r,i){t.hasOwnProperty(n)||(t[n]=i.apply(null,r))}n(t=t?t._modules:{},"parts-gantt/PathfinderAlgorithms.js",[t["parts/Utilities.js"]],function(t){function v(t,n,r){r=r||0;var i,e,a=t.length-1;for(n-=1e-7;r<=a;)if(0<(e=n-t[i=a+r>>1].xMin))r=1+i;else{if(!(e<0))return i;a=i-1}return 0<r?r-1:0}function P(t,n){for(var r=v(t,n.x+1)+1;r--;){var i;if((i=t[r].xMax>=n.x)&&(i=t[r],i=n.x<=i.xMax&&n.x>=i.xMin&&n.y<=i.yMax&&n.y>=i.yMin),i)return r}return-1}function k(t){var n=[];if(t.length){n.push("M",t[0].start.x,t[0].start.y);for(var r=0;r<t.length;++r)n.push("L",t[r].end.x,t[r].end.y)}return n}function O(t,n){t.yMin=A(t.yMin,n.yMin),t.yMax=R(t.yMax,n.yMax),t.xMin=A(t.xMin,n.xMin),t.xMax=R(t.xMax,n.xMax)}var n=t.extend,w=t.pick,R=Math.min,A=Math.max,S=Math.abs;return{straight:function(t,n){return{path:["M",t.x,t.y,"L",n.x,n.y],obstacles:[{start:t,end:n}]}},simpleConnect:n(function(t,n,r){function e(t,n,r,i,e){return(t={x:t.x,y:t.y})[n]=r[i||n]+(e||0),t}function i(t,n,r){var i=S(n[r]-t[r+"Min"])>S(n[r]-t[r+"Max"]);return e(n,r,t,r+(i?"Max":"Min"),i?1:-1)}var a=[],o=w(r.startDirectionX,S(n.x-t.x)>S(n.y-t.y))?"x":"y",s=r.chartObstacles,h=P(s,t);if(-1<(r=P(s,n))){var c=s[r];c={start:r=i(c,n,o),end:n};var x=r}else x=n;return-1<h&&(r=i(s=s[h],t,o),a.push({start:t,end:r}),r[o]>=t[o]==r[o]>=x[o]&&(n=t[o="y"===o?"x":"y"]<n[o],a.push({start:r,end:e(r,o,s,o+(n?"Max":"Min"),n?1:-1)}),o="y"===o?"x":"y")),r=e(t=a.length?a[a.length-1].end:t,o,x),a.push({start:t,end:r}),o=e(r,"y"===o?"x":"y",x),a.push({start:r,end:o}),a.push(c),{path:k(a),obstacles:a}},{requiresObstacles:!0}),fastAvoid:n(function(t,n,x){function d(t,n,r){var i,e=t.x<n.x?1:-1;if(t.x<n.x)var a=t,o=n;else a=n,o=t;if(t.y<n.y)var s=t,h=n;else s=n,h=t;for(i=e<0?R(v(g,o.x),g.length-1):0;g[i]&&(0<e&&g[i].xMin<=o.x||e<0&&g[i].xMax>=a.x);){if(g[i].xMin<=o.x&&g[i].xMax>=a.x&&g[i].yMin<=h.y&&g[i].yMax>=s.y)return r?{y:t.y,x:t.x<n.x?g[i].xMin-1:g[i].xMax+1,obstacle:g[i]}:{x:t.x,y:t.y<n.y?g[i].yMin-1:g[i].yMax+1,obstacle:g[i]};i+=e}return n}function l(t,n,r,i,e){var a=e.soft,o=e.hard,s=i?"x":"y",h={x:n.x,y:n.y},c={x:n.x,y:n.y};e=t[s+"Max"]>=a[s+"Max"],a=t[s+"Min"]<=a[s+"Min"];var x=t[s+"Max"]>=o[s+"Max"];o=t[s+"Min"]<=o[s+"Min"];var l=S(t[s+"Min"]-n[s]),M=S(t[s+"Max"]-n[s]);return r=S(l-M)<10?n[s]<r[s]:M<l,c[s]=t[s+"Min"],h[s]=t[s+"Max"],t=d(n,c,i)[s]!==c[s],n=d(n,h,i)[s]!==h[s],r=t?!n||r:!n&&r,r=a?!e||r:!e&&r,o?!x||r:!x&&r}var r,i,e,a,o=w(x.startDirectionX,S(n.x-t.x)>S(n.y-t.y)),s=o?"x":"y",h=[],M=!1,c=x.obstacleMetrics,y=R(t.x,n.x)-c.maxWidth-10,p=A(t.x,n.x)+c.maxWidth+10,f=R(t.y,n.y)-c.maxHeight-10,u=A(t.y,n.y)+c.maxHeight+10,g=x.chartObstacles,m=v(g,y);if(c=v(g,p),-1<(c=P(g=g.slice(m,c+1),n))){var b=(r=g[c],i=n,e=t,a=R(r.xMax-i.x,i.x-r.xMin)<R(r.yMax-i.y,i.y-r.yMin),e=l(r,i,e,a,{soft:x.hardBounds,hard:x.hardBounds}),a?{y:i.y,x:r[e?"xMax":"xMin"]+(e?1:-1)}:{x:i.x,y:r[e?"yMax":"yMin"]+(e?1:-1)});h.push({end:n,start:b}),n=b}for(;-1<(c=P(g,n));)m=n[s]-t[s]<0,(b={x:n.x,y:n.y})[s]=g[c][m?s+"Max":s+"Min"]+(m?1:-1),h.push({end:n,start:b}),n=b;return{path:k(t=(t=function t(n,r,i){if(n.x===r.x&&n.y===r.y)return[];var e=i?"x":"y",a=x.obstacleOptions.margin,o={soft:{xMin:y,xMax:p,yMin:f,yMax:u},hard:x.hardBounds},s=P(g,n);if(-1<s){o=l(s=g[s],n,r,i,o),O(s,x.hardBounds);var h=i?{y:n.y,x:s[o?"xMax":"xMin"]+(o?1:-1)}:{x:n.x,y:s[o?"yMax":"yMin"]+(o?1:-1)},c=P(g,h);-1<c&&(O(c=g[c],x.hardBounds),h[e]=o?A(s[e+"Max"]-a+1,(c[e+"Min"]+s[e+"Max"])/2):R(s[e+"Min"]+a-1,(c[e+"Max"]+s[e+"Min"])/2),M=n.x===h.x&&n.y===h.y&&(M&&(h[e]=o?A(s[e+"Max"],c[e+"Max"])+1:R(s[e+"Min"],c[e+"Min"])-1),!M)),n=[{start:n,end:h}]}else n=[{start:n,end:{x:(e=d(n,{x:i?r.x:n.x,y:i?n.y:r.y},i)).x,y:e.y}}],e[i?"x":"y"]!==r[i?"x":"y"]&&(o=l(e.obstacle,e,r,!i,o),O(e.obstacle,x.hardBounds),o={x:i?e.x:e.obstacle[o?"xMax":"xMin"]+(o?1:-1),y:i?e.obstacle[o?"yMax":"yMin"]+(o?1:-1):e.y},i=!i,n=n.concat(t({x:e.x,y:e.y},o,i)));return n.concat(t(n[n.length-1].end,r,!i))}(t,n,o)).concat(h.reverse())),obstacles:t}},{requiresObstacles:!0})}}),n(t,"parts-gantt/ArrowSymbols.js",[t["parts/Globals.js"]],function(e){e.SVGRenderer.prototype.symbols.arrow=function(t,n,r,i){return["M",t,n+i/2,"L",t+r,n,"L",t,n+i/2,"L",t+r,n+i]},e.SVGRenderer.prototype.symbols["arrow-half"]=function(t,n,r,i){return e.SVGRenderer.prototype.symbols.arrow(t,n,r/2,i)},e.SVGRenderer.prototype.symbols["triangle-left"]=function(t,n,r,i){return["M",t+r,n,"L",t,n+i/2,"L",t+r,n+i,"Z"]},e.SVGRenderer.prototype.symbols["arrow-filled"]=e.SVGRenderer.prototype.symbols["triangle-left"],e.SVGRenderer.prototype.symbols["triangle-left-half"]=function(t,n,r,i){return e.SVGRenderer.prototype.symbols["triangle-left"](t,n,r/2,i)},e.SVGRenderer.prototype.symbols["arrow-filled-half"]=e.SVGRenderer.prototype.symbols["triangle-left-half"]}),n(t,"parts-gantt/Pathfinder.js",[t["parts/Globals.js"],t["parts/Point.js"],t["parts/Utilities.js"],t["parts-gantt/PathfinderAlgorithms.js"]],function(t,c,n,r){function f(t){var n=t.shapeArgs;return n?{xMin:n.x,xMax:n.x+n.width,yMin:n.y,yMax:n.y+n.height}:(n=t.graphic&&t.graphic.getBBox())?{xMin:t.plotX-n.width/2,xMax:t.plotX+n.width/2,yMin:t.plotY-n.height/2,yMax:t.plotY+n.height/2}:null}function x(t,n,r){this.init(t,n,r)}function i(t){this.init(t)}var e=n.addEvent,l=n.defined,a=n.error,o=n.extend,s=n.merge,h=n.objectEach,M=n.pick,d=n.splat,y=t.deg2rad,p=Math.max,u=Math.min;o(t.defaultOptions,{connectors:{type:"straight",lineWidth:1,marker:{enabled:!1,align:"center",verticalAlign:"middle",inside:!1,lineWidth:1},startMarker:{symbol:"diamond"},endMarker:{symbol:"arrow-filled"}}}),x.prototype={init:function(t,n,r){this.fromPoint=t,this.toPoint=n,this.options=r,this.chart=t.series.chart,this.pathfinder=this.chart.pathfinder},renderPath:function(t,n,r){var i=this.chart,e=i.styledMode,a=i.pathfinder,o=!i.options.chart.forExport&&!1!==r,s=this.graphics&&this.graphics.path;a.group||(a.group=i.renderer.g().addClass("highcharts-pathfinder-group").attr({zIndex:-1}).add(i.seriesGroup)),a.group.translate(i.plotLeft,i.plotTop),s&&s.renderer||(s=i.renderer.path().add(a.group),e||s.attr({opacity:0})),s.attr(n),t={d:t},e||(t.opacity=1),s[o?"animate":"attr"](t,r),this.graphics=this.graphics||{},this.graphics.path=s},addMarker:function(t,n,r){var i=this.fromPoint.series.chart,e=i.pathfinder;i=i.renderer;var a="start"===t?this.fromPoint:this.toPoint,o=a.getPathfinderAnchorPoint(n);if(n.enabled){if(r="start"===t?{x:r[4],y:r[5]}:{x:r[r.length-5],y:r[r.length-4]},r=a.getRadiansToVector(r,o),o=a.getMarkerVector(r,n.radius,o),r=-r/y,n.width&&n.height)var s=n.width,h=n.height;else s=h=2*n.radius;this.graphics=this.graphics||{},o={x:o.x-s/2,y:o.y-h/2,width:s,height:h,rotation:r,rotationOriginX:o.x,rotationOriginY:o.y},this.graphics[t]?this.graphics[t].animate(o):(this.graphics[t]=i.symbol(n.symbol).addClass("highcharts-point-connecting-path-"+t+"-marker").attr(o).add(e.group),i.styledMode||this.graphics[t].attr({fill:n.color||this.fromPoint.color,stroke:n.lineColor,"stroke-width":n.lineWidth,opacity:0}).animate({opacity:1},a.series.options.animation))}},getPath:function(t){var n=this.pathfinder,r=this.chart,i=n.algorithms[t.type],e=n.chartObstacles;if("function"==typeof i)return i.requiresObstacles&&!e&&(e=n.chartObstacles=n.getChartObstacles(t),r.options.connectors.algorithmMargin=t.algorithmMargin,n.chartObstacleMetrics=n.getObstacleMetrics(e)),i(this.fromPoint.getPathfinderAnchorPoint(t.startMarker),this.toPoint.getPathfinderAnchorPoint(t.endMarker),s({chartObstacles:e,lineObstacles:n.lineObstacles||[],obstacleMetrics:n.chartObstacleMetrics,hardBounds:{xMin:0,xMax:r.plotWidth,yMin:0,yMax:r.plotHeight},obstacleOptions:{margin:t.algorithmMargin},startDirectionX:n.getAlgorithmStartDirection(t.startMarker)},t));a('"'+t.type+'" is not a Pathfinder algorithm.')},render:function(){var t=this.fromPoint,n=t.series,r=n.chart,i=r.pathfinder,e=s(r.options.connectors,n.options.connectors,t.options.connectors,this.options),a={};r.styledMode||(a.stroke=e.lineColor||t.color,a["stroke-width"]=e.lineWidth,e.dashStyle&&(a.dashstyle=e.dashStyle)),a.class="highcharts-point-connecting-path highcharts-color-"+t.colorIndex,e=s(a,e),l(e.marker.radius)||(e.marker.radius=u(p(Math.ceil((e.algorithmMargin||8)/2)-1,1),5)),r=(t=this.getPath(e)).path,t.obstacles&&(i.lineObstacles=i.lineObstacles||[],i.lineObstacles=i.lineObstacles.concat(t.obstacles)),this.renderPath(r,a,n.options.animation),this.addMarker("start",s(e.marker,e.startMarker),r),this.addMarker("end",s(e.marker,e.endMarker),r)},destroy:function(){this.graphics&&(h(this.graphics,function(t){t.destroy()}),delete this.graphics)}},i.prototype={algorithms:r,init:function(t){this.chart=t,this.connections=[],e(t,"redraw",function(){this.pathfinder.update()})},update:function(t){var i=this.chart,e=this,n=e.connections;e.connections=[],i.series.forEach(function(t){t.visible&&!t.options.isInternal&&t.points.forEach(function(n){var r,t=n.options&&n.options.connect&&d(n.options.connect);n.visible&&!1!==n.isInside&&t&&t.forEach(function(t){(r=i.get("string"==typeof t?t:t.to))instanceof c&&r.series.visible&&r.visible&&!1!==r.isInside&&e.connections.push(new x(n,r,"string"==typeof t?{}:t))})})});for(var r,a,o=0,s=n.length,h=e.connections.length;o<s;++o){for(a=!1,r=0;r<h;++r)if(n[o].fromPoint===e.connections[r].fromPoint&&n[o].toPoint===e.connections[r].toPoint){e.connections[r].graphics=n[o].graphics,a=!0;break}a||n[o].destroy()}delete this.chartObstacles,delete this.lineObstacles,e.renderConnections(t)},renderConnections:function(t){t?this.chart.series.forEach(function(n){function t(){var t=n.chart.pathfinder;(t&&t.connections||[]).forEach(function(t){t.fromPoint&&t.fromPoint.series===n&&t.render()}),n.pathfinderRemoveRenderEvent&&(n.pathfinderRemoveRenderEvent(),delete n.pathfinderRemoveRenderEvent)}!1===n.options.animation?t():n.pathfinderRemoveRenderEvent=e(n,"afterAnimate",t)}):this.connections.forEach(function(t){t.render()})},getChartObstacles:function(t){for(var n,r=[],i=this.chart.series,e=M(t.algorithmMargin,0),a=0,o=i.length;a<o;++a)if(i[a].visible&&!i[a].options.isInternal)for(var s,h=0,c=i[a].points.length;h<c;++h)(s=i[a].points[h]).visible&&(s=f(s))&&r.push({xMin:s.xMin-e,xMax:s.xMax+e,yMin:s.yMin-e,yMax:s.yMax+e});return r=r.sort(function(t,n){return t.xMin-n.xMin}),l(t.algorithmMargin)||(n=t.algorithmMargin=function(t){for(var n,r,i=t.length,e=0,a=[],s=function(t,n,r){r=M(r,10);var i=t.yMax+r>n.yMin-r&&t.yMin-r<n.yMax+r,e=t.xMax+r>n.xMin-r&&t.xMin-r<n.xMax+r,a=i?t.xMin>n.xMax?t.xMin-n.xMax:n.xMin-t.xMax:1/0,o=e?t.yMin>n.yMax?t.yMin-n.yMax:n.yMin-t.yMax:1/0;return e&&i?r?s(t,n,Math.floor(r/2)):1/0:u(a,o)};e<i;++e)for(n=e+1;n<i;++n)(r=s(t[e],t[n]))<80&&a.push(r);return a.push(80),p(Math.floor(a.sort(function(t,n){return t-n})[Math.floor(a.length/10)]/2-1),1)}(r),r.forEach(function(t){t.xMin-=n,t.xMax+=n,t.yMin-=n,t.yMax+=n})),r},getObstacleMetrics:function(t){for(var n,r,i=0,e=0,a=t.length;a--;)i<(n=t[a].xMax-t[a].xMin)&&(i=n),e<(r=t[a].yMax-t[a].yMin)&&(e=r);return{maxHeight:e,maxWidth:i}},getAlgorithmStartDirection:function(t){var n="top"!==t.verticalAlign&&"bottom"!==t.verticalAlign;return"left"!==t.align&&"right"!==t.align?n&&void 0:n||void 0}},t.Connection=x,t.Pathfinder=i,o(c.prototype,{getPathfinderAnchorPoint:function(t){var n=f(this);switch(t.align){case"right":var r="xMax";break;case"left":r="xMin"}switch(t.verticalAlign){case"top":var i="yMin";break;case"bottom":i="yMax"}return{x:r?n[r]:(n.xMin+n.xMax)/2,y:i?n[i]:(n.yMin+n.yMax)/2}},getRadiansToVector:function(t,n){return l(n)||(n={x:((n=f(this)).xMin+n.xMax)/2,y:(n.yMin+n.yMax)/2}),Math.atan2(n.y-t.y,t.x-n.x)},getMarkerVector:function(t,n,r){var i=2*Math.PI,e=f(this),a=e.xMax-e.xMin,o=e.yMax-e.yMin,s=Math.atan2(o,a),h=!1;a/=2;for(var c=o/2,x=e.xMin+a,l=x,M=e=e.yMin+c,d={},y=1,p=1;t<-Math.PI;)t+=i;for(;t>Math.PI;)t-=i;return i=Math.tan(t),-s<t&&t<=s?(p=-1,h=!0):s<t&&t<=Math.PI-s?p=-1:t>Math.PI-s||t<=-(Math.PI-s)?(y=-1,h=!0):y=-1,h?(l+=y*a,M+=p*a*i):(l+=o/(2*i)*y,M+=p*c),r.x!==x&&(l=r.x),r.y!==e&&(M=r.y),d.x=l+n*Math.cos(t),d.y=M-n*Math.sin(t),d}}),t.Chart.prototype.callbacks.push(function(t){var n;!1!==t.options.connectors.enabled&&(((n=t).options.pathfinder||n.series.reduce(function(t,n){return n.options&&s(!0,n.options.connectors=n.options.connectors||{},n.options.pathfinder),t||n.options&&n.options.pathfinder},!1))&&(s(!0,n.options.connectors=n.options.connectors||{},n.options.pathfinder),a('WARNING: Pathfinder options have been renamed. Use "chart.connectors" or "series.connectors" instead.')),this.pathfinder=new i(this),this.pathfinder.update(!0))})}),n(t,"masters/modules/pathfinder.src.js",[],function(){})});