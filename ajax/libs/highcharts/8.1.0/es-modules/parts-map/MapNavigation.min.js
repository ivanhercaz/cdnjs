"use strict";import H from"../parts/Globals.js";import U from"../parts/Utilities.js";var addEvent=U.addEvent,extend=U.extend,merge=U.merge,objectEach=U.objectEach,pick=U.pick;import"../parts/Chart.js";var Chart=H.Chart,doc=H.doc;function stopEvent(t){t&&(t.preventDefault&&t.preventDefault(),t.stopPropagation&&t.stopPropagation(),t.cancelBubble=!0)}function MapNavigation(t){this.init(t)}MapNavigation.prototype.init=function(t){this.chart=t,t.mapNavButtons=[]},MapNavigation.prototype.update=function(t){var i,e,n,a,o,s=this.chart,d=s.options.mapNavigation,h=function(t){this.handler.call(s,t),stopEvent(t)},p=s.mapNavButtons;for(t&&(d=s.options.mapNavigation=merge(s.options.mapNavigation,t));p.length;)p.pop().destroy();pick(d.enableButtons,d.enabled)&&!s.renderer.forExport&&objectEach(d.buttons,function(t,r){i=merge(d.buttonOptions,t),s.styledMode||((e=i.theme).style=merge(i.theme.style,i.style),n=e.states,a=n&&n.hover,o=n&&n.select),(t=s.renderer.button(i.text,0,0,h,e,a,o,0,"zoomIn"===r?"topbutton":"bottombutton").addClass("highcharts-map-navigation highcharts-"+{zoomIn:"zoom-in",zoomOut:"zoom-out"}[r]).attr({width:i.width,height:i.height,title:s.options.lang[r],padding:i.padding,zIndex:5}).add()).handler=i.onclick,addEvent(t.element,"dblclick",stopEvent),p.push(t);var l=i,c=addEvent(s,"load",function(){t.align(extend(l,{width:t.width,height:2*t.height}),null,l.alignTo),c()})}),this.updateEvents(d)},MapNavigation.prototype.updateEvents=function(t){var i=this.chart;pick(t.enableDoubleClickZoom,t.enabled)||t.enableDoubleClickZoomTo?this.unbindDblClick=this.unbindDblClick||addEvent(i.container,"dblclick",function(t){i.pointer.onContainerDblClick(t)}):this.unbindDblClick&&(this.unbindDblClick=this.unbindDblClick()),pick(t.enableMouseWheelZoom,t.enabled)?this.unbindMouseWheel=this.unbindMouseWheel||addEvent(i.container,void 0===doc.onmousewheel?"DOMMouseScroll":"mousewheel",function(t){return i.pointer.onContainerMouseWheel(t),stopEvent(t),!1}):this.unbindMouseWheel&&(this.unbindMouseWheel=this.unbindMouseWheel())},extend(Chart.prototype,{fitToBox:function(t,i){return[["x","width"],["y","height"]].forEach(function(e){var n=e[0],a=e[1];t[n]+t[a]>i[n]+i[a]&&(t[a]>i[a]?(t[a]=i[a],t[n]=i[n]):t[n]=i[n]+i[a]-t[a]),t[a]>i[a]&&(t[a]=i[a]),t[n]<i[n]&&(t[n]=i[n])}),t},mapZoom:function(t,i,e,n,a){var o=this.xAxis[0],s=o.max-o.min,d=pick(i,o.min+s/2),h=s*t,p=this.yAxis[0],r=p.max-p.min,l=pick(e,p.min+r/2),c=r*t,u=d-h*(n?(n-o.pos)/o.len:.5),m=l-c*(a?(a-p.pos)/p.len:.5),v=this.fitToBox({x:u,y:m,width:h,height:c},{x:o.dataMin,y:p.dataMin,width:o.dataMax-o.dataMin,height:p.dataMax-p.dataMin}),b=v.x<=o.dataMin&&v.width>=o.dataMax-o.dataMin&&v.y<=p.dataMin&&v.height>=p.dataMax-p.dataMin;n&&o.mapAxis&&(o.mapAxis.fixTo=[n-o.pos,i]),a&&p.mapAxis&&(p.mapAxis.fixTo=[a-p.pos,e]),void 0===t||b?(o.setExtremes(void 0,void 0,!1),p.setExtremes(void 0,void 0,!1)):(o.setExtremes(v.x,v.x+v.width,!1),p.setExtremes(v.y,v.y+v.height,!1)),this.redraw()}}),addEvent(Chart,"beforeRender",function(){this.mapNavigation=new MapNavigation(this),this.mapNavigation.update()}),H.MapNavigation=MapNavigation;