!function(t){"object"==typeof module&&module.exports?module.exports=t.default=t:"function"==typeof define&&define.amd?define("highcharts/modules/export-data",["highcharts","highcharts/modules/exporting"],function(e){return t(e),t.Highcharts=e,t}):t("undefined"!=typeof Highcharts?Highcharts:void 0)}(function(e){function t(e,t,a,o){e.hasOwnProperty(t)||(e[t]=o.apply(null,a))}t(e=e?e._modules:{},"mixins/ajax.js",[e["parts/Globals.js"],e["parts/Utilities.js"]],function(a,e){var o=e.merge,r=e.objectEach;a.ajax=function(e){var t=o(!0,{url:!1,type:"get",dataType:"json",success:!1,error:!1,data:!1,headers:{}},e);e={json:"application/json",xml:"application/xml",text:"text/plain",octet:"application/octet-stream"};var a=new XMLHttpRequest;if(!t.url)return!1;a.open(t.type.toUpperCase(),t.url,!0),t.headers["Content-Type"]||a.setRequestHeader("Content-Type",e[t.dataType]||e.text),r(t.headers,function(e,t){a.setRequestHeader(t,e)}),a.onreadystatechange=function(){if(4===a.readyState){if(200===a.status){var e=a.responseText;if("json"===t.dataType)try{e=JSON.parse(e)}catch(e){return void(t.error&&t.error(a,e))}return t.success&&t.success(e)}t.error&&t.error(a,a.responseText)}};try{t.data=JSON.stringify(t.data)}catch(e){}a.send(t.data||!0)},a.getJSON=function(e,t){a.ajax({url:e,success:t,dataType:"json",headers:{"Content-Type":"text/plain"}})}}),t(e,"mixins/download-url.js",[e["parts/Globals.js"]],function(r){var n=r.win,i=n.navigator,s=n.document,l=n.URL||n.webkitURL||n,c=/Edge\/\d+/.test(i.userAgent);r.dataURLtoBlob=function(e){if((e=e.match(/data:([^;]*)(;base64)?,([0-9A-Za-z+/]+)/))&&3<e.length&&n.atob&&n.ArrayBuffer&&n.Uint8Array&&n.Blob&&l.createObjectURL){for(var t=n.atob(e[3]),a=new n.ArrayBuffer(t.length),a=new n.Uint8Array(a),o=0;o<a.length;++o)a[o]=t.charCodeAt(o);return e=new n.Blob([a],{type:e[1]}),l.createObjectURL(e)}},r.downloadURL=function(t,e){var a=s.createElement("a");if("string"==typeof t||t instanceof String||!i.msSaveOrOpenBlob){if((c||2e6<t.length)&&!(t=r.dataURLtoBlob(t)))throw Error("Failed to convert to blob");if(void 0!==a.download)a.href=t,a.download=e,s.body.appendChild(a),a.click(),s.body.removeChild(a);else try{var o=n.open(t,"chart");if(null==o)throw Error("Failed to open window")}catch(e){n.location.href=t}}else i.msSaveOrOpenBlob(t,e)}}),t(e,"modules/export-data.src.js",[e["parts/Globals.js"],e["parts/Utilities.js"]],function(C,e){function t(e,t){var a=i.navigator,o=-1<a.userAgent.indexOf("WebKit")&&a.userAgent.indexOf("Chrome")<0,r=i.URL||i.webkitURL||i;try{if(a.msSaveOrOpenBlob&&i.MSBlobBuilder){var n=new i.MSBlobBuilder;return n.append(e),n.getBlob("image/svg+xml")}if(!o)return r.createObjectURL(new i.Blob(["\ufeff"+e],{type:t}))}catch(e){}}var d=e.defined,a=e.extend,D=e.pick,i=C.win,o=i.document,r=C.seriesTypes,n=C.downloadURL,h=C.fireEvent;C.setOptions({exporting:{csv:{columnHeaderFormatter:null,dateFormat:"%Y-%m-%d %H:%M:%S",decimalPoint:null,itemDelimiter:null,lineDelimiter:"\n"},showTable:!1,useMultiLevelHeaders:!0,useRowspanHeaders:!0},lang:{downloadCSV:"Download CSV",downloadXLS:"Download XLS",exportData:{categoryHeader:"Category",categoryDatetimeHeader:"DateTime"},viewData:"View data table"}}),C.addEvent(C.Chart,"render",function(){this.options&&this.options.exporting&&this.options.exporting.showTable&&!this.options.chart.forExport&&this.viewData()}),C.Chart.prototype.setUpKeyToAxis=function(){r.arearange&&(r.arearange.prototype.keyToAxis={low:"y",high:"y"}),r.gantt&&(r.gantt.prototype.keyToAxis={start:"x",end:"x"})},C.Chart.prototype.getDataRows=function(u){function e(e,t,a){if(g.columnHeaderFormatter){var o=g.columnHeaderFormatter(e,t,a);if(!1!==o)return o}return e?e instanceof C.Axis?e.options.title&&e.options.title.text||(e.dateTime?i:n):u?{columnTitle:1<a?t:e.name,topLevelColumnTitle:e.name}:e.name+(1<a?" ("+t+")":""):n}function m(a,e,o){var r={},n={};return e.forEach(function(e){var t=(a.keyToAxis&&a.keyToAxis[e]||e)+"Axis",t=C.isNumber(o)?a.chart[t][o]:a[t];r[e]=t&&t.categories||[],n[e]=t&&t.dateTime}),{categoryMap:r,dateTimeValueAxisMap:n}}var t,f=this.hasParallelCoordinates,x=this.time,g=this.options.exporting&&this.options.exporting.csv||{},a=this.xAxis,y={},o=[],b=[],v=[],r=this.options.lang.exportData,n=r.categoryHeader,i=r.categoryDatetimeHeader,w=[],T=0;for(s in this.setUpKeyToAxis(),this.series.forEach(function(r){var n,i=r.xAxis,s=r.options.keys||r.pointArrayMap||["y"],l=s.length,c=!r.requireSorting&&{},p=a.indexOf(i),d=m(r,s);if(!1!==r.options.includeInDataExport&&!r.options.isInternal&&!1!==r.visible){for(C.find(w,function(e){return e[0]===p})||w.push([p,T]),n=0;n<l;)t=e(r,s[n],s.length),v.push(t.columnTitle||t),u&&b.push(t.topLevelColumnTitle||t),n++;var h={chart:r.chart,autoIncrement:r.autoIncrement,options:r.options,pointArrayMap:r.pointArrayMap};r.options.data.forEach(function(e,t){f&&(d=m(r,s,t));var a={series:h};r.pointClass.prototype.applyOptions.apply(a,[e]),e=a.x;var o=r.data[t]&&r.data[t].name;for(n=0,(!i||"name"===r.exportKey||!f&&i&&i.hasNames)&&(e=o),c&&(c[e]&&(e+="|"+t),c[e]=!0),y[e]||(y[e]=[],y[e].xValues=[]),y[e].x=a.x,y[e].name=o,y[e].xValues[p]=a.x;n<l;)o=a[t=s[n]],y[e][T+n]=D(d.categoryMap[t][o],d.dateTimeValueAxisMap[t]?x.dateFormat(g.dateFormat,o):null,o),n++}),T+=n}}),y)Object.hasOwnProperty.call(y,s)&&o.push(y[s]);for(var s=u?[b,v]:[v],T=w.length;T--;){var l=w[T][0],c=w[T][1],p=a[l];o.sort(function(e,t){return e.xValues[l]-t.xValues[l]}),r=e(p),s[0].splice(c,0,r),u&&s[1]&&s[1].splice(c,0,r),o.forEach(function(e){var t=e.name;p&&!d(t)&&(t=p.dateTime?(e.x instanceof Date&&(e.x=e.x.getTime()),x.dateFormat(g.dateFormat,e.x)):p.categories?D(p.names[e.x],p.categories[e.x],e.x):e.x),e.splice(c,0,t)})}return s=s.concat(o),h(this,"exportData",{dataRows:s}),s},C.Chart.prototype.getCSV=function(e){var r="",n=this.getDataRows(),t=this.options.exporting.csv,i=D(t.decimalPoint,","!==t.itemDelimiter&&e?1.1.toLocaleString()[1]:"."),s=D(t.itemDelimiter,","===i?";":","),l=t.lineDelimiter;return n.forEach(function(e,t){for(var a,o=e.length;o--;)"string"==typeof(a=e[o])&&(a='"'+a+'"'),"number"==typeof a&&"."!==i&&(a=a.toString().replace(".",i)),e[o]=a;r+=e.join(s),t<n.length-1&&(r+=l)}),r},C.Chart.prototype.getTable=function(e){var a='<table id="highcharts-data-table-'+this.index+'">',l=this.options,n=e?1.1.toLocaleString()[1]:".",c=D(l.exporting.useMultiLevelHeaders,!0);e=this.getDataRows(c);function p(e,t,a,o){var r=D(o,"");return t="text"+(t?" "+t:""),"number"==typeof r?(r=r.toString(),","===n&&(r=r.replace(".",n)),t="number"):o||(t="empty"),"<"+e+(a?" "+a:"")+' class="'+t+'">'+r+"</"+e+">"}var o=0,t=c?e.shift():null,r=e.shift();!1!==l.exporting.tableCaption&&(a+='<caption class="highcharts-table-caption">'+D(l.exporting.tableCaption,l.title.text?l.title.text.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"):"Chart")+"</caption>");for(var i=0,s=e.length;i<s;++i)e[i].length>o&&(o=e[i].length);return a+=function(e,t,a){var o="<thead>",r=0;a=a||t&&t.length;var n,i=0;if(n=c&&e&&t){e:if(n=e.length,t.length===n){for(;n--;)if(e[n]!==t[n]){n=!1;break e}n=!0}else n=!1;n=!n}if(n){for(o+="<tr>";r<a;++r){n=e[r];var s=e[r+1];n===s?++i:i?(o+=p("th","highcharts-table-topheading",'scope="col" colspan="'+(i+1)+'"',n),i=0):(n===t[r]?l.exporting.useRowspanHeaders?(s=2,delete t[r]):(s=1,t[r]=""):s=1,o+=p("th","highcharts-table-topheading",'scope="col"'+(1<s?' valign="top" rowspan="'+s+'"':""),n))}o+="</tr>"}if(t){for(o+="<tr>",r=0,a=t.length;r<a;++r)void 0!==t[r]&&(o+=p("th",null,'scope="col"',t[r]));o+="</tr>"}return o+"</thead>"}(t,r,Math.max(o,r.length)),a+="<tbody>",e.forEach(function(e){a+="<tr>";for(var t=0;t<o;t++)a+=p(t?"td":"th",null,t?"":'scope="row"',e[t]);a+="</tr>"}),h(this,"afterGetTable",e={html:a+="</tbody></table>"}),e.html},C.Chart.prototype.downloadCSV=function(){var e=this.getCSV(!0);n(t(e,"text/csv")||"data:text/csv,\ufeff"+encodeURIComponent(e),this.getFilename()+".csv")},C.Chart.prototype.downloadXLS=function(){var e='<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head>\x3c!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>Ark1</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--\x3e<style>td{border:none;font-family: Calibri, sans-serif;} .number{mso-number-format:"0.00";} .text{ mso-number-format:"@";}</style><meta name=ProgId content=Excel.Sheet><meta charset=UTF-8></head><body>'+this.getTable(!0)+"</body></html>";n(t(e,"application/vnd.ms-excel")||"data:application/vnd.ms-excel;base64,"+i.btoa(unescape(encodeURIComponent(e))),this.getFilename()+".xls")},C.Chart.prototype.viewData=function(){this.dataTableDiv||(this.dataTableDiv=o.createElement("div"),this.dataTableDiv.className="highcharts-data-table",this.renderTo.parentNode.insertBefore(this.dataTableDiv,this.renderTo.nextSibling)),this.dataTableDiv.innerHTML=this.getTable(),h(this,"afterViewData",this.dataTableDiv)},(e=C.getOptions().exporting)&&(a(e.menuItemDefinitions,{downloadCSV:{textKey:"downloadCSV",onclick:function(){this.downloadCSV()}},downloadXLS:{textKey:"downloadXLS",onclick:function(){this.downloadXLS()}},viewData:{textKey:"viewData",onclick:function(){this.viewData()}}}),e.buttons&&e.buttons.contextButton.menuItems.push("separator","downloadCSV","downloadXLS","viewData")),r.map&&(r.map.prototype.exportKey="name"),r.mapbubble&&(r.mapbubble.prototype.exportKey="name"),r.treemap&&(r.treemap.prototype.exportKey="name")}),t(e,"masters/modules/export-data.src.js",[],function(){})});