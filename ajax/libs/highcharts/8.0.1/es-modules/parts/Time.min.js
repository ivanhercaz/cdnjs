"use strict";import Highcharts from"./Globals.js";import U from"./Utilities.js";var defined=U.defined,error=U.error,extend=U.extend,isObject=U.isObject,merge=U.merge,objectEach=U.objectEach,pad=U.pad,pick=U.pick,splat=U.splat,timeUnits=U.timeUnits,H=Highcharts,win=H.win,Time=function(){function e(e){this.options={},this.useUTC=!1,this.variableTimezone=!1,this.Date=win.Date,this.getTimezoneOffset=this.timezoneOffsetFunction(),this.update(e)}return e.prototype.get=function(e,t){if(this.variableTimezone||this.timezoneOffset){var i=t.getTime(),n=i-this.getTimezoneOffset(t);t.setTime(n);var s=t["getUTC"+e]();return t.setTime(i),s}return this.useUTC?t["getUTC"+e]():t["get"+e]()},e.prototype.set=function(e,t,i){if(this.variableTimezone||this.timezoneOffset){if("Milliseconds"===e||"Seconds"===e||"Minutes"===e)return t["setUTC"+e](i);var n=this.getTimezoneOffset(t),s=t.getTime()-n;t.setTime(s),t["setUTC"+e](i);var o=this.getTimezoneOffset(t);return s=t.getTime()+o,t.setTime(s)}return this.useUTC?t["setUTC"+e](i):t["set"+e](i)},e.prototype.update=function(e){var t=pick(e&&e.useUTC,!0);this.options=e=merge(!0,this.options||{},e),this.Date=e.Date||win.Date||Date,this.useUTC=t,this.timezoneOffset=t&&e.timezoneOffset,this.getTimezoneOffset=this.timezoneOffsetFunction(),this.variableTimezone=!(t&&!e.getTimezoneOffset&&!e.timezone)},e.prototype.makeTime=function(e,t,i,n,s,o){var r,a,m;return this.useUTC?(r=this.Date.UTC.apply(0,arguments),r+=a=this.getTimezoneOffset(r),a!==(m=this.getTimezoneOffset(r))?r+=m-a:a-36e5!==this.getTimezoneOffset(r-36e5)||H.isSafari||(r-=36e5)):r=new this.Date(e,t,pick(i,1),pick(n,0),pick(s,0),pick(o,0)).getTime(),r},e.prototype.timezoneOffsetFunction=function(){var e=this,t=this.options,i=win.moment;if(!this.useUTC)return function(e){return 6e4*new Date(e.toString()).getTimezoneOffset()};if(t.timezone){if(i)return function(e){return 6e4*-i.tz(e,t.timezone).utcOffset()};error(25)}return this.useUTC&&t.getTimezoneOffset?function(e){return 6e4*t.getTimezoneOffset(e)}:function(){return 6e4*(e.timezoneOffset||0)}},e.prototype.dateFormat=function(e,t,i){var n,s,o;if(!defined(t)||isNaN(t))return(null===(n=H.defaultOptions.lang)||void 0===n?void 0:n.invalidDate)||"";e=pick(e,"%Y-%m-%d %H:%M:%S");var r=this,a=new this.Date(t),m=this.get("Hours",a),f=this.get("Day",a),u=this.get("Date",a),h=this.get("Month",a),d=this.get("FullYear",a),p=H.defaultOptions.lang,g=null===(s=p)||void 0===s?void 0:s.weekdays,T=null===(o=p)||void 0===o?void 0:o.shortWeekdays,c=extend({a:T?T[f]:g[f].substr(0,3),A:g[f],d:pad(u),e:pad(u,2," "),w:f,b:p.shortMonths[h],B:p.months[h],m:pad(h+1),o:h+1,y:d.toString().substr(2,2),Y:d,H:pad(m),k:m,I:pad(m%12||12),l:m%12||12,M:pad(this.get("Minutes",a)),p:m<12?"AM":"PM",P:m<12?"am":"pm",S:pad(a.getSeconds()),L:pad(Math.floor(t%1e3),3)},H.dateFormats);return objectEach(c,function(i,n){for(;-1!==e.indexOf("%"+n);)e=e.replace("%"+n,"function"==typeof i?i.call(r,t):i)}),i?e.substr(0,1).toUpperCase()+e.substr(1):e},e.prototype.resolveDTLFormat=function(e){return isObject(e,!0)?e:{main:(e=splat(e))[0],from:e[1],to:e[2]}},e.prototype.getTimeTicks=function(e,t,i,n){var s,o,r,a,m=this,f=m.Date,u=[],h={},d=new f(t),p=e.unitRange,g=e.count||1;if(n=pick(n,1),defined(t)){m.set("Milliseconds",d,p>=timeUnits.second?0:g*Math.floor(m.get("Milliseconds",d)/g)),p>=timeUnits.second&&m.set("Seconds",d,p>=timeUnits.minute?0:g*Math.floor(m.get("Seconds",d)/g)),p>=timeUnits.minute&&m.set("Minutes",d,p>=timeUnits.hour?0:g*Math.floor(m.get("Minutes",d)/g)),p>=timeUnits.hour&&m.set("Hours",d,p>=timeUnits.day?0:g*Math.floor(m.get("Hours",d)/g)),p>=timeUnits.day&&m.set("Date",d,p>=timeUnits.month?1:Math.max(1,g*Math.floor(m.get("Date",d)/g))),p>=timeUnits.month&&(m.set("Month",d,p>=timeUnits.year?0:g*Math.floor(m.get("Month",d)/g)),o=m.get("FullYear",d)),p>=timeUnits.year&&(o-=o%g,m.set("FullYear",d,o)),p===timeUnits.week&&(a=m.get("Day",d),m.set("Date",d,m.get("Date",d)-a+n+(a<n?-7:0))),o=m.get("FullYear",d);var T=m.get("Month",d),c=m.get("Date",d),l=m.get("Hours",d);t=d.getTime(),m.variableTimezone&&(r=i-t>4*timeUnits.month||m.getTimezoneOffset(t)!==m.getTimezoneOffset(i));var U=d.getTime();for(s=1;U<i;)u.push(U),p===timeUnits.year?U=m.makeTime(o+s*g,0):p===timeUnits.month?U=m.makeTime(o,T+s*g):!r||p!==timeUnits.day&&p!==timeUnits.week?r&&p===timeUnits.hour&&g>1?U=m.makeTime(o,T,c,l+s*g):U+=p*g:U=m.makeTime(o,T,c+s*g*(p===timeUnits.day?1:7)),s++;u.push(U),p<=timeUnits.hour&&u.length<1e4&&u.forEach(function(e){e%18e5==0&&"000000000"===m.dateFormat("%H%M%S%L",e)&&(h[e]="day")})}return u.info=extend(e,{higherRanks:h,totalRange:p*g}),u},e.defaultOptions={Date:void 0,getTimezoneOffset:void 0,timezone:void 0,timezoneOffset:0,useUTC:!0},e}();H.Time=Time;export default H.Time;