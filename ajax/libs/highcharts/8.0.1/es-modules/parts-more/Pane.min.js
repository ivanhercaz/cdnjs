"use strict";import H from"../parts/Globals.js";import"../mixins/centered-series.js";import U from"../parts/Utilities.js";var addEvent=U.addEvent,extend=U.extend,merge=U.merge,pick=U.pick,splat=U.splat,CenteredSeriesMixin=H.CenteredSeriesMixin;function Pane(t,e){this.init(t,e)}function isInsidePane(t,e,n){return Math.sqrt(Math.pow(t-n[0],2)+Math.pow(e-n[1],2))<n[2]/2}H.Chart.prototype.collectionsWithUpdate.push("pane"),extend(Pane.prototype,{coll:"pane",init:function(t,e){this.chart=e,this.background=[],e.pane.push(this),this.setOptions(t)},setOptions:function(t){this.options=t=merge(this.defaultOptions,this.chart.angular?{background:{}}:void 0,t)},render:function(){var t,e,n=this.options,r=this.options.background,i=this.chart.renderer;if(this.group||(this.group=i.g("pane-group").attr({zIndex:n.zIndex||0}).add()),this.updateCenter(),r)for(r=splat(r),t=Math.max(r.length,this.background.length||0),e=0;e<t;e++)r[e]&&this.axis?this.renderBackground(merge(this.defaultBackgroundOptions,r[e]),e):this.background[e]&&(this.background[e]=this.background[e].destroy(),this.background.splice(e,1))},renderBackground:function(t,e){var n="animate",r={class:"highcharts-pane "+(t.className||"")};this.chart.styledMode||extend(r,{fill:t.backgroundColor,stroke:t.borderColor,"stroke-width":t.borderWidth}),this.background[e]||(this.background[e]=this.chart.renderer.path().add(this.group),n="attr"),this.background[e][n]({d:this.axis.getPlotBandPath(t.from,t.to,t)}).attr(r)},defaultOptions:{center:["50%","50%"],size:"85%",innerSize:"0%",startAngle:0},defaultBackgroundOptions:{shape:"circle",borderWidth:1,borderColor:"#cccccc",backgroundColor:{linearGradient:{x1:0,y1:0,x2:0,y2:1},stops:[[0,"#ffffff"],[1,"#e6e6e6"]]},from:-Number.MAX_VALUE,innerRadius:0,to:Number.MAX_VALUE,outerRadius:"105%"},updateCenter:function(t){this.center=(t||this.axis||{}).center=CenteredSeriesMixin.getCenter.call(this)},update:function(t,e){merge(!0,this.options,t),merge(!0,this.chart.options.pane,t),this.setOptions(this.options),this.render(),this.chart.axes.forEach(function(t){t.pane===this&&(t.pane=null,t.update({},e))},this)}}),H.Pane=Pane,H.Chart.prototype.getHoverPane=function(t){var e,n=this;return t&&n.pane.forEach(function(r){var i=t.chartX-n.plotLeft,o=t.chartY-n.plotTop;isInsidePane(n.inverted?o:i,n.inverted?i:o,r.center)&&(e=r)}),e},addEvent(H.Chart,"afterIsInsidePlot",function(t){this.polar&&(t.isInsidePlot=this.pane.some(function(e){return isInsidePane(t.x,t.y,e.center)}))}),addEvent(H.Pointer,"beforeGetHoverData",function(t){var e=this.chart;e.polar&&(e.hoverPane=e.getHoverPane(t),t.filter=function(n){return n.visible&&!(!t.shared&&n.directTouch)&&pick(n.options.enableMouseTracking,!0)&&(!e.hoverPane||n.xAxis.pane===e.hoverPane)})}),addEvent(H.Pointer,"afterGetHoverData",function(t){var e=this.chart;t.hoverPoint&&t.hoverPoint.plotX&&t.hoverPoint.plotY&&e.hoverPane&&!isInsidePane(t.hoverPoint.plotX,t.hoverPoint.plotY,e.hoverPane.center)&&(t.hoverPoint=void 0)});