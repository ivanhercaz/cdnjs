"use strict";import H from"../parts/Globals.js";import U from"../parts/Utilities.js";var clamp=U.clamp,pick=U.pick,seriesType=U.seriesType,seriesTypes=H.seriesTypes,colProto=seriesTypes.column.prototype;seriesType("columnpyramid","column",{},{translate:function(){var t=this,e=t.chart,o=t.options,i=t.dense=t.closestPointRange*t.xAxis.transA<2,s=t.borderWidth=pick(o.borderWidth,i?0:1),p=t.yAxis,r=o.threshold,a=t.translatedThreshold=p.getThreshold(r),l=pick(o.minPointLength,5),n=t.getColumnMetrics(),h=n.width,c=t.barW=Math.max(h,1+2*s),d=t.pointXOffset=n.offset;e.inverted&&(a-=.5),o.pointPadding&&(c=Math.ceil(c)),colProto.translate.apply(t),t.points.forEach(function(i){var s,n,m,y,f,g,T,x,u,M,P,b,k=pick(i.yBottom,a),v=999+Math.abs(k),W=clamp(i.plotY,-v,p.len+v),A=i.plotX+d,U=c/2,H=Math.min(W,k),L=Math.max(W,k)-H;i.barX=A,i.pointWidth=h,i.tooltipPos=e.inverted?[p.len+p.pos-e.plotLeft-W,t.xAxis.len-A-U,L]:[A+U,W+p.pos-e.plotTop,L],s=r+(i.total||i.y),"percent"===o.stacking&&(s=r+(i.y<0)?-100:100),m=p.toPixels(s,!0),T=A-(y=(n=e.plotHeight-m-(e.plotHeight-a))?U*(H-m)/n:0)+U,x=A+y+U,u=A+(f=n?U*(H+L-m)/n:0)+U,M=A-f+U,P=H-l,b=H+L,i.y<0&&(P=H,b=H+L+l),e.inverted&&(x=(T=A+U+(y=U*(m-(g=e.plotWidth-H))/(n=m-(e.plotWidth-a))))-2*y,u=A-(f=U*(m-(g-L))/n)+U,M=A+f+U,P=H,b=H+L-l,i.y<0&&(b=H+L+l)),i.shapeType="path",i.shapeArgs={x:T,y:P,width:x-T,height:L,d:["M",T,P,"L",x,P,u,b,M,b,"Z"]}})}});