"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.__BackgroundImpl=exports.Background=void 0;var _extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},_react=require("react"),_react2=_interopRequireDefault(_react),_reactMeasure=require("react-measure"),_reactMeasure2=_interopRequireDefault(_reactMeasure),_constructUrl=require("./constructUrl"),_constructUrl2=_interopRequireDefault(_constructUrl),_targetWidths=require("./targetWidths"),_targetWidths2=_interopRequireDefault(_targetWidths),_findClosest=require("./findClosest"),_findClosest2=_interopRequireDefault(_findClosest);function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var PACKAGE_VERSION="8.5.1",noop=function(){},findNearestWidth=function(e){return(0,_findClosest2.default)(e,_targetWidths2.default)},toFixed=function(e,t){return+t.toFixed(e)},BackgroundImpl=function(e){function t(e){r(e),"function"==typeof p&&p(e)}var r=e.measureRef,i=(e.measure,e.contentRect),n=e.imgixParams,a=void 0===n?{}:n,u=(e.onLoad,e.disableLibraryParam),o=e.src,d=e.children,l=e.className,c=void 0===l?"":l,s=a.w,_=a.h,f=null!=i.bounds.top,h=e.htmlAttributes||{},g=toFixed(2,a.dpr||global.devicePixelRatio||1),p=h.ref,v=function(){if(null!=s&&null!=_)return{width:s,height:_};if(!f)return{width:void 0,height:void 0};var e=i.bounds.width/i.bounds.height;if(null==s&&null==_){var t=findNearestWidth(i.bounds.width);return{width:t,height:Math.ceil(t/e)}}if(null==s)return null!=_?{width:Math.ceil(_*e),height:_}:void 0;var r=Math.ceil(s/e);return{width:s,height:r}}(),m=v.width,b=v.height,x=null!=m&&null!=b,k=_extends({},h);if(!x)return _react2.default.createElement("div",_extends({},k,{className:"react-imgix-bg-loading "+c,ref:t}),d);var w,R=(w=_extends({},a,u?{}:{ixlib:"react-"+PACKAGE_VERSION},{width:m,height:b,fit:"crop",dpr:g}),(0,_constructUrl2.default)(o,w)),q=_extends({},h.style,{backgroundImage:"url("+R+")",backgroundSize:void 0!==(h.style||{}).backgroundSize?h.style.backgroundSize:"cover"});return _react2.default.createElement("div",_extends({},k,{className:c,ref:t,style:q}),d)},Background=(0,_reactMeasure.withContentRect)("bounds")(BackgroundImpl);exports.Background=Background,exports.__BackgroundImpl=BackgroundImpl;