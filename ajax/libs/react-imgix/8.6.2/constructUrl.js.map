{"version":3,"sources":["../src/constructUrl.js"],"names":["Base64","require","PACKAGE_VERSION","PARAM_EXPANSION","Object","freeze","brightness","contrast","exposure","gamma","highlights","hue","invert","saturation","shaddows","sharpness","vibrance","blend","border","padding","faces","download","DPI","format","quality","orientation","blurring","halftone","monotone","pixelate","height","width","DEFAULT_OPTIONS","auto","constructUrlFromParams","src","params","split","url","query","oldParams","map","x","key","val","decodeURIComponent","reduce","obj","allParams","entries","a","b","encodeURIComponent","join","constructUrl","longOptions","shortOptions","keys","forEach","substr","encodeURI","buildURLPublic","imgixParams","options","disableLibraryParam","ixlib"],"mappings":"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","sourcesContent":["/*\nCopyright Â© 2015 by Coursera\nLicensed under the Apache License 2.0, seen https://github.com/coursera/react-imgix/blob/master/LICENSE\n\nMinor syntax modifications have been made\n*/\n\nvar Base64 = require(\"js-base64\").Base64;\nconst PACKAGE_VERSION = require(\"../package.json\").version;\n\n// @see https://www.imgix.com/docs/reference\nvar PARAM_EXPANSION = Object.freeze({\n  // Adjustment\n  brightness: \"bri\",\n  contrast: \"con\",\n  exposure: \"exp\",\n  gamma: \"gam\",\n  highlights: \"high\",\n  hue: \"hue\",\n  invert: \"invert\",\n  saturation: \"sat\",\n  shaddows: \"shad\",\n  sharpness: \"sharp\",\n  \"unsharp-mask\": \"usm\",\n  \"unsharp-radius\": \"usmrad\",\n  vibrance: \"vib\",\n\n  // Automatic\n  \"auto-features\": \"auto\",\n\n  // Background\n  \"background-color\": \"bg\",\n\n  // Blend\n  blend: \"blend\",\n  \"blend-mode\": \"bm\",\n  \"blend-align\": \"ba\",\n  \"blend-alpha\": \"balph\",\n  \"blend-padding\": \"bp\",\n  \"blend-width\": \"bw\",\n  \"blend-height\": \"bh\",\n  \"blend-fit\": \"bf\",\n  \"blend-crop\": \"bc\",\n  \"blend-size\": \"bs\",\n  \"blend-x\": \"bx\",\n  \"blend-y\": \"by\",\n\n  // Border & Padding\n  border: \"border\",\n  padding: \"pad\",\n\n  // Face Detection\n  \"face-index\": \"faceindex\",\n  \"face-padding\": \"facepad\",\n  faces: \"faces\",\n\n  // Format\n  \"chroma-subsampling\": \"chromasub\",\n  \"color-quantization\": \"colorquant\",\n  download: \"dl\",\n  DPI: \"dpi\",\n  format: \"fm\",\n  \"lossless-compression\": \"lossless\",\n  quality: \"q\",\n\n  // Mask\n  \"mask-image\": \"mask\",\n\n  // Mask\n  \"noise-blur\": \"nr\",\n  \"noise-sharpen\": \"nrs\",\n\n  // Palette n/a\n  // PDF n/a\n  // Pixel Density n/a\n\n  // Rotation\n  \"flip-direction\": \"flip\",\n  orientation: \"or\",\n  \"rotation-angle\": \"rot\",\n\n  // Size\n  \"crop-mode\": \"crop\",\n  \"fit-mode\": \"fit\",\n  \"image-height\": \"h\",\n  \"image-width\": \"w\",\n\n  // Stylize\n  blurring: \"blur\",\n  halftone: \"htn\",\n  monotone: \"mono\",\n  pixelate: \"px\",\n  \"sepia-tone\": \"sepia\",\n\n  // Trim TODO\n  // Watermark TODO\n\n  // Extra\n  height: \"h\",\n  width: \"w\"\n});\n\nvar DEFAULT_OPTIONS = Object.freeze({\n  auto: \"format\" // http://www.imgix.com/docs/reference/automatic#param-auto\n});\n\nfunction constructUrlFromParams(src, params) {\n  const [url, query] = src.split(\"?\");\n  const oldParams = query\n    ? query\n        .split(\"&\")\n        .map(x => {\n          const [key, val] = x.split(\"=\");\n          return [key, decodeURIComponent(val)];\n        })\n        .reduce((obj, [key, val]) => Object.assign(obj, { [key]: val }), {})\n    : {};\n  const allParams = {\n    ...oldParams,\n    ...params\n  };\n  return `${url}?${Object.entries(allParams)\n    .map(([a, b]) => `${a}=${encodeURIComponent(b)}`)\n    .join(\"&\")}`;\n}\n\n/**\n * Construct a URL for an image with an Imgix proxy, expanding image options\n * per the [API reference docs](https://www.imgix.com/docs/reference).\n * @param  {String} src         src of raw image\n * @param  {Object} longOptions map of image API options, in long or short form per expansion rules\n * @return {String}             URL of image src transformed by Imgix\n */\nfunction constructUrl(src, longOptions) {\n  if (!src) {\n    return \"\";\n  }\n\n  var shortOptions = Object.assign({}, DEFAULT_OPTIONS);\n  Object.keys(longOptions).forEach(function(key) {\n    var val = longOptions[key];\n\n    if (PARAM_EXPANSION[key]) {\n      key = PARAM_EXPANSION[key];\n    }\n\n    key = encodeURIComponent(key);\n\n    if (key.substr(-2) === \"64\") {\n      val = Base64.encodeURI(val);\n    }\n\n    shortOptions[key] = val;\n  });\n\n  return constructUrlFromParams(src, shortOptions);\n}\n\nfunction buildURLPublic(src, imgixParams = {}, options = {}) {\n  const { disableLibraryParam } = options;\n\n  return constructUrl(src, {\n    ...imgixParams,\n    ...(disableLibraryParam ? {} : { ixlib: `react-${PACKAGE_VERSION}` })\n  });\n}\n\nexport default constructUrl;\n\nexport { buildURLPublic };\n"],"file":"constructUrl.js"}