"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.__BackgroundImpl=exports.Background=void 0;var _react=_interopRequireDefault(require("react")),_reactMeasure=_interopRequireWildcard(require("react-measure")),_constructUrl=_interopRequireDefault(require("./constructUrl")),_targetWidths=_interopRequireDefault(require("./targetWidths")),_findClosest=_interopRequireDefault(require("./findClosest"));function _interopRequireWildcard(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};n.get||n.set?Object.defineProperty(t,r,n):t[r]=e[r]}return t.default=e,t}function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _extends(){return(_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(e){_defineProperty(t,e,r[e])})}return t}function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var PACKAGE_VERSION="8.6.1",noop=function(){},findNearestWidth=function(e){return(0,_findClosest.default)(e,_targetWidths.default)},toFixed=function(e,t){return+t.toFixed(e)},BackgroundImpl=function(e){function t(e){r(e),"function"==typeof _&&_(e)}var r=e.measureRef,n=(e.measure,e.contentRect),i=e.imgixParams,o=void 0===i?{}:i,a=(e.onLoad,e.disableLibraryParam),u=e.src,c=e.children,l=e.className,d=void 0===l?"":l,s=o.w,f=o.h,p=null!=n.bounds.top,h=e.htmlAttributes||{},g=toFixed(2,o.dpr||global.devicePixelRatio||1),_=h.ref,b=function(){if(null!=s&&null!=f)return{width:s,height:f};if(!p)return{width:void 0,height:void 0};var e=n.bounds.width/n.bounds.height;if(null==s&&null==f){var t=findNearestWidth(n.bounds.width);return{width:t,height:Math.ceil(t/e)}}if(null==s)return null!=f?{width:Math.ceil(f*e),height:f}:void 0;var r=Math.ceil(s/e);return{width:s,height:r}}(),v=b.width,y=b.height,m=null!=v&&null!=y,O=_objectSpread({},h);if(!m)return _react.default.createElement("div",_extends({},O,{className:"react-imgix-bg-loading ".concat(d),ref:t}),c);var w,P=(w=_objectSpread({fit:"crop"},o,a?{}:{ixlib:"react-".concat(PACKAGE_VERSION)},{width:v,height:y,dpr:g}),(0,_constructUrl.default)(u,w)),j=_objectSpread({},h.style,{backgroundImage:"url(".concat(P,")"),backgroundSize:void 0!==(h.style||{}).backgroundSize?h.style.backgroundSize:"cover"});return _react.default.createElement("div",_extends({},O,{className:d,ref:t,style:j}),c)};exports.__BackgroundImpl=BackgroundImpl;var Background=(0,_reactMeasure.withContentRect)("bounds")(BackgroundImpl);exports.Background=Background;