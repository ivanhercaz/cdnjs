"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var OutMode_1=require("../../Enums/OutMode"),Utils_1=require("../../Utils/Utils"),Mover_1=require("./Mover"),RotateDirection_1=require("../../Enums/RotateDirection"),SizeAnimationStatus_1=require("../../Enums/SizeAnimationStatus"),OpacityAnimationStatus_1=require("../../Enums/OpacityAnimationStatus"),Updater=function(){function d(t,i){this.container=t,this.particle=i,this.mover=new Mover_1.Mover(t,i)}return d.checkBounds=function(t,i,e,o,a){(e<t+i&&0<o||t-i<0&&o<0)&&a()},d.prototype.update=function(t){this.mover.move(t),this.updateOpacity(t),this.updateSize(t),this.updateAngle(t),this.fixOutOfCanvasPosition(t),this.updateOutMode(t)},d.prototype.updateOpacity=function(t){var i=this.container.options,e=this.particle,o=0<i.fpsLimit?60*t/1e3:3.6;if(e.particlesOptions.opacity.animation.enable){switch(e.opacity.status){case OpacityAnimationStatus_1.OpacityAnimationStatus.increasing:e.opacity.value>=e.particlesOptions.opacity.value?e.opacity.status=OpacityAnimationStatus_1.OpacityAnimationStatus.decreasing:e.opacity.value+=(e.opacity.velocity||0)*o;break;case OpacityAnimationStatus_1.OpacityAnimationStatus.decreasing:e.opacity.value<=e.particlesOptions.opacity.animation.minimumValue?e.opacity.status=OpacityAnimationStatus_1.OpacityAnimationStatus.increasing:e.opacity.value-=(e.opacity.velocity||0)*o}e.opacity.value<0&&(e.opacity.value=0)}},d.prototype.updateSize=function(t){var i,e=this.container,o=e.options,a=this.particle,s=0<o.fpsLimit?60*t/1e3:3.6;if(a.particlesOptions.size.animation.enable){switch(a.size.status){case SizeAnimationStatus_1.SizeAnimationStatus.increasing:a.size.value>=(null!==(i=a.sizeValue)&&void 0!==i?i:e.retina.sizeValue)?a.size.status=SizeAnimationStatus_1.SizeAnimationStatus.decreasing:a.size.value+=(a.size.velocity||0)*s;break;case SizeAnimationStatus_1.SizeAnimationStatus.decreasing:a.size.value<=a.particlesOptions.size.animation.minimumValue?a.size.status=SizeAnimationStatus_1.SizeAnimationStatus.increasing:a.size.value-=(a.size.velocity||0)*s}a.size.value<0&&(a.size.value=0)}},d.prototype.updateAngle=function(t){var i=this.container.options,e=this.particle,o=0<i.fpsLimit?60*t/1e3:3.6;if(e.particlesOptions.rotate.animation.enable)switch(e.rotateDirection){case RotateDirection_1.RotateDirection.clockwise:e.angle+=e.particlesOptions.rotate.animation.speed*Math.PI/18*o,360<e.angle&&(e.angle-=360);break;case RotateDirection_1.RotateDirection.counterClockwise:default:e.angle-=e.particlesOptions.rotate.animation.speed*Math.PI/18*o,e.angle<0&&(e.angle+=360)}},d.prototype.fixOutOfCanvasPosition=function(t){var i,e=this.container,o=this.particle,a=o.particlesOptions.move.outMode,s=e.canvas.size;if(i=a===OutMode_1.OutMode.bounce?{bottom:s.height,left:o.size.value,right:s.width,top:o.size.value}:a===OutMode_1.OutMode.bounceHorizontal?{bottom:s.height+o.size.value-o.offset.y,left:o.size.value,right:s.width,top:-o.size.value-o.offset.y}:a===OutMode_1.OutMode.bounceVertical?{bottom:s.height,left:-o.size.value-o.offset.x,right:s.width+o.size.value+o.offset.x,top:o.size.value}:{bottom:s.height+o.size.value-o.offset.y,left:-o.size.value-o.offset.x,right:s.width+o.size.value+o.offset.x,top:-o.size.value-o.offset.y},a===OutMode_1.OutMode.destroy){var n=o.size.value;Utils_1.Utils.isPointInside(o.position,e.canvas.size,n)||e.particles.remove(o)}else{n=o.size.value;var u=Utils_1.Utils.calculateBounds(o.position,n);u.left>s.width-o.offset.x?(o.position.x=i.left,o.position.y=Math.random()*s.height):u.right<-o.offset.x&&(o.position.x=i.right,o.position.y=Math.random()*s.height),u.top>s.height-o.offset.y?(o.position.x=Math.random()*s.width,o.position.y=i.top):u.bottom<-o.offset.y&&(o.position.x=Math.random()*s.width,o.position.y=i.bottom)}},d.prototype.updateOutMode=function(t){switch(this.particle.particlesOptions.move.outMode){case OutMode_1.OutMode.bounce:case OutMode_1.OutMode.bounceVertical:case OutMode_1.OutMode.bounceHorizontal:this.updateBounce(t)}},d.prototype.updateBounce=function(t){for(var i=this.container,e=this.particle,o=!1,a=0,s=i.plugins;a<s.length;a++){var n=s[a];if(void 0!==n.particleBounce&&(o=n.particleBounce(e,t)),o)break}if(!o){var u=e.particlesOptions.move.outMode,c=e.position.x+e.offset.x,r=e.position.y+e.offset.y;if(u===OutMode_1.OutMode.bounce||u===OutMode_1.OutMode.bounceHorizontal){var p=e.size.value,l=e.velocity.horizontal;d.checkBounds(c,p,i.canvas.size.width,l,function(){e.velocity.horizontal*=-1})}if(u===OutMode_1.OutMode.bounce||u===OutMode_1.OutMode.bounceVertical){p=e.size.value,l=e.velocity.vertical;d.checkBounds(r,p,i.canvas.size.height,l,function(){e.velocity.vertical*=-1})}}},d}();exports.Updater=Updater;