"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var Utils_1=require("../../Utils/Utils"),Collider=function(){function i(){}return i.collide=function(i,t){for(var o=0,e=t.particles.spatialGrid.queryRadius(i.position,2*i.size.value);o<e.length;o++){var l=e[o];if(i!==l&&l.particlesOptions.move.collisions){var r=Utils_1.Utils.getDistanceBetweenCoordinates(i.position,l.position),a=t.retina.sizeValue;r<=this.getRadius(i,a)+this.getRadius(l,a)&&this.resolveCollision(i,l)}}},i.getRadius=function(i,t){return i.bubble.radius||i.size.value||t},i.resolveCollision=function(i,t){var o=i.velocity.horizontal-t.velocity.horizontal,e=i.velocity.vertical-t.velocity.vertical;if(0<=o*(t.position.x-i.position.x)+e*(t.position.y-i.position.y)){var l=-Math.atan2(t.position.y-i.position.y,t.position.x-i.position.x),r=i.size.value,a=t.size.value,n=this.rotate(i.velocity,l),s=this.rotate(t.velocity,l),c={horizontal:n.horizontal*(r-a)/(r+a)+2*s.horizontal*a/(r+a),vertical:n.vertical},v={horizontal:s.horizontal*(r-a)/(r+a)+2*n.horizontal*a/(r+a),vertical:s.vertical},h=this.rotate(c,-l),u=this.rotate(v,-l);i.velocity.horizontal=h.horizontal,i.velocity.vertical=h.vertical,t.velocity.horizontal=u.horizontal,t.velocity.vertical=u.vertical}},i.rotate=function(i,t){return{horizontal:i.horizontal*Math.cos(t)-i.vertical*Math.sin(t),vertical:i.horizontal*Math.sin(t)+i.vertical*Math.cos(t)}},i}();exports.Collider=Collider;