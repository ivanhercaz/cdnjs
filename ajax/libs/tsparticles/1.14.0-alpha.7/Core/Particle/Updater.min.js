"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var OutMode_1=require("../../Enums/OutMode"),Utils_1=require("../../Utils/Utils"),Mover_1=require("./Mover"),RotateDirection_1=require("../../Enums/RotateDirection"),SizeAnimationStatus_1=require("../../Enums/SizeAnimationStatus"),OpacityAnimationStatus_1=require("../../Enums/OpacityAnimationStatus"),Updater=function(){function p(t,i){this.container=t,this.particle=i,this.mover=new Mover_1.Mover(t,i)}return p.checkBounds=function(t,i,e,o,a){(e<t+i&&0<o||t-i<0&&o<0)&&a()},p.prototype.update=function(t){this.mover.move(t),this.updateOpacity(t),this.updateSize(t),this.updateAngle(t),this.fixOutOfCanvasPosition(t),this.updateOutMode(t)},p.prototype.updateOpacity=function(t){var i=this.container.options,e=this.particle,o=0<i.fpsLimit?60*t/1e3:3.6;if(e.particlesOptions.opacity.animation.enable){switch(e.opacity.status){case OpacityAnimationStatus_1.OpacityAnimationStatus.increasing:e.opacity.value>=e.particlesOptions.opacity.value?e.opacity.status=OpacityAnimationStatus_1.OpacityAnimationStatus.decreasing:e.opacity.value+=(e.opacity.velocity||0)*o;break;case OpacityAnimationStatus_1.OpacityAnimationStatus.decreasing:e.opacity.value<=e.particlesOptions.opacity.animation.minimumValue?e.opacity.status=OpacityAnimationStatus_1.OpacityAnimationStatus.increasing:e.opacity.value-=(e.opacity.velocity||0)*o}e.opacity.value<0&&(e.opacity.value=0)}},p.prototype.updateSize=function(t){var i,e=this.container,o=e.options,a=this.particle,s=0<o.fpsLimit?60*t/1e3:3.6;if(a.particlesOptions.size.animation.enable){switch(a.size.status){case SizeAnimationStatus_1.SizeAnimationStatus.increasing:a.size.value>=(null!==(i=a.sizeValue)&&void 0!==i?i:e.retina.sizeValue)?a.size.status=SizeAnimationStatus_1.SizeAnimationStatus.decreasing:a.size.value+=(a.size.velocity||0)*s;break;case SizeAnimationStatus_1.SizeAnimationStatus.decreasing:a.size.value<=a.particlesOptions.size.animation.minimumValue?a.size.status=SizeAnimationStatus_1.SizeAnimationStatus.increasing:a.size.value-=(a.size.velocity||0)*s}a.size.value<0&&(a.size.value=0)}},p.prototype.updateAngle=function(t){var i=this.container.options,e=this.particle,o=0<i.fpsLimit?60*t/1e3:3.6;if(e.particlesOptions.rotate.animation.enable)switch(e.rotateDirection){case RotateDirection_1.RotateDirection.clockwise:e.angle+=e.particlesOptions.rotate.animation.speed*Math.PI/18*o,360<e.angle&&(e.angle-=360);break;case RotateDirection_1.RotateDirection.counterClockwise:default:e.angle-=e.particlesOptions.rotate.animation.speed*Math.PI/18*o,e.angle<0&&(e.angle+=360)}},p.prototype.fixOutOfCanvasPosition=function(t){var i,e,o=this.container,a=this.particle,s=a.particlesOptions.move.outMode,n=o.canvas.size,u=s===OutMode_1.OutMode.bounce?{bottom:n.height,left:a.size.value,right:n.width,top:a.size.value}:s===OutMode_1.OutMode.bounceHorizontal?{bottom:n.height+a.size.value-a.offset.y,left:a.size.value,right:n.width,top:-a.size.value-a.offset.y}:s===OutMode_1.OutMode.bounceVertical?{bottom:n.height,left:-a.size.value-a.offset.x,right:n.width+a.size.value+a.offset.x,top:a.size.value}:{bottom:n.height+a.size.value-a.offset.y,left:-a.size.value-a.offset.x,right:n.width+a.size.value+a.offset.x,top:-a.size.value-a.offset.y};s===OutMode_1.OutMode.destroy?(i=a.size.value,Utils_1.Utils.isPointInside(a.position,o.canvas.size,i)||o.particles.remove(a)):(i=a.size.value,(e=Utils_1.Utils.calculateBounds(a.position,i)).left>n.width-a.offset.x?(a.position.x=u.left,a.position.y=Math.random()*n.height):e.right<-a.offset.x&&(a.position.x=u.right,a.position.y=Math.random()*n.height),e.top>n.height-a.offset.y?(a.position.x=Math.random()*n.width,a.position.y=u.top):e.bottom<-a.offset.y&&(a.position.x=Math.random()*n.width,a.position.y=u.bottom))},p.prototype.updateOutMode=function(t){switch(this.particle.particlesOptions.move.outMode){case OutMode_1.OutMode.bounce:case OutMode_1.OutMode.bounceVertical:case OutMode_1.OutMode.bounceHorizontal:this.updateBounce(t)}},p.prototype.updateBounce=function(t){var i,e,o,a,s=this.container,n=this.particle,u=!1;for(var c in s.plugins){var r=s.plugins[c];if(void 0!==r.particleBounce&&(u=r.particleBounce(n,t)),u)break}u||(i=n.particlesOptions.move.outMode,e=n.getPosition(),i!==OutMode_1.OutMode.bounce&&i!==OutMode_1.OutMode.bounceHorizontal||(o=n.size.value,a=n.velocity.horizontal,p.checkBounds(e.x,o,s.canvas.size.width,a,function(){n.velocity.horizontal*=-1})),i!==OutMode_1.OutMode.bounce&&i!==OutMode_1.OutMode.bounceVertical||(o=n.size.value,a=n.velocity.vertical,p.checkBounds(e.y,o,s.canvas.size.height,a,function(){n.velocity.vertical*=-1})))},p}();exports.Updater=Updater;