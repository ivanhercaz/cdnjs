"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var QuadTree_1=require("../../../../Utils/QuadTree"),Infecter=function(){function e(){}return e.infect=function(t,e,n){var i,a;if(t.updateInfection(n),void 0!==t.infectionStage){var o=e.options.infection;if(o.enable&&!(o.stages.length<1))for(var f=o.stages[t.infectionStage],r=e.retina.pixelRatio,c=2*t.size.value+f.radius*r,g=t.getPosition(),u=null!==(i=f.infectedStage)&&void 0!==i?i:t.infectionStage,d=e.particles.quadTree.query(new QuadTree_1.Circle(g.x,g.y,c)).filter(function(e){return void 0===e.infectionStage||e.infectionStage!==t.infectionStage}),l=f.rate,s=d.length,S=0,v=d;S<v.length;S++){var p,I,h=v[S];Math.random()<l/s&&(void 0===h.infectionStage?h.startInfection(u):h.infectionStage<t.infectionStage?h.updateInfectionStage(u):h.infectionStage>t.infectionStage&&(I=null!==(a=null==(p=o.stages[h.infectionStage])?void 0:p.infectedStage)&&void 0!==a?a:h.infectionStage,t.updateInfectionStage(I)))}}},e}();exports.Infecter=Infecter;