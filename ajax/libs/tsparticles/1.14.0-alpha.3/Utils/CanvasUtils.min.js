"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var ColorUtils_1=require("./ColorUtils"),CanvasUtils=function(){function o(){}return o.paintBase=function(o,t,e){o.save(),o.fillStyle=null!=e?e:"rgba(0,0,0,0)",o.fillRect(0,0,t.width,t.height),o.restore()},o.clear=function(o,t){o.clearRect(0,0,t.width,t.height)},o.drawAbsorber=function(o,t){o.save(),o.translate(t.position.x,t.position.y),o.beginPath(),o.arc(0,0,t.size,0,2*Math.PI,!1),o.closePath(),o.fillStyle=ColorUtils_1.ColorUtils.getStyleFromColor(t.color,t.opacity),o.fill(),o.restore()},o.drawLineLinked=function(o,t,e,r,l,i,s,a){o.save(),o.lineWidth=t,o.beginPath(),o.moveTo(e.x,e.y),o.lineTo(r.x,r.y),o.closePath(),l&&(o.globalCompositeOperation="destination-out"),i&&(o.strokeStyle=ColorUtils_1.ColorUtils.getStyleFromColor(i,s));var n="string"==typeof a.color?ColorUtils_1.ColorUtils.stringToRgb(a.color):ColorUtils_1.ColorUtils.colorToRgb(a.color);a.enable&&n&&(o.shadowBlur=a.blur,o.shadowColor=ColorUtils_1.ColorUtils.getStyleFromColor(n)),o.stroke(),o.restore()},o.drawConnectLine=function(o,t,e,r,l){o.save(),o.beginPath(),o.moveTo(r.x,r.y),o.lineTo(l.x,l.y),o.closePath(),o.lineWidth=t,o.strokeStyle=e,o.stroke(),o.restore()},o.gradient=function(o,t,e,r){var l=Math.floor(e.size.value/t.size.value);if(t.color&&e.color){var i={x:t.position.x+t.offset.x,y:t.position.y+t.offset.y},s={x:e.position.x+e.offset.x,y:e.position.y+e.offset.y},a=ColorUtils_1.ColorUtils.mix(t.color,e.color,t.size.value,e.size.value),n=o.createLinearGradient(i.x,i.y,s.x,s.y);return n.addColorStop(0,ColorUtils_1.ColorUtils.getStyleFromColor(t.color,r)),n.addColorStop(1<l?1:l,ColorUtils_1.ColorUtils.getStyleFromColor(a,r)),n.addColorStop(1,ColorUtils_1.ColorUtils.getStyleFromColor(e.color,r)),n}},o.drawGrabLine=function(o,t,e,r,l,i){o.save(),o.beginPath(),o.moveTo(e.x,e.y),o.lineTo(r.x,r.y),o.closePath(),o.strokeStyle=ColorUtils_1.ColorUtils.getStyleFromColor(l,i),o.lineWidth=t,o.stroke(),o.restore()},o.drawParticle=function(o,t,e,r,l,i,s,a){var n={x:e.position.x+e.offset.x,y:e.position.y+e.offset.y};t.save(),t.translate(n.x,n.y),t.beginPath(),0!==e.angle&&t.rotate(e.angle*Math.PI/180),l&&(t.globalCompositeOperation="destination-out");var f=e.shadowColor;a.enable&&f&&(t.shadowBlur=a.blur,t.shadowColor=ColorUtils_1.ColorUtils.getStyleFromColor(f),t.shadowOffsetX=a.offset.x,t.shadowOffsetY=a.offset.y),t.fillStyle=r;var C=e.stroke;0<C.width&&e.strokeColor&&(t.strokeStyle=ColorUtils_1.ColorUtils.getStyleFromColor(e.strokeColor,e.stroke.opacity),t.lineWidth=C.width),this.drawShape(o,t,e,i,s),e.close&&t.closePath(),0<C.width&&e.strokeColor&&t.stroke(),e.fill&&t.fill(),t.restore(),t.save(),t.translate(n.x,n.y),0!==e.angle&&t.rotate(e.angle*Math.PI/180),l&&(t.globalCompositeOperation="destination-out"),this.drawShapeAfterEffect(o,t,e,i,s),t.restore()},o.addShapeDrawer=function(o,t){this.drawers[o]||(this.drawers[o]=t)},o.getShapeDrawer=function(o){return this.drawers[o]},o.drawShape=function(o,t,e,r,l){if(e.shape){var i=o.drawers[e.shape];i&&i.draw(t,e,r,l)}},o.drawShapeAfterEffect=function(o,t,e,r,l){if(e.shape){var i=o.drawers[e.shape];i&&void 0!==i.afterEffect&&i.afterEffect(t,e,r,l)}},o.drawers={},o}();exports.CanvasUtils=CanvasUtils;