"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var ProcessBubbleType_1=require("../../Enums/ProcessBubbleType"),Utils_1=require("../Utils/Utils"),HoverMode_1=require("../../Enums/Modes/HoverMode"),ClickMode_1=require("../../Enums/Modes/ClickMode"),Constants_1=require("../Utils/Constants"),Bubbler=function(){function e(e,i){this.container=e,this.particle=i}return e.prototype.bubble=function(){var e=this.container.options,i=e.interactivity.events.onHover.enable,t=e.interactivity.events.onHover.mode,s=e.interactivity.events.onClick.enable,o=e.interactivity.events.onClick.mode;i&&Utils_1.Utils.isInArray(HoverMode_1.HoverMode.bubble,t)?this.hoverBubble():s&&Utils_1.Utils.isInArray(ClickMode_1.ClickMode.bubble,o)&&this.clickBubble()},e.prototype.init=function(){var e=this.particle;this.opacity=e.opacity.value,this.radius=e.radius},e.prototype.process=function(e,i,t){var s=this.container,o=s.options.interactivity.modes.bubble.duration,b=t.bubbleObj.optValue,r=s.retina.bubbleModeDistance,a=t.particlesObj.optValue,l=t.bubbleObj.value,n=t.particlesObj.value||0,u=t.type;if(b!==a)if(s.bubble.durationEnd){if(l){c=2*b-n-i*(n-b)/o;u===ProcessBubbleType_1.ProcessBubbleType.size&&(this.radius=c),u===ProcessBubbleType_1.ProcessBubbleType.opacity&&(this.opacity=c)}}else if(e<=r){if((null!=l?l:n)!==b){var c=n-i*(n-b)/o;u===ProcessBubbleType_1.ProcessBubbleType.size&&(this.radius=c),u===ProcessBubbleType_1.ProcessBubbleType.opacity&&(this.opacity=c)}}else u===ProcessBubbleType_1.ProcessBubbleType.size&&(this.radius=void 0),u===ProcessBubbleType_1.ProcessBubbleType.opacity&&(this.opacity=void 0)},e.prototype.clickBubble=function(){var e=this.container,i=e.options,t=this.particle,s=e.interactivity.mouse.clickPosition||{x:0,y:0},o=Utils_1.Utils.getDistanceBetweenCoordinates(t.position,s),b=((new Date).getTime()-(e.interactivity.mouse.clickTime||0))/1e3;if(e.bubble.clicking){b>i.interactivity.modes.bubble.duration&&(e.bubble.durationEnd=!0),b>2*i.interactivity.modes.bubble.duration&&(e.bubble.clicking=!1,e.bubble.durationEnd=!1);var r={bubbleObj:{optValue:e.retina.bubbleModeSize,value:this.radius},particlesObj:{optValue:e.retina.sizeValue,value:this.particle.radius},type:ProcessBubbleType_1.ProcessBubbleType.size};this.process(o,b,r);var a={bubbleObj:{optValue:i.interactivity.modes.bubble.opacity,value:this.opacity},particlesObj:{optValue:i.particles.opacity.value,value:this.particle.opacity.value},type:ProcessBubbleType_1.ProcessBubbleType.opacity};this.process(o,b,a)}},e.prototype.hoverBubble=function(){var e=this.container,i=this.particle,t=e.interactivity.mouse.position||{x:0,y:0},s=Utils_1.Utils.getDistanceBetweenCoordinates(i.position,t),o=1-s/e.retina.bubbleModeDistance;s<=e.retina.bubbleModeDistance?0<=o&&e.interactivity.status===Constants_1.Constants.mouseMoveEvent&&(this.hoverBubbleSize(o),this.hoverBubbleOpacity(o)):this.init(),e.interactivity.status===Constants_1.Constants.mouseLeaveEvent&&this.init()},e.prototype.hoverBubbleSize=function(e){var i=this.container,t=i.options,s=this.particle,o=t.interactivity.modes.bubble.size,b=t.particles.size.value,r=s.radius;if(i.retina.bubbleModeSize>i.retina.sizeValue)r<(a=r+o*e)&&a<=o&&(this.radius=a);else if(i.retina.bubbleModeSize<i.retina.sizeValue){var a;(a=r-(b-o)*e)<r&&o<=a&&(this.radius=a)}},e.prototype.hoverBubbleOpacity=function(e){var i=this.container.options,t=this.particle,s=i.interactivity.modes.bubble.opacity,o=i.particles.opacity.value,b=t.opacity.value;if(o<s)b<(r=b+s*e)&&r<=s&&(this.opacity=r);else if(s<o){var r;(r=b-(o-s)*e)<b&&s<=r&&(this.opacity=r)}},e}();exports.Bubbler=Bubbler;