"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var ClickMode_1=require("../../Enums/Modes/ClickMode"),HoverMode_1=require("../../Enums/Modes/HoverMode"),OutMode_1=require("../../Enums/OutMode"),Utils_1=require("../Utils/Utils"),DivMode_1=require("../../Enums/Modes/DivMode"),Constants_1=require("../Utils/Constants"),Repulser=function(){function e(e,t){this.container=e,this.particle=t}return e.prototype.repulse=function(){var e=this.container,t=e.options,i=t.interactivity.events.onHover.enable,o=t.interactivity.events.onClick.enable,s=e.interactivity.status===Constants_1.Constants.mouseMoveEvent,n=t.interactivity.events.onHover.mode,r=t.interactivity.events.onClick.mode,a=t.interactivity.events.onDiv.mode;s&&i&&Utils_1.Utils.isInArray(HoverMode_1.HoverMode.repulse,n)?this.hoverRepulse():o&&Utils_1.Utils.isInArray(ClickMode_1.ClickMode.repulse,r)?this.clickRepulse():t.interactivity.events.onDiv.enable&&Utils_1.Utils.isInArray(DivMode_1.DivMode.repulse,a)&&this.divRepulse()},e.prototype.divRepulse=function(){var e=this.container,t=e.options,i=this.particle,o=document.getElementById(t.interactivity.events.onDiv.elementId),s={x:o.offsetLeft+o.offsetWidth/2,y:o.offsetTop+o.offsetHeight/2},n=o.offsetWidth/2;e.retina.isRetina&&(s.x*=e.retina.pxRatio,s.y*=e.retina.pxRatio,n*=e.retina.pxRatio);var r=i.position.x-s.x,a=i.position.y-s.y,l=Math.sqrt(r*r+a*a),c=r/l,u=a/l,p=n,v=Utils_1.Utils.clamp(100*(1-Math.pow(l/p,4)),0,50);this.particle.position.x+=c*v,this.particle.position.y+=u*v},e.prototype.clickRepulse=function(){var e=this.container,t=this.particle;if(e.repulse.finish||(e.repulse.count||(e.repulse.count=0),e.repulse.count++,e.repulse.count===e.particles.count&&(e.repulse.finish=!0)),e.repulse.clicking){var i=e.retina.repulseModeDistance,o=Math.pow(i/6,3),s=e.interactivity.mouse.clickPosition||{x:0,y:0},n=s.x-t.position.x,r=s.y-t.position.y,a=n*n+r*r,l=-o/a;a<=o&&this.processRepulse(n,r,l)}else!1===e.repulse.clicking&&(t.velocity.horizontal=t.initialVelocity.horizontal,t.velocity.vertical=t.initialVelocity.vertical)},e.prototype.hoverRepulse=function(){var e=this.container,t=e.options,i=this.particle,o=e.interactivity.mouse.position||{x:0,y:0},s=i.position.x-o.x,n=i.position.y-o.y,r=Math.sqrt(s*s+n*n),a=s/r,l=n/r,c=e.retina.repulseModeDistance,u=Utils_1.Utils.clamp(100*(1-Math.pow(r/c,2)),0,50),p={x:i.position.x+a*u,y:i.position.y+l*u},v=t.particles.move.outMode;if(v===OutMode_1.OutMode.bounce||v===OutMode_1.OutMode.bounceVertical||v===OutMode_1.OutMode.bounceHorizontal){var d=0<p.x-i.radius&&p.x+i.radius<e.canvas.dimension.width,y=0<p.y-i.radius&&p.y+i.radius<e.canvas.dimension.height;v!==OutMode_1.OutMode.bounceVertical&&!d||(i.position.x=p.x),v!==OutMode_1.OutMode.bounceHorizontal&&!y||(i.position.y=p.y)}else i.position.x=p.x,i.position.y=p.y},e.prototype.processRepulse=function(e,t,i){var o=this.container,s=o.options,n=this.particle,r=Math.atan2(t,e);n.velocity.horizontal=i*Math.cos(r),n.velocity.vertical=i*Math.sin(r);var a=s.particles.move.outMode;if(a===OutMode_1.OutMode.bounce||a===OutMode_1.OutMode.bounceHorizontal||a===OutMode_1.OutMode.bounceVertical){var l=n.position.x+n.velocity.horizontal,c=n.position.y+n.velocity.vertical;a!==OutMode_1.OutMode.bounceVertical&&(l+n.radius>o.canvas.dimension.width||l-n.radius<0)&&(n.velocity.horizontal=-n.velocity.horizontal),a!==OutMode_1.OutMode.bounceHorizontal&&(c+n.radius>o.canvas.dimension.height||c-n.radius<0)&&(n.velocity.vertical=-n.velocity.vertical)}},e}();exports.Repulser=Repulser;