"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var Particle_1=require("./Particle"),PolygonMaskType_1=require("../Enums/PolygonMaskType"),PolygonMaskInlineArrangement_1=require("../Enums/PolygonMaskInlineArrangement"),InteractionManager_1=require("./Particle/InteractionManager"),SpatialGrid_1=require("./Utils/SpatialGrid"),Particles=function(){function t(t){this.container=t,this.array=[],this.interactionsEnabled=!1,this.spatialGrid=new SpatialGrid_1.SpatialGrid(this.container.canvas.dimension)}return Object.defineProperty(t.prototype,"count",{get:function(){return this.array.length},enumerable:!0,configurable:!0}),t.prototype.init=function(){var t=this.container,e=t.options;if(!e.polygon.enable||e.polygon.type!==PolygonMaskType_1.PolygonMaskType.inline||e.polygon.inline.arrangement!==PolygonMaskInlineArrangement_1.PolygonMaskInlineArrangement.onePerPoint&&e.polygon.inline.arrangement!==PolygonMaskInlineArrangement_1.PolygonMaskInlineArrangement.perPoint)for(var n=this.array.length;n<e.particles.number.value;n++)this.addParticle(new Particle_1.Particle(t));else t.polygon.drawPointsOnPolygonPath();this.interactionsEnabled=e.particles.lineLinked.enable||e.particles.move.attract.enable||e.particles.move.collisions},t.prototype.redraw=function(){this.clear(),this.init(),this.draw(0)},t.prototype.removeAt=function(t,e){if(0<=t&&t<=this.count)for(var n=0,r=this.array.splice(t,null!=e?e:1);n<r.length;n++){r[n].destroy()}},t.prototype.remove=function(t){this.removeAt(this.array.indexOf(t))},t.prototype.update=function(t){for(var e=0;e<this.array.length;e++){var n=this.array[e];n.update(e,t),this.interactionsEnabled&&InteractionManager_1.InteractionManager.interact(n,this.container)}},t.prototype.draw=function(t){var e=this.container,n=e.options;e.canvas.clear(),this.update(t),this.spatialGrid.setGrid(this.array,this.container.canvas.dimension),n.polygon.enable&&n.polygon.draw.enable&&e.polygon.drawPolygon();for(var r=0,i=this.array;r<i.length;r++){i[r].draw()}},t.prototype.clear=function(){this.array=[]},t.prototype.push=function(t,e){var n,r,i=this.container,a=i.options;this.pushing=!0,0<a.particles.number.limit&&this.array.length+t>a.particles.number.limit&&this.removeQuantity(this.array.length+t-a.particles.number.limit),e&&(r=null!==(n=e.position)&&void 0!==n?n:{x:0,y:0});for(var o=0;o<t;o++)this.addParticle(new Particle_1.Particle(i,r));a.particles.move.enable||this.container.play(),this.pushing=!1},t.prototype.addParticle=function(t){this.array.push(t)},t.prototype.removeQuantity=function(t){var e=this.container.options;this.removeAt(0,t),e.particles.move.enable||this.container.play()},t}();exports.Particles=Particles;