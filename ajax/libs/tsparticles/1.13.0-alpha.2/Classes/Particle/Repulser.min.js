"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var ClickMode_1=require("../../Enums/Modes/ClickMode"),HoverMode_1=require("../../Enums/Modes/HoverMode"),OutMode_1=require("../../Enums/OutMode"),Utils_1=require("../Utils/Utils"),DivMode_1=require("../../Enums/Modes/DivMode"),Constants_1=require("../Utils/Constants"),Repulser=function(){function e(e,i){this.container=e,this.particle=i}return e.prototype.repulse=function(){var e=this.container,i=e.options.interactivity,t=i.events.onHover.enable,o=i.events.onClick.enable,s=e.interactivity.status===Constants_1.Constants.mouseMoveEvent,n=i.events.onHover.mode,l=i.events.onClick.mode,r=i.events.onDiv.mode;s&&t&&Utils_1.Utils.isInArray(HoverMode_1.HoverMode.repulse,n)?this.hoverRepulse():o&&Utils_1.Utils.isInArray(ClickMode_1.ClickMode.repulse,l)?this.clickRepulse():i.events.onDiv.enable&&Utils_1.Utils.isInArray(DivMode_1.DivMode.repulse,r)&&this.divRepulse()},e.prototype.divRepulse=function(){var e=this.container,i=e.options,t=this.particle,o=document.getElementById(i.interactivity.events.onDiv.elementId),s={x:o.offsetLeft+o.offsetWidth/2,y:o.offsetTop+o.offsetHeight/2},n=o.offsetWidth/2;e.retina.isRetina&&(s.x*=e.retina.pixelRatio,s.y*=e.retina.pixelRatio,n*=e.retina.pixelRatio);var l=t.position.x-s.x,r=t.position.y-s.y,a=Math.sqrt(l*l+r*r),u=l/a,c=r/a,p=n,v=Utils_1.Utils.clamp(100*(1-Math.pow(a/p,2)),0,50),d={x:t.position.x+u*v,y:t.position.y+c*v},M=i.particles.move.outMode;if(M===OutMode_1.OutMode.bounce||M===OutMode_1.OutMode.bounceVertical||M===OutMode_1.OutMode.bounceHorizontal){var y=0<d.x-t.size.value&&d.x+t.size.value<e.canvas.dimension.width,h=0<d.y-t.size.value&&d.y+t.size.value<e.canvas.dimension.height;M!==OutMode_1.OutMode.bounceVertical&&!y||(t.position.x=d.x),M!==OutMode_1.OutMode.bounceHorizontal&&!h||(t.position.y=d.y)}else t.position.x=d.x,t.position.y=d.y},e.prototype.clickRepulse=function(){var e=this.container,i=this.particle;if(e.repulse.finish||(e.repulse.count||(e.repulse.count=0),e.repulse.count++,e.repulse.count===e.particles.count&&(e.repulse.finish=!0)),e.repulse.clicking){var t=e.retina.repulseModeDistance,o=Math.pow(t/6,3),s=e.interactivity.mouse.clickPosition||{x:0,y:0},n=s.x-i.position.x,l=s.y-i.position.y,r=n*n+l*l,a=-o/r;r<=o&&this.processRepulse(n,l,a)}else!1===e.repulse.clicking&&(i.velocity.horizontal=i.initialVelocity.horizontal,i.velocity.vertical=i.initialVelocity.vertical)},e.prototype.hoverRepulse=function(){var e=this.container,i=e.options,t=this.particle,o=e.interactivity.mouse.position||{x:0,y:0},s=t.position.x-o.x,n=t.position.y-o.y,l=Math.sqrt(s*s+n*n),r=s/l,a=n/l,u=e.retina.repulseModeDistance,c=Utils_1.Utils.clamp(100*(1-Math.pow(l/u,2)),0,50),p={x:t.position.x+r*c,y:t.position.y+a*c},v=i.particles.move.outMode;if(v===OutMode_1.OutMode.bounce||v===OutMode_1.OutMode.bounceVertical||v===OutMode_1.OutMode.bounceHorizontal){var d=0<p.x-t.size.value&&p.x+t.size.value<e.canvas.dimension.width,M=0<p.y-t.size.value&&p.y+t.size.value<e.canvas.dimension.height;v!==OutMode_1.OutMode.bounceVertical&&!d||(t.position.x=p.x),v!==OutMode_1.OutMode.bounceHorizontal&&!M||(t.position.y=p.y)}else t.position.x=p.x,t.position.y=p.y},e.prototype.processRepulse=function(e,i,t){var o=this.container,s=o.options,n=this.particle,l=Math.atan2(i,e);n.velocity.horizontal=t*Math.cos(l),n.velocity.vertical=t*Math.sin(l);var r=s.particles.move.outMode;if(r===OutMode_1.OutMode.bounce||r===OutMode_1.OutMode.bounceHorizontal||r===OutMode_1.OutMode.bounceVertical){var a=n.position.x+n.velocity.horizontal,u=n.position.y+n.velocity.vertical;r!==OutMode_1.OutMode.bounceVertical&&(a+n.size.value>o.canvas.dimension.width||a-n.size.value<0)&&(n.velocity.horizontal=-n.velocity.horizontal),r!==OutMode_1.OutMode.bounceHorizontal&&(u+n.size.value>o.canvas.dimension.height||u-n.size.value<0)&&(n.velocity.vertical=-n.velocity.vertical)}},e}();exports.Repulser=Repulser;