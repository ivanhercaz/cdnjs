"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var ClickMode_1=require("../../Enums/Modes/ClickMode"),HoverMode_1=require("../../Enums/Modes/HoverMode"),OutMode_1=require("../../Enums/OutMode"),Utils_1=require("../Utils/Utils"),DivMode_1=require("../../Enums/Modes/DivMode"),Constants_1=require("../Utils/Constants"),Repulser=function(){function e(e,t){this.container=e,this.particle=t}return e.prototype.repulse=function(){var e=this.container,t=e.options.interactivity,i=t.events.onHover.enable,o=t.events.onClick.enable,s=e.interactivity.status===Constants_1.Constants.mouseMoveEvent,n=t.events.onHover.mode,r=t.events.onClick.mode,l=t.events.onDiv.mode;s&&i&&Utils_1.Utils.isInArray(HoverMode_1.HoverMode.repulse,n)?this.hoverRepulse():o&&Utils_1.Utils.isInArray(ClickMode_1.ClickMode.repulse,r)?this.clickRepulse():t.events.onDiv.enable&&Utils_1.Utils.isInArray(DivMode_1.DivMode.repulse,l)&&this.divRepulse()},e.prototype.divRepulse=function(){var e=this.container,t=e.options,i=document.getElementById(t.interactivity.events.onDiv.elementId);if(i){var o={x:i.offsetLeft+i.offsetWidth/2,y:i.offsetTop+i.offsetHeight/2},s=i.offsetWidth/2;e.retina.isRetina&&(o.x*=e.retina.pixelRatio,o.y*=e.retina.pixelRatio,s*=e.retina.pixelRatio);var n=s;this.processRepulse(o,n)}},e.prototype.hoverRepulse=function(){var e=this.container,t=e.interactivity.mouse.position;if(t){var i=e.retina.repulseModeDistance;this.processRepulse(t,i)}},e.prototype.processRepulse=function(e,t){var i,o=this.container,s=this.particle,n=s.position.x-e.x,r=s.position.y-e.y,l=Math.sqrt(n*n+r*r),a=n/l,u=r/l,c=Utils_1.Utils.clamp(100*(1-Math.pow(l/t,2)),0,50),p=s.particlesOptions.move.outMode,v=null!==(i=s.sizeValue)&&void 0!==i?i:o.retina.sizeValue,d={x:s.position.x+a*c,y:s.position.y+u*c};if(p===OutMode_1.OutMode.bounce||p===OutMode_1.OutMode.bounceVertical||p===OutMode_1.OutMode.bounceHorizontal){var M=0<d.x-v&&d.x+v<o.canvas.dimension.width,y=0<d.y-v&&d.y+v<o.canvas.dimension.height;p!==OutMode_1.OutMode.bounceVertical&&!M||(s.position.x=d.x),p!==OutMode_1.OutMode.bounceHorizontal&&!y||(s.position.y=d.y)}else s.position.x=d.x,s.position.y=d.y},e.prototype.clickRepulse=function(){var e=this.container,t=this.particle;if(e.repulse.finish||(e.repulse.count||(e.repulse.count=0),e.repulse.count++,e.repulse.count===e.particles.count&&(e.repulse.finish=!0)),e.repulse.clicking){var i=e.retina.repulseModeDistance,o=Math.pow(i/6,3),s=e.interactivity.mouse.clickPosition||{x:0,y:0},n=s.x-t.position.x,r=s.y-t.position.y,l=n*n+r*r,a=-o/l;l<=o&&this.processClickRepulse(n,r,a)}else!1===e.repulse.clicking&&(t.velocity.horizontal=t.initialVelocity.horizontal,t.velocity.vertical=t.initialVelocity.vertical)},e.prototype.processClickRepulse=function(e,t,i){var o=this.container,s=o.options,n=this.particle,r=Math.atan2(t,e);n.velocity.horizontal=i*Math.cos(r),n.velocity.vertical=i*Math.sin(r);var l=s.particles.move.outMode;if(l===OutMode_1.OutMode.bounce||l===OutMode_1.OutMode.bounceHorizontal||l===OutMode_1.OutMode.bounceVertical){var a=n.position.x+n.velocity.horizontal,u=n.position.y+n.velocity.vertical;l!==OutMode_1.OutMode.bounceVertical&&(a+n.size.value>o.canvas.dimension.width||a-n.size.value<0)&&(n.velocity.horizontal=-n.velocity.horizontal),l!==OutMode_1.OutMode.bounceHorizontal&&(u+n.size.value>o.canvas.dimension.height||u-n.size.value<0)&&(n.velocity.vertical=-n.velocity.vertical)}},e}();exports.Repulser=Repulser;