"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var ClickMode_1=require("../../Enums/Modes/ClickMode"),HoverMode_1=require("../../Enums/Modes/HoverMode"),OutMode_1=require("../../Enums/OutMode"),Utils_1=require("../Utils/Utils"),DivMode_1=require("../../Enums/Modes/DivMode"),Constants_1=require("../Utils/Constants"),Repulser=function(){function e(e,t){this.container=e,this.particle=t}return e.prototype.repulse=function(){var e=this.container,t=e.options.interactivity,i=t.events.onHover.enable,o=t.events.onClick.enable,s=e.interactivity.status===Constants_1.Constants.mouseMoveEvent,n=t.events.onHover.mode,r=t.events.onClick.mode,l=t.events.onDiv.mode;s&&i&&Utils_1.Utils.isInArray(HoverMode_1.HoverMode.repulse,n)?this.hoverRepulse():o&&Utils_1.Utils.isInArray(ClickMode_1.ClickMode.repulse,r)?this.clickRepulse():t.events.onDiv.enable&&Utils_1.Utils.isInArray(DivMode_1.DivMode.repulse,l)&&this.divRepulse()},e.prototype.divRepulse=function(){var e=this.container,t=e.options,i=this.particle,o=document.getElementById(t.interactivity.events.onDiv.elementId),s={x:o.offsetLeft+o.offsetWidth/2,y:o.offsetTop+o.offsetHeight/2},n=o.offsetWidth/2;e.retina.isRetina&&(s.x*=e.retina.pixelRatio,s.y*=e.retina.pixelRatio,n*=e.retina.pixelRatio);var r=i.position.x-s.x,l=i.position.y-s.y,a=Math.sqrt(r*r+l*l),u=r/a,c=l/a,p=n,v=Utils_1.Utils.clamp(100*(1-Math.pow(a/p,4)),0,50);this.particle.position.x+=u*v,this.particle.position.y+=c*v},e.prototype.clickRepulse=function(){var e=this.container,t=this.particle;if(e.repulse.finish||(e.repulse.count||(e.repulse.count=0),e.repulse.count++,e.repulse.count===e.particles.count&&(e.repulse.finish=!0)),e.repulse.clicking){var i=e.retina.repulseModeDistance,o=Math.pow(i/6,3),s=e.interactivity.mouse.clickPosition||{x:0,y:0},n=s.x-t.position.x,r=s.y-t.position.y,l=n*n+r*r,a=-o/l;l<=o&&this.processRepulse(n,r,a)}else!1===e.repulse.clicking&&(t.velocity.horizontal=t.initialVelocity.horizontal,t.velocity.vertical=t.initialVelocity.vertical)},e.prototype.hoverRepulse=function(){var e=this.container,t=e.options,i=this.particle,o=e.interactivity.mouse.position||{x:0,y:0},s=i.position.x-o.x,n=i.position.y-o.y,r=Math.sqrt(s*s+n*n),l=s/r,a=n/r,u=e.retina.repulseModeDistance,c=Utils_1.Utils.clamp(100*(1-Math.pow(r/u,2)),0,50),p={x:i.position.x+l*c,y:i.position.y+a*c},v=t.particles.move.outMode;if(v===OutMode_1.OutMode.bounce||v===OutMode_1.OutMode.bounceVertical||v===OutMode_1.OutMode.bounceHorizontal){var d=0<p.x-i.size.value&&p.x+i.size.value<e.canvas.dimension.width,M=0<p.y-i.size.value&&p.y+i.size.value<e.canvas.dimension.height;v!==OutMode_1.OutMode.bounceVertical&&!d||(i.position.x=p.x),v!==OutMode_1.OutMode.bounceHorizontal&&!M||(i.position.y=p.y)}else i.position.x=p.x,i.position.y=p.y},e.prototype.processRepulse=function(e,t,i){var o=this.container,s=o.options,n=this.particle,r=Math.atan2(t,e);n.velocity.horizontal=i*Math.cos(r),n.velocity.vertical=i*Math.sin(r);var l=s.particles.move.outMode;if(l===OutMode_1.OutMode.bounce||l===OutMode_1.OutMode.bounceHorizontal||l===OutMode_1.OutMode.bounceVertical){var a=n.position.x+n.velocity.horizontal,u=n.position.y+n.velocity.vertical;l!==OutMode_1.OutMode.bounceVertical&&(a+n.size.value>o.canvas.dimension.width||a-n.size.value<0)&&(n.velocity.horizontal=-n.velocity.horizontal),l!==OutMode_1.OutMode.bounceHorizontal&&(u+n.size.value>o.canvas.dimension.height||u-n.size.value<0)&&(n.velocity.vertical=-n.velocity.vertical)}},e}();exports.Repulser=Repulser;