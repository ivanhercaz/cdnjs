"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var Utils_1=require("../../Utils/Utils"),CollisionMode_1=require("../../../Enums/CollisionMode"),Collider=function(){function i(){}return i.collide=function(i,o){for(var t=0,e=o.particles.spatialGrid.queryRadius(i.position,2*i.size.value);t<e.length;t++){var l=e[t];if(i!==l&&l.particlesOptions.collisions.enable&&i.particlesOptions.collisions.mode===l.particlesOptions.collisions.mode){var s=Utils_1.Utils.getDistanceBetweenCoordinates(i.position,l.position),r=o.retina.sizeValue;s<=this.getRadius(i,r)+this.getRadius(l,r)&&this.resolveCollision(i,l)}}},i.getRadius=function(i,o){return i.bubble.radius||i.size.value||o},i.resolveCollision=function(i,o){switch(i.particlesOptions.collisions.mode){case CollisionMode_1.CollisionMode.bounce:var t=i.velocity.horizontal-o.velocity.horizontal,e=i.velocity.vertical-o.velocity.vertical;if(0<=t*(o.position.x-i.position.x)+e*(o.position.y-i.position.y)){var l=-Math.atan2(o.position.y-i.position.y,o.position.x-i.position.x),s=i.size.value,r=o.size.value,a=this.rotate(i.velocity,l),n=this.rotate(o.velocity,l),c={horizontal:a.horizontal*(s-r)/(s+r)+2*n.horizontal*r/(s+r),vertical:a.vertical},v={horizontal:n.horizontal*(s-r)/(s+r)+2*a.horizontal*r/(s+r),vertical:n.vertical},h=this.rotate(c,-l),u=this.rotate(v,-l);i.velocity.horizontal=h.horizontal,i.velocity.vertical=h.vertical,o.velocity.horizontal=u.horizontal,o.velocity.vertical=u.vertical}}},i.rotate=function(i,o){return{horizontal:i.horizontal*Math.cos(o)-i.vertical*Math.sin(o),vertical:i.horizontal*Math.sin(o)+i.vertical*Math.cos(o)}},i}();exports.Collider=Collider;