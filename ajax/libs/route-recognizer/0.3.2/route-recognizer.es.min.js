var createObject=Object.create;function createMap(){var e=createObject(null);return e.__=void 0,delete e.__,e}var Target=function(e,t,r){this.path=e,this.matcher=t,this.delegate=r};Target.prototype.to=function(e,t){var r=this.delegate;if(r&&r.willAddRoute&&(e=r.willAddRoute(this.matcher.target,e)),this.matcher.add(this.path,e),t){if(0===t.length)throw new Error("You must have an argument in the function passed to `to`");this.matcher.addChild(this.path,e,t,this.delegate)}};var Matcher=function(e){this.routes=createMap(),this.children=createMap(),this.target=e};function generateMatch(e,t,r){return function(n,a){var o=e+n;if(!a)return new Target(o,t,r);a(generateMatch(o,t,r))}}function addRoute(e,t,r){for(var n=0,a=0;a<e.length;a++)n+=e[a].path.length;var o={path:t=t.substr(n),handler:r};e.push(o)}function eachRoute(e,t,r,n){for(var a=t.routes,o=Object.keys(a),i=0;i<o.length;i++){var s=o[i],h=e.slice();addRoute(h,s,a[s]);var u=t.children[s];u?eachRoute(h,u,r,n):r.call(n,h)}}Matcher.prototype.add=function(e,t){this.routes[e]=t},Matcher.prototype.addChild=function(e,t,r,n){var a=new Matcher(t);this.children[e]=a;var o=generateMatch(e,a,n);n&&n.contextEntered&&n.contextEntered(t,o),r(o)};var map=function(e,t){var r=new Matcher;e(generateMatch("",r,this.delegate)),eachRoute([],r,function(e){t?t(this,e):this.add(e)},this)};function normalizePath(e){return e.split("/").map(normalizeSegment).join("/")}var SEGMENT_RESERVED_CHARS=/%|\//g;function normalizeSegment(e){return e.length<3||-1===e.indexOf("%")?e:decodeURIComponent(e).replace(SEGMENT_RESERVED_CHARS,encodeURIComponent)}var PATH_SEGMENT_ENCODINGS=/%(?:2(?:4|6|B|C)|3(?:B|D|A)|40)/g;function encodePathSegment(e){return encodeURIComponent(e).replace(PATH_SEGMENT_ENCODINGS,decodeURIComponent)}var escapeRegex=/(\/|\.|\*|\+|\?|\||\(|\)|\[|\]|\{|\}|\\)/g,isArray=Array.isArray,hasOwnProperty=Object.prototype.hasOwnProperty;function getParam(e,t){if("object"!=typeof e||null===e)throw new Error("You must pass an object as the second argument to `generate`.");if(!hasOwnProperty.call(e,t))throw new Error("You must provide param `"+t+"` to `generate`.");var r=e[t],n="string"==typeof r?r:""+r;if(0===n.length)throw new Error("You must provide a param `"+t+"`.");return n}var eachChar=[];eachChar[0]=function(e,t){for(var r=t,n=e.value,a=0;a<n.length;a++){var o=n.charCodeAt(a);r=r.put(o,!1,!1)}return r},eachChar[1]=function(e,t){return t.put(47,!0,!0)},eachChar[2]=function(e,t){return t.put(-1,!1,!0)},eachChar[4]=function(e,t){return t};var regex=[];regex[0]=function(e){return e.value.replace(escapeRegex,"\\$1")},regex[1]=function(){return"([^/]+)"},regex[2]=function(){return"(.+)"},regex[4]=function(){return""};var generate=[];function parse(e,t,r,n,a){t.length>0&&47===t.charCodeAt(0)&&(t=t.substr(1));for(var o=t.split("/"),i=0;i<o.length;i++){var s,h=o[i],u=0;12&(s=2<<(u=""===h?4:58===h.charCodeAt(0)?1:42===h.charCodeAt(0)?2:0))&&(h=h.slice(1),r.push(h),a.push(0!=(4&s))),14&s&&n[u]++,e.push({type:u,value:normalizeSegment(h)})}}function isEqualCharSpec(e,t,r){return e.char===t&&e.negate===r}generate[0]=function(e){return e.value},generate[1]=function(e,t){var r=getParam(t,e.value);return RouteRecognizer.ENCODE_AND_DECODE_PATH_SEGMENTS?encodePathSegment(r):r},generate[2]=function(e,t){return getParam(t,e.value)},generate[4]=function(){return""};var State=function(e,t,r,n,a){this.states=e,this.id=t,this.char=r,this.negate=n,this.nextStates=a?t:null,this.pattern="",this._regex=void 0,this.handlers=void 0,this.types=void 0};function isMatch(e,t){return e.negate?e.char!==t&&-1!==e.char:e.char===t||-1===e.char}function sortSolutions(e){return e.sort(function(e,t){var r=e.types||[0,0,0],n=r[0],a=r[1],o=r[2],i=t.types||[0,0,0],s=i[0],h=i[1],u=i[2];if(o!==u)return o-u;if(o){if(n!==s)return s-n;if(a!==h)return h-a}return a!==h?a-h:n!==s?s-n:0})}function recognizeChar(e,t){for(var r=[],n=0,a=e.length;n<a;n++){var o=e[n];r=r.concat(o.match(t))}return r}State.prototype.regex=function(){return this._regex||(this._regex=new RegExp(this.pattern)),this._regex},State.prototype.get=function(e,t){var r=this.nextStates;if(null!==r)if(isArray(r))for(var n=0;n<r.length;n++){var a=this.states[r[n]];if(isEqualCharSpec(a,e,t))return a}else{var o=this.states[r];if(isEqualCharSpec(o,e,t))return o}},State.prototype.put=function(e,t,r){var n;if(n=this.get(e,t))return n;var a=this.states;return n=new State(a,a.length,e,t,r),a[a.length]=n,null==this.nextStates?this.nextStates=n.id:isArray(this.nextStates)?this.nextStates.push(n.id):this.nextStates=[this.nextStates,n.id],n},State.prototype.match=function(e){var t=this.nextStates;if(!t)return[];var r=[];if(isArray(t))for(var n=0;n<t.length;n++){var a=this.states[t[n]];isMatch(a,e)&&r.push(a)}else{var o=this.states[t];isMatch(o,e)&&r.push(o)}return r};var RecognizeResults=function(e){this.length=0,this.queryParams=e||{}};function findHandler(e,t,r){var n=e.handlers,a=e.regex();if(!a||!n)throw new Error("state not initialized");var o=t.match(a),i=1,s=new RecognizeResults(r);s.length=n.length;for(var h=0;h<n.length;h++){for(var u=n[h],c=u.names,l=u.shouldDecodes,p={},g=0;g<c.length;g++){var d=c[g],f=o&&o[i++];RouteRecognizer.ENCODE_AND_DECODE_PATH_SEGMENTS&&l[g]?p[d]=f&&decodeURIComponent(f):p[d]=f}s[h]={handler:u.handler,params:p,isDynamic:!!c.length}}return s}function decodeQueryParamPart(e){var t;e=e.replace(/\+/gm,"%20");try{t=decodeURIComponent(e)}catch(e){t=""}return t}RecognizeResults.prototype.splice=Array.prototype.splice,RecognizeResults.prototype.slice=Array.prototype.slice,RecognizeResults.prototype.push=Array.prototype.push;var RouteRecognizer=function(){this.names=createMap();var e=[],t=new State(e,0,-1,!0,!1);e[0]=t,this.states=e,this.rootState=t};RouteRecognizer.prototype.add=function(e,t){for(var r,n=this.rootState,a="^",o=[0,0,0],i=new Array(e.length),s=[],h=!0,u=0,c=0;c<e.length;c++){var l=e[c],p=[],g=[];for(parse(s,l.path,p,o,g);u<s.length;u++){var d=s[u];4!==d.type&&(h=!1,n=n.put(47,!1,!1),a+="/",n=eachChar[d.type](d,n),a+=regex[d.type](d))}var f={handler:l.handler,names:p,shouldDecodes:g};i[c]=f}h&&(n=n.put(47,!1,!1),a+="/"),n.handlers=i,n.pattern=a+"$",n.types=o,"object"==typeof t&&null!==t&&t.as&&(r=t.as),r&&(this.names[r]={segments:s,handlers:i})},RouteRecognizer.prototype.handlersFor=function(e){var t=this.names[e];if(!t)throw new Error("There is no route named "+e);for(var r=new Array(t.handlers.length),n=0;n<t.handlers.length;n++)r[n]=t.handlers[n];return r},RouteRecognizer.prototype.hasRoute=function(e){return!!this.names[e]},RouteRecognizer.prototype.generate=function(e,t){var r=this.names[e],n="";if(!r)throw new Error("There is no route named "+e);for(var a=r.segments,o=0;o<a.length;o++){var i=a[o];4!==i.type&&(n+="/",n+=generate[i.type](i,t))}return"/"!==n.charAt(0)&&(n="/"+n),t&&t.queryParams&&(n+=this.generateQueryString(t.queryParams)),n},RouteRecognizer.prototype.generateQueryString=function(e){var t=[],r=Object.keys(e);r.sort();for(var n=0;n<r.length;n++){var a=r[n],o=e[a];if(null!=o){var i=encodeURIComponent(a);if(isArray(o))for(var s=0;s<o.length;s++){var h=a+"[]="+encodeURIComponent(o[s]);t.push(h)}else i+="="+encodeURIComponent(o),t.push(i)}}return 0===t.length?"":"?"+t.join("&")},RouteRecognizer.prototype.parseQueryString=function(e){for(var t=e.split("&"),r={},n=0;n<t.length;n++){var a=t[n].split("="),o=decodeQueryParamPart(a[0]),i=o.length,s=!1,h=void 0;1===a.length?h="true":(i>2&&"[]"===o.slice(i-2)&&(s=!0,r[o=o.slice(0,i-2)]||(r[o]=[])),h=a[1]?decodeQueryParamPart(a[1]):""),s?r[o].push(h):r[o]=h}return r},RouteRecognizer.prototype.recognize=function(e){var t,r=[this.rootState],n={},a=!1,o=e.indexOf("#");-1!==o&&(e=e.substr(0,o));var i=e.indexOf("?");if(-1!==i){var s=e.substr(i+1,e.length);e=e.substr(0,i),n=this.parseQueryString(s)}"/"!==e.charAt(0)&&(e="/"+e);var h=e;RouteRecognizer.ENCODE_AND_DECODE_PATH_SEGMENTS?e=normalizePath(e):(e=decodeURI(e),h=decodeURI(h));var u=e.length;u>1&&"/"===e.charAt(u-1)&&(e=e.substr(0,u-1),h=h.substr(0,h.length-1),a=!0);for(var c=0;c<e.length&&(r=recognizeChar(r,e.charCodeAt(c))).length;c++);for(var l=[],p=0;p<r.length;p++)r[p].handlers&&l.push(r[p]);r=sortSolutions(l);var g=l[0];return g&&g.handlers&&(a&&g.pattern&&"(.+)$"===g.pattern.slice(-5)&&(h+="/"),t=findHandler(g,h,n)),t},RouteRecognizer.VERSION="0.3.2",RouteRecognizer.ENCODE_AND_DECODE_PATH_SEGMENTS=!0,RouteRecognizer.Normalizer={normalizeSegment:normalizeSegment,normalizePath:normalizePath,encodePathSegment:encodePathSegment},RouteRecognizer.prototype.map=map;export default RouteRecognizer;