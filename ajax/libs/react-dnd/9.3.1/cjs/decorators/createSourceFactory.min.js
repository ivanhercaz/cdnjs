"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=createSourceFactory;var _invariant=_interopRequireDefault(require("invariant")),_js_utils=require("../utils/js_utils"),_utils=require("./utils");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),e}function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var ALLOWED_SPEC_METHODS=["canDrag","beginDrag","isDragging","endDrag"],REQUIRED_SPEC_METHODS=["beginDrag"],SourceImpl=function(){function n(e,t,r){var i=this;_classCallCheck(this,n),_defineProperty(this,"props",null),_defineProperty(this,"spec",void 0),_defineProperty(this,"monitor",void 0),_defineProperty(this,"ref",void 0),_defineProperty(this,"beginDrag",function(){if(i.props){var e=i.spec.beginDrag(i.props,i.monitor,i.ref.current);return"production"!==process.env.NODE_ENV&&(0,_invariant.default)((0,_js_utils.isPlainObject)(e),"beginDrag() must return a plain object that represents the dragged item. Instead received %s. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source",e),e}}),this.spec=e,this.monitor=t,this.ref=r}return _createClass(n,[{key:"receiveProps",value:function(e){this.props=e}},{key:"canDrag",value:function(){return!!this.props&&(!this.spec.canDrag||this.spec.canDrag(this.props,this.monitor))}},{key:"isDragging",value:function(e,t){return!!this.props&&(this.spec.isDragging?this.spec.isDragging(this.props,this.monitor):t===e.getSourceId())}},{key:"endDrag",value:function(){this.props&&this.spec.endDrag&&this.spec.endDrag(this.props,this.monitor,(0,_utils.getDecoratedComponent)(this.ref))}}]),n}();function createSourceFactory(r){return Object.keys(r).forEach(function(e){(0,_invariant.default)(-1<ALLOWED_SPEC_METHODS.indexOf(e),'Expected the drag source specification to only have some of the following keys: %s. Instead received a specification with an unexpected "%s" key. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source',ALLOWED_SPEC_METHODS.join(", "),e),(0,_invariant.default)("function"==typeof r[e],"Expected %s in the drag source specification to be a function. Instead received a specification with %s: %s. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source",e,e,r[e])}),REQUIRED_SPEC_METHODS.forEach(function(e){(0,_invariant.default)("function"==typeof r[e],"Expected %s in the drag source specification to be a function. Instead received a specification with %s: %s. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source",e,e,r[e])}),function(e,t){return new SourceImpl(r,e,t)}}