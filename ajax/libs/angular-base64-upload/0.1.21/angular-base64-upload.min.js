/*! angular-base64-upload - v0.1.21
* https://github.com/adonespitogo/angular-base64-upload
* Copyright (c) Adones Pitogo <pitogo.adones@gmail.com> [Wed Apr 26 2017]
* Licensed MIT */
!function(e,n){"use strict";e._arrayBufferToBase64=function(n){for(var t="",r=new Uint8Array(n),a=r.byteLength,i=0;i<a;i+=1)t+=String.fromCharCode(r[i]);return e.btoa(t)},e.angular.module("naif.base64",[]).directive("baseSixtyFourInput",["$window","$q",function(e,t){var r={onChange:"&",onAfterValidate:"&",parser:"&"},a=["onabort","onerror","onloadstart","onloadend","onprogress","onload"];return a.forEach(function(e){r[e]="&"}),{restrict:"A",require:"ngModel",scope:r,link:function(r,i,o,l){function f(e){if(o.maxnum&&o.multiple&&e){var n=e.length<=parseInt(o.maxnum);l.$setValidity("maxnum",n)}return e}function u(e){if(o.minnum&&o.multiple&&e){var n=e.length>=parseInt(o.minnum);l.$setValidity("minnum",n)}return e}function s(e){var n=!0;if(o.maxsize&&e){var t=1e3*parseFloat(o.maxsize);if(o.multiple)for(var r=0;r<e.length;r++){var a=e[r];if(a.filesize>t){n=!1;break}}else n=e.filesize<=t;l.$setValidity("maxsize",n)}return e}function c(e){var n=!0,t=1e3*parseFloat(o.minsize);if(o.minsize&&e){if(o.multiple)for(var r=0;r<e.length;r++){var a=e[r];if(a.filesize<t){n=!1;break}}else n=e.filesize>=t;l.$setValidity("minsize",n)}return e}function p(e){var n,t,r,a=!0;if(o.accept&&(t=o.accept.trim().replace(/[,\s]+/gi,"|").replace(/\./g,"\\.").replace(/\/\*/g,"/.*"),n=new RegExp(t)),o.accept&&e){if(o.multiple)for(var i=0;i<e.length;i++){var f=e[i];if(r="."+f.filename.split(".").pop(),!(a=n.test(f.filetype)||n.test(r)))break}else r="."+e.filename.split(".").pop(),a=n.test(e.filetype)||n.test(r);l.$setValidity("accept",a)}return e}function d(){var e=o.multiple?V:V[0];l.$setViewValue(e),s(e),c(e),f(e),u(e),p(e)}function m(e,n,t,r,a){t[e]=function(e){n()(e,t,r,b,V,a)}}function g(a,i,l){return function(f){var u,s=f.target.result,c=o.maxsize&&i.size>1024*o.maxsize;o.doNotParseIfOversize!==n&&c?l.base64=null:l.base64=e._arrayBufferToBase64(s),u=o.parser?t.when(r.parser()(i,l)):t.when(l),u.then(function(e){V.push(e),i.deferredObj.resolve()}),o.onload&&(r.onload&&"function"==typeof r.onload()?r.onload()(f,a,i,b,V,l):r.onload(f,b))}}function h(e,n,t){for(var i=a.length-1;i>=0;i--){var l=a[i];o[l]&&"onload"!==l&&m(l,r[l],e,n,t)}e.onload=g(e,n,t)}function v(){var n,r=[];for(n=b.length-1;n>=0;n--)b[n].deferredObj=t.defer(),r.push(b[n].deferredObj.promise);for(t.all(r).then(d),n=b.length-1;n>=0;n--){var a=new e.FileReader,i=b[n],o={};o.filetype=i.type,o.filename=i.name,o.filesize=i.size,h(a,i,o),a.readAsArrayBuffer(i)}}function y(e){o.onChange&&(r.onChange&&"function"==typeof r.onChange()?r.onChange()(e,b):r.onChange(e,b))}function z(e){if(o.onAfterValidate){for(var n=[],a=b.length-1;a>=0;a--)n.push(b[a].deferredObj.promise);t.all(n).then(function(){r.onAfterValidate&&"function"==typeof r.onAfterValidate()?r.onAfterValidate()(e,V,b):r.onAfterValidate(e,V,b)})}}var b=[],V=[];l&&(l.$isEmpty=function(e){return!e||(angular.isArray(e)?0===e.length:!e.base64)},r._clearInput=function(){i[0].value=""},r.$watch(function(){return l.$viewValue},function(e){l.$isEmpty(e)&&r._clearInput()}),i.on("change",function(e){e.target.files.length&&(V=[],V=angular.copy(V),b=e.target.files,v(),y(e),z(e))}))}}}])}(window);
//# sourceMappingURL=angular-base64-upload.min.js.map
