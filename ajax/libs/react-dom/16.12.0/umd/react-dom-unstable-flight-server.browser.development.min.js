"use strict";!function(n,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("react-dom/server")):"function"==typeof define&&define.amd?define(["react-dom/server"],e):n.ReactFlightDOMServer=e(n.ReactDOMServer)}(this,function(o){function i(n){n()}function u(n,e){return n.enqueue(e),0<n.desiredSize}var e=new TextEncoder;function c(n){return e.encode(n)}var a="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103,d=JSON.stringify;function f(n,e){var r=[],t={destination:e,nextChunkId:0,pendingChunks:0,pingedSegments:r,completedJSONChunks:[],completedErrorChunks:[],flowing:!1,toJSON:function(n,e){return function(e,n){if("string"==typeof n)return function(n){return"$"===n[0]?"$"+n:n}(n);for(;"object"==typeof n&&null!==n&&n.$$typeof===a;){var r=n;try{n=p(r)}catch(n){if("object"==typeof n&&null!==n&&"function"==typeof n.then){e.pendingChunks++;var t=s(e,r),o=t.ping;return n.then(o,o),l(t.id)}e.pendingChunks++;var i=e.nextChunkId++;return h(e,i,n),l(i)}}return n}(t,e)}};t.pendingChunks++;var o=s(t,n);return r.push(o),t}function p(n){var e,r=n.type,t=n.props;if("function"==typeof r)return r(t);if("string"==typeof r)return e=n,o.renderToStaticMarkup(e);throw new Error("Unsupported type.")}function s(t,n){var o={id:t.nextChunkId++,model:n,ping:function(){return e=o,(r=(n=t).pingedSegments).push(e),void(1===r.length&&i(function(){return v(n)}));var n,e,r}};return o}function l(n){return"$"+n.toString(16)}function g(n,e){return n+e.toString(16)+":"}function h(n,e,r){var t,o="";try{r instanceof Error?(t=""+r.message,o=""+r.stack):t="Error: "+r}catch(n){t="An error occurred but serializing the error message failed."}var i={message:t,stack:o},u=g("E",e)+d(i)+"\n";n.completedErrorChunks.push(c(u))}function t(e,r){var n=r.model;try{for(;"object"==typeof n&&null!==n&&n.$$typeof===a;){var t=n;n=p(r.model=t)}var o,i=d(n,e.toJSON),u=r.id;o=0===u?i+"\n":g("J",u)+i+"\n",e.completedJSONChunks.push(c(o))}catch(n){if("object"==typeof n&&null!==n&&"function"==typeof n.then){var f=r.ping;return void n.then(f,f)}h(e,r.id,n)}}function v(n){var e=n.pingedSegments;n.pingedSegments=[];for(var r=0;r<e.length;r++){t(n,e[r])}n.flowing&&y(n)}var m=!1;function y(n){if(!m){m=!0;var e=n.destination;try{for(var r=n.completedJSONChunks,t=0;t<r.length;t++){if(n.pendingChunks--,!u(e,r[t])){n.flowing=!1,t++;break}}r.splice(0,t);var o=n.completedErrorChunks;for(t=0;t<o.length;t++){if(n.pendingChunks--,!u(e,o[t])){n.flowing=!1,t++;break}}o.splice(0,t)}finally{m=!1}0===n.pendingChunks&&e.close()}}var n={renderToReadableStream:function(r){var t;return new ReadableStream({start:function(n){var e;t=f(r,n),(e=t).flowing=!0,i(function(){return v(e)})},pull:function(n){var e;(e=t).flowing=!0,y(e)},cancel:function(n){}})}},r=Object.freeze({default:n}),k=r?n:r;return k.default||k});