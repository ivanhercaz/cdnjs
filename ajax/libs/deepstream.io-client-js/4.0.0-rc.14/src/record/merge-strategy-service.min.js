"use strict";var __values=this&&this.__values||function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],r=0;return t?t.call(e):{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}}},__read=this&&this.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,a,s=r.call(e),o=[];try{for(;(void 0===t||0<t--)&&!(n=s.next()).done;)o.push(n.value)}catch(e){a={error:e}}finally{try{n&&!n.done&&(r=s.return)&&r.call(s)}finally{if(a)throw a.error}}return o};Object.defineProperty(exports,"__esModule",{value:!0});var constants_1=require("../constants"),message_constants_1=require("../../binary-protocol/src/message-constants"),MergeStrategyService=function(){function e(e,t){this.services=e,this.defaultStrategy=t,this.strategiesByRecord=new Map,this.strategiesByPattern=new Map}return e.prototype.setMergeStrategyByName=function(e,t){this.strategiesByRecord.set(e,t)},e.prototype.setMergeStrategyByPattern=function(e,t){this.strategiesByPattern.set(e,t)},e.prototype.merge=function(r,n,a,s,o,i,c){var t,e,l=this.strategiesByRecord.get(r);if(l)l(a,n,o,s,function(e,t){i.call(c,e,r,t,s,o,n,a)});else{try{for(var u=__values(this.strategiesByPattern),y=u.next();!y.done;y=u.next()){var f=__read(y.value,2),g=f[0],v=f[1];if(g.test(r))return void v(a,n,o,s,function(e,t){i.call(c,e,r,t,s,o,n,a)})}}catch(e){t={error:e}}finally{try{y&&!y.done&&(e=u.return)&&e.call(u)}finally{if(t)throw t.error}}this.defaultStrategy?this.defaultStrategy(a,n,o,s,function(e,t){i.call(c,e,r,t,s,o,n,a)}):this.services.logger.error({topic:message_constants_1.TOPIC.RECORD},constants_1.EVENT.RECORD_VERSION_EXISTS,{remoteVersion:s,recordName:r})}},e}();exports.MergeStrategyService=MergeStrategyService;