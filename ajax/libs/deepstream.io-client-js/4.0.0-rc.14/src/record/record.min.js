"use strict";var __extends=this&&this.__extends||function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}();Object.defineProperty(exports,"__esModule",{value:!0});var utils=require("../util/utils"),constants_1=require("../constants"),Emitter=require("component-emitter2"),Record=function(r){function t(t){var e=r.call(this)||this;return e.record=t,e.subscriptions=[],e.record.on(constants_1.EVENT.RECORD_READY,e.emit.bind(e,constants_1.EVENT.RECORD_READY,e)),e.record.on(constants_1.EVENT.RECORD_DISCARDED,e.emit.bind(e,constants_1.EVENT.RECORD_DISCARDED)),e.record.on(constants_1.EVENT.RECORD_DELETED,e.emit.bind(e,constants_1.EVENT.RECORD_DELETED)),e.record.on(constants_1.EVENT.RECORD_ERROR,e.emit.bind(e,constants_1.EVENT.RECORD_ERROR)),e.record.addReference(e),e}return __extends(t,r),Object.defineProperty(t.prototype,"name",{get:function(){return this.record.name},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isReady",{get:function(){return this.record.isReady},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"version",{get:function(){return this.record.version},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hasProvider",{get:function(){return this.record.hasProvider},enumerable:!0,configurable:!0}),t.prototype.whenReady=function(t){if(!t)return this.record.whenReady(this);this.record.whenReady(this,t)},t.prototype.get=function(t){return this.record.get(t)},t.prototype.set=function(t,e,r){return this.record.set(utils.normalizeSetArguments(arguments))},t.prototype.setWithAck=function(t,e,r){return this.record.setWithAck(utils.normalizeSetArguments(arguments))},t.prototype.erase=function(t){if(!t)throw new Error("unable to erase record data without path, consider using `delete`");this.set(t,void 0)},t.prototype.eraseWithAck=function(t,e){if(!t)throw new Error("unable to erase record data without path, consider using `delete`");if(!e)return this.setWithAck(t,void 0);this.setWithAck(t,void 0,e)},t.prototype.subscribe=function(t,e,r){var o=utils.normalizeArguments(arguments);this.subscriptions.push(o),this.record.subscribe(o)},t.prototype.unsubscribe=function(t,e){var r=utils.normalizeArguments(arguments);this.subscriptions=this.subscriptions.filter(function(t){return t.path!==r.path||t.callback!==r.callback}),this.record.unsubscribe(r)},t.prototype.discard=function(){for(var t=0;t<this.subscriptions.length;t++)this.record.unsubscribe(this.subscriptions[t]);return this.record.removeReference(this)},t.prototype.delete=function(t){return this.record.delete(t)},t.prototype.setMergeStrategy=function(t){this.record.setMergeStrategy(t)},t}(Emitter);exports.Record=Record;