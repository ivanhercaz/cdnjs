"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var StateMachine=function(){function t(t,i){this.stateMachine=i,this.inEndState=!1,this.transitions=i.transitions,this.state=i.init,this.context=i.context,this.history=[{oldState:"-",newState:this.state,transitionName:"-"}]}return t.prototype.transition=function(t){for(var i,e=0;e<this.transitions.length;e++)if(t===(i=this.transitions[e]).name&&(this.state===i.from||void 0===i.from)){this.history.push({oldState:this.state,transitionName:t,newState:i.to});var n=this.state;return this.state=i.to,this.stateMachine.onStateChanged&&this.stateMachine.onStateChanged.call(this.context,this.state,n),void(i.handler&&i.handler.call(this.context))}var s=JSON.stringify({transition:t,state:this.state}),a=this.history.reduce(function(t,i){return t+"\n\tFrom "+i.oldState+" to "+i.newState+" via "+i.transitionName},"");throw new Error("Invalid state transition.\nDetails: "+s+" \nHistory: "+a)},t}();exports.StateMachine=StateMachine;