"use strict";var __extends=this&&this.__extends||function(){var i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};return function(t,e){function r(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}();Object.defineProperty(exports,"__esModule",{value:!0});var utils=require("../util/utils"),Emitter=require("component-emitter2"),AnonymousRecord=function(r){function t(t){var e=r.call(this)||this;return e.record=null,e.subscriptions=[],e.getRecordCore=t,e}return __extends(t,r),Object.defineProperty(t.prototype,"name",{get:function(){return this.record?this.record.name:""},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isReady",{get:function(){return!!this.record&&this.record.isReady},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"version",{get:function(){return this.record?this.record.version:-1},enumerable:!0,configurable:!0}),t.prototype.whenReady=function(t){if(this.record){if(!t)return this.record.whenReady(this);this.record.whenReady(this,t)}},t.prototype.setName=function(t,e){if(this.name!==t){this.discard(),this.record=this.getRecordCore(t),this.record.addReference(this);for(var r=0;r<this.subscriptions.length;r++)this.record.subscribe(this.subscriptions[r]);if(this.emit("nameChanged",t),!e)return this.record.whenReady(this);this.record.whenReady(this,e)}},t.prototype.get=function(t){if(this.record)return this.record.get(t)},t.prototype.set=function(t,e,r){if(this.record)return this.record.set(utils.normalizeSetArguments(arguments))},t.prototype.setWithAck=function(t,e,r){if(this.record)return this.record.setWithAck(utils.normalizeSetArguments(arguments))},t.prototype.erase=function(t){if(this.record)return this.record.set(utils.normalizeSetArguments(arguments))},t.prototype.eraseWithAck=function(t,e){if(this.record)return this.record.setWithAck(utils.normalizeSetArguments(arguments))},t.prototype.subscribe=function(t,e,r){var i=utils.normalizeArguments(arguments);this.subscriptions.push(i),this.record&&this.record.subscribe(i)},t.prototype.unsubscribe=function(t,e){var r=utils.normalizeArguments(arguments);this.subscriptions=this.subscriptions.filter(function(t){return t.path!==r.path||t.callback!==r.callback}),this.record&&this.record.unsubscribe(r)},t.prototype.discard=function(){if(this.record){for(var t=0;t<this.subscriptions.length;t++)this.record.unsubscribe(this.subscriptions[t]);return this.record.removeReference(this)}},t.prototype.delete=function(t){if(this.record)return this.record.delete(t)},t.prototype.setMergeStrategy=function(t){this.record&&this.record.setMergeStrategy(t)},t}(Emitter);exports.AnonymousRecord=AnonymousRecord;