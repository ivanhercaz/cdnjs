{"version":3,"sources":["single-notifier.spec.js"],"names":["__awaiter","this","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","value","step","next","e","rejected","result","done","then","apply","__generator","body","f","y","t","g","_","label","sent","trys","ops","verb","throw","return","Symbol","iterator","n","v","op","TypeError","call","pop","length","push","_this","Object","defineProperty","exports","bluebird_1","require","sinon_1","mocks_1","constants_1","message_constants_1","single_notifier_1","describe","services","singleNotifier","callbackSpy","action","RECORD_ACTIONS","READ","name","topic","TOPIC","RECORD","beforeEach","getServicesMock","SingleNotifier","spy","afterEach","verify","it","message","connectionMock","expects","once","withExactArgs","timeoutRegistryMock","request","_a","connection","isConnected","delay","assert","calledOnce","calledWithExactly","EVENT","CLIENT_OFFLINE","MESSAGE_DENIED","isError","recieve","undefined","notCalled","parsedData","some","simulateConnectionLost"],"mappings":"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"}