{"version":3,"sources":["message-builder.js"],"names":["Object","defineProperty","exports","value","message_constants_1","require","utils_1","constants_1","message_validator_1","getMessage","msg","isAck","message","action","isWriteAck","ACTION_TO_WRITE_ACK","undefined","ACTIONS","topic","Error","TOPIC","meta","n","name","m","names","c","correlationId","s","subscription","v","version","p","path","r","reason","u","url","t","originalTopic","a","originalAction","x","protocolVersion","rn","requestorName","rd","requestorData","ts","trustedSender","rt","registryTopic","payloadEncoding","PAYLOAD_ENCODING","JSON","META_KEYS","metaError","validateMeta","payloadBuff","metaStr","stringify","metaBuff","Buffer","from","data","parsedData","payloadStr","hasPayload","console","error","metaBuffLength","length","payloadBuffLength","META_PAYLOAD_OVERFLOW_LENGTH","buildRaw","buildMultipart","payload","fin","metaLength","payloadLength","messageParts","metaSectionOffset","payloadSectionOffset","metaSectionLength","Math","min","payloadSectionLength","metaSection","slice","payloadSection","push","concat","messageBufferLength","HEADER_LENGTH","messageBuffer","allocUnsafe","writeUIntBE","copy","combineMultipleMessages","messages"],"mappings":"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"}