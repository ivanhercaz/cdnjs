"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const message_parser_1=require("../../binary-protocol/src/message-parser"),message_builder_1=require("../../binary-protocol/src/message-builder"),message_constants_1=require("../../binary-protocol/src/message-constants"),NodeWebSocket=require("ws");exports.socketFactory=((e,s)=>{const a=new NodeWebSocket(e,s);return a.onparsedmessage=(()=>{}),a.onmessage=(e=>{const s=message_parser_1.parse(e.data);a.onparsedmessages(s)}),a.sendParsedMessage=(e=>{if(e.topic===message_constants_1.TOPIC.CONNECTION&&e.action===message_constants_1.CONNECTION_ACTIONS.CLOSING)return a.onparsedmessages([{topic:message_constants_1.TOPIC.CONNECTION,action:message_constants_1.CONNECTION_ACTIONS.CLOSED}]),void a.close();e.data=JSON.stringify(e.parsedData),a.send(message_builder_1.getMessage(e,!1))}),a});