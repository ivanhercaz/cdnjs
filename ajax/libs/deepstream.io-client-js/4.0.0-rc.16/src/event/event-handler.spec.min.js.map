{"version":3,"sources":["event-handler.spec.js"],"names":["__assign","this","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","value","step","next","e","rejected","result","done","then","__generator","body","f","y","g","_","label","sent","trys","ops","verb","throw","return","Symbol","iterator","v","op","TypeError","pop","push","_this","defineProperty","exports","chai_1","require","sinon","mocks_1","constants_1","message_constants_1","bluebird_1","client_options_1","event_handler_1","describe","services","listener","eventHandler","handle","spy","name","beforeEach","getServicesMock","getListenerMock","EventHandler","DefaultOptions","subscriptionInterval","getHandle","afterEach","verify","listenerMock","it","expect","subscribe","bind","to","unsubscribe","emit","connectionMock","expects","once","withExactArgs","topic","TOPIC","EVENT","action","EVENT_ACTIONS","EMIT","parsedData","SUBSCRIBE","timeoutRegistryMock","message","twice","simulateConnectionReestablished","UNSUBSCRIBE","loggerMock","NOT_SUBSCRIBED","assert","calledOnce","calledWithExactly","callCount","undefined","MESSAGE_DENIED","originalAction","isAck","callback","listen","unlisten","subscriptionFoundMsg","SUBSCRIPTION_FOR_PATTERN_FOUND","subscription","subscriptionRemovedMsg","SUBSCRIPTION_FOR_PATTERN_REMOVED","UNSOLICITED_MESSAGE","connection","isConnected","isInLimbo","_a","delay"],"mappings":"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"}