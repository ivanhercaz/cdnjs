"use strict";Object.defineProperty(exports,"__esModule",{value:!0});class StateMachine{constructor(t,s){this.stateMachine=s,this.inEndState=!1,this.transitions=s.transitions,this.state=s.init,this.context=s.context}transition(t){let s;for(let e=0;e<this.transitions.length;e++)if(t===(s=this.transitions[e]).name&&(this.state===s.from||void 0===s.from)){const t=this.state;return this.state=s.to,this.stateMachine.onStateChanged&&this.stateMachine.onStateChanged.call(this.context,this.state,t),void(s.handler&&s.handler.call(this.context))}const e=JSON.stringify({transition:t,state:this.state});throw new Error(`Invalid state transition: ${e}`)}}exports.StateMachine=StateMachine;