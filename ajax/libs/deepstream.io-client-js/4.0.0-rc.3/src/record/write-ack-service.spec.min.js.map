{"version":3,"sources":["write-ack-service.spec.js"],"names":["__awaiter","this","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","value","step","next","e","rejected","result","done","then","apply","Object","defineProperty","exports","bluebird_1","require","sinon_1","mocks_1","constants_1","message_constants_1","write_ack_service_1","describe","topic","TOPIC","RECORD","action","RECORD_ACTIONS","CREATEANDPATCH","ackAction","CREATEANDPATCH_WITH_WRITE_ACK","name","services","writeAckService","callbackSpy","beforeEach","getServicesMock","WriteAcknowledgementService","spy","afterEach","verify","it","connection","isConnected","connectionMock","expects","never","send","delay","assert","calledOnce","calledWithExactly","EVENT","CLIENT_OFFLINE","messageBody","simulateConnectionLost","calledTwice","once","withExactArgs","assign","correlationId","message","msg","recieve","notCalled","WRITE_ACKNOWLEDGEMENT","originalAction","CREATEANDUPDATE_WITH_WRITE_ACK","calledWith","errorAction","MESSAGE_DENIED","isError"],"mappings":"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"}