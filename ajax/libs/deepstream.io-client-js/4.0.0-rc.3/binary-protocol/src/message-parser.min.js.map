{"version":3,"sources":["message-parser.js"],"names":["Object","defineProperty","exports","value","message_constants_1","require","constants_1","utils_1","message_validator_1","isError","message","action","topic","TOPIC","PARSER","BULK_ACTIONS","[object Object]","RECORD","RECORD_ACTIONS","SUBSCRIBECREATEANDREAD_BULK","SUBSCRIBECREATEANDREAD","SUBSCRIBEANDHEAD_BULK","SUBSCRIBEANDHEAD","SUBSCRIBEANDREAD_BULK","SUBSCRIBEANDREAD","EVENT","EVENT_ACTIONS","SUBSCRIBE_BULK","SUBSCRIBE","UNSUBSCRIBE_BULK","UNSUBSCRIBE","uuid","parse","buffer","queue","offset","messages","bytesConsumed","rawMessage","readBinary","push","fin","parseMessage","joinMessages","undefined","parseError","isAck","names","forEach","name","correlationId","isBulk","bulkId","bulkAction","length","parseData","parsedData","data","payloadEncoding","PAYLOAD_ENCODING","JSON","Error","parseJSON","buff","HEADER_LENGTH","metaLength","readUIntBE","payloadLength","messageLength","rawHeader","slice","meta","payload","rawMessages","payloadSections","metaSections","payloadSection","metaSection","Buffer","concat","rawTopic","rawAction","PARSER_ACTIONS","UNKNOWN_TOPIC","parsedMessage","description","raw","ACTIONS","UNKNOWN_ACTION","MESSAGE_PARSE_ERROR","toString","metaError","validateMeta","addMetadataToMessage","hasPayload","INVALID_MESSAGE","BINARY","isWriteAck","key","META_KEYS","err"],"mappings":"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"}