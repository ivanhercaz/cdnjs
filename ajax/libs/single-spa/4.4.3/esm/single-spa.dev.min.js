var singleSpa=Object.freeze({__proto__:null,get start(){return start},get ensureJQuerySupport(){return ensureJQuerySupport},get setBootstrapMaxTime(){return setBootstrapMaxTime},get setMountMaxTime(){return setMountMaxTime},get setUnmountMaxTime(){return setUnmountMaxTime},get setUnloadMaxTime(){return setUnloadMaxTime},get registerApplication(){return registerApplication},get getMountedApps(){return getMountedApps},get getAppStatus(){return getAppStatus},get unloadApplication(){return unloadApplication},get checkActivityFunctions(){return checkActivityFunctions},get getAppNames(){return getAppNames},get declareChildApplication(){return declareChildApplication},get unloadChildApplication(){return unloadChildApplication},get navigateToUrl(){return navigateToUrl},get triggerAppChange(){return triggerAppChange},get addErrorHandler(){return addErrorHandler},get removeErrorHandler(){return removeErrorHandler},get mountRootParcel(){return mountRootParcel},get NOT_LOADED(){return NOT_LOADED},get LOADING_SOURCE_CODE(){return LOADING_SOURCE_CODE},get NOT_BOOTSTRAPPED(){return NOT_BOOTSTRAPPED},get BOOTSTRAPPING(){return BOOTSTRAPPING},get NOT_MOUNTED(){return NOT_MOUNTED},get MOUNTING(){return MOUNTING},get UPDATING(){return UPDATING},get LOAD_ERROR(){return LOAD_ERROR},get MOUNTED(){return MOUNTED},get UNMOUNTING(){return UNMOUNTING},get SKIP_BECAUSE_BROKEN(){return SKIP_BECAUSE_BROKEN}}),commonjsGlobal="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},NativeCustomEvent=commonjsGlobal.CustomEvent;function useNative(){try{var t=new NativeCustomEvent("cat",{detail:{foo:"bar"}});return"cat"===t.type&&"bar"===t.detail.foo}catch(t){}return!1}var customEvent=useNative()?NativeCustomEvent:"undefined"!=typeof document&&"function"==typeof document.createEvent?function(t,e){var n=document.createEvent("CustomEvent");return e?n.initCustomEvent(t,e.bubbles,e.cancelable,e.detail):n.initCustomEvent(t,!1,!1,void 0),n}:function(t,e){var n=document.createEventObject();return n.type=t,e?(n.bubbles=Boolean(e.bubbles),n.cancelable=Boolean(e.cancelable),n.detail=e.detail):(n.bubbles=!1,n.cancelable=!1,n.detail=void 0),n};function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperty(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ownKeys(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function _objectSpread2(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(n,!0).forEach(function(e){_defineProperty(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ownKeys(n).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_setPrototypeOf(t,e)}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function _construct(t,e,n){return(_construct=isNativeReflectConstruct()?Reflect.construct:function(t,e,n){var r=[null];r.push.apply(r,e);var o=new(Function.bind.apply(t,r));return n&&_setPrototypeOf(o,n.prototype),o}).apply(null,arguments)}function _isNativeFunction(t){return-1!==Function.toString.call(t).indexOf("[native code]")}function _wrapNativeSuper(t){var e="function"==typeof Map?new Map:void 0;return(_wrapNativeSuper=function(t){if(null===t||!_isNativeFunction(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,n)}function n(){return _construct(t,arguments,_getPrototypeOf(this).constructor)}return n.prototype=Object.create(t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),_setPrototypeOf(n,t)})(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _possibleConstructorReturn(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?_assertThisInitialized(t):e}var errorHandlers=[];function handleAppError(t,e){var n=transformErr(t,e);errorHandlers.length?errorHandlers.forEach(function(t){return t(n)}):setTimeout(function(){throw n})}function addErrorHandler(t){if("function"!=typeof t)throw Error("a single-spa error handler must be a function");errorHandlers.push(t)}function removeErrorHandler(t){if("function"!=typeof t)throw Error("a single-spa error handler must be a function");var e=!1;return errorHandlers=errorHandlers.filter(function(n){var r=n===t;return e=e||r,!r}),e}function transformErr(t,e){var n,r=e.unmountThisParcel?"Parcel":"Application",o="".concat(r," '").concat(e.name,"' died in status ").concat(e.status,": ");if(t instanceof Error){try{t.message=o+t.message}catch(t){}n=t}else{console.warn("While ".concat(e.status,", '").concat(e.name,"' rejected its lifecycle function promise with a non-Error. This will cause stack traces to not be accurate."));try{n=Error(o+JSON.stringify(t))}catch(e){n=t}}n.appName=e.name,n.appOrParcelName=e.name;try{n.name=e.name}catch(t){}return n}var NOT_LOADED="NOT_LOADED",LOADING_SOURCE_CODE="LOADING_SOURCE_CODE",NOT_BOOTSTRAPPED="NOT_BOOTSTRAPPED",BOOTSTRAPPING="BOOTSTRAPPING",NOT_MOUNTED="NOT_MOUNTED",MOUNTING="MOUNTING",MOUNTED="MOUNTED",UPDATING="UPDATING",UNMOUNTING="UNMOUNTING",UNLOADING="UNLOADING",LOAD_ERROR="LOAD_ERROR",SKIP_BECAUSE_BROKEN="SKIP_BECAUSE_BROKEN";function isActive(t){return t.status===MOUNTED}function isntActive(t){return!isActive(t)}function isLoaded(t){return t.status!==NOT_LOADED&&t.status!==LOADING_SOURCE_CODE&&t.status!==LOAD_ERROR}function isntLoaded(t){return!isLoaded(t)}function shouldBeActive(t){try{return t.activeWhen(window.location)}catch(e){handleAppError(e,t),t.status=SKIP_BECAUSE_BROKEN}}function shouldntBeActive(t){try{return!t.activeWhen(window.location)}catch(e){handleAppError(e,t),t.status=SKIP_BECAUSE_BROKEN}}function notSkipped(t){return t!==SKIP_BECAUSE_BROKEN&&(!t||t.status!==SKIP_BECAUSE_BROKEN)}function withoutLoadErrors(t){return t.status!==LOAD_ERROR||(new Date).getTime()-t.loadErrorTime>=200}function toName(t){return t.name}var globalTimeoutConfig={bootstrap:{millis:4e3,dieOnTimeout:!1},mount:{millis:3e3,dieOnTimeout:!1},unmount:{millis:3e3,dieOnTimeout:!1},unload:{millis:3e3,dieOnTimeout:!1}};function setBootstrapMaxTime(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if("number"!=typeof t||t<=0)throw Error("bootstrap max time must be a positive integer number of milliseconds");globalTimeoutConfig.bootstrap={millis:t,dieOnTimeout:e}}function setMountMaxTime(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if("number"!=typeof t||t<=0)throw Error("mount max time must be a positive integer number of milliseconds");globalTimeoutConfig.mount={millis:t,dieOnTimeout:e}}function setUnmountMaxTime(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if("number"!=typeof t||t<=0)throw Error("unmount max time must be a positive integer number of milliseconds");globalTimeoutConfig.unmount={millis:t,dieOnTimeout:e}}function setUnloadMaxTime(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if("number"!=typeof t||t<=0)throw Error("unload max time must be a positive integer number of milliseconds");globalTimeoutConfig.unload={millis:t,dieOnTimeout:e}}function reasonableTime(t,e,n){var r=1e3;return new Promise(function(o,i){var a=!1,u=!1;function s(t){if(!a)if(!0===t)u=!0,n.dieOnTimeout?i("".concat(e," did not resolve or reject for ").concat(n.millis," milliseconds")):console.error("".concat(e," did not resolve or reject for ").concat(n.millis," milliseconds -- we're no longer going to warn you about it."));else if(!u){var o=t,c=o*r;console.warn("".concat(e," did not resolve or reject within ").concat(c," milliseconds")),c+r<n.millis&&setTimeout(function(){return s(o+1)},r)}}t.then(function(t){a=!0,o(t)}).catch(function(t){a=!0,i(t)}),setTimeout(function(){return s(1)},r),setTimeout(function(){return s(!0)},n.millis)})}function ensureValidAppTimeouts(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return _objectSpread2({},globalTimeoutConfig,{},t)}function find(t,e){for(var n=0;n<t.length;n++)if(e(t[n]))return t[n];return null}function validLifecycleFn(t){return t&&("function"==typeof t||(e=t,Array.isArray(e)&&!find(e,function(t){return"function"!=typeof t})));var e}function flattenFnArray(t,e){return 0===(t=Array.isArray(t)?t:[t]).length&&(t=[function(){return Promise.resolve()}]),function(n){return new Promise(function(r,o){!function i(a){var u=t[a](n);smellsLikeAPromise(u)?u.then(function(){a===t.length-1?r():i(a+1)}).catch(o):o("".concat(e," at index ").concat(a," did not return a promise"))}(0)})}}function smellsLikeAPromise(t){return t&&"function"==typeof t.then&&"function"==typeof t.catch}function toBootstrapPromise(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return Promise.resolve().then(function(){return t.status!==NOT_BOOTSTRAPPED?t:(t.status=BOOTSTRAPPING,reasonableTime(t.bootstrap(getProps(t)),"Bootstrapping appOrParcel '".concat(t.name,"'"),t.timeouts.bootstrap).then(function(){return t.status=NOT_MOUNTED,t}).catch(function(n){if(t.status=SKIP_BECAUSE_BROKEN,e)throw transformErr(n,t);return handleAppError(n,t),t}))})}function toUnmountPromise(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return Promise.resolve().then(function(){if(t.status!==MOUNTED)return t;t.status=UNMOUNTING;var n=Object.keys(t.parcels).map(function(e){return t.parcels[e].unmountThisParcel()});return Promise.all(n).then(r,function(n){return r().then(function(){var r=Error(n.message);if(e){var o=transformErr(r,t);throw t.status=SKIP_BECAUSE_BROKEN,o}handleAppError(r,t),t.status=SKIP_BECAUSE_BROKEN})}).then(function(){return t});function r(){return reasonableTime(t.unmount(getProps(t)),"Unmounting application ".concat(t.name,"'"),t.timeouts.unmount).then(function(){t.status=NOT_MOUNTED}).catch(function(n){if(e){var r=transformErr(n,t);throw t.status=SKIP_BECAUSE_BROKEN,r}handleAppError(n,t),t.status=SKIP_BECAUSE_BROKEN})}})}var beforeFirstMountFired=!1,firstMountFired=!1;function toMountPromise(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return Promise.resolve().then(function(){return t.status!==NOT_MOUNTED?t:(beforeFirstMountFired||(window.dispatchEvent(new customEvent("single-spa:before-first-mount")),beforeFirstMountFired=!0),reasonableTime(t.mount(getProps(t)),"Mounting application '".concat(t.name,"'"),t.timeouts.mount).then(function(){return t.status=MOUNTED,firstMountFired||(window.dispatchEvent(new customEvent("single-spa:first-mount")),firstMountFired=!0),t}).catch(function(n){return t.status=MOUNTED,toUnmountPromise(t).then(r,r);function r(){if(e){var r=transformErr(n,t);throw t.status=SKIP_BECAUSE_BROKEN,r}return handleAppError(n,t),t.status=SKIP_BECAUSE_BROKEN,t}}))})}function toUpdatePromise(t){return Promise.resolve().then(function(){if(t.status!==MOUNTED)throw Error("Cannot update parcel '".concat(t.name,"' because it is not mounted"));return t.status=UPDATING,reasonableTime(t.update(getProps(t)),"Updating parcel '".concat(t.name,"'"),t.timeouts.mount).then(function(){return t.status=MOUNTED,t}).catch(function(e){var n=transformErr(e,t);throw t.status=SKIP_BECAUSE_BROKEN,n})})}var parcelCount=0,rootParcels={parcels:{}};function mountRootParcel(){return mountParcel.apply(rootParcels,arguments)}function mountParcel(t,e){var n=this;if(!t||"object"!==_typeof(t)&&"function"!=typeof t)throw Error("Cannot mount parcel without a config object or config loading function");if(t.name&&"string"!=typeof t.name)throw Error("Parcel name must be a string, if provided");if("object"!==_typeof(e))throw Error("Parcel ".concat(name," has invalid customProps -- must be an object"));if(!e.domElement)throw Error("Parcel ".concat(name," cannot be mounted without a domElement provided as a prop"));var r,o=parcelCount++,i="function"==typeof t,a=i?t:function(){return Promise.resolve(t)},u={id:o,parcels:{},status:i?LOADING_SOURCE_CODE:NOT_BOOTSTRAPPED,customProps:e,parentName:n.name,unmountThisParcel:function(){if(u.status!==MOUNTED)throw Error("Cannot unmount parcel '".concat(name,"' -- it is in a ").concat(u.status," status"));return toUnmountPromise(u,!0).then(function(t){return u.parentName&&delete n.parcels[u.id],t}).then(function(t){return c(t),t}).catch(function(t){throw u.status=SKIP_BECAUSE_BROKEN,p(t),t})}};n.parcels[o]=u;var s=a();if(!s||"function"!=typeof s.then)throw Error("When mounting a parcel, the config loading function must return a promise that resolves with the parcel config");var c,p,l=(s=s.then(function(t){if(!t)throw Error("When mounting a parcel, the config loading function returned a promise that did not resolve with a parcel config");var e=t.name||"parcel-".concat(o);if(!validLifecycleFn(t.bootstrap))throw Error("Parcel ".concat(e," must have a valid bootstrap function"));if(!validLifecycleFn(t.mount))throw Error("Parcel ".concat(e," must have a valid mount function"));if(!validLifecycleFn(t.unmount))throw Error("Parcel ".concat(e," must have a valid unmount function"));if(t.update&&!validLifecycleFn(t.update))throw Error("Parcel ".concat(e," provided an invalid update function"));var n=flattenFnArray(t.bootstrap),i=flattenFnArray(t.mount),a=flattenFnArray(t.unmount);u.status=NOT_BOOTSTRAPPED,u.name=e,u.bootstrap=n,u.mount=i,u.unmount=a,u.timeouts=ensureValidAppTimeouts(t.timeouts),t.update&&(u.update=flattenFnArray(t.update),r.update=function(t){return u.customProps=t,promiseWithoutReturnValue(toUpdatePromise(u))})})).then(function(){return toBootstrapPromise(u,!0)}),f=l.then(function(){return toMountPromise(u,!0)}),d=new Promise(function(t,e){c=t,p=e});return r={mount:function(){return promiseWithoutReturnValue(Promise.resolve().then(function(){if(u.status!==NOT_MOUNTED)throw Error("Cannot mount parcel '".concat(name,"' -- it is in a ").concat(u.status," status"));return n.parcels[o]=u,toMountPromise(u)}))},unmount:function(){return promiseWithoutReturnValue(u.unmountThisParcel())},getStatus:function(){return u.status},loadPromise:promiseWithoutReturnValue(s),bootstrapPromise:promiseWithoutReturnValue(l),mountPromise:promiseWithoutReturnValue(f),unmountPromise:promiseWithoutReturnValue(d)}}function promiseWithoutReturnValue(t){return t.then(function(){return null})}function getProps(t){var e=_objectSpread2({},t.customProps,{name:t.name,mountParcel:mountParcel.bind(t),singleSpa:singleSpa});return t.unmountThisParcel&&(e.unmountSelf=t.unmountThisParcel),e}var UserError=function(t){function e(){return _classCallCheck(this,e),_possibleConstructorReturn(this,_getPrototypeOf(e).apply(this,arguments))}return _inherits(e,_wrapNativeSuper(Error)),e}();function toLoadPromise(t){return Promise.resolve().then(function(){return t.status!==NOT_LOADED&&t.status!==LOAD_ERROR?t:(t.status=LOADING_SOURCE_CODE,Promise.resolve().then(function(){var n=t.loadImpl(getProps(t));if(!smellsLikeAPromise(n))throw new UserError("single-spa loading function did not return a promise. Check the second argument to registerApplication('".concat(t.name,"', loadingFunction, activityFunction)"));return n.then(function(n){var r;return t.loadErrorTime=null,"object"!==_typeof(e=n)&&(r="does not export anything"),validLifecycleFn(e.bootstrap)||(r="does not export a bootstrap function or array of functions"),validLifecycleFn(e.mount)||(r="does not export a mount function or array of functions"),validLifecycleFn(e.unmount)||(r="does not export an unmount function or array of functions"),r?(console.error("The loading function for single-spa application '".concat(t.name,"' resolved with the following, which does not have bootstrap, mount, and unmount functions"),e),handleAppError(r,t),t.status=SKIP_BECAUSE_BROKEN,t):(e.devtools&&e.devtools.overlays&&(t.devtools.overlays=_objectSpread2({},t.devtools.overlays,{},e.devtools.overlays)),t.status=NOT_BOOTSTRAPPED,t.bootstrap=flattenFnArray(e.bootstrap,"App '".concat(t.name,"' bootstrap function")),t.mount=flattenFnArray(e.mount,"App '".concat(t.name,"' mount function")),t.unmount=flattenFnArray(e.unmount,"App '".concat(t.name,"' unmount function")),t.unload=flattenFnArray(e.unload||[],"App '".concat(t.name,"' unload function")),t.timeouts=ensureValidAppTimeouts(e.timeouts),t)})}).catch(function(e){return handleAppError(e,t),e instanceof UserError?t.status=SKIP_BECAUSE_BROKEN:(t.status=LOAD_ERROR,t.loadErrorTime=(new Date).getTime()),t}));var e})}var capturedEventListeners={hashchange:[],popstate:[]},routingEventsListeningTo=["hashchange","popstate"];function navigateToUrl(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("string"==typeof t)e=t;else if(this&&this.href)e=this.href;else{if(!(t&&t.currentTarget&&t.currentTarget.href&&t.preventDefault))throw Error("singleSpaNavigate must be either called with a string url, with an <a> tag as its context, or with an event whose currentTarget is an <a> tag");e=t.currentTarget.href,t.preventDefault()}var r=parseUri(window.location.href),o=parseUri(e);if(0===e.indexOf("#"))window.location.hash="#"+o.anchor;else if(r.host!==o.host&&o.host){if(n.isTestingEnv)return{wouldHaveReloadedThePage:!0};window.location.href=e}else!function(t,e){return e===t||e==="/"+t}(o.path+"?"+o.query,r.path+"?"+r.query)?window.history.pushState(null,null,e):window.location.hash="#"+o.anchor}function callCapturedEventListeners(t){var e=this;if(t){var n=t[0].type;routingEventsListeningTo.indexOf(n)>=0&&capturedEventListeners[n].forEach(function(n){n.apply(e,t)})}}function urlReroute(){reroute([],arguments)}window.addEventListener("hashchange",urlReroute),window.addEventListener("popstate",urlReroute);var originalAddEventListener=window.addEventListener,originalRemoveEventListener=window.removeEventListener;window.addEventListener=function(t,e){if(!("function"==typeof e&&routingEventsListeningTo.indexOf(t)>=0)||find(capturedEventListeners[t],function(t){return t===e}))return originalAddEventListener.apply(this,arguments);capturedEventListeners[t].push(e)},window.removeEventListener=function(t,e){if(!("function"==typeof e&&routingEventsListeningTo.indexOf(t)>=0))return originalRemoveEventListener.apply(this,arguments);capturedEventListeners[t]=capturedEventListeners[t].filter(function(t){return t!==e})};var originalPushState=window.history.pushState;window.history.pushState=function(t){var e=originalPushState.apply(this,arguments);return urlReroute(createPopStateEvent(t)),e};var originalReplaceState=window.history.replaceState;function createPopStateEvent(t){try{return new PopStateEvent("popstate",{state:t})}catch(n){var e=document.createEvent("PopStateEvent");return e.initPopStateEvent("popstate",!1,!1,t),e}}function parseUri(t){for(var e={strictMode:!0,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}},n=e.parser.strict.exec(t),r={},o=14;o--;)r[e.key[o]]=n[o]||"";return r[e.q.name]={},r[e.key[12]].replace(e.q.parser,function(t,n,o){n&&(r[e.q.name][n]=o)}),r}window.history.replaceState=function(t){var e=originalReplaceState.apply(this,arguments);return urlReroute(createPopStateEvent(t)),e},window.singleSpaNavigate=navigateToUrl;var hasInitialized=!1;function ensureJQuerySupport(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.jQuery;if(t||window.$&&window.$.fn&&window.$.fn.jquery&&(t=window.$),t&&!hasInitialized){var e=t.fn.on,n=t.fn.off;t.fn.on=function(t,n){return captureRoutingEvents.call(this,e,window.addEventListener,t,n,arguments)},t.fn.off=function(t,e){return captureRoutingEvents.call(this,n,window.removeEventListener,t,e,arguments)},hasInitialized=!0}}function captureRoutingEvents(t,e,n,r,o){return"string"!=typeof n?t.apply(this,o):(n.split(/\s+/).forEach(function(t){routingEventsListeningTo.indexOf(t)>=0&&(e(t,r),n=n.replace(t,""))}),""===n.trim()?this:t.apply(this,o))}var appsToUnload={};function toUnloadPromise(t){return Promise.resolve().then(function(){var e=appsToUnload[t.name];return e?t.status===NOT_LOADED?(finishUnloadingApp(t,e),t):t.status===UNLOADING?e.promise.then(function(){return t}):t.status!==NOT_MOUNTED?t:(t.status=UNLOADING,reasonableTime(t.unload(getProps(t)),"Unloading application '".concat(t.name,"'"),t.timeouts.unload).then(function(){return finishUnloadingApp(t,e),t}).catch(function(n){return errorUnloadingApp(t,e,n),t})):t})}function finishUnloadingApp(t,e){delete appsToUnload[t.name],delete t.bootstrap,delete t.mount,delete t.unmount,delete t.unload,t.status=NOT_LOADED,e.resolve()}function errorUnloadingApp(t,e,n){delete appsToUnload[t.name],delete t.bootstrap,delete t.mount,delete t.unmount,delete t.unload,handleAppError(n,t),t.status=SKIP_BECAUSE_BROKEN,e.reject(n)}function addAppToUnload(t,e,n,r){appsToUnload[t.name]={app:t,resolve:n,reject:r},Object.defineProperty(appsToUnload[t.name],"promise",{get:e})}function getAppUnloadInfo(t){return appsToUnload[t]}function getAppsToUnload(){return Object.keys(appsToUnload).map(function(t){return appsToUnload[t].app}).filter(isntActive)}var apps=[];function getMountedApps(){return apps.filter(isActive).map(toName)}function getAppNames(){return apps.map(toName)}function getRawAppData(){return[].concat(apps)}function getAppStatus(t){var e=find(apps,function(e){return e.name===t});return e?e.status:null}function declareChildApplication(t,e,n){return console.warn('declareChildApplication is deprecated and will be removed in the next major version, use "registerApplication" instead'),registerApplication(t,e,n)}function registerApplication(t,e,n){var r,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if("string"!=typeof t||0===t.length)throw Error("The first argument must be a non-empty string 'appName'");if(-1!==getAppNames().indexOf(t))throw Error("There is already an app declared with name ".concat(t));if("object"!==_typeof(o)||Array.isArray(o))throw Error("customProps must be an object");if(!e)throw Error("The application or loading function is required");if(r="function"!=typeof e?function(){return Promise.resolve(e)}:e,"function"!=typeof n)throw Error("The activeWhen argument must be a function");apps.push({loadErrorTime:null,name:t,loadImpl:r,activeWhen:n,status:NOT_LOADED,parcels:{},devtools:{overlays:{options:{},selectors:[]}},customProps:o}),ensureJQuerySupport(),reroute()}function checkActivityFunctions(t){for(var e=[],n=0;n<apps.length;n++)apps[n].activeWhen(t)&&e.push(apps[n].name);return e}function getAppsToLoad(){return apps.filter(notSkipped).filter(withoutLoadErrors).filter(isntLoaded).filter(shouldBeActive)}function getAppsToUnmount(){return apps.filter(notSkipped).filter(isActive).filter(shouldntBeActive)}function getAppsToMount(){return apps.filter(notSkipped).filter(isntActive).filter(isLoaded).filter(shouldBeActive)}function unregisterApplication(t){if(!apps.find(function(e){return e.name===t}))throw Error("Cannot unregister application '".concat(t,"' because no such application has been registered"));return unloadApplication(t).then(function(){var e=apps.findIndex(function(e){return e.name===t});apps.splice(e,1)})}function unloadChildApplication(t,e){return console.warn('unloadChildApplication is deprecated and will be removed in the next major version, use "unloadApplication" instead'),unloadApplication(t,e)}function unloadApplication(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{waitForUnmount:!1};if("string"!=typeof t)throw Error("unloadApplication requires a string 'appName'");var n=find(apps,function(e){return e.name===t});if(!n)throw Error("Could not unload application '".concat(t,"' because no such application has been registered"));var r,o=getAppUnloadInfo(n.name);if(e&&e.waitForUnmount){if(o)return o.promise;var i=new Promise(function(t,e){addAppToUnload(n,function(){return i},t,e)});return i}return o?(r=o.promise,immediatelyUnloadApp(n,o.resolve,o.reject)):r=new Promise(function(t,e){addAppToUnload(n,function(){return r},t,e),immediatelyUnloadApp(n,t,e)}),r}function immediatelyUnloadApp(t,e,n){toUnmountPromise(t).then(toUnloadPromise).then(function(){e(),setTimeout(function(){reroute()})}).catch(n)}var appChangeUnderway=!1,peopleWaitingOnAppChange=[];function triggerAppChange(){return reroute()}function reroute(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1?arguments[1]:void 0;if(appChangeUnderway)return new Promise(function(t,n){peopleWaitingOnAppChange.push({resolve:t,reject:n,eventArguments:e})});appChangeUnderway=!0;var n=!0;return isStarted()?Promise.resolve().then(function(){window.dispatchEvent(new customEvent("single-spa:before-routing-event",i()));var e=getAppsToUnload().map(toUnloadPromise),a=getAppsToUnmount().map(toUnmountPromise).map(function(t){return t.then(toUnloadPromise)}),u=a.concat(e);u.length>0&&(n=!1);var s=Promise.all(u),c=getAppsToLoad(),p=c.map(function(t){return toLoadPromise(t).then(toBootstrapPromise).then(function(t){return s.then(function(){return toMountPromise(t)})})});p.length>0&&(n=!1);var l=getAppsToMount().filter(function(t){return c.indexOf(t)<0}).map(function(t){return toBootstrapPromise(t).then(function(){return s}).then(function(){return toMountPromise(t)})});return l.length>0&&(n=!1),s.catch(function(t){throw o(),t}).then(function(){return o(),Promise.all(p.concat(l)).catch(function(e){throw t.forEach(function(t){return t.reject(e)}),e}).then(function(){return r(!1)})})}):Promise.resolve().then(function(){var t=getAppsToLoad().map(toLoadPromise);return t.length>0&&(n=!1),Promise.all(t).then(r).catch(function(t){throw o(),t})});function r(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],r=getMountedApps();e&&o(),t.forEach(function(t){return t.resolve(r)});try{var a=n?"single-spa:no-app-change":"single-spa:app-change";window.dispatchEvent(new customEvent(a,i())),window.dispatchEvent(new customEvent("single-spa:routing-event",i()))}catch(t){setTimeout(function(){throw t})}if(appChangeUnderway=!1,peopleWaitingOnAppChange.length>0){var u=peopleWaitingOnAppChange;peopleWaitingOnAppChange=[],reroute(u)}return r}function o(){t.forEach(function(t){callCapturedEventListeners(t.eventArguments)}),callCapturedEventListeners(e)}function i(){var t={detail:{}};return e&&e[0]&&(t.detail.originalEvent=e[0]),t}}var started=!1;function start(){started=!0,reroute()}function isStarted(){return started}var startWarningDelay=5e3;setTimeout(function(){started||console.warn("singleSpa.start() has not been called, ".concat(startWarningDelay,"ms after single-spa was loaded. Before start() is called, apps can be declared and loaded, but not bootstrapped or mounted. See https://github.com/CanopyTax/single-spa/blob/master/docs/single-spa-api.md#start"))},startWarningDelay);var devtools={getRawAppData:getRawAppData,reroute:reroute,NOT_LOADED:NOT_LOADED,toLoadPromise:toLoadPromise,toBootstrapPromise:toBootstrapPromise,unregisterApplication:unregisterApplication};window&&window.__SINGLE_SPA_DEVTOOLS__&&(window.__SINGLE_SPA_DEVTOOLS__.exposedMethods=devtools);export{BOOTSTRAPPING,LOADING_SOURCE_CODE,LOAD_ERROR,MOUNTED,MOUNTING,NOT_BOOTSTRAPPED,NOT_LOADED,NOT_MOUNTED,SKIP_BECAUSE_BROKEN,UNMOUNTING,UPDATING,addErrorHandler,checkActivityFunctions,declareChildApplication,ensureJQuerySupport,getAppNames,getAppStatus,getMountedApps,mountRootParcel,navigateToUrl,registerApplication,removeErrorHandler,setBootstrapMaxTime,setMountMaxTime,setUnloadMaxTime,setUnmountMaxTime,start,triggerAppChange,unloadApplication,unloadChildApplication};