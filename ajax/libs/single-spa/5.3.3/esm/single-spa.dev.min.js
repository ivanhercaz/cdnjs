var singleSpa=Object.freeze({__proto__:null,get start(){return start},get ensureJQuerySupport(){return ensureJQuerySupport},get setBootstrapMaxTime(){return setBootstrapMaxTime},get setMountMaxTime(){return setMountMaxTime},get setUnmountMaxTime(){return setUnmountMaxTime},get setUnloadMaxTime(){return setUnloadMaxTime},get registerApplication(){return registerApplication},get getMountedApps(){return getMountedApps},get getAppStatus(){return getAppStatus},get unloadApplication(){return unloadApplication},get checkActivityFunctions(){return checkActivityFunctions},get getAppNames(){return getAppNames},get navigateToUrl(){return navigateToUrl},get triggerAppChange(){return triggerAppChange},get addErrorHandler(){return addErrorHandler},get removeErrorHandler(){return removeErrorHandler},get mountRootParcel(){return mountRootParcel},get NOT_LOADED(){return NOT_LOADED},get LOADING_SOURCE_CODE(){return LOADING_SOURCE_CODE},get NOT_BOOTSTRAPPED(){return NOT_BOOTSTRAPPED},get BOOTSTRAPPING(){return BOOTSTRAPPING},get NOT_MOUNTED(){return NOT_MOUNTED},get MOUNTING(){return MOUNTING},get UPDATING(){return UPDATING},get LOAD_ERROR(){return LOAD_ERROR},get MOUNTED(){return MOUNTED},get UNMOUNTING(){return UNMOUNTING},get SKIP_BECAUSE_BROKEN(){return SKIP_BECAUSE_BROKEN}});function _typeof(t){"@babel/helpers - typeof";return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _defineProperty(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toConsumableArray(t){return _arrayWithoutHoles(t)||_iterableToArray(t)||_unsupportedIterableToArray(t)||_nonIterableSpread()}function _arrayWithoutHoles(t){if(Array.isArray(t))return _arrayLikeToArray(t)}function _iterableToArray(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(r):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(t,e):void 0}}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var commonjsGlobal="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},NativeCustomEvent=commonjsGlobal.CustomEvent;function useNative(){try{var t=new NativeCustomEvent("cat",{detail:{foo:"bar"}});return"cat"===t.type&&"bar"===t.detail.foo}catch(t){}return!1}var customEvent=useNative()?NativeCustomEvent:"undefined"!=typeof document&&"function"==typeof document.createEvent?function(t,e){var r=document.createEvent("CustomEvent");return e?r.initCustomEvent(t,e.bubbles,e.cancelable,e.detail):r.initCustomEvent(t,!1,!1,void 0),r}:function(t,e){var r=document.createEventObject();return r.type=t,e?(r.bubbles=Boolean(e.bubbles),r.cancelable=Boolean(e.cancelable),r.detail=e.detail):(r.bubbles=!1,r.cancelable=!1,r.detail=void 0),r},errorHandlers=[];function handleAppError(t,e,r){var n=transformErr(t,e,r);errorHandlers.length?errorHandlers.forEach(function(t){return t(n)}):setTimeout(function(){throw n})}function addErrorHandler(t){if("function"!=typeof t)throw Error(formatErrorMessage(28,"a single-spa error handler must be a function"));errorHandlers.push(t)}function removeErrorHandler(t){if("function"!=typeof t)throw Error(formatErrorMessage(29,"a single-spa error handler must be a function"));var e=!1;return errorHandlers=errorHandlers.filter(function(r){var n=r===t;return e=e||n,!n}),e}function formatErrorMessage(t,e){for(var r=arguments.length,n=new Array(r>2?r-2:0),o=2;o<r;o++)n[o-2]=arguments[o];return"single-spa minified message #".concat(t,": ").concat(e?e+" ":"","See https://single-spa.js.org/error/?code=").concat(t).concat(n.length?"&arg=".concat(n.join("&arg=")):"")}function transformErr(t,e,r){var n,o="".concat(objectType(e)," '").concat(toName(e),"' died in status ").concat(e.status,": ");if(t instanceof Error){try{t.message=o+t.message}catch(t){}n=t}else{console.warn(formatErrorMessage(30,"While ".concat(e.status,", '").concat(toName(e),"' rejected its lifecycle function promise with a non-Error. This will cause stack traces to not be accurate."),e.status,toName(e)));try{n=Error(o+JSON.stringify(t))}catch(e){n=t}}return n.appOrParcelName=toName(e),e.status=r,n}var NOT_LOADED="NOT_LOADED",LOADING_SOURCE_CODE="LOADING_SOURCE_CODE",NOT_BOOTSTRAPPED="NOT_BOOTSTRAPPED",BOOTSTRAPPING="BOOTSTRAPPING",NOT_MOUNTED="NOT_MOUNTED",MOUNTING="MOUNTING",MOUNTED="MOUNTED",UPDATING="UPDATING",UNMOUNTING="UNMOUNTING",UNLOADING="UNLOADING",LOAD_ERROR="LOAD_ERROR",SKIP_BECAUSE_BROKEN="SKIP_BECAUSE_BROKEN";function isActive(t){return t.status===MOUNTED}function isntActive(t){return!isActive(t)}function isLoaded(t){return t.status!==NOT_LOADED&&t.status!==LOADING_SOURCE_CODE&&t.status!==LOAD_ERROR}function isntLoaded(t){return!isLoaded(t)}function shouldBeActive(t){try{return t.activeWhen(window.location)}catch(e){handleAppError(e,t,SKIP_BECAUSE_BROKEN)}}function shouldntBeActive(t){try{return!shouldBeActive(t)}catch(e){handleAppError(e,t,SKIP_BECAUSE_BROKEN)}}function notSkipped(t){return t!==SKIP_BECAUSE_BROKEN&&(!t||t.status!==SKIP_BECAUSE_BROKEN)}function withoutLoadErrors(t){return t.status!==LOAD_ERROR||(new Date).getTime()-t.loadErrorTime>=200}function toName(t){return t.name}function isParcel(t){return Boolean(t.unmountThisParcel)}function objectType(t){return isParcel(t)?"parcel":"application"}function assign(){for(var t=arguments.length-1;t>0;t--)for(var e in arguments[t])"__proto__"!==e&&(arguments[t-1][e]=arguments[t][e]);return arguments[0]}function find(t,e){for(var r=0;r<t.length;r++)if(e(t[r]))return t[r];return null}function validLifecycleFn(t){return t&&("function"==typeof t||(e=t,Array.isArray(e)&&!find(e,function(t){return"function"!=typeof t})));var e}function flattenFnArray(t,e){var r=t[e]||[];0===(r=Array.isArray(r)?r:[r]).length&&(r=[function(){return Promise.resolve()}]);var n=objectType(t),o=toName(t);return function(t){return r.reduce(function(r,a,i){return r.then(function(){var r=a(t);return smellsLikeAPromise(r)?r:Promise.reject(formatErrorMessage(15,"Within ".concat(n," ").concat(o,", the lifecycle function ").concat(e," at array index ").concat(i," did not return a promise"),n,o,e,i))})},Promise.resolve())}}function smellsLikeAPromise(t){return t&&"function"==typeof t.then&&"function"==typeof t.catch}function toBootstrapPromise(t,e){return Promise.resolve().then(function(){return t.status!==NOT_BOOTSTRAPPED?t:(t.status=BOOTSTRAPPING,reasonableTime(t,"bootstrap").then(function(){return t.status=NOT_MOUNTED,t}).catch(function(r){if(e)throw transformErr(r,t,SKIP_BECAUSE_BROKEN);return handleAppError(r,t,SKIP_BECAUSE_BROKEN),t}))})}function toUnmountPromise(t,e){return Promise.resolve().then(function(){if(t.status!==MOUNTED)return t;t.status=UNMOUNTING;var r=Object.keys(t.parcels).map(function(e){return t.parcels[e].unmountThisParcel()});return Promise.all(r).then(n,function(r){return n().then(function(){var n=Error(r.message);if(e)throw transformErr(n,t,SKIP_BECAUSE_BROKEN);handleAppError(n,t,SKIP_BECAUSE_BROKEN)})}).then(function(){return t});function n(){return reasonableTime(t,"unmount").then(function(){t.status=NOT_MOUNTED}).catch(function(r){if(e)throw transformErr(r,t,SKIP_BECAUSE_BROKEN);handleAppError(r,t,SKIP_BECAUSE_BROKEN)})}})}var beforeFirstMountFired=!1,firstMountFired=!1;function toMountPromise(t,e){return Promise.resolve().then(function(){return t.status!==NOT_MOUNTED?t:(beforeFirstMountFired||(window.dispatchEvent(new customEvent("single-spa:before-first-mount")),beforeFirstMountFired=!0),reasonableTime(t,"mount").then(function(){return t.status=MOUNTED,firstMountFired||(window.dispatchEvent(new customEvent("single-spa:first-mount")),firstMountFired=!0),t}).catch(function(r){return t.status=MOUNTED,toUnmountPromise(t,!0).then(n,n);function n(){if(e)throw transformErr(r,t,SKIP_BECAUSE_BROKEN);return handleAppError(r,t,SKIP_BECAUSE_BROKEN),t}}))})}function toUpdatePromise(t){return Promise.resolve().then(function(){if(t.status!==MOUNTED)throw Error(formatErrorMessage(32,"Cannot update parcel '".concat(toName(t),"' because it is not mounted"),toName(t)));return t.status=UPDATING,reasonableTime(t,"update").then(function(){return t.status=MOUNTED,t}).catch(function(e){throw transformErr(e,t,SKIP_BECAUSE_BROKEN)})})}var parcelCount=0,rootParcels={parcels:{}};function mountRootParcel(){return mountParcel.apply(rootParcels,arguments)}function mountParcel(t,e){var r=this;if(!t||"object"!==_typeof(t)&&"function"!=typeof t)throw Error(formatErrorMessage(2,"Cannot mount parcel without a config object or config loading function"));if(t.name&&"string"!=typeof t.name)throw Error(formatErrorMessage(3,"Parcel name must be a string, if provided. Was given ".concat(_typeof(t.name)),_typeof(t.name)));if("object"!==_typeof(e))throw Error(formatErrorMessage(4,"Parcel ".concat(name," has invalid customProps -- must be an object but was given ").concat(_typeof(e)),name,_typeof(e)));if(!e.domElement)throw Error(formatErrorMessage(5,"Parcel ".concat(name," cannot be mounted without a domElement provided as a prop"),name));var n,o=parcelCount++,a="function"==typeof t,i=a?t:function(){return Promise.resolve(t)},s={id:o,parcels:{},status:a?LOADING_SOURCE_CODE:NOT_BOOTSTRAPPED,customProps:e,parentName:toName(r),unmountThisParcel:function(){if(s.status!==MOUNTED)throw Error(formatErrorMessage(6,"Cannot unmount parcel '".concat(name,"' -- it is in a ").concat(s.status," status"),name,s.status));return toUnmountPromise(s,!0).then(function(t){return s.parentName&&delete r.parcels[s.id],t}).then(function(t){return c(t),t}).catch(function(t){throw s.status=SKIP_BECAUSE_BROKEN,l(t),t})}};r.parcels[o]=s;var u=i();if(!u||"function"!=typeof u.then)throw Error(formatErrorMessage(7,"When mounting a parcel, the config loading function must return a promise that resolves with the parcel config"));var c,l,p=(u=u.then(function(t){if(!t)throw Error(formatErrorMessage(8,"When mounting a parcel, the config loading function returned a promise that did not resolve with a parcel config"));var e=t.name||"parcel-".concat(o);if(!validLifecycleFn(t.bootstrap))throw Error(formatErrorMessage(9,"Parcel ".concat(e," must have a valid bootstrap function"),e));if(!validLifecycleFn(t.mount))throw Error(formatErrorMessage(10,"Parcel ".concat(e," must have a valid mount function"),e));if(!validLifecycleFn(t.unmount))throw Error(formatErrorMessage(11,"Parcel ".concat(e," must have a valid unmount function"),e));if(t.update&&!validLifecycleFn(t.update))throw Error(formatErrorMessage(12,"Parcel ".concat(e," provided an invalid update function"),e));var r=flattenFnArray(t,"bootstrap"),a=flattenFnArray(t,"mount"),i=flattenFnArray(t,"unmount");s.status=NOT_BOOTSTRAPPED,s.name=e,s.bootstrap=r,s.mount=a,s.unmount=i,s.timeouts=ensureValidAppTimeouts(t.timeouts),t.update&&(s.update=flattenFnArray(t,"update"),n.update=function(t){return s.customProps=t,promiseWithoutReturnValue(toUpdatePromise(s))})})).then(function(){return toBootstrapPromise(s,!0)}),f=p.then(function(){return toMountPromise(s,!0)}),m=new Promise(function(t,e){c=t,l=e});return n={mount:function(){return promiseWithoutReturnValue(Promise.resolve().then(function(){if(s.status!==NOT_MOUNTED)throw Error(formatErrorMessage(13,"Cannot mount parcel '".concat(name,"' -- it is in a ").concat(s.status," status"),name,s.status));return r.parcels[o]=s,toMountPromise(s)}))},unmount:function(){return promiseWithoutReturnValue(s.unmountThisParcel())},getStatus:function(){return s.status},loadPromise:promiseWithoutReturnValue(u),bootstrapPromise:promiseWithoutReturnValue(p),mountPromise:promiseWithoutReturnValue(f),unmountPromise:promiseWithoutReturnValue(m)}}function promiseWithoutReturnValue(t){return t.then(function(){return null})}function getProps(t){var e=assign({},t.customProps,{name:toName(t),mountParcel:mountParcel.bind(t),singleSpa:singleSpa});return isParcel(t)&&(e.unmountSelf=t.unmountThisParcel),e}var defaultWarningMillis=1e3,globalTimeoutConfig={bootstrap:{millis:4e3,dieOnTimeout:!1,warningMillis:defaultWarningMillis},mount:{millis:3e3,dieOnTimeout:!1,warningMillis:defaultWarningMillis},unmount:{millis:3e3,dieOnTimeout:!1,warningMillis:defaultWarningMillis},unload:{millis:3e3,dieOnTimeout:!1,warningMillis:defaultWarningMillis},update:{millis:3e3,dieOnTimeout:!1,warningMillis:defaultWarningMillis}};function setBootstrapMaxTime(t,e,r){if("number"!=typeof t||t<=0)throw Error(formatErrorMessage(16,"bootstrap max time must be a positive integer number of milliseconds"));globalTimeoutConfig.bootstrap={millis:t,dieOnTimeout:e,warningMillis:r||defaultWarningMillis}}function setMountMaxTime(t,e,r){if("number"!=typeof t||t<=0)throw Error(formatErrorMessage(17,"mount max time must be a positive integer number of milliseconds"));globalTimeoutConfig.mount={millis:t,dieOnTimeout:e,warningMillis:r||defaultWarningMillis}}function setUnmountMaxTime(t,e,r){if("number"!=typeof t||t<=0)throw Error(formatErrorMessage(18,"unmount max time must be a positive integer number of milliseconds"));globalTimeoutConfig.unmount={millis:t,dieOnTimeout:e,warningMillis:r||defaultWarningMillis}}function setUnloadMaxTime(t,e,r){if("number"!=typeof t||t<=0)throw Error(formatErrorMessage(19,"unload max time must be a positive integer number of milliseconds"));globalTimeoutConfig.unload={millis:t,dieOnTimeout:e,warningMillis:r||defaultWarningMillis}}function reasonableTime(t,e){var r=t.timeouts[e],n=r.warningMillis,o=objectType(t);return new Promise(function(a,i){var s=!1,u=!1;t[e](getProps(t)).then(function(t){s=!0,a(t)}).catch(function(t){s=!0,i(t)}),setTimeout(function(){return l(1)},n),setTimeout(function(){return l(!0)},r.millis);var c=formatErrorMessage(31,"Lifecycle function ".concat(e," for ").concat(o," ").concat(toName(t)," lifecycle did not resolve or reject for ").concat(r.millis," ms."),e,o,toName(t),r.millis);function l(t){if(!s)if(!0===t)u=!0,r.dieOnTimeout?i(Error(c)):console.error(c);else if(!u){var e=t,o=e*n;console.warn(c),o+n<r.millis&&setTimeout(function(){return l(e+1)},n)}}})}function ensureValidAppTimeouts(t){var e={};for(var r in globalTimeoutConfig)e[r]=assign({},globalTimeoutConfig[r],t&&t[r]||{});return e}function toLoadPromise(t){return Promise.resolve().then(function(){return t.loadPromise?t.loadPromise:t.status!==NOT_LOADED&&t.status!==LOAD_ERROR?t:(t.status=LOADING_SOURCE_CODE,t.loadPromise=Promise.resolve().then(function(){var n=t.loadApp(getProps(t));if(!smellsLikeAPromise(n))throw r=!0,Error(formatErrorMessage(33,"single-spa loading function did not return a promise. Check the second argument to registerApplication('".concat(toName(t),"', loadingFunction, activityFunction)"),toName(t)));return n.then(function(r){var n,o;t.loadErrorTime=null,"object"!==_typeof(e=r)&&(o=34,n="does not export anything"),validLifecycleFn(e.bootstrap)||(o=35,n="does not export a bootstrap function or array of functions"),validLifecycleFn(e.mount)||(o=36,n="does not export a bootstrap function or array of functions"),validLifecycleFn(e.unmount)||(o=37,n="does not export a bootstrap function or array of functions");var a=objectType(e);if(o){var i;try{i=JSON.stringify(e)}catch(t){}return console.error(formatErrorMessage(o,"The loading function for single-spa ".concat(a," '").concat(toName(t),"' resolved with the following, which does not have bootstrap, mount, and unmount functions"),a,toName(t),i),e),handleAppError(n,t,SKIP_BECAUSE_BROKEN),t}return e.devtools&&e.devtools.overlays&&(t.devtools.overlays=assign({},t.devtools.overlays,e.devtools.overlays)),t.status=NOT_BOOTSTRAPPED,t.bootstrap=flattenFnArray(e,"bootstrap"),t.mount=flattenFnArray(e,"mount"),t.unmount=flattenFnArray(e,"unmount"),t.unload=flattenFnArray(e,"unload"),t.timeouts=ensureValidAppTimeouts(e.timeouts),delete t.loadPromise,t})}).catch(function(e){var n;return delete t.loadPromise,r?n=SKIP_BECAUSE_BROKEN:(n=LOAD_ERROR,t.loadErrorTime=(new Date).getTime()),handleAppError(e,t,n),t}));var e,r})}var urlRerouteOnly,isInBrowser="undefined"!=typeof window,capturedEventListeners={hashchange:[],popstate:[]},routingEventsListeningTo=["hashchange","popstate"];function navigateToUrl(t){var e;if("string"==typeof t)e=t;else if(this&&this.href)e=this.href;else{if(!(t&&t.currentTarget&&t.currentTarget.href&&t.preventDefault))throw Error(formatErrorMessage(14,"singleSpaNavigate/navigateToUrl must be either called with a string url, with an <a> tag as its context, or with an event whose currentTarget is an <a> tag"));e=t.currentTarget.href,t.preventDefault()}var r=parseUri(window.location.href),n=parseUri(e);0===e.indexOf("#")?window.location.hash=n.hash:r.host!==n.host&&n.host?window.location.href=e:n.pathname===r.pathname&&n.search===r.pathname?window.location.hash=n.hash:window.history.pushState(null,null,e)}function callCapturedEventListeners(t){var e=this;if(t){var r=t[0].type;routingEventsListeningTo.indexOf(r)>=0&&capturedEventListeners[r].forEach(function(r){try{r.apply(e,t)}catch(t){setTimeout(function(){throw t})}})}}function setUrlRerouteOnly(t){urlRerouteOnly=t}function urlReroute(){reroute([],arguments)}if(isInBrowser){window.addEventListener("hashchange",urlReroute),window.addEventListener("popstate",urlReroute);var originalAddEventListener=window.addEventListener,originalRemoveEventListener=window.removeEventListener;function patchedUpdateState(t){return function(){var e=window.location.href,r=t.apply(this,arguments),n=window.location.href;return urlRerouteOnly&&e===n||urlReroute(createPopStateEvent(window.history.state)),r}}function createPopStateEvent(t){try{return new PopStateEvent("popstate",{state:t})}catch(r){var e=document.createEvent("PopStateEvent");return e.initPopStateEvent("popstate",!1,!1,t),e}}window.addEventListener=function(t,e){if(!("function"==typeof e&&routingEventsListeningTo.indexOf(t)>=0)||find(capturedEventListeners[t],function(t){return t===e}))return originalAddEventListener.apply(this,arguments);capturedEventListeners[t].push(e)},window.removeEventListener=function(t,e){if(!("function"==typeof e&&routingEventsListeningTo.indexOf(t)>=0))return originalRemoveEventListener.apply(this,arguments);capturedEventListeners[t]=capturedEventListeners[t].filter(function(t){return t!==e})},window.history.pushState=patchedUpdateState(window.history.pushState),window.history.replaceState=patchedUpdateState(window.history.replaceState),window.singleSpaNavigate=navigateToUrl}function parseUri(t){var e=document.createElement("a");return e.href=t,e}var hasInitialized=!1;function ensureJQuerySupport(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.jQuery;if(t||window.$&&window.$.fn&&window.$.fn.jquery&&(t=window.$),t&&!hasInitialized){var e=t.fn.on,r=t.fn.off;t.fn.on=function(t,r){return captureRoutingEvents.call(this,e,window.addEventListener,t,r,arguments)},t.fn.off=function(t,e){return captureRoutingEvents.call(this,r,window.removeEventListener,t,e,arguments)},hasInitialized=!0}}function captureRoutingEvents(t,e,r,n,o){return"string"!=typeof r?t.apply(this,o):(r.split(/\s+/).forEach(function(t){routingEventsListeningTo.indexOf(t)>=0&&(e(t,n),r=r.replace(t,""))}),""===r.trim()?this:t.apply(this,o))}var appsToUnload={};function toUnloadPromise(t){return Promise.resolve().then(function(){var e=appsToUnload[toName(t)];return e?t.status===NOT_LOADED?(finishUnloadingApp(t,e),t):t.status===UNLOADING?e.promise.then(function(){return t}):t.status!==NOT_MOUNTED?t:(t.status=UNLOADING,reasonableTime(t,"unload").then(function(){return finishUnloadingApp(t,e),t}).catch(function(r){return errorUnloadingApp(t,e,r),t})):t})}function finishUnloadingApp(t,e){delete appsToUnload[toName(t)],delete t.bootstrap,delete t.mount,delete t.unmount,delete t.unload,t.status=NOT_LOADED,e.resolve()}function errorUnloadingApp(t,e,r){delete appsToUnload[toName(t)],delete t.bootstrap,delete t.mount,delete t.unmount,delete t.unload,handleAppError(r,t,SKIP_BECAUSE_BROKEN),e.reject(r)}function addAppToUnload(t,e,r,n){appsToUnload[toName(t)]={app:t,resolve:r,reject:n},Object.defineProperty(appsToUnload[toName(t)],"promise",{get:e})}function getAppUnloadInfo(t){return appsToUnload[t]}function getAppsToUnload(){return Object.keys(appsToUnload).map(function(t){return appsToUnload[t].app}).filter(isntActive)}var apps=[];function getMountedApps(){return apps.filter(isActive).map(toName)}function getAppNames(){return apps.map(toName)}function getRawAppData(){return[].concat(apps)}function getAppStatus(t){var e=find(apps,function(e){return toName(e)===t});return e?e.status:null}function registerApplication(t,e,r,n){var o=sanitizeArguments(t,e,r,n);if(-1!==getAppNames().indexOf(o.name))throw Error(formatErrorMessage(21,"There is already an app registered with name ".concat(o.name),o.name));apps.push(assign({loadErrorTime:null,status:NOT_LOADED,parcels:{},devtools:{overlays:{options:{},selectors:[]}}},o)),isInBrowser&&(ensureJQuerySupport(),reroute())}function checkActivityFunctions(t){return apps.filter(function(e){return e.activeWhen(t)}).map(toName)}function getAppsToLoad(){return apps.filter(notSkipped).filter(withoutLoadErrors).filter(isntLoaded).filter(shouldBeActive)}function getAppsToUnmount(){return apps.filter(notSkipped).filter(isActive).filter(shouldntBeActive)}function getAppsToMount(){return apps.filter(notSkipped).filter(isntActive).filter(isLoaded).filter(shouldBeActive)}function unregisterApplication(t){if(!apps.find(function(e){return toName(e)===t}))throw Error(formatErrorMessage(25,"Cannot unregister application '".concat(t,"' because no such application has been registered"),t));return unloadApplication(t).then(function(){var e=apps.findIndex(function(e){return toName(e)===t});apps.splice(e,1)})}function unloadApplication(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{waitForUnmount:!1};if("string"!=typeof t)throw Error(formatErrorMessage(26,"unloadApplication requires a string 'appName'"));var r=find(apps,function(e){return toName(e)===t});if(!r)throw Error(formatErrorMessage(27,"Could not unload application '".concat(t,"' because no such application has been registered"),t));var n,o=getAppUnloadInfo(toName(r));if(e&&e.waitForUnmount){if(o)return o.promise;var a=new Promise(function(t,e){addAppToUnload(r,function(){return a},t,e)});return a}return o?(n=o.promise,immediatelyUnloadApp(r,o.resolve,o.reject)):n=new Promise(function(t,e){addAppToUnload(r,function(){return n},t,e),immediatelyUnloadApp(r,t,e)}),n}function immediatelyUnloadApp(t,e,r){toUnmountPromise(t).then(toUnloadPromise).then(function(){e(),setTimeout(function(){reroute()})}).catch(r)}function validateRegisterWithArguments(t,e,r,n){if("string"!=typeof t||0===t.length)throw Error(formatErrorMessage(20,"The 1st argument to registerApplication must be a non-empty string 'appName'"));if(!e)throw Error(formatErrorMessage(23,"The 2nd argument to registerApplication must be an application or loading application function"));if("function"!=typeof r)throw Error(formatErrorMessage(24,"The 3rd argument to registerApplication must be an activeWhen function"));if(n&&("object"!==_typeof(n)||Array.isArray(n)))throw Error(formatErrorMessage(22,"The optional 4th argument is a customProps and must be an object"))}function validateRegisterWithConfig(t){if(Array.isArray(t)||null===t)throw Error(formatErrorMessage(39,"Configuration object can't be an Array or null!"));var e=["name","app","activeWhen","customProps"],r=Object.keys(t).reduce(function(t,r){return e.includes(r)?t:t.concat(r)},[]);if(0!==r.length)throw Error(formatErrorMessage(38,"The configuration object accepts only: ".concat(e.join(", "),". Invalid keys: ").concat(r.join(", "),"."),e.join(", "),r.join(", ")));if("string"!=typeof t.name||0===t.name.length)throw Error(formatErrorMessage(20,"The config.name on registerApplication must be a non-empty string"));if("object"!==_typeof(t.app)&&"function"!=typeof t.app)throw Error(formatErrorMessage(20,"The config.app on registerApplication must be an application or a loading function"));var n=function(t){return"string"==typeof t||"function"==typeof t};if(!(n(t.activeWhen)||Array.isArray(t.activeWhen)&&t.activeWhen.every(n)))throw Error(formatErrorMessage(24,"The config.activeWhen on registerApplication must be a string, function or an array with both"));if(t.customProps&&("object"!==_typeof(t.customProps)||Array.isArray(t.customProps)))throw Error(formatErrorMessage(22,"The optional config.customProps must be an object"))}function sanitizeArguments(t,e,r,n){var o={name:null,loadApp:null,activeWhen:null,customProps:null};return"object"===_typeof(t)?(validateRegisterWithConfig(t),o.name=t.name,o.loadApp=t.app,o.activeWhen=t.activeWhen,o.customProps=t.customProps):(validateRegisterWithArguments(t,e,r,n),o.name=t,o.loadApp=e,o.activeWhen=r,o.customProps=n),o.loadApp=sanitizeLoadApp(o.loadApp),o.customProps=sanitizeCustomProps(o.customProps),o.activeWhen=sanitizeActiveWhen(o.activeWhen),o}function sanitizeLoadApp(t){return"function"!=typeof t?function(){return Promise.resolve(t)}:t}function sanitizeCustomProps(t){return t||{}}function sanitizeActiveWhen(t){var e=Array.isArray(t)?t:[t];return e=e.map(function(t){return"function"==typeof t?t:pathToActiveWhen(t)}),function(t){return e.some(function(e){return e(t)})}}function pathToActiveWhen(t){var e=toDynamicPathValidatorRegex(t);return function(t){var r=t.href.replace(t.origin,"");return e.test(r)}}function toDynamicPathValidatorRegex(t){for(var e=0,r=!1,n="^",o=0;o<t.length;o++){var a=t[o];(!r&&":"===a||r&&"/"===a)&&i(o)}return i(t.length),new RegExp(n,"i");function i(o){var a=t.slice(e,o).replace(/[|\\{}()[\]^$+*?.]/g,"\\$&");n+=r?"[^/]+/?":a,r=!r,e=o}}var appChangeUnderway=!1,peopleWaitingOnAppChange=[];function triggerAppChange(){return reroute()}function reroute(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1?arguments[1]:void 0;if(appChangeUnderway)return new Promise(function(t,r){peopleWaitingOnAppChange.push({resolve:t,reject:r,eventArguments:e})});var r=[];return isStarted()?(appChangeUnderway=!0,Promise.resolve().then(function(){window.dispatchEvent(new customEvent("single-spa:before-routing-event",i()));var e=n(getAppsToUnload()).map(toUnloadPromise),s=n(getAppsToUnmount()).map(toUnmountPromise).map(function(t){return t.then(toUnloadPromise)}),u=s.concat(e),c=Promise.all(u),l=n(getAppsToLoad()),p=l.map(function(t){return toLoadPromise(t).then(toBootstrapPromise).then(function(t){return c.then(function(){return toMountPromise(t)})})}),f=getAppsToMount().filter(function(t){return l.indexOf(t)<0}).map(function(t){return r.push(t),toBootstrapPromise(t).then(function(){return c}).then(function(){return toMountPromise(t)})});return c.catch(function(t){throw a(),t}).then(function(){return a(),Promise.all(p.concat(f)).catch(function(e){throw t.forEach(function(t){return t.reject(e)}),e}).then(o)})})):Promise.resolve().then(function(){var t=n(getAppsToLoad()).map(toLoadPromise);return Promise.all(t).then(a).then(function(){return[]}).catch(function(t){throw a(),t})});function n(t){return r.push.apply(r,_toConsumableArray(t)),t}function o(){var e=getMountedApps();t.forEach(function(t){return t.resolve(e)});try{var n=0===r.length?"single-spa:no-app-change":"single-spa:app-change";window.dispatchEvent(new customEvent(n,i())),window.dispatchEvent(new customEvent("single-spa:routing-event",i()))}catch(t){setTimeout(function(){throw t})}if(appChangeUnderway=!1,peopleWaitingOnAppChange.length>0){var o=peopleWaitingOnAppChange;peopleWaitingOnAppChange=[],reroute(o)}return e}function a(){t.forEach(function(t){callCapturedEventListeners(t.eventArguments)}),callCapturedEventListeners(e)}function i(){var t,n={},o=(_defineProperty(t={},MOUNTED,[]),_defineProperty(t,NOT_MOUNTED,[]),_defineProperty(t,NOT_LOADED,[]),_defineProperty(t,SKIP_BECAUSE_BROKEN,[]),t);return r.forEach(function(t){var e=toName(t),r=getAppStatus(e);n[e]=r,(o[r]=o[r]||[]).push(e)}),{detail:{newAppStatuses:n,appsByNewStatus:o,totalAppChanges:r.length,originalEvent:null==e?void 0:e[0]}}}}var started=!1;function start(t){started=!0,t&&t.urlRerouteOnly&&setUrlRerouteOnly(t.urlRerouteOnly),isInBrowser&&reroute()}function isStarted(){return started}isInBrowser&&setTimeout(function(){started||console.warn(formatErrorMessage(1,"singleSpa.start() has not been called, 5000ms after single-spa was loaded. Before start() is called, apps can be declared and loaded, but not bootstrapped or mounted."))},5e3);var devtools={getRawAppData:getRawAppData,reroute:reroute,NOT_LOADED:NOT_LOADED,toLoadPromise:toLoadPromise,toBootstrapPromise:toBootstrapPromise,unregisterApplication:unregisterApplication};isInBrowser&&window.__SINGLE_SPA_DEVTOOLS__&&(window.__SINGLE_SPA_DEVTOOLS__.exposedMethods=devtools);export{BOOTSTRAPPING,LOADING_SOURCE_CODE,LOAD_ERROR,MOUNTED,MOUNTING,NOT_BOOTSTRAPPED,NOT_LOADED,NOT_MOUNTED,SKIP_BECAUSE_BROKEN,UNMOUNTING,UPDATING,addErrorHandler,checkActivityFunctions,ensureJQuerySupport,getAppNames,getAppStatus,getMountedApps,mountRootParcel,navigateToUrl,registerApplication,removeErrorHandler,setBootstrapMaxTime,setMountMaxTime,setUnloadMaxTime,setUnmountMaxTime,start,triggerAppChange,unloadApplication};