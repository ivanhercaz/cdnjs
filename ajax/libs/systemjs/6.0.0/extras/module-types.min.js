import{systemJSPrototype}from"../system-core";const instantiate=systemJSPrototype.instantiate;systemJSPrototype.instantiate=function(t,e){const n=this;switch(t.slice(t.lastIndexOf("."))){case".css":return o(function(t,e){const n=new CSSStyleSheet;n.replaceSync(e),t("default",n)});case".html":return r().then(function(t){return s(t)||u("'.html' modules not implemented")});case".json":return o(function(t,e){t("default",JSON.parse(e))});case".wasm":return r().then(function(t){return s(t)||(WebAssembly.compileStreaming?WebAssembly.compileStreaming(t):t.arrayBuffer().then(WebAssembly.compile))}).then(function(t){const e=[],n=[],r={};return WebAssembly.Module.imports&&WebAssembly.Module.imports(t).forEach(function(t){const s=t.module;-1===e.indexOf(s)&&(e.push(s),n.push(function(t){r[s]=t}))}),[e,function(e){return{setters:n,execute:function(){return WebAssembly.instantiate(t,r).then(function(t){e(t.exports)})}}}]})}return instantiate.apply(this,arguments);function r(){return fetch(t).then(function(t){return t.ok||u(t.status+" "+t.statusText),t})}function s(t){const e=t.headers.get("content-type");if(e&&e.match(/^application\/javascript(;|$)/))return t.text().then(function(t){return(0,eval)(t),n.getRegister()})}function o(t){return r().then(function(e){return s(e)||e.text().then(function(e){return[[],function(n){return{execute:t(n,e)}}]})})}function u(n){throw Error(n+", loading "+t+(e?" from "+e:""))}};