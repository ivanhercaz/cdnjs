"use strict";var _interopRequireWildcard=require("@babel/runtime/helpers/interopRequireWildcard"),_interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:!0}),exports.setTranslateValue=setTranslateValue,exports.default=void 0;var _extends2=_interopRequireDefault(require("@babel/runtime/helpers/extends")),_objectWithoutProperties2=_interopRequireDefault(require("@babel/runtime/helpers/objectWithoutProperties")),React=_interopRequireWildcard(require("react")),_propTypes=_interopRequireDefault(require("prop-types")),ReactDOM=_interopRequireWildcard(require("react-dom")),_debounce=_interopRequireDefault(require("../utils/debounce")),_reactTransitionGroup=require("react-transition-group"),_utils=require("@material-ui/utils"),_useForkRef=_interopRequireDefault(require("../utils/useForkRef")),_useTheme=_interopRequireDefault(require("../styles/useTheme")),_transitions=require("../styles/transitions"),_utils2=require("../transitions/utils");function getTranslateValue(e,t){var r,n,i,a=t.getBoundingClientRect(),s=0,o=0;return(n=t.fakeTransform?t.fakeTransform:(r=window.getComputedStyle(t)).getPropertyValue("-webkit-transform")||r.getPropertyValue("transform"))&&"none"!==n&&"string"==typeof n&&(i=n.split("(")[1].split(")")[0].split(","),s=parseInt(i[4],10),o=parseInt(i[5],10)),"left"===e?"translateX(".concat(window.innerWidth,"px) translateX(-").concat(a.left-s,"px)"):"right"===e?"translateX(-".concat(a.left+a.width-s,"px)"):"up"===e?"translateY(".concat(window.innerHeight,"px) translateY(-").concat(a.top-o,"px)"):"translateY(-".concat(a.top+a.height-o,"px)")}function setTranslateValue(e,t){var r=getTranslateValue(e,t);r&&(t.style.webkitTransform=r,t.style.transform=r)}var defaultTimeout={enter:_transitions.duration.enteringScreen,exit:_transitions.duration.leavingScreen},Slide=React.forwardRef(function(e,t){var r=e.children,n=e.direction,i=void 0===n?"down":n,a=e.in,s=e.onEnter,o=e.onEntering,u=e.onExit,l=e.onExited,p=e.style,d=e.timeout,f=void 0===d?defaultTimeout:d,c=e.TransitionComponent,_=void 0===c?_reactTransitionGroup.Transition:c,T=(0,_objectWithoutProperties2.default)(e,["children","direction","in","onEnter","onEntering","onExit","onExited","style","timeout","TransitionComponent"]),m=(0,_useTheme.default)(),y=React.useRef(null),x=React.useCallback(function(e){y.current=ReactDOM.findDOMNode(e)},[]),b=(0,_useForkRef.default)(r.ref,x),g=(0,_useForkRef.default)(b,t),R=React.useCallback(function(){y.current&&setTranslateValue(i,y.current)},[i]);return React.useEffect(function(){if(!a&&"down"!==i&&"right"!==i){var e=(0,_debounce.default)(function(){y.current&&setTranslateValue(i,y.current)});return window.addEventListener("resize",e),function(){e.clear(),window.removeEventListener("resize",e)}}},[i,a]),React.useEffect(function(){a||R()},[a,R]),React.createElement(_,(0,_extends2.default)({onEnter:function(e,t){var r=y.current;setTranslateValue(i,r),(0,_utils2.reflow)(r),s&&s(r,t)},onEntering:function(e,t){var r=y.current,n=(0,_utils2.getTransitionProps)({timeout:f,style:p},{mode:"enter"});r.style.webkitTransition=m.transitions.create("-webkit-transform",(0,_extends2.default)((0,_extends2.default)({},n),{},{easing:m.transitions.easing.easeOut})),r.style.transition=m.transitions.create("transform",(0,_extends2.default)((0,_extends2.default)({},n),{},{easing:m.transitions.easing.easeOut})),r.style.webkitTransform="none",r.style.transform="none",o&&o(r,t)},onExit:function(){var e=y.current,t=(0,_utils2.getTransitionProps)({timeout:f,style:p},{mode:"exit"});e.style.webkitTransition=m.transitions.create("-webkit-transform",(0,_extends2.default)((0,_extends2.default)({},t),{},{easing:m.transitions.easing.sharp})),e.style.transition=m.transitions.create("transform",(0,_extends2.default)((0,_extends2.default)({},t),{},{easing:m.transitions.easing.sharp})),setTranslateValue(i,e),u&&u(e)},onExited:function(){var e=y.current;e.style.webkitTransition="",e.style.transition="",l&&l(e)},appear:!0,in:a,timeout:f},T),function(e,t){return React.cloneElement(r,(0,_extends2.default)({ref:g,style:(0,_extends2.default)((0,_extends2.default)({visibility:"exited"!==e||a?void 0:"hidden"},p),r.props.style)},t))})});"production"!==process.env.NODE_ENV&&(Slide.propTypes={children:_utils.elementAcceptingRef,direction:_propTypes.default.oneOf(["down","left","right","up"]),in:_propTypes.default.bool,onEnter:_propTypes.default.func,onEntering:_propTypes.default.func,onExit:_propTypes.default.func,onExited:_propTypes.default.func,style:_propTypes.default.object,timeout:_propTypes.default.oneOfType([_propTypes.default.number,_propTypes.default.shape({appear:_propTypes.default.number,enter:_propTypes.default.number,exit:_propTypes.default.number})])});var _default=Slide;exports.default=Slide;