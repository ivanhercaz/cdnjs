import*as React from"react";import*as ReactDOM from"react-dom";import PropTypes from"prop-types";import ownerDocument from"../utils/ownerDocument";import useForkRef from"../utils/useForkRef";function TrapFocus(e){const{children:t,disableAutoFocus:r=!1,disableEnforceFocus:n=!1,disableRestoreFocus:o=!1,getDoc:c,isEnabled:s,open:u}=e,a=React.useRef(),i=React.useRef(null),l=React.useRef(null),f=React.useRef(),d=React.useRef(null),p=React.useCallback(e=>{d.current=ReactDOM.findDOMNode(e)},[]),R=useForkRef(t.ref,p),m=React.useRef();return React.useEffect(()=>{m.current=u},[u]),!m.current&&u&&"undefined"!=typeof window&&(f.current=c().activeElement),React.useEffect(()=>{if(!u)return;const e=ownerDocument(d.current);r||!d.current||d.current.contains(e.activeElement)||(d.current.hasAttribute("tabIndex")||("production"!==process.env.NODE_ENV&&console.error(["Material-UI: The modal content node does not accept focus.",'For the benefit of assistive technologies, the tabIndex of the node is being set to "-1".'].join("\n")),d.current.setAttribute("tabIndex",-1)),d.current.focus());const t=()=>{e.hasFocus()&&!n&&s()&&!a.current?d.current&&!d.current.contains(e.activeElement)&&d.current.focus():a.current=!1},c=t=>{!n&&s()&&9===t.keyCode&&e.activeElement===d.current&&(a.current=!0,t.shiftKey?l.current.focus():i.current.focus())};e.addEventListener("focus",t,!0),e.addEventListener("keydown",c,!0);const p=setInterval(()=>{t()},50);return()=>{clearInterval(p),e.removeEventListener("focus",t,!0),e.removeEventListener("keydown",c,!0),o||(f.current&&f.current.focus&&f.current.focus(),f.current=null)}},[r,n,o,s,u]),React.createElement(React.Fragment,null,React.createElement("div",{tabIndex:0,ref:i,"data-test":"sentinelStart"}),React.cloneElement(t,{ref:R}),React.createElement("div",{tabIndex:0,ref:l,"data-test":"sentinelEnd"}))}"production"!==process.env.NODE_ENV&&(TrapFocus.propTypes={children:PropTypes.element.isRequired,disableAutoFocus:PropTypes.bool,disableEnforceFocus:PropTypes.bool,disableRestoreFocus:PropTypes.bool,getDoc:PropTypes.func.isRequired,isEnabled:PropTypes.func.isRequired,open:PropTypes.bool.isRequired});export default TrapFocus;