"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:!0}),exports.setTranslateValue=setTranslateValue,exports.default=void 0;var _extends2=_interopRequireDefault(require("@babel/runtime/helpers/extends")),_objectWithoutProperties2=_interopRequireDefault(require("@babel/runtime/helpers/objectWithoutProperties")),_react=_interopRequireDefault(require("react")),_propTypes=_interopRequireDefault(require("prop-types")),_reactDom=_interopRequireDefault(require("react-dom")),_debounce=_interopRequireDefault(require("../utils/debounce")),_reactTransitionGroup=require("react-transition-group"),_utils=require("@material-ui/utils"),_useForkRef=_interopRequireDefault(require("../utils/useForkRef")),_useTheme=_interopRequireDefault(require("../styles/useTheme")),_transitions=require("../styles/transitions"),_utils2=require("../transitions/utils");function getTranslateValue(e,t){var r,n=t.getBoundingClientRect();if(t.fakeTransform)r=t.fakeTransform;else{var i=window.getComputedStyle(t);r=i.getPropertyValue("-webkit-transform")||i.getPropertyValue("transform")}var a=0,s=0;if(r&&"none"!==r&&"string"==typeof r){var o=r.split("(")[1].split(")")[0].split(",");a=parseInt(o[4],10),s=parseInt(o[5],10)}return"left"===e?"translateX(".concat(window.innerWidth,"px) translateX(-").concat(n.left-a,"px)"):"right"===e?"translateX(-".concat(n.left+n.width-a,"px)"):"up"===e?"translateY(".concat(window.innerHeight,"px) translateY(-").concat(n.top-s,"px)"):"translateY(-".concat(n.top+n.height-s,"px)")}function setTranslateValue(e,t){var r=getTranslateValue(e,t);r&&(t.style.webkitTransform=r,t.style.transform=r)}var defaultTimeout={enter:_transitions.duration.enteringScreen,exit:_transitions.duration.leavingScreen},Slide=_react.default.forwardRef(function(e,t){var r=e.children,n=e.direction,i=void 0===n?"down":n,a=e.in,s=e.onEnter,o=e.onEntering,u=e.onExit,l=e.onExited,f=e.style,p=e.timeout,d=void 0===p?defaultTimeout:p,c=(0,_objectWithoutProperties2.default)(e,["children","direction","in","onEnter","onEntering","onExit","onExited","style","timeout"]),_=(0,_useTheme.default)(),y=_react.default.useRef(null),T=_react.default.useCallback(function(e){y.current=_reactDom.default.findDOMNode(e)},[]),m=(0,_useForkRef.default)(r.ref,T),g=(0,_useForkRef.default)(m,t),x=_react.default.useCallback(function(){y.current&&setTranslateValue(i,y.current)},[i]);return _react.default.useEffect(function(){if(!a&&"down"!==i&&"right"!==i){var e=(0,_debounce.default)(function(){y.current&&setTranslateValue(i,y.current)});return window.addEventListener("resize",e),function(){e.clear(),window.removeEventListener("resize",e)}}},[i,a]),_react.default.useEffect(function(){a||x()},[a,x]),_react.default.createElement(_reactTransitionGroup.Transition,(0,_extends2.default)({onEnter:function(e,t){var r=y.current;setTranslateValue(i,r),(0,_utils2.reflow)(r),s&&s(r,t)},onEntering:function(e,t){var r=y.current,n=(0,_utils2.getTransitionProps)({timeout:d,style:f},{mode:"enter"});r.style.webkitTransition=_.transitions.create("-webkit-transform",(0,_extends2.default)({},n,{easing:_.transitions.easing.easeOut})),r.style.transition=_.transitions.create("transform",(0,_extends2.default)({},n,{easing:_.transitions.easing.easeOut})),r.style.webkitTransform="none",r.style.transform="none",o&&o(r,t)},onExit:function(){var e=y.current,t=(0,_utils2.getTransitionProps)({timeout:d,style:f},{mode:"exit"});e.style.webkitTransition=_.transitions.create("-webkit-transform",(0,_extends2.default)({},t,{easing:_.transitions.easing.sharp})),e.style.transition=_.transitions.create("transform",(0,_extends2.default)({},t,{easing:_.transitions.easing.sharp})),setTranslateValue(i,e),u&&u(e)},onExited:function(){var e=y.current;e.style.webkitTransition="",e.style.transition="",l&&l(e)},appear:!0,in:a,timeout:d},c),function(e,t){return _react.default.cloneElement(r,(0,_extends2.default)({ref:g,style:(0,_extends2.default)({visibility:"exited"!==e||a?void 0:"hidden"},f,{},r.props.style)},t))})});"production"!==process.env.NODE_ENV&&(Slide.propTypes={children:_utils.elementAcceptingRef,direction:_propTypes.default.oneOf(["left","right","up","down"]),in:_propTypes.default.bool,onEnter:_propTypes.default.func,onEntering:_propTypes.default.func,onExit:_propTypes.default.func,onExited:_propTypes.default.func,style:_propTypes.default.object,timeout:_propTypes.default.oneOfType([_propTypes.default.number,_propTypes.default.shape({enter:_propTypes.default.number,exit:_propTypes.default.number})])});var _default=Slide;exports.default=_default;