"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _react=_interopRequireDefault(require("react")),_reactDom=_interopRequireDefault(require("react-dom")),_propTypes=_interopRequireDefault(require("prop-types")),_ownerDocument=_interopRequireDefault(require("../utils/ownerDocument")),_useForkRef=_interopRequireDefault(require("../utils/useForkRef")),_setRef=_interopRequireDefault(require("../utils/setRef")),_useEventCallback=_interopRequireDefault(require("../utils/useEventCallback")),_utils=require("@material-ui/utils");function mapEventPropToEvent(e){return e.substring(2).toLowerCase()}var ClickAwayListener=_react.default.forwardRef(function(e,t){var r=e.children,u=e.mouseEvent,n=void 0===u?"onClick":u,o=e.touchEvent,a=void 0===o?"onTouchEnd":o,i=e.onClickAway,c=_react.default.useRef(!1),l=_react.default.useRef(null),f=_react.default.useRef(!1);_react.default.useEffect(function(){return f.current=!0,function(){f.current=!1}},[]);var s=(0,_useForkRef.default)(l,t),d=_react.default.useCallback(function(e){(0,_setRef.default)(s,_reactDom.default.findDOMNode(e))},[s]),p=(0,_useForkRef.default)(r.ref,d),_=(0,_useEventCallback.default)(function(e){if(f.current)if(c.current)c.current=!1;else if(l.current){var t=(0,_ownerDocument.default)(l.current);t.documentElement&&t.documentElement.contains(e.target)&&!l.current.contains(e.target)&&i(e)}}),v=_react.default.useCallback(function(){c.current=!0},[]);return _react.default.useEffect(function(){if(!1!==a){var e=mapEventPropToEvent(a),t=(0,_ownerDocument.default)(l.current);return t.addEventListener(e,_),t.addEventListener("touchmove",v),function(){t.removeEventListener(e,_),t.removeEventListener("touchmove",v)}}},[_,v,a]),_react.default.useEffect(function(){if(!1!==n){var e=mapEventPropToEvent(n),t=(0,_ownerDocument.default)(l.current);return t.addEventListener(e,_),function(){t.removeEventListener(e,_)}}},[_,n]),_react.default.createElement(_react.default.Fragment,null,_react.default.cloneElement(r,{ref:p}))});"production"!==process.env.NODE_ENV&&(ClickAwayListener.propTypes={children:_utils.elementAcceptingRef.isRequired,mouseEvent:_propTypes.default.oneOf(["onClick","onMouseDown","onMouseUp",!1]),onClickAway:_propTypes.default.func.isRequired,touchEvent:_propTypes.default.oneOf(["onTouchStart","onTouchEnd",!1])}),"production"!==process.env.NODE_ENV&&(ClickAwayListener.propTypes=(0,_utils.exactProp)(ClickAwayListener.propTypes));var _default=ClickAwayListener;exports.default=_default;