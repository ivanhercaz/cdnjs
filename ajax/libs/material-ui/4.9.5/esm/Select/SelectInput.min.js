import _extends from"@babel/runtime/helpers/esm/extends";import _toConsumableArray from"@babel/runtime/helpers/esm/toConsumableArray";import _slicedToArray from"@babel/runtime/helpers/esm/slicedToArray";import _objectWithoutProperties from"@babel/runtime/helpers/esm/objectWithoutProperties";import _typeof from"@babel/runtime/helpers/esm/typeof";import*as React from"react";import{isFragment}from"react-is";import PropTypes from"prop-types";import clsx from"clsx";import capitalize from"../utils/capitalize";import{refType}from"@material-ui/utils";import Menu from"../Menu/Menu";import{isFilled}from"../InputBase/utils";import useForkRef from"../utils/useForkRef";import useControlled from"../utils/useControlled";function areEqualValues(e,o){return"object"===_typeof(o)&&null!==o?e===o:String(e)===String(o)}function isEmpty(e){return null==e||"string"==typeof e&&!e.trim()}var SelectInput=React.forwardRef(function(e,o){var r=e.autoFocus,t=e.autoWidth,n=e.children,a=e.classes,l=e.className,s=e.defaultValue,p=e.disabled,i=e.displayEmpty,u=e.IconComponent,c=e.inputRef,d=e.labelId,m=e.MenuProps,f=void 0===m?{}:m,y=e.multiple,v=e.name,b=e.onBlur,P=e.onChange,h=e.onClose,T=e.onFocus,R=e.onOpen,E=e.open,x=e.readOnly,g=e.renderValue,C=(e.required,e.SelectDisplayProps),I=void 0===C?{}:C,_=e.tabIndex,F=(e.type,e.value),O=e.variant,A=void 0===O?"standard":O,M=_objectWithoutProperties(e,["autoFocus","autoWidth","children","classes","className","defaultValue","disabled","displayEmpty","IconComponent","inputRef","labelId","MenuProps","multiple","name","onBlur","onChange","onClose","onFocus","onOpen","open","readOnly","renderValue","required","SelectDisplayProps","tabIndex","type","value","variant"]),S=useControlled({controlled:F,default:s,name:"SelectInput"}),j=_slicedToArray(S,2),w=j[0],V=j[1],D=React.useRef(null),N=React.useState(null),W=N[0],q=N[1],k=React.useRef(null!=E).current,U=React.useState(),B=U[0],L=U[1],z=React.useState(!1),K=z[0],H=z[1],G=useForkRef(o,c);React.useImperativeHandle(G,function(){return{focus:function(){W.focus()},node:D.current,value:w}},[W,w]),React.useEffect(function(){r&&W&&W.focus()},[r,W]);var J,Q,X=function(e,o){e?R&&R(o):h&&h(o),k||(L(t?null:W.clientWidth),H(e))},Y=null!==W&&(k?E:K);delete M["aria-invalid"];var Z=[],$=!1,ee=!1;(isFilled({value:w})||i)&&(g?J=g(w):$=!0);var oe=React.Children.map(n,function(e){if(!React.isValidElement(e))return null;var o;if("production"!==process.env.NODE_ENV&&isFragment(e)&&console.error(["Material-UI: the Select component doesn't accept a Fragment as a child.","Consider providing an array instead."].join("\n")),y){if(!Array.isArray(w))throw new Error("Material-UI: the `value` prop must be an array when using the `Select` component with `multiple`.");(o=w.some(function(o){return areEqualValues(o,e.props.value)}))&&$&&Z.push(e.props.children)}else(o=areEqualValues(w,e.props.value))&&$&&(Q=e.props.children);return o&&(ee=!0),React.cloneElement(e,{"aria-selected":o?"true":void 0,onClick:function(e){return function(o){var r;if(y||X(!1,o),y){r=Array.isArray(w)?_toConsumableArray(w):[];var t=w.indexOf(e.props.value);-1===t?r.push(e.props.value):r.splice(t,1)}else r=e.props.value;V(r),P&&(o.persist(),Object.defineProperty(o,"target",{writable:!0,value:{value:r,name:v}}),P(o,e))}}(e),onKeyUp:function(o){" "===o.key&&o.preventDefault();var r=e.props.onKeyUp;"function"==typeof r&&r(o)},role:"option",selected:o,value:void 0,"data-value":e.props.value})});"production"!==process.env.NODE_ENV&&React.useEffect(function(){if(!ee&&!y&&""!==w){var e=React.Children.toArray(n).map(function(e){return e.props.value});console.warn(["Material-UI: you have provided an out-of-range value `".concat(w,"` for the select ").concat(v?'(name="'.concat(v,'") '):"","component."),"Consider providing a value that matches one of the available options or ''.","The available values are ".concat(e.filter(function(e){return null!=e}).map(function(e){return"`".concat(e,"`")}).join(", ")||'""',".")].join("\n"))}},[ee,n,y,v,w]),$&&(J=y?Z.join(", "):Q);var re,te=B;!t&&k&&W&&(te=W.clientWidth),re=void 0!==_?_:p?null:0;var ne=I.id||(v?"mui-component-select-".concat(v):void 0);return React.createElement(React.Fragment,null,React.createElement("div",_extends({className:clsx(a.root,a.select,a.selectMenu,a[A],l,p&&a.disabled),ref:q,tabIndex:re,role:"button","aria-expanded":Y?"true":void 0,"aria-labelledby":"".concat(d||""," ").concat(ne||""),"aria-haspopup":"listbox",onKeyDown:function(e){x||-1!==[" ","ArrowUp","ArrowDown","Enter"].indexOf(e.key)&&(e.preventDefault(),X(!0,e))},onMouseDown:p||x?null:function(e){0===e.button&&(e.preventDefault(),W.focus(),X(!0,e))},onBlur:function(e){!Y&&b&&(e.persist(),Object.defineProperty(e,"target",{writable:!0,value:{value:w,name:v}}),b(e))},onFocus:T},I,{id:ne}),isEmpty(J)?React.createElement("span",{dangerouslySetInnerHTML:{__html:"&#8203;"}}):J),React.createElement("input",_extends({value:Array.isArray(w)?w.join(","):w,name:v,ref:D,type:"hidden",autoFocus:r},M)),React.createElement(u,{className:clsx(a.icon,a["icon".concat(capitalize(A))],Y&&a.iconOpen)}),React.createElement(Menu,_extends({id:"menu-".concat(v||""),anchorEl:W,open:Y,onClose:function(e){X(!1,e)}},f,{MenuListProps:_extends({"aria-labelledby":d,role:"listbox",disableListWrap:!0},f.MenuListProps),PaperProps:_extends({},f.PaperProps,{style:_extends({minWidth:te},null!=f.PaperProps?f.PaperProps.style:null)})}),oe))});"production"!==process.env.NODE_ENV&&(SelectInput.propTypes={autoFocus:PropTypes.bool,autoWidth:PropTypes.bool,children:PropTypes.node,classes:PropTypes.object.isRequired,className:PropTypes.string,defaultValue:PropTypes.any,disabled:PropTypes.bool,displayEmpty:PropTypes.bool,IconComponent:PropTypes.elementType.isRequired,inputRef:refType,labelId:PropTypes.string,MenuProps:PropTypes.object,multiple:PropTypes.bool,name:PropTypes.string,onBlur:PropTypes.func,onChange:PropTypes.func,onClose:PropTypes.func,onFocus:PropTypes.func,onOpen:PropTypes.func,open:PropTypes.bool,readOnly:PropTypes.bool,renderValue:PropTypes.func,required:PropTypes.bool,SelectDisplayProps:PropTypes.object,tabIndex:PropTypes.oneOfType([PropTypes.number,PropTypes.string]),type:PropTypes.any,value:PropTypes.any,variant:PropTypes.oneOf(["standard","outlined","filled"])});export default SelectInput;