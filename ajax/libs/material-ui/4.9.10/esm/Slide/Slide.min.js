import _extends from"@babel/runtime/helpers/esm/extends";import _objectWithoutProperties from"@babel/runtime/helpers/esm/objectWithoutProperties";import*as React from"react";import PropTypes from"prop-types";import*as ReactDOM from"react-dom";import debounce from"../utils/debounce";import{Transition}from"react-transition-group";import{elementAcceptingRef}from"@material-ui/utils";import useForkRef from"../utils/useForkRef";import useTheme from"../styles/useTheme";import{duration}from"../styles/transitions";import{reflow,getTransitionProps}from"../transitions/utils";function getTranslateValue(e,t){var n,r=t.getBoundingClientRect();if(t.fakeTransform)n=t.fakeTransform;else{var o=window.getComputedStyle(t);n=o.getPropertyValue("-webkit-transform")||o.getPropertyValue("transform")}var i=0,s=0;if(n&&"none"!==n&&"string"==typeof n){var a=n.split("(")[1].split(")")[0].split(",");i=parseInt(a[4],10),s=parseInt(a[5],10)}return"left"===e?"translateX(".concat(window.innerWidth,"px) translateX(-").concat(r.left-i,"px)"):"right"===e?"translateX(-".concat(r.left+r.width-i,"px)"):"up"===e?"translateY(".concat(window.innerHeight,"px) translateY(-").concat(r.top-s,"px)"):"translateY(-".concat(r.top+r.height-s,"px)")}export function setTranslateValue(e,t){var n=getTranslateValue(e,t);n&&(t.style.webkitTransform=n,t.style.transform=n)};var defaultTimeout={enter:duration.enteringScreen,exit:duration.leavingScreen},Slide=React.forwardRef(function(e,t){var n=e.children,r=e.direction,o=void 0===r?"down":r,i=e.in,s=e.onEnter,a=e.onEntering,u=e.onExit,p=e.onExited,c=e.style,l=e.timeout,f=void 0===l?defaultTimeout:l,m=_objectWithoutProperties(e,["children","direction","in","onEnter","onEntering","onExit","onExited","style","timeout"]),d=useTheme(),y=React.useRef(null),T=React.useCallback(function(e){y.current=ReactDOM.findDOMNode(e)},[]),g=useForkRef(n.ref,T),x=useForkRef(g,t),b=React.useCallback(function(){y.current&&setTranslateValue(o,y.current)},[o]);return React.useEffect(function(){if(!i&&"down"!==o&&"right"!==o){var e=debounce(function(){y.current&&setTranslateValue(o,y.current)});return window.addEventListener("resize",e),function(){e.clear(),window.removeEventListener("resize",e)}}},[o,i]),React.useEffect(function(){i||b()},[i,b]),React.createElement(Transition,_extends({onEnter:function(e,t){var n=y.current;setTranslateValue(o,n),reflow(n),s&&s(n,t)},onEntering:function(e,t){var n=y.current,r=getTransitionProps({timeout:f,style:c},{mode:"enter"});n.style.webkitTransition=d.transitions.create("-webkit-transform",_extends({},r,{easing:d.transitions.easing.easeOut})),n.style.transition=d.transitions.create("transform",_extends({},r,{easing:d.transitions.easing.easeOut})),n.style.webkitTransform="none",n.style.transform="none",a&&a(n,t)},onExit:function(){var e=y.current,t=getTransitionProps({timeout:f,style:c},{mode:"exit"});e.style.webkitTransition=d.transitions.create("-webkit-transform",_extends({},t,{easing:d.transitions.easing.sharp})),e.style.transition=d.transitions.create("transform",_extends({},t,{easing:d.transitions.easing.sharp})),setTranslateValue(o,e),u&&u(e)},onExited:function(){var e=y.current;e.style.webkitTransition="",e.style.transition="",p&&p(e)},appear:!0,in:i,timeout:f},m),function(e,t){return React.cloneElement(n,_extends({ref:x,style:_extends({visibility:"exited"!==e||i?void 0:"hidden"},c,{},n.props.style)},t))})});"production"!==process.env.NODE_ENV&&(Slide.propTypes={children:elementAcceptingRef,direction:PropTypes.oneOf(["down","left","right","up"]),in:PropTypes.bool,onEnter:PropTypes.func,onEntering:PropTypes.func,onExit:PropTypes.func,onExited:PropTypes.func,style:PropTypes.object,timeout:PropTypes.oneOfType([PropTypes.number,PropTypes.shape({appear:PropTypes.number,enter:PropTypes.number,exit:PropTypes.number})])});export default Slide;