"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault"),_interopRequireWildcard=require("@babel/runtime/helpers/interopRequireWildcard");Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var React=_interopRequireWildcard(require("react")),ReactDOM=_interopRequireWildcard(require("react-dom")),_propTypes=_interopRequireDefault(require("prop-types")),_ownerDocument=_interopRequireDefault(require("../utils/ownerDocument")),_useForkRef=_interopRequireDefault(require("../utils/useForkRef")),_useEventCallback=_interopRequireDefault(require("../utils/useEventCallback")),_utils=require("@material-ui/utils");function mapEventPropToEvent(e){return e.substring(2).toLowerCase()}function ClickAwayListener(e){var n=e.children,t=e.disableReactTree,u=void 0!==t&&t,r=e.mouseEvent,o=void 0===r?"onClick":r,i=e.onClickAway,c=e.touchEvent,a=void 0===c?"onTouchEnd":c,l=React.useRef(!1),s=React.useRef(null),p=React.useRef(!1),f=React.useRef(!1);React.useEffect(function(){return p.current=!0,function(){p.current=!1}},[]);function d(r){return function(e){f.current=!0;var t=n.props[r];t&&t(e)}}var v=React.useCallback(function(e){s.current=ReactDOM.findDOMNode(e)},[]),R=(0,_useForkRef.default)(n.ref,v),E=(0,_useEventCallback.default)(function(e){var t=f.current;if(f.current=!1,p.current&&s.current)if(l.current)l.current=!1;else{var r;if(e.composedPath)r=-1<e.composedPath().indexOf(s.current);else{var n=(0,_ownerDocument.default)(s.current);r=!(n.documentElement&&n.documentElement.contains(e.target))||s.current.contains(e.target)}r||!u&&t||i(e)}}),_={ref:R};return!1!==a&&(_[a]=d(a)),React.useEffect(function(){if(!1!==a){var e=mapEventPropToEvent(a),t=(0,_ownerDocument.default)(s.current),r=function(){l.current=!0};return t.addEventListener(e,E),t.addEventListener("touchmove",r),function(){t.removeEventListener(e,E),t.removeEventListener("touchmove",r)}}},[E,a]),!1!==o&&(_[o]=d(o)),React.useEffect(function(){if(!1!==o){var e=mapEventPropToEvent(o),t=(0,_ownerDocument.default)(s.current);return t.addEventListener(e,E),function(){t.removeEventListener(e,E)}}},[E,o]),React.createElement(React.Fragment,null,React.cloneElement(n,_))}"production"!==process.env.NODE_ENV&&(ClickAwayListener.propTypes={children:_utils.elementAcceptingRef.isRequired,disableReactTree:_propTypes.default.bool,mouseEvent:_propTypes.default.oneOf(["onClick","onMouseDown","onMouseUp",!1]),onClickAway:_propTypes.default.func.isRequired,touchEvent:_propTypes.default.oneOf(["onTouchEnd","onTouchStart",!1])}),"production"!==process.env.NODE_ENV&&(ClickAwayListener.propTypes=(0,_utils.exactProp)(ClickAwayListener.propTypes));var _default=ClickAwayListener;exports.default=_default;