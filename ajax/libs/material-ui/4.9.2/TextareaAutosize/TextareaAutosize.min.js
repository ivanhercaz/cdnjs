"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _extends2=_interopRequireDefault(require("@babel/runtime/helpers/extends")),_objectWithoutProperties2=_interopRequireDefault(require("@babel/runtime/helpers/objectWithoutProperties")),_react=_interopRequireDefault(require("react")),_propTypes=_interopRequireDefault(require("prop-types")),_debounce=_interopRequireDefault(require("../utils/debounce")),_useForkRef=_interopRequireDefault(require("../utils/useForkRef"));function getStyleValue(e,t){return parseInt(e[t],10)||0}var useEnhancedEffect="undefined"!=typeof window?_react.default.useLayoutEffect:_react.default.useEffect,styles={shadow:{visibility:"hidden",position:"absolute",overflow:"hidden",height:0,top:0,left:0,transform:"translateZ(0)"}},TextareaAutosize=_react.default.forwardRef(function(f,e){var t=f.onChange,r=f.rows,p=f.rowsMax,a=f.rowsMin,u=void 0===a?1:a,o=f.style,l=f.value,n=(0,_objectWithoutProperties2.default)(f,["onChange","rows","rowsMax","rowsMin","style","value"]),c=r||u,s=_react.default.useRef(null!=l).current,_=_react.default.useRef(null),i=(0,_useForkRef.default)(e,_),y=_react.default.useRef(null),d=_react.default.useState({}),h=d[0],b=d[1],v=_react.default.useCallback(function(){var e=_.current,t=window.getComputedStyle(e),r=y.current;r.style.width=t.width,r.value=e.value||f.placeholder||"x";var a=t["box-sizing"],u=getStyleValue(t,"padding-bottom")+getStyleValue(t,"padding-top"),o=getStyleValue(t,"border-bottom-width")+getStyleValue(t,"border-top-width"),l=r.scrollHeight-u;r.value="x";var n=r.scrollHeight-u,s=l;c&&(s=Math.max(Number(c)*n,s)),p&&(s=Math.min(Number(p)*n,s));var i=(s=Math.max(s,n))+("border-box"===a?u+o:0),d=Math.abs(s-l)<=1;b(function(e){return 0<i&&1<Math.abs((e.outerHeightStyle||0)-i)||e.overflow!==d?{overflow:d,outerHeightStyle:i}:e})},[p,c,f.placeholder]);_react.default.useEffect(function(){var e=(0,_debounce.default)(function(){v()});return window.addEventListener("resize",e),function(){e.clear(),window.removeEventListener("resize",e)}},[v]),useEnhancedEffect(function(){v()});return _react.default.createElement(_react.default.Fragment,null,_react.default.createElement("textarea",(0,_extends2.default)({value:l,onChange:function(e){s||v(),t&&t(e)},ref:i,rows:c,style:(0,_extends2.default)({height:h.outerHeightStyle,overflow:h.overflow?"hidden":null},o)},n)),_react.default.createElement("textarea",{"aria-hidden":!0,className:f.className,readOnly:!0,ref:y,tabIndex:-1,style:(0,_extends2.default)({},styles.shadow,{},o)}))});"production"!==process.env.NODE_ENV&&(TextareaAutosize.propTypes={className:_propTypes.default.string,onChange:_propTypes.default.func,placeholder:_propTypes.default.string,rows:_propTypes.default.oneOfType([_propTypes.default.string,_propTypes.default.number]),rowsMax:_propTypes.default.oneOfType([_propTypes.default.string,_propTypes.default.number]),rowsMin:_propTypes.default.oneOfType([_propTypes.default.string,_propTypes.default.number]),style:_propTypes.default.object,value:_propTypes.default.any});var _default=TextareaAutosize;exports.default=_default;