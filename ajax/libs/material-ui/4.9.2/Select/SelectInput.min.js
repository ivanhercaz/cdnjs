"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _extends2=_interopRequireDefault(require("@babel/runtime/helpers/extends")),_toConsumableArray2=_interopRequireDefault(require("@babel/runtime/helpers/toConsumableArray")),_slicedToArray2=_interopRequireDefault(require("@babel/runtime/helpers/slicedToArray")),_objectWithoutProperties2=_interopRequireDefault(require("@babel/runtime/helpers/objectWithoutProperties")),_typeof2=_interopRequireDefault(require("@babel/runtime/helpers/typeof")),_react=_interopRequireDefault(require("react")),_reactIs=require("react-is"),_propTypes=_interopRequireDefault(require("prop-types")),_clsx=_interopRequireDefault(require("clsx")),_capitalize=_interopRequireDefault(require("../utils/capitalize")),_utils=require("@material-ui/utils"),_Menu=_interopRequireDefault(require("../Menu/Menu")),_utils2=require("../InputBase/utils"),_useForkRef=_interopRequireDefault(require("../utils/useForkRef")),_useControlled3=_interopRequireDefault(require("../utils/useControlled"));function areEqualValues(e,t){return"object"===(0,_typeof2.default)(t)&&null!==t?e===t:String(e)===String(t)}function isEmpty(e){return null==e||"string"==typeof e&&!e.trim()}var SelectInput=_react.default.forwardRef(function(e,t){var r=e.autoFocus,a=e.autoWidth,l=e.children,u=e.classes,n=e.className,o=e.defaultValue,p=e.disabled,i=e.displayEmpty,s=e.IconComponent,d=e.inputRef,c=e.labelId,f=e.MenuProps,_=void 0===f?{}:f,y=e.multiple,v=e.name,m=e.onBlur,b=e.onChange,h=e.onClose,T=e.onFocus,q=e.onOpen,E=e.open,D=e.readOnly,R=e.renderValue,x=(e.required,e.SelectDisplayProps),I=void 0===x?{}:x,P=e.tabIndex,C=(e.type,e.value),g=e.variant,O=void 0===g?"standard":g,M=(0,_objectWithoutProperties2.default)(e,["autoFocus","autoWidth","children","classes","className","defaultValue","disabled","displayEmpty","IconComponent","inputRef","labelId","MenuProps","multiple","name","onBlur","onChange","onClose","onFocus","onOpen","open","readOnly","renderValue","required","SelectDisplayProps","tabIndex","type","value","variant"]),j=(0,_useControlled3.default)({controlled:C,default:o,name:"SelectInput"}),A=(0,_slicedToArray2.default)(j,2),F=A[0],S=A[1],w=_react.default.useRef(null),V=_react.default.useState(null),N=V[0],W=V[1],k=_react.default.useRef(null!=E).current,U=_react.default.useState(),B=U[0],L=U[1],z=_react.default.useState(!1),K=z[0],H=z[1],G=(0,_useForkRef.default)(t,d);_react.default.useImperativeHandle(G,function(){return{focus:function(){N.focus()},node:w.current,value:F}},[N,F]),_react.default.useEffect(function(){r&&N&&N.focus()},[r,N]);function J(e,t){e?q&&q(t):h&&h(t),k||(L(a?null:N.clientWidth),H(e))}var Q,X,Y=null!==N&&(k?E:K);delete M["aria-invalid"];var Z=[],$=!1,ee=!1;((0,_utils2.isFilled)({value:F})||i)&&(R?Q=R(F):$=!0);var te=_react.default.Children.map(l,function(r){if(!_react.default.isValidElement(r))return null;var e,a;if("production"!==process.env.NODE_ENV&&(0,_reactIs.isFragment)(r)&&console.error(["Material-UI: the Select component doesn't accept a Fragment as a child.","Consider providing an array instead."].join("\n")),y){if(!Array.isArray(F))throw new Error("Material-UI: the `value` prop must be an array when using the `Select` component with `multiple`.");(e=F.some(function(e){return areEqualValues(e,r.props.value)}))&&$&&Z.push(r.props.children)}else(e=areEqualValues(F,r.props.value))&&$&&(X=r.props.children);return e&&(ee=!0),_react.default.cloneElement(r,{"aria-selected":e?"true":void 0,onClick:function(e){var t;if(y||J(!1,e),y){t=Array.isArray(F)?(0,_toConsumableArray2.default)(F):[];var r=F.indexOf(a.props.value);-1===r?t.push(a.props.value):t.splice(r,1)}else t=a.props.value;S(t),b&&(e.persist(),Object.defineProperty(e,"target",{writable:!0,value:{value:t,name:v}}),b(e,a))},onKeyUp:function(e){" "===e.key&&e.preventDefault();var t=r.props.onKeyUp;"function"==typeof t&&t(e)},role:"option",selected:e,value:void 0,"data-value":(a=r).props.value})});"production"!==process.env.NODE_ENV&&_react.default.useEffect(function(){if(!ee&&!y&&""!==F){var e=_react.default.Children.toArray(l).map(function(e){return e.props.value});console.warn(["Material-UI: you have provided an out-of-range value `".concat(F,"` for the select ").concat(v?'(name="'.concat(v,'") '):"","component."),"Consider providing a value that matches one of the available options or ''.","The available values are ".concat(e.filter(function(e){return null!=e}).map(function(e){return"`".concat(e,"`")}).join(", ")||'""',".")].join("\n"))}},[ee,l,y,v,F]),$&&(Q=y?Z.join(", "):X);var re,ae=B;!a&&k&&N&&(ae=N.clientWidth),re=void 0!==P?P:p?null:0;var le=I.id||(v?"mui-component-select-".concat(v):void 0);return _react.default.createElement(_react.default.Fragment,null,_react.default.createElement("div",(0,_extends2.default)({className:(0,_clsx.default)(u.root,u.select,u.selectMenu,u[O],n,p&&u.disabled),ref:W,tabIndex:re,role:"button","aria-expanded":Y?"true":void 0,"aria-labelledby":"".concat(c||""," ").concat(le||""),"aria-haspopup":"listbox",onKeyDown:function(e){if(!D){-1!==[" ","ArrowUp","ArrowDown","Enter"].indexOf(e.key)&&(e.preventDefault(),J(!0,e))}},onMouseDown:p||D?null:function(e){0===e.button&&(e.preventDefault(),N.focus(),J(!0,e))},onBlur:function(e){!Y&&m&&(e.persist(),Object.defineProperty(e,"target",{writable:!0,value:{value:F,name:v}}),m(e))},onFocus:T},I,{id:le}),isEmpty(Q)?_react.default.createElement("span",{dangerouslySetInnerHTML:{__html:"&#8203;"}}):Q),_react.default.createElement("input",(0,_extends2.default)({value:Array.isArray(F)?F.join(","):F,name:v,ref:w,type:"hidden",autoFocus:r},M)),_react.default.createElement(s,{className:(0,_clsx.default)(u.icon,u["icon".concat((0,_capitalize.default)(O))],Y&&u.iconOpen)}),_react.default.createElement(_Menu.default,(0,_extends2.default)({id:"menu-".concat(v||""),anchorEl:N,open:Y,onClose:function(e){J(!1,e)}},_,{MenuListProps:(0,_extends2.default)({"aria-labelledby":c,role:"listbox",disableListWrap:!0},_.MenuListProps),PaperProps:(0,_extends2.default)({},_.PaperProps,{style:(0,_extends2.default)({minWidth:ae},null!=_.PaperProps?_.PaperProps.style:null)})}),te))});"production"!==process.env.NODE_ENV&&(SelectInput.propTypes={autoFocus:_propTypes.default.bool,autoWidth:_propTypes.default.bool,children:_propTypes.default.node,classes:_propTypes.default.object.isRequired,className:_propTypes.default.string,defaultValue:_propTypes.default.any,disabled:_propTypes.default.bool,displayEmpty:_propTypes.default.bool,IconComponent:_propTypes.default.elementType.isRequired,inputRef:_utils.refType,labelId:_propTypes.default.string,MenuProps:_propTypes.default.object,multiple:_propTypes.default.bool,name:_propTypes.default.string,onBlur:_propTypes.default.func,onChange:_propTypes.default.func,onClose:_propTypes.default.func,onFocus:_propTypes.default.func,onOpen:_propTypes.default.func,open:_propTypes.default.bool,readOnly:_propTypes.default.bool,renderValue:_propTypes.default.func,required:_propTypes.default.bool,SelectDisplayProps:_propTypes.default.object,tabIndex:_propTypes.default.oneOfType([_propTypes.default.number,_propTypes.default.string]),type:_propTypes.default.any,value:_propTypes.default.any,variant:_propTypes.default.oneOf(["standard","outlined","filled"])});var _default=SelectInput;exports.default=_default;