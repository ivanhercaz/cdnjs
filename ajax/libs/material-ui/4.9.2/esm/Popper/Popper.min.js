import _extends from"@babel/runtime/helpers/esm/extends";import _objectWithoutProperties from"@babel/runtime/helpers/esm/objectWithoutProperties";import React from"react";import PropTypes from"prop-types";import PopperJS from"popper.js";import{chainPropTypes,refType}from"@material-ui/utils";import{useTheme}from"@material-ui/styles";import Portal from"../Portal";import createChainedFunction from"../utils/createChainedFunction";import setRef from"../utils/setRef";import useForkRef from"../utils/useForkRef";import ownerWindow from"../utils/ownerWindow";function flipPlacement(e,t){if("ltr"===(t&&t.direction||"ltr"))return e;switch(e){case"bottom-end":return"bottom-start";case"bottom-start":return"bottom-end";case"top-end":return"top-start";case"top-start":return"top-end";default:return e}}function getAnchorEl(e){return"function"==typeof e?e():e}var useEnhancedEffect="undefined"!=typeof window?React.useLayoutEffect:React.useEffect,defaultPopperOptions={},Popper=React.forwardRef(function(e,t){var o=e.anchorEl,n=e.children,r=e.container,i=e.disablePortal,p=void 0!==i&&i,c=e.keepMounted,a=void 0!==c&&c,s=e.modifiers,u=e.open,l=e.placement,f=void 0===l?"bottom":l,d=e.popperOptions,m=void 0===d?defaultPopperOptions:d,h=e.popperRef,y=e.transition,b=void 0!==y&&y,E=_objectWithoutProperties(e,["anchorEl","children","container","disablePortal","keepMounted","modifiers","open","placement","popperOptions","popperRef","transition"]),P=React.useRef(null),R=useForkRef(P,t),T=React.useRef(null),v=useForkRef(T,h),w=React.useRef(v);useEnhancedEffect(function(){w.current=v},[v]),React.useImperativeHandle(h,function(){return T.current},[]);var g=React.useState(!0),O=g[0],j=g[1],k=flipPlacement(f,useTheme()),C=React.useState(k),_=C[0],x=C[1];React.useEffect(function(){T.current&&T.current.update()});var M=React.useCallback(function(){if(P.current&&o&&u){T.current&&(T.current.destroy(),w.current(null));var e=function(e){x(e.placement)},t=getAnchorEl(o);if("production"!==process.env.NODE_ENV)if(t instanceof ownerWindow(t).Element){var n=t.getBoundingClientRect();"test"!==process.env.NODE_ENV&&0===n.top&&0===n.left&&0===n.right&&0===n.bottom&&console.warn(["Material-UI: the `anchorEl` prop provided to the component is invalid.","The anchor element should be part of the document layout.","Make sure the element is present in the document or that it's not display none."].join("\n"))}var r=new PopperJS(getAnchorEl(o),P.current,_extends({placement:k},m,{modifiers:_extends({},p?{}:{preventOverflow:{boundariesElement:"window"}},{},s,{},m.modifiers),onCreate:createChainedFunction(e,m.onCreate),onUpdate:createChainedFunction(e,m.onUpdate)}));w.current(r)}},[o,p,s,u,k,m]),F=React.useCallback(function(e){setRef(R,e),M()},[R,M]),N=function(){T.current&&(T.current.destroy(),w.current(null))};if(React.useEffect(function(){M()},[M]),React.useEffect(function(){return function(){N()}},[]),React.useEffect(function(){u||b||N()},[u,b]),!a&&!u&&(!b||O))return null;var W={placement:_};return b&&(W.TransitionProps={in:u,onEnter:function(){j(!1)},onExited:function(){j(!0),N()}}),React.createElement(Portal,{disablePortal:p,container:r},React.createElement("div",_extends({ref:F,role:"tooltip"},E,{style:_extends({position:"fixed",top:0,left:0},E.style)}),"function"==typeof n?n(W):n))});"production"!==process.env.NODE_ENV&&(Popper.propTypes={anchorEl:chainPropTypes(PropTypes.oneOfType([PropTypes.object,PropTypes.func]),function(e){if(e.open){var t=getAnchorEl(e.anchorEl);if(t instanceof ownerWindow(t).Element){var o=t.getBoundingClientRect();if("test"!==process.env.NODE_ENV&&0===o.top&&0===o.left&&0===o.right&&0===o.bottom)return new Error(["Material-UI: the `anchorEl` prop provided to the component is invalid.","The anchor element should be part of the document layout.","Make sure the element is present in the document or that it's not display none."].join("\n"))}else if(!t||"number"!=typeof t.clientWidth||"number"!=typeof t.clientHeight||"function"!=typeof t.getBoundingClientRect)return new Error(["Material-UI: the `anchorEl` prop provided to the component is invalid.","It should be an HTML Element instance or a referenceObject:","https://popper.js.org/popper-documentation.html#referenceObject."].join("\n"))}return null}),children:PropTypes.oneOfType([PropTypes.node,PropTypes.func]).isRequired,container:PropTypes.oneOfType([PropTypes.object,PropTypes.func]),disablePortal:PropTypes.bool,keepMounted:PropTypes.bool,modifiers:PropTypes.object,open:PropTypes.bool.isRequired,placement:PropTypes.oneOf(["bottom-end","bottom-start","bottom","left-end","left-start","left","right-end","right-start","right","top-end","top-start","top"]),popperOptions:PropTypes.object,popperRef:refType,transition:PropTypes.bool});export default Popper;