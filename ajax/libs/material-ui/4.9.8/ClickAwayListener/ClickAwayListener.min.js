"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault"),_interopRequireWildcard=require("@babel/runtime/helpers/interopRequireWildcard");Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var React=_interopRequireWildcard(require("react")),ReactDOM=_interopRequireWildcard(require("react-dom")),_propTypes=_interopRequireDefault(require("prop-types")),_ownerDocument=_interopRequireDefault(require("../utils/ownerDocument")),_useForkRef=_interopRequireDefault(require("../utils/useForkRef")),_setRef=_interopRequireDefault(require("../utils/setRef")),_useEventCallback=_interopRequireDefault(require("../utils/useEventCallback")),_utils=require("@material-ui/utils");function mapEventPropToEvent(e){return e.substring(2).toLowerCase()}var ClickAwayListener=React.forwardRef(function(e,t){var r=e.children,n=e.mouseEvent,u=void 0===n?"onClick":n,o=e.touchEvent,i=void 0===o?"onTouchEnd":o,c=e.onClickAway,a=React.useRef(!1),l=React.useRef(null),s=React.useRef(!1);React.useEffect(function(){return s.current=!0,function(){s.current=!1}},[]);var f=(0,_useForkRef.default)(l,t),p=React.useCallback(function(e){(0,_setRef.default)(f,ReactDOM.findDOMNode(e))},[f]),d=(0,_useForkRef.default)(r.ref,p),R=(0,_useEventCallback.default)(function(e){if(s.current)if(a.current)a.current=!1;else if(l.current){var t=(0,_ownerDocument.default)(l.current);t.documentElement&&t.documentElement.contains(e.target)&&!l.current.contains(e.target)&&c(e)}}),v=React.useCallback(function(){a.current=!0},[]);return React.useEffect(function(){if(!1!==i){var e=mapEventPropToEvent(i),t=(0,_ownerDocument.default)(l.current);return t.addEventListener(e,R),t.addEventListener("touchmove",v),function(){t.removeEventListener(e,R),t.removeEventListener("touchmove",v)}}},[R,v,i]),React.useEffect(function(){if(!1!==u){var e=mapEventPropToEvent(u),t=(0,_ownerDocument.default)(l.current);return t.addEventListener(e,R),function(){t.removeEventListener(e,R)}}},[R,u]),React.createElement(React.Fragment,null,React.cloneElement(r,{ref:d}))});"production"!==process.env.NODE_ENV&&(ClickAwayListener.propTypes={children:_utils.elementAcceptingRef.isRequired,mouseEvent:_propTypes.default.oneOf(["onClick","onMouseDown","onMouseUp",!1]),onClickAway:_propTypes.default.func.isRequired,touchEvent:_propTypes.default.oneOf(["onTouchStart","onTouchEnd",!1])}),"production"!==process.env.NODE_ENV&&(ClickAwayListener.propTypes=(0,_utils.exactProp)(ClickAwayListener.propTypes));var _default=ClickAwayListener;exports.default=_default;