"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _react=_interopRequireDefault(require("react")),_reactDom=_interopRequireDefault(require("react-dom")),_propTypes=_interopRequireDefault(require("prop-types")),_ownerDocument=_interopRequireDefault(require("../utils/ownerDocument")),_useForkRef=_interopRequireDefault(require("../utils/useForkRef"));function TrapFocus(e){var t=e.children,r=e.disableAutoFocus,n=void 0!==r&&r,u=e.disableEnforceFocus,o=void 0!==u&&u,a=e.disableRestoreFocus,c=void 0!==a&&a,s=e.getDoc,i=e.isEnabled,l=e.open,f=_react.default.useRef(),d=_react.default.useRef(null),p=_react.default.useRef(null),_=_react.default.useRef(),v=_react.default.useRef(null),b=_react.default.useCallback(function(e){v.current=_reactDom.default.findDOMNode(e)},[]),E=(0,_useForkRef.default)(t.ref,b);return _react.default.useMemo(function(){l&&"undefined"!=typeof window&&(_.current=s().activeElement)},[l]),_react.default.useEffect(function(){if(l){var t=(0,_ownerDocument.default)(v.current);n||!v.current||v.current.contains(t.activeElement)||(v.current.hasAttribute("tabIndex")||("production"!==process.env.NODE_ENV&&console.error(["Material-UI: the modal content node does not accept focus.",'For the benefit of assistive technologies, the tabIndex of the node is being set to "-1".'].join("\n")),v.current.setAttribute("tabIndex",-1)),v.current.focus());var e=function(){o||!i()||f.current?f.current=!1:v.current&&!v.current.contains(t.activeElement)&&v.current.focus()},r=function(e){!o&&i()&&9===e.keyCode&&t.activeElement===v.current&&(f.current=!0,e.shiftKey?p.current.focus():d.current.focus())};t.addEventListener("focus",e,!0),t.addEventListener("keydown",r,!0);var u=setInterval(function(){e()},50);return function(){clearInterval(u),t.removeEventListener("focus",e,!0),t.removeEventListener("keydown",r,!0),c||(_.current&&_.current.focus&&_.current.focus(),_.current=null)}}},[n,o,c,i,l]),_react.default.createElement(_react.default.Fragment,null,_react.default.createElement("div",{tabIndex:0,ref:d,"data-test":"sentinelStart"}),_react.default.cloneElement(t,{ref:E}),_react.default.createElement("div",{tabIndex:0,ref:p,"data-test":"sentinelEnd"}))}"production"!==process.env.NODE_ENV&&(TrapFocus.propTypes={children:_propTypes.default.element.isRequired,disableAutoFocus:_propTypes.default.bool,disableEnforceFocus:_propTypes.default.bool,disableRestoreFocus:_propTypes.default.bool,getDoc:_propTypes.default.func.isRequired,isEnabled:_propTypes.default.func.isRequired,open:_propTypes.default.bool.isRequired});var _default=TrapFocus;exports.default=_default;