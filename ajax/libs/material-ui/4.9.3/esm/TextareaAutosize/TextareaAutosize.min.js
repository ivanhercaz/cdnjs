import _extends from"@babel/runtime/helpers/esm/extends";import _objectWithoutProperties from"@babel/runtime/helpers/esm/objectWithoutProperties";import React from"react";import PropTypes from"prop-types";import debounce from"../utils/debounce";import useForkRef from"../utils/useForkRef";function getStyleValue(e,t){return parseInt(e[t],10)||0}var useEnhancedEffect="undefined"!=typeof window?React.useLayoutEffect:React.useEffect,styles={shadow:{visibility:"hidden",position:"absolute",overflow:"hidden",height:0,top:0,left:0,transform:"translateZ(0)"}},TextareaAutosize=React.forwardRef(function(e,t){var r=e.onChange,o=e.rows,a=e.rowsMax,n=e.rowsMin,s=void 0===n?1:n,l=e.style,i=e.value,u=_objectWithoutProperties(e,["onChange","rows","rowsMax","rowsMin","style","value"]),p=o||s,c=React.useRef(null!=i).current,d=React.useRef(null),f=useForkRef(t,d),y=React.useRef(null),h=React.useState({}),m=h[0],w=h[1],b=React.useCallback(function(){var t=d.current,r=window.getComputedStyle(t),o=y.current;o.style.width=r.width,o.value=t.value||e.placeholder||"x";var n=r["box-sizing"],s=getStyleValue(r,"padding-bottom")+getStyleValue(r,"padding-top"),l=getStyleValue(r,"border-bottom-width")+getStyleValue(r,"border-top-width"),i=o.scrollHeight-s;o.value="x";var u=o.scrollHeight-s,c=i;p&&(c=Math.max(Number(p)*u,c)),a&&(c=Math.min(Number(a)*u,c));var f=(c=Math.max(c,u))+("border-box"===n?s+l:0),h=Math.abs(c-i)<=1;w(function(e){return f>0&&Math.abs((e.outerHeightStyle||0)-f)>1||e.overflow!==h?{overflow:h,outerHeightStyle:f}:e})},[a,p,e.placeholder]);React.useEffect(function(){var e=debounce(function(){b()});return window.addEventListener("resize",e),function(){e.clear(),window.removeEventListener("resize",e)}},[b]),useEnhancedEffect(function(){b()});return React.createElement(React.Fragment,null,React.createElement("textarea",_extends({value:i,onChange:function(e){c||b(),r&&r(e)},ref:f,rows:p,style:_extends({height:m.outerHeightStyle,overflow:m.overflow?"hidden":null},l)},u)),React.createElement("textarea",{"aria-hidden":!0,className:e.className,readOnly:!0,ref:y,tabIndex:-1,style:_extends({},styles.shadow,{},l)}))});"production"!==process.env.NODE_ENV&&(TextareaAutosize.propTypes={className:PropTypes.string,onChange:PropTypes.func,placeholder:PropTypes.string,rows:PropTypes.oneOfType([PropTypes.string,PropTypes.number]),rowsMax:PropTypes.oneOfType([PropTypes.string,PropTypes.number]),rowsMin:PropTypes.oneOfType([PropTypes.string,PropTypes.number]),style:PropTypes.object,value:PropTypes.any});export default TextareaAutosize;