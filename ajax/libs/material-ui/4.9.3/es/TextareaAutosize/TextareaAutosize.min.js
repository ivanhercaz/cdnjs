import _extends from"@babel/runtime/helpers/esm/extends";import _objectWithoutPropertiesLoose from"@babel/runtime/helpers/esm/objectWithoutPropertiesLoose";import React from"react";import PropTypes from"prop-types";import debounce from"../utils/debounce";import useForkRef from"../utils/useForkRef";function getStyleValue(e,t){return parseInt(e[t],10)||0}const useEnhancedEffect="undefined"!=typeof window?React.useLayoutEffect:React.useEffect,styles={shadow:{visibility:"hidden",position:"absolute",overflow:"hidden",height:0,top:0,left:0,transform:"translateZ(0)"}},TextareaAutosize=React.forwardRef(function(e,t){const{onChange:o,rows:r,rowsMax:s,rowsMin:a=1,style:n,value:l}=e,i=_objectWithoutPropertiesLoose(e,["onChange","rows","rowsMax","rowsMin","style","value"]),u=r||a,{current:p}=React.useRef(null!=l),c=React.useRef(null),d=useForkRef(t,c),f=React.useRef(null),[y,h]=React.useState({}),m=React.useCallback(()=>{const t=c.current,o=window.getComputedStyle(t),r=f.current;r.style.width=o.width,r.value=t.value||e.placeholder||"x";const a=o["box-sizing"],n=getStyleValue(o,"padding-bottom")+getStyleValue(o,"padding-top"),l=getStyleValue(o,"border-bottom-width")+getStyleValue(o,"border-top-width"),i=r.scrollHeight-n;r.value="x";const p=r.scrollHeight-n;let d=i;u&&(d=Math.max(Number(u)*p,d)),s&&(d=Math.min(Number(s)*p,d));const y=(d=Math.max(d,p))+("border-box"===a?n+l:0),m=Math.abs(d-i)<=1;h(e=>y>0&&Math.abs((e.outerHeightStyle||0)-y)>1||e.overflow!==m?{overflow:m,outerHeightStyle:y}:e)},[s,u,e.placeholder]);React.useEffect(()=>{const e=debounce(()=>{m()});return window.addEventListener("resize",e),()=>{e.clear(),window.removeEventListener("resize",e)}},[m]),useEnhancedEffect(()=>{m()});return React.createElement(React.Fragment,null,React.createElement("textarea",_extends({value:l,onChange:e=>{p||m(),o&&o(e)},ref:d,rows:u,style:_extends({height:y.outerHeightStyle,overflow:y.overflow?"hidden":null},n)},i)),React.createElement("textarea",{"aria-hidden":!0,className:e.className,readOnly:!0,ref:f,tabIndex:-1,style:_extends({},styles.shadow,{},n)}))});"production"!==process.env.NODE_ENV&&(TextareaAutosize.propTypes={className:PropTypes.string,onChange:PropTypes.func,placeholder:PropTypes.string,rows:PropTypes.oneOfType([PropTypes.string,PropTypes.number]),rowsMax:PropTypes.oneOfType([PropTypes.string,PropTypes.number]),rowsMin:PropTypes.oneOfType([PropTypes.string,PropTypes.number]),style:PropTypes.object,value:PropTypes.any});export default TextareaAutosize;