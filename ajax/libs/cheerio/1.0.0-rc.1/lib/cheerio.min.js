var parse=require("./parse"),defaultOptions=require("./options").default,flattenOptions=require("./options").flatten,isHtml=require("./utils").isHtml,_={extend:require("lodash/assignIn"),bind:require("lodash/bind"),forEach:require("lodash/forEach"),defaults:require("lodash/defaults")},api=[require("./api/attributes"),require("./api/traversing"),require("./api/manipulation"),require("./api/css"),require("./api/forms")],Cheerio=module.exports=function(e,t,i,r){return this instanceof Cheerio?(this.options=_.defaults(flattenOptions(r),this.options,defaultOptions),e?(i&&("string"==typeof i&&(i=parse(i,this.options,!1)),this._root=Cheerio.call(this,i)),e.cheerio?e:(isNode(e)&&(e=[e]),Array.isArray(e)?(_.forEach(e,_.bind(function(e,t){this[t]=e},this)),this.length=e.length,this):"string"==typeof e&&isHtml(e)?Cheerio.call(this,parse(e,this.options,!1).children):(t?"string"==typeof t?t=isHtml(t)?(t=parse(t,this.options,!1),Cheerio.call(this,t)):(e=[t,e].join(" "),this._root):t.cheerio||(t=Cheerio.call(this,t)):t=this._root,t?t.find(e):this))):this):new Cheerio(e,t,i,r)};_.extend(Cheerio,require("./static")),Cheerio.prototype.cheerio="[cheerio object]",Cheerio.prototype.length=0,Cheerio.prototype.splice=Array.prototype.splice,Cheerio.prototype._make=function(e,t){var i=new this.constructor(e,t,this._root,this.options);return i.prevObject=this,i},Cheerio.prototype.toArray=function(){return this.get()},api.forEach(function(e){_.extend(Cheerio.prototype,e)});var isNode=function(e){return e.name||"text"===e.type||"comment"===e.type};