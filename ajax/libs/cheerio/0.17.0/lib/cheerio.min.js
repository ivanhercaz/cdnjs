var path=require("path"),parse=require("./parse"),_=require("lodash"),api=[require("./api/attributes"),require("./api/traversing"),require("./api/manipulation"),require("./api/css")],quickExpr=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,Cheerio=module.exports=function(e,t,i,r){return this instanceof Cheerio?(this.options=_.defaults(r||{},this.options),e?(i&&("string"==typeof i&&(i=parse(i,this.options)),this._root=Cheerio.call(this,i)),e.cheerio?e:(isNode(e)&&(e=[e]),Array.isArray(e)?(_.forEach(e,function(e,t){this[t]=e},this),this.length=e.length,this):"string"==typeof e&&isHtml(e)?Cheerio.call(this,parse(e,this.options).children):(t?"string"==typeof t?t=isHtml(t)?(t=parse(t,this.options),Cheerio.call(this,t)):(e=[t,e].join(" "),this._root):t.cheerio||(t=Cheerio.call(this,t)):t=this._root,t?t.find(e):this))):this):new Cheerio(e,t,i,r)};_.extend(Cheerio,require("./static")),Cheerio.prototype.cheerio="[cheerio object]",Cheerio.prototype.options={normalizeWhitespace:!1,xmlMode:!1,decodeEntities:!0},Cheerio.prototype.length=0,Cheerio.prototype.splice=Array.prototype.splice;var isHtml=function(e){if("<"===e.charAt(0)&&">"===e.charAt(e.length-1)&&3<=e.length)return!0;var t=quickExpr.exec(e);return!(!t||!t[1])};Cheerio.prototype._make=function(e,t){var i=new Cheerio(e,t,this._root,this.options);return i.prevObject=this,i},Cheerio.prototype.toArray=function(){return this.get()},api.forEach(function(e){_.extend(Cheerio.prototype,e)});var isNode=function(e){return e.name||"text"===e.type||"comment"===e.type};