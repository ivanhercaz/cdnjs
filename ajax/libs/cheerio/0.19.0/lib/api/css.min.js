var _=require("lodash"),domEach=require("../utils").domEach,toString=Object.prototype.toString;function setCss(e,r,t,s){if("string"==typeof r){var n=getCss(e);"function"==typeof t&&(t=t.call(e,s,n[r])),""===t?delete n[r]:null!=t&&(n[r]=t),e.attribs.style=stringify(n)}else"object"==typeof r&&Object.keys(r).forEach(function(t){setCss(e,t,r[t])})}function getCss(t,e){var r=parse(t.attribs.style);return"string"==typeof e?r[e]:Array.isArray(e)?_.pick(r,e):r}function stringify(r){return Object.keys(r||{}).reduce(function(t,e){return t+((t?" ":"")+e+": "+r[e])+";"},"")}function parse(t){return(t=(t||"").trim())?t.split(";").reduce(function(t,e){var r=e.indexOf(":");return r<1||r===e.length-1||(t[e.slice(0,r).trim()]=e.slice(r+1).trim()),t},{}):{}}exports.css=function(r,s){return 2===arguments.length||"[object Object]"===toString.call(r)?domEach(this,function(t,e){setCss(e,r,s,t)}):getCss(this[0],r)};