exports.__esModule=!0,exports.Helmet=void 0;var _createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_react=require("react"),_react2=_interopRequireDefault(_react),_reactSideEffect=require("react-side-effect"),_reactSideEffect2=_interopRequireDefault(_reactSideEffect),_deepEqual=require("deep-equal"),_deepEqual2=_interopRequireDefault(_deepEqual),_objectAssign=require("object-assign"),_objectAssign2=_interopRequireDefault(_objectAssign),_HelmetConstants=require("./HelmetConstants.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _objectWithoutProperties(e,t){var n={};for(var r in e)0<=t.indexOf(r)||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var encodeSpecialCharacters=function(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;")},getInnermostProperty=function(e,t){for(var n=e.length-1;0<=n;n--){var r=e[n];if(r[t])return r[t]}return null},getTitleFromPropsList=function(e){var t=getInnermostProperty(e,_HelmetConstants.TAG_NAMES.TITLE),n=getInnermostProperty(e,_HelmetConstants.HELMET_PROPS.TITLE_TEMPLATE);if(n&&t)return n.replace(/%s/g,function(){return t});var r=getInnermostProperty(e,_HelmetConstants.HELMET_PROPS.DEFAULT_TITLE);return t||r||""},getOnChangeClientState=function(e){return getInnermostProperty(e,_HelmetConstants.HELMET_PROPS.ON_CHANGE_CLIENT_STATE)||function(){}},getAttributesFromPropsList=function(t,e){return e.filter(function(e){return void 0!==e[t]}).map(function(e){return e[t]}).reduce(function(e,t){return _extends({},e,t)},{})},getBaseTagFromPropsList=function(o,e){return e.filter(function(e){return void 0!==e[_HelmetConstants.TAG_NAMES.BASE]}).map(function(e){return e[_HelmetConstants.TAG_NAMES.BASE]}).reverse().reduce(function(e,t){if(!e.length)for(var n=Object.keys(t),r=0;r<n.length;r++){var s=n[r].toLowerCase();if(-1!==o.indexOf(s)&&t[s])return e.concat(t)}return e},[])},getTagsFromPropsList=function(t,l,e){var u={};return e.filter(function(e){return!!Array.isArray(e[t])||(void 0!==e[t]&&warn("Helmet: "+t+' should be of type "Array". Instead found type "'+_typeof(e[t])+'"'),!1)}).map(function(e){return e[t]}).reverse().reduce(function(t,e){var i={};e.filter(function(e){for(var t=void 0,n=Object.keys(e),r=0;r<n.length;r++){var s=n[r],o=s.toLowerCase();-1===l.indexOf(o)||t===_HelmetConstants.TAG_PROPERTIES.REL&&"canonical"===e[t].toLowerCase()||o===_HelmetConstants.TAG_PROPERTIES.REL&&"stylesheet"===e[o].toLowerCase()||(t=o),-1===l.indexOf(s)||s!==_HelmetConstants.TAG_PROPERTIES.INNER_HTML&&s!==_HelmetConstants.TAG_PROPERTIES.CSS_TEXT&&s!==_HelmetConstants.TAG_PROPERTIES.ITEM_PROP||(t=s)}if(!t||!e[t])return!1;var a=e[t].toLowerCase();return u[t]||(u[t]={}),i[t]||(i[t]={}),!u[t][a]&&(i[t][a]=!0)}).reverse().forEach(function(e){return t.push(e)});for(var n=Object.keys(i),r=0;r<n.length;r++){var s=n[r],o=(0,_objectAssign2.default)({},u[s],i[s]);u[s]=o}return t},[]).reverse()},updateTitle=function(e,t){document.title=e||document.title,updateAttributes(_HelmetConstants.TAG_NAMES.TITLE,t)},updateAttributes=function(e,t){for(var n=document.getElementsByTagName(e)[0],r=n.getAttribute(_HelmetConstants.HELMET_ATTRIBUTE),s=r?r.split(","):[],o=[].concat(s),a=Object.keys(t),i=0;i<a.length;i++){var l=a[i],u=t[l]||"";n.setAttribute(l,u),-1===s.indexOf(l)&&s.push(l);var T=o.indexOf(l);-1!==T&&o.splice(T,1)}for(var c=o.length-1;0<=c;c--)n.removeAttribute(o[c]);s.length===o.length?n.removeAttribute(_HelmetConstants.HELMET_ATTRIBUTE):n.setAttribute(_HelmetConstants.HELMET_ATTRIBUTE,s.join(","))},updateTags=function(s,e){var t=document.head||document.querySelector(_HelmetConstants.TAG_NAMES.HEAD),n=t.querySelectorAll(s+"["+_HelmetConstants.HELMET_ATTRIBUTE+"]"),o=Array.prototype.slice.call(n),a=[],i=void 0;return e&&e.length&&e.forEach(function(e){var n=document.createElement(s);for(var t in e)if(e.hasOwnProperty(t))if(t===_HelmetConstants.TAG_PROPERTIES.INNER_HTML)n.innerHTML=e.innerHTML;else if(t===_HelmetConstants.TAG_PROPERTIES.CSS_TEXT)n.styleSheet?n.styleSheet.cssText=e.cssText:n.appendChild(document.createTextNode(e.cssText));else{var r=void 0===e[t]?"":e[t];n.setAttribute(t,r)}n.setAttribute(_HelmetConstants.HELMET_ATTRIBUTE,"true"),o.some(function(e,t){return i=t,n.isEqualNode(e)})?o.splice(i,1):a.push(n)}),o.forEach(function(e){return e.parentNode.removeChild(e)}),a.forEach(function(e){return t.appendChild(e)}),{oldTags:o,newTags:a}},generateElementAttributesAsString=function(r){return Object.keys(r).reduce(function(e,t){var n=void 0!==r[t]?t+'="'+r[t]+'"':""+t;return e?e+" "+n:n},"")},generateTitleAsString=function(e,t,n){var r=generateElementAttributesAsString(n);return r?"<"+e+" "+_HelmetConstants.HELMET_ATTRIBUTE+'="true" '+r+">"+encodeSpecialCharacters(t)+"</"+e+">":"<"+e+" "+_HelmetConstants.HELMET_ATTRIBUTE+'="true">'+encodeSpecialCharacters(t)+"</"+e+">"},generateTagsAsString=function(o,e){return e.reduce(function(e,r){var t=Object.keys(r).filter(function(e){return!(e===_HelmetConstants.TAG_PROPERTIES.INNER_HTML||e===_HelmetConstants.TAG_PROPERTIES.CSS_TEXT)}).reduce(function(e,t){var n=void 0===r[t]?t:t+'="'+encodeSpecialCharacters(r[t])+'"';return e?e+" "+n:n},""),n=r.innerHTML||r.cssText||"",s=-1===_HelmetConstants.SELF_CLOSING_TAGS.indexOf(o);return e+"<"+o+" "+_HelmetConstants.HELMET_ATTRIBUTE+'="true" '+t+(s?"/>":">"+n+"</"+o+">")},"")},convertElementAttributestoReactProps=function(n,e){var t=1<arguments.length&&void 0!==e?e:{};return Object.keys(n).reduce(function(e,t){return e[_HelmetConstants.REACT_TAG_MAP[t]||t]=n[t],e},t)},convertReactPropstoHtmlAttributes=function(n,e){var t=1<arguments.length&&void 0!==e?e:{};return Object.keys(n).reduce(function(e,t){return e[_HelmetConstants.HTML_TAG_MAP[t]||t]=n[t],e},t)},generateTitleAsReactComponent=function(e,t,n){var r=_defineProperty({key:t},_HelmetConstants.HELMET_ATTRIBUTE,!0),s=convertElementAttributestoReactProps(n,r);return[_react2.default.createElement(_HelmetConstants.TAG_NAMES.TITLE,s,t)]},generateTagsAsReactComponent=function(t,e){return e.map(function(r,e){var s=_defineProperty({key:e},_HelmetConstants.HELMET_ATTRIBUTE,!0);return Object.keys(r).forEach(function(e){var t=_HelmetConstants.REACT_TAG_MAP[e]||e;if(t===_HelmetConstants.TAG_PROPERTIES.INNER_HTML||t===_HelmetConstants.TAG_PROPERTIES.CSS_TEXT){var n=r.innerHTML||r.cssText;s.dangerouslySetInnerHTML={__html:n}}else s[t]=r[e]}),_react2.default.createElement(t,s)})},getMethodsForTag=function(e,t){switch(e){case _HelmetConstants.TAG_NAMES.TITLE:return{toComponent:function(){return generateTitleAsReactComponent(e,t.title,t.titleAttributes)},toString:function(){return generateTitleAsString(e,t.title,t.titleAttributes)}};case _HelmetConstants.ATTRIBUTE_NAMES.BODY:case _HelmetConstants.ATTRIBUTE_NAMES.HTML:return{toComponent:function(){return convertElementAttributestoReactProps(t)},toString:function(){return generateElementAttributesAsString(t)}};default:return{toComponent:function(){return generateTagsAsReactComponent(e,t)},toString:function(){return generateTagsAsString(e,t)}}}},mapStateOnServer=function(e){var t=e.baseTag,n=e.bodyAttributes,r=e.htmlAttributes,s=e.linkTags,o=e.metaTags,a=e.noscriptTags,i=e.scriptTags,l=e.styleTags,u=e.title,T=e.titleAttributes;return{base:getMethodsForTag(_HelmetConstants.TAG_NAMES.BASE,t),bodyAttributes:getMethodsForTag(_HelmetConstants.ATTRIBUTE_NAMES.BODY,n),htmlAttributes:getMethodsForTag(_HelmetConstants.ATTRIBUTE_NAMES.HTML,r),link:getMethodsForTag(_HelmetConstants.TAG_NAMES.LINK,s),meta:getMethodsForTag(_HelmetConstants.TAG_NAMES.META,o),noscript:getMethodsForTag(_HelmetConstants.TAG_NAMES.NOSCRIPT,a),script:getMethodsForTag(_HelmetConstants.TAG_NAMES.SCRIPT,i),style:getMethodsForTag(_HelmetConstants.TAG_NAMES.STYLE,l),title:getMethodsForTag(_HelmetConstants.TAG_NAMES.TITLE,{title:u,titleAttributes:T})}},Helmet=function(s){var e,t;return _inherits(n,_react2.default.Component),_createClass(n,[{key:"shouldComponentUpdate",value:function(e){return!(0,_deepEqual2.default)(this.props,e)}},{key:"mapNestedChildrenToProps",value:function(e,t){if(!t)return null;switch(e.type){case _HelmetConstants.TAG_NAMES.SCRIPT:case _HelmetConstants.TAG_NAMES.NOSCRIPT:return{innerHTML:t};case _HelmetConstants.TAG_NAMES.STYLE:return{cssText:t}}return t}},{key:"flattenArrayTypeChildren",value:function(e){var t=e.child,n=e.arrayTypeChildren,r=e.newChildProps,s=e.nestedChildren;return _extends({},n,_defineProperty({},t.type,[].concat(_toConsumableArray(n[t.type]||[]),[_extends({},r,this.mapNestedChildrenToProps(t,s))])))}},{key:"mapObjectTypeChildren",value:function(e){var t,n=e.child,r=e.newProps,s=e.newChildProps,o=e.nestedChildren;switch(n.type){case _HelmetConstants.TAG_NAMES.TITLE:return _extends({},r,(_defineProperty(t={},n.type,o),_defineProperty(t,"titleAttributes",_extends({},s)),t));case _HelmetConstants.TAG_NAMES.BODY:return _extends({},r,{bodyAttributes:_extends({},s)});case _HelmetConstants.TAG_NAMES.HTML:return _extends({},r,{htmlAttributes:_extends({},s)})}return _extends({},r,_defineProperty({},n.type,_extends({},s)))}},{key:"mapArrayTypeChildrenToProps",value:function(t,e){var n=_extends({},e);return Object.keys(t).forEach(function(e){n=_extends({},n,_defineProperty({},e,t[e]))}),n}},{key:"warnOnInvalidChildren",value:function(e,t){"production"!==process.env.NODE_ENV&&t&&"string"!=typeof t&&console.warn("Helmet expects a single string as a child of "+e.type)}},{key:"mapChildrenToProps",value:function(e,o){var a=this,i={};return _react2.default.Children.forEach(e,function(e){var t=e.props,n=t.children,r=_objectWithoutProperties(t,["children"]),s=convertReactPropstoHtmlAttributes(r);switch(a.warnOnInvalidChildren(e,n),e.type){case _HelmetConstants.TAG_NAMES.LINK:case _HelmetConstants.TAG_NAMES.META:case _HelmetConstants.TAG_NAMES.NOSCRIPT:case _HelmetConstants.TAG_NAMES.SCRIPT:case _HelmetConstants.TAG_NAMES.STYLE:i=a.flattenArrayTypeChildren({child:e,arrayTypeChildren:i,newChildProps:s,nestedChildren:n});break;default:o=a.mapObjectTypeChildren({child:e,newProps:o,newChildProps:s,nestedChildren:n})}}),o=this.mapArrayTypeChildrenToProps(i,o)}},{key:"render",value:function(){var e=this.props,t=e.children,n=_objectWithoutProperties(e,["children"]),r=_extends({},n);return t&&(r=this.mapChildrenToProps(t,r)),_react2.default.createElement(s,r)}}],[{key:"canUseDOM",set:function(e){s.canUseDOM=e}}]),t=e=n,e.propTypes={base:_react2.default.PropTypes.object,bodyAttributes:_react2.default.PropTypes.object,children:_react2.default.PropTypes.oneOfType([_react2.default.PropTypes.arrayOf(_react2.default.PropTypes.node),_react2.default.PropTypes.node]),defaultTitle:_react2.default.PropTypes.string,htmlAttributes:_react2.default.PropTypes.object,link:_react2.default.PropTypes.arrayOf(_react2.default.PropTypes.object),meta:_react2.default.PropTypes.arrayOf(_react2.default.PropTypes.object),noscript:_react2.default.PropTypes.arrayOf(_react2.default.PropTypes.object),onChangeClientState:_react2.default.PropTypes.func,script:_react2.default.PropTypes.arrayOf(_react2.default.PropTypes.object),style:_react2.default.PropTypes.arrayOf(_react2.default.PropTypes.object),title:_react2.default.PropTypes.string,titleAttributes:_react2.default.PropTypes.object,titleTemplate:_react2.default.PropTypes.string},e.peek=s.peek,e.rewind=function(){var e=s.rewind();return e=e||mapStateOnServer({baseTag:[],bodyAttributes:{},htmlAttributes:{},linkTags:[],metaTags:[],noscriptTags:[],scriptTags:[],styleTags:[],title:"",titleAttributes:{}})},t;function n(){return _classCallCheck(this,n),_possibleConstructorReturn(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}},reducePropsToState=function(e){return{baseTag:getBaseTagFromPropsList([_HelmetConstants.TAG_PROPERTIES.HREF],e),bodyAttributes:getAttributesFromPropsList(_HelmetConstants.ATTRIBUTE_NAMES.BODY,e),htmlAttributes:getAttributesFromPropsList(_HelmetConstants.ATTRIBUTE_NAMES.HTML,e),linkTags:getTagsFromPropsList(_HelmetConstants.TAG_NAMES.LINK,[_HelmetConstants.TAG_PROPERTIES.REL,_HelmetConstants.TAG_PROPERTIES.HREF],e),metaTags:getTagsFromPropsList(_HelmetConstants.TAG_NAMES.META,[_HelmetConstants.TAG_PROPERTIES.NAME,_HelmetConstants.TAG_PROPERTIES.CHARSET,_HelmetConstants.TAG_PROPERTIES.HTTPEQUIV,_HelmetConstants.TAG_PROPERTIES.PROPERTY,_HelmetConstants.TAG_PROPERTIES.ITEM_PROP],e),noscriptTags:getTagsFromPropsList(_HelmetConstants.TAG_NAMES.NOSCRIPT,[_HelmetConstants.TAG_PROPERTIES.INNER_HTML],e),onChangeClientState:getOnChangeClientState(e),scriptTags:getTagsFromPropsList(_HelmetConstants.TAG_NAMES.SCRIPT,[_HelmetConstants.TAG_PROPERTIES.SRC,_HelmetConstants.TAG_PROPERTIES.INNER_HTML],e),styleTags:getTagsFromPropsList(_HelmetConstants.TAG_NAMES.STYLE,[_HelmetConstants.TAG_PROPERTIES.CSS_TEXT],e),title:getTitleFromPropsList(e),titleAttributes:getAttributesFromPropsList(_HelmetConstants.ATTRIBUTE_NAMES.TITLE,e)}},handleClientStateChange=function(e){var t=e.baseTag,n=e.bodyAttributes,r=e.htmlAttributes,s=e.linkTags,o=e.metaTags,a=e.noscriptTags,i=e.onChangeClientState,l=e.scriptTags,u=e.styleTags,T=e.title,c=e.titleAttributes;updateAttributes(_HelmetConstants.TAG_NAMES.BODY,n),updateAttributes(_HelmetConstants.TAG_NAMES.HTML,r),updateTitle(T,c);var _={baseTag:updateTags(_HelmetConstants.TAG_NAMES.BASE,t),linkTags:updateTags(_HelmetConstants.TAG_NAMES.LINK,s),metaTags:updateTags(_HelmetConstants.TAG_NAMES.META,o),noscriptTags:updateTags(_HelmetConstants.TAG_NAMES.NOSCRIPT,a),scriptTags:updateTags(_HelmetConstants.TAG_NAMES.SCRIPT,l),styleTags:updateTags(_HelmetConstants.TAG_NAMES.STYLE,u)},p={},f={};Object.keys(_).forEach(function(e){var t=_[e],n=t.newTags,r=t.oldTags;n.length&&(p[e]=n),r.length&&(f[e]=_[e].oldTags)}),i(e,p,f)},warn=function(e){return console&&"function"==typeof console.warn&&console.warn(e)},NullComponent=function(){return null},HelmetSideEffects=(0,_reactSideEffect2.default)(reducePropsToState,handleClientStateChange,mapStateOnServer)(NullComponent),HelmetExport=Helmet(HelmetSideEffects);HelmetExport.renderStatic=HelmetExport.rewind,exports.Helmet=HelmetExport,exports.default=HelmetExport;