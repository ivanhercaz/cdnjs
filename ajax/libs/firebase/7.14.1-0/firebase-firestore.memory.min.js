!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t=t||self).firebase)}(this,function(Al){"use strict";try{(function(){Al=Al&&Object.prototype.hasOwnProperty.call(Al,"default")?Al.default:Al;var t,u,e,i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function n(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function c(t,s,u,a){return new(u=u||Promise)(function(n,e){function i(t){try{o(a.next(t))}catch(t){e(t)}}function r(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(i,r)}o((a=a.apply(t,s||[])).next())})}function y(n,i){var r,o,s,t,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(r)throw new TypeError("Generator is already executing.");for(;u;)try{if(r=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=i.call(n,u)}catch(t){e=[6,t],o=0}finally{r=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function r(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var i=Array(t),r=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,r++)i[r]=o[s];return i}function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var i=Array(t),r=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,r++)i[r]=o[s];return i}function o(t,e){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];if(!(e<t.logLevel)){var r=(new Date).toISOString(),o=h[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,s(["["+r+"]  "+t.name+":"],n))}}(e=u=u||{})[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT",u.DEBUG,u.VERBOSE,u.INFO,u.WARN,u.ERROR,u.SILENT;var a=u.INFO,h=((t={})[u.DEBUG]="log",t[u.VERBOSE]="log",t[u.INFO]="info",t[u.WARN]="warn",t[u.ERROR]="error",t),l=(Object.defineProperty(f.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in u))throw new TypeError("Invalid value assigned to `logLevel`");this._logLevel=t},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!0,configurable:!0}),f.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.DEBUG],t)),this._logHandler.apply(this,s([this,u.DEBUG],t))},f.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.VERBOSE],t)),this._logHandler.apply(this,s([this,u.VERBOSE],t))},f.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.INFO],t)),this._logHandler.apply(this,s([this,u.INFO],t))},f.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.WARN],t)),this._logHandler.apply(this,s([this,u.WARN],t))},f.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.ERROR],t)),this._logHandler.apply(this,s([this,u.ERROR],t))},f);function f(t){this.name=t,this._logLevel=a,this._logHandler=o,this._userLogHandler=null}function p(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var d,v=(n(g,d=Error),g);function g(t,e){var n=d.call(this,e)||this;return n.code=t,n.name="FirebaseError",Object.setPrototypeOf(n,g.prototype),Error.captureStackTrace&&Error.captureStackTrace(n,m.prototype.create),n}var m=(w.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var i,r=e[0]||{},o=this.service+"/"+t,s=this.errors[t],u=s?(i=r,s.replace(b,function(t,e){var n=i[e];return null!=n?n.toString():"<"+e+"?>"})):"Error",a=this.serviceName+": "+u+" ("+o+").",h=new v(o,a),c=0,l=Object.keys(r);c<l.length;c++){var f=l[c];"_"!==f.slice(-1)&&(f in h&&console.warn('Overwriting FirebaseError base field "'+f+'" can cause unexpected behavior.'),h[f]=r[f])}return h},w);function w(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var b=/\{\$([^}]+)}/g,E=(A.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},A.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},A.prototype.setServiceProps=function(t){return this.serviceProps=t,this},A);function A(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var I,N="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},T=T||{},_=N;function S(t){return"string"==typeof t}function k(t){return"number"==typeof t}function R(t,e){t=t.split("."),e=e||_;for(var n=0;n<t.length;n++)if(null==(e=e[t[n]]))return null;return e}function O(){}function L(t){var e=typeof t;if("object"==e){if(!t)return"null";if(t instanceof Array)return"array";if(t instanceof Object)return e;var n=Object.prototype.toString.call(t);if("[object Window]"==n)return"object";if("[object Array]"==n||"number"==typeof t.length&&void 0!==t.splice&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("splice"))return"array";if("[object Function]"==n||void 0!==t.call&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("call"))return"function"}else if("function"==e&&void 0===t.call)return"object";return e}function D(t){return"array"==L(t)}function C(t){var e=L(t);return"array"==e||"object"==e&&"number"==typeof t.length}function V(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var U="closure_uid_"+(1e9*Math.random()>>>0),P=0;function M(t,e,n){return t.call.apply(t.bind,arguments)}function q(e,n,t){if(!e)throw Error();if(2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,i),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function x(t,e,n){return(x=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?M:q).apply(null,arguments)}function G(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var j=Date.now||function(){return+new Date};function F(t,o){function e(){}e.prototype=o.prototype,t.N=o.prototype,t.prototype=new e,(t.prototype.constructor=t).yb=function(t,e,n){for(var i=Array(arguments.length-2),r=2;r<arguments.length;r++)i[r-2]=arguments[r];return o.prototype[e].apply(t,i)}}function B(){this.j=this.j,this.i=this.i}B.prototype.j=!1,B.prototype.la=function(){!this.j&&(this.j=!0,this.G(),0)&&(this[U]||(this[U]=++P))},B.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var H=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(S(t))return S(e)&&1==e.length?t.indexOf(e,0):-1;for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},Y=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var i=t.length,r=S(t)?t.split(""):t,o=0;o<i;o++)o in r&&e.call(n,r[o],o,t)};function z(t){return Array.prototype.concat.apply([],arguments)}function Q(t){var e=t.length;if(0<e){for(var n=Array(e),i=0;i<e;i++)n[i]=t[i];return n}return[]}function W(t){return/^[\s\xa0]*$/.test(t)}var X,J=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function K(t,e){return-1!=t.indexOf(e)}function Z(t,e){return t<e?-1:e<t?1:0}t:{var $=_.navigator;if($){var tt=$.userAgent;if(tt){X=tt;break t}}X=""}function et(t,e,n){for(var i in t)e.call(n,t[i],i,t)}function nt(t){var e,n={};for(e in t)n[e]=t[e];return n}var it="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function rt(t,e){for(var n,i,r=1;r<arguments.length;r++){for(n in i=arguments[r])t[n]=i[n];for(var o=0;o<it.length;o++)n=it[o],Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}}function ot(t){return ot[" "](t),t}ot[" "]=O;var st,ut,at=K(X,"Opera"),ht=K(X,"Trident")||K(X,"MSIE"),ct=K(X,"Edge"),lt=ct||ht,ft=K(X,"Gecko")&&!(K(X.toLowerCase(),"webkit")&&!K(X,"Edge"))&&!(K(X,"Trident")||K(X,"MSIE"))&&!K(X,"Edge"),pt=K(X.toLowerCase(),"webkit")&&!K(X,"Edge");function dt(){var t=_.document;return t?t.documentMode:void 0}t:{var yt="",vt=(ut=X,ft?/rv:([^\);]+)(\)|;)/.exec(ut):ct?/Edge\/([\d\.]+)/.exec(ut):ht?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(ut):pt?/WebKit\/(\S+)/.exec(ut):at?/(?:Version)[ \/]?(\S+)/.exec(ut):void 0);if(vt&&(yt=vt?vt[1]:""),ht){var gt=dt();if(null!=gt&&gt>parseFloat(yt)){st=String(gt);break t}}st=yt}var mt,wt={};function bt(u){return t=u,e=function(){for(var t=0,e=J(String(st)).split("."),n=J(String(u)).split("."),i=Math.max(e.length,n.length),r=0;0==t&&r<i;r++){var o=e[r]||"",s=n[r]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=Z(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||Z(0==o[2].length,0==s[2].length)||Z(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t},n=wt,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e();var t,e,n}var Et=_.document;mt=Et&&ht?dt()||("CSS1Compat"==Et.compatMode?parseInt(st,10):5):void 0;var At=!ht||9<=Number(mt),It=ht&&!bt("9"),Nt=function(){if(!_.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{_.addEventListener("test",O,e),_.removeEventListener("test",O,e)}catch(t){}return t}();function Tt(t,e){this.type=t,this.a=this.target=e,this.Ia=!0}function _t(t,e){if(Tt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,i=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(ft){t:{try{ot(e.nodeName);var r=!0;break t}catch(t){}r=!1}r||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,i?(this.clientX=void 0!==i.clientX?i.clientX:i.pageX,this.clientY=void 0!==i.clientY?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=S(t.pointerType)?t.pointerType:St[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}Tt.prototype.b=function(){this.Ia=!1},F(_t,Tt);var St={2:"touch",3:"pen",4:"mouse"};_t.prototype.b=function(){_t.N.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,It)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var kt="closure_listenable_"+(1e6*Math.random()|0),Rt=0;function Ot(t,e,n,i,r){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!i,this.da=r,this.key=++Rt,this.X=this.Z=!1}function Lt(t){t.X=!0,t.listener=null,t.proxy=null,t.src=null,t.da=null}function Dt(t){this.src=t,this.a={},this.b=0}function Ct(t,e){var n=e.type;if(n in t.a){var i,r=t.a[n],o=H(r,e);(i=0<=o)&&Array.prototype.splice.call(r,o,1),i&&(Lt(e),0==t.a[n].length&&(delete t.a[n],t.b--))}}function Vt(t,e,n,i){for(var r=0;r<t.length;++r){var o=t[r];if(!o.X&&o.listener==e&&o.capture==!!n&&o.da==i)return r}return-1}Dt.prototype.add=function(t,e,n,i,r){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=Vt(t,e,i,r);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new Ot(e,this.src,o,!!i,r)).Z=n,t.push(e)),e};var Ut="closure_lm_"+(1e6*Math.random()|0),Pt={};function Mt(t,e,n,i,r){if(i&&i.once)return function t(e,n,i,r,o){if(D(n)){for(var s=0;s<n.length;s++)t(e,n[s],i,r,o);return null}return i=Yt(i),e&&e[kt]?e.Aa(n,i,V(r)?!!r.capture:!!r,o):qt(e,n,i,!0,r,o)}(t,e,n,i,r);if(D(e)){for(var o=0;o<e.length;o++)Mt(t,e[o],n,i,r);return null}return n=Yt(n),t&&t[kt]?t.za(e,n,V(i)?!!i.capture:!!i,r):qt(t,e,n,!1,i,r)}function qt(t,e,n,i,r,o){if(!e)throw Error("Invalid event type");var s=V(r)?!!r.capture:!!r;if(s&&!At)return null;var u,a,h=Bt(t);if(h||(t[Ut]=h=new Dt(t)),(n=h.add(e,n,i,s,o)).proxy)return n;if(u=Ft,i=a=At?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=i).src=t,i.listener=n,t.addEventListener)Nt||(r=s),void 0===r&&(r=!1),t.addEventListener(e.toString(),i,r);else if(t.attachEvent)t.attachEvent(Gt(e.toString()),i);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(i)}return n}function xt(t){if(!k(t)&&t&&!t.X){var e=t.src;if(e&&e[kt])Ct(e.c,t);else{var n=t.type,i=t.proxy;e.removeEventListener?e.removeEventListener(n,i,t.capture):e.detachEvent?e.detachEvent(Gt(n),i):e.addListener&&e.removeListener&&e.removeListener(i),(n=Bt(e))?(Ct(n,t),0==n.b&&(n.src=null,e[Ut]=null)):Lt(t)}}}function Gt(t){return t in Pt?Pt[t]:Pt[t]="on"+t}function jt(t,e){var n=t.listener,i=t.da||t.src;return t.Z&&xt(t),n.call(i,e)}function Ft(t,e){return!!t.X||jt(t,At?new _t(e,this):e=new _t(e||R("window.event"),this))}function Bt(t){return(t=t[Ut])instanceof Dt?t:null}var Ht="__closure_events_fn_"+(1e9*Math.random()>>>0);function Yt(e){return"function"==L(e)?e:(e[Ht]||(e[Ht]=function(t){return e.handleEvent(t)}),e[Ht])}function zt(){B.call(this),this.c=new Dt(this),(this.J=this).B=null}function Qt(t,e,n,i){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var r=!0,o=0;o<e.length;++o){var s=e[o];if(s&&!s.X&&s.capture==n){var u=s.listener,a=s.da||s.src;s.Z&&Ct(t.c,s),r=!1!==u.call(a,i)&&r}}return r&&0!=i.Ia}F(zt,B),zt.prototype[kt]=!0,(I=zt.prototype).addEventListener=function(t,e,n,i){Mt(this,t,e,n,i)},I.removeEventListener=function(t,e,n,i){!function t(e,n,i,r,o){if(D(n))for(var s=0;s<n.length;s++)t(e,n[s],i,r,o);else r=V(r)?!!r.capture:!!r,i=Yt(i),e&&e[kt]?(e=e.c,(n=String(n).toString())in e.a&&-1<(i=Vt(s=e.a[n],i,r,o))&&(Lt(s[i]),Array.prototype.splice.call(s,i,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&Bt(e))&&(n=e.a[n.toString()],e=-1,n&&(e=Vt(n,i,r,o)),(i=-1<e?n[e]:null)&&xt(i))}(this,t,e,n,i)},I.dispatchEvent=function(t){var e,n=this.B;if(n)for(e=[];n;n=n.B)e.push(n);n=this.J;var i=t.type||t;if(S(t))t=new Tt(t,n);else if(t instanceof Tt)t.target=t.target||n;else{var r=t;rt(t=new Tt(i,n),r)}if(r=!0,e)for(var o=e.length-1;0<=o;o--){var s=t.a=e[o];r=Qt(s,i,!0,t)&&r}if(r=Qt(s=t.a=n,i,!0,t)&&r,r=Qt(s,i,!1,t)&&r,e)for(o=0;o<e.length;o++)r=Qt(s=t.a=e[o],i,!1,t)&&r;return r},I.G=function(){if(zt.N.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],i=0;i<n.length;i++)Lt(n[i]);delete e.a[t],e.b--}}this.B=null},I.za=function(t,e,n,i){return this.c.add(String(t),e,!1,n,i)},I.Aa=function(t,e,n,i){return this.c.add(String(t),e,!0,n,i)};var Wt=_.JSON.stringify;function Xt(t,e){this.c=t,this.f=e,this.b=0,this.a=null}function Jt(){this.b=this.a=null}Xt.prototype.get=function(){if(0<this.b){this.b--;var t=this.a;this.a=t.next,t.next=null}else t=this.c();return t};var Kt,Zt=new Xt(function(){return new $t},function(t){t.reset()});function $t(){this.next=this.b=this.a=null}function te(t){_.setTimeout(function(){throw t},0)}function ee(t,e){var n;Kt||(n=_.Promise.resolve(void 0),Kt=function(){n.then(re)}),ne||(Kt(),ne=!0),ie.add(t,e)}Jt.prototype.add=function(t,e){var n=Zt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},$t.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var ne=!($t.prototype.reset=function(){this.next=this.b=this.a=null}),ie=new Jt;function re(){for(var t;i=n=void 0,i=null,(n=ie).a&&(i=n.a,n.a=n.a.next,n.a||(n.b=null),i.next=null),t=i;){try{t.a.call(t.b)}catch(t){te(t)}var e=Zt;e.f(t),e.b<100&&(e.b++,t.next=e.a,e.a=t)}var n,i;ne=!1}function oe(t,e){zt.call(this),this.b=t||1,this.a=e||_,this.f=x(this.gb,this),this.g=j()}function se(t){t.ba=!1,t.L&&(t.a.clearTimeout(t.L),t.L=null)}function ue(t,e,n){if("function"==L(t))n&&(t=x(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=x(t.handleEvent,t)}return 2147483647<Number(e)?-1:_.setTimeout(t,e||0)}function ae(t,e,n){B.call(this),this.f=null!=n?x(t,n):t,this.c=e,this.b=x(this.$a,this),this.a=[]}function he(t){t.U=ue(t.b,t.c),t.f.apply(null,t.a)}function ce(t){B.call(this),this.b=t,this.a={}}F(oe,zt),(I=oe.prototype).ba=!1,I.L=null,I.gb=function(){if(this.ba){var t=j()-this.g;0<t&&t<.8*this.b?this.L=this.a.setTimeout(this.f,this.b-t):(this.L&&(this.a.clearTimeout(this.L),this.L=null),this.dispatchEvent("tick"),this.ba&&(se(this),this.start()))}},I.start=function(){this.ba=!0,this.L||(this.L=this.a.setTimeout(this.f,this.b),this.g=j())},I.G=function(){oe.N.G.call(this),se(this),delete this.a},F(ae,B),(I=ae.prototype).ea=!1,I.U=null,I.Ta=function(t){this.a=arguments,this.U?this.ea=!0:he(this)},I.G=function(){ae.N.G.call(this),this.U&&(_.clearTimeout(this.U),this.U=null,this.ea=!1,this.a=[])},I.$a=function(){this.U=null,this.ea&&(this.ea=!1,he(this))},F(ce,B);var le=[];function fe(t,e,n,i){D(n)||(n&&(le[0]=n.toString()),n=le);for(var r=0;r<n.length;r++){var o=Mt(e,n[r],i||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function pe(t){et(t.a,function(t,e){this.a.hasOwnProperty(e)&&xt(t)},t),t.a={}}function de(){}ce.prototype.G=function(){ce.N.G.call(this),pe(this)},ce.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ye=new zt;function ve(t){Tt.call(this,"serverreachability",t)}function ge(){ye.dispatchEvent(new ve(ye))}function me(t){Tt.call(this,"statevent",t)}function we(){ye.dispatchEvent(new me(ye))}function be(t){Tt.call(this,"timingevent",t)}function Ee(t,e){if("function"!=L(t))throw Error("Fn must not be null and must be a function");return _.setTimeout(function(){t()},e)}F(ve,Tt),F(me,Tt),F(be,Tt);var Ae={NO_ERROR:0,hb:1,ob:2,nb:3,kb:4,mb:5,pb:6,La:7,TIMEOUT:8,sb:9},Ie={jb:"complete",wb:"success",Ma:"error",La:"abort",ub:"ready",vb:"readystatechange",TIMEOUT:"timeout",qb:"incrementaldata",tb:"progress",lb:"downloadprogress",xb:"uploadprogress"};function Ne(){}function Te(t){var e;return(e=t.a)||(e=t.a={}),e}function _e(){}Ne.prototype.a=null;var Se,ke={OPEN:"a",ib:"b",Ma:"c",rb:"d"};function Re(){Tt.call(this,"d")}function Oe(){Tt.call(this,"c")}function Le(){}function De(t,e,n){this.g=t,this.W=e,this.V=n||1,this.I=new ce(this),this.O=Ce,t=lt?125:void 0,this.P=new oe(t),this.h=null,this.b=!1,this.l=this.D=this.f=this.F=this.v=this.R=this.i=null,this.j=[],this.a=null,this.A=0,this.c=this.w=null,this.o=-1,this.m=!1,this.J=0,this.B=null,this.s=this.S=this.H=!1}F(Re,Tt),F(Oe,Tt),F(Le,Ne),Se=new Le;var Ce=45e3,Ve={},Ue={};function Pe(t,e,n){t.F=1,t.f=un($e(e)),t.l=n,t.H=!0,qe(t,null)}function Me(t,e,n,i){t.F=1,t.f=un($e(e)),t.l=null,t.H=n,qe(t,i)}function qe(t,e){t.v=j(),Ge(t),t.D=$e(t.f),sn(t.D,"t",t.V),t.A=0,t.a=t.g.$(t.g.Y()?e:null),0<t.J&&(t.B=new ae(x(t.Ja,t,t.a),t.J)),fe(t.I,t.a,"readystatechange",t.cb),e=t.h?nt(t.h):{},t.l?(t.w||(t.w="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ca(t.D,t.w,t.l,e)):(t.w="GET",t.a.ca(t.D,t.w,null,e)),ge()}function xe(t,e,n){for(var i=!0;!t.m&&t.A<n.length;){var r=(s=n,a=u=void 0,u=(o=t).A,-1==(a=s.indexOf("\n",u))?Ue:(u=Number(s.substring(u,a)),isNaN(u)?Ve:(a+=1)+u>s.length?Ue:(s=s.substr(a,u),o.A=a+u,s)));if(r==Ue){4==e&&(t.c=4,we(),i=!1);break}if(r==Ve){t.c=4,we(),i=!1;break}Ye(t,r)}var o,s,u,a;4==e&&0==n.length&&(t.c=1,we(),i=!1),t.b=t.b&&i,i||(He(t),Be(t))}function Ge(t){t.R=j()+t.O,je(t,t.O)}function je(t,e){if(null!=t.i)throw Error("WatchDog timer not null");t.i=Ee(x(t.ab,t),e)}function Fe(t){t.i&&(_.clearTimeout(t.i),t.i=null)}function Be(t){t.g.Ca()||t.m||t.g.na(t)}function He(t){Fe(t);var e=t.B;e&&"function"==typeof e.la&&e.la(),t.B=null,se(t.P),pe(t.I),t.a&&(e=t.a,t.a=null,e.abort(),e.la())}function Ye(t,e){try{t.g.Fa(t,e),ge()}catch(t){}}function ze(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(C(t)||S(t))Y(t,e,void 0);else{if(t.K&&"function"==typeof t.K)var n=t.K();else if(t.C&&"function"==typeof t.C)n=void 0;else if(C(t)||S(t)){n=[];for(var i=t.length,r=0;r<i;r++)n.push(r)}else for(r in n=[],i=0,t)n[i++]=r;r=(i=function(t){if(t.C&&"function"==typeof t.C)return t.C();if(S(t))return t.split("");if(C(t)){for(var e=[],n=t.length,i=0;i<n;i++)e.push(t[i]);return e}for(i in e=[],n=0,t)e[n++]=t[i];return e}(t)).length;for(var o=0;o<r;o++)e.call(void 0,i[o],n&&n[o],t)}}function Qe(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var i=0;i<n;i+=2)this.set(arguments[i],arguments[i+1])}else if(t)if(t instanceof Qe)for(n=t.K(),i=0;i<n.length;i++)this.set(n[i],t.get(n[i]));else for(i in t)this.set(i,t[i])}function We(t,e){Je(t.b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Xe(t))}function Xe(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var i=t.a[e];Je(t.b,i)&&(t.a[n++]=i),e++}t.a.length=n}if(t.c!=t.a.length){var r={};for(n=e=0;e<t.a.length;)Je(r,i=t.a[e])||(r[t.a[n++]=i]=1),e++;t.a.length=n}}function Je(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(I=De.prototype).setTimeout=function(t){this.O=t},I.cb=function(t){t=t.target;var e=this.B;e&&3==$n(t)?e.Ta():this.Ja(t)},I.Ja=function(t){try{if(t==this.a)t:{var e=$n(this.a),n=this.a.ya();this.a.T();if(!(e<3||3==e&&!lt&&!this.a.aa())){this.m||4!=e||7==n||ge(),Fe(this);var i=this.a.T();this.o=i;var r=this.a.aa();if(this.b=200==i){if(this.S&&!this.s){e:{if(this.a){var o=ti(this.a,"X-HTTP-Initial-Response");if(o&&!W(o)){var s=o;break e}}s=null}if(!s){this.b=!1,this.c=3,we(),He(this),Be(this);break t}this.s=!0,Ye(this,s)}this.H?(xe(this,e,r),lt&&this.b&&3==e&&(fe(this.I,this.P,"tick",this.bb),this.P.start())):Ye(this,r),4==e&&He(this),this.b&&!this.m&&(4==e?this.g.na(this):(this.b=!1,Ge(this)))}else 400==i&&0<r.indexOf("Unknown SID")?this.c=3:this.c=0,we(),He(this),Be(this)}}}catch(t){}},I.bb=function(){if(this.a){var t=$n(this.a),e=this.a.aa();this.A<e.length&&(Fe(this),xe(this,t,e),this.b&&4!=t&&Ge(this))}},I.cancel=function(){this.m=!0,He(this)},I.ab=function(){this.i=null;var t=j();0<=t-this.R?(2!=this.F&&(ge(),we()),He(this),this.c=2,Be(this)):je(this,this.R-t)},(I=Qe.prototype).C=function(){Xe(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},I.K=function(){return Xe(this),this.a.concat()},I.get=function(t,e){return Je(this.b,t)?this.b[t]:e},I.set=function(t,e){Je(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},I.forEach=function(t,e){for(var n=this.K(),i=0;i<n.length;i++){var r=n[i],o=this.get(r);t.call(e,o,r,this)}};var Ke=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Ze(t,e){var n;this.b=this.j=this.f="",this.i=null,this.g=this.a="",this.h=!1,t instanceof Ze?(this.h=void 0!==e?e:t.h,tn(this,t.f),this.j=t.j,en(this,t.b),nn(this,t.i),this.a=t.a,rn(this,En(t.c)),this.g=t.g):t&&(n=String(t).match(Ke))?(this.h=!!e,tn(this,n[1]||"",!0),this.j=an(n[2]||""),en(this,n[3]||"",!0),nn(this,n[4]),this.a=an(n[5]||"",!0),rn(this,n[6]||"",!0),this.g=an(n[7]||"")):(this.h=!!e,this.c=new vn(null,this.h))}function $e(t){return new Ze(t)}function tn(t,e,n){t.f=n?an(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function en(t,e,n){t.b=n?an(e,!0):e}function nn(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.i=e}else t.i=null}function rn(t,e,n){var i,r;e instanceof vn?(t.c=e,i=t.c,(r=t.h)&&!i.f&&(gn(i),i.c=null,i.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(mn(this,e),bn(this,n,t))},i)),i.f=r):(n||(e=hn(e,dn)),t.c=new vn(e,t.h))}function on(t,e,n){t.c.set(e,n)}function sn(t,e,n){D(n)||(n=[String(n)]),bn(t.c,e,n)}function un(t){return on(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^j()).toString(36)),t}function an(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function hn(t,e,n){return S(t)?(t=encodeURI(t).replace(e,cn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function cn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Ze.prototype.toString=function(){var t=[],e=this.f;e&&t.push(hn(e,ln,!0),":");var n=this.b;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(hn(e,ln,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.i)&&t.push(":",String(n))),(n=this.a)&&(this.b&&"/"!=n.charAt(0)&&t.push("/"),t.push(hn(n,"/"==n.charAt(0)?pn:fn,!0))),(n=this.c.toString())&&t.push("?",n),(n=this.g)&&t.push("#",hn(n,yn)),t.join("")},Ze.prototype.resolve=function(t){var e=$e(this),n=!!t.f;n?tn(e,t.f):n=!!t.j,n?e.j=t.j:n=!!t.b,n?en(e,t.b):n=null!=t.i;var i=t.a;if(n)nn(e,t.i);else if(n=!!t.a){if("/"!=i.charAt(0))if(this.b&&!this.a)i="/"+i;else{var r=e.a.lastIndexOf("/");-1!=r&&(i=e.a.substr(0,r+1)+i)}if(".."==(r=i)||"."==r)i="";else if(K(r,"./")||K(r,"/.")){i=0==r.lastIndexOf("/",0),r=r.split("/");for(var o=[],s=0;s<r.length;){var u=r[s++];"."==u?i&&s==r.length&&o.push(""):".."==u?((1<o.length||1==o.length&&""!=o[0])&&o.pop(),i&&s==r.length&&o.push("")):(o.push(u),i=!0)}i=o.join("/")}else i=r}return n?e.a=i:n=""!==t.c.toString(),n?rn(e,En(t.c)):n=!!t.g,n&&(e.g=t.g),e};var ln=/[#\/\?@]/g,fn=/[#\?:]/g,pn=/[#\?]/g,dn=/[#\?@]/g,yn=/#/g;function vn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function gn(u){u.a||(u.a=new Qe,u.b=0,u.c&&function(t){if(t){t=t.split("&");for(var e=0;e<t.length;e++){var n=t[e].indexOf("="),i=null;if(0<=n){var r=t[e].substring(0,n);i=t[e].substring(n+1)}else r=t[e];o=r,s=i?decodeURIComponent(i.replace(/\+/g," ")):"",u.add(decodeURIComponent(o.replace(/\+/g," ")),s)}}var o,s}(u.c))}function mn(t,e){gn(t),e=An(t,e),Je(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,We(t.a,e))}function wn(t,e){return gn(t),e=An(t,e),Je(t.a.b,e)}function bn(t,e,n){mn(t,e),0<n.length&&(t.c=null,t.a.set(An(t,e),Q(n)),t.b+=n.length)}function En(t){var e=new vn;return e.c=t.c,t.a&&(e.a=new Qe(t.a),e.b=t.b),e}function An(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function In(t){this.a=t,this.b=this.h=null,this.g=!1,this.i=null,this.c=-1,this.l=this.f=null}function Nn(t){var e=t.a.F.a;if(null!=e)we(),e?(we(),fi(t.a,t,!1)):(we(),fi(t.a,t,!0));else{t.b=new De(t,void 0,void 0),t.b.h=t.h,e=gi(e=t.a,e.Y()?t.f:null,t.i),we(),sn(e,"TYPE","xmlhttp");var n=t.a.j,i=t.a.I;n&&i&&on(e,n,i),Me(t.b,e,!1,t.f)}}function Tn(){this.a=this.b=null}function _n(){this.a=new Qe}function Sn(t){var e=typeof t;return"object"==e&&t||"function"==e?"o"+(t[U]||(t[U]=++P)):e.charAt(0)+t}function kn(t,e){this.b=t,this.a=e}function Rn(t){this.g=t||On,t=_.PerformanceNavigationTiming?0<(t=_.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(_.ka&&_.ka.Da&&_.ka.Da()&&_.ka.Da().zb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new _n),this.b=null,this.c=[]}(I=vn.prototype).add=function(t,e){gn(this),this.c=null,t=An(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},I.forEach=function(n,i){gn(this),this.a.forEach(function(t,e){Y(t,function(t){n.call(i,t,e,this)},this)},this)},I.K=function(){gn(this);for(var t=this.a.C(),e=this.a.K(),n=[],i=0;i<e.length;i++)for(var r=t[i],o=0;o<r.length;o++)n.push(e[i]);return n},I.C=function(t){gn(this);var e=[];if(S(t))wn(this,t)&&(e=z(e,this.a.get(An(this,t))));else{t=this.a.C();for(var n=0;n<t.length;n++)e=z(e,t[n])}return e},I.set=function(t,e){return gn(this),this.c=null,wn(this,t=An(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},I.get=function(t,e){return t&&0<(t=this.C(t)).length?String(t[0]):e},I.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.K(),n=0;n<e.length;n++){var i=e[n],r=encodeURIComponent(String(i));i=this.C(i);for(var o=0;o<i.length;o++){var s=r;""!==i[o]&&(s+="="+encodeURIComponent(String(i[o]))),t.push(s)}}return this.c=t.join("&")},F(function(){},function(){}),(I=In.prototype).M=null,I.$=function(t){return this.a.$(t)},I.abort=function(){this.b&&(this.b.cancel(),this.b=null),this.c=-1},I.Ca=function(){return!1},I.Fa=function(t,e){if(this.c=t.o,0==this.M){if(!this.a.o&&(t=t.a)){var n=ti(t,"X-Client-Wire-Protocol");this.l=n||null,this.a.j&&(t=ti(t,"X-HTTP-Session-Id"))&&(this.a.I=t)}if(e){try{var i=this.a.ja.a.parse(e)}catch(t){return(e=this.a).m=this.c,void yi(e,2)}this.f=i[0]}else(e=this.a).m=this.c,yi(e,2)}else 1==this.M&&(this.g?we():"11111"==e?(we(),this.g=!0,(!ht||10<=Number(mt))&&(this.c=200,this.b.cancel(),we(),fi(this.a,this,!0))):(we(),this.g=!1))},I.na=function(){if(this.c=this.b.o,this.b.b)0==this.M?(this.M=1,Nn(this)):1==this.M&&(this.g?(we(),fi(this.a,this,!0)):(we(),fi(this.a,this,!1)));else{0!=this.M&&1!=this.M||we();var t=this.a;t.m=this.c,yi(t,2)}},I.Y=function(){return this.a.Y()},I.ma=function(){return this.a.ma()},_n.prototype.add=function(t){this.a.set(Sn(t),t)},_n.prototype.C=function(){return this.a.C()};var On=10;function Ln(t,e){!t.a&&(K(e,"spdy")||K(e,"quic")||K(e,"h2"))&&(t.f=t.g,t.a=new _n,t.b&&(Un(t,t.b),t.b=null))}function Dn(t){return t.b||t.a&&t.a.a.c>=t.f}function Cn(t){return t.b?1:t.a?t.a.a.c:0}function Vn(t,e){return t.b?t.b==e:!!t.a&&(e=Sn(e),Je(t.a.a.b,e))}function Un(t,e){t.a?t.a.add(e):t.b=e}function Pn(t,e){var n;t.b&&t.b==e?t.b=null:((n=t.a)&&(n=Sn(e),n=Je(t.a.a.b,n)),n&&We(t.a.a,Sn(e)))}function Mn(t){if(null!=t.b)return t.c.concat(t.b.j);if(null==t.a||0==t.a.a.c)return Q(t.c);var e=t.c;return Y(t.a.C(),function(t){e=e.concat(t.j)}),e}function qn(){}function xn(){this.a=new qn}function Gn(t,i,e){var r=e||"";try{ze(t,function(t,e){var n=t;V(t)&&(n=Wt(t)),i.push(r+e+"="+encodeURIComponent(n))})}catch(t){throw i.push(r+"type="+encodeURIComponent("_badmap")),t}}function jn(t,e,n,i,r){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,r(i)}catch(t){}}Rn.prototype.cancel=function(){var t;this.c=Mn(this),this.b?(this.b.cancel(),this.b=null):this.a&&0!=this.a.a.c&&(Y(this.a.C(),function(t){t.cancel()}),(t=this.a.a).b={},t.a.length=0,t.c=0)},qn.prototype.stringify=function(t){return _.JSON.stringify(t,void 0)},qn.prototype.parse=function(t){return _.JSON.parse(t,void 0)};var Fn=_.JSON.parse;function Bn(t){zt.call(this),this.headers=new Qe,this.H=t||null,this.b=!1,this.s=this.a=null,this.A="",this.h=0,this.f="",this.g=this.w=this.l=this.v=!1,this.o=0,this.m=null,this.I=Hn,this.D=this.F=!1}F(Bn,zt);var Hn="",Yn=/^https?$/i,zn=["POST","PUT"];function Qn(t){return"content-type"==t.toLowerCase()}function Wn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Xn(t),Kn(t)}function Xn(t){t.v||(t.v=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function Jn(t){if(t.b&&void 0!==T&&(!t.s[1]||4!=$n(t)||2!=t.T()))if(t.l&&4==$n(t))ue(t.Ea,0,t);else if(t.dispatchEvent("readystatechange"),4==$n(t)){t.b=!1;try{var e,n=t.T();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var i=!0;break t;default:i=!1}if(!(e=i)){var r;if(r=0===n){var o=String(t.A).match(Ke)[1]||null;if(!o&&_.self&&_.self.location){var s=_.self.location.protocol;o=s.substr(0,s.length-1)}r=!Yn.test(o?o.toLowerCase():"")}e=r}if(e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{t.h=6;try{var u=2<$n(t)?t.a.statusText:""}catch(t){u=""}t.f=u+" ["+t.T()+"]",Xn(t)}}finally{Kn(t)}}}function Kn(t,e){if(t.a){Zn(t);var n=t.a,i=t.s[0]?O:null;t.a=null,t.s=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=i}catch(t){}}}function Zn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(_.clearTimeout(t.m),t.m=null)}function $n(t){return t.a?t.a.readyState:0}function ti(t,e){return t.a?t.a.getResponseHeader(e):null}function ei(t,e,n){t:{for(i in n){var i=!1;break t}i=!0}if(i)return t;var r;if(r="",et(n,function(t,e){r+=e,r+=":",r+=t,r+="\r\n"}),n=r,S(t)){if(e=encodeURIComponent(String(e)),e+=n=null!=n?"="+encodeURIComponent(String(n)):""){if((n=t.indexOf("#"))<0&&(n=t.length),(i=t.indexOf("?"))<0||n<i){i=n;var o=""}else o=t.substring(i+1,n);n=(t=[t.substr(0,i),o,t.substr(n)])[1],t[1]=e?n?n+"&"+e:e:n,t=t[0]+(t[1]?"?"+t[1]:"")+t[2]}return t}return on(t,e,n),t}function ni(t){this.f=[],this.F=new Tn,this.ga=this.pa=this.B=this.ha=this.a=this.I=this.j=this.V=this.g=this.J=this.i=null,this.Qa=this.P=0,this.Oa=!!R("internalChannelParams.failFast",t),this.ia=this.w=this.s=this.l=this.h=this.c=null,this.oa=!0,this.m=this.ra=this.O=-1,this.S=this.v=this.A=0,this.Na=R("internalChannelParams.baseRetryDelayMs",t)||5e3,this.Ra=R("internalChannelParams.retryDelaySeedMs",t)||1e4,this.Pa=R("internalChannelParams.forwardChannelMaxRetries",t)||2,this.qa=R("internalChannelParams.forwardChannelRequestTimeoutMs",t)||2e4,this.Ka=t&&t.Ab||void 0,this.D=void 0,this.R=t&&t.supportsCrossDomainXhr||!1,this.H="",this.b=new Rn(t&&t.concurrentRequestLimit),this.ja=new xn,this.o=!t||void 0===t.backgroundChannelTest||t.backgroundChannelTest,(this.W=t&&t.fastHandshake||!1)&&!this.o&&(this.o=!0),t&&t.forceLongPolling&&(this.oa=!1),this.fa=void 0}function ii(t){if(ri(t),3==t.u){var e=t.P++,n=$e(t.B);on(n,"SID",t.H),on(n,"RID",e),on(n,"TYPE","terminate"),ai(t,n),(e=new De(t,e,void 0)).F=2,e.f=un($e(n)),n=!1,_.navigator&&_.navigator.sendBeacon&&(n=_.navigator.sendBeacon(e.f.toString(),"")),!n&&_.Image&&((new Image).src=e.f,n=!0),n||(e.a=e.g.$(null),e.a.ca(e.f)),e.v=j(),Ge(e)}vi(t)}function ri(t){t.w&&(t.w.abort(),t.w=null),t.a&&(t.a.cancel(),t.a=null),t.l&&(_.clearTimeout(t.l),t.l=null),pi(t),t.b.cancel(),t.h&&(k(t.h)&&_.clearTimeout(t.h),t.h=null)}function oi(t,e){t.f.push(new kn(t.Qa++,e)),3==t.u&&si(t)}function si(t){Dn(t.b)||t.h||(t.h=!0,ee(t.Ha,t),t.A=0)}function ui(t,e){var n;n=e?e.W:t.P++;var i=$e(t.B);on(i,"SID",t.H),on(i,"RID",n),on(i,"AID",t.O),ai(t,i),t.g&&t.i&&ei(i,t.g,t.i),n=new De(t,n,t.A+1),null===t.g&&(n.h=t.i),e&&(t.f=e.j.concat(t.f)),e=hi(t,n,1e3),n.setTimeout(Math.round(.5*t.qa)+Math.round(.5*t.qa*Math.random())),Un(t.b,n),Pe(n,i,e)}function ai(t,n){t.c&&ze({},function(t,e){on(n,e,t)})}function hi(t,e,n){n=Math.min(t.f.length,n);var i=t.c?x(t.c.Sa,t.c,t):null;t:for(var r=t.f,o=-1;;){var s=["count="+n];-1==o?0<n?(o=r[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var h=r[a].b,c=r[a].a;if((h-=o)<0)o=Math.max(0,r[a].b-100),u=!1;else try{Gn(c,s,"req"+h+"_")}catch(t){i&&i(c)}}if(u){i=s.join("&");break t}}return t=t.f.splice(0,n),e.j=t,i}function ci(t){t.a||t.l||(t.S=1,ee(t.Ga,t),t.v=0)}function li(t){return!(t.a||t.l||3<=t.v)&&(t.S++,t.l=Ee(x(t.Ga,t),di(t,t.v)),t.v++,1)}function fi(t,e,n){var i=e.l;i&&Ln(t.b,i),t.ia=t.oa&&n,t.m=e.c,t.B=gi(t,null,t.ha),si(t)}function pi(t){null!=t.s&&(_.clearTimeout(t.s),t.s=null)}function di(t,e){var n=t.Na+Math.floor(Math.random()*t.Ra);return t.ma()||(n*=2),n*e}function yi(t,e){if(2==e){var n=null;t.c&&(n=null);var i=x(t.eb,t);n||(n=new Ze("//www.google.com/images/cleardot.gif"),_.location&&"http"==_.location.protocol||tn(n,"https"),un(n)),function(t,e){var n=new de;if(_.Image){var i=new Image;i.onload=G(jn,n,i,"TestLoadImage: loaded",!0,e),i.onerror=G(jn,n,i,"TestLoadImage: error",!1,e),i.onabort=G(jn,n,i,"TestLoadImage: abort",!1,e),i.ontimeout=G(jn,n,i,"TestLoadImage: timeout",!1,e),_.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=t}else e(!1)}(n.toString(),i)}else we();t.u=0,t.c&&t.c.ta(e),vi(t),ri(t)}function vi(t){t.u=0,t.m=-1,t.c&&(0==Mn(t.b).length&&0==t.f.length||(t.b.c.length=0,Q(t.f),t.f.length=0),t.c.sa())}function gi(t,e,n){var i,r,o,s,u,a,h=(i=n)instanceof Ze?$e(i):new Ze(i,void 0);if(""!=h.b)e&&en(h,e+"."+h.b),nn(h,h.i);else{var c,l=_.location;c=e?e+"."+l.hostname:l.hostname,r=l.protocol,o=c,s=+l.port,u=n,a=new Ze(null,void 0),r&&tn(a,r),o&&en(a,o),s&&nn(a,s),u&&(a.a=u),h=a}return t.V&&et(t.V,function(t,e){on(h,e,t)}),e=t.j,n=t.I,e&&n&&on(h,e,n),on(h,"VER",t.wa),ai(t,h),h}function mi(){}function wi(){if(ht&&!(10<=Number(mt)))throw Error("Environmental error: no available transport.")}function bi(t,e){zt.call(this),this.a=new ni(e),this.g=t,this.m=e&&e.fb?e.fb:function(t){for(var e=t,n=1;n<arguments.length;n++){var i,r=arguments[n];0==r.lastIndexOf("/",0)?e=r:((i=""==e)||(i=0<=(i=e.length-1)&&e.indexOf("/",i)==i),e+=i?r:"/"+r)}return e}(this.g,"test"),this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.i=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.xa&&(t?t["X-WebChannel-Client-Profile"]=e.xa:t={"X-WebChannel-Client-Profile":e.xa}),this.a.J=t,(t=e&&e.httpHeadersOverwriteParam)&&!W(t)&&(this.a.g=t),this.l=e&&e.supportsCrossDomainXhr||!1,this.h=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!W(e)&&(this.a.j=e,null!==(t=this.b)&&e in t&&e in(t=this.b)&&delete t[e]),this.f=new Ii(this)}function Ei(t){Re.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function Ai(){Oe.call(this),this.status=1}function Ii(t){this.a=t}(I=Bn.prototype).ca=function(t,e,n,i){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.A+"; newUri="+t);e=e?e.toUpperCase():"GET",this.A=t,this.f="",this.h=0,this.v=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?Te(this.H):Te(Se),this.a.onreadystatechange=x(this.Ea,this);try{this.w=!0,this.a.open(e,String(t),!0),this.w=!1}catch(t){return void Wn(this,t)}t=n||"";var r,o=new Qe(this.headers);i&&ze(i,function(t,e){o.set(e,t)}),i=function(t){t:{for(var e=Qn,n=t.length,i=S(t)?t.split(""):t,r=0;r<n;r++)if(r in i&&e.call(void 0,i[r],r,t)){e=r;break t}e=-1}return e<0?null:S(t)?t.charAt(e):t[e]}(o.K()),n=_.FormData&&t instanceof _.FormData,0<=H(zn,e)&&!i&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Zn(this),0<this.o&&((this.D=(r=this.a,ht&&bt(9)&&k(r.timeout)&&void 0!==r.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=x(this.Ba,this)):this.m=ue(this.Ba,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){Wn(this,t)}},I.Ba=function(){void 0!==T&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},I.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Kn(this))},I.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Kn(this,!0)),Bn.N.G.call(this)},I.Ea=function(){this.j||(this.w||this.l||this.g?Jn(this):this.Za())},I.Za=function(){Jn(this)},I.T=function(){try{return 2<$n(this)?this.a.status:-1}catch(t){return-1}},I.aa=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},I.Ua=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Fn(e)}},I.ya=function(){return this.h},I.Xa=function(){return S(this.f)?this.f:String(this.f)},(I=ni.prototype).wa=8,I.u=1,I.Ca=function(){return 0==this.u},I.Ha=function(t){if(this.h)if(this.h=null,1==this.u){if(!t){this.P=Math.floor(1e5*Math.random()),t=this.P++;var e,n=new De(this,t,void 0),i=this.i;if(this.J&&(i?rt(i=nt(i),this.J):i=this.J),null===this.g&&(n.h=i),this.W)t:{for(var r=e=0;r<this.f.length;r++){var o=this.f[r];if(void 0===(o="__data__"in o.a&&S(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=r;break t}if(4096===e||r===this.f.length-1){e=r+1;break t}}e=1e3}else e=1e3;e=hi(this,n,e),on(r=$e(this.B),"RID",t),on(r,"CVER",22),this.o&&this.j&&on(r,"X-HTTP-Session-Id",this.j),ai(this,r),this.g&&i&&ei(r,this.g,i),Un(this.b,n),this.W?(on(r,"$req",e),on(r,"SID","null"),n.S=!0,Pe(n,r,null)):Pe(n,r,e),this.u=2}}else 3==this.u&&(t?ui(this,t):0==this.f.length||Dn(this.b)||ui(this))},I.Ga=function(){this.l=null,this.a=new De(this,"rpc",this.S),null===this.g&&(this.a.h=this.i),this.a.J=0;var t=$e(this.pa);on(t,"RID","rpc"),on(t,"SID",this.H),on(t,"CI",this.ia?"0":"1"),on(t,"AID",this.O),ai(this,t),on(t,"TYPE","xmlhttp"),this.g&&this.i&&ei(t,this.g,this.i),this.D&&this.a.setTimeout(this.D),Me(this.a,t,!0,this.ga)},I.Fa=function(t,e){if(0!=this.u&&(this.a==t||Vn(this.b,t)))if(this.m=t.o,!t.s&&Vn(this.b,t)&&3==this.u){try{var n=this.ja.a.parse(e)}catch(t){n=null}if(D(n)&&3==n.length){if(0==(e=n)[0]){t:if(!this.l){if(this.a){if(!(this.a.v+3e3<t.v))break t;pi(this),this.a.cancel(),this.a=null}li(this),we()}}else this.ra=e[1],0<this.ra-this.O&&e[2]<37500&&this.ia&&0==this.v&&!this.s&&(this.s=Ee(x(this.Ya,this),6e3));if(Cn(this.b)<=1&&this.fa){try{this.fa()}catch(t){}this.fa=void 0}}else yi(this,11)}else if(!t.s&&this.a!=t||pi(this),!W(e))for(e=n=this.ja.a.parse(e),n=0;n<e.length;n++){var i=e[n];if(this.O=i[0],i=i[1],2==this.u)if("c"==i[0]){this.H=i[1],this.ga=i[2];var r=i[3];null!=r&&(this.wa=r),null!=(i=i[5])&&k(i)&&0<i&&(this.D=1.5*i),this.o&&(i=t.a)&&((r=ti(i,"X-Client-Wire-Protocol"))&&Ln(this.b,r),this.j&&(i=ti(i,"X-HTTP-Session-Id")))&&(this.I=i,on(this.B,this.j,i)),this.u=3,this.c&&this.c.va(),i=t,this.pa=gi(this,this.Y()?this.ga:null,this.ha),i.s?(Pn(this.b,i),(r=this.D)&&i.setTimeout(r),i.i&&(Fe(i),Ge(i)),this.a=i):ci(this),0<this.f.length&&si(this)}else"stop"!=i[0]&&"close"!=i[0]||yi(this,7);else 3==this.u&&("stop"==i[0]||"close"==i[0]?"stop"==i[0]?yi(this,7):ii(this):"noop"!=i[0]&&this.c&&this.c.ua(i),this.v=0)}},I.Ya=function(){null!=this.s&&(this.s=null,this.a.cancel(),this.a=null,li(this),we())},I.na=function(t){var e=null;if(this.a==t){pi(this),this.a=null;var n=2}else{if(!Vn(this.b,t))return;e=t.j,Pn(this.b,t),n=1}if(this.m=t.o,0!=this.u)if(t.b)1==n?(e=j()-t.v,ye.dispatchEvent(new be(ye,t.l&&t.l.length,this.A)),si(this)):ci(this);else{var i=t.c;if(3==i||0==i&&0<this.m||!(1==n&&function(t,e){if(!(Cn(t.b)>=t.b.f-(t.h?1:0))){if(t.h)return t.f=e.j.concat(t.f),1;if(!(1==t.u||2==t.u||t.A>=(t.Oa?0:t.Pa)))return t.h=Ee(x(t.Ha,t,e),di(t,t.A)),t.A++,1}}(this,t)||2==n&&li(this)))switch(e&&0<e.length&&(t=this.b,t.c=t.c.concat(e)),i){case 1:yi(this,5);break;case 4:yi(this,10);break;case 3:yi(this,6);break;default:yi(this,2)}}},I.eb=function(t){we()},I.$=function(t){if(t&&!this.R)throw Error("Can't create secondary domain capable XhrIo object.");return(t=new Bn(this.Ka)).F=this.R,t},I.ma=function(){return!!this.c&&!0},I.Y=function(){return this.R},(I=mi.prototype).va=function(){},I.ua=function(){},I.ta=function(){},I.sa=function(){},I.Sa=function(){},wi.prototype.a=function(t,e){return new bi(t,e)},F(bi,zt),(I=bi.prototype).addEventListener=function(t,e,n,i){bi.N.addEventListener.call(this,t,e,n,i)},I.removeEventListener=function(t,e,n,i){bi.N.removeEventListener.call(this,t,e,n,i)},I.Va=function(){this.a.c=this.f,this.l&&(this.a.R=!0);var t=this.a,e=this.m,n=this.g,i=this.b||void 0;we(),t.ha=n,t.V=i||{},t.o&&(t.F.b=[],t.F.a=!1),t.w=new In(t),null===t.g&&(t.w.h=t.i),n=e,t.g&&t.i&&(n=ei(e,t.g,t.i)),(t=t.w).i=n,e=gi(t.a,null,t.i),we(),null!=(n=t.a.F.b)?(t.f=n[0],t.M=1,Nn(t)):(sn(e,"MODE","init"),!t.a.o&&t.a.j&&sn(e,"X-HTTP-Session-Id",t.a.j),t.b=new De(t,void 0,void 0),t.b.h=t.h,Me(t.b,e,!1,null),t.M=0)},I.close=function(){ii(this.a)},I.Wa=function(t){if(S(t)){var e={};e.__data__=t,oi(this.a,e)}else this.h?((e={}).__data__=Wt(t),oi(this.a,e)):oi(this.a,t)},I.G=function(){this.a.c=null,delete this.f,ii(this.a),delete this.a,bi.N.G.call(this)},F(Ei,Re),F(Ai,Oe),F(Ii,mi),Ii.prototype.va=function(){this.a.dispatchEvent("a")},Ii.prototype.ua=function(t){this.a.dispatchEvent(new Ei(t))},Ii.prototype.ta=function(t){this.a.dispatchEvent(new Ai)},Ii.prototype.sa=function(){this.a.dispatchEvent("b")};var Ni=G(function(t,e){function n(){}n.prototype=t.prototype;var i=new n;return t.apply(i,Array.prototype.slice.call(arguments,1)),i},wi);wi.prototype.createWebChannel=wi.prototype.a,bi.prototype.send=bi.prototype.Wa,bi.prototype.open=bi.prototype.Va,bi.prototype.close=bi.prototype.close,Ae.NO_ERROR=0,Ae.TIMEOUT=8,Ae.HTTP_ERROR=6,Ie.COMPLETE="complete",(_e.EventType=ke).OPEN="a",ke.CLOSE="b",ke.ERROR="c",ke.MESSAGE="d",zt.prototype.listen=zt.prototype.za,Bn.prototype.listenOnce=Bn.prototype.Aa,Bn.prototype.getLastError=Bn.prototype.Xa,Bn.prototype.getLastErrorCode=Bn.prototype.ya,Bn.prototype.getStatus=Bn.prototype.T,Bn.prototype.getResponseJson=Bn.prototype.Ua,Bn.prototype.getResponseText=Bn.prototype.aa,Bn.prototype.send=Bn.prototype.ca;var Ti={createWebChannelTransport:Ni,ErrorCode:Ae,EventType:Ie,WebChannel:_e,XhrIo:Bn},_i=Ti.createWebChannelTransport,Si=Ti.ErrorCode,ki=Ti.EventType,Ri=Ti.WebChannel,Oi=Ti.XhrIo,Li=Al.SDK_VERSION,Di=(Ci.prototype.t=function(){return null!=this.uid},Ci.prototype.s=function(){return this.t()?"uid:"+this.uid:"anonymous-user"},Ci.prototype.isEqual=function(t){return t.uid===this.uid},Ci);function Ci(t){this.uid=t}function Vi(t,e){this.user=e,this.type="OAuth",this.o={},this.o.Authorization="Bearer "+t}Di.UNAUTHENTICATED=new Di(null),Di.i=new Di("google-credentials-uid"),Di.h=new Di("first-party-uid");var Ui,Pi={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Mi=(n(Ji,Ui=Error),Ji),qi=(Xi.prototype.getToken=function(){return Promise.resolve(null)},Xi.prototype.l=function(){},Xi.prototype._=function(t){(this.u=t)(Di.UNAUTHENTICATED)},Xi.prototype.T=function(){this.u=null},Xi),xi=(Wi.prototype.getToken=function(){var e=this,n=this.I,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){if(e.I!==n)throw new Mi(Pi.ABORTED,"getToken aborted due to token change.");return t?(vu("string"==typeof t.accessToken,"Invalid tokenData returned from getToken():"+t),new Vi(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},Wi.prototype.l=function(){this.forceRefresh=!0},Wi.prototype._=function(t){this.u=t,this.R&&t(this.currentUser)},Wi.prototype.T=function(){this.auth&&this.auth.removeAuthTokenListener(this.m),this.m=null,this.u=null},Wi.prototype.A=function(){var t=this.auth&&this.auth.getUid();return vu(null===t||"string"==typeof t,"Received invalid UID: "+t),new Di(t)},Wi),Gi=(Object.defineProperty(Qi.prototype,"o",{get:function(){var t={"X-Goog-AuthUser":this.V},e=this.P.auth.p([]);return e&&(t.Authorization=e),t},enumerable:!0,configurable:!0}),Qi),ji=(zi.prototype.getToken=function(){return Promise.resolve(new Gi(this.P,this.V))},zi.prototype._=function(t){t(Di.h)},zi.prototype.T=function(){},zi.prototype.l=function(){},zi),Fi=(Yi.now=function(){return Yi.fromMillis(Date.now())},Yi.fromDate=function(t){return Yi.fromMillis(t.getTime())},Yi.fromMillis=function(t){var e=Math.floor(t/1e3);return new Yi(e,1e6*(t-1e3*e))},Yi.prototype.toDate=function(){return new Date(this.toMillis())},Yi.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},Yi.prototype.g=function(t){return this.seconds===t.seconds?wu(this.nanoseconds,t.nanoseconds):wu(this.seconds,t.seconds)},Yi.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},Yi.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},Yi.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},Yi),Bi=(Hi.v=function(t){return new Hi(t)},Hi.S=function(){return Hi.MIN},Hi.prototype.C=function(t){return this.timestamp.g(t.timestamp)},Hi.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},Hi.prototype.D=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},Hi.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},Hi.prototype.F=function(){return this.timestamp},Hi);function Hi(t){this.timestamp=t}function Yi(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new Mi(Pi.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new Mi(Pi.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Mi(Pi.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new Mi(Pi.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function zi(t,e){this.P=t,this.V=e}function Qi(t,e){this.P=t,this.V=e,this.type="FirstParty",this.user=Di.h}function Wi(t){var e=this;this.m=null,this.currentUser=Di.UNAUTHENTICATED,this.R=!1,this.I=0,this.u=null,this.forceRefresh=!1,this.m=function(){e.I++,e.currentUser=e.A(),e.R=!0,e.u&&e.u(e.currentUser)},this.I=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.m):(this.m(null),t.get().then(function(t){e.auth=t,e.m&&e.auth.addAuthTokenListener(e.m)},function(){}))}function Xi(){this.u=null}function Ji(t,e){var n=this;return(n=Ui.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}Bi.MIN=new Bi(new Fi(0,0));var Ki,Zi=(Object.defineProperty(er.prototype,"length",{get:function(){return this.N},enumerable:!0,configurable:!0}),er.prototype.isEqual=function(t){return 0===er.k(this,t)},er.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof er?t.forEach(function(t){e.push(t)}):e.push(t),this.L(e)},er.prototype.limit=function(){return this.offset+this.length},er.prototype.$=function(t){return t=void 0===t?1:t,this.L(this.segments,this.offset+t,this.length-t)},er.prototype.O=function(){return this.L(this.segments,this.offset,this.length-1)},er.prototype.M=function(){return this.segments[this.offset]},er.prototype.U=function(){return this.get(this.length-1)},er.prototype.get=function(t){return this.segments[this.offset+t]},er.prototype.q=function(){return 0===this.length},er.prototype.B=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},er.prototype.W=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},er.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},er.prototype.j=function(){return this.segments.slice(this.offset,this.limit())},er.k=function(t,e){for(var n=Math.min(t.length,e.length),i=0;i<n;i++){var r=t.get(i),o=e.get(i);if(r<o)return-1;if(o<r)return 1}return t.length<e.length?-1:t.length>e.length?1:0},er),$i=(n(tr,Ki=Zi),tr.prototype.L=function(t,e,n){return new tr(t,e,n)},tr.prototype.G=function(){return this.j().join("/")},tr.prototype.toString=function(){return this.G()},tr.K=function(t){if(0<=t.indexOf("//"))throw new Mi(Pi.INVALID_ARGUMENT,"Invalid path ("+t+"). Paths must not contain // in them.");return new tr(t.split("/").filter(function(t){return 0<t.length}))},tr);function tr(){return null!==Ki&&Ki.apply(this,arguments)||this}function er(t,e,n){void 0===e?e=0:e>t.length&&yu("offset "+e+" out of range "+t.length),void 0===n?n=t.length-e:n>t.length-e&&yu("length "+n+" out of range "+(t.length-e)),this.segments=t,this.offset=e,this.N=n}$i.H=new $i([]);var nr,ir=/^[_a-zA-Z][_a-zA-Z0-9]*$/,rr=(n(or,nr=Zi),or.prototype.L=function(t,e,n){return new or(t,e,n)},or.J=function(t){return ir.test(t)},or.prototype.G=function(){return this.j().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),or.J(t)||(t="`"+t+"`"),t}).join(".")},or.prototype.toString=function(){return this.G()},or.prototype.Y=function(){return 1===this.length&&"__name__"===this.get(0)},or.X=function(){return new or(["__name__"])},or.Z=function(t){for(var e=[],n="",i=0,r=function(){if(0===n.length)throw new Mi(Pi.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;i<t.length;){var s=t[i];if("\\"===s){if(i+1===t.length)throw new Mi(Pi.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[i+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Mi(Pi.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,i+=2}else"`"===s?o=!o:"."!==s||o?n+=s:r(),i++}if(r(),o)throw new Mi(Pi.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new or(e)},or);function or(){return null!==nr&&nr.apply(this,arguments)||this}rr.H=new rr([]);var sr=(ur.tt=function(t){return new ur($i.K(t).$(5))},ur.prototype.et=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},ur.prototype.isEqual=function(t){return null!==t&&0===$i.k(this.path,t.path)},ur.prototype.toString=function(){return this.path.toString()},ur.k=function(t,e){return $i.k(t.path,e.path)},ur.st=function(t){return t.length%2==0},ur.it=function(t){return new ur(new $i(t.slice()))},ur);function ur(t){this.path=t}sr.EMPTY=new sr(new $i([]));var ar=(pr.prototype.nt=function(t,e){return new pr(this.k,this.root.nt(t,e,this.k).rt(null,null,cr.ht,null,null))},pr.prototype.remove=function(t){return new pr(this.k,this.root.remove(t,this.k).rt(null,null,cr.ht,null,null))},pr.prototype.get=function(t){for(var e=this.root;!e.q();){var n=this.k(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},pr.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.q();){var i=this.k(t,n.key);if(0===i)return e+n.left.size;n=i<0?n.left:(e+=n.left.size+1,n.right)}return-1},pr.prototype.q=function(){return this.root.q()},Object.defineProperty(pr.prototype,"size",{get:function(){return this.root.size},enumerable:!0,configurable:!0}),pr.prototype.ot=function(){return this.root.ot()},pr.prototype.at=function(){return this.root.at()},pr.prototype.ut=function(t){return this.root.ut(t)},pr.prototype.forEach=function(n){this.ut(function(t,e){return n(t,e),!1})},pr.prototype.toString=function(){var n=[];return this.ut(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},pr.prototype.ct=function(t){return this.root.ct(t)},pr.prototype.lt=function(){return new hr(this.root,null,this.k,!1)},pr.prototype._t=function(t){return new hr(this.root,t,this.k,!1)},pr.prototype.dt=function(){return new hr(this.root,null,this.k,!0)},pr.prototype.ft=function(t){return new hr(this.root,t,this.k,!0)},pr),hr=(fr.prototype.Et=function(){var t=this.Tt.pop(),e={key:t.key,value:t.value};if(this.wt)for(t=t.left;!t.q();)this.Tt.push(t),t=t.right;else for(t=t.right;!t.q();)this.Tt.push(t),t=t.left;return e},fr.prototype.Rt=function(){return 0<this.Tt.length},fr.prototype.It=function(){if(0===this.Tt.length)return null;var t=this.Tt[this.Tt.length-1];return{key:t.key,value:t.value}},fr),cr=(lr.prototype.rt=function(t,e,n,i,r){return new lr(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=i?i:this.left,null!=r?r:this.right)},lr.prototype.q=function(){return!1},lr.prototype.ut=function(t){return this.left.ut(t)||t(this.key,this.value)||this.right.ut(t)},lr.prototype.ct=function(t){return this.right.ct(t)||t(this.key,this.value)||this.left.ct(t)},lr.prototype.min=function(){return this.left.q()?this:this.left.min()},lr.prototype.ot=function(){return this.min().key},lr.prototype.at=function(){return this.right.q()?this.key:this.right.at()},lr.prototype.nt=function(t,e,n){var i=this,r=n(t,i.key);return(i=r<0?i.rt(null,null,null,i.left.nt(t,e,n),null):0===r?i.rt(null,e,null,null,null):i.rt(null,null,null,null,i.right.nt(t,e,n))).At()},lr.prototype.Pt=function(){if(this.left.q())return lr.EMPTY;var t=this;return t.left.Vt()||t.left.left.Vt()||(t=t.pt()),(t=t.rt(null,null,null,t.left.Pt(),null)).At()},lr.prototype.remove=function(t,e){var n,i=this;if(e(t,i.key)<0)i.left.q()||i.left.Vt()||i.left.left.Vt()||(i=i.pt()),i=i.rt(null,null,null,i.left.remove(t,e),null);else{if(i.left.Vt()&&(i=i.gt()),i.right.q()||i.right.Vt()||i.right.left.Vt()||(i=i.yt()),0===e(t,i.key)){if(i.right.q())return lr.EMPTY;n=i.right.min(),i=i.rt(n.key,n.value,null,null,i.right.Pt())}i=i.rt(null,null,null,null,i.right.remove(t,e))}return i.At()},lr.prototype.Vt=function(){return this.color},lr.prototype.At=function(){var t=this;return t.right.Vt()&&!t.left.Vt()&&(t=t.bt()),t.left.Vt()&&t.left.left.Vt()&&(t=t.gt()),t.left.Vt()&&t.right.Vt()&&(t=t.vt()),t},lr.prototype.pt=function(){var t=this.vt();return t.right.left.Vt()&&(t=(t=(t=t.rt(null,null,null,null,t.right.gt())).bt()).vt()),t},lr.prototype.yt=function(){var t=this.vt();return t.left.left.Vt()&&(t=(t=t.gt()).vt()),t},lr.prototype.bt=function(){var t=this.rt(null,null,lr.RED,null,this.right.left);return this.right.rt(null,null,this.color,t,null)},lr.prototype.gt=function(){var t=this.rt(null,null,lr.RED,this.left.right,null);return this.left.rt(null,null,this.color,null,t)},lr.prototype.vt=function(){var t=this.left.rt(null,null,!this.left.color,null,null),e=this.right.rt(null,null,!this.right.color,null,null);return this.rt(null,null,!this.color,t,e)},lr.prototype.St=function(){var t=this.Ct();return Math.pow(2,t)<=this.size+1},lr.prototype.Ct=function(){if(this.Vt()&&this.left.Vt())throw yu("Red node has red child("+this.key+","+this.value+")");if(this.right.Vt())throw yu("Right child of ("+this.key+","+this.value+") is red");var t=this.left.Ct();if(t!==this.right.Ct())throw yu("Black depths differ");return t+(this.Vt()?0:1)},lr);function lr(t,e,n,i,r){this.key=t,this.value=e,this.color=null!=n?n:lr.RED,this.left=null!=i?i:lr.EMPTY,this.right=null!=r?r:lr.EMPTY,this.size=this.left.size+1+this.right.size}function fr(t,e,n,i){this.wt=i,this.Tt=[];for(var r=1;!t.q();)if(r=e?n(t.key,e):1,i&&(r*=-1),r<0)t=this.wt?t.left:t.right;else{if(0===r){this.Tt.push(t);break}this.Tt.push(t),t=this.wt?t.right:t.left}}function pr(t,e){this.k=t,this.root=e||cr.EMPTY}function dr(){this.size=0}cr.EMPTY=null,cr.RED=!0,cr.ht=!1,cr.EMPTY=(Object.defineProperty(dr.prototype,"key",{get:function(){throw yu("LLRBEmptyNode has no key.")},enumerable:!0,configurable:!0}),Object.defineProperty(dr.prototype,"value",{get:function(){throw yu("LLRBEmptyNode has no value.")},enumerable:!0,configurable:!0}),Object.defineProperty(dr.prototype,"color",{get:function(){throw yu("LLRBEmptyNode has no color.")},enumerable:!0,configurable:!0}),Object.defineProperty(dr.prototype,"left",{get:function(){throw yu("LLRBEmptyNode has no left child.")},enumerable:!0,configurable:!0}),Object.defineProperty(dr.prototype,"right",{get:function(){throw yu("LLRBEmptyNode has no right child.")},enumerable:!0,configurable:!0}),dr.prototype.rt=function(t,e,n,i,r){return this},dr.prototype.nt=function(t,e,n){return new cr(t,e)},dr.prototype.remove=function(t,e){return this},dr.prototype.q=function(){return!0},dr.prototype.ut=function(t){return!1},dr.prototype.ct=function(t){return!1},dr.prototype.ot=function(){return null},dr.prototype.at=function(){return null},dr.prototype.Vt=function(){return!1},dr.prototype.St=function(){return!0},dr.prototype.Ct=function(){return 0},new dr);var yr=(mr.prototype.has=function(t){return null!==this.data.get(t)},mr.prototype.first=function(){return this.data.ot()},mr.prototype.last=function(){return this.data.at()},Object.defineProperty(mr.prototype,"size",{get:function(){return this.data.size},enumerable:!0,configurable:!0}),mr.prototype.indexOf=function(t){return this.data.indexOf(t)},mr.prototype.forEach=function(n){this.data.ut(function(t,e){return n(t),!1})},mr.prototype.Dt=function(t,e){for(var n=this.data._t(t[0]);n.Rt();){var i=n.Et();if(0<=this.k(i.key,t[1]))return;e(i.key)}},mr.prototype.Ft=function(t,e){var n;for(n=void 0!==e?this.data._t(e):this.data.lt();n.Rt();)if(!t(n.Et().key))return},mr.prototype.Nt=function(t){var e=this.data._t(t);return e.Rt()?e.Et().key:null},mr.prototype.lt=function(){return new vr(this.data.lt())},mr.prototype._t=function(t){return new vr(this.data._t(t))},mr.prototype.add=function(t){return this.rt(this.data.remove(t).nt(t,!0))},mr.prototype.delete=function(t){return this.has(t)?this.rt(this.data.remove(t)):this},mr.prototype.q=function(){return this.data.q()},mr.prototype.kt=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},mr.prototype.isEqual=function(t){if(!(t instanceof mr))return!1;if(this.size!==t.size)return!1;for(var e=this.data.lt(),n=t.data.lt();e.Rt();){var i=e.Et().key,r=n.Et().key;if(0!==this.k(i,r))return!1}return!0},mr.prototype.j=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},mr.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},mr.prototype.rt=function(t){var e=new mr(this.k);return e.data=t,e},mr),vr=(gr.prototype.Et=function(){return this.Lt.Et().key},gr.prototype.Rt=function(){return this.Lt.Rt()},gr);function gr(t){this.Lt=t}function mr(t){this.k=t,this.data=new ar(this.k)}function wr(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function br(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Er(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Ar=(Ir.fromBase64String=function(t){return new Ir(uu.Ot().atob(t))},Ir.fromUint8Array=function(t){return new Ir(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},Ir.prototype.toBase64=function(){return uu.Ot().btoa(this.$t)},Ir.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.$t)},Ir.prototype.Mt=function(){return 2*this.$t.length},Ir.prototype.C=function(t){return wu(this.$t,t.$t)},Ir.prototype.isEqual=function(t){return this.$t===t.$t},Ir);function Ir(t){this.$t=t}function Nr(t){return null==t}function Tr(t){return-0===t&&1/t==-1/0}function _r(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function Sr(t){var e=Ur(t.mapValue.fields.__local_write_time__.timestampValue);return new Fi(e.seconds,e.nanos)}Ar.Ut=new Ar("");var kr=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Rr(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?_r(t)?4:10:yu("Invalid value type: "+JSON.stringify(t))}function Or(r,t){var e,n,i,o=Rr(r);if(o!==Rr(t))return!1;switch(o){case 0:return!0;case 1:return r.booleanValue===t.booleanValue;case 4:return Sr(r).isEqual(Sr(t));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=Ur(r.timestampValue),n=Ur(t.timestampValue);return e.seconds===n.seconds&&e.nanos===n.nanos}(t);case 5:return r.stringValue===t.stringValue;case 6:return i=t,Mr(r.bytesValue).isEqual(Mr(i.bytesValue));case 7:return r.referenceValue===t.referenceValue;case 8:return n=t,Pr((e=r).geoPointValue.latitude)===Pr(n.geoPointValue.latitude)&&Pr(e.geoPointValue.longitude)===Pr(n.geoPointValue.longitude);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return Pr(t.integerValue)===Pr(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=Pr(t.doubleValue),i=Pr(e.doubleValue);return n===i?Tr(n)===Tr(i):isNaN(n)&&isNaN(i)}return!1}(r,t);case 9:return bu(r.arrayValue.values||[],t.arrayValue.values||[],Or);case 10:return function(t){var e=r.mapValue.fields||{},n=t.mapValue.fields||{};if(wr(e)!==wr(n))return!1;for(var i in e)if(e.hasOwnProperty(i)&&(void 0===n[i]||!Or(e[i],n[i])))return!1;return!0}(t);default:return yu("Unexpected value type: "+JSON.stringify(r))}}function Lr(t,e){return void 0!==(t.values||[]).find(function(t){return Or(t,e)})}function Dr(t,e){var n,i,r,o,s,u,a,h,c,l,f=Rr(t),p=Rr(e);if(f!==p)return wu(f,p);switch(f){case 0:return 0;case 1:return wu(t.booleanValue,e.booleanValue);case 2:return h=e,(c=Pr(t.integerValue||t.doubleValue))<(l=Pr(h.integerValue||h.doubleValue))?-1:l<c?1:c===l?0:isNaN(c)?isNaN(l)?0:-1:1;case 3:return Cr(t.timestampValue,e.timestampValue);case 4:return Cr(Sr(t),Sr(e));case 5:return wu(t.stringValue,e.stringValue);case 6:return o=t.bytesValue,s=e.bytesValue,u=Mr(o),a=Mr(s),u.C(a);case 7:return function(t,e){for(var n=t.split("/"),i=e.split("/"),r=0;r<n.length&&r<i.length;r++){var o=wu(n[r],i[r]);if(0!==o)return o}return wu(n.length,i.length)}(t.referenceValue,e.referenceValue);case 8:return n=t.geoPointValue,i=e.geoPointValue,0!==(r=wu(Pr(n.latitude),Pr(i.latitude)))?r:wu(Pr(n.longitude),Pr(i.longitude));case 9:return function(t,e){for(var n=t.values||[],i=e.values||[],r=0;r<n.length&&r<i.length;++r){var o=Dr(n[r],i[r]);if(o)return o}return wu(n.length,i.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},i=Object.keys(n),r=e.fields||{},o=Object.keys(r);i.sort(),o.sort();for(var s=0;s<i.length&&s<o.length;++s){var u=wu(i[s],o[s]);if(0!==u)return u;var a=Dr(n[i[s]],r[o[s]]);if(0!==a)return a}return wu(i.length,o.length)}(t.mapValue,e.mapValue);default:throw yu("Invalid value type: "+f)}}function Cr(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return wu(t,e);var n=Ur(t),i=Ur(e),r=wu(n.seconds,i.seconds);return 0!==r?r:wu(n.nanos,i.nanos)}function Vr(t){return function s(r){return"nullValue"in r?"null":"booleanValue"in r?""+r.booleanValue:"integerValue"in r?""+r.integerValue:"doubleValue"in r?""+r.doubleValue:"timestampValue"in r?"time("+(t=Ur(r.timestampValue)).seconds+","+t.nanos+")":"stringValue"in r?r.stringValue:"bytesValue"in r?Mr(r.bytesValue).toBase64():"referenceValue"in r?(n=r.referenceValue,sr.tt(n).toString()):"geoPointValue"in r?"geo("+(e=r.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in r?function(){for(var t="[",e=!0,n=0,i=r.arrayValue.values||[];n<i.length;n++)e?e=!1:t+=",",t+=s(i[n]);return t+"]"}():"mapValue"in r?function(t){for(var e="{",n=!0,i=0,r=Object.keys(t.fields||{}).sort();i<r.length;i++){var o=r[i];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(r.mapValue):yu("Invalid value type: "+JSON.stringify(r));var t,e,n}(t)}function Ur(t){if(vu(!!t,"Cannot normalize null or undefined timestamp."),"string"!=typeof t)return{seconds:Pr(t.seconds),nanos:Pr(t.nanos)};var e=0,n=kr.exec(t);if(vu(!!n,"invalid timestamp: "+t),n[1]){var i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}var r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}function Pr(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Mr(t){return"string"==typeof t?Ar.fromBase64String(t):Ar.fromUint8Array(t)}function qr(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.G()}}function xr(t){return t&&"integerValue"in t}function Gr(t){return!!t&&"arrayValue"in t}function jr(t){return t&&"nullValue"in t}function Fr(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Br(t){return t&&"mapValue"in t}var Hr=(Yr.prototype.qt=function(t,e){return n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}},t&&(n.fields.__previous_value__=t),{mapValue:n};var n},Yr.prototype.Bt=function(t,e){return e},Yr.prototype.xt=function(t){return null},Yr.prototype.isEqual=function(t){return t instanceof Yr},Yr);function Yr(){}Hr.instance=new Hr;var zr=(Kr.prototype.qt=function(t,e){return this.apply(t)},Kr.prototype.Bt=function(t,e){return this.apply(t)},Kr.prototype.apply=function(t){for(var n=Zr(t),e=function(e){n.some(function(t){return Or(t,e)})||n.push(e)},i=0,r=this.elements;i<r.length;i++)e(r[i]);return{arrayValue:{values:n}}},Kr.prototype.xt=function(t){return null},Kr.prototype.isEqual=function(t){return t instanceof Kr&&bu(this.elements,t.elements,Or)},Kr),Qr=(Jr.prototype.qt=function(t,e){return this.apply(t)},Jr.prototype.Bt=function(t,e){return this.apply(t)},Jr.prototype.apply=function(t){for(var n=Zr(t),e=function(e){n=n.filter(function(t){return!Or(t,e)})},i=0,r=this.elements;i<r.length;i++)e(r[i]);return{arrayValue:{values:n}}},Jr.prototype.xt=function(t){return null},Jr.prototype.isEqual=function(t){return t instanceof Jr&&bu(this.elements,t.elements,Or)},Jr),Wr=(Xr.prototype.qt=function(t,e){var n=this.xt(t),i=this.asNumber(n)+this.asNumber(this.Qt);return xr(n)&&xr(this.Qt)?this.serializer.Wt(i):this.serializer.jt(i)},Xr.prototype.Bt=function(t,e){return e},Xr.prototype.xt=function(t){return xr(e=t)||e&&"doubleValue"in e?t:{integerValue:0};var e},Xr.prototype.isEqual=function(t){return t instanceof Xr&&Or(this.Qt,t.Qt)},Xr.prototype.asNumber=function(t){return Pr(t.integerValue||t.doubleValue)},Xr);function Xr(t,e){this.serializer=t,this.Qt=e}function Jr(t){this.elements=t}function Kr(t){this.elements=t}function Zr(t){return Gr(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function $r(t,e){this.version=t,this.transformResults=e}var to=(oo.Gt=function(t){return new oo(t)},oo.zt=function(t){var e=new yr(rr.k);return t.forEach(function(t){return e=e.add(t)}),new oo(e)},oo.prototype.Kt=function(e){var n=!1;return this.fields.forEach(function(t){t.B(e)&&(n=!0)}),n},oo.prototype.isEqual=function(t){return this.fields.isEqual(t.fields)},oo),eo=(ro.prototype.isEqual=function(t){return this.field.isEqual(t.field)&&this.transform.isEqual(t.transform)},ro),no=(io.exists=function(t){return new io(void 0,t)},io.updateTime=function(t){return new io(t)},Object.defineProperty(io.prototype,"Ht",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!0,configurable:!0}),io.prototype.Jt=function(t){return void 0!==this.updateTime?t instanceof Lo&&t.version.isEqual(this.updateTime):void 0===this.exists||this.exists===t instanceof Lo},io.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},io);function io(t,e){this.updateTime=t,this.exists=e}function ro(t,e){this.field=t,this.transform=e}function oo(t){this.fields=t}no.NONE=new no;var so,uo,ao,ho,co,lo=(To.prototype.Yt=function(t){},To.Xt=function(t){return t instanceof Lo?t.version:Bi.MIN},To),fo=(n(No,co=lo),No.prototype.Bt=function(t,e){this.Yt(t);var n=e.version;return new Lo(this.key,n,this.value,{hasCommittedMutations:!0})},No.prototype.qt=function(t,e,n){if(this.Yt(t),!this.Zt.Jt(t))return t;var i=lo.Xt(t);return new Lo(this.key,i,this.value,{te:!0})},No.prototype.ee=function(t){return null},No.prototype.isEqual=function(t){return t instanceof No&&this.key.isEqual(t.key)&&this.value.isEqual(t.value)&&this.Zt.isEqual(t.Zt)},No),po=(n(Io,ho=lo),Io.prototype.Bt=function(t,e){if(this.Yt(t),!this.Zt.Jt(t))return new Co(this.key,e.version);var n=this.ie(t);return new Lo(this.key,e.version,n,{hasCommittedMutations:!0})},Io.prototype.qt=function(t,e,n){if(this.Yt(t),!this.Zt.Jt(t))return t;var i=lo.Xt(t),r=this.ie(t);return new Lo(this.key,i,r,{te:!0})},Io.prototype.ee=function(t){return null},Io.prototype.isEqual=function(t){return t instanceof Io&&this.key.isEqual(t.key)&&this.se.isEqual(t.se)&&this.Zt.isEqual(t.Zt)},Io.prototype.ie=function(t){var e;return e=t instanceof Lo?t.data():mo.EMPTY,this.ne(e)},Io.prototype.ne=function(t){var n=this,i=t.re();return this.se.fields.forEach(function(t){if(!t.q()){var e=n.data.field(t);null!==e?i.set(t,e):i.delete(t)}}),i.he()},Io),yo=(n(Ao,ao=lo),Ao.prototype.Bt=function(t,e){if(this.Yt(t),vu(null!=e.transformResults,"Transform results missing for TransformMutation."),!this.Zt.Jt(t))return new Co(this.key,e.version);var n=this.oe(t),i=this.ae(t,e.transformResults),r=e.version,o=this.ue(n.data(),i);return new Lo(this.key,r,o,{hasCommittedMutations:!0})},Ao.prototype.qt=function(t,e,n){if(this.Yt(t),!this.Zt.Jt(t))return t;var i=this.oe(t),r=this.ce(n,t,e),o=this.ue(i.data(),r);return new Lo(this.key,i.version,o,{te:!0})},Ao.prototype.ee=function(t){for(var e=null,n=0,i=this.fieldTransforms;n<i.length;n++){var r=i[n],o=t instanceof Lo?t.field(r.field):void 0,s=r.transform.xt(o||null);null!=s&&(e=null==e?mo.le().set(r.field,s):e.set(r.field,s))}return e?e.he():null},Ao.prototype.isEqual=function(t){return t instanceof Ao&&this.key.isEqual(t.key)&&bu(this.fieldTransforms,t.fieldTransforms,function(t,e){return t.isEqual(e)})&&this.Zt.isEqual(t.Zt)},Ao.prototype.oe=function(t){return t},Ao.prototype.ae=function(t,e){var n=[];vu(this.fieldTransforms.length===e.length,"server transform result count ("+e.length+") should match field transform count ("+this.fieldTransforms.length+")");for(var i=0;i<e.length;i++){var r=this.fieldTransforms[i],o=r.transform,s=null;t instanceof Lo&&(s=t.field(r.field)),n.push(o.Bt(s,e[i]))}return n},Ao.prototype.ce=function(t,e,n){for(var i=[],r=0,o=this.fieldTransforms;r<o.length;r++){var s=o[r],u=s.transform,a=null;e instanceof Lo&&(a=e.field(s.field)),null===a&&n instanceof Lo&&(a=n.field(s.field)),i.push(u.qt(a,t))}return i},Ao.prototype.ue=function(t,e){for(var n=t.re(),i=0;i<this.fieldTransforms.length;i++){var r=this.fieldTransforms[i].field;n.set(r,e[i])}return n.he()},Ao),vo=(n(Eo,uo=lo),Eo.prototype.Bt=function(t,e){return this.Yt(t),new Do(this.key,e.version,{hasCommittedMutations:!0})},Eo.prototype.qt=function(t,e,n){return this.Yt(t),this.Zt.Jt(t)?new Do(this.key,Bi.S()):t},Eo.prototype.ee=function(t){return null},Eo.prototype.isEqual=function(t){return t instanceof Eo&&this.key.isEqual(t.key)&&this.Zt.isEqual(t.Zt)},Eo),go=(n(bo,so=lo),bo.prototype.Bt=function(t,e){yu("VerifyMutation should only be used in Transactions.")},bo.prototype.qt=function(t,e,n){yu("VerifyMutation should only be used in Transactions.")},bo.prototype.ee=function(t){yu("VerifyMutation should only be used in Transactions.")},bo.prototype.isEqual=function(t){return t instanceof bo&&this.key.isEqual(t.key)&&this.Zt.isEqual(t.Zt)},bo),mo=(wo.le=function(){return wo.EMPTY.re()},wo.prototype.field=function(t){if(t.q())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!Br(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.U()])||null},wo.prototype.se=function(){return this._e(this.proto.mapValue)},wo.prototype._e=function(t){var r=this,o=new yr(rr.k);return br(t.fields||{},function(t,e){var n=new rr([t]);if(10===Rr(e)){var i=r._e(e.mapValue).fields;i.q()?o=o.add(n):i.forEach(function(t){o=o.add(n.child(t))})}else o=o.add(n)}),to.Gt(o)},wo.prototype.isEqual=function(t){return Or(this.proto,t.proto)},wo.prototype.re=function(){return new Ro(this)},wo);function wo(t){this.proto=t}function bo(t,e){var n=this;return(n=so.call(this)||this).key=t,n.Zt=e,n.type=4,n}function Eo(t,e){var n=this;return(n=uo.call(this)||this).key=t,n.Zt=e,n.type=3,n}function Ao(t,e){var n=this;return(n=ao.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.Zt=no.exists(!0),n}function Io(t,e,n,i){var r=this;return(r=ho.call(this)||this).key=t,r.data=e,r.se=n,r.Zt=i,r.type=1,r}function No(t,e,n){var i=this;return(i=co.call(this)||this).key=t,i.value=e,i.Zt=n,i.type=0,i}function To(){}mo.EMPTY=new mo({mapValue:{}});var _o,So,ko,Ro=(Ho.prototype.set=function(t,e){return this.we(t,e),this},Ho.prototype.delete=function(t){return this.we(t,null),this},Ho.prototype.we=function(t,e){for(var n=this.fe,i=0;i<t.length-1;++i){var r=t.get(i),o=n.get(r);o instanceof Map||(o=o&&10===Rr(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(r,o)),n=o}n.set(t.U(),e)},Ho.prototype.he=function(){var t=this.Te(rr.H,this.fe);return null!=t?new mo(t):this.de},Ho.prototype.Te=function(i,t){var r=this,o=!1,e=this.de.field(i),s=Br(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){if(t instanceof Map){var n=r.Te(i.child(e),t);null!=n&&(s[e]=n,o=!0)}else null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},Ho),Oo=(Bo.me=function(t,e){return sr.k(t.key,e.key)},Bo),Lo=(n(Fo,ko=Oo),Fo.prototype.field=function(t){return this.Ee.field(t)},Fo.prototype.data=function(){return this.Ee},Fo.prototype.Re=function(){return this.Ee.proto},Fo.prototype.isEqual=function(t){return t instanceof Fo&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.te===t.te&&this.hasCommittedMutations===t.hasCommittedMutations&&this.Ee.isEqual(t.Ee)},Fo.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.Ee.toString()+", {hasLocalMutations: "+this.te+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(Fo.prototype,"hasPendingWrites",{get:function(){return this.te||this.hasCommittedMutations},enumerable:!0,configurable:!0}),Fo.Ie=function(t,e,n){var i=e.field(t),r=n.field(t);return null!==i&&null!==r?Dr(i,r):yu("Trying to compare documents on fields that don't exist")},Fo),Do=(n(jo,So=Oo),jo.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(jo.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!0,configurable:!0}),jo.prototype.isEqual=function(t){return t instanceof jo&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},jo),Co=(n(Go,_o=Oo),Go.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(Go.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!0,configurable:!0}),Go.prototype.isEqual=function(t){return t instanceof Go&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},Go),Vo=(xo.prototype.canonicalId=function(){if(null===this.Ae){var t=this.path.G();null!==this.collectionGroup&&(t+="|cg:"+this.collectionGroup),t+="|f:",t+=this.filters.map(function(t){return t.canonicalId()}).join(","),t+="|ob:",t+=this.orderBy.map(function(t){return t.canonicalId()}).join(","),Nr(this.limit)||(t+="|l:",t+=this.limit),this.startAt&&(t+="|lb:",t+=this.startAt.canonicalId()),this.endAt&&(t+="|ub:",t+=this.endAt.canonicalId()),this.Ae=t}return this.Ae},xo.prototype.toString=function(){var t=this.path.G();return null!==this.collectionGroup&&(t+=" collectionGroup="+this.collectionGroup),0<this.filters.length&&(t+=", filters: ["+this.filters.join(", ")+"]"),Nr(this.limit)||(t+=", limit: "+this.limit),0<this.orderBy.length&&(t+=", orderBy: ["+this.orderBy.join(", ")+"]"),this.startAt&&(t+=", startAt: "+this.startAt.canonicalId()),this.endAt&&(t+=", endAt: "+this.endAt.canonicalId()),"Target("+t+")"},xo.prototype.isEqual=function(t){if(this.limit!==t.limit)return!1;if(this.orderBy.length!==t.orderBy.length)return!1;for(var e=0;e<this.orderBy.length;e++)if(!this.orderBy[e].isEqual(t.orderBy[e]))return!1;if(this.filters.length!==t.filters.length)return!1;for(var n=0;n<this.filters.length;n++)if(!this.filters[n].isEqual(t.filters[n]))return!1;return this.collectionGroup===t.collectionGroup&&!!this.path.isEqual(t.path)&&!!(null!==this.startAt?this.startAt.isEqual(t.startAt):null===t.startAt)&&(null!==this.endAt?this.endAt.isEqual(t.endAt):null===t.endAt)},xo.prototype.Pe=function(){return sr.st(this.path)&&null===this.collectionGroup&&0===this.filters.length},xo),Uo=(qo.ve=function(t){return new qo(t)},Object.defineProperty(qo.prototype,"orderBy",{get:function(){if(null===this.ge){var t=this.Se(),e=this.Ce();if(null!==t&&null===e)t.Y()?this.ge=[vs]:this.ge=[new ys(t),vs];else{for(var n=!(this.ge=[]),i=0,r=this.Ve;i<r.length;i++){var o=r[i];this.ge.push(o),o.field.Y()&&(n=!0)}if(!n){var s=0<this.Ve.length?this.Ve[this.Ve.length-1].dir:is.ASCENDING;this.ge.push(s===is.ASCENDING?vs:gs)}}}return this.ge},enumerable:!0,configurable:!0}),qo.prototype.De=function(t){var e=this.filters.concat([t]);return new qo(this.path,this.collectionGroup,this.Ve.slice(),e,this.limit,this.pe,this.startAt,this.endAt)},qo.prototype.Fe=function(t){var e=this.Ve.concat([t]);return new qo(this.path,this.collectionGroup,e,this.filters.slice(),this.limit,this.pe,this.startAt,this.endAt)},qo.prototype.Ne=function(t){return new qo(this.path,this.collectionGroup,this.Ve.slice(),this.filters.slice(),t,"F",this.startAt,this.endAt)},qo.prototype.ke=function(t){return new qo(this.path,this.collectionGroup,this.Ve.slice(),this.filters.slice(),t,"L",this.startAt,this.endAt)},qo.prototype.Le=function(t){return new qo(this.path,this.collectionGroup,this.Ve.slice(),this.filters.slice(),this.limit,this.pe,t,this.endAt)},qo.prototype.$e=function(t){return new qo(this.path,this.collectionGroup,this.Ve.slice(),this.filters.slice(),this.limit,this.pe,this.startAt,t)},qo.prototype.Oe=function(t){return new qo(t,null,this.Ve.slice(),this.filters.slice(),this.limit,this.pe,this.startAt,this.endAt)},qo.prototype.Me=function(){return 0===this.filters.length&&null===this.limit&&null==this.startAt&&null==this.endAt&&(0===this.Ve.length||1===this.Ve.length&&this.Ve[0].field.Y())},qo.prototype.canonicalId=function(){return this.Ue().canonicalId()+"|lt:"+this.pe},qo.prototype.toString=function(){return"Query(target="+this.Ue().toString()+"; limitType="+this.pe+")"},qo.prototype.isEqual=function(t){return this.Ue().isEqual(t.Ue())&&this.pe===t.pe},qo.prototype.qe=function(t,e){for(var n=!1,i=0,r=this.orderBy;i<r.length;i++){var o=r[i],s=o.compare(t,e);if(0!==s)return s;n=n||o.field.Y()}return 0},qo.prototype.matches=function(t){return this.Be(t)&&this.xe(t)&&this.Qe(t)&&this.We(t)},qo.prototype.je=function(){return!Nr(this.limit)&&"F"===this.pe},qo.prototype.Ge=function(){return!Nr(this.limit)&&"L"===this.pe},qo.prototype.Ce=function(){return 0<this.Ve.length?this.Ve[0].field:null},qo.prototype.Se=function(){for(var t=0,e=this.filters;t<e.length;t++){var n=e[t];if(n instanceof Ko&&n.ze())return n.field}return null},qo.prototype.Ke=function(t){for(var e=0,n=this.filters;e<n.length;e++){var i=n[e];if(i instanceof Ko&&0<=t.indexOf(i.op))return i.op}return null},qo.prototype.Pe=function(){return this.Ue().Pe()},qo.prototype.He=function(){return null!==this.collectionGroup},qo.prototype.Ue=function(){if(!this.ye)if("F"===this.pe)this.ye=new Vo(this.path,this.collectionGroup,this.orderBy,this.filters,this.limit,this.startAt,this.endAt);else{for(var t=[],e=0,n=this.orderBy;e<n.length;e++){var i=n[e],r=i.dir===is.DESCENDING?is.ASCENDING:is.DESCENDING;t.push(new ys(i.field,r))}var o=this.endAt?new ds(this.endAt.position,!this.endAt.before):null,s=this.startAt?new ds(this.startAt.position,!this.startAt.before):null;this.ye=new Vo(this.path,this.collectionGroup,t,this.filters,this.limit,o,s)}return this.ye},qo.prototype.Be=function(t){var e=t.key.path;return null!==this.collectionGroup?t.key.et(this.collectionGroup)&&this.path.B(e):sr.st(this.path)?this.path.isEqual(e):this.path.W(e)},qo.prototype.xe=function(t){for(var e=0,n=this.Ve;e<n.length;e++){var i=n[e];if(!i.field.Y()&&null===t.field(i.field))return!1}return!0},qo.prototype.Qe=function(t){for(var e=0,n=this.filters;e<n.length;e++)if(!n[e].matches(t))return!1;return!0},qo.prototype.We=function(t){return!(this.startAt&&!this.startAt.Je(this.orderBy,t)||this.endAt&&this.endAt.Je(this.orderBy,t))},qo.prototype.be=function(t){},qo),Po=(Mo.K=function(t){switch(t){case"<":return Mo.LESS_THAN;case"<=":return Mo.LESS_THAN_OR_EQUAL;case"==":return Mo.EQUAL;case">=":return Mo.GREATER_THAN_OR_EQUAL;case">":return Mo.GREATER_THAN;case"array-contains":return Mo.ARRAY_CONTAINS;case"in":return Mo.IN;case"array-contains-any":return Mo.ARRAY_CONTAINS_ANY;default:return yu("Unknown FieldFilter operator: "+t)}},Mo.prototype.toString=function(){return this.name},Mo.prototype.isEqual=function(t){return this.name===t.name},Mo);function Mo(t){this.name=t}function qo(t,e,n,i,r,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===i&&(i=[]),void 0===r&&(r=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.Ve=n,this.filters=i,this.limit=r,this.pe=o,this.startAt=s,this.endAt=u,this.ge=null,this.ye=null,this.startAt&&this.be(this.startAt),this.endAt&&this.be(this.endAt)}function xo(t,e,n,i,r,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===i&&(i=[]),void 0===r&&(r=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=i,this.limit=r,this.startAt=o,this.endAt=s,this.Ae=null}function Go(){return null!==_o&&_o.apply(this,arguments)||this}function jo(t,e,n){var i=this;return(i=So.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),i}function Fo(t,e,n,i){var r=this;return(r=ko.call(this,t,e)||this).Ee=n,r.te=!!i.te,r.hasCommittedMutations=!!i.hasCommittedMutations,r}function Bo(t,e){this.key=t,this.version=e}function Ho(t){this.de=t,this.fe=new Map}Po.LESS_THAN=new Po("<"),Po.LESS_THAN_OR_EQUAL=new Po("<="),Po.EQUAL=new Po("=="),Po.GREATER_THAN=new Po(">"),Po.GREATER_THAN_OR_EQUAL=new Po(">="),Po.ARRAY_CONTAINS=new Po("array-contains"),Po.IN=new Po("in"),Po.ARRAY_CONTAINS_ANY=new Po("array-contains-any");var Yo,zo,Qo,Wo,Xo,Jo,Ko=(n(cs,Jo=function(){}),cs.create=function(t,e,n){if(t.Y())return e===Po.IN?new $o(t,n):new Zo(t,e,n);if(jr(n)){if(e!==Po.EQUAL)throw new Mi(Pi.INVALID_ARGUMENT,"Invalid query. Null supports only equality comparisons.");return new cs(t,e,n)}if(Fr(n)){if(e!==Po.EQUAL)throw new Mi(Pi.INVALID_ARGUMENT,"Invalid query. NaN supports only equality comparisons.");return new cs(t,e,n)}return e===Po.ARRAY_CONTAINS?new ts(t,n):e===Po.IN?new es(t,n):e===Po.ARRAY_CONTAINS_ANY?new ns(t,n):new cs(t,e,n)},cs.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&Rr(this.value)===Rr(e)&&this.Ye(Dr(e,this.value))},cs.prototype.Ye=function(t){switch(this.op){case Po.LESS_THAN:return t<0;case Po.LESS_THAN_OR_EQUAL:return t<=0;case Po.EQUAL:return 0===t;case Po.GREATER_THAN:return 0<t;case Po.GREATER_THAN_OR_EQUAL:return 0<=t;default:return yu("Unknown FieldFilter operator: "+this.op)}},cs.prototype.ze=function(){return 0<=[Po.LESS_THAN,Po.LESS_THAN_OR_EQUAL,Po.GREATER_THAN,Po.GREATER_THAN_OR_EQUAL].indexOf(this.op)},cs.prototype.canonicalId=function(){return this.field.G()+this.op.toString()+Vr(this.value)},cs.prototype.isEqual=function(t){return t instanceof cs&&this.op.isEqual(t.op)&&this.field.isEqual(t.field)&&Or(this.value,t.value)},cs.prototype.toString=function(){return this.field.G()+" "+this.op+" "+Vr(this.value)},cs),Zo=(n(hs,Xo=Ko),hs.prototype.matches=function(t){var e=sr.k(t.key,this.key);return this.Ye(e)},hs),$o=(n(as,Wo=Ko),as.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},as),ts=(n(us,Qo=Ko),us.prototype.matches=function(t){var e=t.field(this.field);return Gr(e)&&Lr(e.arrayValue,this.value)},us),es=(n(ss,zo=Ko),ss.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&Lr(this.value.arrayValue,e)},ss),ns=(n(os,Yo=Ko),os.prototype.matches=function(t){var e=this,n=t.field(this.field);return!(!Gr(n)||!n.arrayValue.values)&&n.arrayValue.values.some(function(t){return Lr(e.value.arrayValue,t)})},os),is=(rs.prototype.toString=function(){return this.name},rs);function rs(t){this.name=t}function os(t,e){return Yo.call(this,t,Po.ARRAY_CONTAINS_ANY,e)||this}function ss(t,e){return zo.call(this,t,Po.IN,e)||this}function us(t,e){return Qo.call(this,t,Po.ARRAY_CONTAINS,e)||this}function as(t,e){var n=this;return(n=Wo.call(this,t,Po.IN,e)||this).keys=(e.arrayValue.values||[]).map(function(t){return sr.tt(t.referenceValue)}),n}function hs(t,e,n){var i=this;return(i=Xo.call(this,t,e,n)||this).key=sr.tt(n.referenceValue),i}function cs(t,e,n){var i=this;return(i=Jo.call(this)||this).field=t,i.op=e,i.value=n,i}function ls(t){this.count=t}is.ASCENDING=new is("asc"),is.DESCENDING=new is("desc");var fs,ps,ds=(Es.prototype.canonicalId=function(){return(this.before?"b":"a")+":"+this.position.map(function(t){return Vr(t)}).join(",")},Es.prototype.Je=function(t,e){for(var n=0,i=0;i<this.position.length;i++){var r=t[i],o=this.position[i];if(n=r.field.Y()?sr.k(sr.tt(o.referenceValue),e.key):Dr(o,e.field(r.field)),r.dir===is.DESCENDING&&(n*=-1),0!==n)break}return this.before?n<=0:n<0},Es.prototype.isEqual=function(t){if(null===t)return!1;if(this.before!==t.before||this.position.length!==t.position.length)return!1;for(var e=0;e<this.position.length;e++)if(!Or(this.position[e],t.position[e]))return!1;return!0},Es),ys=(bs.prototype.compare=function(t,e){var n=this.Xe?Lo.me(t,e):Lo.Ie(this.field,t,e);switch(this.dir){case is.ASCENDING:return n;case is.DESCENDING:return-1*n;default:return yu("Unknown direction: "+this.dir)}},bs.prototype.canonicalId=function(){return this.field.G()+this.dir.toString()},bs.prototype.toString=function(){return this.field.G()+" ("+this.dir+")"},bs.prototype.isEqual=function(t){return this.dir===t.dir&&this.field.isEqual(t.field)},bs),vs=new ys(rr.X(),is.ASCENDING),gs=new ys(rr.X(),is.DESCENDING),ms=(ws.prototype.es=function(t){return new ws(this.target,this.targetId,this.Ze,t,this.ts,this.lastLimboFreeSnapshotVersion,this.resumeToken)},ws.prototype.ss=function(t,e){return new ws(this.target,this.targetId,this.Ze,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},ws.prototype.ns=function(t){return new ws(this.target,this.targetId,this.Ze,this.sequenceNumber,this.ts,t,this.resumeToken)},ws);function ws(t,e,n,i,r,o,s){void 0===r&&(r=Bi.MIN),void 0===o&&(o=Bi.MIN),void 0===s&&(s=Ar.Ut),this.target=t,this.targetId=e,this.Ze=n,this.sequenceNumber=i,this.ts=r,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function bs(t,e){this.field=t,void 0===e&&(e=is.ASCENDING),this.dir=e,this.Xe=t.Y()}function Es(t,e){this.position=t,this.before=e}function As(t){switch(t){case Pi.OK:return yu("Treated status OK as error");case Pi.CANCELLED:case Pi.UNKNOWN:case Pi.DEADLINE_EXCEEDED:case Pi.RESOURCE_EXHAUSTED:case Pi.INTERNAL:case Pi.UNAVAILABLE:case Pi.UNAUTHENTICATED:return;case Pi.INVALID_ARGUMENT:case Pi.NOT_FOUND:case Pi.ALREADY_EXISTS:case Pi.PERMISSION_DENIED:case Pi.FAILED_PRECONDITION:case Pi.ABORTED:case Pi.OUT_OF_RANGE:case Pi.UNIMPLEMENTED:case Pi.DATA_LOSS:return 1;default:return yu("Unknown status code: "+t)}}function Is(t){if(void 0===t)return pu("GRPC error has no .code"),Pi.UNKNOWN;switch(t){case fs.OK:return Pi.OK;case fs.CANCELLED:return Pi.CANCELLED;case fs.UNKNOWN:return Pi.UNKNOWN;case fs.DEADLINE_EXCEEDED:return Pi.DEADLINE_EXCEEDED;case fs.RESOURCE_EXHAUSTED:return Pi.RESOURCE_EXHAUSTED;case fs.INTERNAL:return Pi.INTERNAL;case fs.UNAVAILABLE:return Pi.UNAVAILABLE;case fs.UNAUTHENTICATED:return Pi.UNAUTHENTICATED;case fs.INVALID_ARGUMENT:return Pi.INVALID_ARGUMENT;case fs.NOT_FOUND:return Pi.NOT_FOUND;case fs.ALREADY_EXISTS:return Pi.ALREADY_EXISTS;case fs.PERMISSION_DENIED:return Pi.PERMISSION_DENIED;case fs.FAILED_PRECONDITION:return Pi.FAILED_PRECONDITION;case fs.ABORTED:return Pi.ABORTED;case fs.OUT_OF_RANGE:return Pi.OUT_OF_RANGE;case fs.UNIMPLEMENTED:return Pi.UNIMPLEMENTED;case fs.DATA_LOSS:return Pi.DATA_LOSS;default:return yu("Unknown status code: "+t)}}(ps=fs=fs||{})[ps.OK=0]="OK",ps[ps.CANCELLED=1]="CANCELLED",ps[ps.UNKNOWN=2]="UNKNOWN",ps[ps.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ps[ps.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ps[ps.NOT_FOUND=5]="NOT_FOUND",ps[ps.ALREADY_EXISTS=6]="ALREADY_EXISTS",ps[ps.PERMISSION_DENIED=7]="PERMISSION_DENIED",ps[ps.UNAUTHENTICATED=16]="UNAUTHENTICATED",ps[ps.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ps[ps.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ps[ps.ABORTED=10]="ABORTED",ps[ps.OUT_OF_RANGE=11]="OUT_OF_RANGE",ps[ps.UNIMPLEMENTED=12]="UNIMPLEMENTED",ps[ps.INTERNAL=13]="INTERNAL",ps[ps.UNAVAILABLE=14]="UNAVAILABLE",ps[ps.DATA_LOSS=15]="DATA_LOSS";var Ns=new ar(sr.k);function Ts(){return Ns}function _s(){return Ts()}var Ss=new ar(sr.k);function ks(){return Ss}var Rs=new ar(sr.k);function Os(){return Rs}var Ls=new yr(sr.k);function Ds(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Ls,i=0,r=t;i<r.length;i++){var o=r[i];n=n.add(o)}return n}var Cs=new yr(wu);function Vs(){return Cs}function Us(t,e,n,i){this.gs=t,this.removedTargetIds=e,this.key=n,this.ys=i}function Ps(t,e){this.targetId=t,this.bs=e}function Ms(t,e,n,i){void 0===n&&(n=Ar.Ut),void 0===i&&(i=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=i}var qs=(Ks.os=function(t){return new Ks(t.k)},Ks.prototype.has=function(t){return null!=this.rs.get(t)},Ks.prototype.get=function(t){return this.rs.get(t)},Ks.prototype.first=function(){return this.hs.ot()},Ks.prototype.last=function(){return this.hs.at()},Ks.prototype.q=function(){return this.hs.q()},Ks.prototype.indexOf=function(t){var e=this.rs.get(t);return e?this.hs.indexOf(e):-1},Object.defineProperty(Ks.prototype,"size",{get:function(){return this.hs.size},enumerable:!0,configurable:!0}),Ks.prototype.forEach=function(n){this.hs.ut(function(t,e){return n(t),!1})},Ks.prototype.add=function(t){var e=this.delete(t.key);return e.rt(e.rs.nt(t.key,t),e.hs.nt(t,null))},Ks.prototype.delete=function(t){var e=this.get(t);return e?this.rt(this.rs.remove(t),this.hs.remove(e)):this},Ks.prototype.isEqual=function(t){if(!(t instanceof Ks))return!1;if(this.size!==t.size)return!1;for(var e=this.hs.lt(),n=t.hs.lt();e.Rt();){var i=e.Et().key,r=n.Et().key;if(!i.isEqual(r))return!1}return!0},Ks.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},Ks.prototype.rt=function(t,e){var n=new Ks;return n.k=this.k,n.rs=t,n.hs=e,n},Ks),xs=(Js.prototype.track=function(t){var e=t.doc.key,n=this.as.get(e);!n||0!==t.type&&3===n.type?this.as=this.as.nt(e,t):3===t.type&&1!==n.type?this.as=this.as.nt(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.as=this.as.nt(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.as=this.as.nt(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.as=this.as.remove(e):1===t.type&&2===n.type?this.as=this.as.nt(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.as=this.as.nt(e,{type:2,doc:t.doc}):yu("unsupported combination of changes: "+JSON.stringify(t)+" after "+JSON.stringify(n))},Js.prototype.us=function(){var n=[];return this.as.ut(function(t,e){n.push(e)}),n},Js),Gs=(Xs.fs=function(t,e,n,i){var r=[];return e.forEach(function(t){r.push({type:0,doc:t})}),new Xs(t,e,qs.os(e),r,n,i,!0,!1)},Object.defineProperty(Xs.prototype,"hasPendingWrites",{get:function(){return!this.ls.q()},enumerable:!0,configurable:!0}),Xs.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this._s===t._s&&this.ls.isEqual(t.ls)&&this.query.isEqual(t.query)&&this.docs.isEqual(t.docs)&&this.cs.isEqual(t.cs)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var i=0;i<e.length;i++)if(e[i].type!==n[i].type||!e[i].doc.isEqual(n[i].doc))return!1;return!0},Xs),js=(Ws.Rs=function(t,e){var n=new Map;return n.set(t,Fs.Is(t,e)),new Ws(Bi.MIN,n,Vs(),Ts(),Ds())},Ws),Fs=(Qs.Is=function(t,e){return new Qs(Ar.Ut,e,Ds(),Ds(),Ds())},Qs),Bs=(Object.defineProperty(zs.prototype,"As",{get:function(){return this.Ds},enumerable:!0,configurable:!0}),Object.defineProperty(zs.prototype,"resumeToken",{get:function(){return this.Cs},enumerable:!0,configurable:!0}),Object.defineProperty(zs.prototype,"Ns",{get:function(){return 0!==this.vs},enumerable:!0,configurable:!0}),Object.defineProperty(zs.prototype,"ks",{get:function(){return this.Fs},enumerable:!0,configurable:!0}),zs.prototype.Ls=function(t){0<t.Mt()&&(this.Fs=!0,this.Cs=t)},zs.prototype.$s=function(){var n=Ds(),i=Ds(),r=Ds();return this.Ss.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:i=i.add(t);break;case 1:r=r.add(t);break;default:yu("Encountered invalid change type: "+e)}}),new Fs(this.Cs,this.Ds,n,i,r)},zs.prototype.Os=function(){this.Fs=!1,this.Ss=$s()},zs.prototype.Ms=function(t,e){this.Fs=!0,this.Ss=this.Ss.nt(t,e)},zs.prototype.Us=function(t){this.Fs=!0,this.Ss=this.Ss.remove(t)},zs.prototype.qs=function(){this.vs+=1},zs.prototype.Bs=function(){--this.vs},zs.prototype.xs=function(){this.Fs=!0,this.Ds=!0},zs),Hs=(Ys.prototype.Ks=function(t){for(var e=0,n=t.gs;e<n.length;e++){var i=n[e];t.ys instanceof Lo?this.Hs(i,t.ys):t.ys instanceof Do&&this.Js(i,t.key,t.ys)}for(var r=0,o=t.removedTargetIds;r<o.length;r++){var s=o[r];this.Js(s,t.key,t.ys)}},Ys.prototype.Ys=function(n){var i=this;this.Xs(n,function(t){var e=i.Zs(t);switch(n.state){case 0:i.ti(t)&&e.Ls(n.resumeToken);break;case 1:e.Bs(),e.Ns||e.Os(),e.Ls(n.resumeToken);break;case 2:e.Bs(),e.Ns||i.removeTarget(t);break;case 3:i.ti(t)&&(e.xs(),e.Ls(n.resumeToken));break;case 4:i.ti(t)&&(i.ei(t),e.Ls(n.resumeToken));break;default:yu("Unknown target watch change state: "+n.state)}})},Ys.prototype.Xs=function(t,n){var i=this;0<t.targetIds.length?t.targetIds.forEach(n):this.Ws.forEach(function(t,e){i.ti(e)&&n(e)})},Ys.prototype.si=function(t){var e=t.targetId,n=t.bs.count,i=this.ii(e);if(i){var r=i.target;if(r.Pe())if(0===n){var o=new sr(r.path);this.Js(e,o,new Do(o,Bi.S()))}else vu(1===n,"Single document existence filter with count: "+n);else this.ni(e)!==n&&(this.ei(e),this.zs=this.zs.add(e))}},Ys.prototype.ri=function(r){var o=this,s=new Map;this.Ws.forEach(function(t,e){var n=o.ii(e);if(n){if(t.As&&n.target.Pe()){var i=new sr(n.target.path);null!==o.js.get(i)||o.hi(e,i)||o.Js(e,i,new Do(i,r))}t.ks&&(s.set(e,t.$s()),t.Os())}});var i=Ds();this.Gs.forEach(function(t,e){var n=!0;e.Ft(function(t){var e=o.ii(t);return!e||2===e.Ze||(n=!1)}),n&&(i=i.add(t))});var t=new js(r,s,this.zs,this.js,i);return this.js=Ts(),this.Gs=Zs(),this.zs=new yr(wu),t},Ys.prototype.Hs=function(t,e){if(this.ti(t)){var n=this.hi(t,e.key)?2:0;this.Zs(t).Ms(e.key,n),this.js=this.js.nt(e.key,e),this.Gs=this.Gs.nt(e.key,this.oi(e.key).add(t))}},Ys.prototype.Js=function(t,e,n){if(this.ti(t)){var i=this.Zs(t);this.hi(t,e)?i.Ms(e,1):i.Us(e),this.Gs=this.Gs.nt(e,this.oi(e).delete(t)),n&&(this.js=this.js.nt(e,n))}},Ys.prototype.removeTarget=function(t){this.Ws.delete(t)},Ys.prototype.ni=function(t){var e=this.Zs(t).$s();return this.Qs.ai(t).size+e.Ps.size-e.ps.size},Ys.prototype.qs=function(t){this.Zs(t).qs()},Ys.prototype.Zs=function(t){var e=this.Ws.get(t);return e||(e=new Bs,this.Ws.set(t,e)),e},Ys.prototype.oi=function(t){var e=this.Gs.get(t);return e||(e=new yr(wu),this.Gs=this.Gs.nt(t,e)),e},Ys.prototype.ti=function(t){var e=null!==this.ii(t);return e||fu("WatchChangeAggregator","Detected inactive target",t),e},Ys.prototype.ii=function(t){var e=this.Ws.get(t);return e&&e.Ns?null:this.Qs.ui(t)},Ys.prototype.ei=function(e){var n=this;this.Ws.set(e,new Bs),this.Qs.ai(e).forEach(function(t){n.Js(e,t,null)})},Ys.prototype.hi=function(t,e){return this.Qs.ai(t).has(e)},Ys);function Ys(t){this.Qs=t,this.Ws=new Map,this.js=Ts(),this.Gs=Zs(),this.zs=new yr(wu)}function zs(){this.vs=0,this.Ss=$s(),this.Cs=Ar.Ut,this.Ds=!1,this.Fs=!0}function Qs(t,e,n,i,r){this.resumeToken=t,this.As=e,this.Ps=n,this.Vs=i,this.ps=r}function Ws(t,e,n,i,r){this.ts=t,this.ws=e,this.Ts=n,this.ms=i,this.Es=r}function Xs(t,e,n,i,r,o,s,u){this.query=t,this.docs=e,this.cs=n,this.docChanges=i,this.ls=r,this.fromCache=o,this._s=s,this.ds=u}function Js(){this.as=new ar(sr.k)}function Ks(n){this.k=n?function(t,e){return n(t,e)||sr.k(t.key,e.key)}:function(t,e){return sr.k(t.key,e.key)},this.rs=ks(),this.hs=new ar(this.k)}function Zs(){return new ar(sr.k)}function $s(){return new ar(sr.k)}var tu,eu,nu=((eu={})[is.ASCENDING.name]="ASCENDING",eu[is.DESCENDING.name]="DESCENDING",eu),iu=((tu={})[Po.LESS_THAN.name]="LESS_THAN",tu[Po.LESS_THAN_OR_EQUAL.name]="LESS_THAN_OR_EQUAL",tu[Po.GREATER_THAN.name]="GREATER_THAN",tu[Po.GREATER_THAN_OR_EQUAL.name]="GREATER_THAN_OR_EQUAL",tu[Po.EQUAL.name]="EQUAL",tu[Po.ARRAY_CONTAINS.name]="ARRAY_CONTAINS",tu[Po.IN.name]="IN",tu[Po.ARRAY_CONTAINS_ANY.name]="ARRAY_CONTAINS_ANY",tu),ru=(ou.prototype.li=function(t){var e=void 0===t.code?Pi.UNKNOWN:Is(t.code);return new Mi(e,t.message||"")},ou.prototype._i=function(t){return this.options.di||Nr(t)?t:{value:t}},ou.prototype.fi=function(t){var e;return Nr(e="object"==typeof t?t.value:t)?null:e},ou.prototype.Wt=function(t){return{integerValue:""+t}},ou.prototype.jt=function(t){if(this.options.di){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Tr(t)?"-0":t}},ou.prototype.wi=function(t){return"number"==typeof(e=t)&&Number.isInteger(e)&&!Tr(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER?this.Wt(t):this.jt(t);var e},ou.prototype.F=function(t){return this.options.di?new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+t.nanoseconds).slice(-9)+"Z":{seconds:""+t.seconds,nanos:t.nanoseconds}},ou.prototype.v=function(t){var e=Ur(t);return new Fi(e.seconds,e.nanos)},ou.prototype.Ti=function(t){return this.options.di?t.toBase64():t.toUint8Array()},ou.prototype.mi=function(t){return this.options.di?(vu(void 0===t||"string"==typeof t,"value must be undefined or a string when using proto3 Json"),Ar.fromBase64String(t||"")):(vu(void 0===t||t instanceof Uint8Array,"value must be undefined or Uint8Array"),Ar.fromUint8Array(t||new Uint8Array))},ou.prototype.toVersion=function(t){return this.F(t.F())},ou.prototype.fromVersion=function(t){return vu(!!t,"Trying to deserialize version that isn't set"),Bi.v(this.v(t))},ou.prototype.Ei=function(t,e){return this.Ri(e||this.ci).child("documents").child(t).G()},ou.prototype.Ii=function(t){var e=$i.K(t);return vu(su(e),"Tried to deserialize invalid key "+e.toString()),e},ou.prototype.Ai=function(t){return this.Ei(t.path)},ou.prototype.tt=function(t){var e=this.Ii(t);return vu(e.get(1)===this.ci.projectId,"Tried to deserialize key from different project: "+e.get(1)+" vs "+this.ci.projectId),vu(!e.get(3)&&!this.ci.database||e.get(3)===this.ci.database,"Tried to deserialize key from different database: "+e.get(3)+" vs "+this.ci.database),new sr(this.Pi(e))},ou.prototype.Vi=function(t){return this.Ei(t)},ou.prototype.pi=function(t){var e=this.Ii(t);return 4===e.length?$i.H:this.Pi(e)},Object.defineProperty(ou.prototype,"gi",{get:function(){return new $i(["projects",this.ci.projectId,"databases",this.ci.database]).G()},enumerable:!0,configurable:!0}),ou.prototype.Ri=function(t){return new $i(["projects",t.projectId,"databases",t.database])},ou.prototype.Pi=function(t){return vu(4<t.length&&"documents"===t.get(4),"tried to deserialize invalid key "+t.toString()),t.$(5)},ou.prototype.yi=function(t,e){return{name:this.Ai(t),fields:e.proto.mapValue.fields}},ou.prototype.bi=function(t){return{name:this.Ai(t.key),fields:t.Re().mapValue.fields,updateTime:this.F(t.version.F())}},ou.prototype.vi=function(t,e){var n=this.tt(t.name),i=this.fromVersion(t.updateTime),r=new mo({mapValue:{fields:t.fields}});return new Lo(n,i,r,{hasCommittedMutations:!!e})},ou.prototype.Si=function(t){vu(!!t.found,"Tried to deserialize a found document from a missing document."),t.found.name,t.found.updateTime;var e=this.tt(t.found.name),n=this.fromVersion(t.found.updateTime),i=new mo({mapValue:{fields:t.found.fields}});return new Lo(e,n,i,{})},ou.prototype.Ci=function(t){vu(!!t.missing,"Tried to deserialize a missing document from a found document."),vu(!!t.readTime,"Tried to deserialize a missing document without a read time.");var e=this.tt(t.missing),n=this.fromVersion(t.readTime);return new Do(e,n)},ou.prototype.Di=function(t){return"found"in t?this.Si(t):"missing"in t?this.Ci(t):yu("invalid batch get response: "+JSON.stringify(t))},ou.prototype.Fi=function(t){var e;if("targetChange"in t){t.targetChange;var n=this.Ni(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],r=this.mi(t.targetChange.resumeToken),o=t.targetChange.cause;e=new Ms(n,i,r,o&&this.li(o)||null)}else if("documentChange"in t){t.documentChange;var s=t.documentChange;s.document,s.document.name,s.document.updateTime;var u=this.tt(s.document.name),a=this.fromVersion(s.document.updateTime),h=new mo({mapValue:{fields:s.document.fields}}),c=new Lo(u,a,h,{});e=new Us(s.targetIds||[],s.removedTargetIds||[],c.key,c)}else if("documentDelete"in t){t.documentDelete;var l=t.documentDelete;l.document;var f=this.tt(l.document),p=l.readTime?this.fromVersion(l.readTime):Bi.S(),d=new Do(f,p);e=new Us([],l.removedTargetIds||[],d.key,d)}else if("documentRemove"in t){t.documentRemove;var y=t.documentRemove;y.document;var v=this.tt(y.document);e=new Us([],y.removedTargetIds||[],v,null)}else{if(!("filter"in t))return yu("Unknown change type "+JSON.stringify(t));t.filter;var g=t.filter;g.targetId;var m=new ls(g.count||0);e=new Ps(g.targetId,m)}return e},ou.prototype.Ni=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:yu("Got unexpected TargetChange.state: "+t)},ou.prototype.ki=function(t){if(!("targetChange"in t))return Bi.MIN;var e=t.targetChange;return e.targetIds&&e.targetIds.length||!e.readTime?Bi.MIN:this.fromVersion(e.readTime)},ou.prototype.Li=function(t){var e,n=this;if(t instanceof fo)e={update:this.yi(t.key,t.value)};else if(t instanceof vo)e={delete:this.Ai(t.key)};else if(t instanceof po)e={update:this.yi(t.key,t.data),updateMask:this.$i(t.se)};else if(t instanceof yo)e={transform:{document:this.Ai(t.key),fieldTransforms:t.fieldTransforms.map(function(t){return n.Oi(t)})}};else{if(!(t instanceof go))return yu("Unknown mutation type "+t.type);e={verify:this.Ai(t.key)}}return t.Zt.Ht||(e.currentDocument=this.Mi(t.Zt)),e},ou.prototype.Ui=function(t){var e=this,n=t.currentDocument?this.qi(t.currentDocument):no.NONE;if(t.update){t.update.name;var i=this.tt(t.update.name),r=new mo({mapValue:{fields:t.update.fields}});if(t.updateMask){var o=this.Bi(t.updateMask);return new po(i,r,o,n)}return new fo(i,r,n)}if(t.delete){var s=this.tt(t.delete);return new vo(s,n)}if(t.transform){var u=this.tt(t.transform.document),a=t.transform.fieldTransforms.map(function(t){return e.xi(t)});return vu(!0===n.exists,'Transforms only support precondition "exists == true"'),new yo(u,a)}if(t.verify){var h=this.tt(t.verify);return new go(h,n)}return yu("unknown mutation proto: "+JSON.stringify(t))},ou.prototype.Mi=function(t){return void 0!==t.updateTime?{updateTime:this.toVersion(t.updateTime)}:void 0!==t.exists?{exists:t.exists}:yu("Unknown precondition")},ou.prototype.qi=function(t){return void 0!==t.updateTime?no.updateTime(this.fromVersion(t.updateTime)):void 0!==t.exists?no.exists(t.exists):no.NONE},ou.prototype.Qi=function(t,e){var n=t.updateTime?this.fromVersion(t.updateTime):this.fromVersion(e);n.isEqual(Bi.MIN)&&(n=this.fromVersion(e));var i=null;return t.transformResults&&0<t.transformResults.length&&(i=t.transformResults),new $r(n,i)},ou.prototype.Wi=function(t,e){var n=this;return t&&0<t.length?(vu(void 0!==e,"Received a write result without a commit time"),t.map(function(t){return n.Qi(t,e)})):[]},ou.prototype.Oi=function(t){var e=t.transform;if(e instanceof Hr)return{fieldPath:t.field.G(),setToServerValue:"REQUEST_TIME"};if(e instanceof zr)return{fieldPath:t.field.G(),appendMissingElements:{values:e.elements}};if(e instanceof Qr)return{fieldPath:t.field.G(),removeAllFromArray:{values:e.elements}};if(e instanceof Wr)return{fieldPath:t.field.G(),increment:e.Qt};throw yu("Unknown transform: "+t.transform)},ou.prototype.xi=function(t){var e=null;if("setToServerValue"in t)vu("REQUEST_TIME"===t.setToServerValue,"Unknown server value transform proto: "+JSON.stringify(t)),e=Hr.instance;else if("appendMissingElements"in t){var n=t.appendMissingElements.values||[];e=new zr(n)}else if("removeAllFromArray"in t){var i=t.removeAllFromArray.values||[];e=new Qr(i)}else"increment"in t?e=new Wr(this,t.increment):yu("Unknown transform proto: "+JSON.stringify(t));var r=rr.Z(t.fieldPath);return new eo(r,e)},ou.prototype.ji=function(t){return{documents:[this.Vi(t.path)]}},ou.prototype.Gi=function(t){var e=t.documents.length;vu(1===e,"DocumentsTarget contained other than 1 document: "+e);var n=t.documents[0];return Uo.ve(this.pi(n)).Ue()},ou.prototype.zi=function(t){var e={structuredQuery:{}},n=t.path;null!==t.collectionGroup?(e.parent=this.Vi(n),e.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(e.parent=this.Vi(n.O()),e.structuredQuery.from=[{collectionId:n.U()}]);var i=this.Ki(t.filters);i&&(e.structuredQuery.where=i);var r=this.Hi(t.orderBy);r&&(e.structuredQuery.orderBy=r);var o=this._i(t.limit);return null!==o&&(e.structuredQuery.limit=o),t.startAt&&(e.structuredQuery.startAt=this.Ji(t.startAt)),t.endAt&&(e.structuredQuery.endAt=this.Ji(t.endAt)),e},ou.prototype.Yi=function(t){var e=this.pi(t.parent),n=t.structuredQuery,i=n.from?n.from.length:0,r=null;if(0<i){vu(1===i,"StructuredQuery.from with more than one collection is not supported.");var o=n.from[0];o.allDescendants?r=o.collectionId:e=e.child(o.collectionId)}var s=[];n.where&&(s=this.Xi(n.where));var u=[];n.orderBy&&(u=this.Zi(n.orderBy));var a=null;n.limit&&(a=this.fi(n.limit));var h=null;n.startAt&&(h=this.tn(n.startAt));var c=null;return n.endAt&&(c=this.tn(n.endAt)),new Uo(e,r,u,s,a,"F",h,c).Ue()},ou.prototype.en=function(t){var e=this.sn(t.Ze);return null==e?null:{"goog-listen-tags":e}},ou.prototype.sn=function(t){switch(t){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return yu("Unrecognized query purpose: "+t)}},ou.prototype.Ue=function(t){var e,n=t.target;return(e=n.Pe()?{documents:this.ji(n)}:{query:this.zi(n)}).targetId=t.targetId,0<t.resumeToken.Mt()&&(e.resumeToken=this.Ti(t.resumeToken)),e},ou.prototype.Ki=function(t){var e=this;if(0!==t.length){var n=t.map(function(t){return t instanceof Ko?e.in(t):yu("Unrecognized filter: "+JSON.stringify(t))});return 1===n.length?n[0]:{compositeFilter:{op:"AND",filters:n}}}},ou.prototype.Xi=function(t){var e=this;return t?void 0!==t.unaryFilter?[this.nn(t)]:void 0!==t.fieldFilter?[this.rn(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map(function(t){return e.Xi(t)}).reduce(function(t,e){return t.concat(e)}):yu("Unknown filter: "+JSON.stringify(t)):[]},ou.prototype.Hi=function(t){var e=this;if(0!==t.length)return t.map(function(t){return e.hn(t)})},ou.prototype.Zi=function(t){var e=this;return t.map(function(t){return e.on(t)})},ou.prototype.Ji=function(t){return{before:t.before,values:t.position}},ou.prototype.tn=function(t){var e=!!t.before,n=t.values||[];return new ds(n,e)},ou.prototype.an=function(t){return nu[t.name]},ou.prototype.un=function(t){switch(t){case"ASCENDING":return is.ASCENDING;case"DESCENDING":return is.DESCENDING;default:return}},ou.prototype.cn=function(t){return iu[t.name]},ou.prototype.ln=function(t){switch(t){case"EQUAL":return Po.EQUAL;case"GREATER_THAN":return Po.GREATER_THAN;case"GREATER_THAN_OR_EQUAL":return Po.GREATER_THAN_OR_EQUAL;case"LESS_THAN":return Po.LESS_THAN;case"LESS_THAN_OR_EQUAL":return Po.LESS_THAN_OR_EQUAL;case"ARRAY_CONTAINS":return Po.ARRAY_CONTAINS;case"IN":return Po.IN;case"ARRAY_CONTAINS_ANY":return Po.ARRAY_CONTAINS_ANY;case"OPERATOR_UNSPECIFIED":return yu("Unspecified operator");default:return yu("Unknown operator")}},ou.prototype._n=function(t){return{fieldPath:t.G()}},ou.prototype.dn=function(t){return rr.Z(t.fieldPath)},ou.prototype.hn=function(t){return{field:this._n(t.field),direction:this.an(t.dir)}},ou.prototype.on=function(t){return new ys(this.dn(t.field),this.un(t.direction))},ou.prototype.rn=function(t){return Ko.create(this.dn(t.fieldFilter.field),this.ln(t.fieldFilter.op),t.fieldFilter.value)},ou.prototype.in=function(t){if(t.op===Po.EQUAL){if(Fr(t.value))return{unaryFilter:{field:this._n(t.field),op:"IS_NAN"}};if(jr(t.value))return{unaryFilter:{field:this._n(t.field),op:"IS_NULL"}}}return{fieldFilter:{field:this._n(t.field),op:this.cn(t.op),value:t.value}}},ou.prototype.nn=function(t){switch(t.unaryFilter.op){case"IS_NAN":var e=this.dn(t.unaryFilter.field);return Ko.create(e,Po.EQUAL,{doubleValue:NaN});case"IS_NULL":var n=this.dn(t.unaryFilter.field);return Ko.create(n,Po.EQUAL,{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return yu("Unspecified filter");default:return yu("Unknown filter")}},ou.prototype.$i=function(t){var e=[];return t.fields.forEach(function(t){return e.push(t.G())}),{fieldPaths:e}},ou.prototype.Bi=function(t){var e=(t.fieldPaths||[]).map(function(t){return rr.Z(t)});return to.zt(e)},ou);function ou(t,e){this.ci=t,this.options=e}function su(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}var uu=(hu.fn=function(t){hu.platform&&yu("Platform already defined"),hu.platform=t},hu.Ot=function(){return hu.platform||yu("Platform not set"),hu.platform},hu),au=new l("@firebase/firestore");function hu(){}function cu(){return au.logLevel}function lu(t){au.logLevel=t}function fu(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(au.logLevel<=u.DEBUG){var i=e.map(du);au.debug.apply(au,r(["Firestore ("+Li+"): "+t],i))}}function pu(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(au.logLevel<=u.ERROR){var i=e.map(du);au.error.apply(au,r(["Firestore ("+Li+"): "+t],i))}}function du(t){if("string"==typeof t)return t;var e=uu.Ot();try{return e.wn(t)}catch(e){return t}}function yu(t){var e="FIRESTORE ("+Li+") INTERNAL ASSERTION FAILED: "+t;throw pu(e),new Error(e)}function vu(t,e){t||yu(e)}var gu=(mu.Tn=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e="",n=0;n<20;n++)e+=t.charAt(Math.floor(Math.random()*t.length));return e},mu);function mu(){}function wu(t,e){return t<e?-1:e<t?1:0}function bu(t,n,i){return t.length===n.length&&t.every(function(t,e){return i(t,n[e])})}function Eu(t,e,n,i,r){this.ci=t,this.persistenceKey=e,this.host=n,this.ssl=i,this.forceLongPolling=r}var Au=(Object.defineProperty(ju.prototype,"mn",{get:function(){return"(default)"===this.database},enumerable:!0,configurable:!0}),ju.prototype.isEqual=function(t){return t instanceof ju&&t.projectId===this.projectId&&t.database===this.database},ju.prototype.C=function(t){return wu(this.projectId,t.projectId)||wu(this.database,t.database)},ju),Iu=(Gu.prototype.get=function(t){var e=this.En(t),n=this.Rn[e];if(void 0!==n)for(var i=0,r=n;i<r.length;i++){var o=r[i],s=o[0],u=o[1];if(s.isEqual(t))return u}},Gu.prototype.has=function(t){return void 0!==this.get(t)},Gu.prototype.set=function(t,e){var n=this.En(t),i=this.Rn[n];if(void 0!==i){for(var r=0;r<i.length;r++)if(i[r][0].isEqual(t))return void(i[r]=[t,e]);i.push([t,e])}else this.Rn[n]=[[t,e]]},Gu.prototype.delete=function(t){var e=this.En(t),n=this.Rn[e];if(void 0===n)return!1;for(var i=0;i<n.length;i++)if(n[i][0].isEqual(t))return 1===n.length?delete this.Rn[e]:n.splice(i,1),!0;return!1},Gu.prototype.forEach=function(u){br(this.Rn,function(t,e){for(var n=0,i=e;n<i.length;n++){var r=i[n],o=r[0],s=r[1];u(o,s)}})},Gu.prototype.q=function(){return Er(this.Rn)},Gu),Nu=(xu.prototype.Bt=function(t,e,n){for(var i=n.An,r=0;r<this.mutations.length;r++){var o=this.mutations[r];if(o.key.isEqual(t)){var s=i[r];e=o.Bt(e,s)}}return e},xu.prototype.qt=function(t,e){for(var n=0,i=this.baseMutations;n<i.length;n++){var r=i[n];r.key.isEqual(t)&&(e=r.qt(e,e,this.In))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=a.qt(e,o,this.In))}return e},xu.prototype.Pn=function(n){var i=this,r=n;return this.mutations.forEach(function(t){var e=i.qt(t.key,n.get(t.key));e&&(r=r.nt(t.key,e))}),r},xu.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},Ds())},xu.prototype.isEqual=function(t){return this.batchId===t.batchId&&bu(this.mutations,t.mutations,function(t,e){return t.isEqual(e)})&&bu(this.baseMutations,t.baseMutations,function(t,e){return t.isEqual(e)})},xu),Tu=(qu.from=function(t,e,n,i){vu(t.mutations.length===n.length,"Mutations sent "+t.mutations.length+" must equal results received "+n.length);for(var r=Os(),o=t.mutations,s=0;s<o.length;s++)r=r.nt(o[s].key,n[s].version);return new qu(t,e,n,i,r)},qu),_u=(Mu.prototype.q=function(){return this.gn.q()},Mu.prototype.vn=function(t,e){var n=new Su(t,e);this.gn=this.gn.add(n),this.yn=this.yn.add(n)},Mu.prototype.Sn=function(t,e){var n=this;t.forEach(function(t){return n.vn(t,e)})},Mu.prototype.Cn=function(t,e){this.Dn(new Su(t,e))},Mu.prototype.Fn=function(t,e){var n=this;t.forEach(function(t){return n.Cn(t,e)})},Mu.prototype.Nn=function(t){var e=this,n=sr.EMPTY,i=new Su(n,t),r=new Su(n,t+1),o=[];return this.yn.Dt([i,r],function(t){e.Dn(t),o.push(t.key)}),o},Mu.prototype.kn=function(){var e=this;this.gn.forEach(function(t){return e.Dn(t)})},Mu.prototype.Dn=function(t){this.gn=this.gn.delete(t),this.yn=this.yn.delete(t)},Mu.prototype.Ln=function(t){var e=sr.EMPTY,n=new Su(e,t),i=new Su(e,t+1),r=Ds();return this.yn.Dt([n,i],function(t){r=r.add(t.key)}),r},Mu.prototype.$n=function(t){var e=new Su(t,0),n=this.gn.Nt(e);return null!==n&&t.isEqual(n.key)},Mu),Su=(Pu.me=function(t,e){return sr.k(t.key,e.key)||wu(t.On,e.On)},Pu.bn=function(t,e){return wu(t.On,e.On)||sr.k(t.key,e.key)},Pu),ku=(Uu.prototype.catch=function(t){return this.next(void 0,t)},Uu.prototype.next=function(i,r){var o=this;return this.Bn&&yu("Called next() or catch() twice for PersistencePromise"),this.Bn=!0,this.qn?this.error?this.xn(r,this.error):this.Qn(i,this.result):new Uu(function(e,n){o.Mn=function(t){o.Qn(i,t).next(e,n)},o.Un=function(t){o.xn(r,t).next(e,n)}})},Uu.prototype.Wn=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},Uu.prototype.jn=function(t){try{var e=t();return e instanceof Uu?e:Uu.resolve(e)}catch(t){return Uu.reject(t)}},Uu.prototype.Qn=function(t,e){return t?this.jn(function(){return t(e)}):Uu.resolve(e)},Uu.prototype.xn=function(t,e){return t?this.jn(function(){return t(e)}):Uu.reject(e)},Uu.resolve=function(n){return new Uu(function(t,e){t(n)})},Uu.reject=function(n){return new Uu(function(t,e){e(n)})},Uu.Gn=function(t){return new Uu(function(e,n){var i=0,r=0,o=!1;t.forEach(function(t){++i,t.next(function(){++r,o&&r===i&&e()},function(t){return n(t)})}),o=!0,r===i&&e()})},Uu.zn=function(t){for(var n=Uu.resolve(!1),e=function(e){n=n.next(function(t){return t?Uu.resolve(t):e()})},i=0,r=t;i<r.length;i++)e(r[i]);return n},Uu.forEach=function(t,n){var i=this,r=[];return t.forEach(function(t,e){r.push(n.call(i,t,e))}),this.Gn(r)},Uu),Ru=(Vu.prototype.Yn=function(e,n){var i=this;return this.Hn.Xn(e,n).next(function(t){return i.Zn(e,n,t)})},Vu.prototype.Zn=function(t,i,r){return this.Kn.tr(t,i).next(function(t){for(var e=0,n=r;e<n.length;e++)t=n[e].qt(i,t);return t})},Vu.prototype.er=function(t,e,r){var o=_s();return e.forEach(function(t,e){for(var n=0,i=r;n<i.length;n++)e=i[n].qt(t,e);o=o.nt(t,e)}),o},Vu.prototype.sr=function(e,t){var n=this;return this.Kn.getEntries(e,t).next(function(t){return n.ir(e,t)})},Vu.prototype.ir=function(i,r){var o=this;return this.Hn.nr(i,r).next(function(t){var e=o.er(i,r,t),n=Ts();return e.forEach(function(t,e){e=e||new Do(t,Bi.S()),n=n.nt(t,e)}),n})},Vu.prototype.rr=function(t,e,n){return e.Pe()?this.hr(t,e.path):e.He()?this.or(t,e,n):this.ar(t,e,n)},Vu.prototype.hr=function(t,e){return this.Yn(t,new sr(e)).next(function(t){var e=ks();return t instanceof Lo&&(e=e.nt(t.key,t)),e})},Vu.prototype.or=function(n,i,r){var o=this,s=i.collectionGroup,u=ks();return this.Jn.ur(n,s).next(function(t){return ku.forEach(t,function(t){var e=i.Oe(t.child(s));return o.ar(n,e,r).next(function(t){t.forEach(function(t,e){u=u.nt(t,e)})})}).next(function(){return u})})},Vu.prototype.ar=function(e,n,t){var c,l,i=this;return this.Kn.rr(e,n,t).next(function(t){return c=t,i.Hn.cr(e,n)}).next(function(t){return l=t,i.lr(e,l,c).next(function(t){c=t;for(var e=0,n=l;e<n.length;e++)for(var i=n[e],r=0,o=i.mutations;r<o.length;r++){var s=o[r],u=s.key,a=c.get(u),h=s.qt(a,a,i.In);c=h instanceof Lo?c.nt(u,h):c.remove(u)}})}).next(function(){return c.forEach(function(t,e){n.matches(e)||(c=c.remove(t))}),c})},Vu.prototype.lr=function(t,e,n){for(var i=Ds(),r=0,o=e;r<o.length;r++)for(var s=0,u=o[r].mutations;s<u.length;s++){var a=u[s];a instanceof po&&null===n.get(a.key)&&(i=i.add(a.key))}var h=n;return this.Kn.getEntries(t,i).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof Lo&&(h=h.nt(t,e))}),h})},Vu),Ou=(Cu.wr=function(t,e){for(var n=Ds(),i=Ds(),r=0,o=e.docChanges;r<o.length;r++){var s=o[r];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}}return new Cu(t,e.fromCache,n,i)},Cu),Lu=(Du.prototype.mr=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},Du.prototype.next=function(){var t=++this.previousValue;return this.Er&&this.Er(t),t},Du);function Du(t,e){var n=this;this.previousValue=t,e&&(e.Tr=function(t){return n.mr(t)},this.Er=function(t){return e.Rr(t)})}function Cu(t,e,n,i){this.targetId=t,this.fromCache=e,this._r=n,this.dr=i}function Vu(t,e,n){this.Kn=t,this.Hn=e,this.Jn=n}function Uu(t){var e=this;this.Mn=null,this.Un=null,this.result=void 0,this.error=void 0,this.qn=!1,this.Bn=!1,t(function(t){e.qn=!0,e.result=t,e.Mn&&e.Mn(t)},function(t){e.qn=!0,e.error=t,e.Un&&e.Un(t)})}function Pu(t,e){this.key=t,this.On=e}function Mu(){this.gn=new yr(Su.me),this.yn=new yr(Su.bn)}function qu(t,e,n,i,r){this.batch=t,this.Vn=e,this.An=n,this.streamToken=i,this.pn=r}function xu(t,e,n,i){this.batchId=t,this.In=e,this.baseMutations=n,this.mutations=i}function Gu(t){this.En=t,this.Rn={}}function ju(t,e){this.projectId=t,this.database=e||"(default)"}function Fu(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})}Lu.Ir=-1;var Bu=(Wu.yr=function(t,e,n,i,r){var o=new Wu(t,e,Date.now()+n,i,r);return o.start(n),o},Wu.prototype.start=function(t){var e=this;this.br=setTimeout(function(){return e.vr()},t)},Wu.prototype.Sr=function(){return this.vr()},Wu.prototype.cancel=function(t){null!==this.br&&(this.clearTimeout(),this.gr.reject(new Mi(Pi.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},Wu.prototype.vr=function(){var e=this;this.Ar.Cr(function(){return null!==e.br?(e.clearTimeout(),e.op().then(function(t){return e.gr.resolve(t)})):Promise.resolve()})},Wu.prototype.clearTimeout=function(){null!==this.br&&(this.pr(this),clearTimeout(this.br),this.br=null)},Wu),Hu=(Object.defineProperty(Qu.prototype,"Or",{get:function(){return this.Fr},enumerable:!0,configurable:!0}),Qu.prototype.Cr=function(t){this.enqueue(t)},Qu.prototype.Mr=function(t){this.Ur(),this.qr(t)},Qu.prototype.Br=function(t){return this.Ur(),this.qr(t)},Qu.prototype.xr=function(e){return c(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.Ur(),this.Fr?[3,2]:(this.Fr=!0,[4,this.Br(e)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},Qu.prototype.enqueue=function(t){return this.Ur(),this.Fr?new Promise(function(t){}):this.qr(t)},Qu.prototype.qr=function(t){var e=this,n=this.Dr.then(function(){return e.Lr=!0,t().catch(function(t){throw e.kr=t,e.Lr=!1,pu("INTERNAL UNHANDLED ERROR: ",t.stack||t.message||""),t}).then(function(t){return e.Lr=!1,t})});return this.Dr=n},Qu.prototype.Qr=function(t,e,n){var i=this;this.Ur(),-1<this.$r.indexOf(t)&&(e=0);var r=Bu.yr(this,t,e,n,function(t){return i.Wr(t)});return this.Nr.push(r),r},Qu.prototype.Ur=function(){this.kr&&yu("AsyncQueue is already failed: "+(this.kr.stack||this.kr.message))},Qu.prototype.jr=function(){},Qu.prototype.Gr=function(){return c(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return[4,e=this.Dr];case 1:t.sent(),t.label=2;case 2:if(e!==this.Dr)return[3,0];t.label=3;case 3:return[2]}})})},Qu.prototype.zr=function(t){for(var e=0,n=this.Nr;e<n.length;e++)if(n[e].Pr===t)return!0;return!1},Qu.prototype.Kr=function(i){var r=this;return this.Gr().then(function(){r.Nr.sort(function(t,e){return t.Vr-e.Vr});for(var t=0,e=r.Nr;t<e.length;t++){var n=e[t];if(n.Sr(),"all"!==i&&n.Pr===i)break}return r.Gr()})},Qu.prototype.Hr=function(t){this.$r.push(t)},Qu.prototype.Wr=function(t){var e=this.Nr.indexOf(t);this.Nr.splice(e,1)},Qu),Yu=(zu.Zr=function(t){return new zu(t,zu.th,zu.eh)},zu);function zu(t,e,n){this.Jr=t,this.Yr=e,this.Xr=n}function Qu(){this.Dr=Promise.resolve(),this.Fr=!1,this.Nr=[],this.kr=null,this.Lr=!1,this.$r=[]}function Wu(t,e,n,i,r){this.Ar=t,this.Pr=e,this.Vr=n,this.op=i,this.pr=r,this.gr=new Fu,this.then=this.gr.promise.then.bind(this.gr.promise),this.catch=this.gr.promise.catch.bind(this.gr.promise),this.gr.promise.catch(function(t){})}Yu.sh=-1,Yu.ih=1048576,Yu.nh=41943040,Yu.th=10,Yu.eh=1e3,Yu.rh=new Yu(Yu.nh,Yu.th,Yu.eh),Yu.DISABLED=new Yu(Yu.sh,0,0);var Xu=(Ju.prototype.start=function(){return this.Ph()},Ju.prototype.Vh=function(r){return c(this,void 0,void 0,function(){var e,m,n,i=this;return y(this,function(t){switch(t.label){case 0:return e=this.Hn,m=this.Rh,[4,this.persistence.runTransaction("Handle user change","readonly",function(v){var g;return i.Hn.ph(v).next(function(t){return g=t,e=i.persistence.fh(r),m=new Ru(i.wh,e,i.persistence.Ih()),e.ph(v)}).next(function(t){for(var e=[],n=[],i=Ds(),r=0,o=g;r<o.length;r++){var s=o[r];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++){var h=a[u];i=i.add(h.key)}}for(var c=0,l=t;c<l.length;c++){var f=l[c];n.push(f.batchId);for(var p=0,d=f.mutations;p<d.length;p++){var y=d[p];i=i.add(y.key)}}return m.sr(v,i).next(function(t){return{gh:t,yh:e,bh:n}})})})];case 1:return n=t.sent(),[2,(this.Hn=e,this.Rh=m,this.hh.Ah(this.Rh),n)]}})})},Ju.prototype.vh=function(u){var a,h=this,c=Fi.now(),t=u.reduce(function(t,e){return t.add(e.key)},Ds());return this.persistence.runTransaction("Locally write mutations","readwrite",function(s){return h.Rh.sr(s,t).next(function(t){a=t;for(var e=[],n=0,i=u;n<i.length;n++){var r=i[n],o=r.ee(a.get(r.key));null!=o&&e.push(new po(r.key,o,o.se(),no.exists(!0)))}return h.Hn.Sh(s,c,e,u)})}).then(function(t){var e=t.Pn(a);return{batchId:t.batchId,Ch:e}})},Ju.prototype.Dh=function(t){var n=this;return this.persistence.runTransaction("Lookup mutation documents","readonly",function(e){return n.Hn.Fh(e,t).next(function(t){return t?n.Rh.sr(e,t):ku.resolve(null)})})},Ju.prototype.Nh=function(i){var r=this;return this.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var e=i.batch.keys(),n=r.wh.kh({Lh:!0});return r.Hn.Nh(t,i.batch,i.streamToken).next(function(){return r.$h(t,i,n)}).next(function(){return n.apply(t)}).next(function(){return r.Hn.Oh(t)}).next(function(){return r.Rh.sr(t,e)})})},Ju.prototype.Mh=function(t){var i=this;return this.persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return i.Hn.Uh(e,t).next(function(t){return vu(null!==t,"Attempt to reject nonexistent batch!"),n=t.keys(),i.Hn.qh(e,t)}).next(function(){return i.Hn.Oh(e)}).next(function(){return i.Rh.sr(e,n)})})},Ju.prototype.Bh=function(){var e=this;return this.persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.Hn.Bh(t)})},Ju.prototype.xh=function(){var e=this;return this.persistence.runTransaction("Get last stream token","readonly",function(t){return e.Hn.xh(t)})},Ju.prototype.Qh=function(e){var n=this;return this.persistence.runTransaction("Set last stream token","readwrite-primary",function(t){return n.Hn.Qh(t,e)})},Ju.prototype.Wh=function(){var e=this;return this.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.mh.Wh(t)})},Ju.prototype.jh=function(a){var h=this,c=a.ts,l=this.ah;return this.persistence.runTransaction("Apply remote event","readwrite-primary",function(o){var r=h.wh.kh({Lh:!0});l=h.ah;var s=[];a.ws.forEach(function(t,e){var n=l.get(e);if(n){s.push(h.mh.Gh(o,t.ps,e).next(function(){return h.mh.zh(o,t.Ps,e)}));var i=t.resumeToken;if(0<i.Mt()){var r=n.ss(i,c).es(o.Kh);l=l.nt(e,r),Ju.Hh(n,r,t)&&s.push(h.mh.Jh(o,r))}}});var u=Ts(),n=Ds();if(a.ms.forEach(function(t,e){n=n.add(t)}),s.push(r.getEntries(o,n).next(function(i){a.ms.forEach(function(t,e){var n=i.get(t);e instanceof Do&&e.version.isEqual(Bi.MIN)?(r.Yh(t,c),u=u.nt(t,e)):null==n||0<e.version.C(n.version)||0===e.version.C(n.version)&&n.hasPendingWrites?(r.Xh(e,c),u=u.nt(t,e)):fu("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version),a.Es.has(t)&&s.push(h.persistence.dh.Zh(o,t))})})),!c.isEqual(Bi.MIN)){var t=h.mh.Wh(o).next(function(t){return h.mh.to(o,o.Kh,c)});s.push(t)}return ku.Gn(s).next(function(){return r.apply(o)}).next(function(){return h.Rh.ir(o,u)})}).then(function(t){return h.ah=l,t})},Ju.Hh=function(t,e,n){return vu(0<e.resumeToken.Mt(),"Attempted to persist target data with no resume token"),0===t.resumeToken.Mt()||e.ts.D()-t.ts.D()>=this.eo||0<n.Ps.size+n.Vs.size+n.ps.size},Ju.prototype.so=function(t){for(var n=this,e=0,i=t;e<i.length;e++){var r=i[e],o=r.targetId;if(this.oh.Sn(r._r,o),this.oh.Fn(r.dr,o),!r.fromCache){var s=this.ah.get(o),u=s.ts,a=s.ns(u);this.ah=this.ah.nt(o,a)}}return this.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(e){return ku.forEach(t,function(t){return ku.forEach(t.dr,function(t){return n.persistence.dh.Cn(e,t)})})})},Ju.prototype.io=function(e){var n=this;return this.persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===e&&(e=-1),n.Hn.no(t,e)})},Ju.prototype.ro=function(e){var n=this;return this.persistence.runTransaction("read document","readonly",function(t){return n.Rh.Yn(t,e)})},Ju.prototype.ho=function(i){var r=this;return this.persistence.runTransaction("Allocate target","readwrite",function(e){var n;return r.mh.oo(e,i).next(function(t){return t?(n=t,ku.resolve(n)):r.mh.ao(e).next(function(t){return n=new ms(i,t,0,e.Kh),r.mh.uo(e,n).next(function(){return n})})})}).then(function(t){return null===r.ah.get(t.targetId)&&(r.ah=r.ah.nt(t.targetId,t),r.uh.set(i,t.targetId)),t})},Ju.prototype.oo=function(t,e){var n=this.uh.get(e);return void 0!==n?ku.resolve(this.ah.get(n)):this.mh.oo(t,e)},Ju.prototype.co=function(n,i){var r=this,o=this.ah.get(n),t=i?"readwrite":"readwrite-primary";return this.persistence.runTransaction("Release target",t,function(e){var t=r.oh.Nn(n);return i?ku.resolve():ku.forEach(t,function(t){return r.persistence.dh.Cn(e,t)}).next(function(){r.persistence.dh.removeTarget(e,o)})}).then(function(){r.ah=r.ah.remove(n),r.uh.delete(o.target)})},Ju.prototype.lo=function(t,n){var i=this,r=Bi.MIN,o=Ds();return this.persistence.runTransaction("Execute query","readonly",function(e){return i.oo(e,t.Ue()).next(function(t){if(t)return r=t.lastLimboFreeSnapshotVersion,i.mh._o(e,t.targetId).next(function(t){o=t})}).next(function(){return i.hh.rr(e,t,n?r:Bi.MIN,n?o:Ds())}).next(function(t){return{documents:t,do:o}})})},Ju.prototype.fo=function(e){var n=this;return this.persistence.runTransaction("Remote document keys","readonly",function(t){return n.mh._o(t,e)})},Ju.prototype.wo=function(){return this.persistence.wo()},Ju.prototype.To=function(t){this.Hn.mo(t)},Ju.prototype.Eo=function(t){this.persistence.Eo(t)},Ju.prototype.$h=function(t,r,o){var e=this,s=r.batch,n=s.keys(),u=ku.resolve();return n.forEach(function(i){u=u.next(function(){return o.tr(t,i)}).next(function(t){var e=t,n=r.pn.get(i);vu(null!==n,"ackVersions should contain every doc in the write."),(!e||e.version.C(n)<0)&&(e=s.Bt(i,e,r))&&o.Xh(e,r.Vn)})}),u.next(function(){return e.Hn.qh(t,s)})},Ju.prototype.Ro=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.Io(t,n.ah)})},Ju.prototype.Ao=function(e){var n=this,t=this.ah.get(e);return t?Promise.resolve(t.target):this.persistence.runTransaction("Get target data","readonly",function(t){return n.mh.ui(t,e).next(function(t){return t?t.target:null})})},Ju.prototype.Po=function(){var i=this;return this.persistence.runTransaction("Get new document changes","readonly",function(t){return i.wh.Po(t,i.lh)}).then(function(t){var e=t.Vo,n=t.readTime;return i.lh=n,e})},Ju.prototype.Ph=function(){return c(this,void 0,void 0,function(){var e,n=this;return y(this,function(t){switch(t.label){case 0:return[4,(e=this).persistence.runTransaction("Synchronize last document change read time","readonly",function(t){return n.wh.po(t)})];case 1:return e.lh=t.sent(),[2]}})})},Ju);function Ju(t,e,n){this.persistence=t,this.hh=e,this.oh=new _u,this.ah=new ar(wu),this.uh=new Iu(function(t){return t.canonicalId()}),this.lh=Bi.MIN,this.persistence.dh._h(this.oh),this.Hn=t.fh(n),this.wh=t.Th(),this.mh=t.Eh(),this.Rh=new Ru(this.wh,this.Hn,this.persistence.Ih()),this.hh.Ah(this.Rh)}function Ku(e){return c(this,void 0,void 0,function(){return y(this,function(t){if(e.code!==Pi.FAILED_PRECONDITION||"The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab."!==e.message)throw e;return fu("LocalStore","Unexpectedly lost primary lease"),[2]})})}function Zu(t,e){if(0!==e.length)throw new Mi(Pi.INVALID_ARGUMENT,"Function "+t+"() does not support arguments, but was called with "+ya(e.length,"argument")+".")}function $u(t,e,n){if(e.length!==n)throw new Mi(Pi.INVALID_ARGUMENT,"Function "+t+"() requires "+ya(n,"argument")+", but was called with "+ya(e.length,"argument")+".")}function ta(t,e,n){if(e.length<n)throw new Mi(Pi.INVALID_ARGUMENT,"Function "+t+"() requires at least "+ya(n,"argument")+", but was called with "+ya(e.length,"argument")+".")}function ea(t,e,n,i){if(e.length<n||e.length>i)throw new Mi(Pi.INVALID_ARGUMENT,"Function "+t+"() requires between "+n+" and "+i+" arguments, but was called with "+ya(e.length,"argument")+".")}function na(t,e,n,i){ua(t,e,da(n)+" argument",i)}function ia(t,e,n,i){void 0!==i&&na(t,e,n,i)}function ra(t,e,n,i){ua(t,e,n+" option",i)}function oa(t,e,n,i){void 0!==i&&ra(t,e,n,i)}function sa(t,e,n,i,a){void 0!==i&&function(t,e,n){for(var i=[],r=0,o=a;r<o.length;r++){var s=o[r];if(s===n)return;i.push(ha(s))}var u=ha(n);throw new Mi(Pi.INVALID_ARGUMENT,"Invalid value "+u+" provided to function "+t+'() for option "'+e+'". Acceptable values: '+i.join(", "))}(t,n,i)}function ua(t,e,n,i){if(!("object"===e?aa(i):"non-empty string"===e?"string"==typeof i&&""!==i:typeof i===e)){var r=ha(i);throw new Mi(Pi.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" to be of type "+e+", but it was: "+r)}}function aa(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function ha(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":yu("Unknown wrong type: "+typeof e);if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function ca(t,e,n){if(void 0===n)throw new Mi(Pi.INVALID_ARGUMENT,"Function "+t+"() requires a valid "+da(e)+" argument, but it was undefined.")}function la(n,t,i){br(t,function(t,e){if(i.indexOf(t)<0)throw new Mi(Pi.INVALID_ARGUMENT,"Unknown option '"+t+"' passed to function "+n+"(). Available options: "+i.join(", "))})}function fa(t,e,n,i){var r=ha(i);return new Mi(Pi.INVALID_ARGUMENT,"Function "+t+"() requires its "+da(n)+" argument to be a "+e+", but it was: "+r)}function pa(t,e,n){if(n<=0)throw new Mi(Pi.INVALID_ARGUMENT,'Function "'+t+'()" requires its '+da(e)+" argument to be a positive number, but it was: "+n+".")}function da(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function ya(t,e){return t+" "+e+(1===t?"":"s")}function va(t,e){function n(){var t="This constructor is private.";throw e&&(t+=" ",t+=e),new Mi(Pi.INVALID_ARGUMENT,t)}return n.prototype=t.prototype,Object.assign(n,t),n}function ga(){if("undefined"==typeof Uint8Array)throw new Mi(Pi.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function ma(){if(!uu.Ot().yo)throw new Mi(Pi.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}Xu.eo=3e8;var wa=(Ia.fromBase64String=function(t){$u("Blob.fromBase64String",arguments,1),na("Blob.fromBase64String","string",1,t),ma();try{return new Ia(Ar.fromBase64String(t))}catch(t){throw new Mi(Pi.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},Ia.fromUint8Array=function(t){if($u("Blob.fromUint8Array",arguments,1),ga(),!(t instanceof Uint8Array))throw fa("Blob.fromUint8Array","Uint8Array",1,t);return new Ia(Ar.fromUint8Array(t))},Ia.prototype.toBase64=function(){return $u("Blob.toBase64",arguments,0),ma(),this.bo.toBase64()},Ia.prototype.toUint8Array=function(){return $u("Blob.toUint8Array",arguments,0),ga(),this.bo.toUint8Array()},Ia.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},Ia.prototype.isEqual=function(t){return this.bo.isEqual(t.bo)},Ia),ba=va(wa,"Use Blob.fromUint8Array() or Blob.fromBase64String() instead."),Ea=(Aa.documentId=function(){return Aa.So},Aa.prototype.isEqual=function(t){if(!(t instanceof Aa))throw fa("isEqual","FieldPath",1,t);return this.vo.isEqual(t.vo)},Aa);function Aa(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];!function(){if(!(t instanceof Array)||t.length<1)throw new Mi(Pi.INVALID_ARGUMENT,"Function FieldPath() requires its fieldNames argument to be an array with at least 1 element.")}();for(var n=0;n<t.length;++n)if(na("FieldPath","string",n,t[n]),0===t[n].length)throw new Mi(Pi.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.vo=new rr(t)}function Ia(t){ma(),this.bo=t}Ea.So=new Ea(rr.X().G());var Na,Ta=new RegExp("[~\\*/\\[\\]]"),_a=(Ra.delete=function(){return Zu("FieldValue.delete",arguments),Sa.instance},Ra.serverTimestamp=function(){return Zu("FieldValue.serverTimestamp",arguments),La.instance},Ra.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return ta("FieldValue.arrayUnion",arguments,1),new Pa(t)},Ra.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return ta("FieldValue.arrayRemove",arguments,1),new Ma(t)},Ra.increment=function(t){return na("FieldValue.increment","number",1,t),$u("FieldValue.increment",arguments,1),new qa(t)},Ra.prototype.isEqual=function(t){return this===t},Ra),Sa=(n(ka,Na=_a),ka);function ka(){return Na.call(this,"FieldValue.delete")||this}function Ra(t){this.Co=t}Sa.instance=new Sa;var Oa,La=(n(Da,Oa=_a),Da);function Da(){return Oa.call(this,"FieldValue.serverTimestamp")||this}La.instance=new La;var Ca,Va,Ua,Pa=(n(Xa,Ua=_a),Xa),Ma=(n(Wa,Va=_a),Wa),qa=(n(Qa,Ca=_a),Qa),xa=va(_a,"Use FieldValue.<field>() instead."),Ga=(Object.defineProperty(za.prototype,"latitude",{get:function(){return this.No},enumerable:!0,configurable:!0}),Object.defineProperty(za.prototype,"longitude",{get:function(){return this.ko},enumerable:!0,configurable:!0}),za.prototype.isEqual=function(t){return this.No===t.No&&this.ko===t.ko},za.prototype.g=function(t){return wu(this.No,t.No)||wu(this.ko,t.ko)},za),ja=/^__.*__$/,Fa=(Ya.prototype.Lo=function(t,e){var n=[];return null!==this.se?n.push(new po(t,this.data,this.se,e)):n.push(new fo(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new yo(t,this.fieldTransforms)),n},Ya),Ba=(Ha.prototype.Lo=function(t,e){var n=[new po(t,this.data,this.se,e)];return 0<this.fieldTransforms.length&&n.push(new yo(t,this.fieldTransforms)),n},Ha);function Ha(t,e,n){this.data=t,this.se=e,this.fieldTransforms=n}function Ya(t,e,n){this.data=t,this.se=e,this.fieldTransforms=n}function za(t,e){if($u("GeoPoint",arguments,2),na("GeoPoint","number",1,t),na("GeoPoint","number",2,e),!isFinite(t)||t<-90||90<t)throw new Mi(Pi.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new Mi(Pi.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.No=t,this.ko=e}function Qa(t){var e=this;return(e=Ca.call(this,"FieldValue.increment")||this).Fo=t,e}function Wa(t){var e=this;return(e=Va.call(this,"FieldValue.arrayRemove")||this).Do=t,e}function Xa(t){var e=this;return(e=Ua.call(this,"FieldValue.arrayUnion")||this).Do=t,e}function Ja(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw yu("Unexpected case for UserDataSource: "+t)}}var Ka=(eh.prototype.Uo=function(t){var e=null==this.path?null:this.path.child(t),n=new eh(this.$o,this.methodName,e,!1,this.fieldTransforms,this.se);return n.qo(t),n},eh.prototype.Bo=function(t){var e=null==this.path?null:this.path.child(t),n=new eh(this.$o,this.methodName,e,!1,this.fieldTransforms,this.se);return n.Mo(),n},eh.prototype.xo=function(t){return new eh(this.$o,this.methodName,null,!0,this.fieldTransforms,this.se)},eh.prototype.Qo=function(t){var e=null===this.path||this.path.q()?"":" (found in field "+this.path.toString()+")";return new Mi(Pi.INVALID_ARGUMENT,"Function "+this.methodName+"() called with invalid data. "+t+e)},eh.prototype.contains=function(e){return void 0!==this.se.find(function(t){return e.B(t)})||void 0!==this.fieldTransforms.find(function(t){return e.B(t.field)})},eh.prototype.Mo=function(){if(null!==this.path)for(var t=0;t<this.path.length;t++)this.qo(this.path.get(t))},eh.prototype.qo=function(t){if(0===t.length)throw this.Qo("Document fields must not be empty");if(Ja(this.$o)&&ja.test(t))throw this.Qo('Document fields cannot begin and end with "__"')},eh),Za=function(t,e){this.ci=t,this.key=e},$a=(th.prototype.jo=function(t,e){var n=new Ka(0,t,rr.H);ih("Data must be an object, but it was:",n,e);var i=this.Go(e,n);return new Fa(new mo(i),null,n.fieldTransforms)},th.prototype.zo=function(t,e,n){var i=new Ka(2,t,rr.H);ih("Data must be an object, but it was:",i,e);var r,o,s=this.Go(e,i);if(n){for(var u=new yr(rr.k),a=0,h=n;a<h.length;a++){var c=h[a],l=void 0;if(c instanceof Ea)l=c.vo;else{if("string"!=typeof c)throw yu("Expected stringOrFieldPath to be a string or a FieldPath");l=oh(t,c)}if(!i.contains(l))throw new Mi(Pi.INVALID_ARGUMENT,"Field '"+l+"' is specified in your field mask but missing from your input data.");u=u.add(l)}r=to.Gt(u),o=i.fieldTransforms.filter(function(t){return r.Kt(t.field)})}else r=to.zt(i.se),o=i.fieldTransforms;return new Fa(new mo(s),r,o)},th.prototype.Ko=function(o,t){var s=this,u=new Ka(1,o,rr.H);ih("Data must be an object, but it was:",u,t);var a=new yr(rr.k),h=mo.le();br(t,function(t,e){var n=oh(o,t),i=u.Bo(n);if((e=s.Ho(e,i))instanceof Sa)a=a.add(n);else{var r=s.Jo(e,i);null!=r&&(a=a.add(n),h.set(n,r))}});var e=to.Gt(a);return new Ba(h.he(),e,u.fieldTransforms)},th.prototype.Yo=function(t,e,n,i){var r=new Ka(1,t,rr.H),o=[rh(t,e)],s=[n];if(i.length%2!=0)throw new Mi(Pi.INVALID_ARGUMENT,"Function "+t+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var u=0;u<i.length;u+=2)o.push(rh(t,i[u])),s.push(i[u+1]);for(var a=new yr(rr.k),h=mo.le(),c=0;c<o.length;++c){var l=o[c],f=r.Bo(l),p=this.Ho(s[c],f);if(p instanceof Sa)a=a.add(l);else{var d=this.Jo(p,f);null!=d&&(a=a.add(l),h.set(l,d))}}var y=to.Gt(a);return new Ba(h.he(),y,r.fieldTransforms)},th.prototype.Xo=function(t,e,n){void 0===n&&(n=!1);var i=new Ka(n?4:3,t,rr.H);return this.Jo(e,i)},th.prototype.Ho=function(t,e){try{return this.Wo(t)}catch(t){var n=sh(t);throw e.Qo(n)}},th.prototype.Jo=function(t,e){if(nh(t=this.Ho(t,e)))return ih("Unsupported field value:",e,t),this.Go(t,e);if(t instanceof _a)return this.Zo(t,e),null;if(e.path&&e.se.push(e.path),t instanceof Array){if(e.Oo&&4!==e.$o)throw e.Qo("Nested arrays are not supported");return this.ta(t,e)}return this.ea(t,e)},th.prototype.Go=function(t,i){var r=this,o={};return Er(t)?i.path&&0<i.path.length&&i.se.push(i.path):br(t,function(t,e){var n=r.Jo(e,i.Uo(t));null!=n&&(o[t]=n)}),{mapValue:{fields:o}}},th.prototype.ta=function(t,e){for(var n=[],i=0,r=0,o=t;r<o.length;r++){var s=o[r],u=this.Jo(s,e.xo(i));null==u&&(u={nullValue:"NULL_VALUE"}),n.push(u),i++}return{arrayValue:{values:n}}},th.prototype.Zo=function(t,e){if(!Ja(e.$o))throw e.Qo(t.Co+"() can only be used with update() and set()");if(null===e.path)throw e.Qo(t.Co+"() is not currently supported inside arrays");if(t instanceof Sa){if(2!==e.$o)throw 1===e.$o?e.Qo("FieldValue.delete() can only appear at the top level of your update data"):e.Qo("FieldValue.delete() cannot be used with set() unless you pass {merge:true}");e.se.push(e.path)}else if(t instanceof La)e.fieldTransforms.push(new eo(e.path,Hr.instance));else if(t instanceof Pa){var n=this.sa(t.Co,t.Do),i=new zr(n);e.fieldTransforms.push(new eo(e.path,i))}else if(t instanceof Ma){var r=this.sa(t.Co,t.Do),o=new Qr(r);e.fieldTransforms.push(new eo(e.path,o))}else if(t instanceof qa){var s=this.Xo("FieldValue.increment",t.Fo),u=new Wr(this.serializer,s);e.fieldTransforms.push(new eo(e.path,u))}else yu("Unknown FieldValue type: "+t)},th.prototype.ea=function(t,e){if(null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return this.serializer.wi(t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=Fi.fromDate(t);return{timestampValue:this.serializer.F(n)}}if(t instanceof Fi){var i=new Fi(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:this.serializer.F(i)}}if(t instanceof Ga)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof wa)return{bytesValue:this.serializer.Ti(t)};if(t instanceof Za)return{referenceValue:this.serializer.Ei(t.key.path,t.ci)};throw e.Qo("Unsupported field value: "+ha(t))},th.prototype.sa=function(i,t){var r=this;return t.map(function(t,e){var n=new Ka(3,i,rr.H);return r.Jo(t,n.xo(e))})},th);function th(t,e){this.serializer=t,this.Wo=e}function eh(t,e,n,i,r,o){this.$o=t,this.methodName=e,this.path=n,this.Oo=i,void 0===r&&this.Mo(),this.Oo=void 0!==i&&i,this.fieldTransforms=r||[],this.se=o||[]}function nh(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Fi||t instanceof Ga||t instanceof wa||t instanceof Za||t instanceof _a)}function ih(t,e,n){if(!nh(n)||!aa(n)){var i=ha(n);throw"an object"===i?e.Qo(t+" a custom object"):e.Qo(t+" "+i)}}function rh(t,e){if(e instanceof Ea)return e.vo;if("string"==typeof e)return oh(t,e);throw new Mi(Pi.INVALID_ARGUMENT,"Function "+t+"() called with invalid data. Field path arguments must be of type string or FieldPath.")}function oh(t,e){try{return function(e){if(0<=e.search(Ta))throw new Mi(Pi.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(Ea.bind.apply(Ea,r([void 0],e.split("."))))}catch(t){throw new Mi(Pi.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e).vo}catch(e){var n=sh(e);throw new Mi(Pi.INVALID_ARGUMENT,"Function "+t+"() called with invalid data. "+n)}}function sh(t){return t instanceof Error?t.message:t.toString()}function uh(t){this.key=t}function ah(t){this.key=t}function hh(t,e,n){this.query=t,this.targetId=e,this.view=n}function ch(t){this.key=t,this.xc=!1}function lh(){this.yl=null,this.targetId=0,this.bl=[]}var fh,ph,dh,yh=(nc.prototype.reset=function(){this.oa=0},nc.prototype.ca=function(){this.oa=this.ha},nc.prototype.la=function(t){var e=this;this.cancel();var n=Math.floor(this.oa+this._a()),i=Math.max(0,Date.now()-this.ua),r=Math.max(0,n-i);0<this.oa&&fu("ExponentialBackoff","Backing off for "+r+" ms (base delay: "+this.oa+" ms, delay with jitter: "+n+" ms, last attempt: "+i+" ms ago)"),this.aa=this.ia.Qr(this.Pr,r,function(){return e.ua=Date.now(),t()}),this.oa*=this.ra,this.oa<this.na&&(this.oa=this.na),this.oa>this.ha&&(this.oa=this.ha)},nc.prototype.cancel=function(){null!==this.aa&&(this.aa.cancel(),this.aa=null)},nc.prototype._a=function(){return(Math.random()-.5)*this.oa},nc),vh=(ec.prototype.Ra=function(){return 1===this.state||2===this.state||4===this.state},ec.prototype.Ia=function(){return 2===this.state},ec.prototype.start=function(){3!==this.state?this.auth():this.Aa()},ec.prototype.stop=function(){return c(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.Ra()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},ec.prototype.Pa=function(){this.state=0,this.Ea.reset()},ec.prototype.Va=function(){var t=this;this.Ia()&&null===this.ma&&(this.ma=this.ia.Qr(this.da,6e4,function(){return t.pa()}))},ec.prototype.ga=function(t){this.ya(),this.stream.send(t)},ec.prototype.pa=function(){return c(this,void 0,void 0,function(){return y(this,function(t){return this.Ia()?[2,this.close(0)]:[2]})})},ec.prototype.ya=function(){this.ma&&(this.ma.cancel(),this.ma=null)},ec.prototype.close=function(e,n){return c(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.ya(),this.Ea.cancel(),this.Ta++,3!==e?this.Ea.reset():n&&n.code===Pi.RESOURCE_EXHAUSTED?(pu(n.toString()),pu("Using maximum backoff delay to prevent overloading the backend."),this.Ea.ca()):n&&n.code===Pi.UNAUTHENTICATED&&this.wa.l(),null!==this.stream&&(this.ba(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.va(n)];case 1:return t.sent(),[2]}})})},ec.prototype.ba=function(){},ec.prototype.auth=function(){var n=this;this.state=1;var t=this.Sa(this.Ta),e=this.Ta;this.wa.getToken().then(function(t){n.Ta===e&&n.Ca(t)},function(e){t(function(){var t=new Mi(Pi.UNKNOWN,"Fetching auth token failed: "+e.message);return n.Da(t)})})},ec.prototype.Ca=function(t){var e=this,n=this.Sa(this.Ta);this.stream=this.Fa(t),this.stream.Na(function(){n(function(){return e.state=2,e.listener.Na()})}),this.stream.va(function(t){n(function(){return e.Da(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},ec.prototype.Aa=function(){var t=this;this.state=4,this.Ea.la(function(){return c(t,void 0,void 0,function(){return y(this,function(t){return this.state=0,this.start(),[2]})})})},ec.prototype.Da=function(t){return fu("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},ec.prototype.Sa=function(e){var n=this;return function(t){n.ia.Cr(function(){return n.Ta===e?t():(fu("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},ec),gh=(n(tc,ph=vh),tc.prototype.Fa=function(t){return this.fa.ka("Listen",t)},tc.prototype.onMessage=function(t){this.Ea.reset();var e=this.serializer.Fi(t),n=this.serializer.ki(t);return this.listener.La(e,n)},tc.prototype.$a=function(t){var e={};e.database=this.serializer.gi,e.addTarget=this.serializer.Ue(t);var n=this.serializer.en(t);n&&(e.labels=n),this.ga(e)},tc.prototype.Oa=function(t){var e={};e.database=this.serializer.gi,e.removeTarget=t,this.ga(e)},tc),mh=(n($h,fh=vh),Object.defineProperty($h.prototype,"Ua",{get:function(){return this.Ma},enumerable:!0,configurable:!0}),$h.prototype.start=function(){this.Ma=!1,fh.prototype.start.call(this)},$h.prototype.ba=function(){this.Ma&&this.qa([])},$h.prototype.Fa=function(t){return this.fa.ka("Write",t)},$h.prototype.onMessage=function(t){if(vu(!!t.streamToken,"Got a write response without a stream token"),this.lastStreamToken=this.serializer.mi(t.streamToken),this.Ma){this.Ea.reset();var e=this.serializer.Wi(t.writeResults,t.commitTime),n=this.serializer.fromVersion(t.commitTime);return this.listener.Ba(n,e)}return vu(!t.writeResults||0===t.writeResults.length,"Got mutation results for handshake"),this.Ma=!0,this.listener.xa()},$h.prototype.Qa=function(){var t={};t.database=this.serializer.gi,this.ga(t)},$h.prototype.qa=function(t){var e=this,n={streamToken:this.serializer.Ti(this.lastStreamToken),writes:t.map(function(t){return e.serializer.Li(t)})};this.ga(n)},$h),wh=(Zh.prototype.Wa=function(t){return new mh(this.ia,this.fa,this.credentials,this.serializer,t)},Zh.prototype.ja=function(t){return new gh(this.ia,this.fa,this.credentials,this.serializer,t)},Zh.prototype.commit=function(t){var e=this,n={database:this.serializer.gi,writes:t.map(function(t){return e.serializer.Li(t)})};return this.Ga("Commit",n).then(function(t){return e.serializer.Wi(t.writeResults,t.commitTime)})},Zh.prototype.za=function(e){var r=this,t={database:this.serializer.gi,documents:e.map(function(t){return r.serializer.Ai(t)})};return this.Ka("BatchGetDocuments",t).then(function(t){var n=Ts();t.forEach(function(t){var e=r.serializer.Di(t);n=n.nt(e.key,e)});var i=[];return e.forEach(function(t){var e=n.get(t);vu(!!e,"Missing entity in write response for "+t),i.push(e)}),i})},Zh.prototype.Ga=function(e,n){var i=this;return this.credentials.getToken().then(function(t){return i.fa.Ga(e,n,t)}).catch(function(t){throw t.code===Pi.UNAUTHENTICATED&&i.credentials.l(),t})},Zh.prototype.Ka=function(e,n){var i=this;return this.credentials.getToken().then(function(t){return i.fa.Ka(e,n,t)}).catch(function(t){throw t.code===Pi.UNAUTHENTICATED&&i.credentials.l(),t})},Zh),bh=(Kh.prototype.za=function(i){return c(this,void 0,void 0,function(){var e,n=this;return y(this,function(t){switch(t.label){case 0:if(this.tu(),0<this.mutations.length)throw new Mi(Pi.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,this.Ha.za(i)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof Do||t instanceof Lo?n.eu(t):yu("Document in a transaction was a "+t.constructor.name)}),e)]}})})},Kh.prototype.set=function(t,e){this.write(e.Lo(t,this.Zt(t))),this.Za.add(t)},Kh.prototype.update=function(t,e){try{this.write(e.Lo(t,this.su(t)))}catch(t){this.Xa=t}this.Za.add(t)},Kh.prototype.delete=function(t){this.write([new vo(t,this.Zt(t))]),this.Za.add(t)},Kh.prototype.commit=function(){return c(this,void 0,void 0,function(){var e,n=this;return y(this,function(t){switch(t.label){case 0:if(this.tu(),this.Xa)throw this.Xa;return e=this.Ja,this.mutations.forEach(function(t){e=e.remove(t.key)}),e.forEach(function(t,e){n.mutations.push(new go(t,n.Zt(t)))}),[4,this.Ha.commit(this.mutations)];case 1:return t.sent(),this.Ya=!0,[2]}})})},Kh.prototype.eu=function(t){var e;if(t instanceof Lo)e=t.version;else{if(!(t instanceof Do))throw yu("Document in a transaction was a "+t.constructor.name);e=Bi.S()}var n=this.Ja.get(t.key);if(null!==n){if(!e.isEqual(n))throw new Mi(Pi.ABORTED,"Document version changed between two reads.")}else this.Ja=this.Ja.nt(t.key,e)},Kh.prototype.Zt=function(t){var e=this.Ja.get(t);return!this.Za.has(t)&&e?no.updateTime(e):no.NONE},Kh.prototype.su=function(t){var e=this.Ja.get(t);if(this.Za.has(t)||!e)return no.exists(!0);if(e.isEqual(Bi.S()))throw new Mi(Pi.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return no.updateTime(e)},Kh.prototype.write=function(t){this.tu(),this.mutations=this.mutations.concat(t)},Kh.prototype.tu=function(){},Kh),Eh=(Jh.prototype.ou=function(){var t=this;0===this.nu&&(this.au("Unknown"),this.ru=this.Ar.Qr("online_state_timeout",1e4,function(){return t.ru=null,t.uu("Backend didn't respond within 10 seconds."),t.au("Offline"),Promise.resolve()}))},Jh.prototype.cu=function(t){"Online"===this.state?this.au("Unknown"):(this.nu++,1<=this.nu&&(this.lu(),this.uu("Connection failed 1 times. Most recent error: "+t.toString()),this.au("Offline")))},Jh.prototype.set=function(t){this.lu(),this.nu=0,"Online"===t&&(this.hu=!1),this.au(t)},Jh.prototype.au=function(t){t!==this.state&&(this.state=t,this.iu(t))},Jh.prototype.uu=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.hu?(pu(e),this.hu=!1):fu("OnlineStateTracker",e)},Jh.prototype.lu=function(){null!==this.ru&&(this.ru.cancel(),this.ru=null)},Jh),Ah=(Xh.prototype.start=function(){return this.enableNetwork()},Xh.prototype.enableNetwork=function(){return c(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return this.networkEnabled=!0,this.Eu()?(e=this.gu,[4,this._u.xh()]):[3,3];case 1:return e.lastStreamToken=t.sent(),this.Su()?this.Cu():this.Iu.set("Unknown"),[4,this.Du()];case 2:t.sent(),t.label=3;case 3:return[2]}})})},Xh.prototype.disableNetwork=function(){return c(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.networkEnabled=!1,[4,this.Fu()];case 1:return t.sent(),this.Iu.set("Offline"),[2]}})})},Xh.prototype.Fu=function(){return c(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return[4,this.gu.stop()];case 1:return t.sent(),[4,this.Au.stop()];case 2:return t.sent(),0<this.du.length&&(fu("RemoteStore","Stopping write stream with "+this.du.length+" pending writes"),this.du=[]),this.Nu(),[2]}})})},Xh.prototype.ku=function(){return c(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return fu("RemoteStore","RemoteStore shutting down."),this.networkEnabled=!1,[4,this.Fu()];case 1:return t.sent(),this.Tu.ku(),this.Iu.set("Unknown"),[2]}})})},Xh.prototype.listen=function(t){this.fu.has(t.targetId)||(this.fu.set(t.targetId,t),this.Su()?this.Cu():this.Au.Ia()&&this.Lu(t))},Xh.prototype.$u=function(t){this.fu.delete(t),this.Au.Ia()&&this.Ou(t),0===this.fu.size&&(this.Au.Ia()?this.Au.Va():this.Eu()&&this.Iu.set("Unknown"))},Xh.prototype.ui=function(t){return this.fu.get(t)||null},Xh.prototype.ai=function(t){return this.Mu.ai(t)},Xh.prototype.Lu=function(t){this.wu.qs(t.targetId),this.Au.$a(t)},Xh.prototype.Ou=function(t){this.wu.qs(t),this.Au.Oa(t)},Xh.prototype.Cu=function(){this.wu=new Hs(this),this.Au.start(),this.Iu.ou()},Xh.prototype.Su=function(){return this.Eu()&&!this.Au.Ra()&&0<this.fu.size},Xh.prototype.Eu=function(){return this.isPrimary&&this.networkEnabled},Xh.prototype.Nu=function(){this.wu=null},Xh.prototype.Pu=function(){return c(this,void 0,void 0,function(){var n=this;return y(this,function(t){return this.fu.forEach(function(t,e){n.Lu(t)}),[2]})})},Xh.prototype.Vu=function(e){return c(this,void 0,void 0,function(){return y(this,function(t){return this.Nu(),this.Su()?(this.Iu.cu(e),this.Cu()):this.Iu.set("Unknown"),[2]})})},Xh.prototype.pu=function(n,i){return c(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return this.Iu.set("Online"),n instanceof Ms&&2===n.state&&n.cause?[2,this.Uu(n)]:(n instanceof Us?this.wu.Ks(n):n instanceof Ps?this.wu.si(n):this.wu.Ys(n),i.isEqual(Bi.MIN)?[3,4]:[4,this._u.Wh()]);case 1:return e=t.sent(),0<=i.C(e)?[4,this.qu(i)]:[3,3];case 2:t.sent(),t.label=3;case 3:t.label=4;case 4:return[2]}})})},Xh.prototype.qu=function(i){var r=this,t=this.wu.ri(i);return t.ws.forEach(function(t,e){if(0<t.resumeToken.Mt()){var n=r.fu.get(e);n&&r.fu.set(e,n.ss(t.resumeToken,i))}}),t.Ts.forEach(function(t){var e=r.fu.get(t);if(e){r.fu.set(t,e.ss(Ar.Ut,e.ts)),r.Ou(t);var n=new ms(e.target,t,1,e.sequenceNumber);r.Lu(n)}}),this.Mu.jh(t)},Xh.prototype.Uu=function(t){var n=this,i=t.cause,r=Promise.resolve();return t.targetIds.forEach(function(e){r=r.then(function(){return c(n,void 0,void 0,function(){return y(this,function(t){return this.fu.has(e)?[2,(this.fu.delete(e),this.wu.removeTarget(e),this.Mu.Bu(e,i))]:[2]})})})}),r},Xh.prototype.Du=function(){return c(this,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:return this.xu()?(e=0<this.du.length?this.du[this.du.length-1].batchId:-1,[4,this._u.io(e)]):[3,5];case 1:return null!==(n=t.sent())?[3,2]:(0===this.du.length&&this.gu.Va(),[3,4]);case 2:return this.Qu(n),[4,this.Du()];case 3:t.sent(),t.label=4;case 4:t.label=5;case 5:return this.Wu()&&this.ju(),[2]}})})},Xh.prototype.xu=function(){return this.Eu()&&this.du.length<10},Xh.prototype.Gu=function(){return this.du.length},Xh.prototype.Qu=function(t){this.du.push(t),this.gu.Ia()&&this.gu.Ua&&this.gu.qa(t.mutations)},Xh.prototype.Wu=function(){return this.Eu()&&!this.gu.Ra()&&0<this.du.length},Xh.prototype.ju=function(){this.gu.start()},Xh.prototype.yu=function(){return c(this,void 0,void 0,function(){return y(this,function(t){return this.gu.Qa(),[2]})})},Xh.prototype.vu=function(){var i=this;return this._u.Qh(this.gu.lastStreamToken).then(function(){for(var t=0,e=i.du;t<e.length;t++){var n=e[t];i.gu.qa(n.mutations)}}).catch(Ku)},Xh.prototype.Ba=function(t,e){var n=this,i=this.du.shift(),r=Tu.from(i,t,e,this.gu.lastStreamToken);return this.Mu.zu(r).then(function(){return n.Du()})},Xh.prototype.bu=function(n){return c(this,void 0,void 0,function(){var e=this;return y(this,function(t){return n&&0<this.du.length?[2,(this.gu.Ua?this.Ku(n):this.Hu(n)).then(function(){e.Wu()&&e.ju()})]:[2]})})},Xh.prototype.Hu=function(e){return c(this,void 0,void 0,function(){return y(this,function(t){return As(e.code)?[2,(fu("RemoteStore","RemoteStore error before completed handshake; resetting stream token: ",this.gu.lastStreamToken),this.gu.lastStreamToken=Ar.Ut,this._u.Qh(Ar.Ut).catch(Ku))]:[2]})})},Xh.prototype.Ku=function(r){return c(this,void 0,void 0,function(){var e,n,i=this;return y(this,function(t){return As(n=r.code)&&n!==Pi.ABORTED?(e=this.du.shift(),[2,(this.gu.Pa(),this.Mu.Ju(e.batchId,r).then(function(){return i.Du()}))]):[2]})})},Xh.prototype.Yu=function(){return new bh(this.Ha)},Xh.prototype.Ru=function(){return c(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.networkEnabled=!1,[4,this.Fu()];case 1:return t.sent(),this.Iu.set("Unknown"),[4,this.enableNetwork()];case 2:return t.sent(),[2]}})})},Xh.prototype.Xu=function(){return c(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.Eu()?(fu("RemoteStore","RemoteStore restarting streams for new credential"),[4,this.Ru()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},Xh.prototype.Zu=function(e){return c(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return(this.isPrimary=e)&&this.networkEnabled?[4,this.enableNetwork()]:[3,2];case 1:return t.sent(),[3,5];case 2:return e?[3,4]:[4,this.Fu()];case 3:t.sent(),this.Iu.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})},Xh),Ih=(Wh.prototype.tc=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},Wh.prototype.ec=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},Wh.prototype.sc=function(){var t={activeTargetIds:this.activeTargetIds.j(),updateTimeMs:Date.now()};return JSON.stringify(t)},Wh),Nh=(Qh.prototype.rc=function(t){},Qh.prototype.hc=function(t,e,n){},Qh.prototype.oc=function(t){return this.ic.tc(t),this.nc[t]||"not-current"},Qh.prototype.ac=function(t,e,n){this.nc[t]=e},Qh.prototype.uc=function(t){this.ic.ec(t)},Qh.prototype.cc=function(t){return this.ic.activeTargetIds.has(t)},Qh.prototype.lc=function(t){delete this.nc[t]},Qh.prototype._c=function(){return this.ic.activeTargetIds},Qh.prototype.dc=function(t){return this.ic.activeTargetIds.has(t)},Qh.prototype.start=function(){return this.ic=new Ih,Promise.resolve()},Qh.prototype.Vh=function(t,e,n){},Qh.prototype.fc=function(t){},Qh.prototype.ku=function(){},Qh.prototype.Rr=function(t){},Qh),Th=(zh.prototype.next=function(){return this.wc+=2,this.wc},zh.Tc=function(){return new zh(0)},zh.mc=function(){return new zh(-1)},zh),_h=(Object.defineProperty(Yh.prototype,"Pc",{get:function(){return this.Ec},enumerable:!0,configurable:!0}),Yh.prototype.Vc=function(t,e){var u=this,a=e?e.pc:new xs,h=e?e.Ac:this.Ac,c=e?e.ls:this.ls,l=h,f=!1,p=this.query.je()&&h.size===this.query.limit?h.last():null,d=this.query.Ge()&&h.size===this.query.limit?h.first():null;if(t.ut(function(t,e){var n=h.get(t),i=e instanceof Lo?e:null;i=i&&(u.query.matches(i)?i:null);var r=!!n&&u.ls.has(n.key),o=!!i&&(i.te||u.ls.has(i.key)&&i.hasCommittedMutations),s=!1;n&&i?n.data().isEqual(i.data())?r!==o&&(a.track({type:3,doc:i}),s=!0):u.gc(n,i)||(a.track({type:2,doc:i}),s=!0,(p&&0<u.query.qe(i,p)||d&&u.query.qe(i,d)<0)&&(f=!0)):!n&&i?(a.track({type:0,doc:i}),s=!0):n&&!i&&(a.track({type:1,doc:n}),s=!0,(p||d)&&(f=!0)),s&&(c=i?(l=l.add(i),o?c.add(t):c.delete(t)):(l=l.delete(t),c.delete(t)))}),this.query.je()||this.query.Ge())for(;l.size>this.query.limit;){var n=this.query.je()?l.last():l.first();l=l.delete(n.key),c=c.delete(n.key),a.track({type:1,doc:n})}return{Ac:l,pc:a,yc:f,ls:c}},Yh.prototype.gc=function(t,e){return t.te&&e.hasCommittedMutations&&!e.te},Yh.prototype.bc=function(t,e,n){var o=this,i=this.Ac;this.Ac=t.Ac,this.ls=t.ls;var r=t.pc.us();r.sort(function(t,e){return i=t.type,r=e.type,n(i)-n(r)||o.query.qe(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return yu("Unknown ChangeType: "+t)}}var i,r}),this.vc(n);var s=e?this.Sc():[],u=0===this.Ic.size&&this.As?1:0,a=u!==this.Rc;return this.Rc=u,0!==r.length||a?{snapshot:new Gs(this.query,t.Ac,i,r,t.ls,0==u,a,!1),Cc:s}:{Cc:s}},Yh.prototype.Dc=function(t){return this.As&&"Offline"===t?(this.As=!1,this.bc({Ac:this.Ac,pc:new xs,ls:this.ls,yc:!1},!1)):{Cc:[]}},Yh.prototype.Fc=function(t){return!this.Ec.has(t)&&!!this.Ac.has(t)&&!this.Ac.get(t).te},Yh.prototype.vc=function(t){var e=this;t&&(t.Ps.forEach(function(t){return e.Ec=e.Ec.add(t)}),t.Vs.forEach(function(t){}),t.ps.forEach(function(t){return e.Ec=e.Ec.delete(t)}),this.As=t.As)},Yh.prototype.Sc=function(){var e=this;if(!this.As)return[];var n=this.Ic;this.Ic=Ds(),this.Ac.forEach(function(t){e.Fc(t.key)&&(e.Ic=e.Ic.add(t.key))});var i=[];return n.forEach(function(t){e.Ic.has(t)||i.push(new ah(t))}),this.Ic.forEach(function(t){n.has(t)||i.push(new uh(t))}),i},Yh.prototype.Nc=function(t){this.Ec=t.do,this.Ic=Ds();var e=this.Vc(t.documents);return this.bc(e,!0)},Yh.prototype.kc=function(){return Gs.fs(this.query,this.Ac,this.ls,0===this.Rc)},Yh),Sh=(Hh.prototype.Oc=function(){this.Mc()},Hh.prototype.Mc=function(){var t=this;this.Ea.la(function(){return c(t,void 0,void 0,function(){var e,n,i=this;return y(this,function(t){return e=this.Lc.Yu(),(n=this.Uc(e))&&n.then(function(t){i.Ar.Cr(function(){return e.commit().then(function(){i.gr.resolve(t)}).catch(function(t){i.qc(t)})})}).catch(function(t){i.qc(t)}),[2]})})})},Hh.prototype.Uc=function(t){try{var e=this.updateFunction(t);return!Nr(e)&&e.catch&&e.then?e:(this.gr.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.gr.reject(t),null}},Hh.prototype.qc=function(t){var e=this;0<this.$c&&this.Bc(t)?(--this.$c,this.Ar.Cr(function(){return e.Mc(),Promise.resolve()})):this.gr.reject(t)},Hh.prototype.Bc=function(t){if("FirebaseError"!==t.name)return!1;var e=t.code;return"aborted"===e||"failed-precondition"===e||!As(e)},Hh),kh=(Object.defineProperty(Bh.prototype,"el",{get:function(){return!0===this.isPrimary},enumerable:!0,configurable:!0}),Bh.prototype.subscribe=function(t){this.jc=t},Bh.prototype.listen=function(s){return c(this,void 0,void 0,function(){var e,n,i,r,o;return y(this,function(t){switch(t.label){case 0:return this.sl("listen()"),(i=this.Gc.get(s))?(e=i.targetId,this.Qc.oc(e),n=i.view.kc(),[3,4]):[3,1];case 1:return[4,this._u.ho(s.Ue())];case 2:return r=t.sent(),o=this.Qc.oc(r.targetId),e=r.targetId,[4,this.il(s,e,"current"===o)];case 3:n=t.sent(),this.isPrimary&&this.Lc.listen(r),t.label=4;case 4:return[2,(this.jc.La([n]),e)]}})})},Bh.prototype.il=function(u,a,h){return c(this,void 0,void 0,function(){var e,n,i,r,o,s;return y(this,function(t){switch(t.label){case 0:return[4,this._u.lo(u,!0)];case 1:return e=t.sent(),n=new _h(u,e.do),i=n.Vc(e.documents),r=Fs.Is(a,h&&"Offline"!==this.onlineState),o=n.bc(i,!0===this.isPrimary,r),s=new hh(u,a,n),[2,(this.Gc.set(u,s),this.zc.has(a)?this.zc.get(a).push(u):this.zc.set(a,[u]),o.snapshot)]}})})},Bh.prototype.nl=function(i){return c(this,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:return[4,this._u.lo(i.query,!0)];case 1:return e=t.sent(),n=i.view.Nc(e),[2,(this.isPrimary&&this.rl(i.targetId,n.Cc),n)]}})})},Bh.prototype.$u=function(r){return c(this,void 0,void 0,function(){var e,n,i=this;return y(this,function(t){switch(t.label){case 0:return this.sl("unlisten()"),e=this.Gc.get(r),1<(n=this.zc.get(e.targetId)).length?[2,(this.zc.set(e.targetId,n.filter(function(t){return!t.isEqual(r)})),void this.Gc.delete(r))]:this.isPrimary?(this.Qc.uc(e.targetId),this.Qc.dc(e.targetId)?[3,2]:[4,this._u.co(e.targetId,!1).then(function(){i.Qc.lc(e.targetId),i.Lc.$u(e.targetId),i.hl(e.targetId)}).catch(Ku)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return this.hl(e.targetId),[4,this._u.co(e.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})},Bh.prototype.write=function(n,i){return c(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return this.sl("write()"),[4,this._u.vh(n)];case 1:return e=t.sent(),this.Qc.rc(e.batchId),this.ol(e.batchId,i),[4,this.al(e.Ch)];case 2:return t.sent(),[4,this.Lc.Du()];case 3:return t.sent(),[2]}})})},Bh.prototype.runTransaction=function(t,e,n){new Sh(t,this.Lc,e,n).Oc()},Bh.prototype.jh=function(n){return c(this,void 0,void 0,function(){var e,i=this;return y(this,function(t){switch(t.label){case 0:this.sl("applyRemoteEvent()"),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this._u.jh(n)];case 2:return e=t.sent(),n.ws.forEach(function(t,e){var n=i.Jc.get(e);n&&(vu(t.Ps.size+t.Vs.size+t.ps.size<=1,"Limbo resolution for single document contains multiple changes."),0<t.Ps.size?n.xc=!0:0<t.Vs.size?vu(n.xc,"Received change for limbo target document without add."):0<t.ps.size&&(vu(n.xc,"Received remove for limbo target document without add."),n.xc=!1))}),[4,this.al(e,n)];case 3:return t.sent(),[3,6];case 4:return[4,Ku(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},Bh.prototype.Dc=function(i,t){if(this.isPrimary&&0===t||!this.isPrimary&&1===t){this.sl("applyOnlineStateChange()");var r=[];this.Gc.forEach(function(t,e){var n=e.view.Dc(i);n.snapshot&&r.push(n.snapshot)}),this.jc.ul(i),this.jc.La(r),this.onlineState=i,this.isPrimary&&this.Qc.fc(i)}},Bh.prototype.Bu=function(u,a){return c(this,void 0,void 0,function(){var e,n,i,r,o,s=this;return y(this,function(t){switch(t.label){case 0:return this.sl("rejectListens()"),this.Qc.ac(u,"rejected",a),e=this.Jc.get(u),(n=e&&e.key)?(this.Hc=this.Hc.remove(n),this.Jc.delete(u),this.cl(),i=(i=new ar(sr.k)).nt(n,new Do(n,Bi.S())),r=Ds().add(n),o=new js(Bi.MIN,new Map,new yr(wu),i,r),[2,this.jh(o)]):[4,this._u.co(u,!1).then(function(){return s.hl(u,a)}).catch(Ku)];case 1:return t.sent(),[2]}})})},Bh.prototype.ll=function(n,i,r){return c(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return this.sl("applyBatchState()"),[4,this._u.Dh(n)];case 1:return null===(e=t.sent())?[3,6]:"pending"!==i?[3,3]:[4,this.Lc.Du()];case 2:return t.sent(),[3,4];case 3:"acknowledged"===i||"rejected"===i?(this._l(n,r||null),this._u.To(n)):yu("Unknown batchState: "+i),t.label=4;case 4:return[4,this.al(e)];case 5:return t.sent(),[3,7];case 6:fu("SyncEngine","Cannot apply mutation batch with id: "+n),t.label=7;case 7:return[2]}})})},Bh.prototype.zu=function(i){return c(this,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:this.sl("applySuccessfulWrite()"),e=i.batch.batchId,this._l(e,null),this.dl(e),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this._u.Nh(i)];case 2:return n=t.sent(),this.Qc.hc(e,"acknowledged"),[4,this.al(n)];case 3:return t.sent(),[3,6];case 4:return[4,Ku(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},Bh.prototype.Ju=function(n,i){return c(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:this.sl("rejectFailedWrite()"),this._l(n,i),this.dl(n),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this._u.Mh(n)];case 2:return e=t.sent(),this.Qc.hc(n,"rejected",i),[4,this.al(e)];case 3:return t.sent(),[3,6];case 4:return[4,Ku(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},Bh.prototype.fl=function(i){return c(this,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:return this.Lc.Eu()||fu("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),[4,this._u.Bh()];case 1:return-1===(e=t.sent())?[2,void i.resolve()]:((n=this.Zc.get(e)||[]).push(i),this.Zc.set(e,n),[2])}})})},Bh.prototype.dl=function(t){(this.Zc.get(t)||[]).forEach(function(t){t.resolve()}),this.Zc.delete(t)},Bh.prototype.wl=function(e){this.Zc.forEach(function(t){t.forEach(function(t){t.reject(new Mi(Pi.CANCELLED,e))})}),this.Zc.clear()},Bh.prototype.ol=function(t,e){var n=this.Xc[this.currentUser.s()];n=(n=n||new ar(wu)).nt(t,e),this.Xc[this.currentUser.s()]=n},Bh.prototype._l=function(t,e){var n=this.Xc[this.currentUser.s()];if(n){var i=n.get(t);i&&(e?i.reject(e):i.resolve(),n=n.remove(t)),this.Xc[this.currentUser.s()]=n}},Bh.prototype.hl=function(t,e){var n=this;void 0===e&&(e=null),this.Qc.uc(t);for(var i=0,r=this.zc.get(t);i<r.length;i++){var o=r[i];this.Gc.delete(o),e&&this.jc.Tl(o,e)}if(this.zc.delete(t),this.isPrimary){var s=this.Yc.Ln(t);this.Yc.Nn(t),s.forEach(function(t){n.Yc.$n(t)||n.ml(t)})}},Bh.prototype.ml=function(t){var e=this.Hc.get(t);null!==e&&(this.Lc.$u(e),this.Hc=this.Hc.remove(t),this.Jc.delete(e),this.cl())},Bh.prototype.rl=function(t,e){for(var n=0,i=e;n<i.length;n++){var r=i[n];r instanceof uh?(this.Yc.vn(r.key,t),this.El(r)):r instanceof ah?(fu("SyncEngine","Document no longer in limbo: "+r.key),this.Yc.Cn(r.key,t),this.Yc.$n(r.key)||this.ml(r.key)):yu("Unknown limbo change: "+JSON.stringify(r))}},Bh.prototype.El=function(t){var e=t.key;this.Hc.get(e)||(fu("SyncEngine","New document in limbo: "+e),this.Kc.push(e),this.cl())},Bh.prototype.cl=function(){for(;0<this.Kc.length&&this.Hc.size<this.Wc;){var t=this.Kc.shift(),e=this.tl.next();this.Jc.set(e,new ch(t)),this.Hc=this.Hc.nt(t,e),this.Lc.listen(new ms(Uo.ve(t.path).Ue(),e,2,Lu.Ir))}},Bh.prototype.Rl=function(){return this.Hc},Bh.prototype.Il=function(){return this.Kc},Bh.prototype.al=function(i,a){return c(this,void 0,void 0,function(){var o,s,e,u=this;return y(this,function(t){switch(t.label){case 0:return o=[],s=[],e=[],this.Gc.forEach(function(t,r){e.push(Promise.resolve().then(function(){var n=r.view.Vc(i);return n.yc?u._u.lo(r.query,!1).then(function(t){var e=t.documents;return r.view.Vc(e,n)}):n}).then(function(t){var e=a&&a.ws.get(r.targetId),n=r.view.bc(t,!0===u.isPrimary,e);if(u.rl(r.targetId,n.Cc),n.snapshot){u.isPrimary&&u.Qc.ac(r.targetId,n.snapshot.fromCache?"not-current":"current"),o.push(n.snapshot);var i=Ou.wr(r.targetId,n.snapshot);s.push(i)}}))}),[4,Promise.all(e)];case 1:return t.sent(),this.jc.La(o),[4,this._u.so(s)];case 2:return t.sent(),[2]}})})},Bh.prototype.sl=function(t){},Bh.prototype.Xu=function(i){return c(this,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:return e=!this.currentUser.isEqual(i),this.currentUser=i,e?(this.wl("'waitForPendingWrites' promise is rejected due to a user change."),[4,this._u.Vh(i)]):[3,3];case 1:return n=t.sent(),this.Qc.Vh(i,n.yh,n.bh),[4,this.al(n.gh)];case 2:t.sent(),t.label=3;case 3:return[4,this.Lc.Xu()];case 4:return t.sent(),[2]}})})},Bh.prototype.Zu=function(h){return c(this,void 0,void 0,function(){var e,n,i,r,o,s,u,a=this;return y(this,function(t){switch(t.label){case 0:return!0!==h||!0===this.isPrimary?[3,3]:(this.isPrimary=!0,[4,this.Lc.Zu(!0)]);case 1:return t.sent(),e=this.Qc._c(),[4,this.Al(e.j())];case 2:for(n=t.sent(),i=0,r=n;i<r.length;i++)o=r[i],this.Lc.listen(o);return[3,7];case 3:return!1!==h||!1===this.isPrimary?[3,7]:(this.isPrimary=!1,s=[],u=Promise.resolve(),this.zc.forEach(function(t,e){a.Qc.cc(e)?s.push(e):u=u.then(function(){return a.hl(e),a._u.co(e,!0)}),a.Lc.$u(e)}),[4,u]);case 4:return t.sent(),[4,this.Al(s)];case 5:return t.sent(),this.Pl(),[4,this.Lc.Zu(!1)];case 6:t.sent(),t.label=7;case 7:return[2]}})})},Bh.prototype.Pl=function(){var n=this;this.Jc.forEach(function(t,e){n.Lc.$u(e)}),this.Yc.kn(),this.Jc=new Map,this.Hc=new ar(sr.k)},Bh.prototype.Al=function(d){return c(this,void 0,void 0,function(){var e,n,i,r,o,s,u,a,h,c,l,f,p;return y(this,function(t){switch(t.label){case 0:e=[],n=[],i=0,r=d,t.label=1;case 1:return i<r.length?(o=r[i],s=void 0,(u=this.zc.get(o))&&0!==u.length?[4,this._u.co(o,!0)]:[3,8]):[3,14];case 2:return t.sent(),[4,this._u.ho(u[0].Ue())];case 3:s=t.sent(),a=0,h=u,t.label=4;case 4:return a<h.length?(c=h[a],l=this.Gc.get(c),[4,this.nl(l)]):[3,7];case 5:(f=t.sent()).snapshot&&n.push(f.snapshot),t.label=6;case 6:return a++,[3,4];case 7:return[3,12];case 8:return[4,this._u.Ao(o)];case 9:return p=t.sent(),[4,this._u.ho(p)];case 10:return s=t.sent(),[4,this.il(this.Vl(p),o,!1)];case 11:t.sent(),t.label=12;case 12:e.push(s),t.label=13;case 13:return i++,[3,1];case 14:return[2,(this.jc.La(n),e)]}})})},Bh.prototype.Vl=function(t){return new Uo(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)},Bh.prototype.wo=function(){return this._u.wo()},Bh.prototype.pl=function(i,r,o){return c(this,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:return this.isPrimary?(fu("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!this.zc.has(i))return[3,8];switch(r){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,this._u.Po()];case 3:return e=t.sent(),n=js.Rs(i,"current"===r),[4,this.al(e,n)];case 4:return t.sent(),[3,8];case 5:return[4,this._u.co(i,!0)];case 6:return t.sent(),this.hl(i,o),[3,8];case 7:yu("Unexpected target state: "+r),t.label=8;case 8:return[2]}})})},Bh.prototype.gl=function(f,p){return c(this,void 0,void 0,function(){var e,n,i,r,o,s,u,a,h,c,l=this;return y(this,function(t){switch(t.label){case 0:if(!this.isPrimary)return[3,10];e=0,n=f,t.label=1;case 1:return e<n.length?(i=n[e],[4,this._u.Ao(i)]):[3,6];case 2:return r=t.sent(),[4,this._u.ho(r)];case 3:return o=t.sent(),[4,this.il(this.Vl(r),o.targetId,!1)];case 4:t.sent(),this.Lc.listen(o),t.label=5;case 5:return e++,[3,1];case 6:s=function(e){return y(this,function(t){switch(t.label){case 0:return u.zc.has(e)?[4,u._u.co(e,!1).then(function(){l.Lc.$u(e),l.hl(e)}).catch(Ku)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})},u=this,a=0,h=p,t.label=7;case 7:return a<h.length?(c=h[a],[5,s(c)]):[3,10];case 8:t.sent(),t.label=9;case 9:return a++,[3,7];case 10:return[2]}})})},Bh.prototype.enableNetwork=function(){return this._u.Eo(!0),this.Lc.enableNetwork()},Bh.prototype.disableNetwork=function(){return this._u.Eo(!1),this.Lc.disableNetwork()},Bh.prototype.ai=function(t){var e=this.Jc.get(t);if(e&&e.xc)return Ds().add(e.key);var n=Ds(),i=this.zc.get(t);if(!i)return n;for(var r=0,o=i;r<o.length;r++){var s=o[r],u=this.Gc.get(s);n=n.kt(u.view.Pc)}return n},Bh),Rh=(Fh.prototype.listen=function(t){var e=t.query,n=!1,i=this.vl.get(e);return i||(n=!0,i=new lh,this.vl.set(e,i)),i.bl.push(t),t.Dc(this.onlineState),i.yl&&t.Cl(i.yl)&&this.Dl(),n?this.Mu.listen(e).then(function(t){return i.targetId=t}):Promise.resolve(i.targetId)},Fh.prototype.$u=function(o){return c(this,void 0,void 0,function(){var e,n,i,r;return y(this,function(t){return e=o.query,n=!1,(i=this.vl.get(e))&&0<=(r=i.bl.indexOf(o))&&(i.bl.splice(r,1),n=0===i.bl.length),n?[2,(this.vl.delete(e),this.Mu.$u(e))]:[2]})})},Fh.prototype.La=function(t){for(var e=!1,n=0,i=t;n<i.length;n++){var r=i[n],o=r.query,s=this.vl.get(o);if(s){for(var u=0,a=s.bl;u<a.length;u++)a[u].Cl(r)&&(e=!0);s.yl=r}}e&&this.Dl()},Fh.prototype.Tl=function(t,e){var n=this.vl.get(t);if(n)for(var i=0,r=n.bl;i<r.length;i++)r[i].onError(e);this.vl.delete(t)},Fh.prototype.ul=function(r){this.onlineState=r;var o=!1;this.vl.forEach(function(t,e){for(var n=0,i=e.bl;n<i.length;n++)i[n].Dc(r)&&(o=!0)}),o&&this.Dl()},Fh.prototype.Fl=function(t){this.Sl.add(t),t.next()},Fh.prototype.Nl=function(t){this.Sl.delete(t)},Fh.prototype.Dl=function(){this.Sl.forEach(function(t){t.next()})},Fh),Oh=(jh.prototype.Cl=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,i=t.docChanges;n<i.length;n++){var r=i[n];3!==r.type&&e.push(r)}t=new Gs(t.query,t.docs,t.cs,e,t.ls,t.fromCache,t._s,!0)}var o=!1;return this.Ll?this.Ol(t)&&(this.kl.next(t),o=!0):this.Ml(t,this.onlineState)&&(this.Ul(t),o=!0),this.$l=t,o},jh.prototype.onError=function(t){this.kl.error(t)},jh.prototype.Dc=function(t){this.onlineState=t;var e=!1;return this.$l&&!this.Ll&&this.Ml(this.$l,t)&&(this.Ul(this.$l),e=!0),e},jh.prototype.Ml=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.ql&&n||t.docs.q()&&"Offline"!==e)},jh.prototype.Ol=function(t){if(0<t.docChanges.length)return!0;var e=this.$l&&this.$l.hasPendingWrites!==t.hasPendingWrites;return!(!t._s&&!e)&&!0===this.options.includeMetadataChanges},jh.prototype.Ul=function(t){t=Gs.fs(t.query,t.docs,t.ls,t.fromCache),this.Ll=!0,this.kl.next(t)},jh),Lh=(Gh.prototype.Ah=function(t){this.Bl=t},Gh.prototype.rr=function(e,i,r,o){var s=this;return i.Me()||r.isEqual(Bi.MIN)?this.xl(e,i):this.Bl.sr(e,o).next(function(t){var n=s.Ql(i,t);return(i.je()||i.Ge())&&s.yc(i.pe,n,o,r)?s.xl(e,i):(cu()<=u.DEBUG&&fu("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),i.toString()),s.Bl.rr(e,i,r).next(function(e){return n.forEach(function(t){e=e.nt(t.key,t)}),e}))})},Gh.prototype.Ql=function(n,t){var i=new yr(function(t,e){return n.qe(t,e)});return t.forEach(function(t,e){e instanceof Lo&&n.matches(e)&&(i=i.add(e))}),i},Gh.prototype.yc=function(t,e,n,i){if(n.size!==e.size)return!0;var r="F"===t?e.last():e.first();return!!r&&(r.hasPendingWrites||0<r.version.C(i))},Gh.prototype.xl=function(t,e){return cu()<=u.DEBUG&&fu("IndexFreeQueryEngine","Using full collection scan to execute query: %s",e.toString()),this.Bl.rr(t,e,Bi.MIN)},Gh),Dh=(xh.prototype.jl=function(t,e){return this.Wl.add(e),ku.resolve()},xh.prototype.ur=function(t,e){return ku.resolve(this.Wl.getEntries(e))},xh),Ch=(qh.prototype.add=function(t){var e=t.U(),n=t.O(),i=this.index[e]||new yr($i.k),r=!i.has(n);return this.index[e]=i.add(n),r},qh.prototype.has=function(t){var e=t.U(),n=t.O(),i=this.index[e];return i&&i.has(n)},qh.prototype.getEntries=function(t){return(this.index[t]||new yr($i.k)).j()},qh),Vh=(Mh.prototype.Kl=function(t){return ku.resolve(0===this.Hn.length)},Mh.prototype.Nh=function(t,e,n){var i=e.batchId,r=this.Hl(i,"acknowledged");return vu(0===r,"Can only acknowledge the first batch in the mutation queue"),this.Hn[r],this.lastStreamToken=n,ku.resolve()},Mh.prototype.xh=function(t){return ku.resolve(this.lastStreamToken)},Mh.prototype.Qh=function(t,e){return this.lastStreamToken=e,ku.resolve()},Mh.prototype.Sh=function(t,e,n,i){var r=this.Gl;this.Gl++,0<this.Hn.length&&this.Hn[this.Hn.length-1];var o=new Nu(r,e,n,i);this.Hn.push(o);for(var s=0,u=i;s<u.length;s++){var a=u[s];this.zl=this.zl.add(new Su(a.key,r)),this.Jn.jl(t,a.key.path.O())}return ku.resolve(o)},Mh.prototype.Uh=function(t,e){return ku.resolve(this.Jl(e))},Mh.prototype.Fh=function(t,e){var n=this.Jl(e);return ku.resolve(n.keys())},Mh.prototype.no=function(t,e){var n=e+1,i=this.Yl(n),r=i<0?0:i;return ku.resolve(this.Hn.length>r?this.Hn[r]:null)},Mh.prototype.Bh=function(){return ku.resolve(0===this.Hn.length?-1:this.Gl-1)},Mh.prototype.ph=function(t){return ku.resolve(this.Hn.slice())},Mh.prototype.Xn=function(t,e){var n=this,i=new Su(e,0),r=new Su(e,Number.POSITIVE_INFINITY),o=[];return this.zl.Dt([i,r],function(t){var e=n.Jl(t.On);o.push(e)}),ku.resolve(o)},Mh.prototype.nr=function(t,e){var i=this,r=new yr(wu);return e.forEach(function(t){var e=new Su(t,0),n=new Su(t,Number.POSITIVE_INFINITY);i.zl.Dt([e,n],function(t){r=r.add(t.On)})}),ku.resolve(this.Xl(r))},Mh.prototype.cr=function(t,e){var n=e.path,i=n.length+1,r=n;sr.st(r)||(r=r.child(""));var o=new Su(new sr(r),0),s=new yr(wu);return this.zl.Ft(function(t){var e=t.key.path;return!!n.B(e)&&(e.length===i&&(s=s.add(t.On)),!0)},o),ku.resolve(this.Xl(s))},Mh.prototype.Xl=function(t){var n=this,i=[];return t.forEach(function(t){var e=n.Jl(t);null!==e&&i.push(e)}),i},Mh.prototype.qh=function(n,i){var r=this;vu(0===this.Hl(i.batchId,"removed"),"Can only remove the first entry of the mutation queue"),this.Hn.shift();var o=this.zl;return ku.forEach(i.mutations,function(t){var e=new Su(t.key,i.batchId);return o=o.delete(e),r.dh.Zl(n,t.key)}).next(function(){r.zl=o})},Mh.prototype.mo=function(t){},Mh.prototype.$n=function(t,e){var n=new Su(e,0),i=this.zl.Nt(n);return ku.resolve(e.isEqual(i&&i.key))},Mh.prototype.Oh=function(t){return this.Hn.length,ku.resolve()},Mh.prototype.Hl=function(t,e){return this.Yl(t)},Mh.prototype.Yl=function(t){return 0===this.Hn.length?0:t-this.Hn[0].batchId},Mh.prototype.Jl=function(t){var e=this.Yl(t);return e<0||e>=this.Hn.length?null:this.Hn[e]},Mh),Uh=(Ph.prototype.Xh=function(t,e,n){var i=e.key,r=this.docs.get(i),o=r?r.size:0,s=this.t_(e);return this.docs=this.docs.nt(i,{e_:e,size:s,readTime:n}),this.size+=s-o,this.Jn.jl(t,i.path.O())},Ph.prototype.Yh=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},Ph.prototype.tr=function(t,e){var n=this.docs.get(e);return ku.resolve(n?n.e_:null)},Ph.prototype.getEntries=function(t,e){var n=this,i=_s();return e.forEach(function(t){var e=n.docs.get(t);i=i.nt(t,e?e.e_:null)}),ku.resolve(i)},Ph.prototype.rr=function(t,e,n){for(var i=ks(),r=new sr(e.path.child("")),o=this.docs._t(r);o.Rt();){var s=o.Et(),u=s.key,a=s.value,h=a.e_,c=a.readTime;if(!e.path.B(u.path))break;c.C(n)<=0||h instanceof Lo&&e.matches(h)&&(i=i.nt(h.key,h))}return ku.resolve(i)},Ph.prototype.s_=function(t,e){return ku.forEach(this.docs,function(t){return e(t)})},Ph.prototype.Po=function(t,e){throw new Error("getNewDocumentChanges() is not supported with MemoryPersistence")},Ph.prototype.po=function(t){return ku.resolve(Bi.MIN)},Ph.prototype.kh=function(t){return new Ph.i_(this)},Ph.prototype.n_=function(t){return ku.resolve(this.size)},Ph);function Ph(t,e){this.Jn=t,this.t_=e,this.docs=new ar(sr.k),this.size=0}function Mh(t,e){this.Jn=t,this.dh=e,this.Hn=[],this.Gl=1,this.lastStreamToken=Ar.Ut,this.zl=new yr(Su.me)}function qh(){this.index={}}function xh(){this.Wl=new Ch}function Gh(){}function jh(t,e,n){this.query=t,this.kl=e,this.Ll=!1,this.$l=null,this.onlineState="Unknown",this.options=n||{}}function Fh(t){this.Mu=t,this.vl=new Iu(function(t){return t.canonicalId()}),this.onlineState="Unknown",this.Sl=new Set,this.Mu.subscribe(this)}function Bh(t,e,n,i,r){this._u=t,this.Lc=e,this.Qc=n,this.currentUser=i,this.Wc=r,this.jc=null,this.Gc=new Iu(function(t){return t.canonicalId()}),this.zc=new Map,this.Kc=[],this.Hc=new ar(sr.k),this.Jc=new Map,this.Yc=new _u,this.Xc={},this.Zc=new Map,this.tl=Th.mc(),this.isPrimary=void 0,this.onlineState="Unknown"}function Hh(t,e,n,i){this.Ar=t,this.Lc=e,this.updateFunction=n,this.gr=i,this.$c=5,this.Ea=new yh(this.Ar,"retry_transaction")}function Yh(t,e){this.query=t,this.Ec=e,this.Rc=null,this.As=!1,this.Ic=Ds(),this.ls=Ds(),this.Ac=new qs(t.qe.bind(t))}function zh(t){this.wc=t}function Qh(){this.ic=new Ih,this.nc={},this.Mu=null,this.iu=null,this.Tr=null}function Wh(){this.activeTargetIds=Vs()}function Xh(t,e,n,i,r){var o=this;this._u=t,this.Ha=e,this.du=[],this.fu=new Map,this.wu=null,this.networkEnabled=!1,this.isPrimary=!1,this.Tu=r,this.Tu.mu(function(t){n.Cr(function(){return c(o,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.Eu()?(fu("RemoteStore","Restarting streams for network reachability change."),[4,this.Ru()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.Iu=new Eh(n,i),this.Au=this.Ha.ja({Na:this.Pu.bind(this),va:this.Vu.bind(this),La:this.pu.bind(this)}),this.gu=this.Ha.Wa({Na:this.yu.bind(this),va:this.bu.bind(this),xa:this.vu.bind(this),Ba:this.Ba.bind(this)})}function Jh(t,e){this.Ar=t,this.iu=e,this.state="Unknown",this.nu=0,this.ru=null,this.hu=!0}function Kh(t){this.Ha=t,this.Ja=Os(),this.mutations=[],this.Ya=!1,this.Xa=null,this.Za=new Set}function Zh(t,e,n,i){this.ia=t,this.fa=e,this.credentials=n,this.serializer=i}function $h(t,e,n,i,r){var o=this;return(o=fh.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,r)||this).serializer=i,o.Ma=!1,o.lastStreamToken=Ar.Ut,o}function tc(t,e,n,i,r){var o=this;return(o=ph.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,r)||this).serializer=i,o}function ec(t,e,n,i,r,o){this.ia=t,this.da=n,this.fa=i,this.wa=r,this.listener=o,this.state=0,this.Ta=0,this.ma=null,this.stream=null,this.Ea=new yh(t,e)}function nc(t,e,n,i,r){void 0===n&&(n=1e3),void 0===i&&(i=1.5),void 0===r&&(r=6e4),this.ia=t,this.Pr=e,this.na=n,this.ra=i,this.ha=r,this.oa=0,this.aa=null,this.ua=Date.now(),this.reset()}function ic(t){var e=this;return(e=dh.call(this)||this).c_=t,e}function rc(){this.Ch=new Iu(function(t){return t.toString()}),this.r_=!1}Uh.i_=(Object.defineProperty(rc.prototype,"readTime",{get:function(){return this.h_},set:function(t){this.h_=t},enumerable:!0,configurable:!0}),rc.prototype.Xh=function(t,e){this.o_(),this.readTime=e,this.Ch.set(t.key,t)},rc.prototype.Yh=function(t,e){this.o_(),e&&(this.readTime=e),this.Ch.set(t,null)},rc.prototype.tr=function(t,e){this.o_();var n=this.Ch.get(e);return void 0!==n?ku.resolve(n):this.a_(t,e)},rc.prototype.getEntries=function(t,e){return this.u_(t,e)},rc.prototype.apply=function(t){return this.o_(),this.r_=!0,this.bc(t)},rc.prototype.o_=function(){},n(ic,dh=rc),ic.prototype.bc=function(n){var i=this,r=[];return this.Ch.forEach(function(t,e){e?r.push(i.c_.Xh(n,e,i.readTime)):i.c_.Yh(t)}),ku.Gn(r)},ic.prototype.a_=function(t,e){return this.c_.tr(t,e)},ic.prototype.u_=function(t,e){return this.c_.getEntries(t,e)},ic);var oc,sc=(bc.prototype.Xs=function(t,n){return this.l_.forEach(function(t,e){return n(e)}),ku.resolve()},bc.prototype.Wh=function(t){return ku.resolve(this.lastRemoteSnapshotVersion)},bc.prototype.w_=function(t){return ku.resolve(this.__)},bc.prototype.ao=function(t){return this.highestTargetId=this.f_.next(),ku.resolve(this.highestTargetId)},bc.prototype.to=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.__&&(this.__=e),ku.resolve()},bc.prototype.T_=function(t){this.l_.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.f_=new Th(e),this.highestTargetId=e),t.sequenceNumber>this.__&&(this.__=t.sequenceNumber)},bc.prototype.uo=function(t,e){return this.T_(e),this.targetCount+=1,ku.resolve()},bc.prototype.Jh=function(t,e){return this.T_(e),ku.resolve()},bc.prototype.m_=function(t,e){return this.l_.delete(e.target),this.d_.Nn(e.targetId),--this.targetCount,ku.resolve()},bc.prototype.E_=function(n,i,r){var o=this,s=0,u=[];return this.l_.forEach(function(t,e){e.sequenceNumber<=i&&null===r.get(e.targetId)&&(o.l_.delete(t),u.push(o.R_(n,e.targetId)),s++)}),ku.Gn(u).next(function(){return s})},bc.prototype.I_=function(t){return ku.resolve(this.targetCount)},bc.prototype.oo=function(t,e){var n=this.l_.get(e)||null;return ku.resolve(n)},bc.prototype.ui=function(t,e){return yu("Not yet implemented.")},bc.prototype.zh=function(e,t,n){this.d_.Sn(t,n);var i=this.persistence.dh,r=[];return i&&t.forEach(function(t){r.push(i.vn(e,t))}),ku.Gn(r)},bc.prototype.Gh=function(e,t,n){this.d_.Fn(t,n);var i=this.persistence.dh,r=[];return i&&t.forEach(function(t){r.push(i.Cn(e,t))}),ku.Gn(r)},bc.prototype.R_=function(t,e){return this.d_.Nn(e),ku.resolve()},bc.prototype._o=function(t,e){var n=this.d_.Ln(e);return ku.resolve(n)},bc.prototype.$n=function(t,e){return ku.resolve(this.d_.$n(e))},bc),uc=(wc.prototype.start=function(){return Promise.resolve()},wc.prototype.ku=function(){return this.V_=!1,Promise.resolve()},Object.defineProperty(wc.prototype,"g_",{get:function(){return this.V_},enumerable:!0,configurable:!0}),wc.prototype.wo=function(){return c(this,void 0,void 0,function(){return y(this,function(t){return[2,[this.clientId]]})})},wc.prototype.y_=function(t){return t(!0)},wc.prototype.b_=function(){},wc.prototype.Eo=function(t){},wc.prototype.Ih=function(){return this.Jn},wc.prototype.fh=function(t){var e=this.A_[t.s()];return e||(e=new Vh(this.Jn,this.dh),this.A_[t.s()]=e),e},wc.prototype.Eh=function(){return this.mh},wc.prototype.Th=function(){return this.Kn},wc.prototype.runTransaction=function(t,e,n){var i=this;fu("MemoryPersistence","Starting transaction:",t);var r=new ac(this.P_.next());return this.dh.v_(),n(r).next(function(t){return i.dh.S_(r).next(function(){return t})}).Wn().then(function(t){return r.C_(),t})},wc.prototype.D_=function(e,n){return ku.zn(Object.values(this.A_).map(function(t){return function(){return t.$n(e,n)}}))},wc),ac=(mc.prototype.N_=function(t){this.F_.push(t)},mc.prototype.C_=function(){this.F_.forEach(function(t){return t()})},n(gc,oc=mc),gc),hc=(vc.O_=function(t){return new vc(t)},Object.defineProperty(vc.prototype,"M_",{get:function(){if(this.L_)return this.L_;throw yu("orphanedDocuments is only valid during a transaction.")},enumerable:!0,configurable:!0}),vc.prototype._h=function(t){this.k_=t},vc.prototype.vn=function(t,e){return this.M_.delete(e),ku.resolve()},vc.prototype.Cn=function(t,e){return this.M_.add(e),ku.resolve()},vc.prototype.Zl=function(t,e){return this.M_.add(e),ku.resolve()},vc.prototype.removeTarget=function(t,e){var n=this,i=this.persistence.Eh();return i._o(t,e.targetId).next(function(t){t.forEach(function(t){return n.M_.add(t)})}).next(function(){return i.m_(t,e)})},vc.prototype.v_=function(){this.L_=new Set},vc.prototype.S_=function(t){var n=this,i=this.persistence.Th().kh();return ku.forEach(this.M_,function(e){return n.U_(t,e).next(function(t){t||i.Yh(e)})}).next(function(){return n.L_=null,i.apply(t)})},vc.prototype.Zh=function(t,e){var n=this;return this.U_(t,e).next(function(t){t?n.M_.delete(e):n.M_.add(e)})},vc.prototype.p_=function(t){return 0},vc.prototype.U_=function(t,e){var n=this;return ku.zn([function(){return n.persistence.Eh().$n(t,e)},function(){return n.persistence.D_(t,e)},function(){return ku.resolve(n.k_.$n(e))}])},vc),cc=(yc.prototype.initialize=function(e){return c(this,void 0,void 0,function(){var n=this;return y(this,function(t){switch(t.label){case 0:return this.Qc=this.q_(e),this.persistence=this.B_(e),[4,this.persistence.start()];case 1:return t.sent(),this.x_=this.Q_(e),this._u=this.W_(e),this.Lc=this.j_(e),this.Mu=this.G_(e),this.z_=this.K_(e),this.Qc.iu=function(t){return n.Mu.Dc(t,1)},this.Lc.Mu=this.Mu,this.Qc.Mu=this.Mu,[4,this.Qc.start()];case 2:return t.sent(),[4,this.Lc.start()];case 3:return t.sent(),[4,this._u.start()];case 4:return t.sent(),[4,this.persistence.y_(function(e){return c(n,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return[4,this.Mu.Zu(e)];case 1:return t.sent(),this.x_&&(e&&!this.x_.g_?this.x_.start(this._u):e||this.x_.stop()),[2]}})})})];case 5:return t.sent(),[2]}})})},yc.prototype.K_=function(t){return new Rh(this.Mu)},yc.prototype.Q_=function(t){return null},yc.prototype.W_=function(t){return new Xu(this.persistence,new Lh,t.H_)},yc.prototype.B_=function(t){return new uc(t.clientId,hc.O_)},yc.prototype.j_=function(t){var e=this;return new Ah(this._u,t.Ha,t.Ar,function(t){return e.Mu.Dc(t,0)},t.platform.J_())},yc.prototype.q_=function(t){return new Nh},yc.prototype.G_=function(t){return new kh(this._u,this.Lc,this.Qc,t.H_,t.Wc)},yc.prototype.clearPersistence=function(t){throw new Mi(Pi.FAILED_PRECONDITION,"You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.")},yc),lc=(dc.prototype.start=function(e,n){var i=this;this.X_();var r=new Fu,o=new Fu,s=!1;return this.credentials._(function(t){if(!s)return s=!0,fu("FirestoreClient","Initializing. user=",t.uid),i.Z_(e,n,t,o).then(r.resolve,r.reject);i.Ar.Cr(function(){return i.Xu(t)})}),this.Ar.Cr(function(){return r.promise}),o.promise},dc.prototype.enableNetwork=function(){var t=this;return this.X_(),this.Ar.enqueue(function(){return t.Mu.enableNetwork()})},dc.prototype.Z_=function(s,u,a,h){return c(this,void 0,void 0,function(){var e,n,i,r,o=this;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),[4,this.platform.td(this.Y_)];case 1:return e=t.sent(),n=this.platform.ed(this.Y_.ci),i=new wh(this.Ar,e,this.credentials,n),[4,s.initialize({Ar:this.Ar,Y_:this.Y_,platform:this.platform,Ha:i,clientId:this.clientId,H_:a,Wc:100,sd:u})];case 2:return t.sent(),this.persistence=s.persistence,this.Qc=s.Qc,this._u=s._u,this.Lc=s.Lc,this.Mu=s.Mu,this.x_=s.x_,this.nd=s.z_,this.persistence.b_(function(){return c(o,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return[4,this.terminate()];case 1:return t.sent(),[2]}})})}),h.resolve(),[3,4];case 3:if(r=t.sent(),h.reject(r),!this.rd(r))throw r;return[2,(console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+r),this.Z_(new cc,{hd:!1},a,h))];case 4:return[2]}})})},dc.prototype.rd=function(t){return"FirebaseError"===t.name?t.code===Pi.FAILED_PRECONDITION||t.code===Pi.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code},dc.prototype.X_=function(){if(this.Ar.Or)throw new Mi(Pi.FAILED_PRECONDITION,"The client has already been terminated.")},dc.prototype.Xu=function(t){return this.Ar.jr(),fu("FirestoreClient","Credential Changed. Current user: "+t.uid),this.Mu.Xu(t)},dc.prototype.disableNetwork=function(){var t=this;return this.X_(),this.Ar.enqueue(function(){return t.Mu.disableNetwork()})},dc.prototype.terminate=function(){var t=this;return this.Ar.xr(function(){return c(t,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.x_&&this.x_.stop(),[4,this.Lc.ku()];case 1:return t.sent(),[4,this.Qc.ku()];case 2:return t.sent(),[4,this.persistence.ku()];case 3:return t.sent(),this.credentials.T(),[2]}})})})},dc.prototype.waitForPendingWrites=function(){var t=this;this.X_();var e=new Fu;return this.Ar.Cr(function(){return t.Mu.fl(e)}),e.promise},dc.prototype.listen=function(t,e,n){var i=this;this.X_();var r=new Oh(t,e,n);return this.Ar.Cr(function(){return i.nd.listen(r)}),r},dc.prototype.$u=function(t){var e=this;this.od||this.Ar.Cr(function(){return e.nd.$u(t)})},dc.prototype.ad=function(t){var e=this;return this.X_(),this.Ar.enqueue(function(){return e._u.ro(t)}).then(function(t){if(t instanceof Lo)return t;if(t instanceof Do)return null;throw new Mi(Pi.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")})},dc.prototype.ud=function(r){var t=this;return this.X_(),this.Ar.enqueue(function(){return c(t,void 0,void 0,function(){var e,n,i;return y(this,function(t){switch(t.label){case 0:return[4,this._u.lo(r,!0)];case 1:return e=t.sent(),n=new _h(r,e.do),i=n.Vc(e.documents),[2,n.bc(i,!1).snapshot]}})})})},dc.prototype.write=function(t){var e=this;this.X_();var n=new Fu;return this.Ar.Cr(function(){return e.Mu.write(t,n)}),n.promise},dc.prototype.ci=function(){return this.Y_.ci},dc.prototype.Fl=function(t){var e=this;this.X_(),this.Ar.Cr(function(){return e.nd.Fl(t),Promise.resolve()})},dc.prototype.Nl=function(t){this.od||this.nd.Nl(t)},Object.defineProperty(dc.prototype,"od",{get:function(){return this.Ar.Or},enumerable:!0,configurable:!0}),dc.prototype.transaction=function(t){var e=this;this.X_();var n=new Fu;return this.Ar.Cr(function(){return e.Mu.runTransaction(e.Ar,t,n),Promise.resolve()}),n.promise},dc),fc=(pc.prototype.next=function(t){this.ld(this.observer.next,t)},pc.prototype.error=function(t){this.ld(this.observer.error,t)},pc.prototype._d=function(){this.muted=!0},pc.prototype.ld=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},pc);function pc(t){this.observer=t,this.muted=!1}function dc(t,e,n,i){this.platform=t,this.Y_=e,this.credentials=n,this.Ar=i,this.clientId=gu.Tn()}function yc(){}function vc(t){this.persistence=t,this.k_=null,this.L_=null}function gc(t){var e=this;return(e=oc.call(this)||this).Kh=t,e}function mc(){this.F_=[]}function wc(t,e){var n=this;this.clientId=t,this.A_={},this.P_=new Lu(0),this.V_=!1,this.V_=!0,this.dh=e(this),this.mh=new sc(this),this.Jn=new Dh,this.Kn=new Uh(this.Jn,function(t){return n.dh.p_(t)})}function bc(t){this.persistence=t,this.l_=new Iu(function(t){return t.canonicalId()}),this.lastRemoteSnapshotVersion=Bi.MIN,this.highestTargetId=0,this.__=0,this.d_=new _u,this.targetCount=0,this.f_=Th.Tc()}function Ec(r){return function(){if("object"==typeof r&&null!==r)for(var t=r,e=0,n=["next","error","complete"];e<n.length;e++){var i=n[e];if(i in t&&"function"==typeof t[i])return 1}}()}var Ac,Ic,Nc=(Wc.prototype.fd=function(t){switch(Rr(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Pr(t.integerValue||t.doubleValue);case 3:return this.wd(t.timestampValue);case 4:return this.Td(t);case 5:return t.stringValue;case 6:return new wa(Mr(t.bytesValue));case 7:return this.md(t.referenceValue);case 8:return new Ga(t.geoPointValue.latitude,t.geoPointValue.longitude);case 9:return this.Ed(t.arrayValue);case 10:return this.Rd(t.mapValue);default:throw yu("Invalid value type: "+JSON.stringify(t))}},Wc.prototype.Rd=function(t){var n=this,i={};return br(t.fields||{},function(t,e){i[t]=n.fd(e)}),i},Wc.prototype.Ed=function(t){var e=this;return(t.values||[]).map(function(t){return e.fd(t)})},Wc.prototype.Td=function(t){switch(this.dd){case"previous":var e=function t(e){var n=e.mapValue.fields.__previous_value__;return _r(n)?t(n):n}(t);return null==e?null:this.fd(e);case"estimate":return this.wd(Sr(t));default:return null}},Wc.prototype.wd=function(t){var e=Ur(t),n=new Fi(e.seconds,e.nanos);return this.timestampsInSnapshots?n:n.toDate()},Wc.prototype.md=function(t){var e=$i.K(t);vu(su(e),"ReferenceValue is not valid "+t);var n=new Au(e.get(1),e.get(3)),i=new sr(e.$(5));return n.isEqual(this.firestore.Id)||pu("Document "+i+" contains a document reference within a different database ("+n.projectId+"/"+n.database+") which is not supported. It will be treated as a reference in the current database ("+this.firestore.Id.projectId+"/"+this.firestore.Id.database+") instead."),new Oc(i,this.firestore,this.converter)},Wc),Tc=Yu.sh,_c=(Qc.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.timestampsInSnapshots===t.timestampsInSnapshots&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.forceLongPolling===t.forceLongPolling},Qc),Sc=(zc.prototype.settings=function(t){$u("Firestore.settings",arguments,1),na("Firestore.settings","object",1,t);var e=new _c(t);if(this.pd&&!this.Sd.isEqual(e))throw new Mi(Pi.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");void 0!==(this.Sd=e).credentials&&(this.bd=function(t){if(!t)return new qi;switch(t.type){case"gapi":var e=t.Fd;return vu(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty),"unexpected gapi interface"),new ji(e,t.V||"0");case"provider":return t.Fd;default:throw new Mi(Pi.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(e.credentials))},zc.prototype.enableNetwork=function(){return this.Vd(),this.pd.enableNetwork()},zc.prototype.disableNetwork=function(){return this.Vd(),this.pd.disableNetwork()},zc.prototype.enablePersistence=function(t){var e,n;if(this.pd)throw new Mi(Pi.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var i=!1;return t&&(void 0!==t.experimentalTabSynchronization&&pu("The 'experimentalTabSynchronization' setting will be removed. Use 'synchronizeTabs' instead."),i=null!==(n=null!==(e=t.synchronizeTabs)&&void 0!==e?e:t.experimentalTabSynchronization)&&void 0!==n&&n),this.Nd(this.vd,{hd:!0,cacheSizeBytes:this.Sd.cacheSizeBytes,synchronizeTabs:i})},zc.prototype.clearPersistence=function(){return c(this,void 0,void 0,function(){var i,e=this;return y(this,function(t){if(void 0!==this.pd&&!this.pd.od)throw new Mi(Pi.FAILED_PRECONDITION,"Persistence cannot be cleared after this Firestore instance is initialized.");return i=new Fu,[2,(this.Pd.Mr(function(){return c(e,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),e=this.kd(),[4,this.vd.clearPersistence(e)];case 1:return t.sent(),i.resolve(),[3,3];case 2:return n=t.sent(),i.reject(n),[3,3];case 3:return[2]}})})}),i.promise)]})})},zc.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(zc.prototype,"Ld",{get:function(){return this.Vd(),this.pd.od},enumerable:!0,configurable:!0}),zc.prototype.waitForPendingWrites=function(){return this.Vd(),this.pd.waitForPendingWrites()},zc.prototype.onSnapshotsInSync=function(t){if(this.Vd(),Ec(t))return this.$d(t);na("Firestore.onSnapshotsInSync","function",1,t);var e={next:t};return this.$d(e)},zc.prototype.$d=function(t){var e=this,n=new fc({next:function(){t.next&&t.next()},error:function(t){throw yu("Uncaught Error in onSnapshotsInSync")}});return this.pd.Fl(n),function(){n._d(),e.pd.Nl(n)}},zc.prototype.Vd=function(){return this.pd||this.Nd(new cc,{hd:!1}),this.pd},zc.prototype.kd=function(){return new Eu(this.Id,this.yd,this.Sd.host,this.Sd.ssl,this.Sd.forceLongPolling)},zc.prototype.Nd=function(t,e){var n=this.kd();return this.pd=new lc(uu.Ot(),n,this.bd,this.Pd),this.pd.start(t,e)},zc.prototype.Dd=function(i){var t=new ru(i,{di:uu.Ot().di});return new $a(t,function(t){if(t instanceof Oc){var e=i,n=t.firestore.Id;if(!n.isEqual(e))throw new Mi(Pi.INVALID_ARGUMENT,"Document reference is for database "+n.projectId+"/"+n.database+" but should be for database "+e.projectId+"/"+e.database);return new Za(i,t.Od)}return t})},zc.gd=function(t){if(e=t.options,!Object.prototype.hasOwnProperty.call(e,"projectId"))throw new Mi(Pi.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var e,n=t.options.projectId;if(!n||"string"!=typeof n)throw new Mi(Pi.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new Au(n)},Object.defineProperty(zc.prototype,"app",{get:function(){if(!this.Ad)throw new Mi(Pi.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.Ad},enumerable:!0,configurable:!0}),zc.prototype.collection=function(t){return $u("Firestore.collection",arguments,1),na("Firestore.collection","non-empty string",1,t),this.Vd(),new Pc($i.K(t),this)},zc.prototype.doc=function(t){return $u("Firestore.doc",arguments,1),na("Firestore.doc","non-empty string",1,t),this.Vd(),Oc.Md($i.K(t),this)},zc.prototype.collectionGroup=function(t){if($u("Firestore.collectionGroup",arguments,1),na("Firestore.collectionGroup","non-empty string",1,t),0<=t.indexOf("/"))throw new Mi(Pi.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.Vd(),new Vc(new Uo($i.H,t),this)},zc.prototype.runTransaction=function(e){var n=this;return $u("Firestore.runTransaction",arguments,1),na("Firestore.runTransaction","function",1,e),this.Vd().transaction(function(t){return e(new kc(n,t))})},zc.prototype.batch=function(){return this.Vd(),new Rc(this)},Object.defineProperty(zc,"logLevel",{get:function(){switch(cu()){case u.DEBUG:return"debug";case u.SILENT:return"silent";default:return"error"}},enumerable:!0,configurable:!0}),zc.setLogLevel=function(t){switch($u("Firestore.setLogLevel",arguments,1),na("Firestore.setLogLevel","non-empty string",1,t),t){case"debug":lu(u.DEBUG);break;case"error":lu(u.ERROR);break;case"silent":lu(u.SILENT);break;default:throw new Mi(Pi.INVALID_ARGUMENT,"Invalid log level: "+t)}},zc.prototype.Ud=function(){return this.Sd.timestampsInSnapshots},zc),kc=(Yc.prototype.get=function(t){var n=this;$u("Transaction.get",arguments,1);var i=Zc("Transaction.get",t,this.qd);return this.Bd.za([i.Od]).then(function(t){if(!t||1!==t.length)return yu("Mismatch in docs returned from document lookup.");var e=t[0];if(e instanceof Do)return new Dc(n.qd,i.Od,null,!1,!1,i.xd);if(e instanceof Lo)return new Dc(n.qd,i.Od,e,!1,!1,i.xd);throw yu("BatchGetDocumentsRequest returned unexpected document type: "+e.constructor.name)})},Yc.prototype.set=function(t,e,n){ea("Transaction.set",arguments,2,3);var i=Zc("Transaction.set",t,this.qd);n=Xc("Transaction.set",n);var r=$c(i.xd,e,"Transaction.set"),o=r[0],s=r[1],u=n.merge||n.mergeFields?this.qd.Cd.zo(s,o,n.mergeFields):this.qd.Cd.jo(s,o);return this.Bd.set(i.Od,u),this},Yc.prototype.update=function(t,e,n){for(var i,r,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return r="string"==typeof e||e instanceof Ea?(ta("Transaction.update",arguments,3),i=Zc("Transaction.update",t,this.qd),this.qd.Cd.Yo("Transaction.update",e,n,o)):($u("Transaction.update",arguments,2),i=Zc("Transaction.update",t,this.qd),this.qd.Cd.Ko("Transaction.update",e)),this.Bd.update(i.Od,r),this},Yc.prototype.delete=function(t){$u("Transaction.delete",arguments,1);var e=Zc("Transaction.delete",t,this.qd);return this.Bd.delete(e.Od),this},Yc),Rc=(Hc.prototype.set=function(t,e,n){ea("WriteBatch.set",arguments,2,3),this.jd();var i=Zc("WriteBatch.set",t,this.qd);n=Xc("WriteBatch.set",n);var r=$c(i.xd,e,"WriteBatch.set"),o=r[0],s=r[1],u=n.merge||n.mergeFields?this.qd.Cd.zo(s,o,n.mergeFields):this.qd.Cd.jo(s,o);return this.Qd=this.Qd.concat(u.Lo(i.Od,no.NONE)),this},Hc.prototype.update=function(t,e,n){for(var i,r,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return this.jd(),r="string"==typeof e||e instanceof Ea?(ta("WriteBatch.update",arguments,3),i=Zc("WriteBatch.update",t,this.qd),this.qd.Cd.Yo("WriteBatch.update",e,n,o)):($u("WriteBatch.update",arguments,2),i=Zc("WriteBatch.update",t,this.qd),this.qd.Cd.Ko("WriteBatch.update",e)),this.Qd=this.Qd.concat(r.Lo(i.Od,no.exists(!0))),this},Hc.prototype.delete=function(t){$u("WriteBatch.delete",arguments,1),this.jd();var e=Zc("WriteBatch.delete",t,this.qd);return this.Qd=this.Qd.concat(new vo(e.Od,no.NONE)),this},Hc.prototype.commit=function(){return this.jd(),this.Wd=!0,0<this.Qd.length?this.qd.Vd().write(this.Qd):Promise.resolve()},Hc.prototype.jd=function(){if(this.Wd)throw new Mi(Pi.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},Hc),Oc=(Bc.Md=function(t,e,n){if(t.length%2!=0)throw new Mi(Pi.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.G()+" has "+t.length);return new Bc(new sr(t),e,n)},Object.defineProperty(Bc.prototype,"id",{get:function(){return this.Od.path.U()},enumerable:!0,configurable:!0}),Object.defineProperty(Bc.prototype,"parent",{get:function(){return new Pc(this.Od.path.O(),this.firestore,this.xd)},enumerable:!0,configurable:!0}),Object.defineProperty(Bc.prototype,"path",{get:function(){return this.Od.path.G()},enumerable:!0,configurable:!0}),Bc.prototype.collection=function(t){if($u("DocumentReference.collection",arguments,1),na("DocumentReference.collection","non-empty string",1,t),!t)throw new Mi(Pi.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");var e=$i.K(t);return new Pc(this.Od.path.child(e),this.firestore)},Bc.prototype.isEqual=function(t){if(!(t instanceof Bc))throw fa("isEqual","DocumentReference",1,t);return this.firestore===t.firestore&&this.Od.isEqual(t.Od)&&this.xd===t.xd},Bc.prototype.set=function(t,e){ea("DocumentReference.set",arguments,1,2),e=Xc("DocumentReference.set",e);var n=$c(this.xd,t,"DocumentReference.set"),i=n[0],r=n[1],o=e.merge||e.mergeFields?this.firestore.Cd.zo(r,i,e.mergeFields):this.firestore.Cd.jo(r,i);return this.pd.write(o.Lo(this.Od,no.NONE))},Bc.prototype.update=function(t,e){for(var n,i=[],r=2;r<arguments.length;r++)i[r-2]=arguments[r];return n="string"==typeof t||t instanceof Ea?(ta("DocumentReference.update",arguments,2),this.firestore.Cd.Yo("DocumentReference.update",t,e,i)):($u("DocumentReference.update",arguments,1),this.firestore.Cd.Ko("DocumentReference.update",t)),this.pd.write(n.Lo(this.Od,no.exists(!0)))},Bc.prototype.delete=function(){return $u("DocumentReference.delete",arguments,0),this.pd.write([new vo(this.Od,no.NONE)])},Bc.prototype.onSnapshot=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];ea("DocumentReference.onSnapshot",arguments,1,4);var n,i={includeMetadataChanges:!1},r=0;"object"!=typeof t[r]||Ec(t[r])||(la("DocumentReference.onSnapshot",i=t[r],["includeMetadataChanges"]),oa("DocumentReference.onSnapshot","boolean","includeMetadataChanges",i.includeMetadataChanges),r++);var o={includeMetadataChanges:i.includeMetadataChanges};return n=Ec(t[r])?t[r]:(na("DocumentReference.onSnapshot","function",r,t[r]),ia("DocumentReference.onSnapshot","function",r+1,t[r+1]),ia("DocumentReference.onSnapshot","function",r+2,t[r+2]),{next:t[r],error:t[r+1],complete:t[r+2]}),this.Gd(o,n)},Bc.prototype.Gd=function(t,n){var i=this,e=function(t){console.error("Uncaught Error in onSnapshot:",t)};n.error&&(e=n.error.bind(n));var r=new fc({next:function(t){if(n.next){var e=t.docs.get(i.Od);n.next(new Dc(i.firestore,i.Od,e,t.fromCache,t.hasPendingWrites,i.xd))}},error:e}),o=this.pd.listen(Uo.ve(this.Od.path),r,t);return function(){r._d(),i.pd.$u(o)}},Bc.prototype.get=function(n){var i=this;return ea("DocumentReference.get",arguments,0,1),Kc("DocumentReference.get",n),new Promise(function(e,t){n&&"cache"===n.source?i.firestore.Vd().ad(i.Od).then(function(t){e(new Dc(i.firestore,i.Od,t,!0,t instanceof Lo&&t.te,i.xd))},t):i.zd(e,t,n)})},Bc.prototype.zd=function(e,n,i){var r=this.Gd({includeMetadataChanges:!0,ql:!0},{next:function(t){r(),!t.exists&&t.metadata.fromCache?n(new Mi(Pi.UNAVAILABLE,"Failed to get document because the client is offline.")):t.exists&&t.metadata.fromCache&&i&&"server"===i.source?n(new Mi(Pi.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):e(t)},error:n})},Bc.prototype.withConverter=function(t){return new Bc(this.Od,this.firestore,t)},Bc),Lc=(Fc.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},Fc),Dc=(jc.prototype.data=function(t){if(ea("DocumentSnapshot.data",arguments,0,1),t=Jc("DocumentSnapshot.data",t),this.Kd){if(this.xd){var e=new Cc(this.qd,this.Od,this.Kd,this.Hd,this.Jd);return this.xd.fromFirestore(e,t)}return new Nc(this.qd,this.qd.Ud(),t.serverTimestamps,void 0).fd(this.Kd.Re())}},jc.prototype.get=function(t,e){if(ea("DocumentSnapshot.get",arguments,1,2),e=Jc("DocumentSnapshot.get",e),this.Kd){var n=this.Kd.data().field(rh("DocumentSnapshot.get",t));if(null!==n)return new Nc(this.qd,this.qd.Ud(),e.serverTimestamps,this.xd).fd(n)}},Object.defineProperty(jc.prototype,"id",{get:function(){return this.Od.path.U()},enumerable:!0,configurable:!0}),Object.defineProperty(jc.prototype,"ref",{get:function(){return new Oc(this.Od,this.qd,this.xd)},enumerable:!0,configurable:!0}),Object.defineProperty(jc.prototype,"exists",{get:function(){return null!==this.Kd},enumerable:!0,configurable:!0}),Object.defineProperty(jc.prototype,"metadata",{get:function(){return new Lc(this.Jd,this.Hd)},enumerable:!0,configurable:!0}),jc.prototype.isEqual=function(t){if(!(t instanceof jc))throw fa("isEqual","DocumentSnapshot",1,t);return this.qd===t.qd&&this.Hd===t.Hd&&this.Od.isEqual(t.Od)&&(null===this.Kd?null===t.Kd:this.Kd.isEqual(t.Kd))&&this.xd===t.xd},jc),Cc=(n(Gc,Ic=Dc),Gc.prototype.data=function(t){return Ic.prototype.data.call(this,t)},Gc),Vc=(xc.prototype.where=function(t,e,n){var i;$u("Query.where",arguments,3),ca("Query.where",3,n),function(t,e){if(!t.some(function(t){return t===e}))throw new Mi(Pi.INVALID_ARGUMENT,"Invalid value "+ha(e)+" provided to function Query.where() for its "+da(2)+" argument. Acceptable values: "+t.join(", "))}(["<","<=","==",">=",">","array-contains","in","array-contains-any"],e);var r=rh("Query.where",t),o=Po.K(e);if(r.Y()){if(o===Po.ARRAY_CONTAINS||o===Po.ARRAY_CONTAINS_ANY)throw new Mi(Pi.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o.toString()+"' queries on FieldPath.documentId().");if(o===Po.IN){this.Xd(n,o);for(var s=[],u=0,a=n;u<a.length;u++){var h=a[u];s.push(this.Zd(h))}i={arrayValue:{values:s}}}else i=this.Zd(n)}else o!==Po.IN&&o!==Po.ARRAY_CONTAINS_ANY||this.Xd(n,o),i=this.firestore.Cd.Xo("Query.where",n,o===Po.IN);var c=Ko.create(r,o,i);return this.tf(c),new xc(this.Yd.De(c),this.firestore,this.xd)},xc.prototype.orderBy=function(t,e){var n;if(ea("Query.orderBy",arguments,1,2),ia("Query.orderBy","non-empty string",2,e),void 0===e||"asc"===e)n=is.ASCENDING;else{if("desc"!==e)throw new Mi(Pi.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+e+"', expected 'asc' or 'desc'.");n=is.DESCENDING}if(null!==this.Yd.startAt)throw new Mi(Pi.INVALID_ARGUMENT,"Invalid query. You must not call Query.startAt() or Query.startAfter() before calling Query.orderBy().");if(null!==this.Yd.endAt)throw new Mi(Pi.INVALID_ARGUMENT,"Invalid query. You must not call Query.endAt() or Query.endBefore() before calling Query.orderBy().");var i=rh("Query.orderBy",t),r=new ys(i,n);return this.ef(r),new xc(this.Yd.Fe(r),this.firestore,this.xd)},xc.prototype.limit=function(t){return $u("Query.limit",arguments,1),na("Query.limit","number",1,t),pa("Query.limit",1,t),new xc(this.Yd.Ne(t),this.firestore,this.xd)},xc.prototype.limitToLast=function(t){return $u("Query.limitToLast",arguments,1),na("Query.limitToLast","number",1,t),pa("Query.limitToLast",1,t),new xc(this.Yd.ke(t),this.firestore,this.xd)},xc.prototype.startAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];ta("Query.startAt",arguments,1);var i=this.sf("Query.startAt",t,e,!0);return new xc(this.Yd.Le(i),this.firestore,this.xd)},xc.prototype.startAfter=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];ta("Query.startAfter",arguments,1);var i=this.sf("Query.startAfter",t,e,!1);return new xc(this.Yd.Le(i),this.firestore,this.xd)},xc.prototype.endBefore=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];ta("Query.endBefore",arguments,1);var i=this.sf("Query.endBefore",t,e,!0);return new xc(this.Yd.$e(i),this.firestore,this.xd)},xc.prototype.endAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];ta("Query.endAt",arguments,1);var i=this.sf("Query.endAt",t,e,!1);return new xc(this.Yd.$e(i),this.firestore,this.xd)},xc.prototype.isEqual=function(t){if(!(t instanceof xc))throw fa("isEqual","Query",1,t);return this.firestore===t.firestore&&this.Yd.isEqual(t.Yd)},xc.prototype.withConverter=function(t){return new xc(this.Yd,this.firestore,t)},xc.prototype.sf=function(t,e,n,i){if(ca(t,1,e),e instanceof Dc){if(0<n.length)throw new Mi(Pi.INVALID_ARGUMENT,"Too many arguments provided to "+t+"().");var r=e;if(!r.exists)throw new Mi(Pi.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+t+"().");return this.if(r.Kd,i)}var o=[e].concat(n);return this.nf(t,o,i)},xc.prototype.if=function(t,e){for(var n=[],i=0,r=this.Yd.orderBy;i<r.length;i++){var o=r[i];if(o.field.Y())n.push(qr(this.firestore.Id,t.key));else{var s=t.field(o.field);if(_r(s))throw new Mi(Pi.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+o.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===s){var u=o.field.G();throw new Mi(Pi.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.")}n.push(s)}}return new ds(n,e)},xc.prototype.nf=function(t,e,n){var i=this.Yd.Ve;if(e.length>i.length)throw new Mi(Pi.INVALID_ARGUMENT,"Too many arguments provided to "+t+"(). The number of arguments must be less than or equal to the number of Query.orderBy() clauses");for(var r=[],o=0;o<e.length;o++){var s=e[o];if(i[o].field.Y()){if("string"!=typeof s)throw new Mi(Pi.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+t+"(), but got a "+typeof s);if(!this.Yd.He()&&-1!==s.indexOf("/"))throw new Mi(Pi.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+t+"() must be a plain document ID, but '"+s+"' contains a slash.");var u=this.Yd.path.child($i.K(s));if(!sr.st(u))throw new Mi(Pi.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+t+"() must result in a valid document path, but '"+u+"' is not because it contains an odd number of segments.");var a=new sr(u);r.push(qr(this.firestore.Id,a))}else{var h=this.firestore.Cd.Xo(t,s);r.push(h)}}return new ds(r,n)},xc.prototype.onSnapshot=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];ea("Query.onSnapshot",arguments,1,4);var n,i={},r=0;return"object"!=typeof t[r]||Ec(t[r])||(la("Query.onSnapshot",i=t[r],["includeMetadataChanges"]),oa("Query.onSnapshot","boolean","includeMetadataChanges",i.includeMetadataChanges),r++),n=Ec(t[r])?t[r]:(na("Query.onSnapshot","function",r,t[r]),ia("Query.onSnapshot","function",r+1,t[r+1]),ia("Query.onSnapshot","function",r+2,t[r+2]),{next:t[r],error:t[r+1],complete:t[r+2]}),this.rf(this.Yd),this.Gd(i,n)},xc.prototype.Gd=function(t,e){var n=this,i=function(t){console.error("Uncaught Error in onSnapshot:",t)};e.error&&(i=e.error.bind(e));var r=new fc({next:function(t){e.next&&e.next(new Uc(n.firestore,n.Yd,t,n.xd))},error:i}),o=this.firestore.Vd(),s=o.listen(this.Yd,r,t);return function(){r._d(),o.$u(s)}},xc.prototype.rf=function(t){if(t.Ge()&&0===t.Ve.length)throw new Mi(Pi.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")},xc.prototype.get=function(n){var i=this;return ea("Query.get",arguments,0,1),Kc("Query.get",n),this.rf(this.Yd),new Promise(function(e,t){n&&"cache"===n.source?i.firestore.Vd().ud(i.Yd).then(function(t){e(new Uc(i.firestore,i.Yd,t,i.xd))},t):i.zd(e,t,n)})},xc.prototype.zd=function(e,n,i){var r=this.Gd({includeMetadataChanges:!0,ql:!0},{next:function(t){r(),t.metadata.fromCache&&i&&"server"===i.source?n(new Mi(Pi.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):e(t)},error:n})},xc.prototype.Zd=function(t){if("string"==typeof t){if(""===t)throw new Mi(Pi.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!this.Yd.He()&&-1!==t.indexOf("/"))throw new Mi(Pi.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+t+"' contains a '/' character.");var e=this.Yd.path.child($i.K(t));if(!sr.st(e))throw new Mi(Pi.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return qr(this.firestore.Id,new sr(e))}if(t instanceof Oc){var n=t;return qr(this.firestore.Id,n.Od)}throw new Mi(Pi.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+ha(t)+".")},xc.prototype.Xd=function(t,e){if(!Array.isArray(t)||0===t.length)throw new Mi(Pi.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new Mi(Pi.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.");if(0<=t.indexOf(null))throw new Mi(Pi.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'null' in the value array.");if(0<t.filter(function(t){return Number.isNaN(t)}).length)throw new Mi(Pi.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'NaN' in the value array.")},xc.prototype.tf=function(t){if(t instanceof Ko){var e=[Po.ARRAY_CONTAINS,Po.ARRAY_CONTAINS_ANY],n=[Po.IN,Po.ARRAY_CONTAINS_ANY],i=0<=e.indexOf(t.op),r=0<=n.indexOf(t.op);if(t.ze()){var o=this.Yd.Se();if(null!==o&&!o.isEqual(t.field))throw new Mi(Pi.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+o.toString()+"' and '"+t.field.toString()+"'");var s=this.Yd.Ce();null!==s&&this.hf(t.field,s)}else if(r||i){var u=null;if(r&&(u=this.Yd.Ke(n)),null===u&&i&&(u=this.Yd.Ke(e)),null!=u)throw u===t.op?new Mi(Pi.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+t.op.toString()+"' filter."):new Mi(Pi.INVALID_ARGUMENT,"Invalid query. You cannot use '"+t.op.toString()+"' filters with '"+u.toString()+"' filters.")}}},xc.prototype.ef=function(t){if(null===this.Yd.Ce()){var e=this.Yd.Se();null!==e&&this.hf(e,t.field)}},xc.prototype.hf=function(t,e){if(!e.isEqual(t))throw new Mi(Pi.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+t.toString()+"' and so you must also use '"+t.toString()+"' as your first Query.orderBy(), but your first Query.orderBy() is on field '"+e.toString()+"' instead.")},xc),Uc=(Object.defineProperty(qc.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!0,configurable:!0}),Object.defineProperty(qc.prototype,"empty",{get:function(){return this.uf.docs.q()},enumerable:!0,configurable:!0}),Object.defineProperty(qc.prototype,"size",{get:function(){return this.uf.docs.size},enumerable:!0,configurable:!0}),qc.prototype.forEach=function(e,n){var i=this;ea("QuerySnapshot.forEach",arguments,1,2),na("QuerySnapshot.forEach","function",1,e),this.uf.docs.forEach(function(t){e.call(n,i._f(t))})},Object.defineProperty(qc.prototype,"query",{get:function(){return new Vc(this.af,this.qd,this.xd)},enumerable:!0,configurable:!0}),qc.prototype.docChanges=function(t){t&&(la("QuerySnapshot.docChanges",t,["includeMetadataChanges"]),oa("QuerySnapshot.docChanges","boolean","includeMetadataChanges",t.includeMetadataChanges));var e=!(!t||!t.includeMetadataChanges);if(e&&this.uf.ds)throw new Mi(Pi.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.cf&&this.lf===e||(this.cf=function(r,e,o,s){if(o.cs.q()){var n=0;return o.docChanges.map(function(t){var e=new Cc(r,t.doc.key,t.doc,o.fromCache,o.ls.has(t.doc.key),s);return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var u=o.cs;return o.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=new Cc(r,t.doc.key,t.doc,o.fromCache,o.ls.has(t.doc.key),s),n=-1,i=-1;return 0!==t.type&&(n=u.indexOf(t.doc.key),u=u.delete(t.doc.key)),1!==t.type&&(i=(u=u.add(t.doc)).indexOf(t.doc.key)),{type:function(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return yu("Unknown change type: "+t)}}(t.type),doc:e,oldIndex:n,newIndex:i}})}(this.qd,e,this.uf,this.xd),this.lf=e),this.cf},qc.prototype.isEqual=function(t){if(!(t instanceof qc))throw fa("isEqual","QuerySnapshot",1,t);return this.qd===t.qd&&this.af.isEqual(t.af)&&this.uf.isEqual(t.uf)&&this.xd===t.xd},qc.prototype._f=function(t){return new Cc(this.qd,t.key,t,this.metadata.fromCache,this.uf.ls.has(t.key),this.xd)},qc),Pc=(n(Mc,Ac=Vc),Object.defineProperty(Mc.prototype,"id",{get:function(){return this.Yd.path.U()},enumerable:!0,configurable:!0}),Object.defineProperty(Mc.prototype,"parent",{get:function(){var t=this.Yd.path.O();return t.q()?null:new Oc(new sr(t),this.firestore)},enumerable:!0,configurable:!0}),Object.defineProperty(Mc.prototype,"path",{get:function(){return this.Yd.path.G()},enumerable:!0,configurable:!0}),Mc.prototype.doc=function(t){if(ea("CollectionReference.doc",arguments,0,1),0===arguments.length&&(t=gu.Tn()),na("CollectionReference.doc","non-empty string",1,t),""===t)throw new Mi(Pi.INVALID_ARGUMENT,"Document path must be a non-empty string");var e=$i.K(t);return Oc.Md(this.Yd.path.child(e),this.firestore,this.xd)},Mc.prototype.add=function(t){$u("CollectionReference.add",arguments,1),na("CollectionReference.add","object",1,this.xd?this.xd.toFirestore(t):t);var e=this.doc();return e.set(t).then(function(){return e})},Mc.prototype.withConverter=function(t){return new Mc(this.df,this.firestore,t)},Mc);function Mc(t,e,n){var i=this;if(((i=Ac.call(this,Uo.ve(t),e,n)||this).df=t).length%2!=1)throw new Mi(Pi.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t.G()+" has "+t.length);return i}function qc(t,e,n,i){this.qd=t,this.af=e,this.uf=n,this.xd=i,this.cf=null,this.lf=null,this.metadata=new Lc(n.hasPendingWrites,n.fromCache)}function xc(t,e,n){this.Yd=t,this.firestore=e,this.xd=n}function Gc(){return null!==Ic&&Ic.apply(this,arguments)||this}function jc(t,e,n,i,r,o){this.qd=t,this.Od=e,this.Kd=n,this.Hd=i,this.Jd=r,this.xd=o}function Fc(t,e){this.hasPendingWrites=t,this.fromCache=e}function Bc(t,e,n){this.Od=t,this.firestore=e,this.xd=n,this.pd=this.firestore.Vd()}function Hc(t){this.qd=t,this.Qd=[],this.Wd=!1}function Yc(t,e){this.qd=t,this.Bd=e}function zc(t,e,n){var i=this;if(void 0===n&&(n=new cc),this.Ad=null,this.Pd=new Hu,this.INTERNAL={delete:function(){return c(i,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.Vd(),[4,this.pd.terminate()];case 1:return t.sent(),[2]}})})}},"object"==typeof t.options){var r=t;this.Ad=r,this.Id=zc.gd(r),this.yd=r.name,this.bd=new xi(e)}else{var o=t;if(!o.projectId)throw new Mi(Pi.INVALID_ARGUMENT,"Must provide projectId");this.Id=new Au(o.projectId,o.database),this.yd="[DEFAULT]",this.bd=new qi}this.vd=n,this.Sd=new _c({}),this.Cd=this.Dd(this.Id)}function Qc(t){var e,n;if(void 0===t.host){if(void 0!==t.ssl)throw new Mi(Pi.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else ra("settings","non-empty string","host",t.host),this.host=t.host,oa("settings","boolean","ssl",t.ssl),this.ssl=null===(e=t.ssl)||void 0===e||e;if(la("settings",t,["host","ssl","credentials","timestampsInSnapshots","cacheSizeBytes","experimentalForceLongPolling"]),oa("settings","object","credentials",t.credentials),this.credentials=t.credentials,oa("settings","boolean","timestampsInSnapshots",t.timestampsInSnapshots),!0===t.timestampsInSnapshots?pu("The setting 'timestampsInSnapshots: true' is no longer required and should be removed."):!1===t.timestampsInSnapshots&&pu("Support for 'timestampsInSnapshots: false' will be removed soon. You must update your code to handle Timestamp objects."),this.timestampsInSnapshots=null===(n=t.timestampsInSnapshots)||void 0===n||n,oa("settings","number","cacheSizeBytes",t.cacheSizeBytes),void 0===t.cacheSizeBytes)this.cacheSizeBytes=Yu.nh;else{if(t.cacheSizeBytes!==Tc&&t.cacheSizeBytes<Yu.ih)throw new Mi(Pi.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+Yu.ih);this.cacheSizeBytes=t.cacheSizeBytes}oa("settings","boolean","experimentalForceLongPolling",t.experimentalForceLongPolling),this.forceLongPolling=void 0!==t.experimentalForceLongPolling&&t.experimentalForceLongPolling}function Wc(t,e,n,i){this.firestore=t,this.timestampsInSnapshots=e,this.dd=n,this.converter=i}function Xc(t,e){if(void 0===e)return{merge:!1};if(la(t,e,["merge","mergeFields"]),oa(t,"boolean","merge",e.merge),void 0!==(n=e.mergeFields)&&function(t,e,n){if(!(n instanceof Array))throw new Mi(Pi.INVALID_ARGUMENT,"Function "+t+"() requires its "+e+" option to be an array, but it was: "+ha(n));for(var i=0;i<n.length;++i)if(!("string"==typeof(r=n[i])||r instanceof Ea))throw new Mi(Pi.INVALID_ARGUMENT,"Function "+t+"() requires all "+e+" elements to be a string or a FieldPath, but the value at index "+i+" was: "+ha(n[i]));var r}(t,"mergeFields",n),void 0!==e.mergeFields&&void 0!==e.merge)throw new Mi(Pi.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');var n;return e}function Jc(t,e){return void 0===e?{}:(la(t,e,["serverTimestamps"]),sa(t,0,"serverTimestamps",e.serverTimestamps,["estimate","previous","none"]),e)}function Kc(t,e){ia(t,"object",1,e),e&&(la(t,e,["source"]),sa(t,0,"source",e.source,["default","server","cache"]))}function Zc(t,e,n){if(e instanceof Oc){if(e.firestore!==n)throw new Mi(Pi.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}throw fa(t,"DocumentReference",1,e)}function $c(t,e,n){var i;return t?(i=t.toFirestore(e),n="toFirestore() in "+n):i=e,[i,n]}var tl,el=va(Sc,"Use firebase.firestore() instead."),nl=va(kc,"Use firebase.firestore().runTransaction() instead."),il=va(Rc,"Use firebase.firestore().batch() instead."),rl=va(Oc,"Use firebase.firestore().doc() instead."),ol=va(Dc),sl=va(Cc),ul=va(Vc),al=va(Uc),hl=va(Pc,"Use firebase.firestore().collection() instead."),cl={Firestore:el,GeoPoint:Ga,Timestamp:Fi,Blob:ba,Transaction:nl,WriteBatch:il,DocumentReference:rl,DocumentSnapshot:ol,Query:ul,QueryDocumentSnapshot:sl,QuerySnapshot:al,CollectionReference:hl,FieldPath:Ea,FieldValue:xa,setLogLevel:Sc.setLogLevel,CACHE_SIZE_UNLIMITED:Tc},ll=(bl.prototype.mu=function(t){},bl.prototype.ku=function(){},bl),fl=(wl.prototype.mu=function(t){this.Ef.push(t)},wl.prototype.ku=function(){window.removeEventListener("online",this.ff),window.removeEventListener("offline",this.Tf)},wl.prototype.Rf=function(){window.addEventListener("online",this.ff),window.addEventListener("offline",this.Tf)},wl.prototype.wf=function(){fu("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.Ef;t<e.length;t++)(0,e[t])(0)},wl.prototype.mf=function(){fu("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.Ef;t<e.length;t++)(0,e[t])(1)},wl.If=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},wl),pl=(ml.prototype.Na=function(t){this.Vf=t},ml.prototype.va=function(t){this.pf=t},ml.prototype.onMessage=function(t){this.gf=t},ml.prototype.close=function(){this.Pf()},ml.prototype.send=function(t){this.Af(t)},ml.prototype.yf=function(){this.Vf()},ml.prototype.bf=function(t){this.pf(t)},ml.prototype.vf=function(t){this.gf(t)},ml),dl={BatchGetDocuments:"batchGet",Commit:"commit"},yl="gl-js/ fire/"+Li,vl=(gl.prototype.Cf=function(t,e){if(e)for(var n in e.o)e.o.hasOwnProperty(n)&&(t[n]=e.o[n]);t["X-Goog-Api-Client"]=yl},gl.prototype.Ga=function(a,i,r){var h=this,c=this.Df(a);return new Promise(function(o,s){var u=new Oi;u.listenOnce(ki.COMPLETE,function(){try{switch(u.getLastErrorCode()){case Si.NO_ERROR:var t=u.getResponseJson();fu("Connection","XHR received:",JSON.stringify(t)),o(t);break;case Si.TIMEOUT:fu("Connection",'RPC "'+a+'" timed out'),s(new Mi(Pi.DEADLINE_EXCEEDED,"Request time out"));break;case Si.HTTP_ERROR:var e=u.getStatus();if(fu("Connection",'RPC "'+a+'" failed with status:',e,"response text:",u.getResponseText()),0<e){var n=u.getResponseJson().error;if(n&&n.status&&n.message){var i=(r=n.status.toLowerCase().replace("_","-"),0<=Object.values(Pi).indexOf(r)?r:Pi.UNKNOWN);s(new Mi(i,n.message))}else s(new Mi(Pi.UNKNOWN,"Server responded with status "+u.getStatus()))}else fu("Connection",'RPC "'+a+'" failed'),s(new Mi(Pi.UNAVAILABLE,"Connection failed."));break;default:yu('RPC "'+a+'" failed with unanticipated webchannel error '+u.getLastErrorCode()+": "+u.getLastError()+", giving up.")}}finally{fu("Connection",'RPC "'+a+'" completed.')}var r});var t=Object.assign({},i);delete t.database;var e=JSON.stringify(t);fu("Connection","XHR sending: ",c+" "+e);var n={"Content-Type":"text/plain"};h.Cf(n,r),u.send(c,"POST",e,n,15)})},gl.prototype.Ka=function(t,e,n){return this.Ga(t,e,n)},gl.prototype.ka=function(t,e){var n,i,r=[this.Sf,"/","google.firestore.v1.Firestore","/",t,"/channel"],o=_i(),s={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.ci.projectId+"/databases/"+this.ci.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling};this.Cf(s.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(p())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=p().indexOf("Electron/")||0<=(i=p()).indexOf("MSIE ")||0<=i.indexOf("Trident/")||0<=p().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(s.httpHeadersOverwriteParam="$httpHeaders");var u=r.join("");function a(t,e){h.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})}fu("Connection","Creating WebChannel: "+u+" "+s);var h=o.createWebChannel(u,s),c=!1,l=!1,f=new pl({Af:function(t){l?fu("Connection","Not sending because WebChannel is closed:",t):(c||(fu("Connection","Opening WebChannel transport."),h.open(),c=!0),fu("Connection","WebChannel sending:",t),h.send(t))},Pf:function(){return h.close()}});return a(Ri.EventType.OPEN,function(){l||fu("Connection","WebChannel transport opened.")}),a(Ri.EventType.CLOSE,function(){l||(l=!0,fu("Connection","WebChannel transport closed"),f.bf())}),a(Ri.EventType.ERROR,function(t){l||(l=!0,fu("Connection","WebChannel transport errored:",t),f.bf(new Mi(Pi.UNAVAILABLE,"The operation could not be completed")))}),a(Ri.EventType.MESSAGE,function(t){var e;if(!l){var n=t.data[0];vu(!!n,"Got a webchannel message without data.");var i=n.error||(null===(e=n[0])||void 0===e?void 0:e.error);if(i){fu("Connection","WebChannel received error:",i);var r=i.status,o=function(){var t=fs[r];if(void 0!==t)return Is(t)}(),s=i.message;void 0===o&&(o=Pi.INTERNAL,s="Unknown error status: "+r+" with message "+i.message),l=!0,f.bf(new Mi(o,s)),h.close()}else fu("Connection","WebChannel received:",n),f.vf(n)}}),setTimeout(function(){f.yf()},0),f},gl.prototype.Df=function(t){var e=dl[t];return this.Sf+"/v1/projects/"+this.ci.projectId+"/databases/"+this.ci.database+"/documents:"+e},gl);function gl(t){this.ci=t.ci;var e=t.ssl?"https":"http";this.Sf=e+"://"+t.host,this.forceLongPolling=t.forceLongPolling}function ml(t){this.Af=t.Af,this.Pf=t.Pf}function wl(){var t=this;this.ff=function(){return t.wf()},this.Tf=function(){return t.mf()},this.Ef=[],this.Rf()}function bl(){}function El(){this.di=!0,this.yo="undefined"!=typeof atob}uu.fn((Object.defineProperty(El.prototype,"document",{get:function(){return"undefined"!=typeof document?document:null},enumerable:!0,configurable:!0}),Object.defineProperty(El.prototype,"window",{get:function(){return"undefined"!=typeof window?window:null},enumerable:!0,configurable:!0}),El.prototype.td=function(t){return Promise.resolve(new vl(t))},El.prototype.J_=function(){return new(fl.If()?fl:ll)},El.prototype.ed=function(t){return new ru(t,{di:!0})},El.prototype.wn=function(t){return JSON.stringify(t)},El.prototype.atob=function(t){return atob(t)},El.prototype.btoa=function(t){return btoa(t)},new El)),(tl=Al).INTERNAL.registerComponent(new E("firestore",function(t){return e=t.getProvider("app").getImmediate(),n=t.getProvider("auth-internal"),new Sc(e,n,new cc);var e,n},"PUBLIC").setServiceProps(Object.assign({},cl))),tl.registerVersion("@firebase/firestore","1.14.1-0")}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.memory.js - be sure to load firebase-app.js first.")}});