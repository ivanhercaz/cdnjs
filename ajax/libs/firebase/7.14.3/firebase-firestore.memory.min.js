!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t=t||self).firebase)}(this,function($c){"use strict";try{(function(){$c=$c&&Object.prototype.hasOwnProperty.call($c,"default")?$c.default:$c;var t,u,e,i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function n(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function l(t,s,u,a){return new(u=u||Promise)(function(n,e){function i(t){try{o(a.next(t))}catch(t){e(t)}}function r(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(i,r)}o((a=a.apply(t,s||[])).next())})}function p(n,i){var r,o,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(r)throw new TypeError("Generator is already executing.");for(;u;)try{if(r=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=i.call(n,u)}catch(t){e=[6,t],o=0}finally{r=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function r(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var i=Array(t),r=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,r++)i[r]=o[s];return i}function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var i=Array(t),r=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,r++)i[r]=o[s];return i}function o(t,e){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];if(!(e<t.logLevel)){var r=(new Date).toISOString(),o=h[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,s(["["+r+"]  "+t.name+":"],n))}}(e=u=u||{})[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT",u.DEBUG,u.VERBOSE,u.INFO,u.WARN,u.ERROR,u.SILENT;var a=u.INFO,h=((t={})[u.DEBUG]="log",t[u.VERBOSE]="log",t[u.INFO]="info",t[u.WARN]="warn",t[u.ERROR]="error",t),c=(Object.defineProperty(f.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in u))throw new TypeError("Invalid value assigned to `logLevel`");this._logLevel=t},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!0,configurable:!0}),f.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.DEBUG],t)),this._logHandler.apply(this,s([this,u.DEBUG],t))},f.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.VERBOSE],t)),this._logHandler.apply(this,s([this,u.VERBOSE],t))},f.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.INFO],t)),this._logHandler.apply(this,s([this,u.INFO],t))},f.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.WARN],t)),this._logHandler.apply(this,s([this,u.WARN],t))},f.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.ERROR],t)),this._logHandler.apply(this,s([this,u.ERROR],t))},f);function f(t){this.name=t,this._logLevel=a,this._logHandler=o,this._userLogHandler=null}function d(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var y,v=(n(g,y=Error),g);function g(t,e){var n=y.call(this,e)||this;return n.code=t,n.name="FirebaseError",Object.setPrototypeOf(n,g.prototype),Error.captureStackTrace&&Error.captureStackTrace(n,m.prototype.create),n}var m=(w.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var i,r=e[0]||{},o=this.service+"/"+t,s=this.errors[t],u=s?(i=r,s.replace(b,function(t,e){var n=i[e];return null!=n?n.toString():"<"+e+"?>"})):"Error",a=this.serviceName+": "+u+" ("+o+").",h=new v(o,a),c=0,f=Object.keys(r);c<f.length;c++){var l=f[c];"_"!==l.slice(-1)&&(l in h&&console.warn('Overwriting FirebaseError base field "'+l+'" can cause unexpected behavior.'),h[l]=r[l])}return h},w);function w(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var b=/\{\$([^}]+)}/g,E=(I.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},I.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},I.prototype.setServiceProps=function(t){return this.serviceProps=t,this},I);function I(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}function T(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var A,N="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},_=_||{},S=N||self;function R(){}function k(t){var e=typeof t;if("object"==e){if(!t)return"null";if(t instanceof Array)return"array";if(t instanceof Object)return e;var n=Object.prototype.toString.call(t);if("[object Window]"==n)return"object";if("[object Array]"==n||"number"==typeof t.length&&void 0!==t.splice&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("splice"))return"array";if("[object Function]"==n||void 0!==t.call&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("call"))return"function"}else if("function"==e&&void 0===t.call)return"object";return e}function D(t){var e=k(t);return"array"==e||"object"==e&&"number"==typeof t.length}function O(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var L="closure_uid_"+(1e9*Math.random()>>>0),V=0;function M(t,e,n){return t.call.apply(t.bind,arguments)}function P(e,n,t){if(!e)throw Error();if(2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,i),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function C(t,e,n){return(C=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?M:P).apply(null,arguments)}function U(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var j=Date.now||function(){return+new Date};function q(t,e){function n(){}n.prototype=e.prototype,t.M=e.prototype,t.prototype=new n,t.prototype.constructor=t}function F(){this.j=this.j,this.i=this.i}F.prototype.j=!1,F.prototype.da=function(){!this.j&&(this.j=!0,this.C(),0)&&(Object.prototype.hasOwnProperty.call(this,L)&&this[L]||(this[L]=++V))},F.prototype.C=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var x=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},G=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var i=t.length,r="string"==typeof t?t.split(""):t,o=0;o<i;o++)o in r&&e.call(n,r[o],o,t)};function B(t){return Array.prototype.concat.apply([],arguments)}function z(t){var e=t.length;if(0<e){for(var n=Array(e),i=0;i<e;i++)n[i]=t[i];return n}return[]}function H(t){return/^[\s\xa0]*$/.test(t)}var W,Q=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function Y(t,e){return-1!=t.indexOf(e)}function X(t,e){return t<e?-1:e<t?1:0}t:{var K=S.navigator;if(K){var J=K.userAgent;if(J){W=J;break t}}W=""}function $(t,e,n){for(var i in t)e.call(n,t[i],i,t)}function Z(t){var e={};for(var n in t)e[n]=t[n];return e}var tt="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function et(t,e){for(var n,i,r=1;r<arguments.length;r++){for(n in i=arguments[r])t[n]=i[n];for(var o=0;o<tt.length;o++)n=tt[o],Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}}function nt(t){return nt[" "](t),t}nt[" "]=R;var it,rt,ot=Y(W,"Opera"),st=Y(W,"Trident")||Y(W,"MSIE"),ut=Y(W,"Edge"),at=ut||st,ht=Y(W,"Gecko")&&!(Y(W.toLowerCase(),"webkit")&&!Y(W,"Edge"))&&!(Y(W,"Trident")||Y(W,"MSIE"))&&!Y(W,"Edge"),ct=Y(W.toLowerCase(),"webkit")&&!Y(W,"Edge");function ft(){var t=S.document;return t?t.documentMode:void 0}t:{var lt="",pt=(rt=W,ht?/rv:([^\);]+)(\)|;)/.exec(rt):ut?/Edge\/([\d\.]+)/.exec(rt):st?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(rt):ct?/WebKit\/(\S+)/.exec(rt):ot?/(?:Version)[ \/]?(\S+)/.exec(rt):void 0);if(pt&&(lt=pt?pt[1]:""),st){var dt=ft();if(null!=dt&&dt>parseFloat(lt)){it=String(dt);break t}}it=lt}var yt={};function vt(u){return t=u,e=function(){for(var t=0,e=Q(String(it)).split("."),n=Q(String(u)).split("."),i=Math.max(e.length,n.length),r=0;0==t&&r<i;r++){var o=e[r]||"",s=n[r]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=X(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||X(0==o[2].length,0==s[2].length)||X(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t},n=yt,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e();var t,e,n}var gt=S.document&&st&&(ft()||parseInt(it,10))||void 0,mt=!st||9<=Number(gt),wt=st&&!vt("9"),bt=function(){if(!S.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{S.addEventListener("test",R,e),S.removeEventListener("test",R,e)}catch(t){}return t}();function Et(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function It(t,e){if(Et.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,i=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(ht){t:{try{nt(e.nodeName);var r=!0;break t}catch(t){}r=!1}r||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,i?(this.clientX=void 0!==i.clientX?i.clientX:i.pageX,this.clientY=void 0!==i.clientY?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:Tt[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}Et.prototype.b=function(){this.defaultPrevented=!0},q(It,Et);var Tt={2:"touch",3:"pen",4:"mouse"};It.prototype.b=function(){It.M.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,wt)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var At="closure_listenable_"+(1e6*Math.random()|0),Nt=0;function _t(t,e,n,i,r){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!i,this.aa=r,this.key=++Nt,this.V=this.X=!1}function St(t){t.V=!0,t.listener=null,t.proxy=null,t.src=null,t.aa=null}function Rt(t){this.src=t,this.a={},this.b=0}function kt(t,e){var n,i,r,o=e.type;o in t.a&&(i=t.a[o],(n=0<=(r=x(i,e)))&&Array.prototype.splice.call(i,r,1),n&&(St(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function Dt(t,e,n,i){for(var r=0;r<t.length;++r){var o=t[r];if(!o.V&&o.listener==e&&o.capture==!!n&&o.aa==i)return r}return-1}Rt.prototype.add=function(t,e,n,i,r){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=Dt(t,e,i,r);return-1<s?(e=t[s],n||(e.X=!1)):((e=new _t(e,this.src,o,!!i,r)).X=n,t.push(e)),e};var Ot="closure_lm_"+(1e6*Math.random()|0),Lt={};function Vt(t,e,n,i,r){if(i&&i.once)return function t(e,n,i,r,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],i,r,o);return null}return i=xt(i),e&&e[At]?e.sa(n,i,O(r)?!!r.capture:!!r,o):Mt(e,n,i,!0,r,o)}(t,e,n,i,r);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Vt(t,e[o],n,i,r);return null}return n=xt(n),t&&t[At]?t.ra(e,n,O(i)?!!i.capture:!!i,r):Mt(t,e,n,!1,i,r)}function Mt(t,e,n,i,r,o){if(!e)throw Error("Invalid event type");var s=O(r)?!!r.capture:!!r;if(s&&!mt)return null;var u,a,h=qt(t);if(h||(t[Ot]=h=new Rt(t)),(n=h.add(e,n,i,s,o)).proxy)return n;if(u=jt,i=a=mt?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=i).src=t,i.listener=n,t.addEventListener)bt||(r=s),void 0===r&&(r=!1),t.addEventListener(e.toString(),i,r);else if(t.attachEvent)t.attachEvent(Ct(e.toString()),i);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(i)}return n}function Pt(t){var e,n,i;"number"!=typeof t&&t&&!t.V&&((e=t.src)&&e[At]?kt(e.c,t):(n=t.type,i=t.proxy,e.removeEventListener?e.removeEventListener(n,i,t.capture):e.detachEvent?e.detachEvent(Ct(n),i):e.addListener&&e.removeListener&&e.removeListener(i),(n=qt(e))?(kt(n,t),0==n.b&&(n.src=null,e[Ot]=null)):St(t)))}function Ct(t){return t in Lt?Lt[t]:Lt[t]="on"+t}function Ut(t,e){var n=t.listener,i=t.aa||t.src;return t.X&&Pt(t),n.call(i,e)}function jt(t,e){if(t.V)return!0;if(mt)return Ut(t,new It(e,this));if(!e)t:{e=["window","event"];for(var n=S,i=0;i<e.length;i++)if(null==(n=n[e[i]])){e=null;break t}e=n}return Ut(t,e=new It(e,this))}function qt(t){return(t=t[Ot])instanceof Rt?t:null}var Ft="__closure_events_fn_"+(1e9*Math.random()>>>0);function xt(e){return"function"==k(e)?e:(e[Ft]||(e[Ft]=function(t){return e.handleEvent(t)}),e[Ft])}function Gt(){F.call(this),this.c=new Rt(this),(this.J=this).A=null}function Bt(t,e,n,i){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var r=!0,o=0;o<e.length;++o){var s,u,a=e[o];a&&!a.V&&a.capture==n&&(s=a.listener,u=a.aa||a.src,a.X&&kt(t.c,a),r=!1!==s.call(u,i)&&r)}return r&&!i.defaultPrevented}q(Gt,F),Gt.prototype[At]=!0,(A=Gt.prototype).addEventListener=function(t,e,n,i){Vt(this,t,e,n,i)},A.removeEventListener=function(t,e,n,i){!function t(e,n,i,r,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],i,r,o);else r=O(r)?!!r.capture:!!r,i=xt(i),e&&e[At]?(e=e.c,(n=String(n).toString())in e.a&&-1<(i=Dt(s=e.a[n],i,r,o))&&(St(s[i]),Array.prototype.splice.call(s,i,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&qt(e))&&(n=e.a[n.toString()],e=-1,n&&(e=Dt(n,i,r,o)),(i=-1<e?n[e]:null)&&Pt(i))}(this,t,e,n,i)},A.dispatchEvent=function(t){var e,n=this.A;if(n)for(e=[];n;n=n.A)e.push(n);n=this.J;var i=t.type||t;if("string"==typeof t?t=new Et(t,n):t instanceof Et?t.target=t.target||n:(s=t,et(t=new Et(i,n),s)),s=!0,e)for(var r=e.length-1;0<=r;r--)var o=t.a=e[r],s=Bt(o,i,!0,t)&&s;if(s=Bt(o=t.a=n,i,!0,t)&&s,s=Bt(o,i,!1,t)&&s,e)for(r=0;r<e.length;r++)s=Bt(o=t.a=e[r],i,!1,t)&&s;return s},A.C=function(){if(Gt.M.C.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],i=0;i<n.length;i++)St(n[i]);delete e.a[t],e.b--}}this.A=null},A.ra=function(t,e,n,i){return this.c.add(String(t),e,!1,n,i)},A.sa=function(t,e,n,i){return this.c.add(String(t),e,!0,n,i)};var zt=S.JSON.stringify;function Ht(){this.b=this.a=null}var Wt,Qt=(Yt.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Yt(function(){return new Xt},function(t){t.reset()},100));function Yt(t,e,n){this.f=n,this.c=t,this.g=e,this.b=0,this.a=null}function Xt(){this.next=this.b=this.a=null}function Kt(t){S.setTimeout(function(){throw t},0)}function Jt(t,e){var n;Wt||(n=S.Promise.resolve(void 0),Wt=function(){n.then(te)}),$t||(Wt(),$t=!0),Zt.add(t,e)}Ht.prototype.add=function(t,e){var n=Qt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Xt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var $t=!(Xt.prototype.reset=function(){this.next=this.b=this.a=null}),Zt=new Ht;function te(){for(var t,e,n;n=e=void 0,n=null,(e=Zt).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){Kt(t)}var i=Qt;i.g(t),i.b<i.f&&(i.b++,t.next=i.a,i.a=t)}$t=!1}function ee(t,e){Gt.call(this),this.b=t||1,this.a=e||S,this.f=C(this.Ua,this),this.g=j()}function ne(t){t.Z=!1,t.L&&(t.a.clearTimeout(t.L),t.L=null)}function ie(t,e,n){if("function"==k(t))n&&(t=C(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=C(t.handleEvent,t)}return 2147483647<Number(e)?-1:S.setTimeout(t,e||0)}function re(t,e,n){F.call(this),this.f=null!=n?C(t,n):t,this.c=e,this.b=C(this.Pa,this),this.a=[]}function oe(t){t.T=ie(t.b,t.c),t.f.apply(null,t.a)}function se(t){F.call(this),this.b=t,this.a={}}q(ee,Gt),(A=ee.prototype).Z=!1,A.L=null,A.Ua=function(){var t;this.Z&&(0<(t=j()-this.g)&&t<.8*this.b?this.L=this.a.setTimeout(this.f,this.b-t):(this.L&&(this.a.clearTimeout(this.L),this.L=null),this.dispatchEvent("tick"),this.Z&&(ne(this),this.start())))},A.start=function(){this.Z=!0,this.L||(this.L=this.a.setTimeout(this.f,this.b),this.g=j())},A.C=function(){ee.M.C.call(this),ne(this),delete this.a},q(re,F),(A=re.prototype).ba=!1,A.T=null,A.Ia=function(t){this.a=arguments,this.T?this.ba=!0:oe(this)},A.C=function(){re.M.C.call(this),this.T&&(S.clearTimeout(this.T),this.T=null,this.ba=!1,this.a=[])},A.Pa=function(){this.T=null,this.ba&&(this.ba=!1,oe(this))},q(se,F);var ue=[];function ae(t,e,n,i){Array.isArray(n)||(n&&(ue[0]=n.toString()),n=ue);for(var r=0;r<n.length;r++){var o=Vt(e,n[r],i||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function he(t){$(t.a,function(t,e){this.a.hasOwnProperty(e)&&Pt(t)},t),t.a={}}function ce(){}se.prototype.C=function(){se.M.C.call(this),he(this)},se.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var fe=null;function le(){return fe=fe||new Gt}function pe(t){Et.call(this,"serverreachability",t)}function de(){var t=le();t.dispatchEvent(new pe(t))}function ye(t){Et.call(this,"statevent",t)}function ve(){var t=le();t.dispatchEvent(new ye(t))}function ge(t){Et.call(this,"timingevent",t)}function me(t,e){if("function"!=k(t))throw Error("Fn must not be null and must be a function");return S.setTimeout(function(){t()},e)}q(pe,Et),q(ye,Et),q(ge,Et);var we={NO_ERROR:0,Va:1,bb:2,ab:3,Ya:4,$a:5,cb:6,za:7,TIMEOUT:8,gb:9},be={Xa:"complete",kb:"success",Aa:"error",za:"abort",ib:"ready",jb:"readystatechange",TIMEOUT:"timeout",eb:"incrementaldata",hb:"progress",Za:"downloadprogress",lb:"uploadprogress"};function Ee(){}function Ie(t){var e;return(e=t.a)||(e=t.a={}),e}function Te(){}Ee.prototype.a=null;var Ae,Ne={OPEN:"a",Wa:"b",Aa:"c",fb:"d"};function _e(){Et.call(this,"d")}function Se(){Et.call(this,"c")}function Re(){}function ke(t,e,n){this.g=t,this.W=e,this.U=n||1,this.G=new se(this),this.N=De,t=at?125:void 0,this.O=new ee(t),this.m=null,this.b=!1,this.j=this.A=this.f=this.B=this.s=this.P=this.h=null,this.i=[],this.a=null,this.w=0,this.c=this.v=null,this.H=-1,this.l=!1,this.J=0,this.D=null,this.o=this.R=this.F=!1}q(_e,Et),q(Se,Et),q(Re,Ee),Ae=new Re;var De=45e3,Oe={},Le={};function Ve(t,e,n){t.B=1,t.f=tn(Ye(e)),t.j=n,t.F=!0,Me(t,null)}function Me(t,e){t.s=j(),Ce(t),t.A=Ye(t.f);var n=t.A,i=t.U;Array.isArray(i)||(i=[String(i)]),dn(n.b,"t",i),t.w=0,t.a=oi(t.g,t.g.w?e:null),0<t.J&&(t.D=new re(C(t.ya,t,t.a),t.J)),ae(t.G,t.a,"readystatechange",t.Sa),e=t.m?Z(t.m):{},t.j?(t.v||(t.v="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.$(t.A,t.v,t.j,e)):(t.v="GET",t.a.$(t.A,t.v,null,e)),de()}function Pe(t,e,n){for(var i,r,o,s,u=!0;!t.l&&t.w<n.length;){var a=(r=n,s=o=void 0,o=(i=t).w,-1==(s=r.indexOf("\n",o))?Le:(o=Number(r.substring(o,s)),isNaN(o)?Oe:(s+=1)+o>r.length?Le:(r=r.substr(s,o),i.w=s+o,r)));if(a==Le){4==e&&(t.c=4,ve(),u=!1);break}if(a==Oe){t.c=4,ve(),u=!1;break}xe(t,a)}4==e&&0==n.length&&(t.c=1,ve(),u=!1),t.b=t.b&&u,u||(Fe(t),qe(t))}function Ce(t){t.P=j()+t.N,Ue(t,t.N)}function Ue(t,e){if(null!=t.h)throw Error("WatchDog timer not null");t.h=me(C(t.Qa,t),e)}function je(t){t.h&&(S.clearTimeout(t.h),t.h=null)}function qe(t){0==t.g.u||t.l||ti(t.g,t)}function Fe(t){je(t);var e=t.D;e&&"function"==typeof e.da&&e.da(),t.D=null,ne(t.O),he(t.G),t.a&&(e=t.a,t.a=null,e.abort(),e.da())}function xe(t,e){try{var n,i,r,o,s,u,a,h,c,f,l=t.g;if(0!=l.u&&(l.a==t||En(l.b,t)))if(l.A=t.H,!t.o&&En(l.b,t)&&3==l.u){try{var p=l.ja.a.parse(e)}catch(t){p=null}if(Array.isArray(p)&&3==p.length){var d=p;if(0==d[0]){t:if(!l.i){if(l.a){if(!(l.a.s+3e3<t.s))break t;Zn(l),l.a.cancel(),l.a=null}$n(l),ve()}}else l.ia=d[1],0<l.ia-l.G&&d[2]<37500&&l.U&&0==l.m&&!l.l&&(l.l=me(C(l.Na,l),6e3));if(bn(l.b)<=1&&l.O){try{l.O()}catch(t){}l.O=void 0}}else ni(l,11)}else if(!t.o&&l.a!=t||Zn(l),!H(e))for(e=p=l.ja.a.parse(e),p=0;p<e.length;p++){d=e[p],l.G=d[0],d=d[1],2==l.u?"c"==d[0]?(l.B=d[1],l.R=d[2],null!=(n=d[3])&&(l.oa=n),null!=(i=d[5])&&"number"==typeof i&&0<i&&(l.D=1.5*i),r=l,(o=t.a)&&(!(s=o.a?o.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(u=r.b).a&&(Y(s,"spdy")||Y(s,"quic")||Y(s,"h2"))&&(u.f=u.g,u.a=new Set,u.b&&(In(u,u.b),u.b=null)),!r.s||(a=o.a?o.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(r.ha=a,Ze(r.v,r.s,a))),l.u=3,l.c&&l.c.na(),h=t,(r=l).ea=ri(r,r.w?r.R:null,r.P),h.o?(Tn(r.b,h),c=h,(f=r.D)&&c.setTimeout(f),c.h&&(je(c),Ce(c)),r.a=h):Jn(r),0<l.f.length&&Qn(l)):"stop"!=d[0]&&"close"!=d[0]||ni(l,7):3==l.u&&("stop"==d[0]||"close"==d[0]?"stop"==d[0]?ni(l,7):zn(l):"noop"!=d[0]&&l.c&&l.c.ma(d),l.m=0)}de()}catch(t){}}function Ge(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(D(t)||"string"==typeof t)G(t,e,void 0);else{if(t.K&&"function"==typeof t.K)var n=t.K();else if(t.I&&"function"==typeof t.I)n=void 0;else if(D(t)||"string"==typeof t){n=[];for(var i=t.length,r=0;r<i;r++)n.push(r)}else for(r in n=[],i=0,t)n[i++]=r;r=(i=function(t){if(t.I&&"function"==typeof t.I)return t.I();if("string"==typeof t)return t.split("");if(D(t)){for(var e=[],n=t.length,i=0;i<n;i++)e.push(t[i]);return e}for(i in e=[],n=0,t)e[n++]=t[i];return e}(t)).length;for(var o=0;o<r;o++)e.call(void 0,i[o],n&&n[o],t)}}function Be(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var i=0;i<n;i+=2)this.set(arguments[i],arguments[i+1])}else if(t)if(t instanceof Be)for(n=t.K(),i=0;i<n.length;i++)this.set(n[i],t.get(n[i]));else for(i in t)this.set(i,t[i])}function ze(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var i=t.a[e];He(t.b,i)&&(t.a[n++]=i),e++}t.a.length=n}if(t.c!=t.a.length){for(var r={},n=e=0;e<t.a.length;)He(r,i=t.a[e])||(r[t.a[n++]=i]=1),e++;t.a.length=n}}function He(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(A=ke.prototype).setTimeout=function(t){this.N=t},A.Sa=function(t){t=t.target;var e=this.D;e&&3==Fn(t)?e.Ia():this.ya(t)},A.ya=function(t){try{if(t==this.a)t:{var e=Fn(this.a),n=this.a.qa();this.a.S();if(!(e<3||3==e&&!at&&!this.a.Y())){this.l||4!=e||7==n||de(),je(this);var i=this.a.S();this.H=i;var r=this.a.Y();if(this.b=200==i){if(this.R&&!this.o){e:{if(this.a){var o,s=this.a;if((o=s.a?s.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!H(o)){var u=o;break e}}u=null}if(!u){this.b=!1,this.c=3,ve(),Fe(this),qe(this);break t}this.o=!0,xe(this,u)}this.F?(Pe(this,e,r),at&&this.b&&3==e&&(ae(this.G,this.O,"tick",this.Ra),this.O.start())):xe(this,r),4==e&&Fe(this),this.b&&!this.l&&(4==e?ti(this.g,this):(this.b=!1,Ce(this)))}else 400==i&&0<r.indexOf("Unknown SID")?this.c=3:this.c=0,ve(),Fe(this),qe(this)}}}catch(t){}},A.Ra=function(){var t,e;this.a&&(t=Fn(this.a),e=this.a.Y(),this.w<e.length&&(je(this),Pe(this,t,e),this.b&&4!=t&&Ce(this)))},A.cancel=function(){this.l=!0,Fe(this)},A.Qa=function(){this.h=null;var t=j();0<=t-this.P?(2!=this.B&&(de(),ve()),Fe(this),this.c=2,qe(this)):Ue(this,this.P-t)},(A=Be.prototype).I=function(){ze(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},A.K=function(){return ze(this),this.a.concat()},A.get=function(t,e){return He(this.b,t)?this.b[t]:e},A.set=function(t,e){He(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},A.forEach=function(t,e){for(var n=this.K(),i=0;i<n.length;i++){var r=n[i],o=this.get(r);t.call(e,o,r,this)}};var We=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Qe(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Qe?(this.a=void 0!==e?e:t.a,Xe(this,t.f),this.j=t.j,Ke(this,t.c),Je(this,t.h),this.g=t.g,e=t.b,(n=new cn).c=e.c,e.a&&(n.a=new Be(e.a),n.b=e.b),$e(this,n),this.i=t.i):t&&(n=String(t).match(We))?(this.a=!!e,Xe(this,n[1]||"",!0),this.j=en(n[2]||""),Ke(this,n[3]||"",!0),Je(this,n[4]),this.g=en(n[5]||"",!0),$e(this,n[6]||"",!0),this.i=en(n[7]||"")):(this.a=!!e,this.b=new cn(null,this.a))}function Ye(t){return new Qe(t)}function Xe(t,e,n){t.f=n?en(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function Ke(t,e,n){t.c=n?en(e,!0):e}function Je(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function $e(t,e,n){var i,r;e instanceof cn?(t.b=e,i=t.b,(r=t.a)&&!i.f&&(fn(i),i.c=null,i.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(ln(this,e),dn(this,n,t))},i)),i.f=r):(n||(e=nn(e,an)),t.b=new cn(e,t.a))}function Ze(t,e,n){t.b.set(e,n)}function tn(t){return Ze(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^j()).toString(36)),t}function en(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function nn(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,rn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function rn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Qe.prototype.toString=function(){var t=[],e=this.f;e&&t.push(nn(e,on,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(nn(e,on,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(nn(n,"/"==n.charAt(0)?un:sn,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",nn(n,hn)),t.join("")};var on=/[#\/\?@]/g,sn=/[#\?:]/g,un=/[#\?]/g,an=/[#\?@]/g,hn=/#/g;function cn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function fn(u){u.a||(u.a=new Be,u.b=0,u.c&&function(t){if(t){t=t.split("&");for(var e=0;e<t.length;e++){var n,i=t[e].indexOf("="),r=null;0<=i?(n=t[e].substring(0,i),r=t[e].substring(i+1)):n=t[e],o=n,s=r?decodeURIComponent(r.replace(/\+/g," ")):"",u.add(decodeURIComponent(o.replace(/\+/g," ")),s)}}var o,s}(u.c))}function ln(t,e){fn(t),e=yn(t,e),He(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,He((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&ze(t)))}function pn(t,e){return fn(t),e=yn(t,e),He(t.a.b,e)}function dn(t,e,n){ln(t,e),0<n.length&&(t.c=null,t.a.set(yn(t,e),z(n)),t.b+=n.length)}function yn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function vn(t,e){this.b=t,this.a=e}function gn(t){this.g=t||mn,t=S.PerformanceNavigationTiming?0<(t=S.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(S.ca&&S.ca.ua&&S.ca.ua()&&S.ca.ua().mb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}(A=cn.prototype).add=function(t,e){fn(this),this.c=null,t=yn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},A.forEach=function(n,i){fn(this),this.a.forEach(function(t,e){G(t,function(t){n.call(i,t,e,this)},this)},this)},A.K=function(){fn(this);for(var t=this.a.I(),e=this.a.K(),n=[],i=0;i<e.length;i++)for(var r=t[i],o=0;o<r.length;o++)n.push(e[i]);return n},A.I=function(t){fn(this);var e=[];if("string"==typeof t)pn(this,t)&&(e=B(e,this.a.get(yn(this,t))));else{t=this.a.I();for(var n=0;n<t.length;n++)e=B(e,t[n])}return e},A.set=function(t,e){return fn(this),this.c=null,pn(this,t=yn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},A.get=function(t,e){return t&&0<(t=this.I(t)).length?String(t[0]):e},A.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.K(),n=0;n<e.length;n++)for(var i=e[n],r=encodeURIComponent(String(i)),i=this.I(i),o=0;o<i.length;o++){var s=r;""!==i[o]&&(s+="="+encodeURIComponent(String(i[o]))),t.push(s)}return this.c=t.join("&")};var mn=10;function wn(t){return t.b||t.a&&t.a.size>=t.f}function bn(t){return t.b?1:t.a?t.a.size:0}function En(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function In(t,e){t.a?t.a.add(e):t.b=e}function Tn(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function An(t){var e,n;if(null!=t.b)return t.c.concat(t.b.i);if(null==t.a||0===t.a.size)return z(t.c);var i=t.c;try{for(var r=T(t.a.values()),o=r.next();!o.done;o=r.next())var s=o.value,i=i.concat(s.i)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}return i}function Nn(){}function _n(){this.a=new Nn}function Sn(t,i,e){var r=e||"";try{Ge(t,function(t,e){var n=t;O(t)&&(n=zt(t)),i.push(r+e+"="+encodeURIComponent(n))})}catch(t){throw i.push(r+"type="+encodeURIComponent("_badmap")),t}}function Rn(t,e,n,i,r){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,r(i)}catch(t){}}gn.prototype.cancel=function(){var t,e;if(this.c=An(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=T(this.a.values()),i=n.next();!i.done;i=n.next())i.value.cancel()}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},Nn.prototype.stringify=function(t){return S.JSON.stringify(t,void 0)},Nn.prototype.parse=function(t){return S.JSON.parse(t,void 0)};var kn=S.JSON.parse;function Dn(t){Gt.call(this),this.headers=new Be,this.G=t||null,this.b=!1,this.s=this.a=null,this.D="",this.h=0,this.f="",this.g=this.w=this.l=this.v=!1,this.o=0,this.m=null,this.H=On,this.B=this.F=!1}q(Dn,Gt);var On="",Ln=/^https?$/i,Vn=["POST","PUT"];function Mn(t){return"content-type"==t.toLowerCase()}function Pn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Cn(t),jn(t)}function Cn(t){t.v||(t.v=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function Un(t){if(t.b&&void 0!==_&&(!t.s[1]||4!=Fn(t)||2!=t.S()))if(t.l&&4==Fn(t))ie(t.va,0,t);else if(t.dispatchEvent("readystatechange"),4==Fn(t)){t.b=!1;try{var e,n,i,r,o=t.S();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}if((e=s)||((n=0===o)&&(!(r=String(t.D).match(We)[1]||null)&&S.self&&S.self.location&&(r=(i=S.self.location.protocol).substr(0,i.length-1)),n=!Ln.test(r?r.toLowerCase():"")),e=n),e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{t.h=6;try{var u=2<Fn(t)?t.a.statusText:""}catch(t){u=""}t.f=u+" ["+t.S()+"]",Cn(t)}}finally{jn(t)}}}function jn(t,e){if(t.a){qn(t);var n=t.a,i=t.s[0]?R:null;t.a=null,t.s=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=i}catch(t){}}}function qn(t){t.a&&t.B&&(t.a.ontimeout=null),t.m&&(S.clearTimeout(t.m),t.m=null)}function Fn(t){return t.a?t.a.readyState:0}function xn(t,e,n){t:{for(i in n){var i=!1;break t}i=!0}var r;i||(r="",$(n,function(t,e){r+=e,r+=":",r+=t,r+="\r\n"}),n=r,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):Ze(t,e,n))}function Gn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Bn(t){this.f=[],this.R=this.ea=this.v=this.P=this.a=this.ha=this.s=this.N=this.h=this.F=this.j=null,this.Fa=this.H=0,this.Ca=Gn("failFast",!1,t),this.U=this.l=this.i=this.g=this.c=null,this.W=!0,this.A=this.ia=this.G=-1,this.J=this.m=this.o=0,this.Ba=Gn("baseRetryDelayMs",5e3,t),this.Ga=Gn("retryDelaySeedMs",1e4,t),this.Da=Gn("forwardChannelMaxRetries",2,t),this.ga=Gn("forwardChannelRequestTimeoutMs",2e4,t),this.Ea=t&&t.nb||void 0,this.D=void 0,this.w=t&&t.supportsCrossDomainXhr||!1,this.B="",this.b=new gn(t&&t.concurrentRequestLimit),this.ja=new _n,this.fa=t&&t.fastHandshake||!1,t&&t.forceLongPolling&&(this.W=!1),this.O=void 0}function zn(t){var e,n;Hn(t),3==t.u&&(e=t.H++,Ze(n=Ye(t.v),"SID",t.B),Ze(n,"RID",e),Ze(n,"TYPE","terminate"),Xn(t,n),(e=new ke(t,e,void 0)).B=2,e.f=tn(Ye(n)),n=!1,S.navigator&&S.navigator.sendBeacon&&(n=S.navigator.sendBeacon(e.f.toString(),"")),!n&&S.Image&&((new Image).src=e.f,n=!0),n||(e.a=oi(e.g,null),e.a.$(e.f)),e.s=j(),Ce(e)),ii(t)}function Hn(t){t.a&&(t.a.cancel(),t.a=null),t.i&&(S.clearTimeout(t.i),t.i=null),Zn(t),t.b.cancel(),t.g&&("number"==typeof t.g&&S.clearTimeout(t.g),t.g=null)}function Wn(t,e){t.f.push(new vn(t.Fa++,e)),3==t.u&&Qn(t)}function Qn(t){wn(t.b)||t.g||(t.g=!0,Jt(t.xa,t),t.o=0)}function Yn(t,e){var n=e?e.W:t.H++,i=Ye(t.v);Ze(i,"SID",t.B),Ze(i,"RID",n),Ze(i,"AID",t.G),Xn(t,i),t.h&&t.j&&xn(i,t.h,t.j),n=new ke(t,n,t.o+1),null===t.h&&(n.m=t.j),e&&(t.f=e.i.concat(t.f)),e=Kn(t,n,1e3),n.setTimeout(Math.round(.5*t.ga)+Math.round(.5*t.ga*Math.random())),In(t.b,n),Ve(n,i,e)}function Xn(t,n){t.c&&Ge({},function(t,e){Ze(n,e,t)})}function Kn(t,e,n){n=Math.min(t.f.length,n);var i=t.c?C(t.c.Ha,t.c,t):null;t:for(var r=t.f,o=-1;;){var s=["count="+n];-1==o?0<n?(o=r[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var h=r[a].b,c=r[a].a;if((h-=o)<0)o=Math.max(0,r[a].b-100),u=!1;else try{Sn(c,s,"req"+h+"_")}catch(t){i&&i(c)}}if(u){i=s.join("&");break t}}return t=t.f.splice(0,n),e.i=t,i}function Jn(t){t.a||t.i||(t.J=1,Jt(t.wa,t),t.m=0)}function $n(t){return!(t.a||t.i||3<=t.m)&&(t.J++,t.i=me(C(t.wa,t),ei(t,t.m)),t.m++,1)}function Zn(t){null!=t.l&&(S.clearTimeout(t.l),t.l=null)}function ti(t,e){var n,i=null;if(t.a==e){Zn(t),t.a=null;var r=2}else{if(!En(t.b,e))return;i=e.i,Tn(t.b,e),r=1}if(t.A=e.H,0!=t.u)if(e.b){1==r?(i=e.j?e.j.length:0,e=j()-e.s,n=t.o,(r=le()).dispatchEvent(new ge(r)),Qn(t)):Jn(t)}else if(3==(n=e.c)||0==n&&0<t.A||!(1==r&&function(t,e){if(!(bn(t.b)>=t.b.f-(t.g?1:0))){if(t.g)return t.f=e.i.concat(t.f),1;if(!(1==t.u||2==t.u||t.o>=(t.Ca?0:t.Da)))return t.g=me(C(t.xa,t,e),ei(t,t.o)),t.o++,1}}(t,e)||2==r&&$n(t)))switch(i&&0<i.length&&(e=t.b,e.c=e.c.concat(i)),n){case 1:ni(t,5);break;case 4:ni(t,10);break;case 3:ni(t,6);break;default:ni(t,2)}}function ei(t,e){var n=t.Ba+Math.floor(Math.random()*t.Ga);return t.c||(n*=2),n*e}function ni(t,e){var n,i,r,o,s,u;2==e?(n=null,t.c&&(n=null),i=C(t.Ta,t),n||(n=new Qe("//www.google.com/images/cleardot.gif"),S.location&&"http"==S.location.protocol||Xe(n,"https"),tn(n)),r=n.toString(),o=i,u=new ce,S.Image?((s=new Image).onload=U(Rn,u,s,"TestLoadImage: loaded",!0,o),s.onerror=U(Rn,u,s,"TestLoadImage: error",!1,o),s.onabort=U(Rn,u,s,"TestLoadImage: abort",!1,o),s.ontimeout=U(Rn,u,s,"TestLoadImage: timeout",!1,o),S.setTimeout(function(){s.ontimeout&&s.ontimeout()},1e4),s.src=r):o(!1)):ve(),t.u=0,t.c&&t.c.la(e),ii(t),Hn(t)}function ii(t){t.u=0,t.A=-1,t.c&&(0==An(t.b).length&&0==t.f.length||(t.b.c.length=0,z(t.f),t.f.length=0),t.c.ka())}function ri(t,e,n){var i,r,o,s,u,a,h,c=(i=n)instanceof Qe?Ye(i):new Qe(i,void 0);return""!=c.c?(e&&Ke(c,e+"."+c.c),Je(c,c.h)):(o=(r=S.location).protocol,s=e?e+"."+r.hostname:r.hostname,u=+r.port,a=n,h=new Qe(null,void 0),o&&Xe(h,o),s&&Ke(h,s),u&&Je(h,u),a&&(h.g=a),c=h),t.N&&$(t.N,function(t,e){Ze(c,e,t)}),e=t.s,n=t.ha,e&&n&&Ze(c,e,n),Ze(c,"VER",t.oa),Xn(t,c),c}function oi(t,e){if(e&&!t.w)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Dn(t.Ea)).F=t.w,e}function si(){}function ui(){if(st&&!(10<=Number(gt)))throw Error("Environmental error: no available transport.")}function ai(t,e){Gt.call(this),this.a=new Bn(e),this.l=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.j=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.pa&&(t?t["X-WebChannel-Client-Profile"]=e.pa:t={"X-WebChannel-Client-Profile":e.pa}),this.a.F=t,(t=e&&e.httpHeadersOverwriteParam)&&!H(t)&&(this.a.h=t),this.h=e&&e.supportsCrossDomainXhr||!1,this.g=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!H(e)&&(this.a.s=e,null!==(t=this.b)&&e in t&&e in(t=this.b)&&delete t[e]),this.f=new fi(this)}function hi(t){_e.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function ci(){Se.call(this),this.status=1}function fi(t){this.a=t}(A=Dn.prototype).$=function(t,e,n,i){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+t);e=e?e.toUpperCase():"GET",this.D=t,this.f="",this.h=0,this.v=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.G?Ie(this.G):Ie(Ae),this.a.onreadystatechange=C(this.va,this);try{this.w=!0,this.a.open(e,String(t),!0),this.w=!1}catch(t){return void Pn(this,t)}t=n||"";var r,o=new Be(this.headers);i&&Ge(i,function(t,e){o.set(e,t)}),i=function(t){t:{for(var e=Mn,n=t.length,i="string"==typeof t?t.split(""):t,r=0;r<n;r++)if(r in i&&e.call(void 0,i[r],r,t)){e=r;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.K()),n=S.FormData&&t instanceof S.FormData,0<=x(Vn,e)&&!i&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.H&&(this.a.responseType=this.H),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{qn(this),0<this.o&&((this.B=(r=this.a,st&&vt(9)&&"number"==typeof r.timeout&&void 0!==r.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=C(this.ta,this)):this.m=ie(this.ta,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){Pn(this,t)}},A.ta=function(){void 0!==_&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},A.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),jn(this))},A.C=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),jn(this,!0)),Dn.M.C.call(this)},A.va=function(){this.j||(this.w||this.l||this.g?Un(this):this.Oa())},A.Oa=function(){Un(this)},A.S=function(){try{return 2<Fn(this)?this.a.status:-1}catch(t){return-1}},A.Y=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},A.Ja=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),kn(e)}},A.qa=function(){return this.h},A.Ma=function(){return"string"==typeof this.f?this.f:String(this.f)},(A=Bn.prototype).oa=8,A.u=1,A.xa=function(t){if(this.g)if(this.g=null,1==this.u){if(!t){this.H=Math.floor(1e5*Math.random()),t=this.H++;var e,n=new ke(this,t,void 0),i=this.j;if(this.F&&(i?et(i=Z(i),this.F):i=this.F),null===this.h&&(n.m=i),this.fa)t:{for(var r=e=0;r<this.f.length;r++){var o=this.f[r];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=r;break t}if(4096===e||r===this.f.length-1){e=r+1;break t}}e=1e3}else e=1e3;e=Kn(this,n,e),Ze(r=Ye(this.v),"RID",t),Ze(r,"CVER",22),this.s&&Ze(r,"X-HTTP-Session-Id",this.s),Xn(this,r),this.h&&i&&xn(r,this.h,i),In(this.b,n),this.fa?(Ze(r,"$req",e),Ze(r,"SID","null"),n.R=!0,Ve(n,r,null)):Ve(n,r,e),this.u=2}}else 3==this.u&&(t?Yn(this,t):0==this.f.length||wn(this.b)||Yn(this))},A.wa=function(){this.i=null,this.a=new ke(this,"rpc",this.J),null===this.h&&(this.a.m=this.j),this.a.J=0;var t=Ye(this.ea);Ze(t,"RID","rpc"),Ze(t,"SID",this.B),Ze(t,"CI",this.U?"0":"1"),Ze(t,"AID",this.G),Xn(this,t),Ze(t,"TYPE","xmlhttp"),this.h&&this.j&&xn(t,this.h,this.j),this.D&&this.a.setTimeout(this.D);var e=this.a,n=this.R;e.B=1,e.f=tn(Ye(t)),e.j=null,e.F=!0,Me(e,n)},A.Na=function(){null!=this.l&&(this.l=null,this.a.cancel(),this.a=null,$n(this),ve())},A.Ta=function(t){ve()},(A=si.prototype).na=function(){},A.ma=function(){},A.la=function(){},A.ka=function(){},A.Ha=function(){},ui.prototype.a=function(t,e){return new ai(t,e)},q(ai,Gt),(A=ai.prototype).addEventListener=function(t,e,n,i){ai.M.addEventListener.call(this,t,e,n,i)},A.removeEventListener=function(t,e,n,i){ai.M.removeEventListener.call(this,t,e,n,i)},A.Ka=function(){this.a.c=this.f,this.h&&(this.a.w=!0);var t=this.a,e=this.l,n=this.b||void 0;ve(),t.P=e,t.N=n||{},t.U=t.W,t.v=ri(t,null,t.P),Qn(t)},A.close=function(){zn(this.a)},A.La=function(t){var e;"string"==typeof t?((e={}).__data__=t,Wn(this.a,e)):this.g?((e={}).__data__=zt(t),Wn(this.a,e)):Wn(this.a,t)},A.C=function(){this.a.c=null,delete this.f,zn(this.a),delete this.a,ai.M.C.call(this)},q(hi,_e),q(ci,Se),q(fi,si),fi.prototype.na=function(){this.a.dispatchEvent("a")},fi.prototype.ma=function(t){this.a.dispatchEvent(new hi(t))},fi.prototype.la=function(t){this.a.dispatchEvent(new ci)},fi.prototype.ka=function(){this.a.dispatchEvent("b")},ui.prototype.createWebChannel=ui.prototype.a,ai.prototype.send=ai.prototype.La,ai.prototype.open=ai.prototype.Ka,ai.prototype.close=ai.prototype.close,we.NO_ERROR=0,we.TIMEOUT=8,we.HTTP_ERROR=6,be.COMPLETE="complete",(Te.EventType=Ne).OPEN="a",Ne.CLOSE="b",Ne.ERROR="c",Ne.MESSAGE="d",Gt.prototype.listen=Gt.prototype.ra,Dn.prototype.listenOnce=Dn.prototype.sa,Dn.prototype.getLastError=Dn.prototype.Ma,Dn.prototype.getLastErrorCode=Dn.prototype.qa,Dn.prototype.getStatus=Dn.prototype.S,Dn.prototype.getResponseJson=Dn.prototype.Ja,Dn.prototype.getResponseText=Dn.prototype.Y,Dn.prototype.send=Dn.prototype.$;var li={createWebChannelTransport:function(){return new ui},ErrorCode:we,EventType:be,WebChannel:Te,XhrIo:Dn},pi=li.createWebChannelTransport,di=li.ErrorCode,yi=li.EventType,vi=li.WebChannel,gi=li.XhrIo,mi=$c.SDK_VERSION,wi=(bi.prototype.t=function(){return null!=this.uid},bi.prototype.s=function(){return this.t()?"uid:"+this.uid:"anonymous-user"},bi.prototype.isEqual=function(t){return t.uid===this.uid},bi);function bi(t){this.uid=t}function Ei(t,e){this.user=e,this.type="OAuth",this.o={},this.o.Authorization="Bearer "+t}wi.UNAUTHENTICATED=new wi(null),wi.i=new wi("google-credentials-uid"),wi.h=new wi("first-party-uid");var Ii,Ti,Ai={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Ni=(n(Gi,Ti=Error),Gi),_i=(xi.prototype.getToken=function(){return Promise.resolve(null)},xi.prototype.l=function(){},xi.prototype._=function(t){(this.u=t)(wi.UNAUTHENTICATED)},xi.prototype.T=function(){this.u=null},xi),Si=(Fi.prototype.getToken=function(){var e=this,n=this.R,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){if(e.R!==n)throw new Ni(Ai.ABORTED,"getToken aborted due to token change.");return t?(zs("string"==typeof t.accessToken),new Ei(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},Fi.prototype.l=function(){this.forceRefresh=!0},Fi.prototype._=function(t){this.u=t,this.I&&t(this.currentUser)},Fi.prototype.T=function(){this.auth&&this.auth.removeAuthTokenListener(this.m),this.m=null,this.u=null},Fi.prototype.A=function(){var t=this.auth&&this.auth.getUid();return zs(null===t||"string"==typeof t),new wi(t)},Fi),Ri=(Object.defineProperty(qi.prototype,"o",{get:function(){var t={"X-Goog-AuthUser":this.V},e=this.P.auth.p([]);return e&&(t.Authorization=e),t},enumerable:!0,configurable:!0}),qi),ki=(ji.prototype.getToken=function(){return Promise.resolve(new Ri(this.P,this.V))},ji.prototype._=function(t){t(wi.h)},ji.prototype.T=function(){},ji.prototype.l=function(){},ji),Di=(Ui.now=function(){return Ui.fromMillis(Date.now())},Ui.fromDate=function(t){return Ui.fromMillis(t.getTime())},Ui.fromMillis=function(t){var e=Math.floor(t/1e3);return new Ui(e,1e6*(t-1e3*e))},Ui.prototype.toDate=function(){return new Date(this.toMillis())},Ui.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},Ui.prototype.g=function(t){return this.seconds===t.seconds?Qs(this.nanoseconds,t.nanoseconds):Qs(this.seconds,t.seconds)},Ui.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},Ui.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},Ui.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},Ui),Oi=(Ci.v=function(t){return new Ci(t)},Ci.min=function(){return new Ci(new Di(0,0))},Ci.prototype.S=function(t){return this.timestamp.g(t.timestamp)},Ci.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},Ci.prototype.C=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},Ci.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},Ci.prototype.D=function(){return this.timestamp},Ci),Li=(Object.defineProperty(Pi.prototype,"length",{get:function(){return this.F},enumerable:!0,configurable:!0}),Pi.prototype.isEqual=function(t){return 0===Pi.N(this,t)},Pi.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof Pi?t.forEach(function(t){e.push(t)}):e.push(t),this.$(e)},Pi.prototype.limit=function(){return this.offset+this.length},Pi.prototype.L=function(t){return t=void 0===t?1:t,this.$(this.segments,this.offset+t,this.length-t)},Pi.prototype.k=function(){return this.$(this.segments,this.offset,this.length-1)},Pi.prototype.O=function(){return this.segments[this.offset]},Pi.prototype.M=function(){return this.get(this.length-1)},Pi.prototype.get=function(t){return this.segments[this.offset+t]},Pi.prototype.q=function(){return 0===this.length},Pi.prototype.B=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},Pi.prototype.U=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},Pi.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},Pi.prototype.W=function(){return this.segments.slice(this.offset,this.limit())},Pi.N=function(t,e){for(var n=Math.min(t.length,e.length),i=0;i<n;i++){var r=t.get(i),o=e.get(i);if(r<o)return-1;if(o<r)return 1}return t.length<e.length?-1:t.length>e.length?1:0},Pi),Vi=(n(Mi,Ii=Li),Mi.prototype.$=function(t,e,n){return new Mi(t,e,n)},Mi.prototype.j=function(){return this.W().join("/")},Mi.prototype.toString=function(){return this.j()},Mi.G=function(t){if(0<=t.indexOf("//"))throw new Ni(Ai.INVALID_ARGUMENT,"Invalid path ("+t+"). Paths must not contain // in them.");return new Mi(t.split("/").filter(function(t){return 0<t.length}))},Mi);function Mi(){return null!==Ii&&Ii.apply(this,arguments)||this}function Pi(t,e,n){void 0===e?e=0:e>t.length&&Bs(),void 0===n?n=t.length-e:n>t.length-e&&Bs(),this.segments=t,this.offset=e,this.F=n}function Ci(t){this.timestamp=t}function Ui(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new Ni(Ai.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new Ni(Ai.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Ni(Ai.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new Ni(Ai.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function ji(t,e){this.P=t,this.V=e}function qi(t,e){this.P=t,this.V=e,this.type="FirstParty",this.user=wi.h}function Fi(t){var e=this;this.m=null,this.currentUser=wi.UNAUTHENTICATED,this.I=!1,this.R=0,this.u=null,this.forceRefresh=!1,this.m=function(){e.R++,e.currentUser=e.A(),e.I=!0,e.u&&e.u(e.currentUser)},this.R=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.m):(this.m(null),t.get().then(function(t){e.auth=t,e.m&&e.auth.addAuthTokenListener(e.m)},function(){}))}function xi(){this.u=null}function Gi(t,e){var n=this;return(n=Ti.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}Vi.H=new Vi([]);var Bi,zi=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Hi=(n(Wi,Bi=Li),Wi.prototype.$=function(t,e,n){return new Wi(t,e,n)},Wi.K=function(t){return zi.test(t)},Wi.prototype.j=function(){return this.W().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),Wi.K(t)||(t="`"+t+"`"),t}).join(".")},Wi.prototype.toString=function(){return this.j()},Wi.prototype.Y=function(){return 1===this.length&&"__name__"===this.get(0)},Wi.X=function(){return new Wi(["__name__"])},Wi.J=function(t){for(var e=[],n="",i=0,r=function(){if(0===n.length)throw new Ni(Ai.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;i<t.length;){var s=t[i];if("\\"===s){if(i+1===t.length)throw new Ni(Ai.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[i+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Ni(Ai.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,i+=2}else"`"===s?o=!o:"."!==s||o?n+=s:r(),i++}if(r(),o)throw new Ni(Ai.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new Wi(e)},Wi);function Wi(){return null!==Bi&&Bi.apply(this,arguments)||this}Hi.H=new Hi([]);var Qi=(Yi.Z=function(t){return new Yi(Vi.G(t).L(5))},Yi.prototype.tt=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},Yi.prototype.isEqual=function(t){return null!==t&&0===Vi.N(this.path,t.path)},Yi.prototype.toString=function(){return this.path.toString()},Yi.N=function(t,e){return Vi.N(t.path,e.path)},Yi.et=function(t){return t.length%2==0},Yi.st=function(t){return new Yi(new Vi(t.slice()))},Yi);function Yi(t){this.path=t}function Xi(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Ki(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Ji(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}Qi.EMPTY=new Qi(new Vi([]));var $i=(Zi.fromBase64String=function(t){return new Zi(Ps.nt().atob(t))},Zi.fromUint8Array=function(t){return new Zi(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},Zi.prototype.toBase64=function(){return Ps.nt().btoa(this.it)},Zi.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.it)},Zi.prototype.rt=function(){return 2*this.it.length},Zi.prototype.S=function(t){return Qs(this.it,t.it)},Zi.prototype.isEqual=function(t){return this.it===t.it},Zi);function Zi(t){this.it=t}function tr(t){return null==t}function er(t){return-0===t&&1/t==-1/0}function nr(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function ir(t){var e=fr(t.mapValue.fields.__local_write_time__.timestampValue);return new Di(e.seconds,e.nanos)}$i.ht=new $i("");var rr=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function or(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?nr(t)?4:10:Bs()}function sr(i,r){var t,e,n,o=or(i);if(o!==or(r))return!1;switch(o){case 0:return!0;case 1:return i.booleanValue===r.booleanValue;case 4:return ir(i).isEqual(ir(r));case 3:return function(t){if("string"==typeof i.timestampValue&&"string"==typeof t.timestampValue&&i.timestampValue.length===t.timestampValue.length)return i.timestampValue===t.timestampValue;var e=fr(i.timestampValue),n=fr(t.timestampValue);return e.seconds===n.seconds&&e.nanos===n.nanos}(r);case 5:return i.stringValue===r.stringValue;case 6:return n=r,pr(i.bytesValue).isEqual(pr(n.bytesValue));case 7:return i.referenceValue===r.referenceValue;case 8:return e=r,lr((t=i).geoPointValue.latitude)===lr(e.geoPointValue.latitude)&&lr(t.geoPointValue.longitude)===lr(e.geoPointValue.longitude);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return lr(t.integerValue)===lr(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=lr(t.doubleValue),i=lr(e.doubleValue);return n===i?er(n)===er(i):isNaN(n)&&isNaN(i)}return!1}(i,r);case 9:return Ys(i.arrayValue.values||[],r.arrayValue.values||[],sr);case 10:return function(){var t=i.mapValue.fields||{},e=r.mapValue.fields||{};if(Xi(t)!==Xi(e))return!1;for(var n in t)if(t.hasOwnProperty(n)&&(void 0===e[n]||!sr(t[n],e[n])))return!1;return!0}();default:return Bs()}}function ur(t,e){return void 0!==(t.values||[]).find(function(t){return sr(t,e)})}function ar(t,e){var n,i,r,o,s,u,a,h,c,f,l=or(t),p=or(e);if(l!==p)return Qs(l,p);switch(l){case 0:return 0;case 1:return Qs(t.booleanValue,e.booleanValue);case 2:return h=e,(c=lr(t.integerValue||t.doubleValue))<(f=lr(h.integerValue||h.doubleValue))?-1:f<c?1:c===f?0:isNaN(c)?isNaN(f)?0:-1:1;case 3:return hr(t.timestampValue,e.timestampValue);case 4:return hr(ir(t),ir(e));case 5:return Qs(t.stringValue,e.stringValue);case 6:return o=t.bytesValue,s=e.bytesValue,u=pr(o),a=pr(s),u.S(a);case 7:return function(t,e){for(var n=t.split("/"),i=e.split("/"),r=0;r<n.length&&r<i.length;r++){var o=Qs(n[r],i[r]);if(0!==o)return o}return Qs(n.length,i.length)}(t.referenceValue,e.referenceValue);case 8:return n=t.geoPointValue,i=e.geoPointValue,0!==(r=Qs(lr(n.latitude),lr(i.latitude)))?r:Qs(lr(n.longitude),lr(i.longitude));case 9:return function(t,e){for(var n=t.values||[],i=e.values||[],r=0;r<n.length&&r<i.length;++r){var o=ar(n[r],i[r]);if(o)return o}return Qs(n.length,i.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},i=Object.keys(n),r=e.fields||{},o=Object.keys(r);i.sort(),o.sort();for(var s=0;s<i.length&&s<o.length;++s){var u=Qs(i[s],o[s]);if(0!==u)return u;var a=ar(n[i[s]],r[o[s]]);if(0!==a)return a}return Qs(i.length,o.length)}(t.mapValue,e.mapValue);default:throw Bs()}}function hr(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Qs(t,e);var n=fr(t),i=fr(e),r=Qs(n.seconds,i.seconds);return 0!==r?r:Qs(n.nanos,i.nanos)}function cr(t){return function s(r){return"nullValue"in r?"null":"booleanValue"in r?""+r.booleanValue:"integerValue"in r?""+r.integerValue:"doubleValue"in r?""+r.doubleValue:"timestampValue"in r?"time("+(t=fr(r.timestampValue)).seconds+","+t.nanos+")":"stringValue"in r?r.stringValue:"bytesValue"in r?pr(r.bytesValue).toBase64():"referenceValue"in r?(n=r.referenceValue,Qi.Z(n).toString()):"geoPointValue"in r?"geo("+(e=r.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in r?function(){for(var t="[",e=!0,n=0,i=r.arrayValue.values||[];n<i.length;n++)e?e=!1:t+=",",t+=s(i[n]);return t+"]"}():"mapValue"in r?function(t){for(var e="{",n=!0,i=0,r=Object.keys(t.fields||{}).sort();i<r.length;i++){var o=r[i];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(r.mapValue):Bs();var t,e,n}(t)}function fr(t){if(zs(!!t),"string"!=typeof t)return{seconds:lr(t.seconds),nanos:lr(t.nanos)};var e,n=0,i=rr.exec(t);zs(!!i),i[1]&&(e=((e=i[1])+"000000000").substr(0,9),n=Number(e));var r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:n}}function lr(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function pr(t){return"string"==typeof t?$i.fromBase64String(t):$i.fromUint8Array(t)}function dr(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.j()}}function yr(t){return t&&"integerValue"in t}function vr(t){return!!t&&"arrayValue"in t}function gr(t){return t&&"nullValue"in t}function mr(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function wr(t){return t&&"mapValue"in t}var br=(Er.prototype.ot=function(t,e){return n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}},t&&(n.fields.__previous_value__=t),{mapValue:n};var n},Er.prototype.at=function(t,e){return e},Er.prototype.ut=function(t){return null},Er.prototype.isEqual=function(t){return t instanceof Er},Er);function Er(){}br.instance=new br;var Ir=(Sr.prototype.ot=function(t,e){return this.apply(t)},Sr.prototype.at=function(t,e){return this.apply(t)},Sr.prototype.apply=function(t){for(var n=Rr(t),e=function(e){n.some(function(t){return sr(t,e)})||n.push(e)},i=0,r=this.elements;i<r.length;i++)e(r[i]);return{arrayValue:{values:n}}},Sr.prototype.ut=function(t){return null},Sr.prototype.isEqual=function(t){return t instanceof Sr&&Ys(this.elements,t.elements,sr)},Sr),Tr=(_r.prototype.ot=function(t,e){return this.apply(t)},_r.prototype.at=function(t,e){return this.apply(t)},_r.prototype.apply=function(t){for(var n=Rr(t),e=function(e){n=n.filter(function(t){return!sr(t,e)})},i=0,r=this.elements;i<r.length;i++)e(r[i]);return{arrayValue:{values:n}}},_r.prototype.ut=function(t){return null},_r.prototype.isEqual=function(t){return t instanceof _r&&Ys(this.elements,t.elements,sr)},_r),Ar=(Nr.prototype.ot=function(t,e){var n=this.ut(t),i=this.asNumber(n)+this.asNumber(this.ct);return yr(n)&&yr(this.ct)?this.serializer.lt(i):this.serializer._t(i)},Nr.prototype.at=function(t,e){return e},Nr.prototype.ut=function(t){return yr(e=t)||e&&"doubleValue"in e?t:{integerValue:0};var e},Nr.prototype.isEqual=function(t){return t instanceof Nr&&sr(this.ct,t.ct)},Nr.prototype.asNumber=function(t){return lr(t.integerValue||t.doubleValue)},Nr);function Nr(t,e){this.serializer=t,this.ct=e}function _r(t){this.elements=t}function Sr(t){this.elements=t}function Rr(t){return vr(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function kr(t,e){this.version=t,this.transformResults=e}var Dr,Or,Lr,Vr,Mr,Pr=(no.prototype.ft=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].B(t))return!0;return!1},no.prototype.isEqual=function(t){return Ys(this.fields,t.fields,function(t,e){return t.isEqual(e)})},no),Cr=(eo.prototype.isEqual=function(t){return this.field.isEqual(t.field)&&this.transform.isEqual(t.transform)},eo),Ur=(to.dt=function(){return new to},to.exists=function(t){return new to(void 0,t)},to.updateTime=function(t){return new to(t)},Object.defineProperty(to.prototype,"Tt",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!0,configurable:!0}),to.prototype.wt=function(t){return void 0!==this.updateTime?t instanceof mo&&t.version.isEqual(this.updateTime):void 0===this.exists||this.exists===t instanceof mo},to.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},to),jr=(Zr.prototype.Et=function(t){},Zr.It=function(t){return t instanceof mo?t.version:Oi.min()},Zr),qr=(n($r,Mr=jr),$r.prototype.at=function(t,e){this.Et(t);var n=e.version;return new mo(this.key,n,this.value,{hasCommittedMutations:!0})},$r.prototype.ot=function(t,e,n){if(this.Et(t),!this.Rt.wt(t))return t;var i=jr.It(t);return new mo(this.key,i,this.value,{At:!0})},$r.prototype.Pt=function(t){return null},$r.prototype.isEqual=function(t){return t instanceof $r&&this.key.isEqual(t.key)&&this.value.isEqual(t.value)&&this.Rt.isEqual(t.Rt)},$r),Fr=(n(Jr,Vr=jr),Jr.prototype.at=function(t,e){if(this.Et(t),!this.Rt.wt(t))return new bo(this.key,e.version);var n=this.pt(t);return new mo(this.key,e.version,n,{hasCommittedMutations:!0})},Jr.prototype.ot=function(t,e,n){if(this.Et(t),!this.Rt.wt(t))return t;var i=jr.It(t),r=this.pt(t);return new mo(this.key,i,r,{At:!0})},Jr.prototype.Pt=function(t){return null},Jr.prototype.isEqual=function(t){return t instanceof Jr&&this.key.isEqual(t.key)&&this.Vt.isEqual(t.Vt)&&this.Rt.isEqual(t.Rt)},Jr.prototype.pt=function(t){var e=t instanceof mo?t.data():zr.empty();return this.yt(e)},Jr.prototype.yt=function(t){var n=this,i=new Hr(t);return this.Vt.fields.forEach(function(t){var e;t.q()||(null!==(e=n.data.field(t))?i.set(t,e):i.delete(t))}),i.gt()},Jr),xr=(n(Kr,Lr=jr),Kr.prototype.at=function(t,e){if(this.Et(t),zs(null!=e.transformResults),!this.Rt.wt(t))return new bo(this.key,e.version);var n=this.bt(t),i=this.vt(t,e.transformResults),r=e.version,o=this.St(n.data(),i);return new mo(this.key,r,o,{hasCommittedMutations:!0})},Kr.prototype.ot=function(t,e,n){if(this.Et(t),!this.Rt.wt(t))return t;var i=this.bt(t),r=this.Ct(n,t,e),o=this.St(i.data(),r);return new mo(this.key,i.version,o,{At:!0})},Kr.prototype.Pt=function(t){for(var e=null,n=0,i=this.fieldTransforms;n<i.length;n++){var r=i[n],o=t instanceof mo?t.field(r.field):void 0,s=r.transform.ut(o||null);null!=s&&(e=null==e?(new Hr).set(r.field,s):e.set(r.field,s))}return e?e.gt():null},Kr.prototype.isEqual=function(t){return t instanceof Kr&&this.key.isEqual(t.key)&&Ys(this.fieldTransforms,t.fieldTransforms,function(t,e){return t.isEqual(e)})&&this.Rt.isEqual(t.Rt)},Kr.prototype.bt=function(t){return t},Kr.prototype.vt=function(t,e){var n=[];zs(this.fieldTransforms.length===e.length);for(var i=0;i<e.length;i++){var r=this.fieldTransforms[i],o=r.transform,s=null;t instanceof mo&&(s=t.field(r.field)),n.push(o.at(s,e[i]))}return n},Kr.prototype.Ct=function(t,e,n){for(var i=[],r=0,o=this.fieldTransforms;r<o.length;r++){var s=o[r],u=s.transform,a=null;e instanceof mo&&(a=e.field(s.field)),null===a&&n instanceof mo&&(a=n.field(s.field)),i.push(u.ot(a,t))}return i},Kr.prototype.St=function(t,e){for(var n=new Hr(t),i=0;i<this.fieldTransforms.length;i++){var r=this.fieldTransforms[i].field;n.set(r,e[i])}return n.gt()},Kr),Gr=(n(Xr,Or=jr),Xr.prototype.at=function(t,e){return this.Et(t),new wo(this.key,e.version,{hasCommittedMutations:!0})},Xr.prototype.ot=function(t,e,n){return this.Et(t),this.Rt.wt(t)?new wo(this.key,Oi.min()):t},Xr.prototype.Pt=function(t){return null},Xr.prototype.isEqual=function(t){return t instanceof Xr&&this.key.isEqual(t.key)&&this.Rt.isEqual(t.Rt)},Xr),Br=(n(Yr,Dr=jr),Yr.prototype.at=function(t,e){Bs()},Yr.prototype.ot=function(t,e,n){Bs()},Yr.prototype.Pt=function(t){Bs()},Yr.prototype.isEqual=function(t){return t instanceof Yr&&this.key.isEqual(t.key)&&this.Rt.isEqual(t.Rt)},Yr),zr=(Qr.empty=function(){return new Qr({mapValue:{}})},Qr.prototype.field=function(t){if(t.q())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!wr(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.M()])||null},Qr.prototype.isEqual=function(t){return sr(this.proto,t.proto)},Qr),Hr=(Wr.prototype.set=function(t,e){return this.Nt(t,e),this},Wr.prototype.delete=function(t){return this.Nt(t,null),this},Wr.prototype.Nt=function(t,e){for(var n=this.Ft,i=0;i<t.length-1;++i){var r=t.get(i),o=n.get(r);o instanceof Map||(o=o&&10===or(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(r,o)),n=o}n.set(t.M(),e)},Wr.prototype.gt=function(){var t=this.$t(Hi.H,this.Ft);return null!=t?new zr(t):this.Dt},Wr.prototype.$t=function(i,t){var r=this,o=!1,e=this.Dt.field(i),s=wr(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=r.$t(i.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},Wr);function Wr(t){void 0===t&&(t=zr.empty()),this.Dt=t,this.Ft=new Map}function Qr(t){this.proto=t}function Yr(t,e){var n=this;return(n=Dr.call(this)||this).key=t,n.Rt=e,n.type=4,n}function Xr(t,e){var n=this;return(n=Or.call(this)||this).key=t,n.Rt=e,n.type=3,n}function Kr(t,e){var n=this;return(n=Lr.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.Rt=Ur.exists(!0),n}function Jr(t,e,n,i){var r=this;return(r=Vr.call(this)||this).key=t,r.data=e,r.Vt=n,r.Rt=i,r.type=1,r}function $r(t,e,n){var i=this;return(i=Mr.call(this)||this).key=t,i.value=e,i.Rt=n,i.type=0,i}function Zr(){}function to(t,e){this.updateTime=t,this.exists=e}function eo(t,e){this.field=t,this.transform=e}function no(t){(this.fields=t).sort(Hi.N)}function io(t){var u=[];return Ki(t.fields||{},function(t,e){var n=new Hi([t]);if(wr(e)){var i=io(e.mapValue).fields;if(0===i.length)u.push(n);else for(var r=0,o=i;r<o.length;r++){var s=o[r];u.push(n.child(s))}}else u.push(n)}),new Pr(u)}function ro(t,e){this.key=t,this.version=e}function oo(t){this.count=t}var so,uo,ao,ho,co,fo,lo,po,yo,vo,go,mo=(n(Ho,go=ro),Ho.prototype.field=function(t){return this.Lt.field(t)},Ho.prototype.data=function(){return this.Lt},Ho.prototype.kt=function(){return this.Lt.proto},Ho.prototype.isEqual=function(t){return t instanceof Ho&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.At===t.At&&this.hasCommittedMutations===t.hasCommittedMutations&&this.Lt.isEqual(t.Lt)},Ho.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.Lt.toString()+", {hasLocalMutations: "+this.At+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(Ho.prototype,"hasPendingWrites",{get:function(){return this.At||this.hasCommittedMutations},enumerable:!0,configurable:!0}),Ho),wo=(n(zo,vo=ro),zo.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(zo.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!0,configurable:!0}),zo.prototype.isEqual=function(t){return t instanceof zo&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},zo),bo=(n(Bo,yo=ro),Bo.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(Bo.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!0,configurable:!0}),Bo.prototype.isEqual=function(t){return t instanceof Bo&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},Bo),Eo=(Go.prototype.canonicalId=function(){var t;return null===this.Ot&&(t=this.path.j(),null!==this.collectionGroup&&(t+="|cg:"+this.collectionGroup),t+="|f:",t+=this.filters.map(function(t){return t.canonicalId()}).join(","),t+="|ob:",t+=this.orderBy.map(function(t){return t.canonicalId()}).join(","),tr(this.limit)||(t+="|l:",t+=this.limit),this.startAt&&(t+="|lb:",t+=this.startAt.canonicalId()),this.endAt&&(t+="|ub:",t+=this.endAt.canonicalId()),this.Ot=t),this.Ot},Go.prototype.toString=function(){var t=this.path.j();return null!==this.collectionGroup&&(t+=" collectionGroup="+this.collectionGroup),0<this.filters.length&&(t+=", filters: ["+this.filters.join(", ")+"]"),tr(this.limit)||(t+=", limit: "+this.limit),0<this.orderBy.length&&(t+=", orderBy: ["+this.orderBy.join(", ")+"]"),this.startAt&&(t+=", startAt: "+this.startAt.canonicalId()),this.endAt&&(t+=", endAt: "+this.endAt.canonicalId()),"Target("+t+")"},Go.prototype.isEqual=function(t){if(this.limit!==t.limit)return!1;if(this.orderBy.length!==t.orderBy.length)return!1;for(var e=0;e<this.orderBy.length;e++)if(!this.orderBy[e].isEqual(t.orderBy[e]))return!1;if(this.filters.length!==t.filters.length)return!1;for(var n=0;n<this.filters.length;n++)if(!this.filters[n].isEqual(t.filters[n]))return!1;return this.collectionGroup===t.collectionGroup&&!!this.path.isEqual(t.path)&&!!(null!==this.startAt?this.startAt.isEqual(t.startAt):null===t.startAt)&&(null!==this.endAt?this.endAt.isEqual(t.endAt):null===t.endAt)},Go.prototype.Mt=function(){return Qi.et(this.path)&&null===this.collectionGroup&&0===this.filters.length},Go),Io=(xo.Wt=function(t){return new xo(t)},Object.defineProperty(xo.prototype,"orderBy",{get:function(){if(null===this.Bt){this.Bt=[];var t=this.jt(),e=this.Gt();if(null!==t&&null===e)t.Y()||this.Bt.push(new Do(t)),this.Bt.push(new Do(Hi.X(),"asc"));else{for(var n,i=!1,r=0,o=this.qt;r<o.length;r++){var s=o[r];this.Bt.push(s),s.field.Y()&&(i=!0)}i||(n=0<this.qt.length?this.qt[this.qt.length-1].dir:"asc",this.Bt.push(new Do(Hi.X(),n)))}}return this.Bt},enumerable:!0,configurable:!0}),xo.prototype.Ht=function(t){var e=this.filters.concat([t]);return new xo(this.path,this.collectionGroup,this.qt.slice(),e,this.limit,this.xt,this.startAt,this.endAt)},xo.prototype.Kt=function(t){var e=this.qt.concat([t]);return new xo(this.path,this.collectionGroup,e,this.filters.slice(),this.limit,this.xt,this.startAt,this.endAt)},xo.prototype.zt=function(t){return new xo(this.path,this.collectionGroup,this.qt.slice(),this.filters.slice(),t,"F",this.startAt,this.endAt)},xo.prototype.Yt=function(t){return new xo(this.path,this.collectionGroup,this.qt.slice(),this.filters.slice(),t,"L",this.startAt,this.endAt)},xo.prototype.Xt=function(t){return new xo(this.path,this.collectionGroup,this.qt.slice(),this.filters.slice(),this.limit,this.xt,t,this.endAt)},xo.prototype.Jt=function(t){return new xo(this.path,this.collectionGroup,this.qt.slice(),this.filters.slice(),this.limit,this.xt,this.startAt,t)},xo.prototype.Zt=function(t){return new xo(t,null,this.qt.slice(),this.filters.slice(),this.limit,this.xt,this.startAt,this.endAt)},xo.prototype.te=function(){return 0===this.filters.length&&null===this.limit&&null==this.startAt&&null==this.endAt&&(0===this.qt.length||1===this.qt.length&&this.qt[0].field.Y())},xo.prototype.canonicalId=function(){return this.ee().canonicalId()+"|lt:"+this.xt},xo.prototype.toString=function(){return"Query(target="+this.ee().toString()+"; limitType="+this.xt+")"},xo.prototype.isEqual=function(t){return this.ee().isEqual(t.ee())&&this.xt===t.xt},xo.prototype.se=function(t,e){for(var n=!1,i=0,r=this.orderBy;i<r.length;i++){var o=r[i],s=o.compare(t,e);if(0!==s)return s;n=n||o.field.Y()}return 0},xo.prototype.matches=function(t){return this.ie(t)&&this.ne(t)&&this.re(t)&&this.he(t)},xo.prototype.oe=function(){return!tr(this.limit)&&"F"===this.xt},xo.prototype.ae=function(){return!tr(this.limit)&&"L"===this.xt},xo.prototype.Gt=function(){return 0<this.qt.length?this.qt[0].field:null},xo.prototype.jt=function(){for(var t=0,e=this.filters;t<e.length;t++){var n=e[t];if(n instanceof To&&n.ue())return n.field}return null},xo.prototype.ce=function(t){for(var e=0,n=this.filters;e<n.length;e++){var i=n[e];if(i instanceof To&&0<=t.indexOf(i.op))return i.op}return null},xo.prototype.Mt=function(){return this.ee().Mt()},xo.prototype.le=function(){return null!==this.collectionGroup},xo.prototype.ee=function(){if(!this.Ut)if("F"===this.xt)this.Ut=new Eo(this.path,this.collectionGroup,this.orderBy,this.filters,this.limit,this.startAt,this.endAt);else{for(var t=[],e=0,n=this.orderBy;e<n.length;e++){var i=n[e],r="desc"===i.dir?"asc":"desc";t.push(new Do(i.field,r))}var o=this.endAt?new ko(this.endAt.position,!this.endAt.before):null,s=this.startAt?new ko(this.startAt.position,!this.startAt.before):null;this.Ut=new Eo(this.path,this.collectionGroup,t,this.filters,this.limit,o,s)}return this.Ut},xo.prototype.ie=function(t){var e=t.key.path;return null!==this.collectionGroup?t.key.tt(this.collectionGroup)&&this.path.B(e):Qi.et(this.path)?this.path.isEqual(e):this.path.U(e)},xo.prototype.ne=function(t){for(var e=0,n=this.qt;e<n.length;e++){var i=n[e];if(!i.field.Y()&&null===t.field(i.field))return!1}return!0},xo.prototype.re=function(t){for(var e=0,n=this.filters;e<n.length;e++)if(!n[e].matches(t))return!1;return!0},xo.prototype.he=function(t){return!(this.startAt&&!this.startAt._e(this.orderBy,t)||this.endAt&&this.endAt._e(this.orderBy,t))},xo.prototype.Qt=function(t){},xo),To=(n(Fo,po=function(){}),Fo.create=function(t,e,n){if(t.Y())return"in"===e?new No(t,n):new Ao(t,e,n);if(gr(n)){if("=="!==e)throw new Ni(Ai.INVALID_ARGUMENT,"Invalid query. Null supports only equality comparisons.");return new Fo(t,e,n)}if(mr(n)){if("=="!==e)throw new Ni(Ai.INVALID_ARGUMENT,"Invalid query. NaN supports only equality comparisons.");return new Fo(t,e,n)}return"array-contains"===e?new _o(t,n):"in"===e?new So(t,n):"array-contains-any"===e?new Ro(t,n):new Fo(t,e,n)},Fo.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&or(this.value)===or(e)&&this.fe(ar(e,this.value))},Fo.prototype.fe=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case">":return 0<t;case">=":return 0<=t;default:return Bs()}},Fo.prototype.ue=function(){return 0<=["<","<=",">",">="].indexOf(this.op)},Fo.prototype.canonicalId=function(){return this.field.j()+this.op.toString()+cr(this.value)},Fo.prototype.isEqual=function(t){return t instanceof Fo&&this.op===t.op&&this.field.isEqual(t.field)&&sr(this.value,t.value)},Fo.prototype.toString=function(){return this.field.j()+" "+this.op+" "+cr(this.value)},Fo),Ao=(n(qo,lo=To),qo.prototype.matches=function(t){var e=Qi.N(t.key,this.key);return this.fe(e)},qo),No=(n(jo,fo=To),jo.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},jo),_o=(n(Uo,co=To),Uo.prototype.matches=function(t){var e=t.field(this.field);return vr(e)&&ur(e.arrayValue,this.value)},Uo),So=(n(Co,ho=To),Co.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&ur(this.value.arrayValue,e)},Co),Ro=(n(Po,ao=To),Po.prototype.matches=function(t){var e=this,n=t.field(this.field);return!(!vr(n)||!n.arrayValue.values)&&n.arrayValue.values.some(function(t){return ur(e.value.arrayValue,t)})},Po),ko=(Mo.prototype.canonicalId=function(){return(this.before?"b":"a")+":"+this.position.map(cr).join(",")},Mo.prototype._e=function(t,e){for(var n=0,i=0;i<this.position.length;i++){var r=t[i],o=this.position[i],n=r.field.Y()?Qi.N(Qi.Z(o.referenceValue),e.key):ar(o,e.field(r.field));if("desc"===r.dir&&(n*=-1),0!==n)break}return this.before?n<=0:n<0},Mo.prototype.isEqual=function(t){if(null===t)return!1;if(this.before!==t.before||this.position.length!==t.position.length)return!1;for(var e=0;e<this.position.length;e++)if(!sr(this.position[e],t.position[e]))return!1;return!0},Mo),Do=(Vo.prototype.compare=function(t,e){var n,i,r,o,s=this.de?Qi.N(t.key,e.key):(n=this.field,i=e,r=t.field(n),o=i.field(n),null!==r&&null!==o?ar(r,o):Bs());switch(this.dir){case"asc":return s;case"desc":return-1*s;default:return Bs()}},Vo.prototype.canonicalId=function(){return this.field.j()+this.dir.toString()},Vo.prototype.toString=function(){return this.field.j()+" ("+this.dir+")"},Vo.prototype.isEqual=function(t){return this.dir===t.dir&&this.field.isEqual(t.field)},Vo),Oo=(Lo.prototype.Ee=function(t){return new Lo(this.target,this.targetId,this.Te,t,this.we,this.lastLimboFreeSnapshotVersion,this.resumeToken)},Lo.prototype.me=function(t,e){return new Lo(this.target,this.targetId,this.Te,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},Lo.prototype.Ie=function(t){return new Lo(this.target,this.targetId,this.Te,this.sequenceNumber,this.we,t,this.resumeToken)},Lo);function Lo(t,e,n,i,r,o,s){void 0===r&&(r=Oi.min()),void 0===o&&(o=Oi.min()),void 0===s&&(s=$i.ht),this.target=t,this.targetId=e,this.Te=n,this.sequenceNumber=i,this.we=r,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function Vo(t,e){this.field=t,void 0===e&&(e="asc"),this.dir=e,this.de=t.Y()}function Mo(t,e){this.position=t,this.before=e}function Po(t,e){return ao.call(this,t,"array-contains-any",e)||this}function Co(t,e){return ho.call(this,t,"in",e)||this}function Uo(t,e){return co.call(this,t,"array-contains",e)||this}function jo(t,e){var n=this;return(n=fo.call(this,t,"in",e)||this).keys=(e.arrayValue.values||[]).map(function(t){return Qi.Z(t.referenceValue)}),n}function qo(t,e,n){var i=this;return(i=lo.call(this,t,e,n)||this).key=Qi.Z(n.referenceValue),i}function Fo(t,e,n){var i=this;return(i=po.call(this)||this).field=t,i.op=e,i.value=n,i}function xo(t,e,n,i,r,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===i&&(i=[]),void 0===r&&(r=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.qt=n,this.filters=i,this.limit=r,this.xt=o,this.startAt=s,this.endAt=u,this.Bt=null,this.Ut=null,this.startAt&&this.Qt(this.startAt),this.endAt&&this.Qt(this.endAt)}function Go(t,e,n,i,r,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===i&&(i=[]),void 0===r&&(r=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=i,this.limit=r,this.startAt=o,this.endAt=s,this.Ot=null}function Bo(){return null!==yo&&yo.apply(this,arguments)||this}function zo(t,e,n){var i=this;return(i=vo.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),i}function Ho(t,e,n,i){var r=this;return(r=go.call(this,t,e)||this).Lt=n,r.At=!!i.At,r.hasCommittedMutations=!!i.hasCommittedMutations,r}function Wo(t){switch(t){case Ai.OK:return Bs();case Ai.CANCELLED:case Ai.UNKNOWN:case Ai.DEADLINE_EXCEEDED:case Ai.RESOURCE_EXHAUSTED:case Ai.INTERNAL:case Ai.UNAVAILABLE:case Ai.UNAUTHENTICATED:return;case Ai.INVALID_ARGUMENT:case Ai.NOT_FOUND:case Ai.ALREADY_EXISTS:case Ai.PERMISSION_DENIED:case Ai.FAILED_PRECONDITION:case Ai.ABORTED:case Ai.OUT_OF_RANGE:case Ai.UNIMPLEMENTED:case Ai.DATA_LOSS:return 1;default:return Bs()}}function Qo(t){if(void 0===t)return xs("GRPC error has no .code"),Ai.UNKNOWN;switch(t){case so.OK:return Ai.OK;case so.CANCELLED:return Ai.CANCELLED;case so.UNKNOWN:return Ai.UNKNOWN;case so.DEADLINE_EXCEEDED:return Ai.DEADLINE_EXCEEDED;case so.RESOURCE_EXHAUSTED:return Ai.RESOURCE_EXHAUSTED;case so.INTERNAL:return Ai.INTERNAL;case so.UNAVAILABLE:return Ai.UNAVAILABLE;case so.UNAUTHENTICATED:return Ai.UNAUTHENTICATED;case so.INVALID_ARGUMENT:return Ai.INVALID_ARGUMENT;case so.NOT_FOUND:return Ai.NOT_FOUND;case so.ALREADY_EXISTS:return Ai.ALREADY_EXISTS;case so.PERMISSION_DENIED:return Ai.PERMISSION_DENIED;case so.FAILED_PRECONDITION:return Ai.FAILED_PRECONDITION;case so.ABORTED:return Ai.ABORTED;case so.OUT_OF_RANGE:return Ai.OUT_OF_RANGE;case so.UNIMPLEMENTED:return Ai.UNIMPLEMENTED;case so.DATA_LOSS:return Ai.DATA_LOSS;default:return Bs()}}(uo=so=so||{})[uo.OK=0]="OK",uo[uo.CANCELLED=1]="CANCELLED",uo[uo.UNKNOWN=2]="UNKNOWN",uo[uo.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",uo[uo.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",uo[uo.NOT_FOUND=5]="NOT_FOUND",uo[uo.ALREADY_EXISTS=6]="ALREADY_EXISTS",uo[uo.PERMISSION_DENIED=7]="PERMISSION_DENIED",uo[uo.UNAUTHENTICATED=16]="UNAUTHENTICATED",uo[uo.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",uo[uo.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",uo[uo.ABORTED=10]="ABORTED",uo[uo.OUT_OF_RANGE=11]="OUT_OF_RANGE",uo[uo.UNIMPLEMENTED=12]="UNIMPLEMENTED",uo[uo.INTERNAL=13]="INTERNAL",uo[uo.UNAVAILABLE=14]="UNAVAILABLE",uo[uo.DATA_LOSS=15]="DATA_LOSS";var Yo=(Zo.prototype.Re=function(t,e){return new Zo(this.N,this.root.Re(t,e,this.N).Ae(null,null,Ko.Pe,null,null))},Zo.prototype.remove=function(t){return new Zo(this.N,this.root.remove(t,this.N).Ae(null,null,Ko.Pe,null,null))},Zo.prototype.get=function(t){for(var e=this.root;!e.q();){var n=this.N(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},Zo.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.q();){var i=this.N(t,n.key);if(0===i)return e+n.left.size;n=i<0?n.left:(e+=n.left.size+1,n.right)}return-1},Zo.prototype.q=function(){return this.root.q()},Object.defineProperty(Zo.prototype,"size",{get:function(){return this.root.size},enumerable:!0,configurable:!0}),Zo.prototype.Ve=function(){return this.root.Ve()},Zo.prototype.pe=function(){return this.root.pe()},Zo.prototype.ye=function(t){return this.root.ye(t)},Zo.prototype.forEach=function(n){this.ye(function(t,e){return n(t,e),!1})},Zo.prototype.toString=function(){var n=[];return this.ye(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},Zo.prototype.ge=function(t){return this.root.ge(t)},Zo.prototype.be=function(){return new Xo(this.root,null,this.N,!1)},Zo.prototype.ve=function(t){return new Xo(this.root,t,this.N,!1)},Zo.prototype.Se=function(){return new Xo(this.root,null,this.N,!0)},Zo.prototype.Ce=function(t){return new Xo(this.root,t,this.N,!0)},Zo),Xo=($o.prototype.Ne=function(){var t=this.Fe.pop(),e={key:t.key,value:t.value};if(this.De)for(t=t.left;!t.q();)this.Fe.push(t),t=t.right;else for(t=t.right;!t.q();)this.Fe.push(t),t=t.left;return e},$o.prototype.$e=function(){return 0<this.Fe.length},$o.prototype.Le=function(){if(0===this.Fe.length)return null;var t=this.Fe[this.Fe.length-1];return{key:t.key,value:t.value}},$o),Ko=(Jo.prototype.Ae=function(t,e,n,i,r){return new Jo(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=i?i:this.left,null!=r?r:this.right)},Jo.prototype.q=function(){return!1},Jo.prototype.ye=function(t){return this.left.ye(t)||t(this.key,this.value)||this.right.ye(t)},Jo.prototype.ge=function(t){return this.right.ge(t)||t(this.key,this.value)||this.left.ge(t)},Jo.prototype.min=function(){return this.left.q()?this:this.left.min()},Jo.prototype.Ve=function(){return this.min().key},Jo.prototype.pe=function(){return this.right.q()?this.key:this.right.pe()},Jo.prototype.Re=function(t,e,n){var i=this,r=n(t,i.key);return(i=r<0?i.Ae(null,null,null,i.left.Re(t,e,n),null):0===r?i.Ae(null,e,null,null,null):i.Ae(null,null,null,null,i.right.Re(t,e,n))).ke()},Jo.prototype.Oe=function(){if(this.left.q())return Jo.EMPTY;var t=this;return t.left.Me()||t.left.left.Me()||(t=t.qe()),(t=t.Ae(null,null,null,t.left.Oe(),null)).ke()},Jo.prototype.remove=function(t,e){var n,i=this;if(e(t,i.key)<0)i.left.q()||i.left.Me()||i.left.left.Me()||(i=i.qe()),i=i.Ae(null,null,null,i.left.remove(t,e),null);else{if(i.left.Me()&&(i=i.xe()),i.right.q()||i.right.Me()||i.right.left.Me()||(i=i.Be()),0===e(t,i.key)){if(i.right.q())return Jo.EMPTY;n=i.right.min(),i=i.Ae(n.key,n.value,null,null,i.right.Oe())}i=i.Ae(null,null,null,null,i.right.remove(t,e))}return i.ke()},Jo.prototype.Me=function(){return this.color},Jo.prototype.ke=function(){var t=this;return t.right.Me()&&!t.left.Me()&&(t=t.Ue()),t.left.Me()&&t.left.left.Me()&&(t=t.xe()),t.left.Me()&&t.right.Me()&&(t=t.Qe()),t},Jo.prototype.qe=function(){var t=this.Qe();return t.right.left.Me()&&(t=(t=(t=t.Ae(null,null,null,null,t.right.xe())).Ue()).Qe()),t},Jo.prototype.Be=function(){var t=this.Qe();return t.left.left.Me()&&(t=(t=t.xe()).Qe()),t},Jo.prototype.Ue=function(){var t=this.Ae(null,null,Jo.RED,null,this.right.left);return this.right.Ae(null,null,this.color,t,null)},Jo.prototype.xe=function(){var t=this.Ae(null,null,Jo.RED,this.left.right,null);return this.left.Ae(null,null,this.color,null,t)},Jo.prototype.Qe=function(){var t=this.left.Ae(null,null,!this.left.color,null,null),e=this.right.Ae(null,null,!this.right.color,null,null);return this.Ae(null,null,!this.color,t,e)},Jo.prototype.We=function(){var t=this.je();return Math.pow(2,t)<=this.size+1},Jo.prototype.je=function(){if(this.Me()&&this.left.Me())throw Bs();if(this.right.Me())throw Bs();var t=this.left.je();if(t!==this.right.je())throw Bs();return t+(this.Me()?0:1)},Jo);function Jo(t,e,n,i,r){this.key=t,this.value=e,this.color=null!=n?n:Jo.RED,this.left=null!=i?i:Jo.EMPTY,this.right=null!=r?r:Jo.EMPTY,this.size=this.left.size+1+this.right.size}function $o(t,e,n,i){this.De=i,this.Fe=[];for(var r=1;!t.q();)if(r=e?n(t.key,e):1,i&&(r*=-1),r<0)t=this.De?t.left:t.right;else{if(0===r){this.Fe.push(t);break}this.Fe.push(t),t=this.De?t.right:t.left}}function Zo(t,e){this.N=t,this.root=e||Ko.EMPTY}function ts(){this.size=0}Ko.EMPTY=null,Ko.RED=!0,Ko.Pe=!1,Ko.EMPTY=(Object.defineProperty(ts.prototype,"key",{get:function(){throw Bs()},enumerable:!0,configurable:!0}),Object.defineProperty(ts.prototype,"value",{get:function(){throw Bs()},enumerable:!0,configurable:!0}),Object.defineProperty(ts.prototype,"color",{get:function(){throw Bs()},enumerable:!0,configurable:!0}),Object.defineProperty(ts.prototype,"left",{get:function(){throw Bs()},enumerable:!0,configurable:!0}),Object.defineProperty(ts.prototype,"right",{get:function(){throw Bs()},enumerable:!0,configurable:!0}),ts.prototype.Ae=function(t,e,n,i,r){return this},ts.prototype.Re=function(t,e,n){return new Ko(t,e)},ts.prototype.remove=function(t,e){return this},ts.prototype.q=function(){return!0},ts.prototype.ye=function(t){return!1},ts.prototype.ge=function(t){return!1},ts.prototype.Ve=function(){return null},ts.prototype.pe=function(){return null},ts.prototype.Me=function(){return!1},ts.prototype.We=function(){return!0},ts.prototype.je=function(){return 0},new ts);var es=(os.prototype.has=function(t){return null!==this.data.get(t)},os.prototype.first=function(){return this.data.Ve()},os.prototype.last=function(){return this.data.pe()},Object.defineProperty(os.prototype,"size",{get:function(){return this.data.size},enumerable:!0,configurable:!0}),os.prototype.indexOf=function(t){return this.data.indexOf(t)},os.prototype.forEach=function(n){this.data.ye(function(t,e){return n(t),!1})},os.prototype.Ge=function(t,e){for(var n=this.data.ve(t[0]);n.$e();){var i=n.Ne();if(0<=this.N(i.key,t[1]))return;e(i.key)}},os.prototype.He=function(t,e){for(var n=void 0!==e?this.data.ve(e):this.data.be();n.$e();)if(!t(n.Ne().key))return},os.prototype.Ke=function(t){var e=this.data.ve(t);return e.$e()?e.Ne().key:null},os.prototype.be=function(){return new ns(this.data.be())},os.prototype.ve=function(t){return new ns(this.data.ve(t))},os.prototype.add=function(t){return this.Ae(this.data.remove(t).Re(t,!0))},os.prototype.delete=function(t){return this.has(t)?this.Ae(this.data.remove(t)):this},os.prototype.q=function(){return this.data.q()},os.prototype.ze=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},os.prototype.isEqual=function(t){if(!(t instanceof os))return!1;if(this.size!==t.size)return!1;for(var e=this.data.be(),n=t.data.be();e.$e();){var i=e.Ne().key,r=n.Ne().key;if(0!==this.N(i,r))return!1}return!0},os.prototype.W=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},os.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},os.prototype.Ae=function(t){var e=new os(this.N);return e.data=t,e},os),ns=(rs.prototype.Ne=function(){return this.Ye.Ne().key},rs.prototype.$e=function(){return this.Ye.$e()},rs),is=new Yo(Qi.N);function rs(t){this.Ye=t}function os(t){this.N=t,this.data=new Yo(this.N)}var ss=new Yo(Qi.N);var us=new Yo(Qi.N);var as=new es(Qi.N);function hs(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=as,i=0,r=t;i<r.length;i++)var o=r[i],n=n.add(o);return n}var cs=new es(Qs);function fs(t,e,n,i){this.ms=t,this.removedTargetIds=e,this.key=n,this.Is=i}function ls(t,e){this.targetId=t,this.Rs=e}function ps(t,e,n,i){void 0===n&&(n=$i.ht),void 0===i&&(i=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=i}var ds=(Ss.Ze=function(t){return new Ss(t.N)},Ss.prototype.has=function(t){return null!=this.Xe.get(t)},Ss.prototype.get=function(t){return this.Xe.get(t)},Ss.prototype.first=function(){return this.Je.Ve()},Ss.prototype.last=function(){return this.Je.pe()},Ss.prototype.q=function(){return this.Je.q()},Ss.prototype.indexOf=function(t){var e=this.Xe.get(t);return e?this.Je.indexOf(e):-1},Object.defineProperty(Ss.prototype,"size",{get:function(){return this.Je.size},enumerable:!0,configurable:!0}),Ss.prototype.forEach=function(n){this.Je.ye(function(t,e){return n(t),!1})},Ss.prototype.add=function(t){var e=this.delete(t.key);return e.Ae(e.Xe.Re(t.key,t),e.Je.Re(t,null))},Ss.prototype.delete=function(t){var e=this.get(t);return e?this.Ae(this.Xe.remove(t),this.Je.remove(e)):this},Ss.prototype.isEqual=function(t){if(!(t instanceof Ss))return!1;if(this.size!==t.size)return!1;for(var e=this.Je.be(),n=t.Je.be();e.$e();){var i=e.Ne().key,r=n.Ne().key;if(!i.isEqual(r))return!1}return!0},Ss.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},Ss.prototype.Ae=function(t,e){var n=new Ss;return n.N=this.N,n.Xe=t,n.Je=e,n},Ss),ys=(_s.prototype.track=function(t){var e=t.doc.key,n=this.ts.get(e);!n||0!==t.type&&3===n.type?this.ts=this.ts.Re(e,t):3===t.type&&1!==n.type?this.ts=this.ts.Re(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.ts=this.ts.Re(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.ts=this.ts.Re(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.ts=this.ts.remove(e):1===t.type&&2===n.type?this.ts=this.ts.Re(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.ts=this.ts.Re(e,{type:2,doc:t.doc}):Bs()},_s.prototype.es=function(){var n=[];return this.ts.ye(function(t,e){n.push(e)}),n},_s),vs=(Ns.os=function(t,e,n,i){var r=[];return e.forEach(function(t){r.push({type:0,doc:t})}),new Ns(t,e,ds.Ze(e),r,n,i,!0,!1)},Object.defineProperty(Ns.prototype,"hasPendingWrites",{get:function(){return!this.ns.q()},enumerable:!0,configurable:!0}),Ns.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.rs===t.rs&&this.ns.isEqual(t.ns)&&this.query.isEqual(t.query)&&this.docs.isEqual(t.docs)&&this.ss.isEqual(t.ss)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var i=0;i<e.length;i++)if(e[i].type!==n[i].type||!e[i].doc.isEqual(n[i].doc))return!1;return!0},Ns),gs=(As._s=function(t,e){var n=new Map;return n.set(t,ms.fs(t,e)),new As(Oi.min(),n,cs,is,hs())},As),ms=(Ts.fs=function(t,e){return new Ts($i.ht,e,hs(),hs(),hs())},Ts),ws=(Object.defineProperty(Is.prototype,"ds",{get:function(){return this.ps},enumerable:!0,configurable:!0}),Object.defineProperty(Is.prototype,"resumeToken",{get:function(){return this.Vs},enumerable:!0,configurable:!0}),Object.defineProperty(Is.prototype,"gs",{get:function(){return 0!==this.As},enumerable:!0,configurable:!0}),Object.defineProperty(Is.prototype,"bs",{get:function(){return this.ys},enumerable:!0,configurable:!0}),Is.prototype.vs=function(t){0<t.rt()&&(this.ys=!0,this.Vs=t)},Is.prototype.Ss=function(){var n=hs(),i=hs(),r=hs();return this.Ps.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:i=i.add(t);break;case 1:r=r.add(t);break;default:Bs()}}),new ms(this.Vs,this.ps,n,i,r)},Is.prototype.Cs=function(){this.ys=!1,this.Ps=ks()},Is.prototype.Ds=function(t,e){this.ys=!0,this.Ps=this.Ps.Re(t,e)},Is.prototype.Fs=function(t){this.ys=!0,this.Ps=this.Ps.remove(t)},Is.prototype.Ns=function(){this.As+=1},Is.prototype.$s=function(){--this.As},Is.prototype.Ls=function(){this.ys=!0,this.ps=!0},Is),bs=(Es.prototype.Bs=function(t){for(var e=0,n=t.ms;e<n.length;e++){var i=n[e];t.Is instanceof mo?this.Us(i,t.Is):t.Is instanceof wo&&this.Qs(i,t.key,t.Is)}for(var r=0,o=t.removedTargetIds;r<o.length;r++){var s=o[r];this.Qs(s,t.key,t.Is)}},Es.prototype.Ws=function(n){var i=this;this.js(n,function(t){var e=i.Gs(t);switch(n.state){case 0:i.Hs(t)&&e.vs(n.resumeToken);break;case 1:e.$s(),e.gs||e.Cs(),e.vs(n.resumeToken);break;case 2:e.$s(),e.gs||i.removeTarget(t);break;case 3:i.Hs(t)&&(e.Ls(),e.vs(n.resumeToken));break;case 4:i.Hs(t)&&(i.Ks(t),e.vs(n.resumeToken));break;default:Bs()}})},Es.prototype.js=function(t,n){var i=this;0<t.targetIds.length?t.targetIds.forEach(n):this.Os.forEach(function(t,e){i.Hs(e)&&n(e)})},Es.prototype.zs=function(t){var e,n,i=t.targetId,r=t.Rs.count,o=this.Ys(i);o&&((e=o.target).Mt()?0===r?(n=new Qi(e.path),this.Qs(i,n,new wo(n,Oi.min()))):zs(1===r):this.Xs(i)!==r&&(this.Ks(i),this.xs=this.xs.add(i)))},Es.prototype.Js=function(r){var o=this,s=new Map;this.Os.forEach(function(t,e){var n,i=o.Ys(e);i&&(t.ds&&i.target.Mt()&&(n=new Qi(i.target.path),null!==o.Ms.get(n)||o.Zs(e,n)||o.Qs(e,n,new wo(n,r))),t.bs&&(s.set(e,t.Ss()),t.Cs()))});var i=hs();this.qs.forEach(function(t,e){var n=!0;e.He(function(t){var e=o.Ys(t);return!e||2===e.Te||(n=!1)}),n&&(i=i.add(t))});var t=new gs(r,s,this.xs,this.Ms,i);return this.Ms=is,this.qs=Rs(),this.xs=new es(Qs),t},Es.prototype.Us=function(t,e){var n;this.Hs(t)&&(n=this.Zs(t,e.key)?2:0,this.Gs(t).Ds(e.key,n),this.Ms=this.Ms.Re(e.key,e),this.qs=this.qs.Re(e.key,this.ti(e.key).add(t)))},Es.prototype.Qs=function(t,e,n){var i;this.Hs(t)&&(i=this.Gs(t),this.Zs(t,e)?i.Ds(e,1):i.Fs(e),this.qs=this.qs.Re(e,this.ti(e).delete(t)),n&&(this.Ms=this.Ms.Re(e,n)))},Es.prototype.removeTarget=function(t){this.Os.delete(t)},Es.prototype.Xs=function(t){var e=this.Gs(t).Ss();return this.ks.ei(t).size+e.Ts.size-e.Es.size},Es.prototype.Ns=function(t){this.Gs(t).Ns()},Es.prototype.Gs=function(t){var e=this.Os.get(t);return e||(e=new ws,this.Os.set(t,e)),e},Es.prototype.ti=function(t){var e=this.qs.get(t);return e||(e=new es(Qs),this.qs=this.qs.Re(t,e)),e},Es.prototype.Hs=function(t){var e=null!==this.Ys(t);return e||Fs("WatchChangeAggregator","Detected inactive target",t),e},Es.prototype.Ys=function(t){var e=this.Os.get(t);return e&&e.gs?null:this.ks.si(t)},Es.prototype.Ks=function(e){var n=this;this.Os.set(e,new ws),this.ks.ei(e).forEach(function(t){n.Qs(e,t,null)})},Es.prototype.Zs=function(t,e){return this.ks.ei(t).has(e)},Es);function Es(t){this.ks=t,this.Os=new Map,this.Ms=is,this.qs=Rs(),this.xs=new es(Qs)}function Is(){this.As=0,this.Ps=ks(),this.Vs=$i.ht,this.ps=!1,this.ys=!0}function Ts(t,e,n,i,r){this.resumeToken=t,this.ds=e,this.Ts=n,this.ws=i,this.Es=r}function As(t,e,n,i,r){this.we=t,this.as=e,this.us=n,this.cs=i,this.ls=r}function Ns(t,e,n,i,r,o,s,u){this.query=t,this.docs=e,this.ss=n,this.docChanges=i,this.ns=r,this.fromCache=o,this.rs=s,this.hs=u}function _s(){this.ts=new Yo(Qi.N)}function Ss(n){this.N=n?function(t,e){return n(t,e)||Qi.N(t.key,e.key)}:function(t,e){return Qi.N(t.key,e.key)},this.Xe=ss,this.Je=new Yo(this.N)}function Rs(){return new Yo(Qi.N)}function ks(){return new Yo(Qi.N)}var Ds={asc:"ASCENDING",desc:"DESCENDING"},Os={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Ls=(Vs.prototype.ni=function(t){var e=void 0===t.code?Ai.UNKNOWN:Qo(t.code);return new Ni(e,t.message||"")},Vs.prototype.ri=function(t){return this.options.hi||tr(t)?t:{value:t}},Vs.prototype.oi=function(t){var e;return tr(e="object"==typeof t?t.value:t)?null:e},Vs.prototype.lt=function(t){return{integerValue:""+t}},Vs.prototype._t=function(t){if(this.options.hi){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:er(t)?"-0":t}},Vs.prototype.ai=function(t){return"number"==typeof(e=t)&&Number.isInteger(e)&&!er(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER?this.lt(t):this._t(t);var e},Vs.prototype.D=function(t){return this.options.hi?new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+t.nanoseconds).slice(-9)+"Z":{seconds:""+t.seconds,nanos:t.nanoseconds}},Vs.prototype.v=function(t){var e=fr(t);return new Di(e.seconds,e.nanos)},Vs.prototype.ui=function(t){return this.options.hi?t.toBase64():t.toUint8Array()},Vs.prototype.ci=function(t){return this.options.hi?(zs(void 0===t||"string"==typeof t),$i.fromBase64String(t||"")):(zs(void 0===t||t instanceof Uint8Array),$i.fromUint8Array(t||new Uint8Array))},Vs.prototype.toVersion=function(t){return this.D(t.D())},Vs.prototype.fromVersion=function(t){return zs(!!t),Oi.v(this.v(t))},Vs.prototype.li=function(t,e){return this._i(e||this.ii).child("documents").child(t).j()},Vs.prototype.fi=function(t){var e=Vi.G(t);return zs(Ms(e)),e},Vs.prototype.di=function(t){return this.li(t.path)},Vs.prototype.Z=function(t){var e=this.fi(t);return zs(e.get(1)===this.ii.projectId),zs(!e.get(3)&&!this.ii.database||e.get(3)===this.ii.database),new Qi(this.Ti(e))},Vs.prototype.wi=function(t){return this.li(t)},Vs.prototype.Ei=function(t){var e=this.fi(t);return 4===e.length?Vi.H:this.Ti(e)},Object.defineProperty(Vs.prototype,"mi",{get:function(){return new Vi(["projects",this.ii.projectId,"databases",this.ii.database]).j()},enumerable:!0,configurable:!0}),Vs.prototype._i=function(t){return new Vi(["projects",t.projectId,"databases",t.database])},Vs.prototype.Ti=function(t){return zs(4<t.length&&"documents"===t.get(4)),t.L(5)},Vs.prototype.Ii=function(t,e){return{name:this.di(t),fields:e.proto.mapValue.fields}},Vs.prototype.Ri=function(t){return{name:this.di(t.key),fields:t.kt().mapValue.fields,updateTime:this.D(t.version.D())}},Vs.prototype.Ai=function(t,e){var n=this.Z(t.name),i=this.fromVersion(t.updateTime),r=new zr({mapValue:{fields:t.fields}});return new mo(n,i,r,{hasCommittedMutations:!!e})},Vs.prototype.Pi=function(t){zs(!!t.found),t.found.name,t.found.updateTime;var e=this.Z(t.found.name),n=this.fromVersion(t.found.updateTime),i=new zr({mapValue:{fields:t.found.fields}});return new mo(e,n,i,{})},Vs.prototype.Vi=function(t){zs(!!t.missing),zs(!!t.readTime);var e=this.Z(t.missing),n=this.fromVersion(t.readTime);return new wo(e,n)},Vs.prototype.pi=function(t){return"found"in t?this.Pi(t):"missing"in t?this.Vi(t):Bs()},Vs.prototype.yi=function(t){if("targetChange"in t){t.targetChange;var e=this.gi(t.targetChange.targetChangeType||"NO_CHANGE"),n=t.targetChange.targetIds||[],i=this.ci(t.targetChange.resumeToken),r=t.targetChange.cause,o=new ps(e,n,i,r&&this.ni(r)||null)}else if("documentChange"in t){t.documentChange;var s=t.documentChange;s.document,s.document.name,s.document.updateTime;var u=this.Z(s.document.name),a=this.fromVersion(s.document.updateTime),h=new zr({mapValue:{fields:s.document.fields}}),c=new mo(u,a,h,{});o=new fs(s.targetIds||[],s.removedTargetIds||[],c.key,c)}else if("documentDelete"in t){t.documentDelete;var f=t.documentDelete;f.document;var l=this.Z(f.document),p=f.readTime?this.fromVersion(f.readTime):Oi.min(),d=new wo(l,p);o=new fs([],f.removedTargetIds||[],d.key,d)}else if("documentRemove"in t){t.documentRemove;var y=t.documentRemove;y.document;var v=this.Z(y.document);o=new fs([],y.removedTargetIds||[],v,null)}else{if(!("filter"in t))return Bs();t.filter;var g=t.filter;g.targetId;var m=new oo(g.count||0);o=new ls(g.targetId,m)}return o},Vs.prototype.gi=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:Bs()},Vs.prototype.bi=function(t){if(!("targetChange"in t))return Oi.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length||!e.readTime?Oi.min():this.fromVersion(e.readTime)},Vs.prototype.vi=function(t){var e,n=this;if(t instanceof qr)e={update:this.Ii(t.key,t.value)};else if(t instanceof Gr)e={delete:this.di(t.key)};else if(t instanceof Fr)e={update:this.Ii(t.key,t.data),updateMask:this.Si(t.Vt)};else if(t instanceof xr)e={transform:{document:this.di(t.key),fieldTransforms:t.fieldTransforms.map(function(t){return n.Ci(t)})}};else{if(!(t instanceof Br))return Bs();e={verify:this.di(t.key)}}return t.Rt.Tt||(e.currentDocument=this.Di(t.Rt)),e},Vs.prototype.Fi=function(t){var e=this,n=t.currentDocument?this.Ni(t.currentDocument):Ur.dt();if(t.update){t.update.name;var i=this.Z(t.update.name),r=new zr({mapValue:{fields:t.update.fields}});if(t.updateMask){var o=this.$i(t.updateMask);return new Fr(i,r,o,n)}return new qr(i,r,n)}if(t.delete){var s=this.Z(t.delete);return new Gr(s,n)}if(t.transform){var u=this.Z(t.transform.document),a=t.transform.fieldTransforms.map(function(t){return e.Li(t)});return zs(!0===n.exists),new xr(u,a)}if(t.verify){var h=this.Z(t.verify);return new Br(h,n)}return Bs()},Vs.prototype.Di=function(t){return void 0!==t.updateTime?{updateTime:this.toVersion(t.updateTime)}:void 0!==t.exists?{exists:t.exists}:Bs()},Vs.prototype.Ni=function(t){return void 0!==t.updateTime?Ur.updateTime(this.fromVersion(t.updateTime)):void 0!==t.exists?Ur.exists(t.exists):Ur.dt()},Vs.prototype.ki=function(t,e){var n=t.updateTime?this.fromVersion(t.updateTime):this.fromVersion(e);n.isEqual(Oi.min())&&(n=this.fromVersion(e));var i=null;return t.transformResults&&0<t.transformResults.length&&(i=t.transformResults),new kr(n,i)},Vs.prototype.Oi=function(t,e){var n=this;return t&&0<t.length?(zs(void 0!==e),t.map(function(t){return n.ki(t,e)})):[]},Vs.prototype.Ci=function(t){var e=t.transform;if(e instanceof br)return{fieldPath:t.field.j(),setToServerValue:"REQUEST_TIME"};if(e instanceof Ir)return{fieldPath:t.field.j(),appendMissingElements:{values:e.elements}};if(e instanceof Tr)return{fieldPath:t.field.j(),removeAllFromArray:{values:e.elements}};if(e instanceof Ar)return{fieldPath:t.field.j(),increment:e.ct};throw Bs()},Vs.prototype.Li=function(t){var e,n,i=null;"setToServerValue"in t?(zs("REQUEST_TIME"===t.setToServerValue),i=br.instance):"appendMissingElements"in t?(e=t.appendMissingElements.values||[],i=new Ir(e)):"removeAllFromArray"in t?(n=t.removeAllFromArray.values||[],i=new Tr(n)):"increment"in t?i=new Ar(this,t.increment):Bs();var r=Hi.J(t.fieldPath);return new Cr(r,i)},Vs.prototype.Mi=function(t){return{documents:[this.wi(t.path)]}},Vs.prototype.qi=function(t){zs(1===t.documents.length);var e=t.documents[0];return Io.Wt(this.Ei(e)).ee()},Vs.prototype.xi=function(t){var e={structuredQuery:{}},n=t.path;null!==t.collectionGroup?(e.parent=this.wi(n),e.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(e.parent=this.wi(n.k()),e.structuredQuery.from=[{collectionId:n.M()}]);var i=this.Bi(t.filters);i&&(e.structuredQuery.where=i);var r=this.Ui(t.orderBy);r&&(e.structuredQuery.orderBy=r);var o=this.ri(t.limit);return null!==o&&(e.structuredQuery.limit=o),t.startAt&&(e.structuredQuery.startAt=this.Qi(t.startAt)),t.endAt&&(e.structuredQuery.endAt=this.Qi(t.endAt)),e},Vs.prototype.Wi=function(t){var e,n=this.Ei(t.parent),i=t.structuredQuery,r=i.from?i.from.length:0,o=null;0<r&&(zs(1===r),(e=i.from[0]).allDescendants?o=e.collectionId:n=n.child(e.collectionId));var s=[];i.where&&(s=this.ji(i.where));var u=[];i.orderBy&&(u=this.Gi(i.orderBy));var a=null;i.limit&&(a=this.oi(i.limit));var h=null;i.startAt&&(h=this.Hi(i.startAt));var c=null;return i.endAt&&(c=this.Hi(i.endAt)),new Io(n,o,u,s,a,"F",h,c).ee()},Vs.prototype.Ki=function(t){var e=this.zi(t.Te);return null==e?null:{"goog-listen-tags":e}},Vs.prototype.zi=function(t){switch(t){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Bs()}},Vs.prototype.ee=function(t){var e,n=t.target;return(e=n.Mt()?{documents:this.Mi(n)}:{query:this.xi(n)}).targetId=t.targetId,0<t.resumeToken.rt()&&(e.resumeToken=this.ui(t.resumeToken)),e},Vs.prototype.Bi=function(t){var e=this;if(0!==t.length){var n=t.map(function(t){return t instanceof To?e.Yi(t):Bs()});return 1===n.length?n[0]:{compositeFilter:{op:"AND",filters:n}}}},Vs.prototype.ji=function(t){var e=this;return t?void 0!==t.unaryFilter?[this.Xi(t)]:void 0!==t.fieldFilter?[this.Ji(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map(function(t){return e.ji(t)}).reduce(function(t,e){return t.concat(e)}):Bs():[]},Vs.prototype.Ui=function(t){var e=this;if(0!==t.length)return t.map(function(t){return e.Zi(t)})},Vs.prototype.Gi=function(t){var e=this;return t.map(function(t){return e.tn(t)})},Vs.prototype.Qi=function(t){return{before:t.before,values:t.position}},Vs.prototype.Hi=function(t){var e=!!t.before,n=t.values||[];return new ko(n,e)},Vs.prototype.en=function(t){return Ds[t]},Vs.prototype.sn=function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}},Vs.prototype.nn=function(t){return Os[t]},Vs.prototype.rn=function(t){switch(t){case"EQUAL":return"==";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return Bs()}},Vs.prototype.hn=function(t){return{fieldPath:t.j()}},Vs.prototype.on=function(t){return Hi.J(t.fieldPath)},Vs.prototype.Zi=function(t){return{field:this.hn(t.field),direction:this.en(t.dir)}},Vs.prototype.tn=function(t){return new Do(this.on(t.field),this.sn(t.direction))},Vs.prototype.Ji=function(t){return To.create(this.on(t.fieldFilter.field),this.rn(t.fieldFilter.op),t.fieldFilter.value)},Vs.prototype.Yi=function(t){if("=="===t.op){if(mr(t.value))return{unaryFilter:{field:this.hn(t.field),op:"IS_NAN"}};if(gr(t.value))return{unaryFilter:{field:this.hn(t.field),op:"IS_NULL"}}}return{fieldFilter:{field:this.hn(t.field),op:this.nn(t.op),value:t.value}}},Vs.prototype.Xi=function(t){switch(t.unaryFilter.op){case"IS_NAN":var e=this.on(t.unaryFilter.field);return To.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=this.on(t.unaryFilter.field);return To.create(n,"==",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return Bs()}},Vs.prototype.Si=function(t){var e=[];return t.fields.forEach(function(t){return e.push(t.j())}),{fieldPaths:e}},Vs.prototype.$i=function(t){var e=t.fieldPaths||[];return new Pr(e.map(function(t){return Hi.J(t)}))},Vs);function Vs(t,e){this.ii=t,this.options=e}function Ms(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}var Ps=(Us.an=function(t){Us.platform&&Bs(),Us.platform=t},Us.nt=function(){return Us.platform||Bs(),Us.platform},Us),Cs=new c("@firebase/firestore");function Us(){}function js(){return Cs.logLevel}function qs(t){Cs.logLevel=t}function Fs(t){for(var e,n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];Cs.logLevel<=u.DEBUG&&(e=n.map(Gs),Cs.debug.apply(Cs,r(["Firestore ("+mi+"): "+t],e)))}function xs(t){for(var e,n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];Cs.logLevel<=u.ERROR&&(e=n.map(Gs),Cs.error.apply(Cs,r(["Firestore ("+mi+"): "+t],e)))}function Gs(t){if("string"==typeof t)return t;var e=Ps.nt();try{return e.un(t)}catch(e){return t}}function Bs(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE ("+mi+") INTERNAL ASSERTION FAILED: "+t;throw xs(e),new Error(e)}function zs(t){t||Bs()}var Hs=(Ws.cn=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var i=Ps.nt().ln(40),r=0;r<i.length;++r)n.length<20&&i[r]<e&&(n+=t.charAt(i[r]%t.length));return n},Ws);function Ws(){}function Qs(t,e){return t<e?-1:e<t?1:0}function Ys(t,n,i){return t.length===n.length&&t.every(function(t,e){return i(t,n[e])})}function Xs(t,e,n,i,r){this.ii=t,this.persistenceKey=e,this.host=n,this.ssl=i,this.forceLongPolling=r}var Ks=(Object.defineProperty(yu.prototype,"_n",{get:function(){return"(default)"===this.database},enumerable:!0,configurable:!0}),yu.prototype.isEqual=function(t){return t instanceof yu&&t.projectId===this.projectId&&t.database===this.database},yu.prototype.S=function(t){return Qs(this.projectId,t.projectId)||Qs(this.database,t.database)},yu),Js=(du.prototype.get=function(t){var e=this.fn(t),n=this.dn[e];if(void 0!==n)for(var i=0,r=n;i<r.length;i++){var o=r[i],s=o[0],u=o[1];if(s.isEqual(t))return u}},du.prototype.has=function(t){return void 0!==this.get(t)},du.prototype.set=function(t,e){var n=this.fn(t),i=this.dn[n];if(void 0!==i){for(var r=0;r<i.length;r++)if(i[r][0].isEqual(t))return void(i[r]=[t,e]);i.push([t,e])}else this.dn[n]=[[t,e]]},du.prototype.delete=function(t){var e=this.fn(t),n=this.dn[e];if(void 0===n)return!1;for(var i=0;i<n.length;i++)if(n[i][0].isEqual(t))return 1===n.length?delete this.dn[e]:n.splice(i,1),!0;return!1},du.prototype.forEach=function(u){Ki(this.dn,function(t,e){for(var n=0,i=e;n<i.length;n++){var r=i[n],o=r[0],s=r[1];u(o,s)}})},du.prototype.q=function(){return Ji(this.dn)},du),$s=(pu.prototype.at=function(t,e,n){for(var i=n.wn,r=0;r<this.mutations.length;r++){var o,s=this.mutations[r];s.key.isEqual(t)&&(o=i[r],e=s.at(e,o))}return e},pu.prototype.ot=function(t,e){for(var n=0,i=this.baseMutations;n<i.length;n++){var r=i[n];r.key.isEqual(t)&&(e=r.ot(e,e,this.Tn))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=a.ot(e,o,this.Tn))}return e},pu.prototype.En=function(n){var i=this,r=n;return this.mutations.forEach(function(t){var e=i.ot(t.key,n.get(t.key));e&&(r=r.Re(t.key,e))}),r},pu.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},hs())},pu.prototype.isEqual=function(t){return this.batchId===t.batchId&&Ys(this.mutations,t.mutations,function(t,e){return t.isEqual(e)})&&Ys(this.baseMutations,t.baseMutations,function(t,e){return t.isEqual(e)})},pu),Zs=(lu.from=function(t,e,n,i){zs(t.mutations.length===n.length);for(var r=us,o=t.mutations,s=0;s<o.length;s++)r=r.Re(o[s].key,n[s].version);return new lu(t,e,n,i,r)},lu),tu=(fu.prototype.q=function(){return this.Rn.q()},fu.prototype.pn=function(t,e){var n=new eu(t,e);this.Rn=this.Rn.add(n),this.Pn=this.Pn.add(n)},fu.prototype.yn=function(t,e){var n=this;t.forEach(function(t){return n.pn(t,e)})},fu.prototype.gn=function(t,e){this.bn(new eu(t,e))},fu.prototype.vn=function(t,e){var n=this;t.forEach(function(t){return n.gn(t,e)})},fu.prototype.Sn=function(t){var e=this,n=Qi.EMPTY,i=new eu(n,t),r=new eu(n,t+1),o=[];return this.Pn.Ge([i,r],function(t){e.bn(t),o.push(t.key)}),o},fu.prototype.Cn=function(){var e=this;this.Rn.forEach(function(t){return e.bn(t)})},fu.prototype.bn=function(t){this.Rn=this.Rn.delete(t),this.Pn=this.Pn.delete(t)},fu.prototype.Dn=function(t){var e=Qi.EMPTY,n=new eu(e,t),i=new eu(e,t+1),r=hs();return this.Pn.Ge([n,i],function(t){r=r.add(t.key)}),r},fu.prototype.Fn=function(t){var e=new eu(t,0),n=this.Rn.Ke(e);return null!==n&&t.isEqual(n.key)},fu),eu=(cu.An=function(t,e){return Qi.N(t.key,e.key)||Qs(t.Nn,e.Nn)},cu.Vn=function(t,e){return Qs(t.Nn,e.Nn)||Qi.N(t.key,e.key)},cu),nu=(hu.prototype.catch=function(t){return this.next(void 0,t)},hu.prototype.next=function(i,r){var o=this;return this.On&&Bs(),this.On=!0,this.kn?this.error?this.Mn(r,this.error):this.qn(i,this.result):new hu(function(e,n){o.$n=function(t){o.qn(i,t).next(e,n)},o.Ln=function(t){o.Mn(r,t).next(e,n)}})},hu.prototype.xn=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},hu.prototype.Bn=function(t){try{var e=t();return e instanceof hu?e:hu.resolve(e)}catch(t){return hu.reject(t)}},hu.prototype.qn=function(t,e){return t?this.Bn(function(){return t(e)}):hu.resolve(e)},hu.prototype.Mn=function(t,e){return t?this.Bn(function(){return t(e)}):hu.reject(e)},hu.resolve=function(n){return new hu(function(t,e){t(n)})},hu.reject=function(n){return new hu(function(t,e){e(n)})},hu.Un=function(t){return new hu(function(e,n){var i=0,r=0,o=!1;t.forEach(function(t){++i,t.next(function(){++r,o&&r===i&&e()},function(t){return n(t)})}),o=!0,r===i&&e()})},hu.Qn=function(t){for(var n=hu.resolve(!1),e=function(e){n=n.next(function(t){return t?hu.resolve(t):e()})},i=0,r=t;i<r.length;i++)e(r[i]);return n},hu.forEach=function(t,n){var i=this,r=[];return t.forEach(function(t,e){r.push(n.call(i,t,e))}),this.Un(r)},hu),iu=(au.prototype.Hn=function(e,n){var i=this;return this.jn.Kn(e,n).next(function(t){return i.zn(e,n,t)})},au.prototype.zn=function(t,i,r){return this.Wn.Yn(t,i).next(function(t){for(var e=0,n=r;e<n.length;e++)t=n[e].ot(i,t);return t})},au.prototype.Xn=function(t,e,r){var o=is;return e.forEach(function(t,e){for(var n=0,i=r;n<i.length;n++)e=i[n].ot(t,e);o=o.Re(t,e)}),o},au.prototype.Jn=function(e,t){var n=this;return this.Wn.getEntries(e,t).next(function(t){return n.Zn(e,t)})},au.prototype.Zn=function(i,r){var o=this;return this.jn.tr(i,r).next(function(t){var e=o.Xn(i,r,t),n=is;return e.forEach(function(t,e){e=e||new wo(t,Oi.min()),n=n.Re(t,e)}),n})},au.prototype.er=function(t,e,n){return e.Mt()?this.sr(t,e.path):e.le()?this.ir(t,e,n):this.nr(t,e,n)},au.prototype.sr=function(t,e){return this.Hn(t,new Qi(e)).next(function(t){var e=ss;return t instanceof mo&&(e=e.Re(t.key,t)),e})},au.prototype.ir=function(n,i,r){var o=this,s=i.collectionGroup,u=ss;return this.Gn.rr(n,s).next(function(t){return nu.forEach(t,function(t){var e=i.Zt(t.child(s));return o.nr(n,e,r).next(function(t){t.forEach(function(t,e){u=u.Re(t,e)})})}).next(function(){return u})})},au.prototype.nr=function(e,n,t){var c,f,i=this;return this.Wn.er(e,n,t).next(function(t){return c=t,i.jn.hr(e,n)}).next(function(t){return f=t,i.or(e,f,c).next(function(t){c=t;for(var e=0,n=f;e<n.length;e++)for(var i=n[e],r=0,o=i.mutations;r<o.length;r++){var s=o[r],u=s.key,a=c.get(u),h=s.ot(a,a,i.Tn);c=h instanceof mo?c.Re(u,h):c.remove(u)}})}).next(function(){return c.forEach(function(t,e){n.matches(e)||(c=c.remove(t))}),c})},au.prototype.or=function(t,e,n){for(var i=hs(),r=0,o=e;r<o.length;r++)for(var s=0,u=o[r].mutations;s<u.length;s++){var a=u[s];a instanceof Fr&&null===n.get(a.key)&&(i=i.add(a.key))}var h=n;return this.Wn.getEntries(t,i).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof mo&&(h=h.Re(t,e))}),h})},au),ru=(uu.cr=function(t,e){for(var n=hs(),i=hs(),r=0,o=e.docChanges;r<o.length;r++){var s=o[r];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}}return new uu(t,e.fromCache,n,i)},uu),ou=(su.prototype._r=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},su.prototype.next=function(){var t=++this.previousValue;return this.dr&&this.dr(t),t},su);function su(t,e){var n=this;this.previousValue=t,e&&(e.lr=function(t){return n._r(t)},this.dr=function(t){return e.Tr(t)})}function uu(t,e,n,i){this.targetId=t,this.fromCache=e,this.ar=n,this.ur=i}function au(t,e,n){this.Wn=t,this.jn=e,this.Gn=n}function hu(t){var e=this;this.$n=null,this.Ln=null,this.result=void 0,this.error=void 0,this.kn=!1,this.On=!1,t(function(t){e.kn=!0,e.result=t,e.$n&&e.$n(t)},function(t){e.kn=!0,e.error=t,e.Ln&&e.Ln(t)})}function cu(t,e){this.key=t,this.Nn=e}function fu(){this.Rn=new es(eu.An),this.Pn=new es(eu.Vn)}function lu(t,e,n,i,r){this.batch=t,this.mn=e,this.wn=n,this.streamToken=i,this.In=r}function pu(t,e,n,i){this.batchId=t,this.Tn=e,this.baseMutations=n,this.mutations=i}function du(t){this.fn=t,this.dn={}}function yu(t,e){this.projectId=t,this.database=e||"(default)"}function vu(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})}ou.wr=-1;var gu=(Au.prototype.reset=function(){this.Pr=0},Au.prototype.yr=function(){this.Pr=this.Ar},Au.prototype.gr=function(t){var e=this;this.cancel();var n=Math.floor(this.Pr+this.br()),i=Math.max(0,Date.now()-this.pr),r=Math.max(0,n-i);0<r&&Fs("ExponentialBackoff","Backing off for "+r+" ms (base delay: "+this.Pr+" ms, delay with jitter: "+n+" ms, last attempt: "+i+" ms ago)"),this.Vr=this.Er.vr(this.mr,r,function(){return e.pr=Date.now(),t()}),this.Pr*=this.Rr,this.Pr<this.Ir&&(this.Pr=this.Ir),this.Pr>this.Ar&&(this.Pr=this.Ar)},Au.prototype.cancel=function(){null!==this.Vr&&(this.Vr.cancel(),this.Vr=null)},Au.prototype.br=function(){return(Math.random()-.5)*this.Pr},Au),mu=(Tu.Nr=function(t,e,n,i,r){var o=new Tu(t,e,Date.now()+n,i,r);return o.start(n),o},Tu.prototype.start=function(t){var e=this;this.$r=setTimeout(function(){return e.Lr()},t)},Tu.prototype.kr=function(){return this.Lr()},Tu.prototype.cancel=function(t){null!==this.$r&&(this.clearTimeout(),this.Fr.reject(new Ni(Ai.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},Tu.prototype.Lr=function(){var e=this;this.Sr.Or(function(){return null!==e.$r?(e.clearTimeout(),e.op().then(function(t){return e.Fr.resolve(t)})):Promise.resolve()})},Tu.prototype.clearTimeout=function(){null!==this.$r&&(this.Dr(this),clearTimeout(this.$r),this.$r=null)},Tu),wu=(Object.defineProperty(Iu.prototype,"Kr",{get:function(){return this.xr},enumerable:!0,configurable:!0}),Iu.prototype.Or=function(t){this.enqueue(t)},Iu.prototype.zr=function(t){this.Yr(),this.Xr(t)},Iu.prototype.Jr=function(t){return this.Yr(),this.Xr(t)},Iu.prototype.Zr=function(n){return l(this,void 0,void 0,function(){var e;return p(this,function(t){switch(t.label){case 0:return this.Yr(),this.xr?[3,2]:(this.xr=!0,(e=Ps.nt().window)&&e.removeEventListener("visibilitychange",this.Gr),[4,this.Jr(n)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},Iu.prototype.enqueue=function(t){return this.Yr(),this.xr?new Promise(function(t){}):this.Xr(t)},Iu.prototype.th=function(r){var t=this;this.Yr(),this.xr||(this.qr=this.qr.then(function(){var n=new vu,i=function(){return l(t,void 0,void 0,function(){var e;return p(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,r()];case 1:return t.sent(),n.resolve(),this.jr.reset(),[3,3];case 2:if("IndexedDbTransactionError"!==(e=t.sent()).name)throw n.resolve(),e;return Fs("AsyncQueue","Operation failed with retryable error: "+e),this.jr.gr(i),[3,3];case 3:return[2]}})})};return t.Or(i),n.promise}))},Iu.prototype.Xr=function(t){var e=this,n=this.Mr.then(function(){return e.Qr=!0,t().catch(function(t){throw e.Ur=t,e.Qr=!1,xs("INTERNAL UNHANDLED ERROR: ",t.stack||t.message||""),t}).then(function(t){return e.Qr=!1,t})});return this.Mr=n},Iu.prototype.vr=function(t,e,n){var i=this;this.Yr(),-1<this.Wr.indexOf(t)&&(e=0);var r=mu.Nr(this,t,e,n,function(t){return i.eh(t)});return this.Br.push(r),r},Iu.prototype.Yr=function(){this.Ur&&Bs()},Iu.prototype.sh=function(){},Iu.prototype.ih=function(){return l(this,void 0,void 0,function(){var e;return p(this,function(t){switch(t.label){case 0:return[4,e=this.Mr];case 1:t.sent(),t.label=2;case 2:if(e!==this.Mr)return[3,0];t.label=3;case 3:return[2]}})})},Iu.prototype.nh=function(t){for(var e=0,n=this.Br;e<n.length;e++)if(n[e].mr===t)return!0;return!1},Iu.prototype.Hr=function(i){var r=this;return this.ih().then(function(){r.Br.sort(function(t,e){return t.Cr-e.Cr});for(var t=0,e=r.Br;t<e.length;t++){var n=e[t];if(n.kr(),"all"!==i&&n.mr===i)break}return r.ih()})},Iu.prototype.rh=function(t){this.Wr.push(t)},Iu.prototype.eh=function(t){var e=this.Br.indexOf(t);this.Br.splice(e,1)},Iu),bu=(Eu.uh=function(t){return new Eu(t,Eu.lh,Eu._h)},Eu);function Eu(t,e,n){this.hh=t,this.oh=e,this.ah=n}function Iu(){var t=this;this.Mr=Promise.resolve(),this.qr=Promise.resolve(),this.xr=!1,this.Br=[],this.Ur=null,this.Qr=!1,this.Wr=[],this.jr=new gu(this,"async_queue_retry"),this.Gr=function(){t.Hr("async_queue_retry")};var e=Ps.nt().window;e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Gr)}function Tu(t,e,n,i,r){this.Sr=t,this.mr=e,this.Cr=n,this.op=i,this.Dr=r,this.Fr=new vu,this.then=this.Fr.promise.then.bind(this.Fr.promise),this.catch=this.Fr.promise.catch.bind(this.Fr.promise),this.Fr.promise.catch(function(t){})}function Au(t,e,n,i,r){void 0===n&&(n=1e3),void 0===i&&(i=1.5),void 0===r&&(r=6e4),this.Er=t,this.mr=e,this.Ir=n,this.Rr=i,this.Ar=r,this.Pr=0,this.Vr=null,this.pr=Date.now(),this.reset()}bu.fh=-1,bu.dh=1048576,bu.Th=41943040,bu.lh=10,bu._h=1e3,bu.wh=new bu(bu.Th,bu.lh,bu._h),bu.DISABLED=new bu(bu.fh,0,0);var Nu=(Lu.prototype.next=function(){return this.Eh+=2,this.Eh},Lu.mh=function(){return new Lu(0)},Lu.Ih=function(){return new Lu(-1)},Lu),_u=(Ou.prototype.Ah=function(t,e){return this.Rh.add(e),nu.resolve()},Ou.prototype.rr=function(t,e){return nu.resolve(this.Rh.getEntries(e))},Ou),Su=(Du.prototype.add=function(t){var e=t.M(),n=t.k(),i=this.index[e]||new es(Vi.N),r=!i.has(n);return this.index[e]=i.add(n),r},Du.prototype.has=function(t){var e=t.M(),n=t.k(),i=this.index[e];return i&&i.has(n)},Du.prototype.getEntries=function(t){return(this.index[t]||new es(Vi.N)).W()},Du),Ru=(ku.prototype.start=function(){return Promise.resolve()},ku.prototype.Oh=function(r){return l(this,void 0,void 0,function(){var e,m,n,i=this;return p(this,function(t){switch(t.label){case 0:return e=this.jn,m=this.$h,[4,this.persistence.runTransaction("Handle user change","readonly",function(v){var g;return i.jn.Mh(v).next(function(t){return g=t,e=i.persistence.Sh(r),m=new iu(i.Ch,e,i.persistence.Lh()),e.Mh(v)}).next(function(t){for(var e=[],n=[],i=hs(),r=0,o=g;r<o.length;r++){var s=o[r];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++)var h=a[u],i=i.add(h.key)}for(var c=0,f=t;c<f.length;c++){var l=f[c];n.push(l.batchId);for(var p=0,d=l.mutations;p<d.length;p++){var y=d[p];i=i.add(y.key)}}return m.Jn(v,i).next(function(t){return{qh:t,xh:e,Bh:n}})})})];case 1:return n=t.sent(),[2,(this.jn=e,this.$h=m,this.Ph.kh(this.$h),n)]}})})},ku.prototype.Uh=function(u){var a,h=this,c=Di.now(),t=u.reduce(function(t,e){return t.add(e.key)},hs());return this.persistence.runTransaction("Locally write mutations","readwrite",function(s){return h.$h.Jn(s,t).next(function(t){a=t;for(var e=[],n=0,i=u;n<i.length;n++){var r=i[n],o=r.Pt(a.get(r.key));null!=o&&e.push(new Fr(r.key,o,io(o.proto.mapValue),Ur.exists(!0)))}return h.jn.Qh(s,c,e,u)})}).then(function(t){var e=t.En(a);return{batchId:t.batchId,Wh:e}})},ku.prototype.jh=function(i){var r=this;return this.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var e=i.batch.keys(),n=r.Ch.Gh({Hh:!0});return r.jn.jh(t,i.batch,i.streamToken).next(function(){return r.Kh(t,i,n)}).next(function(){return n.apply(t)}).next(function(){return r.jn.zh(t)}).next(function(){return r.$h.Jn(t,e)})})},ku.prototype.Yh=function(t){var i=this;return this.persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return i.jn.Xh(e,t).next(function(t){return zs(null!==t),n=t.keys(),i.jn.Jh(e,t)}).next(function(){return i.jn.zh(e)}).next(function(){return i.$h.Jn(e,n)})})},ku.prototype.Zh=function(){var e=this;return this.persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.jn.Zh(t)})},ku.prototype.to=function(){var e=this;return this.persistence.runTransaction("Get last stream token","readonly",function(t){return e.jn.to(t)})},ku.prototype.eo=function(e){var n=this;return this.persistence.runTransaction("Set last stream token","readwrite-primary",function(t){return n.jn.eo(t,e)})},ku.prototype.so=function(){var e=this;return this.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.Fh.so(t)})},ku.prototype.io=function(a){var h=this,c=a.we,f=this.ph;return this.persistence.runTransaction("Apply remote event","readwrite-primary",function(o){var r=h.Ch.Gh({Hh:!0});f=h.ph;var s=[];a.as.forEach(function(t,e){var n,i,r=f.get(e);r&&(s.push(h.Fh.no(o,t.Es,e).next(function(){return h.Fh.ro(o,t.Ts,e)})),0<(n=t.resumeToken).rt()&&(i=r.me(n,c).Ee(o.ho),f=f.Re(e,i),ku.oo(r,i,t)&&s.push(h.Fh.ao(o,i))))});var t,u=is,n=hs();return a.cs.forEach(function(t,e){n=n.add(t)}),s.push(r.getEntries(o,n).next(function(i){a.cs.forEach(function(t,e){var n=i.get(t);e instanceof wo&&e.version.isEqual(Oi.min())?(r.uo(t,c),u=u.Re(t,e)):null==n||0<e.version.S(n.version)||0===e.version.S(n.version)&&n.hasPendingWrites?(r.co(e,c),u=u.Re(t,e)):Fs("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version),a.ls.has(t)&&s.push(h.persistence.vh.lo(o,t))})})),c.isEqual(Oi.min())||(t=h.Fh.so(o).next(function(t){return h.Fh._o(o,o.ho,c)}),s.push(t)),nu.Un(s).next(function(){return r.apply(o)}).next(function(){return h.$h.Zn(o,u)})}).then(function(t){return h.ph=f,t})},ku.oo=function(t,e,n){return zs(0<e.resumeToken.rt()),0===t.resumeToken.rt()||e.we.C()-t.we.C()>=this.fo||0<n.Ts.size+n.ws.size+n.Es.size},ku.prototype.do=function(t){for(var n=this,e=0,i=t;e<i.length;e++){var r,o,s,u=i[e],a=u.targetId;this.Vh.yn(u.ar,a),this.Vh.vn(u.ur,a),u.fromCache||(o=(r=this.ph.get(a)).we,s=r.Ie(o),this.ph=this.ph.Re(a,s))}return this.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(e){return nu.forEach(t,function(t){return nu.forEach(t.ur,function(t){return n.persistence.vh.gn(e,t)})})})},ku.prototype.To=function(e){var n=this;return this.persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===e&&(e=-1),n.jn.wo(t,e)})},ku.prototype.Eo=function(e){var n=this;return this.persistence.runTransaction("read document","readonly",function(t){return n.$h.Hn(t,e)})},ku.prototype.mo=function(i){var r=this;return this.persistence.runTransaction("Allocate target","readwrite",function(e){var n;return r.Fh.Io(e,i).next(function(t){return t?(n=t,nu.resolve(n)):r.Fh.Ro(e).next(function(t){return n=new Oo(i,t,0,e.ho),r.Fh.Ao(e,n).next(function(){return n})})})}).then(function(t){return null===r.ph.get(t.targetId)&&(r.ph=r.ph.Re(t.targetId,t),r.yh.set(i,t.targetId)),t})},ku.prototype.Io=function(t,e){var n=this.yh.get(e);return void 0!==n?nu.resolve(this.ph.get(n)):this.Fh.Io(t,e)},ku.prototype.Po=function(n,i){var r=this,o=this.ph.get(n),t=i?"readwrite":"readwrite-primary";return this.persistence.runTransaction("Release target",t,function(e){var t=r.Vh.Sn(n);return i?nu.resolve():nu.forEach(t,function(t){return r.persistence.vh.gn(e,t)}).next(function(){r.persistence.vh.removeTarget(e,o)})}).then(function(){r.ph=r.ph.remove(n),r.yh.delete(o.target)})},ku.prototype.Vo=function(t,n){var i=this,r=Oi.min(),o=hs();return this.persistence.runTransaction("Execute query","readonly",function(e){return i.Io(e,t.ee()).next(function(t){if(t)return r=t.lastLimboFreeSnapshotVersion,i.Fh.po(e,t.targetId).next(function(t){o=t})}).next(function(){return i.Ph.er(e,t,n?r:Oi.min(),n?o:hs())}).next(function(t){return{documents:t,yo:o}})})},ku.prototype.bo=function(e){var n=this;return this.persistence.runTransaction("Remote document keys","readonly",function(t){return n.Fh.po(t,e)})},ku.prototype.Kh=function(t,r,o){var e=this,s=r.batch,n=s.keys(),u=nu.resolve();return n.forEach(function(i){u=u.next(function(){return o.Yn(t,i)}).next(function(t){var e=t,n=r.In.get(i);zs(null!==n),(!e||e.version.S(n)<0)&&(e=s.at(i,e,r))&&o.co(e,r.mn)})}),u.next(function(){return e.jn.Jh(t,s)})},ku.prototype.vo=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.So(t,n.ph)})},ku);function ku(t,e,n){this.persistence=t,this.Ph=e,this.Vh=new tu,this.ph=new Yo(Qs),this.yh=new Js(function(t){return t.canonicalId()}),this.gh=Oi.min(),this.persistence.vh.bh(this.Vh),this.jn=t.Sh(n),this.Ch=t.Dh(),this.Fh=t.Nh(),this.$h=new iu(this.Ch,this.jn,this.persistence.Lh()),this.Ph.kh(this.$h)}function Du(){this.index={}}function Ou(){this.Rh=new Su}function Lu(t){this.Eh=t}function Vu(e){return l(this,void 0,void 0,function(){return p(this,function(t){if(e.code!==Ai.FAILED_PRECONDITION||"The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab."!==e.message)throw e;return Fs("LocalStore","Unexpectedly lost primary lease"),[2]})})}function Mu(t,e){if(0!==e.length)throw new Ni(Ai.INVALID_ARGUMENT,"Function "+t+"() does not support arguments, but was called with "+Ju(e.length,"argument")+".")}function Pu(t,e,n){if(e.length!==n)throw new Ni(Ai.INVALID_ARGUMENT,"Function "+t+"() requires "+Ju(n,"argument")+", but was called with "+Ju(e.length,"argument")+".")}function Cu(t,e,n){if(e.length<n)throw new Ni(Ai.INVALID_ARGUMENT,"Function "+t+"() requires at least "+Ju(n,"argument")+", but was called with "+Ju(e.length,"argument")+".")}function Uu(t,e,n,i){if(e.length<n||e.length>i)throw new Ni(Ai.INVALID_ARGUMENT,"Function "+t+"() requires between "+n+" and "+i+" arguments, but was called with "+Ju(e.length,"argument")+".")}function ju(t,e,n,i){Bu(t,e,Ku(n)+" argument",i)}function qu(t,e,n,i){void 0!==i&&ju(t,e,n,i)}function Fu(t,e,n,i){Bu(t,e,n+" option",i)}function xu(t,e,n,i){void 0!==i&&Fu(t,e,n,i)}function Gu(t,e,n,i,a){void 0!==i&&function(t,e,n){for(var i=[],r=0,o=a;r<o.length;r++){var s=o[r];if(s===n)return;i.push(Hu(s))}var u=Hu(n);throw new Ni(Ai.INVALID_ARGUMENT,"Invalid value "+u+" provided to function "+t+'() for option "'+e+'". Acceptable values: '+i.join(", "))}(t,n,i)}function Bu(t,e,n,i){if(!("object"===e?zu(i):"non-empty string"===e?"string"==typeof i&&""!==i:typeof i===e)){var r=Hu(i);throw new Ni(Ai.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" to be of type "+e+", but it was: "+r)}}function zu(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function Hu(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":Bs();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function Wu(t,e,n){if(void 0===n)throw new Ni(Ai.INVALID_ARGUMENT,"Function "+t+"() requires a valid "+Ku(e)+" argument, but it was undefined.")}function Qu(n,t,i){Ki(t,function(t,e){if(i.indexOf(t)<0)throw new Ni(Ai.INVALID_ARGUMENT,"Unknown option '"+t+"' passed to function "+n+"(). Available options: "+i.join(", "))})}function Yu(t,e,n,i){var r=Hu(i);return new Ni(Ai.INVALID_ARGUMENT,"Function "+t+"() requires its "+Ku(n)+" argument to be a "+e+", but it was: "+r)}function Xu(t,e,n){if(n<=0)throw new Ni(Ai.INVALID_ARGUMENT,'Function "'+t+'()" requires its '+Ku(e)+" argument to be a positive number, but it was: "+n+".")}function Ku(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function Ju(t,e){return t+" "+e+(1===t?"":"s")}function $u(){if("undefined"==typeof Uint8Array)throw new Ni(Ai.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Zu(){if(!Ps.nt().Co)throw new Ni(Ai.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}Ru.fo=3e8;var ta=(ia.fromBase64String=function(t){Pu("Blob.fromBase64String",arguments,1),ju("Blob.fromBase64String","string",1,t),Zu();try{return new ia($i.fromBase64String(t))}catch(t){throw new Ni(Ai.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},ia.fromUint8Array=function(t){if(Pu("Blob.fromUint8Array",arguments,1),$u(),!(t instanceof Uint8Array))throw Yu("Blob.fromUint8Array","Uint8Array",1,t);return new ia($i.fromUint8Array(t))},ia.prototype.toBase64=function(){return Pu("Blob.toBase64",arguments,0),Zu(),this.Do.toBase64()},ia.prototype.toUint8Array=function(){return Pu("Blob.toUint8Array",arguments,0),$u(),this.Do.toUint8Array()},ia.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},ia.prototype.isEqual=function(t){return this.Do.isEqual(t.Do)},ia),ea=(na.documentId=function(){return na.No},na.prototype.isEqual=function(t){if(!(t instanceof na))throw Yu("isEqual","FieldPath",1,t);return this.Fo.isEqual(t.Fo)},na);function na(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];!function(){if(!(t instanceof Array)||t.length<1)throw new Ni(Ai.INVALID_ARGUMENT,"Function FieldPath() requires its fieldNames argument to be an array with at least 1 element.")}();for(var n=0;n<t.length;++n)if(ju("FieldPath","string",n,t[n]),0===t[n].length)throw new Ni(Ai.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.Fo=new Hi(t)}function ia(t){Zu(),this.Do=t}ea.No=new ea(Hi.X().j());var ra,oa,sa,ua,aa,ha=new RegExp("[~\\*/\\[\\]]"),ca=function(t){this.$o=t},fa=(n(Sa,aa=ca),Sa.prototype.Ci=function(t){if(2!==t.Lo)throw 1===t.Lo?t.ko("FieldValue.delete() can only appear at the top level of your update data"):t.ko("FieldValue.delete() cannot be used with set() unless you pass {merge:true}");return t.Vt.push(t.path),null},Sa.prototype.isEqual=function(t){return t instanceof Sa},Sa),la=(n(_a,ua=ca),_a.prototype.Ci=function(t){return new Cr(t.path,br.instance)},_a.prototype.isEqual=function(t){return t instanceof _a},_a),pa=(n(Na,sa=ca),Na.prototype.Ci=function(t){var n=t.Mo({Lo:3,methodName:this.$o}),e=this.Oo.map(function(t,e){return Va(t,n.qo(e))}),i=new Ir(e);return new Cr(t.path,i)},Na.prototype.isEqual=function(t){return this===t},Na),da=(n(Aa,oa=ca),Aa.prototype.Ci=function(t){var n=t.Mo({Lo:3,methodName:this.$o}),e=this.Oo.map(function(t,e){return Va(t,n.qo(e))}),i=new Tr(e);return new Cr(t.path,i)},Aa.prototype.isEqual=function(t){return this===t},Aa),ya=(n(Ta,ra=ca),Ta.prototype.Ci=function(t){t.Mo({methodName:this.$o});var e=Va(this.xo,t),n=new Ar(t.serializer,e);return new Cr(t.path,n)},Ta.prototype.isEqual=function(t){return this===t},Ta),va=(Object.defineProperty(Ia.prototype,"latitude",{get:function(){return this.Bo},enumerable:!0,configurable:!0}),Object.defineProperty(Ia.prototype,"longitude",{get:function(){return this.Uo},enumerable:!0,configurable:!0}),Ia.prototype.isEqual=function(t){return this.Bo===t.Bo&&this.Uo===t.Uo},Ia.prototype.g=function(t){return Qs(this.Bo,t.Bo)||Qs(this.Uo,t.Uo)},Ia),ga=/^__.*__$/,ma=(Ea.prototype.Qo=function(t,e){var n=[];return null!==this.Vt?n.push(new Fr(t,this.data,this.Vt,e)):n.push(new qr(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new xr(t,this.fieldTransforms)),n},Ea),wa=(ba.prototype.Qo=function(t,e){var n=[new Fr(t,this.data,this.Vt,e)];return 0<this.fieldTransforms.length&&n.push(new xr(t,this.fieldTransforms)),n},ba);function ba(t,e,n){this.data=t,this.Vt=e,this.fieldTransforms=n}function Ea(t,e,n){this.data=t,this.Vt=e,this.fieldTransforms=n}function Ia(t,e){if(Pu("GeoPoint",arguments,2),ju("GeoPoint","number",1,t),ju("GeoPoint","number",2,e),!isFinite(t)||t<-90||90<t)throw new Ni(Ai.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new Ni(Ai.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.Bo=t,this.Uo=e}function Ta(t){var e=this;return(e=ra.call(this,"FieldValue.increment")||this).xo=t,e}function Aa(t){var e=this;return(e=oa.call(this,"FieldValue.arrayRemove")||this).Oo=t,e}function Na(t){var e=this;return(e=sa.call(this,"FieldValue.arrayUnion")||this).Oo=t,e}function _a(){return ua.call(this,"FieldValue.serverTimestamp")||this}function Sa(){return aa.call(this,"FieldValue.delete")||this}function Ra(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw Bs()}}var ka=(Object.defineProperty(La.prototype,"path",{get:function(){return this.settings.path},enumerable:!0,configurable:!0}),Object.defineProperty(La.prototype,"Lo",{get:function(){return this.settings.Lo},enumerable:!0,configurable:!0}),La.prototype.Mo=function(t){return new La(Object.assign(Object.assign({},this.settings),t),this.ii,this.serializer,this.fieldTransforms,this.Vt)},La.prototype.jo=function(t){var e=null==this.path?null:this.path.child(t),n=this.Mo({path:e,Go:!1});return n.Ho(t),n},La.prototype.Ko=function(t){var e=null==this.path?null:this.path.child(t),n=this.Mo({path:e,Go:!1});return n.Wo(),n},La.prototype.qo=function(t){return this.Mo({path:null,Go:!0})},La.prototype.ko=function(t){var e=null===this.path||this.path.q()?"":" (found in field "+this.path.toString()+")";return new Ni(Ai.INVALID_ARGUMENT,"Function "+this.settings.methodName+"() called with invalid data. "+t+e)},La.prototype.contains=function(e){return void 0!==this.Vt.find(function(t){return e.B(t)})||void 0!==this.fieldTransforms.find(function(t){return e.B(t.field)})},La.prototype.Wo=function(){if(null!==this.path)for(var t=0;t<this.path.length;t++)this.Ho(this.path.get(t))},La.prototype.Ho=function(t){if(0===t.length)throw this.ko("Document fields must not be empty");if(Ra(this.Lo)&&ga.test(t))throw this.ko('Document fields cannot begin and end with "__"')},La),Da=(Oa.prototype.Yo=function(t,e){var n=this.Xo(0,t);Ca("Data must be an object, but it was:",n,e);var i=Ma(e,n);return new ma(new zr(i),null,n.fieldTransforms)},Oa.prototype.Jo=function(t,e,n){var i=this.Xo(2,t);Ca("Data must be an object, but it was:",i,e);var r,o,s=Ma(e,i);if(n){for(var u=[],a=0,h=n;a<h.length;a++){var c=h[a],f=void 0;if(c instanceof ea)f=c.Fo;else{if("string"!=typeof c)throw Bs();f=ja(t,c)}if(!i.contains(f))throw new Ni(Ai.INVALID_ARGUMENT,"Field '"+f+"' is specified in your field mask but missing from your input data.");qa(u,f)||u.push(f)}r=new Pr(u),o=i.fieldTransforms.filter(function(t){return r.ft(t.field)})}else r=new Pr(i.Vt),o=i.fieldTransforms;return new ma(new zr(s),r,o)},Oa.prototype.Zo=function(o,t){var s=this.Xo(1,o);Ca("Data must be an object, but it was:",s,t);var u=[],a=new Hr;Ki(t,function(t,e){var n,i=ja(o,t),r=s.Ko(i);e instanceof fa?u.push(i):null!=(n=Va(e,r))&&(u.push(i),a.set(i,n))});var e=new Pr(u);return new wa(a.gt(),e,s.fieldTransforms)},Oa.prototype.ta=function(t,e,n,i){var r=this.Xo(1,t),o=[Ua(t,e)],s=[n];if(i.length%2!=0)throw new Ni(Ai.INVALID_ARGUMENT,"Function "+t+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var u=0;u<i.length;u+=2)o.push(Ua(t,i[u])),s.push(i[u+1]);for(var a,h,c,f,l=[],p=new Hr,d=o.length-1;0<=d;--d){qa(l,o[d])||(a=o[d],h=s[d],c=r.Ko(a),h instanceof fa?l.push(a):null!=(f=Va(h,c))&&(l.push(a),p.set(a,f)))}var y=new Pr(l);return new wa(p.gt(),y,r.fieldTransforms)},Oa.prototype.Xo=function(t,e){return new ka({Lo:t,methodName:e,path:Hi.H,Go:!1},this.ii,this.serializer)},Oa.prototype.ea=function(t,e,n){return void 0===n&&(n=!1),Va(e,this.Xo(n?4:3,t))},Oa);function Oa(t,e){this.ii=t,this.serializer=e||Ps.nt().zo(t)}function La(t,e,n,i,r){this.settings=t,this.ii=e,this.serializer=n,void 0===i&&this.Wo(),this.fieldTransforms=i||[],this.Vt=r||[]}function Va(s,t){if(Pa(s))return Ca("Unsupported field value:",t,s),Ma(s,t);if(s instanceof ca)return function(t,e){if(!Ra(e.Lo))throw e.ko(t.$o+"() can only be used with update() and set()");if(null===e.path)throw e.ko(t.$o+"() is not currently supported inside arrays");var n=t.Ci(e);n&&e.fieldTransforms.push(n)}(s,t),null;if(t.path&&t.Vt.push(t.path),s instanceof Array){if(t.settings.Go&&4!==t.Lo)throw t.ko("Nested arrays are not supported");return function(t){for(var e=[],n=0,i=0,r=s;i<r.length;i++){var o=Va(r[i],t.qo(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return e.serializer.ai(t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=Di.fromDate(t);return{timestampValue:e.serializer.D(n)}}if(t instanceof Di){var i=new Di(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:e.serializer.D(i)}}if(t instanceof va)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof ta)return{bytesValue:e.serializer.ui(t)};if(t instanceof nc){var r=e.ii,o=t.firestore.sa;if(!o.isEqual(r))throw e.ko("Document reference is for database "+o.projectId+"/"+o.database+" but should be for database "+r.projectId+"/"+r.database);return{referenceValue:e.serializer.li(t.ia.path,t.firestore.sa)}}throw e.ko("Unsupported field value: "+Hu(t))}(s,t)}function Ma(t,i){var r={};return Ji(t)?i.path&&0<i.path.length&&i.Vt.push(i.path):Ki(t,function(t,e){var n=Va(e,i.jo(t));null!=n&&(r[t]=n)}),{mapValue:{fields:r}}}function Pa(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Di||t instanceof va||t instanceof ta||t instanceof nc||t instanceof ca)}function Ca(t,e,n){if(!Pa(n)||!zu(n)){var i=Hu(n);throw"an object"===i?e.ko(t+" a custom object"):e.ko(t+" "+i)}}function Ua(t,e){if(e instanceof ea)return e.Fo;if("string"==typeof e)return ja(t,e);throw new Ni(Ai.INVALID_ARGUMENT,"Function "+t+"() called with invalid data. Field path arguments must be of type string or FieldPath.")}function ja(t,e){try{return function(e){if(0<=e.search(ha))throw new Ni(Ai.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(ea.bind.apply(ea,r([void 0],e.split("."))))}catch(t){throw new Ni(Ai.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e).Fo}catch(e){var n=e instanceof Error?e.message:e.toString();throw new Ni(Ai.INVALID_ARGUMENT,"Function "+t+"() called with invalid data. "+n)}}function qa(t,e){return t.some(function(t){return t.isEqual(e)})}function Fa(t){this.key=t}function xa(t){this.key=t}function Ga(t,e,n){this.query=t,this.targetId=e,this.view=n}function Ba(t){this.key=t,this.Dc=!1}function za(){this.al=void 0,this.ul=[]}var Ha,Wa,Qa,Ya,Xa=(Rh.prototype.ua=function(){return 1===this.state||2===this.state||4===this.state},Rh.prototype.ca=function(){return 2===this.state},Rh.prototype.start=function(){3!==this.state?this.auth():this.la()},Rh.prototype.stop=function(){return l(this,void 0,void 0,function(){return p(this,function(t){switch(t.label){case 0:return this.ua()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},Rh.prototype._a=function(){this.state=0,this.jr.reset()},Rh.prototype.fa=function(){var t=this;this.ca()&&null===this.aa&&(this.aa=this.Er.vr(this.na,6e4,function(){return t.da()}))},Rh.prototype.Ta=function(t){this.wa(),this.stream.send(t)},Rh.prototype.da=function(){return l(this,void 0,void 0,function(){return p(this,function(t){return this.ca()?[2,this.close(0)]:[2]})})},Rh.prototype.wa=function(){this.aa&&(this.aa.cancel(),this.aa=null)},Rh.prototype.close=function(e,n){return l(this,void 0,void 0,function(){return p(this,function(t){switch(t.label){case 0:return this.wa(),this.jr.cancel(),this.oa++,3!==e?this.jr.reset():n&&n.code===Ai.RESOURCE_EXHAUSTED?(xs(n.toString()),xs("Using maximum backoff delay to prevent overloading the backend."),this.jr.yr()):n&&n.code===Ai.UNAUTHENTICATED&&this.ha.l(),null!==this.stream&&(this.Ea(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.ma(n)];case 1:return t.sent(),[2]}})})},Rh.prototype.Ea=function(){},Rh.prototype.auth=function(){var n=this;this.state=1;var t=this.Ia(this.oa),e=this.oa;this.ha.getToken().then(function(t){n.oa===e&&n.Ra(t)},function(e){t(function(){var t=new Ni(Ai.UNKNOWN,"Fetching auth token failed: "+e.message);return n.Aa(t)})})},Rh.prototype.Ra=function(t){var e=this,n=this.Ia(this.oa);this.stream=this.Pa(t),this.stream.Va(function(){n(function(){return e.state=2,e.listener.Va()})}),this.stream.ma(function(t){n(function(){return e.Aa(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},Rh.prototype.la=function(){var t=this;this.state=4,this.jr.gr(function(){return l(t,void 0,void 0,function(){return p(this,function(t){return this.state=0,this.start(),[2]})})})},Rh.prototype.Aa=function(t){return Fs("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},Rh.prototype.Ia=function(e){var n=this;return function(t){n.Er.Or(function(){return n.oa===e?t():(Fs("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},Rh),Ka=(n(Sh,Qa=Xa),Sh.prototype.Pa=function(t){return this.ra.pa("Listen",t)},Sh.prototype.onMessage=function(t){this.jr.reset();var e=this.serializer.yi(t),n=this.serializer.bi(t);return this.listener.ya(e,n)},Sh.prototype.ga=function(t){var e={};e.database=this.serializer.mi,e.addTarget=this.serializer.ee(t);var n=this.serializer.Ki(t);n&&(e.labels=n),this.Ta(e)},Sh.prototype.ba=function(t){var e={};e.database=this.serializer.mi,e.removeTarget=t,this.Ta(e)},Sh),Ja=(n(_h,Wa=Xa),Object.defineProperty(_h.prototype,"Sa",{get:function(){return this.va},enumerable:!0,configurable:!0}),_h.prototype.start=function(){this.va=!1,Wa.prototype.start.call(this)},_h.prototype.Ea=function(){this.va&&this.Ca([])},_h.prototype.Pa=function(t){return this.ra.pa("Write",t)},_h.prototype.onMessage=function(t){if(zs(!!t.streamToken),this.lastStreamToken=this.serializer.ci(t.streamToken),this.va){this.jr.reset();var e=this.serializer.Oi(t.writeResults,t.commitTime),n=this.serializer.fromVersion(t.commitTime);return this.listener.Da(n,e)}return zs(!t.writeResults||0===t.writeResults.length),this.va=!0,this.listener.Fa()},_h.prototype.Na=function(){var t={};t.database=this.serializer.mi,this.Ta(t)},_h.prototype.Ca=function(t){var e=this,n={streamToken:this.serializer.ui(this.lastStreamToken),writes:t.map(function(t){return e.serializer.vi(t)})};this.Ta(n)},_h),$a=(n(Nh,Ha=function(){this.$a=void 0}),Nh.prototype.La=function(e,n){var i=this;return this.credentials.getToken().then(function(t){return i.ra.La(e,n,t)}).catch(function(t){throw t.code===Ai.UNAUTHENTICATED&&i.credentials.l(),t})},Nh.prototype.ka=function(e,n){var i=this;return this.credentials.getToken().then(function(t){return i.ra.ka(e,n,t)}).catch(function(t){throw t.code===Ai.UNAUTHENTICATED&&i.credentials.l(),t})},Nh),Za=(Ah.prototype.Ua=function(i){return l(this,void 0,void 0,function(){var e,n=this;return p(this,function(t){switch(t.label){case 0:if(this.Qa(),0<this.mutations.length)throw new Ni(Ai.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(s,u){return l(this,void 0,void 0,function(){var n,e,i,r,o;return p(this,function(t){switch(t.label){case 0:return e={database:(n=s).serializer.mi,documents:u.map(function(t){return n.serializer.di(t)})},[4,n.ka("BatchGetDocuments",e)];case 1:return i=t.sent(),r=new Map,i.forEach(function(t){var e=n.serializer.pi(t);r.set(e.key.toString(),e)}),o=[],[2,(u.forEach(function(t){var e=r.get(t.toString());zs(!!e),o.push(e)}),o)]}})})}(this.Oa,i)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof wo||t instanceof mo?n.Wa(t):Bs()}),e)]}})})},Ah.prototype.set=function(t,e){this.write(e.Qo(t,this.Rt(t))),this.Ba.add(t)},Ah.prototype.update=function(t,e){try{this.write(e.Qo(t,this.ja(t)))}catch(t){this.xa=t}this.Ba.add(t)},Ah.prototype.delete=function(t){this.write([new Gr(t,this.Rt(t))]),this.Ba.add(t)},Ah.prototype.commit=function(){return l(this,void 0,void 0,function(){var e,n=this;return p(this,function(t){switch(t.label){case 0:if(this.Qa(),this.xa)throw this.xa;return e=this.Ma,this.mutations.forEach(function(t){e=e.remove(t.key)}),e.forEach(function(t,e){n.mutations.push(new Br(t,n.Rt(t)))}),[4,function(r,o){return l(this,void 0,void 0,function(){var e,n,i;return p(this,function(t){switch(t.label){case 0:return n={database:(e=r).serializer.mi,writes:o.map(function(t){return e.serializer.vi(t)})},[4,e.La("Commit",n)];case 1:return i=t.sent(),[2,e.serializer.Oi(i.writeResults,i.commitTime)]}})})}(this.Oa,this.mutations)];case 1:return t.sent(),this.qa=!0,[2]}})})},Ah.prototype.Wa=function(t){var e;if(t instanceof mo)e=t.version;else{if(!(t instanceof wo))throw Bs();e=Oi.min()}var n=this.Ma.get(t.key);if(null!==n){if(!e.isEqual(n))throw new Ni(Ai.ABORTED,"Document version changed between two reads.")}else this.Ma=this.Ma.Re(t.key,e)},Ah.prototype.Rt=function(t){var e=this.Ma.get(t);return!this.Ba.has(t)&&e?Ur.updateTime(e):Ur.dt()},Ah.prototype.ja=function(t){var e=this.Ma.get(t);if(this.Ba.has(t)||!e)return Ur.exists(!0);if(e.isEqual(Oi.min()))throw new Ni(Ai.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Ur.updateTime(e)},Ah.prototype.write=function(t){this.Qa(),this.mutations=this.mutations.concat(t)},Ah.prototype.Qa=function(){},Ah),th=(Th.prototype.Ya=function(){var t=this;0===this.Ha&&(this.Xa("Unknown"),this.Ka=this.Sr.vr("online_state_timeout",1e4,function(){return t.Ka=null,t.Ja("Backend didn't respond within 10 seconds."),t.Xa("Offline"),Promise.resolve()}))},Th.prototype.Za=function(t){"Online"===this.state?this.Xa("Unknown"):(this.Ha++,1<=this.Ha&&(this.tu(),this.Ja("Connection failed 1 times. Most recent error: "+t.toString()),this.Xa("Offline")))},Th.prototype.set=function(t){this.tu(),this.Ha=0,"Online"===t&&(this.za=!1),this.Xa(t)},Th.prototype.Xa=function(t){t!==this.state&&(this.state=t,this.Ga(t))},Th.prototype.Ja=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.za?(xs(e),this.za=!1):Fs("OnlineStateTracker",e)},Th.prototype.tu=function(){null!==this.Ka&&(this.Ka.cancel(),this.Ka=null)},Th),eh=(Ih.prototype.start=function(){return this.enableNetwork()},Ih.prototype.enableNetwork=function(){return this.networkEnabled=!0,this.Iu()},Ih.prototype.Iu=function(){return l(this,void 0,void 0,function(){var e;return p(this,function(t){switch(t.label){case 0:return this.au()?(e=this.Tu,[4,this.eu.to()]):[3,3];case 1:return e.lastStreamToken=t.sent(),this.Ru()?this.Au():this.cu.set("Unknown"),[4,this.Pu()];case 2:t.sent(),t.label=3;case 3:return[2]}})})},Ih.prototype.disableNetwork=function(){return l(this,void 0,void 0,function(){return p(this,function(t){switch(t.label){case 0:return this.networkEnabled=!1,[4,this.Vu()];case 1:return t.sent(),this.cu.set("Offline"),[2]}})})},Ih.prototype.Vu=function(){return l(this,void 0,void 0,function(){return p(this,function(t){switch(t.label){case 0:return[4,this.Tu.stop()];case 1:return t.sent(),[4,this.lu.stop()];case 2:return t.sent(),0<this.su.length&&(Fs("RemoteStore","Stopping write stream with "+this.su.length+" pending writes"),this.su=[]),this.pu(),[2]}})})},Ih.prototype.yu=function(){return l(this,void 0,void 0,function(){return p(this,function(t){switch(t.label){case 0:return Fs("RemoteStore","RemoteStore shutting down."),this.networkEnabled=!1,[4,this.Vu()];case 1:return t.sent(),this.hu.yu(),this.cu.set("Unknown"),[2]}})})},Ih.prototype.listen=function(t){this.iu.has(t.targetId)||(this.iu.set(t.targetId,t),this.Ru()?this.Au():this.lu.ca()&&this.gu(t))},Ih.prototype.bu=function(t){this.iu.delete(t),this.lu.ca()&&this.vu(t),0===this.iu.size&&(this.lu.ca()?this.lu.fa():this.au()&&this.cu.set("Unknown"))},Ih.prototype.si=function(t){return this.iu.get(t)||null},Ih.prototype.ei=function(t){return this.Su.ei(t)},Ih.prototype.gu=function(t){this.nu.Ns(t.targetId),this.lu.ga(t)},Ih.prototype.vu=function(t){this.nu.Ns(t),this.lu.ba(t)},Ih.prototype.Au=function(){this.nu=new bs(this),this.lu.start(),this.cu.Ya()},Ih.prototype.Ru=function(){return this.au()&&!this.lu.ua()&&0<this.iu.size},Ih.prototype.au=function(){return!this.ru&&this.isPrimary&&this.networkEnabled},Ih.prototype.pu=function(){this.nu=null},Ih.prototype._u=function(){return l(this,void 0,void 0,function(){var n=this;return p(this,function(t){return this.iu.forEach(function(t,e){n.gu(t)}),[2]})})},Ih.prototype.fu=function(e){return l(this,void 0,void 0,function(){return p(this,function(t){return this.pu(),this.Ru()?(this.cu.Za(e),this.Au()):this.cu.set("Unknown"),[2]})})},Ih.prototype.du=function(r,o){return l(this,void 0,void 0,function(){var e,n,i;return p(this,function(t){switch(t.label){case 0:if(this.cu.set("Online"),!(r instanceof ps&&2===r.state&&r.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,this.Cu(r)];case 2:return t.sent(),[3,5];case 3:return e=t.sent(),Fs("RemoteStore","Failed to remove targets %s: %s ",r.targetIds.join(","),e),[4,this.Du(e)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(r instanceof fs?this.nu.Bs(r):r instanceof ls?this.nu.zs(r):this.nu.Ws(r),o.isEqual(Oi.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,this.eu.so()];case 8:return n=t.sent(),0<=o.S(n)?[4,this.Fu(o)]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return Fs("RemoteStore","Failed to raise snapshot:",i=t.sent()),[4,this.Du(i)];case 12:return t.sent(),[3,13];case 13:return[2]}})})},Ih.prototype.Du=function(n){return l(this,void 0,void 0,function(){var e=this;return p(this,function(t){switch(t.label){case 0:if("IndexedDbTransactionError"!==n.name)throw n;return this.ru=!0,[4,this.Vu()];case 1:return t.sent(),this.cu.set("Offline"),this.Sr.th(function(){return l(e,void 0,void 0,function(){return p(this,function(t){switch(t.label){case 0:return Fs("RemoteStore","Retrying IndexedDB access"),[4,this.eu.so()];case 1:return t.sent(),this.ru=!1,[4,this.Iu()];case 2:return t.sent(),[2]}})})}),[2]}})})},Ih.prototype.Fu=function(i){var r=this,t=this.nu.Js(i);return t.as.forEach(function(t,e){var n;0<t.resumeToken.rt()&&((n=r.iu.get(e))&&r.iu.set(e,n.me(t.resumeToken,i)))}),t.us.forEach(function(t){var e,n=r.iu.get(t);n&&(r.iu.set(t,n.me($i.ht,n.we)),r.vu(t),e=new Oo(n.target,t,1,n.sequenceNumber),r.gu(e))}),this.Su.io(t)},Ih.prototype.Cu=function(o){return l(this,void 0,void 0,function(){var e,n,i,r;return p(this,function(t){switch(t.label){case 0:e=o.cause,n=0,i=o.targetIds,t.label=1;case 1:return n<i.length?(r=i[n],this.iu.has(r)?[4,this.Su.Nu(r,e)]:[3,3]):[3,5];case 2:t.sent(),this.iu.delete(r),this.nu.removeTarget(r),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})},Ih.prototype.Pu=function(){return l(this,void 0,void 0,function(){var e,n;return p(this,function(t){switch(t.label){case 0:return this.$u()?(e=0<this.su.length?this.su[this.su.length-1].batchId:-1,[4,this.eu.To(e)]):[3,5];case 1:return null!==(n=t.sent())?[3,2]:(0===this.su.length&&this.Tu.fa(),[3,4]);case 2:return this.Lu(n),[4,this.Pu()];case 3:t.sent(),t.label=4;case 4:t.label=5;case 5:return this.ku()&&this.Ou(),[2]}})})},Ih.prototype.$u=function(){return this.au()&&this.su.length<10},Ih.prototype.Mu=function(){return this.su.length},Ih.prototype.Lu=function(t){this.su.push(t),this.Tu.ca()&&this.Tu.Sa&&this.Tu.Ca(t.mutations)},Ih.prototype.ku=function(){return this.au()&&!this.Tu.ua()&&0<this.su.length},Ih.prototype.Ou=function(){this.Tu.start()},Ih.prototype.wu=function(){return l(this,void 0,void 0,function(){return p(this,function(t){return this.Tu.Na(),[2]})})},Ih.prototype.mu=function(){var i=this;return this.eu.eo(this.Tu.lastStreamToken).then(function(){for(var t=0,e=i.su;t<e.length;t++){var n=e[t];i.Tu.Ca(n.mutations)}}).catch(Vu)},Ih.prototype.Da=function(t,e){var n=this,i=this.su.shift(),r=Zs.from(i,t,e,this.Tu.lastStreamToken);return this.Su.qu(r).then(function(){return n.Pu()})},Ih.prototype.Eu=function(e){return l(this,void 0,void 0,function(){return p(this,function(t){switch(t.label){case 0:return e&&0<this.su.length?this.Tu.Sa?[4,this.xu(e)]:[3,2]:[3,5];case 1:return t.sent(),[3,4];case 2:return[4,this.Bu(e)];case 3:t.sent(),t.label=4;case 4:this.ku()&&this.Ou(),t.label=5;case 5:return[2]}})})},Ih.prototype.Bu=function(e){return l(this,void 0,void 0,function(){return p(this,function(t){return Wo(e.code)?[2,(Fs("RemoteStore","RemoteStore error before completed handshake; resetting stream token: ",this.Tu.lastStreamToken),this.Tu.lastStreamToken=$i.ht,this.eu.eo($i.ht).catch(Vu))]:[2]})})},Ih.prototype.xu=function(r){return l(this,void 0,void 0,function(){var e,n,i=this;return p(this,function(t){return Wo(n=r.code)&&n!==Ai.ABORTED?(e=this.su.shift(),[2,(this.Tu._a(),this.Su.Uu(e.batchId,r).then(function(){return i.Pu()}))]):[2]})})},Ih.prototype.Qu=function(){return new Za(this.Oa)},Ih.prototype.uu=function(){return l(this,void 0,void 0,function(){return p(this,function(t){switch(t.label){case 0:return this.networkEnabled=!1,[4,this.Vu()];case 1:return t.sent(),this.cu.set("Unknown"),[4,this.enableNetwork()];case 2:return t.sent(),[2]}})})},Ih.prototype.Wu=function(){return l(this,void 0,void 0,function(){return p(this,function(t){switch(t.label){case 0:return this.au()?(Fs("RemoteStore","RemoteStore restarting streams for new credential"),[4,this.uu()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},Ih.prototype.ju=function(e){return l(this,void 0,void 0,function(){return p(this,function(t){switch(t.label){case 0:return(this.isPrimary=e)&&this.networkEnabled?[4,this.enableNetwork()]:[3,2];case 1:return t.sent(),[3,5];case 2:return e?[3,4]:[4,this.Vu()];case 3:t.sent(),this.cu.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})},Ih),nh=(Eh.prototype.Gu=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},Eh.prototype.Hu=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},Eh.prototype.Ku=function(){var t={activeTargetIds:this.activeTargetIds.W(),updateTimeMs:Date.now()};return JSON.stringify(t)},Eh),ih=(bh.prototype.Xu=function(t){},bh.prototype.Ju=function(t,e,n){},bh.prototype.Zu=function(t){return this.zu.Gu(t),this.Yu[t]||"not-current"},bh.prototype.tc=function(t,e,n){this.Yu[t]=e},bh.prototype.ec=function(t){this.zu.Hu(t)},bh.prototype.sc=function(t){return this.zu.activeTargetIds.has(t)},bh.prototype.ic=function(t){delete this.Yu[t]},bh.prototype.nc=function(){return this.zu.activeTargetIds},bh.prototype.rc=function(t){return this.zu.activeTargetIds.has(t)},bh.prototype.start=function(){return this.zu=new nh,Promise.resolve()},bh.prototype.Oh=function(t,e,n){},bh.prototype.hc=function(t){},bh.prototype.yu=function(){},bh.prototype.Tr=function(t){},bh),rh=(Object.defineProperty(wh.prototype,"lc",{get:function(){return this.oc},enumerable:!0,configurable:!0}),wh.prototype._c=function(t,e){var u=this,a=e?e.fc:new ys,h=e?e.cc:this.cc,c=e?e.ns:this.ns,f=h,l=!1,p=this.query.oe()&&h.size===this.query.limit?h.last():null,d=this.query.ae()&&h.size===this.query.limit?h.first():null;if(t.ye(function(t,e){var n=h.get(t),i=(i=e instanceof mo?e:null)&&(u.query.matches(i)?i:null),r=!!n&&u.ns.has(n.key),o=!!i&&(i.At||u.ns.has(i.key)&&i.hasCommittedMutations),s=!1;n&&i?n.data().isEqual(i.data())?r!==o&&(a.track({type:3,doc:i}),s=!0):u.dc(n,i)||(a.track({type:2,doc:i}),s=!0,(p&&0<u.query.se(i,p)||d&&u.query.se(i,d)<0)&&(l=!0)):!n&&i?(a.track({type:0,doc:i}),s=!0):n&&!i&&(a.track({type:1,doc:n}),s=!0,(p||d)&&(l=!0)),s&&(c=i?(f=f.add(i),o?c.add(t):c.delete(t)):(f=f.delete(t),c.delete(t)))}),this.query.oe()||this.query.ae())for(;f.size>this.query.limit;){var n=this.query.oe()?f.last():f.first(),f=f.delete(n.key),c=c.delete(n.key);a.track({type:1,doc:n})}return{cc:f,fc:a,Tc:l,ns:c}},wh.prototype.dc=function(t,e){return t.At&&e.hasCommittedMutations&&!e.At},wh.prototype.wc=function(t,e,n){var o=this,i=this.cc;this.cc=t.cc,this.ns=t.ns;var r=t.fc.es();r.sort(function(t,e){return i=t.type,r=e.type,n(i)-n(r)||o.query.se(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Bs()}}var i,r}),this.Ec(n);var s=e?this.mc():[],u=0===this.uc.size&&this.ds?1:0,a=u!==this.ac;return this.ac=u,0!==r.length||a?{snapshot:new vs(this.query,t.cc,i,r,t.ns,0==u,a,!1),Ic:s}:{Ic:s}},wh.prototype.Rc=function(t){return this.ds&&"Offline"===t?(this.ds=!1,this.wc({cc:this.cc,fc:new ys,ns:this.ns,Tc:!1},!1)):{Ic:[]}},wh.prototype.Ac=function(t){return!this.oc.has(t)&&!!this.cc.has(t)&&!this.cc.get(t).At},wh.prototype.Ec=function(t){var e=this;t&&(t.Ts.forEach(function(t){return e.oc=e.oc.add(t)}),t.ws.forEach(function(t){}),t.Es.forEach(function(t){return e.oc=e.oc.delete(t)}),this.ds=t.ds)},wh.prototype.mc=function(){var e=this;if(!this.ds)return[];var n=this.uc;this.uc=hs(),this.cc.forEach(function(t){e.Ac(t.key)&&(e.uc=e.uc.add(t.key))});var i=[];return n.forEach(function(t){e.uc.has(t)||i.push(new xa(t))}),this.uc.forEach(function(t){n.has(t)||i.push(new Fa(t))}),i},wh.prototype.Pc=function(t){this.oc=t.yo,this.uc=hs();var e=this._c(t.documents);return this.wc(e,!0)},wh.prototype.Vc=function(){return vs.os(this.query,this.cc,this.ns,0===this.ac)},wh),oh=(mh.prototype.gc=function(){this.bc()},mh.prototype.bc=function(){var t=this;this.jr.gr(function(){return l(t,void 0,void 0,function(){var e,n,i=this;return p(this,function(t){return e=this.pc.Qu(),(n=this.vc(e))&&n.then(function(t){i.Sr.Or(function(){return e.commit().then(function(){i.Fr.resolve(t)}).catch(function(t){i.Sc(t)})})}).catch(function(t){i.Sc(t)}),[2]})})})},mh.prototype.vc=function(t){try{var e=this.updateFunction(t);return!tr(e)&&e.catch&&e.then?e:(this.Fr.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.Fr.reject(t),null}},mh.prototype.Sc=function(t){var e=this;0<this.yc&&this.Cc(t)?(--this.yc,this.Sr.Or(function(){return e.bc(),Promise.resolve()})):this.Fr.reject(t)},mh.prototype.Cc=function(t){if("FirebaseError"!==t.name)return!1;var e=t.code;return"aborted"===e||"failed-precondition"===e||!Wo(e)},mh),sh=(Object.defineProperty(gh.prototype,"Wc",{get:function(){return!0},enumerable:!0,configurable:!0}),gh.prototype.subscribe=function(t){this.$c=t},gh.prototype.listen=function(s){return l(this,void 0,void 0,function(){var e,n,i,r,o;return p(this,function(t){switch(t.label){case 0:return this.jc("listen()"),(i=this.Lc.get(s))?(e=i.targetId,this.Fc.Zu(e),n=i.view.Vc(),[3,4]):[3,1];case 1:return[4,this.eu.mo(s.ee())];case 2:return r=t.sent(),o=this.Fc.Zu(r.targetId),e=r.targetId,[4,this.Gc(s,e,"current"===o)];case 3:n=t.sent(),this.Wc&&this.pc.listen(r),t.label=4;case 4:return[2,n]}})})},gh.prototype.Gc=function(u,a,h){return l(this,void 0,void 0,function(){var e,n,i,r,o,s;return p(this,function(t){switch(t.label){case 0:return[4,this.eu.Vo(u,!0)];case 1:return e=t.sent(),n=new rh(u,e.yo),i=n._c(e.documents),r=ms.fs(a,h&&"Offline"!==this.onlineState),o=n.wc(i,this.Wc,r),this.Hc(a,o.Ic),s=new Ga(u,a,n),[2,(this.Lc.set(u,s),this.kc.has(a)?this.kc.get(a).push(u):this.kc.set(a,[u]),o.snapshot)]}})})},gh.prototype.bu=function(r){return l(this,void 0,void 0,function(){var e,n,i=this;return p(this,function(t){switch(t.label){case 0:return this.jc("unlisten()"),e=this.Lc.get(r),1<(n=this.kc.get(e.targetId)).length?[2,(this.kc.set(e.targetId,n.filter(function(t){return!t.isEqual(r)})),void this.Lc.delete(r))]:this.Wc?(this.Fc.ec(e.targetId),this.Fc.rc(e.targetId)?[3,2]:[4,this.eu.Po(e.targetId,!1).then(function(){i.Fc.ic(e.targetId),i.pc.bu(e.targetId),i.Kc(e.targetId)}).catch(Vu)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return this.Kc(e.targetId),[4,this.eu.Po(e.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})},gh.prototype.write=function(i,r){return l(this,void 0,void 0,function(){var e,n;return p(this,function(t){switch(t.label){case 0:this.jc("write()"),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.eu.Uh(i)];case 2:return e=t.sent(),[3,4];case 3:if("IndexedDbTransactionError"===(n=t.sent()).name)return[2,(xs("SyncEngine","Dropping write that cannot be persisted: "+n),void r.reject(new Ni(Ai.UNAVAILABLE,"Failed to persist write: "+n)))];throw n;case 4:return this.Fc.Xu(e.batchId),this.zc(e.batchId,r),[4,this.Yc(e.Wh)];case 5:return t.sent(),[4,this.pc.Pu()];case 6:return t.sent(),[2]}})})},gh.prototype.runTransaction=function(t,e,n){new oh(t,this.pc,e,n).gc()},gh.prototype.io=function(n){return l(this,void 0,void 0,function(){var e,i=this;return p(this,function(t){switch(t.label){case 0:this.jc("applyRemoteEvent()"),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.eu.io(n)];case 2:return e=t.sent(),n.as.forEach(function(t,e){var n=i.qc.get(e);n&&(zs(t.Ts.size+t.ws.size+t.Es.size<=1),0<t.Ts.size?n.Dc=!0:0<t.ws.size?zs(n.Dc):0<t.Es.size&&(zs(n.Dc),n.Dc=!1))}),[4,this.Yc(e,n)];case 3:return t.sent(),[3,6];case 4:return[4,Vu(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},gh.prototype.Rc=function(i,t){this.jc("applyOnlineStateChange()");var r=[];this.Lc.forEach(function(t,e){var n=e.view.Rc(i);n.snapshot&&r.push(n.snapshot)}),this.$c.Xc(i),this.$c.ya(r),this.onlineState=i},gh.prototype.Nu=function(u,a){return l(this,void 0,void 0,function(){var e,n,i,r,o,s=this;return p(this,function(t){switch(t.label){case 0:return this.jc("rejectListens()"),this.Fc.tc(u,"rejected",a),e=this.qc.get(u),(n=e&&e.key)?(this.Mc=this.Mc.remove(n),this.qc.delete(u),this.Jc(),i=(i=new Yo(Qi.N)).Re(n,new wo(n,Oi.min())),r=hs().add(n),o=new gs(Oi.min(),new Map,new es(Qs),i,r),[2,this.io(o)]):[4,this.eu.Po(u,!1).then(function(){return s.Kc(u,a)}).catch(Vu)];case 1:return t.sent(),[2]}})})},gh.prototype.qu=function(i){return l(this,void 0,void 0,function(){var e,n;return p(this,function(t){switch(t.label){case 0:this.jc("applySuccessfulWrite()"),e=i.batch.batchId,this.Zc(e,null),this.tl(e),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.eu.jh(i)];case 2:return n=t.sent(),this.Fc.Ju(e,"acknowledged"),[4,this.Yc(n)];case 3:return t.sent(),[3,6];case 4:return[4,Vu(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},gh.prototype.Uu=function(n,i){return l(this,void 0,void 0,function(){var e;return p(this,function(t){switch(t.label){case 0:this.jc("rejectFailedWrite()"),this.Zc(n,i),this.tl(n),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.eu.Yh(n)];case 2:return e=t.sent(),this.Fc.Ju(n,"rejected",i),[4,this.Yc(e)];case 3:return t.sent(),[3,6];case 4:return[4,Vu(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},gh.prototype.el=function(i){return l(this,void 0,void 0,function(){var e,n;return p(this,function(t){switch(t.label){case 0:return this.pc.au()||Fs("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),[4,this.eu.Zh()];case 1:return-1===(e=t.sent())?[2,void i.resolve()]:((n=this.Uc.get(e)||[]).push(i),this.Uc.set(e,n),[2])}})})},gh.prototype.tl=function(t){(this.Uc.get(t)||[]).forEach(function(t){t.resolve()}),this.Uc.delete(t)},gh.prototype.sl=function(e){this.Uc.forEach(function(t){t.forEach(function(t){t.reject(new Ni(Ai.CANCELLED,e))})}),this.Uc.clear()},gh.prototype.zc=function(t,e){var n=(n=(n=this.Bc[this.currentUser.s()])||new Yo(Qs)).Re(t,e);this.Bc[this.currentUser.s()]=n},gh.prototype.Zc=function(t,e){var n,i=this.Bc[this.currentUser.s()];i&&((n=i.get(t))&&(e?n.reject(e):n.resolve(),i=i.remove(t)),this.Bc[this.currentUser.s()]=i)},gh.prototype.Kc=function(t,e){var n=this;void 0===e&&(e=null),this.Fc.ec(t);for(var i,r=0,o=this.kc.get(t);r<o.length;r++){var s=o[r];this.Lc.delete(s),e&&this.$c.il(s,e)}this.kc.delete(t),this.Wc&&(i=this.xc.Dn(t),this.xc.Sn(t),i.forEach(function(t){n.xc.Fn(t)||n.nl(t)}))},gh.prototype.nl=function(t){var e=this.Mc.get(t);null!==e&&(this.pc.bu(e),this.Mc=this.Mc.remove(t),this.qc.delete(e),this.Jc())},gh.prototype.Hc=function(t,e){for(var n=0,i=e;n<i.length;n++){var r=i[n];r instanceof Fa?(this.xc.pn(r.key,t),this.rl(r)):r instanceof xa?(Fs("SyncEngine","Document no longer in limbo: "+r.key),this.xc.gn(r.key,t),this.xc.Fn(r.key)||this.nl(r.key)):Bs()}},gh.prototype.rl=function(t){var e=t.key;this.Mc.get(e)||(Fs("SyncEngine","New document in limbo: "+e),this.Oc.push(e),this.Jc())},gh.prototype.Jc=function(){for(;0<this.Oc.length&&this.Mc.size<this.Nc;){var t=this.Oc.shift(),e=this.Qc.next();this.qc.set(e,new Ba(t)),this.Mc=this.Mc.Re(t,e),this.pc.listen(new Oo(Io.Wt(t.path).ee(),e,2,ou.wr))}},gh.prototype.hl=function(){return this.Mc},gh.prototype.ol=function(){return this.Oc},gh.prototype.Yc=function(i,a){return l(this,void 0,void 0,function(){var o,s,e,u=this;return p(this,function(t){switch(t.label){case 0:return o=[],s=[],e=[],this.Lc.forEach(function(t,r){e.push(Promise.resolve().then(function(){var n=r.view._c(i);return n.Tc?u.eu.Vo(r.query,!1).then(function(t){var e=t.documents;return r.view._c(e,n)}):n}).then(function(t){var e,n=a&&a.as.get(r.targetId),i=r.view.wc(t,u.Wc,n);u.Hc(r.targetId,i.Ic),i.snapshot&&(u.Wc&&u.Fc.tc(r.targetId,i.snapshot.fromCache?"not-current":"current"),o.push(i.snapshot),e=ru.cr(r.targetId,i.snapshot),s.push(e))}))}),[4,Promise.all(e)];case 1:return t.sent(),this.$c.ya(o),[4,this.eu.do(s)];case 2:return t.sent(),[2]}})})},gh.prototype.jc=function(t){},gh.prototype.Wu=function(i){return l(this,void 0,void 0,function(){var e,n;return p(this,function(t){switch(t.label){case 0:return e=!this.currentUser.isEqual(i),this.currentUser=i,e?(this.sl("'waitForPendingWrites' promise is rejected due to a user change."),[4,this.eu.Oh(i)]):[3,3];case 1:return n=t.sent(),this.Fc.Oh(i,n.xh,n.Bh),[4,this.Yc(n.qh)];case 2:t.sent(),t.label=3;case 3:return[4,this.pc.Wu()];case 4:return t.sent(),[2]}})})},gh.prototype.enableNetwork=function(){return this.pc.enableNetwork()},gh.prototype.disableNetwork=function(){return this.pc.disableNetwork()},gh.prototype.ei=function(t){var e=this.qc.get(t);if(e&&e.Dc)return hs().add(e.key);var n=hs(),i=this.kc.get(t);if(!i)return n;for(var r=0,o=i;r<o.length;r++)var s=o[r],u=this.Lc.get(s),n=n.ze(u.view.lc);return n},gh),uh=(vh.prototype.listen=function(u){return l(this,void 0,void 0,function(){var e,n,i,r,o,s;return p(this,function(t){switch(t.label){case 0:if(e=u.query,n=!1,(i=this.cl.get(e))||(n=!0,i=new za),!n)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),r=i,[4,this.Su.listen(e)];case 2:return r.al=t.sent(),[3,4];case 3:if(o=t.sent(),xs("EventManager",s="Initialization of query '"+e+"' failed: "+o),"IndexedDbTransactionError"!==o.name)throw o;return[2,void u.onError(new Ni(Ai.UNAVAILABLE,s))];case 4:return this.cl.set(e,i),i.ul.push(u),u.Rc(this.onlineState),i.al&&u._l(i.al)&&this.fl(),[2]}})})},vh.prototype.bu=function(o){return l(this,void 0,void 0,function(){var e,n,i,r;return p(this,function(t){return e=o.query,n=!1,(i=this.cl.get(e))&&0<=(r=i.ul.indexOf(o))&&(i.ul.splice(r,1),n=0===i.ul.length),n?[2,(this.cl.delete(e),this.Su.bu(e))]:[2]})})},vh.prototype.ya=function(t){for(var e=!1,n=0,i=t;n<i.length;n++){var r=i[n],o=r.query,s=this.cl.get(o);if(s){for(var u=0,a=s.ul;u<a.length;u++)a[u]._l(r)&&(e=!0);s.al=r}}e&&this.fl()},vh.prototype.il=function(t,e){var n=this.cl.get(t);if(n)for(var i=0,r=n.ul;i<r.length;i++)r[i].onError(e);this.cl.delete(t)},vh.prototype.Xc=function(r){this.onlineState=r;var o=!1;this.cl.forEach(function(t,e){for(var n=0,i=e.ul;n<i.length;n++)i[n].Rc(r)&&(o=!0)}),o&&this.fl()},vh.prototype.dl=function(t){this.ll.add(t),t.next()},vh.prototype.Tl=function(t){this.ll.delete(t)},vh.prototype.fl=function(){this.ll.forEach(function(t){t.next()})},vh),ah=(yh.prototype._l=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,i=t.docChanges;n<i.length;n++){var r=i[n];3!==r.type&&e.push(r)}t=new vs(t.query,t.docs,t.ss,e,t.ns,t.fromCache,t.rs,!0)}var o=!1;return this.El?this.Il(t)&&(this.wl.next(t),o=!0):this.Rl(t,this.onlineState)&&(this.Al(t),o=!0),this.ml=t,o},yh.prototype.onError=function(t){this.wl.error(t)},yh.prototype.Rc=function(t){this.onlineState=t;var e=!1;return this.ml&&!this.El&&this.Rl(this.ml,t)&&(this.Al(this.ml),e=!0),e},yh.prototype.Rl=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.Pl&&n||t.docs.q()&&"Offline"!==e)},yh.prototype.Il=function(t){if(0<t.docChanges.length)return!0;var e=this.ml&&this.ml.hasPendingWrites!==t.hasPendingWrites;return!(!t.rs&&!e)&&!0===this.options.includeMetadataChanges},yh.prototype.Al=function(t){t=vs.os(t.query,t.docs,t.ns,t.fromCache),this.El=!0,this.wl.next(t)},yh),hh=(dh.prototype.kh=function(t){this.Vl=t},dh.prototype.er=function(e,i,r,o){var s=this;return i.te()||r.isEqual(Oi.min())?this.pl(e,i):this.Vl.Jn(e,o).next(function(t){var n=s.yl(i,t);return(i.oe()||i.ae())&&s.Tc(i.xt,n,o,r)?s.pl(e,i):(js()<=u.DEBUG&&Fs("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),i.toString()),s.Vl.er(e,i,r).next(function(e){return n.forEach(function(t){e=e.Re(t.key,t)}),e}))})},dh.prototype.yl=function(n,t){var i=new es(function(t,e){return n.se(t,e)});return t.forEach(function(t,e){e instanceof mo&&n.matches(e)&&(i=i.add(e))}),i},dh.prototype.Tc=function(t,e,n,i){if(n.size!==e.size)return!0;var r="F"===t?e.last():e.first();return!!r&&(r.hasPendingWrites||0<r.version.S(i))},dh.prototype.pl=function(t,e){return js()<=u.DEBUG&&Fs("IndexFreeQueryEngine","Using full collection scan to execute query: %s",e.toString()),this.Vl.er(t,e,Oi.min())},dh),ch=(ph.prototype.vl=function(t){return nu.resolve(0===this.jn.length)},ph.prototype.jh=function(t,e,n){var i=e.batchId,r=this.Sl(i,"acknowledged");return zs(0===r),this.jn[r],this.lastStreamToken=n,nu.resolve()},ph.prototype.to=function(t){return nu.resolve(this.lastStreamToken)},ph.prototype.eo=function(t,e){return this.lastStreamToken=e,nu.resolve()},ph.prototype.Qh=function(t,e,n,i){var r=this.gl;this.gl++,0<this.jn.length&&this.jn[this.jn.length-1];var o=new $s(r,e,n,i);this.jn.push(o);for(var s=0,u=i;s<u.length;s++){var a=u[s];this.bl=this.bl.add(new eu(a.key,r)),this.Gn.Ah(t,a.key.path.k())}return nu.resolve(o)},ph.prototype.Xh=function(t,e){return nu.resolve(this.Cl(e))},ph.prototype.wo=function(t,e){var n=e+1,i=this.Dl(n),r=i<0?0:i;return nu.resolve(this.jn.length>r?this.jn[r]:null)},ph.prototype.Zh=function(){return nu.resolve(0===this.jn.length?-1:this.gl-1)},ph.prototype.Mh=function(t){return nu.resolve(this.jn.slice())},ph.prototype.Kn=function(t,e){var n=this,i=new eu(e,0),r=new eu(e,Number.POSITIVE_INFINITY),o=[];return this.bl.Ge([i,r],function(t){var e=n.Cl(t.Nn);o.push(e)}),nu.resolve(o)},ph.prototype.tr=function(t,e){var i=this,r=new es(Qs);return e.forEach(function(t){var e=new eu(t,0),n=new eu(t,Number.POSITIVE_INFINITY);i.bl.Ge([e,n],function(t){r=r.add(t.Nn)})}),nu.resolve(this.Fl(r))},ph.prototype.hr=function(t,e){var n=e.path,i=n.length+1,r=n;Qi.et(r)||(r=r.child(""));var o=new eu(new Qi(r),0),s=new es(Qs);return this.bl.He(function(t){var e=t.key.path;return!!n.B(e)&&(e.length===i&&(s=s.add(t.Nn)),!0)},o),nu.resolve(this.Fl(s))},ph.prototype.Fl=function(t){var n=this,i=[];return t.forEach(function(t){var e=n.Cl(t);null!==e&&i.push(e)}),i},ph.prototype.Jh=function(n,i){var r=this;zs(0===this.Sl(i.batchId,"removed")),this.jn.shift();var o=this.bl;return nu.forEach(i.mutations,function(t){var e=new eu(t.key,i.batchId);return o=o.delete(e),r.vh.Nl(n,t.key)}).next(function(){r.bl=o})},ph.prototype.$l=function(t){},ph.prototype.Fn=function(t,e){var n=new eu(e,0),i=this.bl.Ke(n);return nu.resolve(e.isEqual(i&&i.key))},ph.prototype.zh=function(t){return this.jn.length,nu.resolve()},ph.prototype.Sl=function(t,e){return this.Dl(t)},ph.prototype.Dl=function(t){return 0===this.jn.length?0:t-this.jn[0].batchId},ph.prototype.Cl=function(t){var e=this.Dl(t);return e<0||e>=this.jn.length?null:this.jn[e]},ph),fh=(lh.prototype.co=function(t,e,n){var i=e.key,r=this.docs.get(i),o=r?r.size:0,s=this.Ll(e);return this.docs=this.docs.Re(i,{kl:e,size:s,readTime:n}),this.size+=s-o,this.Gn.Ah(t,i.path.k())},lh.prototype.uo=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},lh.prototype.Yn=function(t,e){var n=this.docs.get(e);return nu.resolve(n?n.kl:null)},lh.prototype.getEntries=function(t,e){var n=this,i=is;return e.forEach(function(t){var e=n.docs.get(t);i=i.Re(t,e?e.kl:null)}),nu.resolve(i)},lh.prototype.er=function(t,e,n){for(var i=ss,r=new Qi(e.path.child("")),o=this.docs.ve(r);o.$e();){var s=o.Ne(),u=s.key,a=s.value,h=a.kl,c=a.readTime;if(!e.path.B(u.path))break;c.S(n)<=0||h instanceof mo&&e.matches(h)&&(i=i.Re(h.key,h))}return nu.resolve(i)},lh.prototype.Ol=function(t,e){return nu.forEach(this.docs,function(t){return e(t)})},lh.prototype.Gh=function(t){return new lh.Ml(this)},lh.prototype.ql=function(t){return nu.resolve(this.size)},lh);function lh(t,e){this.Gn=t,this.Ll=e,this.docs=new Yo(Qi.N),this.size=0}function ph(t,e){this.Gn=t,this.vh=e,this.jn=[],this.gl=1,this.lastStreamToken=$i.ht,this.bl=new es(eu.An)}function dh(){}function yh(t,e,n){this.query=t,this.wl=e,this.El=!1,this.ml=null,this.onlineState="Unknown",this.options=n||{}}function vh(t){this.Su=t,this.cl=new Js(function(t){return t.canonicalId()}),this.onlineState="Unknown",this.ll=new Set,this.Su.subscribe(this)}function gh(t,e,n,i,r){this.eu=t,this.pc=e,this.Fc=n,this.currentUser=i,this.Nc=r,this.$c=null,this.Lc=new Js(function(t){return t.canonicalId()}),this.kc=new Map,this.Oc=[],this.Mc=new Yo(Qi.N),this.qc=new Map,this.xc=new tu,this.Bc={},this.Uc=new Map,this.Qc=Nu.Ih(),this.onlineState="Unknown"}function mh(t,e,n,i){this.Sr=t,this.pc=e,this.updateFunction=n,this.Fr=i,this.yc=5,this.jr=new gu(this.Sr,"transaction_retry")}function wh(t,e){this.query=t,this.oc=e,this.ac=null,this.ds=!1,this.uc=hs(),this.ns=hs(),this.cc=new ds(t.se.bind(t))}function bh(){this.zu=new nh,this.Yu={},this.Su=null,this.Ga=null,this.lr=null}function Eh(){this.activeTargetIds=cs}function Ih(t,e,n,i,r){var o,s,u,a,h,c,f=this;this.eu=t,this.Oa=e,this.Sr=n,this.su=[],this.iu=new Map,this.nu=null,this.networkEnabled=!1,this.isPrimary=!1,this.ru=!1,this.hu=r,this.hu.ou(function(t){n.Or(function(){return l(f,void 0,void 0,function(){return p(this,function(t){switch(t.label){case 0:return this.au()?(Fs("RemoteStore","Restarting streams for network reachability change."),[4,this.uu()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.cu=new th(n,i),this.lu=(a=this.Oa,h=n,c={Va:this._u.bind(this),ma:this.fu.bind(this),ya:this.du.bind(this)},new Ka(h,a.ra,a.credentials,a.serializer,c)),this.Tu=(o=this.Oa,s=n,u={Va:this.wu.bind(this),ma:this.Eu.bind(this),Fa:this.mu.bind(this),Da:this.Da.bind(this)},new Ja(s,o.ra,o.credentials,o.serializer,u))}function Th(t,e){this.Sr=t,this.Ga=e,this.state="Unknown",this.Ha=0,this.Ka=null,this.za=!0}function Ah(t){this.Oa=t,this.Ma=us,this.mutations=[],this.qa=!1,this.xa=null,this.Ba=new Set}function Nh(t,e,n){var i=this;return(i=Ha.call(this)||this).ra=t,i.credentials=e,i.serializer=n,i}function _h(t,e,n,i,r){var o=this;return(o=Wa.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,r)||this).serializer=i,o.va=!1,o.lastStreamToken=$i.ht,o}function Sh(t,e,n,i,r){var o=this;return(o=Qa.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,r)||this).serializer=i,o}function Rh(t,e,n,i,r,o){this.Er=t,this.na=n,this.ra=i,this.ha=r,this.listener=o,this.state=0,this.oa=0,this.aa=null,this.stream=null,this.jr=new gu(t,e)}function kh(t){var e=this;return(e=Ya.call(this)||this).jl=t,e}function Dh(){this.Wh=new Js(function(t){return t.toString()}),this.xl=!1}fh.Ml=(Object.defineProperty(Dh.prototype,"readTime",{get:function(){return this.Bl},set:function(t){this.Bl=t},enumerable:!0,configurable:!0}),Dh.prototype.co=function(t,e){this.Ul(),this.readTime=e,this.Wh.set(t.key,t)},Dh.prototype.uo=function(t,e){this.Ul(),e&&(this.readTime=e),this.Wh.set(t,null)},Dh.prototype.Yn=function(t,e){this.Ul();var n=this.Wh.get(e);return void 0!==n?nu.resolve(n):this.Ql(t,e)},Dh.prototype.getEntries=function(t,e){return this.Wl(t,e)},Dh.prototype.apply=function(t){return this.Ul(),this.xl=!0,this.wc(t)},Dh.prototype.Ul=function(){},n(kh,Ya=Dh),kh.prototype.wc=function(n){var i=this,r=[];return this.Wh.forEach(function(t,e){e?r.push(i.jl.co(n,e,i.readTime)):i.jl.uo(t)}),nu.Un(r)},kh.prototype.Ql=function(t,e){return this.jl.Yn(t,e)},kh.prototype.Wl=function(t,e){return this.jl.getEntries(t,e)},kh);var Oh,Lh=(Wh.prototype.js=function(t,n){return this.Gl.forEach(function(t,e){return n(e)}),nu.resolve()},Wh.prototype.so=function(t){return nu.resolve(this.lastRemoteSnapshotVersion)},Wh.prototype.Yl=function(t){return nu.resolve(this.Hl)},Wh.prototype.Ro=function(t){return this.highestTargetId=this.zl.next(),nu.resolve(this.highestTargetId)},Wh.prototype._o=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.Hl&&(this.Hl=e),nu.resolve()},Wh.prototype.Xl=function(t){this.Gl.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.zl=new Nu(e),this.highestTargetId=e),t.sequenceNumber>this.Hl&&(this.Hl=t.sequenceNumber)},Wh.prototype.Ao=function(t,e){return this.Xl(e),this.targetCount+=1,nu.resolve()},Wh.prototype.ao=function(t,e){return this.Xl(e),nu.resolve()},Wh.prototype.Jl=function(t,e){return this.Gl.delete(e.target),this.Kl.Sn(e.targetId),--this.targetCount,nu.resolve()},Wh.prototype.Zl=function(n,i,r){var o=this,s=0,u=[];return this.Gl.forEach(function(t,e){e.sequenceNumber<=i&&null===r.get(e.targetId)&&(o.Gl.delete(t),u.push(o.t_(n,e.targetId)),s++)}),nu.Un(u).next(function(){return s})},Wh.prototype.e_=function(t){return nu.resolve(this.targetCount)},Wh.prototype.Io=function(t,e){var n=this.Gl.get(e)||null;return nu.resolve(n)},Wh.prototype.ro=function(e,t,n){this.Kl.yn(t,n);var i=this.persistence.vh,r=[];return i&&t.forEach(function(t){r.push(i.pn(e,t))}),nu.Un(r)},Wh.prototype.no=function(e,t,n){this.Kl.vn(t,n);var i=this.persistence.vh,r=[];return i&&t.forEach(function(t){r.push(i.gn(e,t))}),nu.Un(r)},Wh.prototype.t_=function(t,e){return this.Kl.Sn(e),nu.resolve()},Wh.prototype.po=function(t,e){var n=this.Kl.Dn(e);return nu.resolve(n)},Wh.prototype.Fn=function(t,e){return nu.resolve(this.Kl.Fn(e))},Wh),Vh=(Hh.prototype.start=function(){return Promise.resolve()},Hh.prototype.yu=function(){return this.n_=!1,Promise.resolve()},Object.defineProperty(Hh.prototype,"h_",{get:function(){return this.n_},enumerable:!0,configurable:!0}),Hh.prototype.o_=function(){},Hh.prototype.Lh=function(){return this.Gn},Hh.prototype.Sh=function(t){var e=this.s_[t.s()];return e||(e=new ch(this.Gn,this.vh),this.s_[t.s()]=e),e},Hh.prototype.Nh=function(){return this.Fh},Hh.prototype.Dh=function(){return this.Wn},Hh.prototype.runTransaction=function(t,e,n){var i=this;Fs("MemoryPersistence","Starting transaction:",t);var r=new Mh(this.i_.next());return this.vh.a_(),n(r).next(function(t){return i.vh.u_(r).next(function(){return t})}).xn().then(function(t){return r.c_(),t})},Hh.prototype.l_=function(e,n){return nu.Qn(Object.values(this.s_).map(function(t){return function(){return t.Fn(e,n)}}))},Hh),Mh=(zh.prototype.f_=function(t){this.__.push(t)},zh.prototype.c_=function(){this.__.forEach(function(t){return t()})},n(Bh,Oh=zh),Bh),Ph=(Gh.w_=function(t){return new Gh(t)},Object.defineProperty(Gh.prototype,"E_",{get:function(){if(this.T_)return this.T_;throw Bs()},enumerable:!0,configurable:!0}),Gh.prototype.bh=function(t){this.d_=t},Gh.prototype.pn=function(t,e){return this.E_.delete(e),nu.resolve()},Gh.prototype.gn=function(t,e){return this.E_.add(e),nu.resolve()},Gh.prototype.Nl=function(t,e){return this.E_.add(e),nu.resolve()},Gh.prototype.removeTarget=function(t,e){var n=this,i=this.persistence.Nh();return i.po(t,e.targetId).next(function(t){t.forEach(function(t){return n.E_.add(t)})}).next(function(){return i.Jl(t,e)})},Gh.prototype.a_=function(){this.T_=new Set},Gh.prototype.u_=function(t){var n=this,i=this.persistence.Dh().Gh();return nu.forEach(this.E_,function(e){return n.m_(t,e).next(function(t){t||i.uo(e)})}).next(function(){return n.T_=null,i.apply(t)})},Gh.prototype.lo=function(t,e){var n=this;return this.m_(t,e).next(function(t){t?n.E_.delete(e):n.E_.add(e)})},Gh.prototype.r_=function(t){return 0},Gh.prototype.m_=function(t,e){var n=this;return nu.Qn([function(){return n.persistence.Nh().Fn(t,e)},function(){return n.persistence.l_(t,e)},function(){return nu.resolve(n.d_.Fn(e))}])},Gh),Ch=(xh.prototype.initialize=function(n){return l(this,void 0,void 0,function(){var e=this;return p(this,function(t){switch(t.label){case 0:return this.Fc=this.I_(n),this.persistence=this.R_(n),[4,this.persistence.start()];case 1:return t.sent(),this.A_=this.P_(n),this.eu=this.V_(n),this.pc=this.p_(n),this.Su=this.y_(n),this.g_=this.b_(n),this.Fc.Ga=function(t){return e.Su.Rc(t,1)},this.pc.Su=this.Su,[4,this.eu.start()];case 2:return t.sent(),[4,this.Fc.start()];case 3:return t.sent(),[4,this.pc.start()];case 4:return t.sent(),[4,this.pc.ju(this.Su.Wc)];case 5:return t.sent(),[2]}})})},xh.prototype.b_=function(t){return new uh(this.Su)},xh.prototype.P_=function(t){return null},xh.prototype.V_=function(t){return new Ru(this.persistence,new hh,t.v_)},xh.prototype.R_=function(t){return new Vh(Ph.w_)},xh.prototype.p_=function(t){var e=this;return new eh(this.eu,t.Oa,t.Sr,function(t){return e.Su.Rc(t,0)},t.platform.S_())},xh.prototype.I_=function(t){return new ih},xh.prototype.y_=function(t){return new sh(this.eu,this.pc,this.Fc,t.v_,t.Nc)},xh.prototype.clearPersistence=function(t){throw new Ni(Ai.FAILED_PRECONDITION,"You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.")},xh),Uh=(Fh.prototype.start=function(e,n){var i=this;this.D_();var r=new vu,o=new vu,s=!1;return this.credentials._(function(t){if(!s)return s=!0,Fs("FirestoreClient","Initializing. user=",t.uid),i.F_(e,n,t,o).then(r.resolve,r.reject);i.Sr.Or(function(){return i.Wu(t)})}),this.Sr.Or(function(){return r.promise}),o.promise},Fh.prototype.enableNetwork=function(){var t=this;return this.D_(),this.Sr.enqueue(function(){return t.Su.enableNetwork()})},Fh.prototype.F_=function(u,a,h,c){return l(this,void 0,void 0,function(){var n,i,r,o,s=this;return p(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),[4,this.platform.N_(this.C_)];case 1:return n=t.sent(),i=this.platform.zo(this.C_.ii),e=this.credentials,r=new $a(n,e,i),[4,u.initialize({Sr:this.Sr,C_:this.C_,platform:this.platform,Oa:r,clientId:this.clientId,v_:h,Nc:100,L_:a})];case 2:return t.sent(),this.persistence=u.persistence,this.Fc=u.Fc,this.eu=u.eu,this.pc=u.pc,this.Su=u.Su,this.A_=u.A_,this.k_=u.g_,this.persistence.o_(function(){return l(s,void 0,void 0,function(){return p(this,function(t){switch(t.label){case 0:return[4,this.terminate()];case 1:return t.sent(),[2]}})})}),c.resolve(),[3,4];case 3:if(o=t.sent(),c.reject(o),!this.O_(o))throw o;return[2,(console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+o),this.F_(new Ch,{M_:!1},h,c))];case 4:return[2]}var e})})},Fh.prototype.O_=function(t){return"FirebaseError"===t.name?t.code===Ai.FAILED_PRECONDITION||t.code===Ai.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code},Fh.prototype.D_=function(){if(this.Sr.Kr)throw new Ni(Ai.FAILED_PRECONDITION,"The client has already been terminated.")},Fh.prototype.Wu=function(t){return this.Sr.sh(),Fs("FirestoreClient","Credential Changed. Current user: "+t.uid),this.Su.Wu(t)},Fh.prototype.disableNetwork=function(){var t=this;return this.D_(),this.Sr.enqueue(function(){return t.Su.disableNetwork()})},Fh.prototype.terminate=function(){var t=this;return this.Sr.Zr(function(){return l(t,void 0,void 0,function(){return p(this,function(t){switch(t.label){case 0:return this.A_&&this.A_.stop(),[4,this.pc.yu()];case 1:return t.sent(),[4,this.Fc.yu()];case 2:return t.sent(),[4,this.persistence.yu()];case 3:return t.sent(),this.credentials.T(),[2]}})})})},Fh.prototype.waitForPendingWrites=function(){var t=this;this.D_();var e=new vu;return this.Sr.Or(function(){return t.Su.el(e)}),e.promise},Fh.prototype.listen=function(t,e,n){var i=this;this.D_();var r=new ah(t,e,n);return this.Sr.Or(function(){return i.k_.listen(r)}),r},Fh.prototype.bu=function(t){var e=this;this.q_||this.Sr.Or(function(){return e.k_.bu(t)})},Fh.prototype.x_=function(t){var e=this;return this.D_(),this.Sr.enqueue(function(){return e.eu.Eo(t)}).then(function(t){if(t instanceof mo)return t;if(t instanceof wo)return null;throw new Ni(Ai.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")})},Fh.prototype.B_=function(r){var t=this;return this.D_(),this.Sr.enqueue(function(){return l(t,void 0,void 0,function(){var e,n,i;return p(this,function(t){switch(t.label){case 0:return[4,this.eu.Vo(r,!0)];case 1:return e=t.sent(),n=new rh(r,e.yo),i=n._c(e.documents),[2,n.wc(i,!1).snapshot]}})})})},Fh.prototype.write=function(t){var e=this;this.D_();var n=new vu;return this.Sr.Or(function(){return e.Su.write(t,n)}),n.promise},Fh.prototype.ii=function(){return this.C_.ii},Fh.prototype.dl=function(t){var e=this;this.D_(),this.Sr.Or(function(){return e.k_.dl(t),Promise.resolve()})},Fh.prototype.Tl=function(t){this.q_||this.k_.Tl(t)},Object.defineProperty(Fh.prototype,"q_",{get:function(){return this.Sr.Kr},enumerable:!0,configurable:!0}),Fh.prototype.transaction=function(t){var e=this;this.D_();var n=new vu;return this.Sr.Or(function(){return e.Su.runTransaction(e.Sr,t,n),Promise.resolve()}),n.promise},Fh),jh=(qh.prototype.next=function(t){this.U_(this.observer.next,t)},qh.prototype.error=function(t){this.U_(this.observer.error,t)},qh.prototype.Q_=function(){this.muted=!0},qh.prototype.U_=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},qh);function qh(t){this.observer=t,this.muted=!1}function Fh(t,e,n,i){this.platform=t,this.C_=e,this.credentials=n,this.Sr=i,this.clientId=Hs.cn()}function xh(){}function Gh(t){this.persistence=t,this.d_=null,this.T_=null}function Bh(t){var e=this;return(e=Oh.call(this)||this).ho=t,e}function zh(){this.__=[]}function Hh(t){var e=this;this.s_={},this.i_=new ou(0),this.n_=!1,this.n_=!0,this.vh=t(this),this.Fh=new Lh(this),this.Gn=new _u,this.Wn=new fh(this.Gn,function(t){return e.vh.r_(t)})}function Wh(t){this.persistence=t,this.Gl=new Js(function(t){return t.canonicalId()}),this.lastRemoteSnapshotVersion=Oi.min(),this.highestTargetId=0,this.Hl=0,this.Kl=new tu,this.targetCount=0,this.zl=Nu.mh()}function Qh(r){return function(){if("object"==typeof r&&null!==r)for(var t=r,e=0,n=["next","error","complete"];e<n.length;e++){var i=n[e];if(i in t&&"function"==typeof t[i])return 1}}()}var Yh,Xh,Kh=(bc.prototype.j_=function(t){switch(or(t)){case 0:return null;case 1:return t.booleanValue;case 2:return lr(t.integerValue||t.doubleValue);case 3:return this.G_(t.timestampValue);case 4:return this.H_(t);case 5:return t.stringValue;case 6:return new ta(pr(t.bytesValue));case 7:return this.K_(t.referenceValue);case 8:return this.z_(t.geoPointValue);case 9:return this.Y_(t.arrayValue);case 10:return this.X_(t.mapValue);default:throw Bs()}},bc.prototype.X_=function(t){var n=this,i={};return Ki(t.fields||{},function(t,e){i[t]=n.j_(e)}),i},bc.prototype.z_=function(t){return new va(lr(t.latitude),lr(t.longitude))},bc.prototype.Y_=function(t){var e=this;return(t.values||[]).map(function(t){return e.j_(t)})},bc.prototype.H_=function(t){switch(this.W_){case"previous":var e=function t(e){var n=e.mapValue.fields.__previous_value__;return nr(n)?t(n):n}(t);return null==e?null:this.j_(e);case"estimate":return this.G_(ir(t));default:return null}},bc.prototype.G_=function(t){var e=fr(t),n=new Di(e.seconds,e.nanos);return this.timestampsInSnapshots?n:n.toDate()},bc.prototype.K_=function(t){var e=Vi.G(t);zs(Ms(e));var n=new Ks(e.get(1),e.get(3)),i=new Qi(e.L(5));return n.isEqual(this.firestore.sa)||xs("Document "+i+" contains a document reference within a different database ("+n.projectId+"/"+n.database+") which is not supported. It will be treated as a reference in the current database ("+this.firestore.sa.projectId+"/"+this.firestore.sa.database+") instead."),new nc(i,this.firestore,this.converter)},bc),Jh=bu.fh,$h=(wc.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.timestampsInSnapshots===t.timestampsInSnapshots&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.forceLongPolling===t.forceLongPolling},wc),Zh=(mc.prototype.settings=function(t){Pu("Firestore.settings",arguments,1),ju("Firestore.settings","object",1,t);var e=new $h(t);if(this.ef&&!this.hf.isEqual(e))throw new Ni(Ai.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");void 0!==(this.hf=e).credentials&&(this.nf=function(t){if(!t)return new _i;switch(t.type){case"gapi":var e=t.uf;return zs(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new ki(e,t.V||"0");case"provider":return t.uf;default:throw new Ni(Ai.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(e.credentials))},mc.prototype.enableNetwork=function(){return this.tf(),this.ef.enableNetwork()},mc.prototype.disableNetwork=function(){return this.tf(),this.ef.disableNetwork()},mc.prototype.enablePersistence=function(t){var e,n;if(this.ef)throw new Ni(Ai.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var i=!1;return t&&(void 0!==t.experimentalTabSynchronization&&xs("The 'experimentalTabSynchronization' setting will be removed. Use 'synchronizeTabs' instead."),i=null!==(n=null!==(e=t.synchronizeTabs)&&void 0!==e?e:t.experimentalTabSynchronization)&&void 0!==n&&n),this.cf(this.rf,{M_:!0,cacheSizeBytes:this.hf.cacheSizeBytes,synchronizeTabs:i})},mc.prototype.clearPersistence=function(){return l(this,void 0,void 0,function(){var i,e=this;return p(this,function(t){if(void 0!==this.ef&&!this.ef.q_)throw new Ni(Ai.FAILED_PRECONDITION,"Persistence cannot be cleared after this Firestore instance is initialized.");return i=new vu,[2,(this.Z_.zr(function(){return l(e,void 0,void 0,function(){var e,n;return p(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),e=this.lf(),[4,this.rf.clearPersistence(e)];case 1:return t.sent(),i.resolve(),[3,3];case 2:return n=t.sent(),i.reject(n),[3,3];case 3:return[2]}})})}),i.promise)]})})},mc.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(mc.prototype,"_f",{get:function(){return this.tf(),this.ef.q_},enumerable:!0,configurable:!0}),mc.prototype.waitForPendingWrites=function(){return this.tf(),this.ef.waitForPendingWrites()},mc.prototype.onSnapshotsInSync=function(t){if(this.tf(),Qh(t))return this.ff(t);ju("Firestore.onSnapshotsInSync","function",1,t);var e={next:t};return this.ff(e)},mc.prototype.ff=function(t){var e=this,n=new jh({next:function(){t.next&&t.next()},error:function(t){throw Bs()}});return this.ef.dl(n),function(){n.Q_(),e.ef.Tl(n)}},mc.prototype.tf=function(){return this.ef||this.cf(new Ch,{M_:!1}),this.ef},mc.prototype.lf=function(){return new Xs(this.sa,this.if,this.hf.host,this.hf.ssl,this.hf.forceLongPolling)},mc.prototype.cf=function(t,e){var n=this.lf();return this.ef=new Uh(Ps.nt(),n,this.nf,this.Z_),this.ef.start(t,e)},mc.sf=function(t){if(e=t.options,!Object.prototype.hasOwnProperty.call(e,"projectId"))throw new Ni(Ai.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var e,n=t.options.projectId;if(!n||"string"!=typeof n)throw new Ni(Ai.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new Ks(n)},Object.defineProperty(mc.prototype,"app",{get:function(){if(!this.J_)throw new Ni(Ai.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.J_},enumerable:!0,configurable:!0}),mc.prototype.collection=function(t){return Pu("Firestore.collection",arguments,1),ju("Firestore.collection","non-empty string",1,t),this.tf(),new ac(Vi.G(t),this)},mc.prototype.doc=function(t){return Pu("Firestore.doc",arguments,1),ju("Firestore.doc","non-empty string",1,t),this.tf(),nc.df(Vi.G(t),this)},mc.prototype.collectionGroup=function(t){if(Pu("Firestore.collectionGroup",arguments,1),ju("Firestore.collectionGroup","non-empty string",1,t),0<=t.indexOf("/"))throw new Ni(Ai.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.tf(),new sc(new Io(Vi.H,t),this)},mc.prototype.runTransaction=function(e){var n=this;return Pu("Firestore.runTransaction",arguments,1),ju("Firestore.runTransaction","function",1,e),this.tf().transaction(function(t){return e(new tc(n,t))})},mc.prototype.batch=function(){return this.tf(),new ec(this)},Object.defineProperty(mc,"logLevel",{get:function(){switch(js()){case u.DEBUG:return"debug";case u.SILENT:return"silent";default:return"error"}},enumerable:!0,configurable:!0}),mc.setLogLevel=function(t){switch(Pu("Firestore.setLogLevel",arguments,1),ju("Firestore.setLogLevel","non-empty string",1,t),t){case"debug":qs(u.DEBUG);break;case"error":qs(u.ERROR);break;case"silent":qs(u.SILENT);break;default:throw new Ni(Ai.INVALID_ARGUMENT,"Invalid log level: "+t)}},mc.prototype.Tf=function(){return this.hf.timestampsInSnapshots},mc),tc=(gc.prototype.get=function(t){var n=this;Pu("Transaction.get",arguments,1);var i=Ac("Transaction.get",t,this.wf);return this.Ef.Ua([i.ia]).then(function(t){if(!t||1!==t.length)return Bs();var e=t[0];if(e instanceof wo)return new rc(n.wf,i.ia,null,!1,!1,i.mf);if(e instanceof mo)return new rc(n.wf,i.ia,e,!1,!1,i.mf);throw Bs()})},gc.prototype.set=function(t,e,n){Uu("Transaction.set",arguments,2,3);var i=Ac("Transaction.set",t,this.wf);n=Ec("Transaction.set",n);var r=Nc(i.mf,e,"Transaction.set"),o=r[0],s=r[1],u=n.merge||n.mergeFields?this.wf.af.Jo(s,o,n.mergeFields):this.wf.af.Yo(s,o);return this.Ef.set(i.ia,u),this},gc.prototype.update=function(t,e,n){for(var i,r,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return r="string"==typeof e||e instanceof ea?(Cu("Transaction.update",arguments,3),i=Ac("Transaction.update",t,this.wf),this.wf.af.ta("Transaction.update",e,n,o)):(Pu("Transaction.update",arguments,2),i=Ac("Transaction.update",t,this.wf),this.wf.af.Zo("Transaction.update",e)),this.Ef.update(i.ia,r),this},gc.prototype.delete=function(t){Pu("Transaction.delete",arguments,1);var e=Ac("Transaction.delete",t,this.wf);return this.Ef.delete(e.ia),this},gc),ec=(vc.prototype.set=function(t,e,n){Uu("WriteBatch.set",arguments,2,3),this.Af();var i=Ac("WriteBatch.set",t,this.wf);n=Ec("WriteBatch.set",n);var r=Nc(i.mf,e,"WriteBatch.set"),o=r[0],s=r[1],u=n.merge||n.mergeFields?this.wf.af.Jo(s,o,n.mergeFields):this.wf.af.Yo(s,o);return this.If=this.If.concat(u.Qo(i.ia,Ur.dt())),this},vc.prototype.update=function(t,e,n){for(var i,r,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return this.Af(),r="string"==typeof e||e instanceof ea?(Cu("WriteBatch.update",arguments,3),i=Ac("WriteBatch.update",t,this.wf),this.wf.af.ta("WriteBatch.update",e,n,o)):(Pu("WriteBatch.update",arguments,2),i=Ac("WriteBatch.update",t,this.wf),this.wf.af.Zo("WriteBatch.update",e)),this.If=this.If.concat(r.Qo(i.ia,Ur.exists(!0))),this},vc.prototype.delete=function(t){Pu("WriteBatch.delete",arguments,1),this.Af();var e=Ac("WriteBatch.delete",t,this.wf);return this.If=this.If.concat(new Gr(e.ia,Ur.dt())),this},vc.prototype.commit=function(){return this.Af(),this.Rf=!0,0<this.If.length?this.wf.tf().write(this.If):Promise.resolve()},vc.prototype.Af=function(){if(this.Rf)throw new Ni(Ai.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},vc),nc=(yc.df=function(t,e,n){if(t.length%2!=0)throw new Ni(Ai.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.j()+" has "+t.length);return new yc(new Qi(t),e,n)},Object.defineProperty(yc.prototype,"id",{get:function(){return this.ia.path.M()},enumerable:!0,configurable:!0}),Object.defineProperty(yc.prototype,"parent",{get:function(){return new ac(this.ia.path.k(),this.firestore,this.mf)},enumerable:!0,configurable:!0}),Object.defineProperty(yc.prototype,"path",{get:function(){return this.ia.path.j()},enumerable:!0,configurable:!0}),yc.prototype.collection=function(t){if(Pu("DocumentReference.collection",arguments,1),ju("DocumentReference.collection","non-empty string",1,t),!t)throw new Ni(Ai.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");var e=Vi.G(t);return new ac(this.ia.path.child(e),this.firestore)},yc.prototype.isEqual=function(t){if(!(t instanceof yc))throw Yu("isEqual","DocumentReference",1,t);return this.firestore===t.firestore&&this.ia.isEqual(t.ia)&&this.mf===t.mf},yc.prototype.set=function(t,e){Uu("DocumentReference.set",arguments,1,2),e=Ec("DocumentReference.set",e);var n=Nc(this.mf,t,"DocumentReference.set"),i=n[0],r=n[1],o=e.merge||e.mergeFields?this.firestore.af.Jo(r,i,e.mergeFields):this.firestore.af.Yo(r,i);return this.ef.write(o.Qo(this.ia,Ur.dt()))},yc.prototype.update=function(t,e){for(var n,i=[],r=2;r<arguments.length;r++)i[r-2]=arguments[r];return n="string"==typeof t||t instanceof ea?(Cu("DocumentReference.update",arguments,2),this.firestore.af.ta("DocumentReference.update",t,e,i)):(Pu("DocumentReference.update",arguments,1),this.firestore.af.Zo("DocumentReference.update",t)),this.ef.write(n.Qo(this.ia,Ur.exists(!0)))},yc.prototype.delete=function(){return Pu("DocumentReference.delete",arguments,0),this.ef.write([new Gr(this.ia,Ur.dt())])},yc.prototype.onSnapshot=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];Uu("DocumentReference.onSnapshot",arguments,1,4);var n={includeMetadataChanges:!1},i=0;"object"!=typeof t[i]||Qh(t[i])||(Qu("DocumentReference.onSnapshot",n=t[i],["includeMetadataChanges"]),xu("DocumentReference.onSnapshot","boolean","includeMetadataChanges",n.includeMetadataChanges),i++);var r={includeMetadataChanges:n.includeMetadataChanges},o=Qh(t[i])?t[i]:(ju("DocumentReference.onSnapshot","function",i,t[i]),qu("DocumentReference.onSnapshot","function",i+1,t[i+1]),qu("DocumentReference.onSnapshot","function",i+2,t[i+2]),{next:t[i],error:t[i+1],complete:t[i+2]});return this.Pf(r,o)},yc.prototype.Pf=function(t,n){var i=this,e=function(t){console.error("Uncaught Error in onSnapshot:",t)};n.error&&(e=n.error.bind(n));var r=new jh({next:function(t){var e;n.next&&(e=t.docs.get(i.ia),n.next(new rc(i.firestore,i.ia,e,t.fromCache,t.hasPendingWrites,i.mf)))},error:e}),o=this.ef.listen(Io.Wt(this.ia.path),r,t);return function(){r.Q_(),i.ef.bu(o)}},yc.prototype.get=function(n){var i=this;return Uu("DocumentReference.get",arguments,0,1),Tc("DocumentReference.get",n),new Promise(function(e,t){n&&"cache"===n.source?i.firestore.tf().x_(i.ia).then(function(t){e(new rc(i.firestore,i.ia,t,!0,t instanceof mo&&t.At,i.mf))},t):i.Vf(e,t,n)})},yc.prototype.Vf=function(e,n,i){var r=this.Pf({includeMetadataChanges:!0,Pl:!0},{next:function(t){r(),!t.exists&&t.metadata.fromCache?n(new Ni(Ai.UNAVAILABLE,"Failed to get document because the client is offline.")):t.exists&&t.metadata.fromCache&&i&&"server"===i.source?n(new Ni(Ai.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):e(t)},error:n})},yc.prototype.withConverter=function(t){return new yc(this.ia,this.firestore,t)},yc),ic=(dc.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},dc),rc=(pc.prototype.data=function(t){if(Uu("DocumentSnapshot.data",arguments,0,1),t=Ic("DocumentSnapshot.data",t),this.pf){if(this.mf){var e=new oc(this.wf,this.ia,this.pf,this.yf,this.gf);return this.mf.fromFirestore(e,t)}return new Kh(this.wf,this.wf.Tf(),t.serverTimestamps,void 0).j_(this.pf.kt())}},pc.prototype.get=function(t,e){if(Uu("DocumentSnapshot.get",arguments,1,2),e=Ic("DocumentSnapshot.get",e),this.pf){var n=this.pf.data().field(Ua("DocumentSnapshot.get",t));if(null!==n)return new Kh(this.wf,this.wf.Tf(),e.serverTimestamps,this.mf).j_(n)}},Object.defineProperty(pc.prototype,"id",{get:function(){return this.ia.path.M()},enumerable:!0,configurable:!0}),Object.defineProperty(pc.prototype,"ref",{get:function(){return new nc(this.ia,this.wf,this.mf)},enumerable:!0,configurable:!0}),Object.defineProperty(pc.prototype,"exists",{get:function(){return null!==this.pf},enumerable:!0,configurable:!0}),Object.defineProperty(pc.prototype,"metadata",{get:function(){return new ic(this.gf,this.yf)},enumerable:!0,configurable:!0}),pc.prototype.isEqual=function(t){if(!(t instanceof pc))throw Yu("isEqual","DocumentSnapshot",1,t);return this.wf===t.wf&&this.yf===t.yf&&this.ia.isEqual(t.ia)&&(null===this.pf?null===t.pf:this.pf.isEqual(t.pf))&&this.mf===t.mf},pc),oc=(n(lc,Xh=rc),lc.prototype.data=function(t){return Xh.prototype.data.call(this,t)},lc),sc=(fc.prototype.where=function(t,e,n){Pu("Query.where",arguments,3),Wu("Query.where",3,n);var i,r=function(t,e){if(!t.some(function(t){return t===e}))throw new Ni(Ai.INVALID_ARGUMENT,"Invalid value "+Hu(e)+" provided to function Query.where() for its "+Ku(2)+" argument. Acceptable values: "+t.join(", "));return e}(["<","<=","==",">=",">","array-contains","in","array-contains-any"],e),o=Ua("Query.where",t);if(o.Y()){if("array-contains"===r||"array-contains-any"===r)throw new Ni(Ai.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+r+"' queries on FieldPath.documentId().");if("in"===r){this.vf(n,r);for(var s=[],u=0,a=n;u<a.length;u++){var h=a[u];s.push(this.Sf(h))}i={arrayValue:{values:s}}}else i=this.Sf(n)}else"in"!==r&&"array-contains-any"!==r||this.vf(n,r),i=this.firestore.af.ea("Query.where",n,"in"===r);var c=To.create(o,r,i);return this.Cf(c),new fc(this.bf.Ht(c),this.firestore,this.mf)},fc.prototype.orderBy=function(t,e){var n;if(Uu("Query.orderBy",arguments,1,2),qu("Query.orderBy","non-empty string",2,e),void 0===e||"asc"===e)n="asc";else{if("desc"!==e)throw new Ni(Ai.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+e+"', expected 'asc' or 'desc'.");n="desc"}if(null!==this.bf.startAt)throw new Ni(Ai.INVALID_ARGUMENT,"Invalid query. You must not call Query.startAt() or Query.startAfter() before calling Query.orderBy().");if(null!==this.bf.endAt)throw new Ni(Ai.INVALID_ARGUMENT,"Invalid query. You must not call Query.endAt() or Query.endBefore() before calling Query.orderBy().");var i=Ua("Query.orderBy",t),r=new Do(i,n);return this.Df(r),new fc(this.bf.Kt(r),this.firestore,this.mf)},fc.prototype.limit=function(t){return Pu("Query.limit",arguments,1),ju("Query.limit","number",1,t),Xu("Query.limit",1,t),new fc(this.bf.zt(t),this.firestore,this.mf)},fc.prototype.limitToLast=function(t){return Pu("Query.limitToLast",arguments,1),ju("Query.limitToLast","number",1,t),Xu("Query.limitToLast",1,t),new fc(this.bf.Yt(t),this.firestore,this.mf)},fc.prototype.startAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Cu("Query.startAt",arguments,1);var i=this.Ff("Query.startAt",t,e,!0);return new fc(this.bf.Xt(i),this.firestore,this.mf)},fc.prototype.startAfter=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Cu("Query.startAfter",arguments,1);var i=this.Ff("Query.startAfter",t,e,!1);return new fc(this.bf.Xt(i),this.firestore,this.mf)},fc.prototype.endBefore=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Cu("Query.endBefore",arguments,1);var i=this.Ff("Query.endBefore",t,e,!0);return new fc(this.bf.Jt(i),this.firestore,this.mf)},fc.prototype.endAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Cu("Query.endAt",arguments,1);var i=this.Ff("Query.endAt",t,e,!1);return new fc(this.bf.Jt(i),this.firestore,this.mf)},fc.prototype.isEqual=function(t){if(!(t instanceof fc))throw Yu("isEqual","Query",1,t);return this.firestore===t.firestore&&this.bf.isEqual(t.bf)},fc.prototype.withConverter=function(t){return new fc(this.bf,this.firestore,t)},fc.prototype.Ff=function(t,e,n,i){if(Wu(t,1,e),e instanceof rc){if(0<n.length)throw new Ni(Ai.INVALID_ARGUMENT,"Too many arguments provided to "+t+"().");var r=e;if(!r.exists)throw new Ni(Ai.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+t+"().");return this.Nf(r.pf,i)}var o=[e].concat(n);return this.$f(t,o,i)},fc.prototype.Nf=function(t,e){for(var n=[],i=0,r=this.bf.orderBy;i<r.length;i++){var o=r[i];if(o.field.Y())n.push(dr(this.firestore.sa,t.key));else{var s=t.field(o.field);if(nr(s))throw new Ni(Ai.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+o.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===s){var u=o.field.j();throw new Ni(Ai.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.")}n.push(s)}}return new ko(n,e)},fc.prototype.$f=function(t,e,n){var i=this.bf.qt;if(e.length>i.length)throw new Ni(Ai.INVALID_ARGUMENT,"Too many arguments provided to "+t+"(). The number of arguments must be less than or equal to the number of Query.orderBy() clauses");for(var r=[],o=0;o<e.length;o++){var s=e[o];if(i[o].field.Y()){if("string"!=typeof s)throw new Ni(Ai.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+t+"(), but got a "+typeof s);if(!this.bf.le()&&-1!==s.indexOf("/"))throw new Ni(Ai.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+t+"() must be a plain document ID, but '"+s+"' contains a slash.");var u=this.bf.path.child(Vi.G(s));if(!Qi.et(u))throw new Ni(Ai.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+t+"() must result in a valid document path, but '"+u+"' is not because it contains an odd number of segments.");var a=new Qi(u);r.push(dr(this.firestore.sa,a))}else{var h=this.firestore.af.ea(t,s);r.push(h)}}return new ko(r,n)},fc.prototype.onSnapshot=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];Uu("Query.onSnapshot",arguments,1,4);var n,i={},r=0;return"object"!=typeof t[r]||Qh(t[r])||(Qu("Query.onSnapshot",i=t[r],["includeMetadataChanges"]),xu("Query.onSnapshot","boolean","includeMetadataChanges",i.includeMetadataChanges),r++),n=Qh(t[r])?t[r]:(ju("Query.onSnapshot","function",r,t[r]),qu("Query.onSnapshot","function",r+1,t[r+1]),qu("Query.onSnapshot","function",r+2,t[r+2]),{next:t[r],error:t[r+1],complete:t[r+2]}),this.Lf(this.bf),this.Pf(i,n)},fc.prototype.Pf=function(t,e){var n=this,i=function(t){console.error("Uncaught Error in onSnapshot:",t)};e.error&&(i=e.error.bind(e));var r=new jh({next:function(t){e.next&&e.next(new uc(n.firestore,n.bf,t,n.mf))},error:i}),o=this.firestore.tf(),s=o.listen(this.bf,r,t);return function(){r.Q_(),o.bu(s)}},fc.prototype.Lf=function(t){if(t.ae()&&0===t.qt.length)throw new Ni(Ai.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")},fc.prototype.get=function(n){var i=this;return Uu("Query.get",arguments,0,1),Tc("Query.get",n),this.Lf(this.bf),new Promise(function(e,t){n&&"cache"===n.source?i.firestore.tf().B_(i.bf).then(function(t){e(new uc(i.firestore,i.bf,t,i.mf))},t):i.Vf(e,t,n)})},fc.prototype.Vf=function(e,n,i){var r=this.Pf({includeMetadataChanges:!0,Pl:!0},{next:function(t){r(),t.metadata.fromCache&&i&&"server"===i.source?n(new Ni(Ai.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):e(t)},error:n})},fc.prototype.Sf=function(t){if("string"==typeof t){if(""===t)throw new Ni(Ai.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!this.bf.le()&&-1!==t.indexOf("/"))throw new Ni(Ai.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+t+"' contains a '/' character.");var e=this.bf.path.child(Vi.G(t));if(!Qi.et(e))throw new Ni(Ai.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return dr(this.firestore.sa,new Qi(e))}if(t instanceof nc)return dr(this.firestore.sa,t.ia);throw new Ni(Ai.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+Hu(t)+".")},fc.prototype.vf=function(t,e){if(!Array.isArray(t)||0===t.length)throw new Ni(Ai.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new Ni(Ai.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.");if(0<=t.indexOf(null))throw new Ni(Ai.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'null' in the value array.");if(0<t.filter(function(t){return Number.isNaN(t)}).length)throw new Ni(Ai.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'NaN' in the value array.")},fc.prototype.Cf=function(t){if(t instanceof To){var e=["array-contains","array-contains-any"],n=["in","array-contains-any"],i=0<=e.indexOf(t.op),r=0<=n.indexOf(t.op);if(t.ue()){var o=this.bf.jt();if(null!==o&&!o.isEqual(t.field))throw new Ni(Ai.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+o.toString()+"' and '"+t.field.toString()+"'");var s=this.bf.Gt();null!==s&&this.kf(t.field,s)}else if(r||i){var u=null;if(r&&(u=this.bf.ce(n)),null===u&&i&&(u=this.bf.ce(e)),null!=u)throw u===t.op?new Ni(Ai.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+t.op.toString()+"' filter."):new Ni(Ai.INVALID_ARGUMENT,"Invalid query. You cannot use '"+t.op.toString()+"' filters with '"+u.toString()+"' filters.")}}},fc.prototype.Df=function(t){var e;null!==this.bf.Gt()||null!==(e=this.bf.jt())&&this.kf(e,t.field)},fc.prototype.kf=function(t,e){if(!e.isEqual(t))throw new Ni(Ai.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+t.toString()+"' and so you must also use '"+t.toString()+"' as your first Query.orderBy(), but your first Query.orderBy() is on field '"+e.toString()+"' instead.")},fc),uc=(Object.defineProperty(cc.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!0,configurable:!0}),Object.defineProperty(cc.prototype,"empty",{get:function(){return this.Mf.docs.q()},enumerable:!0,configurable:!0}),Object.defineProperty(cc.prototype,"size",{get:function(){return this.Mf.docs.size},enumerable:!0,configurable:!0}),cc.prototype.forEach=function(e,n){var i=this;Uu("QuerySnapshot.forEach",arguments,1,2),ju("QuerySnapshot.forEach","function",1,e),this.Mf.docs.forEach(function(t){e.call(n,i.Bf(t))})},Object.defineProperty(cc.prototype,"query",{get:function(){return new sc(this.Of,this.wf,this.mf)},enumerable:!0,configurable:!0}),cc.prototype.docChanges=function(t){t&&(Qu("QuerySnapshot.docChanges",t,["includeMetadataChanges"]),xu("QuerySnapshot.docChanges","boolean","includeMetadataChanges",t.includeMetadataChanges));var e=!(!t||!t.includeMetadataChanges);if(e&&this.Mf.hs)throw new Ni(Ai.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.qf&&this.xf===e||(this.qf=function(r,e,o,s){if(o.ss.q()){var n=0;return o.docChanges.map(function(t){var e=new oc(r,t.doc.key,t.doc,o.fromCache,o.ns.has(t.doc.key),s);return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var u=o.ss;return o.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=new oc(r,t.doc.key,t.doc,o.fromCache,o.ns.has(t.doc.key),s),n=-1,i=-1;return 0!==t.type&&(n=u.indexOf(t.doc.key),u=u.delete(t.doc.key)),1!==t.type&&(i=(u=u.add(t.doc)).indexOf(t.doc.key)),{type:function(){switch(t.type){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Bs()}}(),doc:e,oldIndex:n,newIndex:i}})}(this.wf,e,this.Mf,this.mf),this.xf=e),this.qf},cc.prototype.isEqual=function(t){if(!(t instanceof cc))throw Yu("isEqual","QuerySnapshot",1,t);return this.wf===t.wf&&this.Of.isEqual(t.Of)&&this.Mf.isEqual(t.Mf)&&this.mf===t.mf},cc.prototype.Bf=function(t){return new oc(this.wf,t.key,t,this.metadata.fromCache,this.Mf.ns.has(t.key),this.mf)},cc),ac=(n(hc,Yh=sc),Object.defineProperty(hc.prototype,"id",{get:function(){return this.bf.path.M()},enumerable:!0,configurable:!0}),Object.defineProperty(hc.prototype,"parent",{get:function(){var t=this.bf.path.k();return t.q()?null:new nc(new Qi(t),this.firestore)},enumerable:!0,configurable:!0}),Object.defineProperty(hc.prototype,"path",{get:function(){return this.bf.path.j()},enumerable:!0,configurable:!0}),hc.prototype.doc=function(t){if(Uu("CollectionReference.doc",arguments,0,1),0===arguments.length&&(t=Hs.cn()),ju("CollectionReference.doc","non-empty string",1,t),""===t)throw new Ni(Ai.INVALID_ARGUMENT,"Document path must be a non-empty string");var e=Vi.G(t);return nc.df(this.bf.path.child(e),this.firestore,this.mf)},hc.prototype.add=function(t){Pu("CollectionReference.add",arguments,1),ju("CollectionReference.add","object",1,this.mf?this.mf.toFirestore(t):t);var e=this.doc();return e.set(t).then(function(){return e})},hc.prototype.withConverter=function(t){return new hc(this.Uf,this.firestore,t)},hc);function hc(t,e,n){var i=this;if(((i=Yh.call(this,Io.Wt(t),e,n)||this).Uf=t).length%2!=1)throw new Ni(Ai.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t.j()+" has "+t.length);return i}function cc(t,e,n,i){this.wf=t,this.Of=e,this.Mf=n,this.mf=i,this.qf=null,this.xf=null,this.metadata=new ic(n.hasPendingWrites,n.fromCache)}function fc(t,e,n){this.bf=t,this.firestore=e,this.mf=n}function lc(){return null!==Xh&&Xh.apply(this,arguments)||this}function pc(t,e,n,i,r,o){this.wf=t,this.ia=e,this.pf=n,this.yf=i,this.gf=r,this.mf=o}function dc(t,e){this.hasPendingWrites=t,this.fromCache=e}function yc(t,e,n){this.ia=t,this.firestore=e,this.mf=n,this.ef=this.firestore.tf()}function vc(t){this.wf=t,this.If=[],this.Rf=!1}function gc(t,e){this.wf=t,this.Ef=e}function mc(t,e,n){var i=this;if(void 0===n&&(n=new Ch),this.J_=null,this.Z_=new wu,this.INTERNAL={delete:function(){return l(i,void 0,void 0,function(){return p(this,function(t){switch(t.label){case 0:return this.tf(),[4,this.ef.terminate()];case 1:return t.sent(),[2]}})})}},"object"==typeof t.options){var r=t;this.J_=r,this.sa=mc.sf(r),this.if=r.name,this.nf=new Si(e)}else{var o=t;if(!o.projectId)throw new Ni(Ai.INVALID_ARGUMENT,"Must provide projectId");this.sa=new Ks(o.projectId,o.database),this.if="[DEFAULT]",this.nf=new _i}this.rf=n,this.hf=new $h({}),this.af=new Da(this.sa)}function wc(t){var e,n;if(void 0===t.host){if(void 0!==t.ssl)throw new Ni(Ai.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else Fu("settings","non-empty string","host",t.host),this.host=t.host,xu("settings","boolean","ssl",t.ssl),this.ssl=null===(e=t.ssl)||void 0===e||e;if(Qu("settings",t,["host","ssl","credentials","timestampsInSnapshots","cacheSizeBytes","experimentalForceLongPolling"]),xu("settings","object","credentials",t.credentials),this.credentials=t.credentials,xu("settings","boolean","timestampsInSnapshots",t.timestampsInSnapshots),!0===t.timestampsInSnapshots?xs("The setting 'timestampsInSnapshots: true' is no longer required and should be removed."):!1===t.timestampsInSnapshots&&xs("Support for 'timestampsInSnapshots: false' will be removed soon. You must update your code to handle Timestamp objects."),this.timestampsInSnapshots=null===(n=t.timestampsInSnapshots)||void 0===n||n,xu("settings","number","cacheSizeBytes",t.cacheSizeBytes),void 0===t.cacheSizeBytes)this.cacheSizeBytes=bu.Th;else{if(t.cacheSizeBytes!==Jh&&t.cacheSizeBytes<bu.dh)throw new Ni(Ai.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+bu.dh);this.cacheSizeBytes=t.cacheSizeBytes}xu("settings","boolean","experimentalForceLongPolling",t.experimentalForceLongPolling),this.forceLongPolling=void 0!==t.experimentalForceLongPolling&&t.experimentalForceLongPolling}function bc(t,e,n,i){this.firestore=t,this.timestampsInSnapshots=e,this.W_=n,this.converter=i}function Ec(t,e){if(void 0===e)return{merge:!1};if(Qu(t,e,["merge","mergeFields"]),xu(t,"boolean","merge",e.merge),void 0!==(n=e.mergeFields)&&function(t,e,n){if(!(n instanceof Array))throw new Ni(Ai.INVALID_ARGUMENT,"Function "+t+"() requires its "+e+" option to be an array, but it was: "+Hu(n));for(var i,r=0;r<n.length;++r)if(!("string"==typeof(i=n[r])||i instanceof ea))throw new Ni(Ai.INVALID_ARGUMENT,"Function "+t+"() requires all "+e+" elements to be a string or a FieldPath, but the value at index "+r+" was: "+Hu(n[r]))}(t,"mergeFields",n),void 0!==e.mergeFields&&void 0!==e.merge)throw new Ni(Ai.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');var n;return e}function Ic(t,e){return void 0===e?{}:(Qu(t,e,["serverTimestamps"]),Gu(t,0,"serverTimestamps",e.serverTimestamps,["estimate","previous","none"]),e)}function Tc(t,e){qu(t,"object",1,e),e&&(Qu(t,e,["source"]),Gu(t,0,"source",e.source,["default","server","cache"]))}function Ac(t,e,n){if(e instanceof nc){if(e.firestore!==n)throw new Ni(Ai.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}throw Yu(t,"DocumentReference",1,e)}function Nc(t,e,n){var i;return t?(i=t.toFirestore(e),n="toFirestore() in "+n):i=e,[i,n]}function _c(t,e){function n(){var t="This constructor is private.";throw e&&(t+=" ",t+=e),new Ni(Ai.INVALID_ARGUMENT,t)}return n.prototype=t.prototype,Object.assign(n,t),n}var Sc,Rc=_c(Zh,"Use firebase.firestore() instead."),kc=_c(tc,"Use firebase.firestore().runTransaction() instead."),Dc=_c(ec,"Use firebase.firestore().batch() instead."),Oc=_c(nc,"Use firebase.firestore().doc() instead."),Lc=_c(rc),Vc=_c(oc),Mc=_c(sc),Pc=_c(uc),Cc=_c(ac,"Use firebase.firestore().collection() instead."),Uc=_c((Kc.delete=function(){return Mu("FieldValue.delete",arguments),new fa},Kc.serverTimestamp=function(){return Mu("FieldValue.serverTimestamp",arguments),new la},Kc.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Cu("FieldValue.arrayUnion",arguments,1),new pa(t)},Kc.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Cu("FieldValue.arrayRemove",arguments,1),new da(t)},Kc.increment=function(t){return ju("FieldValue.increment","number",1,t),Pu("FieldValue.increment",arguments,1),new ya(t)},Kc.prototype.isEqual=function(t){return this===t},Kc),"Use FieldValue.<field>() instead."),jc=_c(ta,"Use Blob.fromUint8Array() or Blob.fromBase64String() instead."),qc={Firestore:Rc,GeoPoint:va,Timestamp:Di,Blob:jc,Transaction:kc,WriteBatch:Dc,DocumentReference:Oc,DocumentSnapshot:Lc,Query:Mc,QueryDocumentSnapshot:Vc,QuerySnapshot:Pc,CollectionReference:Cc,FieldPath:ea,FieldValue:Uc,setLogLevel:Zh.setLogLevel,CACHE_SIZE_UNLIMITED:Jh},Fc=(Xc.prototype.ou=function(t){},Xc.prototype.yu=function(){},Xc),xc=(Yc.prototype.ou=function(t){this.Hf.push(t)},Yc.prototype.yu=function(){window.removeEventListener("online",this.Qf),window.removeEventListener("offline",this.jf)},Yc.prototype.Kf=function(){window.addEventListener("online",this.Qf),window.addEventListener("offline",this.jf)},Yc.prototype.Wf=function(){Fs("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.Hf;t<e.length;t++)(0,e[t])(0)},Yc.prototype.Gf=function(){Fs("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.Hf;t<e.length;t++)(0,e[t])(1)},Yc.zf=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},Yc),Gc=(Qc.prototype.Va=function(t){this.Jf=t},Qc.prototype.ma=function(t){this.Zf=t},Qc.prototype.onMessage=function(t){this.td=t},Qc.prototype.close=function(){this.Xf()},Qc.prototype.send=function(t){this.Yf(t)},Qc.prototype.ed=function(){this.Jf()},Qc.prototype.sd=function(t){this.Zf(t)},Qc.prototype.nd=function(t){this.td(t)},Qc),Bc={BatchGetDocuments:"batchGet",Commit:"commit"},zc="gl-js/ fire/"+mi,Hc=(Wc.prototype.hd=function(t,e){if(e)for(var n in e.o)e.o.hasOwnProperty(n)&&(t[n]=e.o[n]);t["X-Goog-Api-Client"]=zc},Wc.prototype.La=function(a,i,r){var h=this,c=this.od(a);return new Promise(function(o,s){var u=new gi;u.listenOnce(yi.COMPLETE,function(){try{switch(u.getLastErrorCode()){case di.NO_ERROR:var t=u.getResponseJson();Fs("Connection","XHR received:",JSON.stringify(t)),o(t);break;case di.TIMEOUT:Fs("Connection",'RPC "'+a+'" timed out'),s(new Ni(Ai.DEADLINE_EXCEEDED,"Request time out"));break;case di.HTTP_ERROR:var e,n,i=u.getStatus();Fs("Connection",'RPC "'+a+'" failed with status:',i,"response text:",u.getResponseText()),0<i?(e=u.getResponseJson().error)&&e.status&&e.message?(r=e.status.toLowerCase().replace("_","-"),n=0<=Object.values(Ai).indexOf(r)?r:Ai.UNKNOWN,s(new Ni(n,e.message))):s(new Ni(Ai.UNKNOWN,"Server responded with status "+u.getStatus())):(Fs("Connection",'RPC "'+a+'" failed'),s(new Ni(Ai.UNAVAILABLE,"Connection failed.")));break;default:Bs()}}finally{Fs("Connection",'RPC "'+a+'" completed.')}var r});var t=Object.assign({},i);delete t.database;var e=JSON.stringify(t);Fs("Connection","XHR sending: ",c+" "+e);var n={"Content-Type":"text/plain"};h.hd(n,r),u.send(c,"POST",e,n,15)})},Wc.prototype.ka=function(t,e,n){return this.La(t,e,n)},Wc.prototype.pa=function(t,e){var n,i,r=[this.rd,"/","google.firestore.v1.Firestore","/",t,"/channel"],o=pi(),s={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.ii.projectId+"/databases/"+this.ii.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling};this.hd(s.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(d())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=d().indexOf("Electron/")||0<=(i=d()).indexOf("MSIE ")||0<=i.indexOf("Trident/")||0<=d().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(s.httpHeadersOverwriteParam="$httpHeaders");var u=r.join("");function a(t,e){h.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})}Fs("Connection","Creating WebChannel: "+u+" "+s);var h=o.createWebChannel(u,s),c=!1,f=!1,l=new Gc({Yf:function(t){f?Fs("Connection","Not sending because WebChannel is closed:",t):(c||(Fs("Connection","Opening WebChannel transport."),h.open(),c=!0),Fs("Connection","WebChannel sending:",t),h.send(t))},Xf:function(){return h.close()}});return a(vi.EventType.OPEN,function(){f||Fs("Connection","WebChannel transport opened.")}),a(vi.EventType.CLOSE,function(){f||(f=!0,Fs("Connection","WebChannel transport closed"),l.sd())}),a(vi.EventType.ERROR,function(t){f||(f=!0,Fs("Connection","WebChannel transport errored:",t),l.sd(new Ni(Ai.UNAVAILABLE,"The operation could not be completed")))}),a(vi.EventType.MESSAGE,function(t){var e,n,i,r,o,s;f||(zs(!!(n=t.data[0])),(i=n.error||(null===(e=n[0])||void 0===e?void 0:e.error))?(Fs("Connection","WebChannel received error:",i),r=i.status,o=function(){var t=so[r];if(void 0!==t)return Qo(t)}(),s=i.message,void 0===o&&(o=Ai.INTERNAL,s="Unknown error status: "+r+" with message "+i.message),f=!0,l.sd(new Ni(o,s)),h.close()):(Fs("Connection","WebChannel received:",n),l.nd(n)))}),setTimeout(function(){l.ed()},0),l},Wc.prototype.od=function(t){var e=Bc[t];return this.rd+"/v1/projects/"+this.ii.projectId+"/databases/"+this.ii.database+"/documents:"+e},Wc);function Wc(t){this.ii=t.ii;var e=t.ssl?"https":"http";this.rd=e+"://"+t.host,this.forceLongPolling=t.forceLongPolling}function Qc(t){this.Yf=t.Yf,this.Xf=t.Xf}function Yc(){var t=this;this.Qf=function(){return t.Wf()},this.jf=function(){return t.Gf()},this.Hf=[],this.Kf()}function Xc(){}function Kc(){}function Jc(){this.Co="undefined"!=typeof atob}Ps.an((Object.defineProperty(Jc.prototype,"document",{get:function(){return"undefined"!=typeof document?document:null},enumerable:!0,configurable:!0}),Object.defineProperty(Jc.prototype,"window",{get:function(){return"undefined"!=typeof window?window:null},enumerable:!0,configurable:!0}),Jc.prototype.N_=function(t){return Promise.resolve(new Hc(t))},Jc.prototype.S_=function(){return new(xc.zf()?xc:Fc)},Jc.prototype.zo=function(t){return new Ls(t,{hi:!0})},Jc.prototype.un=function(t){return JSON.stringify(t)},Jc.prototype.atob=function(t){return atob(t)},Jc.prototype.btoa=function(t){return btoa(t)},Jc.prototype.ln=function(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e)e.getRandomValues(n);else for(var i=0;i<t;i++)n[i]=Math.floor(256*Math.random());return n},new Jc)),(Sc=$c).INTERNAL.registerComponent(new E("firestore",function(t){return e=t.getProvider("app").getImmediate(),n=t.getProvider("auth-internal"),new Zh(e,n,new Ch);var e,n},"PUBLIC").setServiceProps(Object.assign({},qc))),Sc.registerVersion("@firebase/firestore","1.14.3")}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.memory.js - be sure to load firebase-app.js first.")}});