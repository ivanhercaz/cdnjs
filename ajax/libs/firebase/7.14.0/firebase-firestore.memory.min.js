!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t=t||self).firebase)}(this,function(Il){"use strict";try{(function(){Il=Il&&Object.prototype.hasOwnProperty.call(Il,"default")?Il.default:Il;var t,a,e,i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function n(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function c(t,s,a,u){return new(a=a||Promise)(function(n,e){function i(t){try{o(u.next(t))}catch(t){e(t)}}function r(t){try{o(u.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof a?e:new a(function(t){t(e)})).then(i,r)}o((u=u.apply(t,s||[])).next())})}function y(n,i){var r,o,s,t,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return a.label++,{value:e[1],done:!1};case 5:a.label++,o=e[1],e=[0];continue;case 7:e=a.ops.pop(),a.trys.pop();continue;default:if(!(s=0<(s=a.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){a=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){a.label=e[1];break}if(6===e[0]&&a.label<s[1]){a.label=s[1],s=e;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(e);break}s[2]&&a.ops.pop(),a.trys.pop();continue}e=i.call(n,a)}catch(t){e=[6,t],o=0}finally{r=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function r(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var i=Array(t),r=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,r++)i[r]=o[s];return i}function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var i=Array(t),r=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,r++)i[r]=o[s];return i}function o(t,e){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];if(!(e<t.logLevel)){var r=(new Date).toISOString(),o=h[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,s(["["+r+"]  "+t.name+":"],n))}}(e=a=a||{})[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT",a.DEBUG,a.VERBOSE,a.INFO,a.WARN,a.ERROR,a.SILENT;var u=a.INFO,h=((t={})[a.DEBUG]="log",t[a.VERBOSE]="log",t[a.INFO]="info",t[a.WARN]="warn",t[a.ERROR]="error",t),l=(Object.defineProperty(f.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in a))throw new TypeError("Invalid value assigned to `logLevel`");this._logLevel=t},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!0,configurable:!0}),f.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,a.DEBUG],t)),this._logHandler.apply(this,s([this,a.DEBUG],t))},f.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,a.VERBOSE],t)),this._logHandler.apply(this,s([this,a.VERBOSE],t))},f.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,a.INFO],t)),this._logHandler.apply(this,s([this,a.INFO],t))},f.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,a.WARN],t)),this._logHandler.apply(this,s([this,a.WARN],t))},f.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,a.ERROR],t)),this._logHandler.apply(this,s([this,a.ERROR],t))},f);function f(t){this.name=t,this._logLevel=u,this._logHandler=o,this._userLogHandler=null}function p(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var d,v=(n(g,d=Error),g);function g(t,e){var n=d.call(this,e)||this;return n.code=t,n.name="FirebaseError",Object.setPrototypeOf(n,g.prototype),Error.captureStackTrace&&Error.captureStackTrace(n,m.prototype.create),n}var m=(w.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var i,r=e[0]||{},o=this.service+"/"+t,s=this.errors[t],a=s?(i=r,s.replace(b,function(t,e){var n=i[e];return null!=n?n.toString():"<"+e+"?>"})):"Error",u=this.serviceName+": "+a+" ("+o+").",h=new v(o,u),c=0,l=Object.keys(r);c<l.length;c++){var f=l[c];"_"!==f.slice(-1)&&(f in h&&console.warn('Overwriting FirebaseError base field "'+f+'" can cause unexpected behavior.'),h[f]=r[f])}return h},w);function w(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var b=/\{\$([^}]+)}/g,E=(A.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},A.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},A.prototype.setServiceProps=function(t){return this.serviceProps=t,this},A);function A(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var I,N="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},T=T||{},_=N;function S(t){return"string"==typeof t}function k(t){return"number"==typeof t}function R(t,e){t=t.split("."),e=e||_;for(var n=0;n<t.length;n++)if(null==(e=e[t[n]]))return null;return e}function L(){}function D(t){var e=typeof t;if("object"==e){if(!t)return"null";if(t instanceof Array)return"array";if(t instanceof Object)return e;var n=Object.prototype.toString.call(t);if("[object Window]"==n)return"object";if("[object Array]"==n||"number"==typeof t.length&&void 0!==t.splice&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("splice"))return"array";if("[object Function]"==n||void 0!==t.call&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("call"))return"function"}else if("function"==e&&void 0===t.call)return"object";return e}function O(t){return"array"==D(t)}function C(t){var e=D(t);return"array"==e||"object"==e&&"number"==typeof t.length}function V(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var U="closure_uid_"+(1e9*Math.random()>>>0),P=0;function M(t,e,n){return t.call.apply(t.bind,arguments)}function q(e,n,t){if(!e)throw Error();if(2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,i),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function F(t,e,n){return(F=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?M:q).apply(null,arguments)}function G(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var x=Date.now||function(){return+new Date};function j(t,o){function e(){}e.prototype=o.prototype,t.N=o.prototype,t.prototype=new e,(t.prototype.constructor=t).yb=function(t,e,n){for(var i=Array(arguments.length-2),r=2;r<arguments.length;r++)i[r-2]=arguments[r];return o.prototype[e].apply(t,i)}}function B(){this.j=this.j,this.i=this.i}B.prototype.j=!1,B.prototype.la=function(){!this.j&&(this.j=!0,this.G(),0)&&(this[U]||(this[U]=++P))},B.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var H=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(S(t))return S(e)&&1==e.length?t.indexOf(e,0):-1;for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},Q=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var i=t.length,r=S(t)?t.split(""):t,o=0;o<i;o++)o in r&&e.call(n,r[o],o,t)};function z(t){return Array.prototype.concat.apply([],arguments)}function Y(t){var e=t.length;if(0<e){for(var n=Array(e),i=0;i<e;i++)n[i]=t[i];return n}return[]}function W(t){return/^[\s\xa0]*$/.test(t)}var X,J=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function K(t,e){return-1!=t.indexOf(e)}function Z(t,e){return t<e?-1:e<t?1:0}t:{var $=_.navigator;if($){var tt=$.userAgent;if(tt){X=tt;break t}}X=""}function et(t,e,n){for(var i in t)e.call(n,t[i],i,t)}function nt(t){var e,n={};for(e in t)n[e]=t[e];return n}var it="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function rt(t,e){for(var n,i,r=1;r<arguments.length;r++){for(n in i=arguments[r])t[n]=i[n];for(var o=0;o<it.length;o++)n=it[o],Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}}function ot(t){return ot[" "](t),t}ot[" "]=L;var st,at,ut=K(X,"Opera"),ht=K(X,"Trident")||K(X,"MSIE"),ct=K(X,"Edge"),lt=ct||ht,ft=K(X,"Gecko")&&!(K(X.toLowerCase(),"webkit")&&!K(X,"Edge"))&&!(K(X,"Trident")||K(X,"MSIE"))&&!K(X,"Edge"),pt=K(X.toLowerCase(),"webkit")&&!K(X,"Edge");function dt(){var t=_.document;return t?t.documentMode:void 0}t:{var yt="",vt=(at=X,ft?/rv:([^\);]+)(\)|;)/.exec(at):ct?/Edge\/([\d\.]+)/.exec(at):ht?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(at):pt?/WebKit\/(\S+)/.exec(at):ut?/(?:Version)[ \/]?(\S+)/.exec(at):void 0);if(vt&&(yt=vt?vt[1]:""),ht){var gt=dt();if(null!=gt&&gt>parseFloat(yt)){st=String(gt);break t}}st=yt}var mt,wt={};function bt(a){return t=a,e=function(){for(var t=0,e=J(String(st)).split("."),n=J(String(a)).split("."),i=Math.max(e.length,n.length),r=0;0==t&&r<i;r++){var o=e[r]||"",s=n[r]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=Z(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||Z(0==o[2].length,0==s[2].length)||Z(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t},n=wt,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e();var t,e,n}var Et=_.document;mt=Et&&ht?dt()||("CSS1Compat"==Et.compatMode?parseInt(st,10):5):void 0;var At=!ht||9<=Number(mt),It=ht&&!bt("9"),Nt=function(){if(!_.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{_.addEventListener("test",L,e),_.removeEventListener("test",L,e)}catch(t){}return t}();function Tt(t,e){this.type=t,this.a=this.target=e,this.Ia=!0}function _t(t,e){if(Tt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,i=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(ft){t:{try{ot(e.nodeName);var r=!0;break t}catch(t){}r=!1}r||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,i?(this.clientX=void 0!==i.clientX?i.clientX:i.pageX,this.clientY=void 0!==i.clientY?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=S(t.pointerType)?t.pointerType:St[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}Tt.prototype.b=function(){this.Ia=!1},j(_t,Tt);var St={2:"touch",3:"pen",4:"mouse"};_t.prototype.b=function(){_t.N.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,It)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var kt="closure_listenable_"+(1e6*Math.random()|0),Rt=0;function Lt(t,e,n,i,r){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!i,this.da=r,this.key=++Rt,this.X=this.Z=!1}function Dt(t){t.X=!0,t.listener=null,t.proxy=null,t.src=null,t.da=null}function Ot(t){this.src=t,this.a={},this.b=0}function Ct(t,e){var n=e.type;if(n in t.a){var i,r=t.a[n],o=H(r,e);(i=0<=o)&&Array.prototype.splice.call(r,o,1),i&&(Dt(e),0==t.a[n].length&&(delete t.a[n],t.b--))}}function Vt(t,e,n,i){for(var r=0;r<t.length;++r){var o=t[r];if(!o.X&&o.listener==e&&o.capture==!!n&&o.da==i)return r}return-1}Ot.prototype.add=function(t,e,n,i,r){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=Vt(t,e,i,r);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new Lt(e,this.src,o,!!i,r)).Z=n,t.push(e)),e};var Ut="closure_lm_"+(1e6*Math.random()|0),Pt={};function Mt(t,e,n,i,r){if(i&&i.once)return function t(e,n,i,r,o){if(O(n)){for(var s=0;s<n.length;s++)t(e,n[s],i,r,o);return null}return i=Qt(i),e&&e[kt]?e.Aa(n,i,V(r)?!!r.capture:!!r,o):qt(e,n,i,!0,r,o)}(t,e,n,i,r);if(O(e)){for(var o=0;o<e.length;o++)Mt(t,e[o],n,i,r);return null}return n=Qt(n),t&&t[kt]?t.za(e,n,V(i)?!!i.capture:!!i,r):qt(t,e,n,!1,i,r)}function qt(t,e,n,i,r,o){if(!e)throw Error("Invalid event type");var s=V(r)?!!r.capture:!!r;if(s&&!At)return null;var a,u,h=Bt(t);if(h||(t[Ut]=h=new Ot(t)),(n=h.add(e,n,i,s,o)).proxy)return n;if(a=jt,i=u=At?function(t){return a.call(u.src,u.listener,t)}:function(t){if(!(t=a.call(u.src,u.listener,t)))return t},(n.proxy=i).src=t,i.listener=n,t.addEventListener)Nt||(r=s),void 0===r&&(r=!1),t.addEventListener(e.toString(),i,r);else if(t.attachEvent)t.attachEvent(Gt(e.toString()),i);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(i)}return n}function Ft(t){if(!k(t)&&t&&!t.X){var e=t.src;if(e&&e[kt])Ct(e.c,t);else{var n=t.type,i=t.proxy;e.removeEventListener?e.removeEventListener(n,i,t.capture):e.detachEvent?e.detachEvent(Gt(n),i):e.addListener&&e.removeListener&&e.removeListener(i),(n=Bt(e))?(Ct(n,t),0==n.b&&(n.src=null,e[Ut]=null)):Dt(t)}}}function Gt(t){return t in Pt?Pt[t]:Pt[t]="on"+t}function xt(t,e){var n=t.listener,i=t.da||t.src;return t.Z&&Ft(t),n.call(i,e)}function jt(t,e){return!!t.X||xt(t,At?new _t(e,this):e=new _t(e||R("window.event"),this))}function Bt(t){return(t=t[Ut])instanceof Ot?t:null}var Ht="__closure_events_fn_"+(1e9*Math.random()>>>0);function Qt(e){return"function"==D(e)?e:(e[Ht]||(e[Ht]=function(t){return e.handleEvent(t)}),e[Ht])}function zt(){B.call(this),this.c=new Ot(this),(this.J=this).B=null}function Yt(t,e,n,i){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var r=!0,o=0;o<e.length;++o){var s=e[o];if(s&&!s.X&&s.capture==n){var a=s.listener,u=s.da||s.src;s.Z&&Ct(t.c,s),r=!1!==a.call(u,i)&&r}}return r&&0!=i.Ia}j(zt,B),zt.prototype[kt]=!0,(I=zt.prototype).addEventListener=function(t,e,n,i){Mt(this,t,e,n,i)},I.removeEventListener=function(t,e,n,i){!function t(e,n,i,r,o){if(O(n))for(var s=0;s<n.length;s++)t(e,n[s],i,r,o);else r=V(r)?!!r.capture:!!r,i=Qt(i),e&&e[kt]?(e=e.c,(n=String(n).toString())in e.a&&-1<(i=Vt(s=e.a[n],i,r,o))&&(Dt(s[i]),Array.prototype.splice.call(s,i,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&Bt(e))&&(n=e.a[n.toString()],e=-1,n&&(e=Vt(n,i,r,o)),(i=-1<e?n[e]:null)&&Ft(i))}(this,t,e,n,i)},I.dispatchEvent=function(t){var e,n=this.B;if(n)for(e=[];n;n=n.B)e.push(n);n=this.J;var i=t.type||t;if(S(t))t=new Tt(t,n);else if(t instanceof Tt)t.target=t.target||n;else{var r=t;rt(t=new Tt(i,n),r)}if(r=!0,e)for(var o=e.length-1;0<=o;o--){var s=t.a=e[o];r=Yt(s,i,!0,t)&&r}if(r=Yt(s=t.a=n,i,!0,t)&&r,r=Yt(s,i,!1,t)&&r,e)for(o=0;o<e.length;o++)r=Yt(s=t.a=e[o],i,!1,t)&&r;return r},I.G=function(){if(zt.N.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],i=0;i<n.length;i++)Dt(n[i]);delete e.a[t],e.b--}}this.B=null},I.za=function(t,e,n,i){return this.c.add(String(t),e,!1,n,i)},I.Aa=function(t,e,n,i){return this.c.add(String(t),e,!0,n,i)};var Wt=_.JSON.stringify;function Xt(t,e){this.c=t,this.f=e,this.b=0,this.a=null}function Jt(){this.b=this.a=null}Xt.prototype.get=function(){if(0<this.b){this.b--;var t=this.a;this.a=t.next,t.next=null}else t=this.c();return t};var Kt,Zt=new Xt(function(){return new $t},function(t){t.reset()});function $t(){this.next=this.b=this.a=null}function te(t){_.setTimeout(function(){throw t},0)}function ee(t,e){var n;Kt||(n=_.Promise.resolve(void 0),Kt=function(){n.then(re)}),ne||(Kt(),ne=!0),ie.add(t,e)}Jt.prototype.add=function(t,e){var n=Zt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},$t.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var ne=!($t.prototype.reset=function(){this.next=this.b=this.a=null}),ie=new Jt;function re(){for(var t;i=n=void 0,i=null,(n=ie).a&&(i=n.a,n.a=n.a.next,n.a||(n.b=null),i.next=null),t=i;){try{t.a.call(t.b)}catch(t){te(t)}var e=Zt;e.f(t),e.b<100&&(e.b++,t.next=e.a,e.a=t)}var n,i;ne=!1}function oe(t,e){zt.call(this),this.b=t||1,this.a=e||_,this.f=F(this.gb,this),this.g=x()}function se(t){t.ba=!1,t.L&&(t.a.clearTimeout(t.L),t.L=null)}function ae(t,e,n){if("function"==D(t))n&&(t=F(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=F(t.handleEvent,t)}return 2147483647<Number(e)?-1:_.setTimeout(t,e||0)}function ue(t,e,n){B.call(this),this.f=null!=n?F(t,n):t,this.c=e,this.b=F(this.$a,this),this.a=[]}function he(t){t.U=ae(t.b,t.c),t.f.apply(null,t.a)}function ce(t){B.call(this),this.b=t,this.a={}}j(oe,zt),(I=oe.prototype).ba=!1,I.L=null,I.gb=function(){if(this.ba){var t=x()-this.g;0<t&&t<.8*this.b?this.L=this.a.setTimeout(this.f,this.b-t):(this.L&&(this.a.clearTimeout(this.L),this.L=null),this.dispatchEvent("tick"),this.ba&&(se(this),this.start()))}},I.start=function(){this.ba=!0,this.L||(this.L=this.a.setTimeout(this.f,this.b),this.g=x())},I.G=function(){oe.N.G.call(this),se(this),delete this.a},j(ue,B),(I=ue.prototype).ea=!1,I.U=null,I.Ta=function(t){this.a=arguments,this.U?this.ea=!0:he(this)},I.G=function(){ue.N.G.call(this),this.U&&(_.clearTimeout(this.U),this.U=null,this.ea=!1,this.a=[])},I.$a=function(){this.U=null,this.ea&&(this.ea=!1,he(this))},j(ce,B);var le=[];function fe(t,e,n,i){O(n)||(n&&(le[0]=n.toString()),n=le);for(var r=0;r<n.length;r++){var o=Mt(e,n[r],i||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function pe(t){et(t.a,function(t,e){this.a.hasOwnProperty(e)&&Ft(t)},t),t.a={}}function de(){}ce.prototype.G=function(){ce.N.G.call(this),pe(this)},ce.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ye=new zt;function ve(t){Tt.call(this,"serverreachability",t)}function ge(){ye.dispatchEvent(new ve(ye))}function me(t){Tt.call(this,"statevent",t)}function we(){ye.dispatchEvent(new me(ye))}function be(t){Tt.call(this,"timingevent",t)}function Ee(t,e){if("function"!=D(t))throw Error("Fn must not be null and must be a function");return _.setTimeout(function(){t()},e)}j(ve,Tt),j(me,Tt),j(be,Tt);var Ae={NO_ERROR:0,hb:1,ob:2,nb:3,kb:4,mb:5,pb:6,La:7,TIMEOUT:8,sb:9},Ie={jb:"complete",wb:"success",Ma:"error",La:"abort",ub:"ready",vb:"readystatechange",TIMEOUT:"timeout",qb:"incrementaldata",tb:"progress",lb:"downloadprogress",xb:"uploadprogress"};function Ne(){}function Te(t){var e;return(e=t.a)||(e=t.a={}),e}function _e(){}Ne.prototype.a=null;var Se,ke={OPEN:"a",ib:"b",Ma:"c",rb:"d"};function Re(){Tt.call(this,"d")}function Le(){Tt.call(this,"c")}function De(){}function Oe(t,e,n){this.g=t,this.W=e,this.V=n||1,this.I=new ce(this),this.O=Ce,t=lt?125:void 0,this.P=new oe(t),this.h=null,this.b=!1,this.l=this.D=this.f=this.F=this.v=this.R=this.i=null,this.j=[],this.a=null,this.A=0,this.c=this.w=null,this.o=-1,this.m=!1,this.J=0,this.B=null,this.s=this.S=this.H=!1}j(Re,Tt),j(Le,Tt),j(De,Ne),Se=new De;var Ce=45e3,Ve={},Ue={};function Pe(t,e,n){t.F=1,t.f=an($e(e)),t.l=n,t.H=!0,qe(t,null)}function Me(t,e,n,i){t.F=1,t.f=an($e(e)),t.l=null,t.H=n,qe(t,i)}function qe(t,e){t.v=x(),Ge(t),t.D=$e(t.f),sn(t.D,"t",t.V),t.A=0,t.a=t.g.$(t.g.Y()?e:null),0<t.J&&(t.B=new ue(F(t.Ja,t,t.a),t.J)),fe(t.I,t.a,"readystatechange",t.cb),e=t.h?nt(t.h):{},t.l?(t.w||(t.w="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ca(t.D,t.w,t.l,e)):(t.w="GET",t.a.ca(t.D,t.w,null,e)),ge()}function Fe(t,e,n){for(var i=!0;!t.m&&t.A<n.length;){var r=(s=n,u=a=void 0,a=(o=t).A,-1==(u=s.indexOf("\n",a))?Ue:(a=Number(s.substring(a,u)),isNaN(a)?Ve:(u+=1)+a>s.length?Ue:(s=s.substr(u,a),o.A=u+a,s)));if(r==Ue){4==e&&(t.c=4,we(),i=!1);break}if(r==Ve){t.c=4,we(),i=!1;break}Qe(t,r)}var o,s,a,u;4==e&&0==n.length&&(t.c=1,we(),i=!1),t.b=t.b&&i,i||(He(t),Be(t))}function Ge(t){t.R=x()+t.O,xe(t,t.O)}function xe(t,e){if(null!=t.i)throw Error("WatchDog timer not null");t.i=Ee(F(t.ab,t),e)}function je(t){t.i&&(_.clearTimeout(t.i),t.i=null)}function Be(t){t.g.Ca()||t.m||t.g.na(t)}function He(t){je(t);var e=t.B;e&&"function"==typeof e.la&&e.la(),t.B=null,se(t.P),pe(t.I),t.a&&(e=t.a,t.a=null,e.abort(),e.la())}function Qe(t,e){try{t.g.Fa(t,e),ge()}catch(t){}}function ze(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(C(t)||S(t))Q(t,e,void 0);else{if(t.K&&"function"==typeof t.K)var n=t.K();else if(t.C&&"function"==typeof t.C)n=void 0;else if(C(t)||S(t)){n=[];for(var i=t.length,r=0;r<i;r++)n.push(r)}else for(r in n=[],i=0,t)n[i++]=r;r=(i=function(t){if(t.C&&"function"==typeof t.C)return t.C();if(S(t))return t.split("");if(C(t)){for(var e=[],n=t.length,i=0;i<n;i++)e.push(t[i]);return e}for(i in e=[],n=0,t)e[n++]=t[i];return e}(t)).length;for(var o=0;o<r;o++)e.call(void 0,i[o],n&&n[o],t)}}function Ye(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var i=0;i<n;i+=2)this.set(arguments[i],arguments[i+1])}else if(t)if(t instanceof Ye)for(n=t.K(),i=0;i<n.length;i++)this.set(n[i],t.get(n[i]));else for(i in t)this.set(i,t[i])}function We(t,e){Je(t.b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Xe(t))}function Xe(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var i=t.a[e];Je(t.b,i)&&(t.a[n++]=i),e++}t.a.length=n}if(t.c!=t.a.length){var r={};for(n=e=0;e<t.a.length;)Je(r,i=t.a[e])||(r[t.a[n++]=i]=1),e++;t.a.length=n}}function Je(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(I=Oe.prototype).setTimeout=function(t){this.O=t},I.cb=function(t){t=t.target;var e=this.B;e&&3==$n(t)?e.Ta():this.Ja(t)},I.Ja=function(t){try{if(t==this.a)t:{var e=$n(this.a),n=this.a.ya();this.a.T();if(!(e<3||3==e&&!lt&&!this.a.aa())){this.m||4!=e||7==n||ge(),je(this);var i=this.a.T();this.o=i;var r=this.a.aa();if(this.b=200==i){if(this.S&&!this.s){e:{if(this.a){var o=ti(this.a,"X-HTTP-Initial-Response");if(o&&!W(o)){var s=o;break e}}s=null}if(!s){this.b=!1,this.c=3,we(),He(this),Be(this);break t}this.s=!0,Qe(this,s)}this.H?(Fe(this,e,r),lt&&this.b&&3==e&&(fe(this.I,this.P,"tick",this.bb),this.P.start())):Qe(this,r),4==e&&He(this),this.b&&!this.m&&(4==e?this.g.na(this):(this.b=!1,Ge(this)))}else 400==i&&0<r.indexOf("Unknown SID")?this.c=3:this.c=0,we(),He(this),Be(this)}}}catch(t){}},I.bb=function(){if(this.a){var t=$n(this.a),e=this.a.aa();this.A<e.length&&(je(this),Fe(this,t,e),this.b&&4!=t&&Ge(this))}},I.cancel=function(){this.m=!0,He(this)},I.ab=function(){this.i=null;var t=x();0<=t-this.R?(2!=this.F&&(ge(),we()),He(this),this.c=2,Be(this)):xe(this,this.R-t)},(I=Ye.prototype).C=function(){Xe(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},I.K=function(){return Xe(this),this.a.concat()},I.get=function(t,e){return Je(this.b,t)?this.b[t]:e},I.set=function(t,e){Je(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},I.forEach=function(t,e){for(var n=this.K(),i=0;i<n.length;i++){var r=n[i],o=this.get(r);t.call(e,o,r,this)}};var Ke=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Ze(t,e){var n;this.b=this.j=this.f="",this.i=null,this.g=this.a="",this.h=!1,t instanceof Ze?(this.h=void 0!==e?e:t.h,tn(this,t.f),this.j=t.j,en(this,t.b),nn(this,t.i),this.a=t.a,rn(this,En(t.c)),this.g=t.g):t&&(n=String(t).match(Ke))?(this.h=!!e,tn(this,n[1]||"",!0),this.j=un(n[2]||""),en(this,n[3]||"",!0),nn(this,n[4]),this.a=un(n[5]||"",!0),rn(this,n[6]||"",!0),this.g=un(n[7]||"")):(this.h=!!e,this.c=new vn(null,this.h))}function $e(t){return new Ze(t)}function tn(t,e,n){t.f=n?un(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function en(t,e,n){t.b=n?un(e,!0):e}function nn(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.i=e}else t.i=null}function rn(t,e,n){var i,r;e instanceof vn?(t.c=e,i=t.c,(r=t.h)&&!i.f&&(gn(i),i.c=null,i.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(mn(this,e),bn(this,n,t))},i)),i.f=r):(n||(e=hn(e,dn)),t.c=new vn(e,t.h))}function on(t,e,n){t.c.set(e,n)}function sn(t,e,n){O(n)||(n=[String(n)]),bn(t.c,e,n)}function an(t){return on(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^x()).toString(36)),t}function un(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function hn(t,e,n){return S(t)?(t=encodeURI(t).replace(e,cn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function cn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Ze.prototype.toString=function(){var t=[],e=this.f;e&&t.push(hn(e,ln,!0),":");var n=this.b;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(hn(e,ln,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.i)&&t.push(":",String(n))),(n=this.a)&&(this.b&&"/"!=n.charAt(0)&&t.push("/"),t.push(hn(n,"/"==n.charAt(0)?pn:fn,!0))),(n=this.c.toString())&&t.push("?",n),(n=this.g)&&t.push("#",hn(n,yn)),t.join("")},Ze.prototype.resolve=function(t){var e=$e(this),n=!!t.f;n?tn(e,t.f):n=!!t.j,n?e.j=t.j:n=!!t.b,n?en(e,t.b):n=null!=t.i;var i=t.a;if(n)nn(e,t.i);else if(n=!!t.a){if("/"!=i.charAt(0))if(this.b&&!this.a)i="/"+i;else{var r=e.a.lastIndexOf("/");-1!=r&&(i=e.a.substr(0,r+1)+i)}if(".."==(r=i)||"."==r)i="";else if(K(r,"./")||K(r,"/.")){i=0==r.lastIndexOf("/",0),r=r.split("/");for(var o=[],s=0;s<r.length;){var a=r[s++];"."==a?i&&s==r.length&&o.push(""):".."==a?((1<o.length||1==o.length&&""!=o[0])&&o.pop(),i&&s==r.length&&o.push("")):(o.push(a),i=!0)}i=o.join("/")}else i=r}return n?e.a=i:n=""!==t.c.toString(),n?rn(e,En(t.c)):n=!!t.g,n&&(e.g=t.g),e};var ln=/[#\/\?@]/g,fn=/[#\?:]/g,pn=/[#\?]/g,dn=/[#\?@]/g,yn=/#/g;function vn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function gn(a){a.a||(a.a=new Ye,a.b=0,a.c&&function(t){if(t){t=t.split("&");for(var e=0;e<t.length;e++){var n=t[e].indexOf("="),i=null;if(0<=n){var r=t[e].substring(0,n);i=t[e].substring(n+1)}else r=t[e];o=r,s=i?decodeURIComponent(i.replace(/\+/g," ")):"",a.add(decodeURIComponent(o.replace(/\+/g," ")),s)}}var o,s}(a.c))}function mn(t,e){gn(t),e=An(t,e),Je(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,We(t.a,e))}function wn(t,e){return gn(t),e=An(t,e),Je(t.a.b,e)}function bn(t,e,n){mn(t,e),0<n.length&&(t.c=null,t.a.set(An(t,e),Y(n)),t.b+=n.length)}function En(t){var e=new vn;return e.c=t.c,t.a&&(e.a=new Ye(t.a),e.b=t.b),e}function An(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function In(t){this.a=t,this.b=this.h=null,this.g=!1,this.i=null,this.c=-1,this.l=this.f=null}function Nn(t){var e=t.a.F.a;if(null!=e)we(),e?(we(),fi(t.a,t,!1)):(we(),fi(t.a,t,!0));else{t.b=new Oe(t,void 0,void 0),t.b.h=t.h,e=gi(e=t.a,e.Y()?t.f:null,t.i),we(),sn(e,"TYPE","xmlhttp");var n=t.a.j,i=t.a.I;n&&i&&on(e,n,i),Me(t.b,e,!1,t.f)}}function Tn(){this.a=this.b=null}function _n(){this.a=new Ye}function Sn(t){var e=typeof t;return"object"==e&&t||"function"==e?"o"+(t[U]||(t[U]=++P)):e.charAt(0)+t}function kn(t,e){this.b=t,this.a=e}function Rn(t){this.g=t||Ln,t=_.PerformanceNavigationTiming?0<(t=_.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(_.ka&&_.ka.Da&&_.ka.Da()&&_.ka.Da().zb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new _n),this.b=null,this.c=[]}(I=vn.prototype).add=function(t,e){gn(this),this.c=null,t=An(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},I.forEach=function(n,i){gn(this),this.a.forEach(function(t,e){Q(t,function(t){n.call(i,t,e,this)},this)},this)},I.K=function(){gn(this);for(var t=this.a.C(),e=this.a.K(),n=[],i=0;i<e.length;i++)for(var r=t[i],o=0;o<r.length;o++)n.push(e[i]);return n},I.C=function(t){gn(this);var e=[];if(S(t))wn(this,t)&&(e=z(e,this.a.get(An(this,t))));else{t=this.a.C();for(var n=0;n<t.length;n++)e=z(e,t[n])}return e},I.set=function(t,e){return gn(this),this.c=null,wn(this,t=An(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},I.get=function(t,e){return t&&0<(t=this.C(t)).length?String(t[0]):e},I.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.K(),n=0;n<e.length;n++){var i=e[n],r=encodeURIComponent(String(i));i=this.C(i);for(var o=0;o<i.length;o++){var s=r;""!==i[o]&&(s+="="+encodeURIComponent(String(i[o]))),t.push(s)}}return this.c=t.join("&")},j(function(){},function(){}),(I=In.prototype).M=null,I.$=function(t){return this.a.$(t)},I.abort=function(){this.b&&(this.b.cancel(),this.b=null),this.c=-1},I.Ca=function(){return!1},I.Fa=function(t,e){if(this.c=t.o,0==this.M){if(!this.a.o&&(t=t.a)){var n=ti(t,"X-Client-Wire-Protocol");this.l=n||null,this.a.j&&(t=ti(t,"X-HTTP-Session-Id"))&&(this.a.I=t)}if(e){try{var i=this.a.ja.a.parse(e)}catch(t){return(e=this.a).m=this.c,void yi(e,2)}this.f=i[0]}else(e=this.a).m=this.c,yi(e,2)}else 1==this.M&&(this.g?we():"11111"==e?(we(),this.g=!0,(!ht||10<=Number(mt))&&(this.c=200,this.b.cancel(),we(),fi(this.a,this,!0))):(we(),this.g=!1))},I.na=function(){if(this.c=this.b.o,this.b.b)0==this.M?(this.M=1,Nn(this)):1==this.M&&(this.g?(we(),fi(this.a,this,!0)):(we(),fi(this.a,this,!1)));else{0!=this.M&&1!=this.M||we();var t=this.a;t.m=this.c,yi(t,2)}},I.Y=function(){return this.a.Y()},I.ma=function(){return this.a.ma()},_n.prototype.add=function(t){this.a.set(Sn(t),t)},_n.prototype.C=function(){return this.a.C()};var Ln=10;function Dn(t,e){!t.a&&(K(e,"spdy")||K(e,"quic")||K(e,"h2"))&&(t.f=t.g,t.a=new _n,t.b&&(Un(t,t.b),t.b=null))}function On(t){return t.b||t.a&&t.a.a.c>=t.f}function Cn(t){return t.b?1:t.a?t.a.a.c:0}function Vn(t,e){return t.b?t.b==e:!!t.a&&(e=Sn(e),Je(t.a.a.b,e))}function Un(t,e){t.a?t.a.add(e):t.b=e}function Pn(t,e){var n;t.b&&t.b==e?t.b=null:((n=t.a)&&(n=Sn(e),n=Je(t.a.a.b,n)),n&&We(t.a.a,Sn(e)))}function Mn(t){if(null!=t.b)return t.c.concat(t.b.j);if(null==t.a||0==t.a.a.c)return Y(t.c);var e=t.c;return Q(t.a.C(),function(t){e=e.concat(t.j)}),e}function qn(){}function Fn(){this.a=new qn}function Gn(t,i,e){var r=e||"";try{ze(t,function(t,e){var n=t;V(t)&&(n=Wt(t)),i.push(r+e+"="+encodeURIComponent(n))})}catch(t){throw i.push(r+"type="+encodeURIComponent("_badmap")),t}}function xn(t,e,n,i,r){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,r(i)}catch(t){}}Rn.prototype.cancel=function(){var t;this.c=Mn(this),this.b?(this.b.cancel(),this.b=null):this.a&&0!=this.a.a.c&&(Q(this.a.C(),function(t){t.cancel()}),(t=this.a.a).b={},t.a.length=0,t.c=0)},qn.prototype.stringify=function(t){return _.JSON.stringify(t,void 0)},qn.prototype.parse=function(t){return _.JSON.parse(t,void 0)};var jn=_.JSON.parse;function Bn(t){zt.call(this),this.headers=new Ye,this.H=t||null,this.b=!1,this.s=this.a=null,this.A="",this.h=0,this.f="",this.g=this.w=this.l=this.v=!1,this.o=0,this.m=null,this.I=Hn,this.D=this.F=!1}j(Bn,zt);var Hn="",Qn=/^https?$/i,zn=["POST","PUT"];function Yn(t){return"content-type"==t.toLowerCase()}function Wn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Xn(t),Kn(t)}function Xn(t){t.v||(t.v=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function Jn(t){if(t.b&&void 0!==T&&(!t.s[1]||4!=$n(t)||2!=t.T()))if(t.l&&4==$n(t))ae(t.Ea,0,t);else if(t.dispatchEvent("readystatechange"),4==$n(t)){t.b=!1;try{var e,n=t.T();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var i=!0;break t;default:i=!1}if(!(e=i)){var r;if(r=0===n){var o=String(t.A).match(Ke)[1]||null;if(!o&&_.self&&_.self.location){var s=_.self.location.protocol;o=s.substr(0,s.length-1)}r=!Qn.test(o?o.toLowerCase():"")}e=r}if(e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{t.h=6;try{var a=2<$n(t)?t.a.statusText:""}catch(t){a=""}t.f=a+" ["+t.T()+"]",Xn(t)}}finally{Kn(t)}}}function Kn(t,e){if(t.a){Zn(t);var n=t.a,i=t.s[0]?L:null;t.a=null,t.s=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=i}catch(t){}}}function Zn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(_.clearTimeout(t.m),t.m=null)}function $n(t){return t.a?t.a.readyState:0}function ti(t,e){return t.a?t.a.getResponseHeader(e):null}function ei(t,e,n){t:{for(i in n){var i=!1;break t}i=!0}if(i)return t;var r;if(r="",et(n,function(t,e){r+=e,r+=":",r+=t,r+="\r\n"}),n=r,S(t)){if(e=encodeURIComponent(String(e)),e+=n=null!=n?"="+encodeURIComponent(String(n)):""){if((n=t.indexOf("#"))<0&&(n=t.length),(i=t.indexOf("?"))<0||n<i){i=n;var o=""}else o=t.substring(i+1,n);n=(t=[t.substr(0,i),o,t.substr(n)])[1],t[1]=e?n?n+"&"+e:e:n,t=t[0]+(t[1]?"?"+t[1]:"")+t[2]}return t}return on(t,e,n),t}function ni(t){this.f=[],this.F=new Tn,this.ga=this.pa=this.B=this.ha=this.a=this.I=this.j=this.V=this.g=this.J=this.i=null,this.Qa=this.P=0,this.Oa=!!R("internalChannelParams.failFast",t),this.ia=this.w=this.s=this.l=this.h=this.c=null,this.oa=!0,this.m=this.ra=this.O=-1,this.S=this.v=this.A=0,this.Na=R("internalChannelParams.baseRetryDelayMs",t)||5e3,this.Ra=R("internalChannelParams.retryDelaySeedMs",t)||1e4,this.Pa=R("internalChannelParams.forwardChannelMaxRetries",t)||2,this.qa=R("internalChannelParams.forwardChannelRequestTimeoutMs",t)||2e4,this.Ka=t&&t.Ab||void 0,this.D=void 0,this.R=t&&t.supportsCrossDomainXhr||!1,this.H="",this.b=new Rn(t&&t.concurrentRequestLimit),this.ja=new Fn,this.o=!t||void 0===t.backgroundChannelTest||t.backgroundChannelTest,(this.W=t&&t.fastHandshake||!1)&&!this.o&&(this.o=!0),t&&t.forceLongPolling&&(this.oa=!1),this.fa=void 0}function ii(t){if(ri(t),3==t.u){var e=t.P++,n=$e(t.B);on(n,"SID",t.H),on(n,"RID",e),on(n,"TYPE","terminate"),ui(t,n),(e=new Oe(t,e,void 0)).F=2,e.f=an($e(n)),n=!1,_.navigator&&_.navigator.sendBeacon&&(n=_.navigator.sendBeacon(e.f.toString(),"")),!n&&_.Image&&((new Image).src=e.f,n=!0),n||(e.a=e.g.$(null),e.a.ca(e.f)),e.v=x(),Ge(e)}vi(t)}function ri(t){t.w&&(t.w.abort(),t.w=null),t.a&&(t.a.cancel(),t.a=null),t.l&&(_.clearTimeout(t.l),t.l=null),pi(t),t.b.cancel(),t.h&&(k(t.h)&&_.clearTimeout(t.h),t.h=null)}function oi(t,e){t.f.push(new kn(t.Qa++,e)),3==t.u&&si(t)}function si(t){On(t.b)||t.h||(t.h=!0,ee(t.Ha,t),t.A=0)}function ai(t,e){var n;n=e?e.W:t.P++;var i=$e(t.B);on(i,"SID",t.H),on(i,"RID",n),on(i,"AID",t.O),ui(t,i),t.g&&t.i&&ei(i,t.g,t.i),n=new Oe(t,n,t.A+1),null===t.g&&(n.h=t.i),e&&(t.f=e.j.concat(t.f)),e=hi(t,n,1e3),n.setTimeout(Math.round(.5*t.qa)+Math.round(.5*t.qa*Math.random())),Un(t.b,n),Pe(n,i,e)}function ui(t,n){t.c&&ze({},function(t,e){on(n,e,t)})}function hi(t,e,n){n=Math.min(t.f.length,n);var i=t.c?F(t.c.Sa,t.c,t):null;t:for(var r=t.f,o=-1;;){var s=["count="+n];-1==o?0<n?(o=r[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var a=!0,u=0;u<n;u++){var h=r[u].b,c=r[u].a;if((h-=o)<0)o=Math.max(0,r[u].b-100),a=!1;else try{Gn(c,s,"req"+h+"_")}catch(t){i&&i(c)}}if(a){i=s.join("&");break t}}return t=t.f.splice(0,n),e.j=t,i}function ci(t){t.a||t.l||(t.S=1,ee(t.Ga,t),t.v=0)}function li(t){return!(t.a||t.l||3<=t.v)&&(t.S++,t.l=Ee(F(t.Ga,t),di(t,t.v)),t.v++,1)}function fi(t,e,n){var i=e.l;i&&Dn(t.b,i),t.ia=t.oa&&n,t.m=e.c,t.B=gi(t,null,t.ha),si(t)}function pi(t){null!=t.s&&(_.clearTimeout(t.s),t.s=null)}function di(t,e){var n=t.Na+Math.floor(Math.random()*t.Ra);return t.ma()||(n*=2),n*e}function yi(t,e){if(2==e){var n=null;t.c&&(n=null);var i=F(t.eb,t);n||(n=new Ze("//www.google.com/images/cleardot.gif"),_.location&&"http"==_.location.protocol||tn(n,"https"),an(n)),function(t,e){var n=new de;if(_.Image){var i=new Image;i.onload=G(xn,n,i,"TestLoadImage: loaded",!0,e),i.onerror=G(xn,n,i,"TestLoadImage: error",!1,e),i.onabort=G(xn,n,i,"TestLoadImage: abort",!1,e),i.ontimeout=G(xn,n,i,"TestLoadImage: timeout",!1,e),_.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=t}else e(!1)}(n.toString(),i)}else we();t.u=0,t.c&&t.c.ta(e),vi(t),ri(t)}function vi(t){t.u=0,t.m=-1,t.c&&(0==Mn(t.b).length&&0==t.f.length||(t.b.c.length=0,Y(t.f),t.f.length=0),t.c.sa())}function gi(t,e,n){var i,r,o,s,a,u,h=(i=n)instanceof Ze?$e(i):new Ze(i,void 0);if(""!=h.b)e&&en(h,e+"."+h.b),nn(h,h.i);else{var c,l=_.location;c=e?e+"."+l.hostname:l.hostname,r=l.protocol,o=c,s=+l.port,a=n,u=new Ze(null,void 0),r&&tn(u,r),o&&en(u,o),s&&nn(u,s),a&&(u.a=a),h=u}return t.V&&et(t.V,function(t,e){on(h,e,t)}),e=t.j,n=t.I,e&&n&&on(h,e,n),on(h,"VER",t.wa),ui(t,h),h}function mi(){}function wi(){if(ht&&!(10<=Number(mt)))throw Error("Environmental error: no available transport.")}function bi(t,e){zt.call(this),this.a=new ni(e),this.g=t,this.m=e&&e.fb?e.fb:function(t){for(var e=t,n=1;n<arguments.length;n++){var i,r=arguments[n];0==r.lastIndexOf("/",0)?e=r:((i=""==e)||(i=0<=(i=e.length-1)&&e.indexOf("/",i)==i),e+=i?r:"/"+r)}return e}(this.g,"test"),this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.i=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.xa&&(t?t["X-WebChannel-Client-Profile"]=e.xa:t={"X-WebChannel-Client-Profile":e.xa}),this.a.J=t,(t=e&&e.httpHeadersOverwriteParam)&&!W(t)&&(this.a.g=t),this.l=e&&e.supportsCrossDomainXhr||!1,this.h=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!W(e)&&(this.a.j=e,null!==(t=this.b)&&e in t&&e in(t=this.b)&&delete t[e]),this.f=new Ii(this)}function Ei(t){Re.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function Ai(){Le.call(this),this.status=1}function Ii(t){this.a=t}(I=Bn.prototype).ca=function(t,e,n,i){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.A+"; newUri="+t);e=e?e.toUpperCase():"GET",this.A=t,this.f="",this.h=0,this.v=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?Te(this.H):Te(Se),this.a.onreadystatechange=F(this.Ea,this);try{this.w=!0,this.a.open(e,String(t),!0),this.w=!1}catch(t){return void Wn(this,t)}t=n||"";var r,o=new Ye(this.headers);i&&ze(i,function(t,e){o.set(e,t)}),i=function(t){t:{for(var e=Yn,n=t.length,i=S(t)?t.split(""):t,r=0;r<n;r++)if(r in i&&e.call(void 0,i[r],r,t)){e=r;break t}e=-1}return e<0?null:S(t)?t.charAt(e):t[e]}(o.K()),n=_.FormData&&t instanceof _.FormData,0<=H(zn,e)&&!i&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Zn(this),0<this.o&&((this.D=(r=this.a,ht&&bt(9)&&k(r.timeout)&&void 0!==r.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=F(this.Ba,this)):this.m=ae(this.Ba,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){Wn(this,t)}},I.Ba=function(){void 0!==T&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},I.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Kn(this))},I.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Kn(this,!0)),Bn.N.G.call(this)},I.Ea=function(){this.j||(this.w||this.l||this.g?Jn(this):this.Za())},I.Za=function(){Jn(this)},I.T=function(){try{return 2<$n(this)?this.a.status:-1}catch(t){return-1}},I.aa=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},I.Ua=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),jn(e)}},I.ya=function(){return this.h},I.Xa=function(){return S(this.f)?this.f:String(this.f)},(I=ni.prototype).wa=8,I.u=1,I.Ca=function(){return 0==this.u},I.Ha=function(t){if(this.h)if(this.h=null,1==this.u){if(!t){this.P=Math.floor(1e5*Math.random()),t=this.P++;var e,n=new Oe(this,t,void 0),i=this.i;if(this.J&&(i?rt(i=nt(i),this.J):i=this.J),null===this.g&&(n.h=i),this.W)t:{for(var r=e=0;r<this.f.length;r++){var o=this.f[r];if(void 0===(o="__data__"in o.a&&S(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=r;break t}if(4096===e||r===this.f.length-1){e=r+1;break t}}e=1e3}else e=1e3;e=hi(this,n,e),on(r=$e(this.B),"RID",t),on(r,"CVER",22),this.o&&this.j&&on(r,"X-HTTP-Session-Id",this.j),ui(this,r),this.g&&i&&ei(r,this.g,i),Un(this.b,n),this.W?(on(r,"$req",e),on(r,"SID","null"),n.S=!0,Pe(n,r,null)):Pe(n,r,e),this.u=2}}else 3==this.u&&(t?ai(this,t):0==this.f.length||On(this.b)||ai(this))},I.Ga=function(){this.l=null,this.a=new Oe(this,"rpc",this.S),null===this.g&&(this.a.h=this.i),this.a.J=0;var t=$e(this.pa);on(t,"RID","rpc"),on(t,"SID",this.H),on(t,"CI",this.ia?"0":"1"),on(t,"AID",this.O),ui(this,t),on(t,"TYPE","xmlhttp"),this.g&&this.i&&ei(t,this.g,this.i),this.D&&this.a.setTimeout(this.D),Me(this.a,t,!0,this.ga)},I.Fa=function(t,e){if(0!=this.u&&(this.a==t||Vn(this.b,t)))if(this.m=t.o,!t.s&&Vn(this.b,t)&&3==this.u){try{var n=this.ja.a.parse(e)}catch(t){n=null}if(O(n)&&3==n.length){if(0==(e=n)[0]){t:if(!this.l){if(this.a){if(!(this.a.v+3e3<t.v))break t;pi(this),this.a.cancel(),this.a=null}li(this),we()}}else this.ra=e[1],0<this.ra-this.O&&e[2]<37500&&this.ia&&0==this.v&&!this.s&&(this.s=Ee(F(this.Ya,this),6e3));if(Cn(this.b)<=1&&this.fa){try{this.fa()}catch(t){}this.fa=void 0}}else yi(this,11)}else if(!t.s&&this.a!=t||pi(this),!W(e))for(e=n=this.ja.a.parse(e),n=0;n<e.length;n++){var i=e[n];if(this.O=i[0],i=i[1],2==this.u)if("c"==i[0]){this.H=i[1],this.ga=i[2];var r=i[3];null!=r&&(this.wa=r),null!=(i=i[5])&&k(i)&&0<i&&(this.D=1.5*i),this.o&&(i=t.a)&&((r=ti(i,"X-Client-Wire-Protocol"))&&Dn(this.b,r),this.j&&(i=ti(i,"X-HTTP-Session-Id")))&&(this.I=i,on(this.B,this.j,i)),this.u=3,this.c&&this.c.va(),i=t,this.pa=gi(this,this.Y()?this.ga:null,this.ha),i.s?(Pn(this.b,i),(r=this.D)&&i.setTimeout(r),i.i&&(je(i),Ge(i)),this.a=i):ci(this),0<this.f.length&&si(this)}else"stop"!=i[0]&&"close"!=i[0]||yi(this,7);else 3==this.u&&("stop"==i[0]||"close"==i[0]?"stop"==i[0]?yi(this,7):ii(this):"noop"!=i[0]&&this.c&&this.c.ua(i),this.v=0)}},I.Ya=function(){null!=this.s&&(this.s=null,this.a.cancel(),this.a=null,li(this),we())},I.na=function(t){var e=null;if(this.a==t){pi(this),this.a=null;var n=2}else{if(!Vn(this.b,t))return;e=t.j,Pn(this.b,t),n=1}if(this.m=t.o,0!=this.u)if(t.b)1==n?(e=x()-t.v,ye.dispatchEvent(new be(ye,t.l&&t.l.length,this.A)),si(this)):ci(this);else{var i=t.c;if(3==i||0==i&&0<this.m||!(1==n&&function(t,e){if(!(Cn(t.b)>=t.b.f-(t.h?1:0))){if(t.h)return t.f=e.j.concat(t.f),1;if(!(1==t.u||2==t.u||t.A>=(t.Oa?0:t.Pa)))return t.h=Ee(F(t.Ha,t,e),di(t,t.A)),t.A++,1}}(this,t)||2==n&&li(this)))switch(e&&0<e.length&&(t=this.b,t.c=t.c.concat(e)),i){case 1:yi(this,5);break;case 4:yi(this,10);break;case 3:yi(this,6);break;default:yi(this,2)}}},I.eb=function(t){we()},I.$=function(t){if(t&&!this.R)throw Error("Can't create secondary domain capable XhrIo object.");return(t=new Bn(this.Ka)).F=this.R,t},I.ma=function(){return!!this.c&&!0},I.Y=function(){return this.R},(I=mi.prototype).va=function(){},I.ua=function(){},I.ta=function(){},I.sa=function(){},I.Sa=function(){},wi.prototype.a=function(t,e){return new bi(t,e)},j(bi,zt),(I=bi.prototype).addEventListener=function(t,e,n,i){bi.N.addEventListener.call(this,t,e,n,i)},I.removeEventListener=function(t,e,n,i){bi.N.removeEventListener.call(this,t,e,n,i)},I.Va=function(){this.a.c=this.f,this.l&&(this.a.R=!0);var t=this.a,e=this.m,n=this.g,i=this.b||void 0;we(),t.ha=n,t.V=i||{},t.o&&(t.F.b=[],t.F.a=!1),t.w=new In(t),null===t.g&&(t.w.h=t.i),n=e,t.g&&t.i&&(n=ei(e,t.g,t.i)),(t=t.w).i=n,e=gi(t.a,null,t.i),we(),null!=(n=t.a.F.b)?(t.f=n[0],t.M=1,Nn(t)):(sn(e,"MODE","init"),!t.a.o&&t.a.j&&sn(e,"X-HTTP-Session-Id",t.a.j),t.b=new Oe(t,void 0,void 0),t.b.h=t.h,Me(t.b,e,!1,null),t.M=0)},I.close=function(){ii(this.a)},I.Wa=function(t){if(S(t)){var e={};e.__data__=t,oi(this.a,e)}else this.h?((e={}).__data__=Wt(t),oi(this.a,e)):oi(this.a,t)},I.G=function(){this.a.c=null,delete this.f,ii(this.a),delete this.a,bi.N.G.call(this)},j(Ei,Re),j(Ai,Le),j(Ii,mi),Ii.prototype.va=function(){this.a.dispatchEvent("a")},Ii.prototype.ua=function(t){this.a.dispatchEvent(new Ei(t))},Ii.prototype.ta=function(t){this.a.dispatchEvent(new Ai)},Ii.prototype.sa=function(){this.a.dispatchEvent("b")};var Ni=G(function(t,e){function n(){}n.prototype=t.prototype;var i=new n;return t.apply(i,Array.prototype.slice.call(arguments,1)),i},wi);wi.prototype.createWebChannel=wi.prototype.a,bi.prototype.send=bi.prototype.Wa,bi.prototype.open=bi.prototype.Va,bi.prototype.close=bi.prototype.close,Ae.NO_ERROR=0,Ae.TIMEOUT=8,Ae.HTTP_ERROR=6,Ie.COMPLETE="complete",(_e.EventType=ke).OPEN="a",ke.CLOSE="b",ke.ERROR="c",ke.MESSAGE="d",zt.prototype.listen=zt.prototype.za,Bn.prototype.listenOnce=Bn.prototype.Aa,Bn.prototype.getLastError=Bn.prototype.Xa,Bn.prototype.getLastErrorCode=Bn.prototype.ya,Bn.prototype.getStatus=Bn.prototype.T,Bn.prototype.getResponseJson=Bn.prototype.Ua,Bn.prototype.getResponseText=Bn.prototype.aa,Bn.prototype.send=Bn.prototype.ca;var Ti={createWebChannelTransport:Ni,ErrorCode:Ae,EventType:Ie,WebChannel:_e,XhrIo:Bn},_i=Ti.createWebChannelTransport,Si=Ti.ErrorCode,ki=Ti.EventType,Ri=Ti.WebChannel,Li=Ti.XhrIo,Di=Il.SDK_VERSION,Oi=(Ci.prototype.t=function(){return null!=this.uid},Ci.prototype.s=function(){return this.t()?"uid:"+this.uid:"anonymous-user"},Ci.prototype.isEqual=function(t){return t.uid===this.uid},Ci);function Ci(t){this.uid=t}function Vi(t,e){this.user=e,this.type="OAuth",this.o={},this.o.Authorization="Bearer "+t}Oi.UNAUTHENTICATED=new Oi(null),Oi.i=new Oi("google-credentials-uid"),Oi.h=new Oi("first-party-uid");var Ui,Pi={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Mi=(n(Ji,Ui=Error),Ji),qi=(Xi.prototype.getToken=function(){return Promise.resolve(null)},Xi.prototype.l=function(){},Xi.prototype._=function(t){(this.u=t)(Oi.UNAUTHENTICATED)},Xi.prototype.T=function(){this.u=null},Xi),Fi=(Wi.prototype.getToken=function(){var e=this,n=this.I,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){if(e.I!==n)throw new Mi(Pi.ABORTED,"getToken aborted due to token change.");return t?(va("string"==typeof t.accessToken,"Invalid tokenData returned from getToken():"+t),new Vi(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},Wi.prototype.l=function(){this.forceRefresh=!0},Wi.prototype._=function(t){this.u=t,this.R&&t(this.currentUser)},Wi.prototype.T=function(){this.auth&&this.auth.removeAuthTokenListener(this.m),this.m=null,this.u=null},Wi.prototype.A=function(){var t=this.auth&&this.auth.getUid();return va(null===t||"string"==typeof t,"Received invalid UID: "+t),new Oi(t)},Wi),Gi=(Object.defineProperty(Yi.prototype,"o",{get:function(){var t={"X-Goog-AuthUser":this.V},e=this.P.auth.p([]);return e&&(t.Authorization=e),t},enumerable:!0,configurable:!0}),Yi),xi=(zi.prototype.getToken=function(){return Promise.resolve(new Gi(this.P,this.V))},zi.prototype._=function(t){t(Oi.h)},zi.prototype.T=function(){},zi.prototype.l=function(){},zi),ji=(Qi.now=function(){return Qi.fromMillis(Date.now())},Qi.fromDate=function(t){return Qi.fromMillis(t.getTime())},Qi.fromMillis=function(t){var e=Math.floor(t/1e3);return new Qi(e,1e6*(t-1e3*e))},Qi.prototype.toDate=function(){return new Date(this.toMillis())},Qi.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},Qi.prototype.g=function(t){return this.seconds===t.seconds?wa(this.nanoseconds,t.nanoseconds):wa(this.seconds,t.seconds)},Qi.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},Qi.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},Qi.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},Qi),Bi=(Hi.v=function(t){return new Hi(t)},Hi.S=function(){return Hi.MIN},Hi.prototype.C=function(t){return this.timestamp.g(t.timestamp)},Hi.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},Hi.prototype.D=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},Hi.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},Hi.prototype.F=function(){return this.timestamp},Hi);function Hi(t){this.timestamp=t}function Qi(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new Mi(Pi.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new Mi(Pi.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Mi(Pi.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new Mi(Pi.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function zi(t,e){this.P=t,this.V=e}function Yi(t,e){this.P=t,this.V=e,this.type="FirstParty",this.user=Oi.h}function Wi(t){var e=this;this.m=null,this.currentUser=Oi.UNAUTHENTICATED,this.R=!1,this.I=0,this.u=null,this.forceRefresh=!1,this.m=function(){e.I++,e.currentUser=e.A(),e.R=!0,e.u&&e.u(e.currentUser)},this.I=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.m):(this.m(null),t.get().then(function(t){e.auth=t,e.m&&e.auth.addAuthTokenListener(e.m)},function(){}))}function Xi(){this.u=null}function Ji(t,e){var n=this;return(n=Ui.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}Bi.MIN=new Bi(new ji(0,0));var Ki,Zi=(Object.defineProperty(er.prototype,"length",{get:function(){return this.N},enumerable:!0,configurable:!0}),er.prototype.isEqual=function(t){return 0===er.k(this,t)},er.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof er?t.forEach(function(t){e.push(t)}):e.push(t),this.L(e)},er.prototype.limit=function(){return this.offset+this.length},er.prototype.$=function(t){return t=void 0===t?1:t,this.L(this.segments,this.offset+t,this.length-t)},er.prototype.O=function(){return this.L(this.segments,this.offset,this.length-1)},er.prototype.M=function(){return this.segments[this.offset]},er.prototype.U=function(){return this.get(this.length-1)},er.prototype.get=function(t){return this.segments[this.offset+t]},er.prototype.q=function(){return 0===this.length},er.prototype.B=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},er.prototype.W=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},er.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},er.prototype.j=function(){return this.segments.slice(this.offset,this.limit())},er.k=function(t,e){for(var n=Math.min(t.length,e.length),i=0;i<n;i++){var r=t.get(i),o=e.get(i);if(r<o)return-1;if(o<r)return 1}return t.length<e.length?-1:t.length>e.length?1:0},er),$i=(n(tr,Ki=Zi),tr.prototype.L=function(t,e,n){return new tr(t,e,n)},tr.prototype.G=function(){return this.j().join("/")},tr.prototype.toString=function(){return this.G()},tr.K=function(t){if(0<=t.indexOf("//"))throw new Mi(Pi.INVALID_ARGUMENT,"Invalid path ("+t+"). Paths must not contain // in them.");return new tr(t.split("/").filter(function(t){return 0<t.length}))},tr);function tr(){return null!==Ki&&Ki.apply(this,arguments)||this}function er(t,e,n){void 0===e?e=0:e>t.length&&ya("offset "+e+" out of range "+t.length),void 0===n?n=t.length-e:n>t.length-e&&ya("length "+n+" out of range "+(t.length-e)),this.segments=t,this.offset=e,this.N=n}$i.H=new $i([]);var nr,ir=/^[_a-zA-Z][_a-zA-Z0-9]*$/,rr=(n(or,nr=Zi),or.prototype.L=function(t,e,n){return new or(t,e,n)},or.J=function(t){return ir.test(t)},or.prototype.G=function(){return this.j().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),or.J(t)||(t="`"+t+"`"),t}).join(".")},or.prototype.toString=function(){return this.G()},or.prototype.Y=function(){return 1===this.length&&"__name__"===this.get(0)},or.X=function(){return new or(["__name__"])},or.Z=function(t){for(var e=[],n="",i=0,r=function(){if(0===n.length)throw new Mi(Pi.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;i<t.length;){var s=t[i];if("\\"===s){if(i+1===t.length)throw new Mi(Pi.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var a=t[i+1];if("\\"!==a&&"."!==a&&"`"!==a)throw new Mi(Pi.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=a,i+=2}else"`"===s?o=!o:"."!==s||o?n+=s:r(),i++}if(r(),o)throw new Mi(Pi.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new or(e)},or);function or(){return null!==nr&&nr.apply(this,arguments)||this}rr.H=new rr([]);var sr=(ar.tt=function(t){return new ar($i.K(t).$(5))},ar.prototype.et=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},ar.prototype.isEqual=function(t){return null!==t&&0===$i.k(this.path,t.path)},ar.prototype.toString=function(){return this.path.toString()},ar.k=function(t,e){return $i.k(t.path,e.path)},ar.st=function(t){return t.length%2==0},ar.it=function(t){return new ar(new $i(t.slice()))},ar);function ar(t){this.path=t}sr.EMPTY=new sr(new $i([]));var ur=(pr.prototype.nt=function(t,e){return new pr(this.k,this.root.nt(t,e,this.k).rt(null,null,cr.ht,null,null))},pr.prototype.remove=function(t){return new pr(this.k,this.root.remove(t,this.k).rt(null,null,cr.ht,null,null))},pr.prototype.get=function(t){for(var e=this.root;!e.q();){var n=this.k(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},pr.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.q();){var i=this.k(t,n.key);if(0===i)return e+n.left.size;n=i<0?n.left:(e+=n.left.size+1,n.right)}return-1},pr.prototype.q=function(){return this.root.q()},Object.defineProperty(pr.prototype,"size",{get:function(){return this.root.size},enumerable:!0,configurable:!0}),pr.prototype.ot=function(){return this.root.ot()},pr.prototype.at=function(){return this.root.at()},pr.prototype.ut=function(t){return this.root.ut(t)},pr.prototype.forEach=function(n){this.ut(function(t,e){return n(t,e),!1})},pr.prototype.toString=function(){var n=[];return this.ut(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},pr.prototype.ct=function(t){return this.root.ct(t)},pr.prototype.lt=function(){return new hr(this.root,null,this.k,!1)},pr.prototype._t=function(t){return new hr(this.root,t,this.k,!1)},pr.prototype.dt=function(){return new hr(this.root,null,this.k,!0)},pr.prototype.ft=function(t){return new hr(this.root,t,this.k,!0)},pr),hr=(fr.prototype.Et=function(){var t=this.Tt.pop(),e={key:t.key,value:t.value};if(this.wt)for(t=t.left;!t.q();)this.Tt.push(t),t=t.right;else for(t=t.right;!t.q();)this.Tt.push(t),t=t.left;return e},fr.prototype.Rt=function(){return 0<this.Tt.length},fr.prototype.It=function(){if(0===this.Tt.length)return null;var t=this.Tt[this.Tt.length-1];return{key:t.key,value:t.value}},fr),cr=(lr.prototype.rt=function(t,e,n,i,r){return new lr(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=i?i:this.left,null!=r?r:this.right)},lr.prototype.q=function(){return!1},lr.prototype.ut=function(t){return this.left.ut(t)||t(this.key,this.value)||this.right.ut(t)},lr.prototype.ct=function(t){return this.right.ct(t)||t(this.key,this.value)||this.left.ct(t)},lr.prototype.min=function(){return this.left.q()?this:this.left.min()},lr.prototype.ot=function(){return this.min().key},lr.prototype.at=function(){return this.right.q()?this.key:this.right.at()},lr.prototype.nt=function(t,e,n){var i=this,r=n(t,i.key);return(i=r<0?i.rt(null,null,null,i.left.nt(t,e,n),null):0===r?i.rt(null,e,null,null,null):i.rt(null,null,null,null,i.right.nt(t,e,n))).At()},lr.prototype.Pt=function(){if(this.left.q())return lr.EMPTY;var t=this;return t.left.Vt()||t.left.left.Vt()||(t=t.pt()),(t=t.rt(null,null,null,t.left.Pt(),null)).At()},lr.prototype.remove=function(t,e){var n,i=this;if(e(t,i.key)<0)i.left.q()||i.left.Vt()||i.left.left.Vt()||(i=i.pt()),i=i.rt(null,null,null,i.left.remove(t,e),null);else{if(i.left.Vt()&&(i=i.gt()),i.right.q()||i.right.Vt()||i.right.left.Vt()||(i=i.yt()),0===e(t,i.key)){if(i.right.q())return lr.EMPTY;n=i.right.min(),i=i.rt(n.key,n.value,null,null,i.right.Pt())}i=i.rt(null,null,null,null,i.right.remove(t,e))}return i.At()},lr.prototype.Vt=function(){return this.color},lr.prototype.At=function(){var t=this;return t.right.Vt()&&!t.left.Vt()&&(t=t.bt()),t.left.Vt()&&t.left.left.Vt()&&(t=t.gt()),t.left.Vt()&&t.right.Vt()&&(t=t.vt()),t},lr.prototype.pt=function(){var t=this.vt();return t.right.left.Vt()&&(t=(t=(t=t.rt(null,null,null,null,t.right.gt())).bt()).vt()),t},lr.prototype.yt=function(){var t=this.vt();return t.left.left.Vt()&&(t=(t=t.gt()).vt()),t},lr.prototype.bt=function(){var t=this.rt(null,null,lr.RED,null,this.right.left);return this.right.rt(null,null,this.color,t,null)},lr.prototype.gt=function(){var t=this.rt(null,null,lr.RED,this.left.right,null);return this.left.rt(null,null,this.color,null,t)},lr.prototype.vt=function(){var t=this.left.rt(null,null,!this.left.color,null,null),e=this.right.rt(null,null,!this.right.color,null,null);return this.rt(null,null,!this.color,t,e)},lr.prototype.St=function(){var t=this.Ct();return Math.pow(2,t)<=this.size+1},lr.prototype.Ct=function(){if(this.Vt()&&this.left.Vt())throw ya("Red node has red child("+this.key+","+this.value+")");if(this.right.Vt())throw ya("Right child of ("+this.key+","+this.value+") is red");var t=this.left.Ct();if(t!==this.right.Ct())throw ya("Black depths differ");return t+(this.Vt()?0:1)},lr);function lr(t,e,n,i,r){this.key=t,this.value=e,this.color=null!=n?n:lr.RED,this.left=null!=i?i:lr.EMPTY,this.right=null!=r?r:lr.EMPTY,this.size=this.left.size+1+this.right.size}function fr(t,e,n,i){this.wt=i,this.Tt=[];for(var r=1;!t.q();)if(r=e?n(t.key,e):1,i&&(r*=-1),r<0)t=this.wt?t.left:t.right;else{if(0===r){this.Tt.push(t);break}this.Tt.push(t),t=this.wt?t.right:t.left}}function pr(t,e){this.k=t,this.root=e||cr.EMPTY}function dr(){this.size=0}cr.EMPTY=null,cr.RED=!0,cr.ht=!1,cr.EMPTY=(Object.defineProperty(dr.prototype,"key",{get:function(){throw ya("LLRBEmptyNode has no key.")},enumerable:!0,configurable:!0}),Object.defineProperty(dr.prototype,"value",{get:function(){throw ya("LLRBEmptyNode has no value.")},enumerable:!0,configurable:!0}),Object.defineProperty(dr.prototype,"color",{get:function(){throw ya("LLRBEmptyNode has no color.")},enumerable:!0,configurable:!0}),Object.defineProperty(dr.prototype,"left",{get:function(){throw ya("LLRBEmptyNode has no left child.")},enumerable:!0,configurable:!0}),Object.defineProperty(dr.prototype,"right",{get:function(){throw ya("LLRBEmptyNode has no right child.")},enumerable:!0,configurable:!0}),dr.prototype.rt=function(t,e,n,i,r){return this},dr.prototype.nt=function(t,e,n){return new cr(t,e)},dr.prototype.remove=function(t,e){return this},dr.prototype.q=function(){return!0},dr.prototype.ut=function(t){return!1},dr.prototype.ct=function(t){return!1},dr.prototype.ot=function(){return null},dr.prototype.at=function(){return null},dr.prototype.Vt=function(){return!1},dr.prototype.St=function(){return!0},dr.prototype.Ct=function(){return 0},new dr);var yr=(mr.prototype.has=function(t){return null!==this.data.get(t)},mr.prototype.first=function(){return this.data.ot()},mr.prototype.last=function(){return this.data.at()},Object.defineProperty(mr.prototype,"size",{get:function(){return this.data.size},enumerable:!0,configurable:!0}),mr.prototype.indexOf=function(t){return this.data.indexOf(t)},mr.prototype.forEach=function(n){this.data.ut(function(t,e){return n(t),!1})},mr.prototype.Dt=function(t,e){for(var n=this.data._t(t[0]);n.Rt();){var i=n.Et();if(0<=this.k(i.key,t[1]))return;e(i.key)}},mr.prototype.Ft=function(t,e){var n;for(n=void 0!==e?this.data._t(e):this.data.lt();n.Rt();)if(!t(n.Et().key))return},mr.prototype.Nt=function(t){var e=this.data._t(t);return e.Rt()?e.Et().key:null},mr.prototype.lt=function(){return new vr(this.data.lt())},mr.prototype._t=function(t){return new vr(this.data._t(t))},mr.prototype.add=function(t){return this.rt(this.data.remove(t).nt(t,!0))},mr.prototype.delete=function(t){return this.has(t)?this.rt(this.data.remove(t)):this},mr.prototype.q=function(){return this.data.q()},mr.prototype.kt=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},mr.prototype.isEqual=function(t){if(!(t instanceof mr))return!1;if(this.size!==t.size)return!1;for(var e=this.data.lt(),n=t.data.lt();e.Rt();){var i=e.Et().key,r=n.Et().key;if(0!==this.k(i,r))return!1}return!0},mr.prototype.j=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},mr.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},mr.prototype.rt=function(t){var e=new mr(this.k);return e.data=t,e},mr),vr=(gr.prototype.Et=function(){return this.Lt.Et().key},gr.prototype.Rt=function(){return this.Lt.Rt()},gr);function gr(t){this.Lt=t}function mr(t){this.k=t,this.data=new ur(this.k)}function wr(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function br(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Er(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Ar=(Ir.fromBase64String=function(t){return new Ir(aa.Ot().atob(t))},Ir.fromUint8Array=function(t){return new Ir(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},Ir.prototype.toBase64=function(){return aa.Ot().btoa(this.$t)},Ir.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.$t)},Ir.prototype.Mt=function(){return 2*this.$t.length},Ir.prototype.C=function(t){return wa(this.$t,t.$t)},Ir.prototype.isEqual=function(t){return this.$t===t.$t},Ir);function Ir(t){this.$t=t}function Nr(t){return null==t}function Tr(t){return-0===t&&1/t==-1/0}function _r(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function Sr(t){var e=Ur(t.mapValue.fields.__local_write_time__.timestampValue);return new ji(e.seconds,e.nanos)}Ar.Ut=new Ar("");var kr=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Rr(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?_r(t)?4:10:ya("Invalid value type: "+JSON.stringify(t))}function Lr(r,t){var e,n,i,o=Rr(r);if(o!==Rr(t))return!1;switch(o){case 0:return!0;case 1:return r.booleanValue===t.booleanValue;case 4:return Sr(r).isEqual(Sr(t));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=Ur(r.timestampValue),n=Ur(t.timestampValue);return e.seconds===n.seconds&&e.nanos===n.nanos}(t);case 5:return r.stringValue===t.stringValue;case 6:return i=t,Mr(r.bytesValue).isEqual(Mr(i.bytesValue));case 7:return r.referenceValue===t.referenceValue;case 8:return n=t,Pr((e=r).geoPointValue.latitude)===Pr(n.geoPointValue.latitude)&&Pr(e.geoPointValue.longitude)===Pr(n.geoPointValue.longitude);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return Pr(t.integerValue)===Pr(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=Pr(t.doubleValue),i=Pr(e.doubleValue);return n===i?Tr(n)===Tr(i):isNaN(n)&&isNaN(i)}return!1}(r,t);case 9:return ba(r.arrayValue.values||[],t.arrayValue.values||[],Lr);case 10:return function(t){var e=r.mapValue.fields||{},n=t.mapValue.fields||{};if(wr(e)!==wr(n))return!1;for(var i in e)if(e.hasOwnProperty(i)&&(void 0===n[i]||!Lr(e[i],n[i])))return!1;return!0}(t);default:return ya("Unexpected value type: "+JSON.stringify(r))}}function Dr(t,e){return void 0!==(t.values||[]).find(function(t){return Lr(t,e)})}function Or(t,e){var n,i,r,o,s,a,u,h,c,l,f=Rr(t),p=Rr(e);if(f!==p)return wa(f,p);switch(f){case 0:return 0;case 1:return wa(t.booleanValue,e.booleanValue);case 2:return h=e,(c=Pr(t.integerValue||t.doubleValue))<(l=Pr(h.integerValue||h.doubleValue))?-1:l<c?1:c===l?0:isNaN(c)?isNaN(l)?0:-1:1;case 3:return Cr(t.timestampValue,e.timestampValue);case 4:return Cr(Sr(t),Sr(e));case 5:return wa(t.stringValue,e.stringValue);case 6:return o=t.bytesValue,s=e.bytesValue,a=Mr(o),u=Mr(s),a.C(u);case 7:return function(t,e){for(var n=t.split("/"),i=e.split("/"),r=0;r<n.length&&r<i.length;r++){var o=wa(n[r],i[r]);if(0!==o)return o}return wa(n.length,i.length)}(t.referenceValue,e.referenceValue);case 8:return n=t.geoPointValue,i=e.geoPointValue,0!==(r=wa(Pr(n.latitude),Pr(i.latitude)))?r:wa(Pr(n.longitude),Pr(i.longitude));case 9:return function(t,e){for(var n=t.values||[],i=e.values||[],r=0;r<n.length&&r<i.length;++r){var o=Or(n[r],i[r]);if(o)return o}return wa(n.length,i.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},i=Object.keys(n),r=e.fields||{},o=Object.keys(r);i.sort(),o.sort();for(var s=0;s<i.length&&s<o.length;++s){var a=wa(i[s],o[s]);if(0!==a)return a;var u=Or(n[i[s]],r[o[s]]);if(0!==u)return u}return wa(i.length,o.length)}(t.mapValue,e.mapValue);default:throw ya("Invalid value type: "+f)}}function Cr(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return wa(t,e);var n=Ur(t),i=Ur(e),r=wa(n.seconds,i.seconds);return 0!==r?r:wa(n.nanos,i.nanos)}function Vr(t){return function s(r){return"nullValue"in r?"null":"booleanValue"in r?""+r.booleanValue:"integerValue"in r?""+r.integerValue:"doubleValue"in r?""+r.doubleValue:"timestampValue"in r?"time("+(t=Ur(r.timestampValue)).seconds+","+t.nanos+")":"stringValue"in r?r.stringValue:"bytesValue"in r?Mr(r.bytesValue).toBase64():"referenceValue"in r?(n=r.referenceValue,sr.tt(n).toString()):"geoPointValue"in r?"geo("+(e=r.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in r?function(){for(var t="[",e=!0,n=0,i=r.arrayValue.values||[];n<i.length;n++)e?e=!1:t+=",",t+=s(i[n]);return t+"]"}():"mapValue"in r?function(t){for(var e="{",n=!0,i=0,r=Object.keys(t.fields||{}).sort();i<r.length;i++){var o=r[i];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(r.mapValue):ya("Invalid value type: "+JSON.stringify(r));var t,e,n}(t)}function Ur(t){if(va(!!t,"Cannot normalize null or undefined timestamp."),"string"!=typeof t)return{seconds:Pr(t.seconds),nanos:Pr(t.nanos)};var e=0,n=kr.exec(t);if(va(!!n,"invalid timestamp: "+t),n[1]){var i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}var r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}function Pr(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Mr(t){return"string"==typeof t?Ar.fromBase64String(t):Ar.fromUint8Array(t)}function qr(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.G()}}function Fr(t){return t&&"integerValue"in t}function Gr(t){return!!t&&"arrayValue"in t}function xr(t){return t&&"nullValue"in t}function jr(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Br(t){return t&&"mapValue"in t}var Hr=(Qr.prototype.qt=function(t,e){return n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}},t&&(n.fields.__previous_value__=t),{mapValue:n};var n},Qr.prototype.Bt=function(t,e){return e},Qr.prototype.xt=function(t){return null},Qr.prototype.isEqual=function(t){return t instanceof Qr},Qr);function Qr(){}Hr.instance=new Hr;var zr=(Kr.prototype.qt=function(t,e){return this.apply(t)},Kr.prototype.Bt=function(t,e){return this.apply(t)},Kr.prototype.apply=function(t){for(var n=Zr(t),e=function(e){n.some(function(t){return Lr(t,e)})||n.push(e)},i=0,r=this.elements;i<r.length;i++)e(r[i]);return{arrayValue:{values:n}}},Kr.prototype.xt=function(t){return null},Kr.prototype.isEqual=function(t){return t instanceof Kr&&ba(this.elements,t.elements,Lr)},Kr),Yr=(Jr.prototype.qt=function(t,e){return this.apply(t)},Jr.prototype.Bt=function(t,e){return this.apply(t)},Jr.prototype.apply=function(t){for(var n=Zr(t),e=function(e){n=n.filter(function(t){return!Lr(t,e)})},i=0,r=this.elements;i<r.length;i++)e(r[i]);return{arrayValue:{values:n}}},Jr.prototype.xt=function(t){return null},Jr.prototype.isEqual=function(t){return t instanceof Jr&&ba(this.elements,t.elements,Lr)},Jr),Wr=(Xr.prototype.qt=function(t,e){var n=this.xt(t),i=this.asNumber(n)+this.asNumber(this.Qt);return Fr(n)&&Fr(this.Qt)?this.serializer.Wt(i):this.serializer.jt(i)},Xr.prototype.Bt=function(t,e){return e},Xr.prototype.xt=function(t){return Fr(e=t)||e&&"doubleValue"in e?t:{integerValue:0};var e},Xr.prototype.isEqual=function(t){return t instanceof Xr&&Lr(this.Qt,t.Qt)},Xr.prototype.asNumber=function(t){return Pr(t.integerValue||t.doubleValue)},Xr);function Xr(t,e){this.serializer=t,this.Qt=e}function Jr(t){this.elements=t}function Kr(t){this.elements=t}function Zr(t){return Gr(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function $r(t,e){this.version=t,this.transformResults=e}var to=(oo.Gt=function(t){return new oo(t)},oo.zt=function(t){var e=new yr(rr.k);return t.forEach(function(t){return e=e.add(t)}),new oo(e)},oo.prototype.Kt=function(e){var n=!1;return this.fields.forEach(function(t){t.B(e)&&(n=!0)}),n},oo.prototype.isEqual=function(t){return this.fields.isEqual(t.fields)},oo),eo=(ro.prototype.isEqual=function(t){return this.field.isEqual(t.field)&&this.transform.isEqual(t.transform)},ro),no=(io.exists=function(t){return new io(void 0,t)},io.updateTime=function(t){return new io(t)},Object.defineProperty(io.prototype,"Ht",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!0,configurable:!0}),io.prototype.Jt=function(t){return void 0!==this.updateTime?t instanceof Do&&t.version.isEqual(this.updateTime):void 0===this.exists||this.exists===t instanceof Do},io.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},io);function io(t,e){this.updateTime=t,this.exists=e}function ro(t,e){this.field=t,this.transform=e}function oo(t){this.fields=t}no.NONE=new no;var so,ao,uo,ho,co,lo=(To.prototype.Yt=function(t){},To.Xt=function(t){return t instanceof Do?t.version:Bi.MIN},To),fo=(n(No,co=lo),No.prototype.Bt=function(t,e){this.Yt(t);var n=e.version;return new Do(this.key,n,this.value,{hasCommittedMutations:!0})},No.prototype.qt=function(t,e,n){if(this.Yt(t),!this.Zt.Jt(t))return t;var i=lo.Xt(t);return new Do(this.key,i,this.value,{te:!0})},No.prototype.ee=function(t){return null},No.prototype.isEqual=function(t){return t instanceof No&&this.key.isEqual(t.key)&&this.value.isEqual(t.value)&&this.Zt.isEqual(t.Zt)},No),po=(n(Io,ho=lo),Io.prototype.Bt=function(t,e){if(this.Yt(t),!this.Zt.Jt(t))return new Co(this.key,e.version);var n=this.ie(t);return new Do(this.key,e.version,n,{hasCommittedMutations:!0})},Io.prototype.qt=function(t,e,n){if(this.Yt(t),!this.Zt.Jt(t))return t;var i=lo.Xt(t),r=this.ie(t);return new Do(this.key,i,r,{te:!0})},Io.prototype.ee=function(t){return null},Io.prototype.isEqual=function(t){return t instanceof Io&&this.key.isEqual(t.key)&&this.se.isEqual(t.se)&&this.Zt.isEqual(t.Zt)},Io.prototype.ie=function(t){var e;return e=t instanceof Do?t.data():mo.EMPTY,this.ne(e)},Io.prototype.ne=function(t){var n=this,i=t.re();return this.se.fields.forEach(function(t){if(!t.q()){var e=n.data.field(t);null!==e?i.set(t,e):i.delete(t)}}),i.he()},Io),yo=(n(Ao,uo=lo),Ao.prototype.Bt=function(t,e){if(this.Yt(t),va(null!=e.transformResults,"Transform results missing for TransformMutation."),!this.Zt.Jt(t))return new Co(this.key,e.version);var n=this.oe(t),i=this.ae(t,e.transformResults),r=e.version,o=this.ue(n.data(),i);return new Do(this.key,r,o,{hasCommittedMutations:!0})},Ao.prototype.qt=function(t,e,n){if(this.Yt(t),!this.Zt.Jt(t))return t;var i=this.oe(t),r=this.ce(n,t,e),o=this.ue(i.data(),r);return new Do(this.key,i.version,o,{te:!0})},Ao.prototype.ee=function(t){for(var e=null,n=0,i=this.fieldTransforms;n<i.length;n++){var r=i[n],o=t instanceof Do?t.field(r.field):void 0,s=r.transform.xt(o||null);null!=s&&(e=null==e?mo.le().set(r.field,s):e.set(r.field,s))}return e?e.he():null},Ao.prototype.isEqual=function(t){return t instanceof Ao&&this.key.isEqual(t.key)&&ba(this.fieldTransforms,t.fieldTransforms,function(t,e){return t.isEqual(e)})&&this.Zt.isEqual(t.Zt)},Ao.prototype.oe=function(t){return t},Ao.prototype.ae=function(t,e){var n=[];va(this.fieldTransforms.length===e.length,"server transform result count ("+e.length+") should match field transform count ("+this.fieldTransforms.length+")");for(var i=0;i<e.length;i++){var r=this.fieldTransforms[i],o=r.transform,s=null;t instanceof Do&&(s=t.field(r.field)),n.push(o.Bt(s,e[i]))}return n},Ao.prototype.ce=function(t,e,n){for(var i=[],r=0,o=this.fieldTransforms;r<o.length;r++){var s=o[r],a=s.transform,u=null;e instanceof Do&&(u=e.field(s.field)),null===u&&n instanceof Do&&(u=n.field(s.field)),i.push(a.qt(u,t))}return i},Ao.prototype.ue=function(t,e){for(var n=t.re(),i=0;i<this.fieldTransforms.length;i++){var r=this.fieldTransforms[i].field;n.set(r,e[i])}return n.he()},Ao),vo=(n(Eo,ao=lo),Eo.prototype.Bt=function(t,e){return this.Yt(t),new Oo(this.key,e.version,{hasCommittedMutations:!0})},Eo.prototype.qt=function(t,e,n){return this.Yt(t),this.Zt.Jt(t)?new Oo(this.key,Bi.S()):t},Eo.prototype.ee=function(t){return null},Eo.prototype.isEqual=function(t){return t instanceof Eo&&this.key.isEqual(t.key)&&this.Zt.isEqual(t.Zt)},Eo),go=(n(bo,so=lo),bo.prototype.Bt=function(t,e){ya("VerifyMutation should only be used in Transactions.")},bo.prototype.qt=function(t,e,n){ya("VerifyMutation should only be used in Transactions.")},bo.prototype.ee=function(t){ya("VerifyMutation should only be used in Transactions.")},bo.prototype.isEqual=function(t){return t instanceof bo&&this.key.isEqual(t.key)&&this.Zt.isEqual(t.Zt)},bo),mo=(wo.le=function(){return wo.EMPTY.re()},wo.prototype.field=function(t){if(t.q())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!Br(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.U()])||null},wo.prototype.se=function(){return this._e(this.proto.mapValue)},wo.prototype._e=function(t){var r=this,o=new yr(rr.k);return br(t.fields||{},function(t,e){var n=new rr([t]);if(10===Rr(e)){var i=r._e(e.mapValue).fields;i.q()?o=o.add(n):i.forEach(function(t){o=o.add(n.child(t))})}else o=o.add(n)}),to.Gt(o)},wo.prototype.isEqual=function(t){return Lr(this.proto,t.proto)},wo.prototype.re=function(){return new Ro(this)},wo);function wo(t){this.proto=t}function bo(t,e){var n=this;return(n=so.call(this)||this).key=t,n.Zt=e,n.type=4,n}function Eo(t,e){var n=this;return(n=ao.call(this)||this).key=t,n.Zt=e,n.type=3,n}function Ao(t,e){var n=this;return(n=uo.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.Zt=no.exists(!0),n}function Io(t,e,n,i){var r=this;return(r=ho.call(this)||this).key=t,r.data=e,r.se=n,r.Zt=i,r.type=1,r}function No(t,e,n){var i=this;return(i=co.call(this)||this).key=t,i.value=e,i.Zt=n,i.type=0,i}function To(){}mo.EMPTY=new mo({mapValue:{}});var _o,So,ko,Ro=(Ho.prototype.set=function(t,e){return this.we(t,e),this},Ho.prototype.delete=function(t){return this.we(t,null),this},Ho.prototype.we=function(t,e){for(var n=this.fe,i=0;i<t.length-1;++i){var r=t.get(i),o=n.get(r);o instanceof Map||(o=o&&10===Rr(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(r,o)),n=o}n.set(t.U(),e)},Ho.prototype.he=function(){var t=this.Te(rr.H,this.fe);return null!=t?new mo(t):this.de},Ho.prototype.Te=function(i,t){var r=this,o=!1,e=this.de.field(i),s=Br(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){if(t instanceof Map){var n=r.Te(i.child(e),t);null!=n&&(s[e]=n,o=!0)}else null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},Ho),Lo=(Bo.me=function(t,e){return sr.k(t.key,e.key)},Bo),Do=(n(jo,ko=Lo),jo.prototype.field=function(t){return this.Ee.field(t)},jo.prototype.data=function(){return this.Ee},jo.prototype.Re=function(){return this.Ee.proto},jo.prototype.isEqual=function(t){return t instanceof jo&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.te===t.te&&this.hasCommittedMutations===t.hasCommittedMutations&&this.Ee.isEqual(t.Ee)},jo.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.Ee.toString()+", {hasLocalMutations: "+this.te+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(jo.prototype,"hasPendingWrites",{get:function(){return this.te||this.hasCommittedMutations},enumerable:!0,configurable:!0}),jo.Ie=function(t,e,n){var i=e.field(t),r=n.field(t);return null!==i&&null!==r?Or(i,r):ya("Trying to compare documents on fields that don't exist")},jo),Oo=(n(xo,So=Lo),xo.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(xo.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!0,configurable:!0}),xo.prototype.isEqual=function(t){return t instanceof xo&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},xo),Co=(n(Go,_o=Lo),Go.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(Go.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!0,configurable:!0}),Go.prototype.isEqual=function(t){return t instanceof Go&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},Go),Vo=(Fo.prototype.canonicalId=function(){if(null===this.Ae){var t=this.path.G();null!==this.collectionGroup&&(t+="|cg:"+this.collectionGroup),t+="|f:",t+=this.filters.map(function(t){return t.canonicalId()}).join(","),t+="|ob:",t+=this.orderBy.map(function(t){return t.canonicalId()}).join(","),Nr(this.limit)||(t+="|l:",t+=this.limit),this.startAt&&(t+="|lb:",t+=this.startAt.canonicalId()),this.endAt&&(t+="|ub:",t+=this.endAt.canonicalId()),this.Ae=t}return this.Ae},Fo.prototype.toString=function(){var t=this.path.G();return null!==this.collectionGroup&&(t+=" collectionGroup="+this.collectionGroup),0<this.filters.length&&(t+=", filters: ["+this.filters.join(", ")+"]"),Nr(this.limit)||(t+=", limit: "+this.limit),0<this.orderBy.length&&(t+=", orderBy: ["+this.orderBy.join(", ")+"]"),this.startAt&&(t+=", startAt: "+this.startAt.canonicalId()),this.endAt&&(t+=", endAt: "+this.endAt.canonicalId()),"Target("+t+")"},Fo.prototype.isEqual=function(t){if(this.limit!==t.limit)return!1;if(this.orderBy.length!==t.orderBy.length)return!1;for(var e=0;e<this.orderBy.length;e++)if(!this.orderBy[e].isEqual(t.orderBy[e]))return!1;if(this.filters.length!==t.filters.length)return!1;for(var n=0;n<this.filters.length;n++)if(!this.filters[n].isEqual(t.filters[n]))return!1;return this.collectionGroup===t.collectionGroup&&!!this.path.isEqual(t.path)&&!!(null!==this.startAt?this.startAt.isEqual(t.startAt):null===t.startAt)&&(null!==this.endAt?this.endAt.isEqual(t.endAt):null===t.endAt)},Fo.prototype.Pe=function(){return sr.st(this.path)&&null===this.collectionGroup&&0===this.filters.length},Fo),Uo=(qo.ve=function(t){return new qo(t)},Object.defineProperty(qo.prototype,"orderBy",{get:function(){if(null===this.ge){var t=this.Se(),e=this.Ce();if(null!==t&&null===e)t.Y()?this.ge=[vs]:this.ge=[new ys(t),vs];else{for(var n=!(this.ge=[]),i=0,r=this.Ve;i<r.length;i++){var o=r[i];this.ge.push(o),o.field.Y()&&(n=!0)}if(!n){var s=0<this.Ve.length?this.Ve[this.Ve.length-1].dir:is.ASCENDING;this.ge.push(s===is.ASCENDING?vs:gs)}}}return this.ge},enumerable:!0,configurable:!0}),qo.prototype.De=function(t){var e=this.filters.concat([t]);return new qo(this.path,this.collectionGroup,this.Ve.slice(),e,this.limit,this.pe,this.startAt,this.endAt)},qo.prototype.Fe=function(t){var e=this.Ve.concat([t]);return new qo(this.path,this.collectionGroup,e,this.filters.slice(),this.limit,this.pe,this.startAt,this.endAt)},qo.prototype.Ne=function(t){return new qo(this.path,this.collectionGroup,this.Ve.slice(),this.filters.slice(),t,"F",this.startAt,this.endAt)},qo.prototype.ke=function(t){return new qo(this.path,this.collectionGroup,this.Ve.slice(),this.filters.slice(),t,"L",this.startAt,this.endAt)},qo.prototype.Le=function(t){return new qo(this.path,this.collectionGroup,this.Ve.slice(),this.filters.slice(),this.limit,this.pe,t,this.endAt)},qo.prototype.$e=function(t){return new qo(this.path,this.collectionGroup,this.Ve.slice(),this.filters.slice(),this.limit,this.pe,this.startAt,t)},qo.prototype.Oe=function(t){return new qo(t,null,this.Ve.slice(),this.filters.slice(),this.limit,this.pe,this.startAt,this.endAt)},qo.prototype.Me=function(){return 0===this.filters.length&&null===this.limit&&null==this.startAt&&null==this.endAt&&(0===this.Ve.length||1===this.Ve.length&&this.Ve[0].field.Y())},qo.prototype.canonicalId=function(){return this.Ue().canonicalId()+"|lt:"+this.pe},qo.prototype.toString=function(){return"Query(target="+this.Ue().toString()+"; limitType="+this.pe+")"},qo.prototype.isEqual=function(t){return this.Ue().isEqual(t.Ue())&&this.pe===t.pe},qo.prototype.qe=function(t,e){for(var n=!1,i=0,r=this.orderBy;i<r.length;i++){var o=r[i],s=o.compare(t,e);if(0!==s)return s;n=n||o.field.Y()}return 0},qo.prototype.matches=function(t){return this.Be(t)&&this.xe(t)&&this.Qe(t)&&this.We(t)},qo.prototype.je=function(){return!Nr(this.limit)&&"F"===this.pe},qo.prototype.Ge=function(){return!Nr(this.limit)&&"L"===this.pe},qo.prototype.Ce=function(){return 0<this.Ve.length?this.Ve[0].field:null},qo.prototype.Se=function(){for(var t=0,e=this.filters;t<e.length;t++){var n=e[t];if(n instanceof Ko&&n.ze())return n.field}return null},qo.prototype.Ke=function(t){for(var e=0,n=this.filters;e<n.length;e++){var i=n[e];if(i instanceof Ko&&0<=t.indexOf(i.op))return i.op}return null},qo.prototype.Pe=function(){return this.Ue().Pe()},qo.prototype.He=function(){return null!==this.collectionGroup},qo.prototype.Ue=function(){if(!this.ye)if("F"===this.pe)this.ye=new Vo(this.path,this.collectionGroup,this.orderBy,this.filters,this.limit,this.startAt,this.endAt);else{for(var t=[],e=0,n=this.orderBy;e<n.length;e++){var i=n[e],r=i.dir===is.DESCENDING?is.ASCENDING:is.DESCENDING;t.push(new ys(i.field,r))}var o=this.endAt?new ds(this.endAt.position,!this.endAt.before):null,s=this.startAt?new ds(this.startAt.position,!this.startAt.before):null;this.ye=new Vo(this.path,this.collectionGroup,t,this.filters,this.limit,o,s)}return this.ye},qo.prototype.Be=function(t){var e=t.key.path;return null!==this.collectionGroup?t.key.et(this.collectionGroup)&&this.path.B(e):sr.st(this.path)?this.path.isEqual(e):this.path.W(e)},qo.prototype.xe=function(t){for(var e=0,n=this.Ve;e<n.length;e++){var i=n[e];if(!i.field.Y()&&null===t.field(i.field))return!1}return!0},qo.prototype.Qe=function(t){for(var e=0,n=this.filters;e<n.length;e++)if(!n[e].matches(t))return!1;return!0},qo.prototype.We=function(t){return!(this.startAt&&!this.startAt.Je(this.orderBy,t)||this.endAt&&this.endAt.Je(this.orderBy,t))},qo.prototype.be=function(t){},qo),Po=(Mo.K=function(t){switch(t){case"<":return Mo.LESS_THAN;case"<=":return Mo.LESS_THAN_OR_EQUAL;case"==":return Mo.EQUAL;case">=":return Mo.GREATER_THAN_OR_EQUAL;case">":return Mo.GREATER_THAN;case"array-contains":return Mo.ARRAY_CONTAINS;case"in":return Mo.IN;case"array-contains-any":return Mo.ARRAY_CONTAINS_ANY;default:return ya("Unknown FieldFilter operator: "+t)}},Mo.prototype.toString=function(){return this.name},Mo.prototype.isEqual=function(t){return this.name===t.name},Mo);function Mo(t){this.name=t}function qo(t,e,n,i,r,o,s,a){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===i&&(i=[]),void 0===r&&(r=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===a&&(a=null),this.path=t,this.collectionGroup=e,this.Ve=n,this.filters=i,this.limit=r,this.pe=o,this.startAt=s,this.endAt=a,this.ge=null,this.ye=null,this.startAt&&this.be(this.startAt),this.endAt&&this.be(this.endAt)}function Fo(t,e,n,i,r,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===i&&(i=[]),void 0===r&&(r=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=i,this.limit=r,this.startAt=o,this.endAt=s,this.Ae=null}function Go(){return null!==_o&&_o.apply(this,arguments)||this}function xo(t,e,n){var i=this;return(i=So.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),i}function jo(t,e,n,i){var r=this;return(r=ko.call(this,t,e)||this).Ee=n,r.te=!!i.te,r.hasCommittedMutations=!!i.hasCommittedMutations,r}function Bo(t,e){this.key=t,this.version=e}function Ho(t){this.de=t,this.fe=new Map}Po.LESS_THAN=new Po("<"),Po.LESS_THAN_OR_EQUAL=new Po("<="),Po.EQUAL=new Po("=="),Po.GREATER_THAN=new Po(">"),Po.GREATER_THAN_OR_EQUAL=new Po(">="),Po.ARRAY_CONTAINS=new Po("array-contains"),Po.IN=new Po("in"),Po.ARRAY_CONTAINS_ANY=new Po("array-contains-any");var Qo,zo,Yo,Wo,Xo,Jo,Ko=(n(cs,Jo=function(){}),cs.create=function(t,e,n){if(t.Y())return e===Po.IN?new $o(t,n):new Zo(t,e,n);if(xr(n)){if(e!==Po.EQUAL)throw new Mi(Pi.INVALID_ARGUMENT,"Invalid query. Null supports only equality comparisons.");return new cs(t,e,n)}if(jr(n)){if(e!==Po.EQUAL)throw new Mi(Pi.INVALID_ARGUMENT,"Invalid query. NaN supports only equality comparisons.");return new cs(t,e,n)}return e===Po.ARRAY_CONTAINS?new ts(t,n):e===Po.IN?new es(t,n):e===Po.ARRAY_CONTAINS_ANY?new ns(t,n):new cs(t,e,n)},cs.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&Rr(this.value)===Rr(e)&&this.Ye(Or(e,this.value))},cs.prototype.Ye=function(t){switch(this.op){case Po.LESS_THAN:return t<0;case Po.LESS_THAN_OR_EQUAL:return t<=0;case Po.EQUAL:return 0===t;case Po.GREATER_THAN:return 0<t;case Po.GREATER_THAN_OR_EQUAL:return 0<=t;default:return ya("Unknown FieldFilter operator: "+this.op)}},cs.prototype.ze=function(){return 0<=[Po.LESS_THAN,Po.LESS_THAN_OR_EQUAL,Po.GREATER_THAN,Po.GREATER_THAN_OR_EQUAL].indexOf(this.op)},cs.prototype.canonicalId=function(){return this.field.G()+this.op.toString()+Vr(this.value)},cs.prototype.isEqual=function(t){return t instanceof cs&&this.op.isEqual(t.op)&&this.field.isEqual(t.field)&&Lr(this.value,t.value)},cs.prototype.toString=function(){return this.field.G()+" "+this.op+" "+Vr(this.value)},cs),Zo=(n(hs,Xo=Ko),hs.prototype.matches=function(t){var e=sr.k(t.key,this.key);return this.Ye(e)},hs),$o=(n(us,Wo=Ko),us.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},us),ts=(n(as,Yo=Ko),as.prototype.matches=function(t){var e=t.field(this.field);return Gr(e)&&Dr(e.arrayValue,this.value)},as),es=(n(ss,zo=Ko),ss.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&Dr(this.value.arrayValue,e)},ss),ns=(n(os,Qo=Ko),os.prototype.matches=function(t){var e=this,n=t.field(this.field);return!(!Gr(n)||!n.arrayValue.values)&&n.arrayValue.values.some(function(t){return Dr(e.value.arrayValue,t)})},os),is=(rs.prototype.toString=function(){return this.name},rs);function rs(t){this.name=t}function os(t,e){return Qo.call(this,t,Po.ARRAY_CONTAINS_ANY,e)||this}function ss(t,e){return zo.call(this,t,Po.IN,e)||this}function as(t,e){return Yo.call(this,t,Po.ARRAY_CONTAINS,e)||this}function us(t,e){var n=this;return(n=Wo.call(this,t,Po.IN,e)||this).keys=(e.arrayValue.values||[]).map(function(t){return sr.tt(t.referenceValue)}),n}function hs(t,e,n){var i=this;return(i=Xo.call(this,t,e,n)||this).key=sr.tt(n.referenceValue),i}function cs(t,e,n){var i=this;return(i=Jo.call(this)||this).field=t,i.op=e,i.value=n,i}function ls(t){this.count=t}is.ASCENDING=new is("asc"),is.DESCENDING=new is("desc");var fs,ps,ds=(Es.prototype.canonicalId=function(){return(this.before?"b":"a")+":"+this.position.map(function(t){return Vr(t)}).join(",")},Es.prototype.Je=function(t,e){for(var n=0,i=0;i<this.position.length;i++){var r=t[i],o=this.position[i];if(n=r.field.Y()?sr.k(sr.tt(o.referenceValue),e.key):Or(o,e.field(r.field)),r.dir===is.DESCENDING&&(n*=-1),0!==n)break}return this.before?n<=0:n<0},Es.prototype.isEqual=function(t){if(null===t)return!1;if(this.before!==t.before||this.position.length!==t.position.length)return!1;for(var e=0;e<this.position.length;e++)if(!Lr(this.position[e],t.position[e]))return!1;return!0},Es),ys=(bs.prototype.compare=function(t,e){var n=this.Xe?Do.me(t,e):Do.Ie(this.field,t,e);switch(this.dir){case is.ASCENDING:return n;case is.DESCENDING:return-1*n;default:return ya("Unknown direction: "+this.dir)}},bs.prototype.canonicalId=function(){return this.field.G()+this.dir.toString()},bs.prototype.toString=function(){return this.field.G()+" ("+this.dir+")"},bs.prototype.isEqual=function(t){return this.dir===t.dir&&this.field.isEqual(t.field)},bs),vs=new ys(rr.X(),is.ASCENDING),gs=new ys(rr.X(),is.DESCENDING),ms=(ws.prototype.es=function(t){return new ws(this.target,this.targetId,this.Ze,t,this.ts,this.lastLimboFreeSnapshotVersion,this.resumeToken)},ws.prototype.ss=function(t,e){return new ws(this.target,this.targetId,this.Ze,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},ws.prototype.ns=function(t){return new ws(this.target,this.targetId,this.Ze,this.sequenceNumber,this.ts,t,this.resumeToken)},ws);function ws(t,e,n,i,r,o,s){void 0===r&&(r=Bi.MIN),void 0===o&&(o=Bi.MIN),void 0===s&&(s=Ar.Ut),this.target=t,this.targetId=e,this.Ze=n,this.sequenceNumber=i,this.ts=r,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function bs(t,e){this.field=t,void 0===e&&(e=is.ASCENDING),this.dir=e,this.Xe=t.Y()}function Es(t,e){this.position=t,this.before=e}function As(t){switch(t){case Pi.OK:return ya("Treated status OK as error");case Pi.CANCELLED:case Pi.UNKNOWN:case Pi.DEADLINE_EXCEEDED:case Pi.RESOURCE_EXHAUSTED:case Pi.INTERNAL:case Pi.UNAVAILABLE:case Pi.UNAUTHENTICATED:return;case Pi.INVALID_ARGUMENT:case Pi.NOT_FOUND:case Pi.ALREADY_EXISTS:case Pi.PERMISSION_DENIED:case Pi.FAILED_PRECONDITION:case Pi.ABORTED:case Pi.OUT_OF_RANGE:case Pi.UNIMPLEMENTED:case Pi.DATA_LOSS:return 1;default:return ya("Unknown status code: "+t)}}function Is(t){if(void 0===t)return pa("GRPC error has no .code"),Pi.UNKNOWN;switch(t){case fs.OK:return Pi.OK;case fs.CANCELLED:return Pi.CANCELLED;case fs.UNKNOWN:return Pi.UNKNOWN;case fs.DEADLINE_EXCEEDED:return Pi.DEADLINE_EXCEEDED;case fs.RESOURCE_EXHAUSTED:return Pi.RESOURCE_EXHAUSTED;case fs.INTERNAL:return Pi.INTERNAL;case fs.UNAVAILABLE:return Pi.UNAVAILABLE;case fs.UNAUTHENTICATED:return Pi.UNAUTHENTICATED;case fs.INVALID_ARGUMENT:return Pi.INVALID_ARGUMENT;case fs.NOT_FOUND:return Pi.NOT_FOUND;case fs.ALREADY_EXISTS:return Pi.ALREADY_EXISTS;case fs.PERMISSION_DENIED:return Pi.PERMISSION_DENIED;case fs.FAILED_PRECONDITION:return Pi.FAILED_PRECONDITION;case fs.ABORTED:return Pi.ABORTED;case fs.OUT_OF_RANGE:return Pi.OUT_OF_RANGE;case fs.UNIMPLEMENTED:return Pi.UNIMPLEMENTED;case fs.DATA_LOSS:return Pi.DATA_LOSS;default:return ya("Unknown status code: "+t)}}(ps=fs=fs||{})[ps.OK=0]="OK",ps[ps.CANCELLED=1]="CANCELLED",ps[ps.UNKNOWN=2]="UNKNOWN",ps[ps.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ps[ps.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ps[ps.NOT_FOUND=5]="NOT_FOUND",ps[ps.ALREADY_EXISTS=6]="ALREADY_EXISTS",ps[ps.PERMISSION_DENIED=7]="PERMISSION_DENIED",ps[ps.UNAUTHENTICATED=16]="UNAUTHENTICATED",ps[ps.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ps[ps.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ps[ps.ABORTED=10]="ABORTED",ps[ps.OUT_OF_RANGE=11]="OUT_OF_RANGE",ps[ps.UNIMPLEMENTED=12]="UNIMPLEMENTED",ps[ps.INTERNAL=13]="INTERNAL",ps[ps.UNAVAILABLE=14]="UNAVAILABLE",ps[ps.DATA_LOSS=15]="DATA_LOSS";var Ns=new ur(sr.k);function Ts(){return Ns}function _s(){return Ts()}var Ss=new ur(sr.k);function ks(){return Ss}var Rs=new ur(sr.k);function Ls(){return Rs}var Ds=new yr(sr.k);function Os(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Ds,i=0,r=t;i<r.length;i++){var o=r[i];n=n.add(o)}return n}var Cs=new yr(wa);function Vs(){return Cs}function Us(t,e,n,i){this.gs=t,this.removedTargetIds=e,this.key=n,this.ys=i}function Ps(t,e){this.targetId=t,this.bs=e}function Ms(t,e,n,i){void 0===n&&(n=Ar.Ut),void 0===i&&(i=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=i}var qs=(Ks.os=function(t){return new Ks(t.k)},Ks.prototype.has=function(t){return null!=this.rs.get(t)},Ks.prototype.get=function(t){return this.rs.get(t)},Ks.prototype.first=function(){return this.hs.ot()},Ks.prototype.last=function(){return this.hs.at()},Ks.prototype.q=function(){return this.hs.q()},Ks.prototype.indexOf=function(t){var e=this.rs.get(t);return e?this.hs.indexOf(e):-1},Object.defineProperty(Ks.prototype,"size",{get:function(){return this.hs.size},enumerable:!0,configurable:!0}),Ks.prototype.forEach=function(n){this.hs.ut(function(t,e){return n(t),!1})},Ks.prototype.add=function(t){var e=this.delete(t.key);return e.rt(e.rs.nt(t.key,t),e.hs.nt(t,null))},Ks.prototype.delete=function(t){var e=this.get(t);return e?this.rt(this.rs.remove(t),this.hs.remove(e)):this},Ks.prototype.isEqual=function(t){if(!(t instanceof Ks))return!1;if(this.size!==t.size)return!1;for(var e=this.hs.lt(),n=t.hs.lt();e.Rt();){var i=e.Et().key,r=n.Et().key;if(!i.isEqual(r))return!1}return!0},Ks.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},Ks.prototype.rt=function(t,e){var n=new Ks;return n.k=this.k,n.rs=t,n.hs=e,n},Ks),Fs=(Js.prototype.track=function(t){var e=t.doc.key,n=this.as.get(e);!n||0!==t.type&&3===n.type?this.as=this.as.nt(e,t):3===t.type&&1!==n.type?this.as=this.as.nt(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.as=this.as.nt(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.as=this.as.nt(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.as=this.as.remove(e):1===t.type&&2===n.type?this.as=this.as.nt(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.as=this.as.nt(e,{type:2,doc:t.doc}):ya("unsupported combination of changes: "+JSON.stringify(t)+" after "+JSON.stringify(n))},Js.prototype.us=function(){var n=[];return this.as.ut(function(t,e){n.push(e)}),n},Js),Gs=(Xs.fs=function(t,e,n,i){var r=[];return e.forEach(function(t){r.push({type:0,doc:t})}),new Xs(t,e,qs.os(e),r,n,i,!0,!1)},Object.defineProperty(Xs.prototype,"hasPendingWrites",{get:function(){return!this.ls.q()},enumerable:!0,configurable:!0}),Xs.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this._s===t._s&&this.ls.isEqual(t.ls)&&this.query.isEqual(t.query)&&this.docs.isEqual(t.docs)&&this.cs.isEqual(t.cs)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var i=0;i<e.length;i++)if(e[i].type!==n[i].type||!e[i].doc.isEqual(n[i].doc))return!1;return!0},Xs),xs=(Ws.Rs=function(t,e){var n=new Map;return n.set(t,js.Is(t,e)),new Ws(Bi.MIN,n,Vs(),Ts(),Os())},Ws),js=(Ys.Is=function(t,e){return new Ys(Ar.Ut,e,Os(),Os(),Os())},Ys),Bs=(Object.defineProperty(zs.prototype,"As",{get:function(){return this.Ds},enumerable:!0,configurable:!0}),Object.defineProperty(zs.prototype,"resumeToken",{get:function(){return this.Cs},enumerable:!0,configurable:!0}),Object.defineProperty(zs.prototype,"Ns",{get:function(){return 0!==this.vs},enumerable:!0,configurable:!0}),Object.defineProperty(zs.prototype,"ks",{get:function(){return this.Fs},enumerable:!0,configurable:!0}),zs.prototype.Ls=function(t){0<t.Mt()&&(this.Fs=!0,this.Cs=t)},zs.prototype.$s=function(){var n=Os(),i=Os(),r=Os();return this.Ss.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:i=i.add(t);break;case 1:r=r.add(t);break;default:ya("Encountered invalid change type: "+e)}}),new js(this.Cs,this.Ds,n,i,r)},zs.prototype.Os=function(){this.Fs=!1,this.Ss=$s()},zs.prototype.Ms=function(t,e){this.Fs=!0,this.Ss=this.Ss.nt(t,e)},zs.prototype.Us=function(t){this.Fs=!0,this.Ss=this.Ss.remove(t)},zs.prototype.qs=function(){this.vs+=1},zs.prototype.Bs=function(){--this.vs},zs.prototype.xs=function(){this.Fs=!0,this.Ds=!0},zs),Hs=(Qs.prototype.Ks=function(t){for(var e=0,n=t.gs;e<n.length;e++){var i=n[e];t.ys instanceof Do?this.Hs(i,t.ys):t.ys instanceof Oo&&this.Js(i,t.key,t.ys)}for(var r=0,o=t.removedTargetIds;r<o.length;r++){var s=o[r];this.Js(s,t.key,t.ys)}},Qs.prototype.Ys=function(n){var i=this;this.Xs(n,function(t){var e=i.Zs(t);switch(n.state){case 0:i.ti(t)&&e.Ls(n.resumeToken);break;case 1:e.Bs(),e.Ns||e.Os(),e.Ls(n.resumeToken);break;case 2:e.Bs(),e.Ns||i.removeTarget(t);break;case 3:i.ti(t)&&(e.xs(),e.Ls(n.resumeToken));break;case 4:i.ti(t)&&(i.ei(t),e.Ls(n.resumeToken));break;default:ya("Unknown target watch change state: "+n.state)}})},Qs.prototype.Xs=function(t,n){var i=this;0<t.targetIds.length?t.targetIds.forEach(n):this.Ws.forEach(function(t,e){i.ti(e)&&n(e)})},Qs.prototype.si=function(t){var e=t.targetId,n=t.bs.count,i=this.ii(e);if(i){var r=i.target;if(r.Pe())if(0===n){var o=new sr(r.path);this.Js(e,o,new Oo(o,Bi.S()))}else va(1===n,"Single document existence filter with count: "+n);else this.ni(e)!==n&&(this.ei(e),this.zs=this.zs.add(e))}},Qs.prototype.ri=function(r){var o=this,s=new Map;this.Ws.forEach(function(t,e){var n=o.ii(e);if(n){if(t.As&&n.target.Pe()){var i=new sr(n.target.path);null!==o.js.get(i)||o.hi(e,i)||o.Js(e,i,new Oo(i,r))}t.ks&&(s.set(e,t.$s()),t.Os())}});var i=Os();this.Gs.forEach(function(t,e){var n=!0;e.Ft(function(t){var e=o.ii(t);return!e||2===e.Ze||(n=!1)}),n&&(i=i.add(t))});var t=new xs(r,s,this.zs,this.js,i);return this.js=Ts(),this.Gs=Zs(),this.zs=new yr(wa),t},Qs.prototype.Hs=function(t,e){if(this.ti(t)){var n=this.hi(t,e.key)?2:0;this.Zs(t).Ms(e.key,n),this.js=this.js.nt(e.key,e),this.Gs=this.Gs.nt(e.key,this.oi(e.key).add(t))}},Qs.prototype.Js=function(t,e,n){if(this.ti(t)){var i=this.Zs(t);this.hi(t,e)?i.Ms(e,1):i.Us(e),this.Gs=this.Gs.nt(e,this.oi(e).delete(t)),n&&(this.js=this.js.nt(e,n))}},Qs.prototype.removeTarget=function(t){this.Ws.delete(t)},Qs.prototype.ni=function(t){var e=this.Zs(t).$s();return this.Qs.ai(t).size+e.Ps.size-e.ps.size},Qs.prototype.qs=function(t){this.Zs(t).qs()},Qs.prototype.Zs=function(t){var e=this.Ws.get(t);return e||(e=new Bs,this.Ws.set(t,e)),e},Qs.prototype.oi=function(t){var e=this.Gs.get(t);return e||(e=new yr(wa),this.Gs=this.Gs.nt(t,e)),e},Qs.prototype.ti=function(t){var e=null!==this.ii(t);return e||fa("WatchChangeAggregator","Detected inactive target",t),e},Qs.prototype.ii=function(t){var e=this.Ws.get(t);return e&&e.Ns?null:this.Qs.ui(t)},Qs.prototype.ei=function(e){var n=this;this.Ws.set(e,new Bs),this.Qs.ai(e).forEach(function(t){n.Js(e,t,null)})},Qs.prototype.hi=function(t,e){return this.Qs.ai(t).has(e)},Qs);function Qs(t){this.Qs=t,this.Ws=new Map,this.js=Ts(),this.Gs=Zs(),this.zs=new yr(wa)}function zs(){this.vs=0,this.Ss=$s(),this.Cs=Ar.Ut,this.Ds=!1,this.Fs=!0}function Ys(t,e,n,i,r){this.resumeToken=t,this.As=e,this.Ps=n,this.Vs=i,this.ps=r}function Ws(t,e,n,i,r){this.ts=t,this.ws=e,this.Ts=n,this.ms=i,this.Es=r}function Xs(t,e,n,i,r,o,s,a){this.query=t,this.docs=e,this.cs=n,this.docChanges=i,this.ls=r,this.fromCache=o,this._s=s,this.ds=a}function Js(){this.as=new ur(sr.k)}function Ks(n){this.k=n?function(t,e){return n(t,e)||sr.k(t.key,e.key)}:function(t,e){return sr.k(t.key,e.key)},this.rs=ks(),this.hs=new ur(this.k)}function Zs(){return new ur(sr.k)}function $s(){return new ur(sr.k)}var ta,ea,na=((ea={})[is.ASCENDING.name]="ASCENDING",ea[is.DESCENDING.name]="DESCENDING",ea),ia=((ta={})[Po.LESS_THAN.name]="LESS_THAN",ta[Po.LESS_THAN_OR_EQUAL.name]="LESS_THAN_OR_EQUAL",ta[Po.GREATER_THAN.name]="GREATER_THAN",ta[Po.GREATER_THAN_OR_EQUAL.name]="GREATER_THAN_OR_EQUAL",ta[Po.EQUAL.name]="EQUAL",ta[Po.ARRAY_CONTAINS.name]="ARRAY_CONTAINS",ta[Po.IN.name]="IN",ta[Po.ARRAY_CONTAINS_ANY.name]="ARRAY_CONTAINS_ANY",ta),ra=(oa.prototype.li=function(t){var e=void 0===t.code?Pi.UNKNOWN:Is(t.code);return new Mi(e,t.message||"")},oa.prototype._i=function(t){return this.options.di||Nr(t)?t:{value:t}},oa.prototype.fi=function(t){var e;return Nr(e="object"==typeof t?t.value:t)?null:e},oa.prototype.Wt=function(t){return{integerValue:""+t}},oa.prototype.jt=function(t){if(this.options.di){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Tr(t)?"-0":t}},oa.prototype.wi=function(t){return"number"==typeof(e=t)&&Number.isInteger(e)&&!Tr(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER?this.Wt(t):this.jt(t);var e},oa.prototype.F=function(t){return this.options.di?new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+t.nanoseconds).slice(-9)+"Z":{seconds:""+t.seconds,nanos:t.nanoseconds}},oa.prototype.v=function(t){var e=Ur(t);return new ji(e.seconds,e.nanos)},oa.prototype.Ti=function(t){return this.options.di?t.toBase64():t.toUint8Array()},oa.prototype.mi=function(t){return this.options.di?(va(void 0===t||"string"==typeof t,"value must be undefined or a string when using proto3 Json"),Ar.fromBase64String(t||"")):(va(void 0===t||t instanceof Uint8Array,"value must be undefined or Uint8Array"),Ar.fromUint8Array(t||new Uint8Array))},oa.prototype.toVersion=function(t){return this.F(t.F())},oa.prototype.fromVersion=function(t){return va(!!t,"Trying to deserialize version that isn't set"),Bi.v(this.v(t))},oa.prototype.Ei=function(t,e){return this.Ri(e||this.ci).child("documents").child(t).G()},oa.prototype.Ii=function(t){var e=$i.K(t);return va(sa(e),"Tried to deserialize invalid key "+e.toString()),e},oa.prototype.Ai=function(t){return this.Ei(t.path)},oa.prototype.tt=function(t){var e=this.Ii(t);return va(e.get(1)===this.ci.projectId,"Tried to deserialize key from different project: "+e.get(1)+" vs "+this.ci.projectId),va(!e.get(3)&&!this.ci.database||e.get(3)===this.ci.database,"Tried to deserialize key from different database: "+e.get(3)+" vs "+this.ci.database),new sr(this.Pi(e))},oa.prototype.Vi=function(t){return this.Ei(t)},oa.prototype.pi=function(t){var e=this.Ii(t);return 4===e.length?$i.H:this.Pi(e)},Object.defineProperty(oa.prototype,"gi",{get:function(){return new $i(["projects",this.ci.projectId,"databases",this.ci.database]).G()},enumerable:!0,configurable:!0}),oa.prototype.Ri=function(t){return new $i(["projects",t.projectId,"databases",t.database])},oa.prototype.Pi=function(t){return va(4<t.length&&"documents"===t.get(4),"tried to deserialize invalid key "+t.toString()),t.$(5)},oa.prototype.yi=function(t,e){return{name:this.Ai(t),fields:e.proto.mapValue.fields}},oa.prototype.bi=function(t){return{name:this.Ai(t.key),fields:t.Re().mapValue.fields,updateTime:this.F(t.version.F())}},oa.prototype.vi=function(t,e){var n=this.tt(t.name),i=this.fromVersion(t.updateTime),r=new mo({mapValue:{fields:t.fields}});return new Do(n,i,r,{hasCommittedMutations:!!e})},oa.prototype.Si=function(t){va(!!t.found,"Tried to deserialize a found document from a missing document."),t.found.name,t.found.updateTime;var e=this.tt(t.found.name),n=this.fromVersion(t.found.updateTime),i=new mo({mapValue:{fields:t.found.fields}});return new Do(e,n,i,{})},oa.prototype.Ci=function(t){va(!!t.missing,"Tried to deserialize a missing document from a found document."),va(!!t.readTime,"Tried to deserialize a missing document without a read time.");var e=this.tt(t.missing),n=this.fromVersion(t.readTime);return new Oo(e,n)},oa.prototype.Di=function(t){return"found"in t?this.Si(t):"missing"in t?this.Ci(t):ya("invalid batch get response: "+JSON.stringify(t))},oa.prototype.Fi=function(t){var e;if("targetChange"in t){t.targetChange;var n=this.Ni(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],r=this.mi(t.targetChange.resumeToken),o=t.targetChange.cause;e=new Ms(n,i,r,o&&this.li(o)||null)}else if("documentChange"in t){t.documentChange;var s=t.documentChange;s.document,s.document.name,s.document.updateTime;var a=this.tt(s.document.name),u=this.fromVersion(s.document.updateTime),h=new mo({mapValue:{fields:s.document.fields}}),c=new Do(a,u,h,{});e=new Us(s.targetIds||[],s.removedTargetIds||[],c.key,c)}else if("documentDelete"in t){t.documentDelete;var l=t.documentDelete;l.document;var f=this.tt(l.document),p=l.readTime?this.fromVersion(l.readTime):Bi.S(),d=new Oo(f,p);e=new Us([],l.removedTargetIds||[],d.key,d)}else if("documentRemove"in t){t.documentRemove;var y=t.documentRemove;y.document;var v=this.tt(y.document);e=new Us([],y.removedTargetIds||[],v,null)}else{if(!("filter"in t))return ya("Unknown change type "+JSON.stringify(t));t.filter;var g=t.filter;g.targetId;var m=new ls(g.count||0);e=new Ps(g.targetId,m)}return e},oa.prototype.Ni=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:ya("Got unexpected TargetChange.state: "+t)},oa.prototype.ki=function(t){if(!("targetChange"in t))return Bi.MIN;var e=t.targetChange;return e.targetIds&&e.targetIds.length||!e.readTime?Bi.MIN:this.fromVersion(e.readTime)},oa.prototype.Li=function(t){var e,n=this;if(t instanceof fo)e={update:this.yi(t.key,t.value)};else if(t instanceof vo)e={delete:this.Ai(t.key)};else if(t instanceof po)e={update:this.yi(t.key,t.data),updateMask:this.$i(t.se)};else if(t instanceof yo)e={transform:{document:this.Ai(t.key),fieldTransforms:t.fieldTransforms.map(function(t){return n.Oi(t)})}};else{if(!(t instanceof go))return ya("Unknown mutation type "+t.type);e={verify:this.Ai(t.key)}}return t.Zt.Ht||(e.currentDocument=this.Mi(t.Zt)),e},oa.prototype.Ui=function(t){var e=this,n=t.currentDocument?this.qi(t.currentDocument):no.NONE;if(t.update){t.update.name;var i=this.tt(t.update.name),r=new mo({mapValue:{fields:t.update.fields}});if(t.updateMask){var o=this.Bi(t.updateMask);return new po(i,r,o,n)}return new fo(i,r,n)}if(t.delete){var s=this.tt(t.delete);return new vo(s,n)}if(t.transform){var a=this.tt(t.transform.document),u=t.transform.fieldTransforms.map(function(t){return e.xi(t)});return va(!0===n.exists,'Transforms only support precondition "exists == true"'),new yo(a,u)}if(t.verify){var h=this.tt(t.verify);return new go(h,n)}return ya("unknown mutation proto: "+JSON.stringify(t))},oa.prototype.Mi=function(t){return void 0!==t.updateTime?{updateTime:this.toVersion(t.updateTime)}:void 0!==t.exists?{exists:t.exists}:ya("Unknown precondition")},oa.prototype.qi=function(t){return void 0!==t.updateTime?no.updateTime(this.fromVersion(t.updateTime)):void 0!==t.exists?no.exists(t.exists):no.NONE},oa.prototype.Qi=function(t,e){var n=t.updateTime?this.fromVersion(t.updateTime):this.fromVersion(e);n.isEqual(Bi.MIN)&&(n=this.fromVersion(e));var i=null;return t.transformResults&&0<t.transformResults.length&&(i=t.transformResults),new $r(n,i)},oa.prototype.Wi=function(t,e){var n=this;return t&&0<t.length?(va(void 0!==e,"Received a write result without a commit time"),t.map(function(t){return n.Qi(t,e)})):[]},oa.prototype.Oi=function(t){var e=t.transform;if(e instanceof Hr)return{fieldPath:t.field.G(),setToServerValue:"REQUEST_TIME"};if(e instanceof zr)return{fieldPath:t.field.G(),appendMissingElements:{values:e.elements}};if(e instanceof Yr)return{fieldPath:t.field.G(),removeAllFromArray:{values:e.elements}};if(e instanceof Wr)return{fieldPath:t.field.G(),increment:e.Qt};throw ya("Unknown transform: "+t.transform)},oa.prototype.xi=function(t){var e=null;if("setToServerValue"in t)va("REQUEST_TIME"===t.setToServerValue,"Unknown server value transform proto: "+JSON.stringify(t)),e=Hr.instance;else if("appendMissingElements"in t){var n=t.appendMissingElements.values||[];e=new zr(n)}else if("removeAllFromArray"in t){var i=t.removeAllFromArray.values||[];e=new Yr(i)}else"increment"in t?e=new Wr(this,t.increment):ya("Unknown transform proto: "+JSON.stringify(t));var r=rr.Z(t.fieldPath);return new eo(r,e)},oa.prototype.ji=function(t){return{documents:[this.Vi(t.path)]}},oa.prototype.Gi=function(t){var e=t.documents.length;va(1===e,"DocumentsTarget contained other than 1 document: "+e);var n=t.documents[0];return Uo.ve(this.pi(n)).Ue()},oa.prototype.zi=function(t){var e={structuredQuery:{}},n=t.path;null!==t.collectionGroup?(e.parent=this.Vi(n),e.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(e.parent=this.Vi(n.O()),e.structuredQuery.from=[{collectionId:n.U()}]);var i=this.Ki(t.filters);i&&(e.structuredQuery.where=i);var r=this.Hi(t.orderBy);r&&(e.structuredQuery.orderBy=r);var o=this._i(t.limit);return null!==o&&(e.structuredQuery.limit=o),t.startAt&&(e.structuredQuery.startAt=this.Ji(t.startAt)),t.endAt&&(e.structuredQuery.endAt=this.Ji(t.endAt)),e},oa.prototype.Yi=function(t){var e=this.pi(t.parent),n=t.structuredQuery,i=n.from?n.from.length:0,r=null;if(0<i){va(1===i,"StructuredQuery.from with more than one collection is not supported.");var o=n.from[0];o.allDescendants?r=o.collectionId:e=e.child(o.collectionId)}var s=[];n.where&&(s=this.Xi(n.where));var a=[];n.orderBy&&(a=this.Zi(n.orderBy));var u=null;n.limit&&(u=this.fi(n.limit));var h=null;n.startAt&&(h=this.tn(n.startAt));var c=null;return n.endAt&&(c=this.tn(n.endAt)),new Uo(e,r,a,s,u,"F",h,c).Ue()},oa.prototype.en=function(t){var e=this.sn(t.Ze);return null==e?null:{"goog-listen-tags":e}},oa.prototype.sn=function(t){switch(t){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return ya("Unrecognized query purpose: "+t)}},oa.prototype.Ue=function(t){var e,n=t.target;return(e=n.Pe()?{documents:this.ji(n)}:{query:this.zi(n)}).targetId=t.targetId,0<t.resumeToken.Mt()&&(e.resumeToken=this.Ti(t.resumeToken)),e},oa.prototype.Ki=function(t){var e=this;if(0!==t.length){var n=t.map(function(t){return t instanceof Ko?e.in(t):ya("Unrecognized filter: "+JSON.stringify(t))});return 1===n.length?n[0]:{compositeFilter:{op:"AND",filters:n}}}},oa.prototype.Xi=function(t){var e=this;return t?void 0!==t.unaryFilter?[this.nn(t)]:void 0!==t.fieldFilter?[this.rn(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map(function(t){return e.Xi(t)}).reduce(function(t,e){return t.concat(e)}):ya("Unknown filter: "+JSON.stringify(t)):[]},oa.prototype.Hi=function(t){var e=this;if(0!==t.length)return t.map(function(t){return e.hn(t)})},oa.prototype.Zi=function(t){var e=this;return t.map(function(t){return e.on(t)})},oa.prototype.Ji=function(t){return{before:t.before,values:t.position}},oa.prototype.tn=function(t){var e=!!t.before,n=t.values||[];return new ds(n,e)},oa.prototype.an=function(t){return na[t.name]},oa.prototype.un=function(t){switch(t){case"ASCENDING":return is.ASCENDING;case"DESCENDING":return is.DESCENDING;default:return}},oa.prototype.cn=function(t){return ia[t.name]},oa.prototype.ln=function(t){switch(t){case"EQUAL":return Po.EQUAL;case"GREATER_THAN":return Po.GREATER_THAN;case"GREATER_THAN_OR_EQUAL":return Po.GREATER_THAN_OR_EQUAL;case"LESS_THAN":return Po.LESS_THAN;case"LESS_THAN_OR_EQUAL":return Po.LESS_THAN_OR_EQUAL;case"ARRAY_CONTAINS":return Po.ARRAY_CONTAINS;case"IN":return Po.IN;case"ARRAY_CONTAINS_ANY":return Po.ARRAY_CONTAINS_ANY;case"OPERATOR_UNSPECIFIED":return ya("Unspecified operator");default:return ya("Unknown operator")}},oa.prototype._n=function(t){return{fieldPath:t.G()}},oa.prototype.dn=function(t){return rr.Z(t.fieldPath)},oa.prototype.hn=function(t){return{field:this._n(t.field),direction:this.an(t.dir)}},oa.prototype.on=function(t){return new ys(this.dn(t.field),this.un(t.direction))},oa.prototype.rn=function(t){return Ko.create(this.dn(t.fieldFilter.field),this.ln(t.fieldFilter.op),t.fieldFilter.value)},oa.prototype.in=function(t){if(t.op===Po.EQUAL){if(jr(t.value))return{unaryFilter:{field:this._n(t.field),op:"IS_NAN"}};if(xr(t.value))return{unaryFilter:{field:this._n(t.field),op:"IS_NULL"}}}return{fieldFilter:{field:this._n(t.field),op:this.cn(t.op),value:t.value}}},oa.prototype.nn=function(t){switch(t.unaryFilter.op){case"IS_NAN":var e=this.dn(t.unaryFilter.field);return Ko.create(e,Po.EQUAL,{doubleValue:NaN});case"IS_NULL":var n=this.dn(t.unaryFilter.field);return Ko.create(n,Po.EQUAL,{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return ya("Unspecified filter");default:return ya("Unknown filter")}},oa.prototype.$i=function(t){var e=[];return t.fields.forEach(function(t){return e.push(t.G())}),{fieldPaths:e}},oa.prototype.Bi=function(t){var e=(t.fieldPaths||[]).map(function(t){return rr.Z(t)});return to.zt(e)},oa);function oa(t,e){this.ci=t,this.options=e}function sa(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}var aa=(ha.fn=function(t){ha.platform&&ya("Platform already defined"),ha.platform=t},ha.Ot=function(){return ha.platform||ya("Platform not set"),ha.platform},ha),ua=new l("@firebase/firestore");function ha(){}function ca(){return ua.logLevel}function la(t){ua.logLevel=t}function fa(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(ua.logLevel<=a.DEBUG){var i=e.map(da);ua.debug.apply(ua,r(["Firestore ("+Di+"): "+t],i))}}function pa(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(ua.logLevel<=a.ERROR){var i=e.map(da);ua.error.apply(ua,r(["Firestore ("+Di+"): "+t],i))}}function da(t){if("string"==typeof t)return t;var e=aa.Ot();try{return e.wn(t)}catch(e){return t}}function ya(t){var e="FIRESTORE ("+Di+") INTERNAL ASSERTION FAILED: "+t;throw pa(e),new Error(e)}function va(t,e){t||ya(e)}var ga=(ma.Tn=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e="",n=0;n<20;n++)e+=t.charAt(Math.floor(Math.random()*t.length));return e},ma);function ma(){}function wa(t,e){return t<e?-1:e<t?1:0}function ba(t,n,i){return t.length===n.length&&t.every(function(t,e){return i(t,n[e])})}function Ea(t,e,n,i,r){this.ci=t,this.persistenceKey=e,this.host=n,this.ssl=i,this.forceLongPolling=r}var Aa=(Object.defineProperty(xa.prototype,"mn",{get:function(){return"(default)"===this.database},enumerable:!0,configurable:!0}),xa.prototype.isEqual=function(t){return t instanceof xa&&t.projectId===this.projectId&&t.database===this.database},xa.prototype.C=function(t){return wa(this.projectId,t.projectId)||wa(this.database,t.database)},xa),Ia=(Ga.prototype.get=function(t){var e=this.En(t),n=this.Rn[e];if(void 0!==n)for(var i=0,r=n;i<r.length;i++){var o=r[i],s=o[0],a=o[1];if(s.isEqual(t))return a}},Ga.prototype.has=function(t){return void 0!==this.get(t)},Ga.prototype.set=function(t,e){var n=this.En(t),i=this.Rn[n];if(void 0!==i){for(var r=0;r<i.length;r++)if(i[r][0].isEqual(t))return void(i[r]=[t,e]);i.push([t,e])}else this.Rn[n]=[[t,e]]},Ga.prototype.delete=function(t){var e=this.En(t),n=this.Rn[e];if(void 0===n)return!1;for(var i=0;i<n.length;i++)if(n[i][0].isEqual(t))return 1===n.length?delete this.Rn[e]:n.splice(i,1),!0;return!1},Ga.prototype.forEach=function(a){br(this.Rn,function(t,e){for(var n=0,i=e;n<i.length;n++){var r=i[n],o=r[0],s=r[1];a(o,s)}})},Ga.prototype.q=function(){return Er(this.Rn)},Ga),Na=(Fa.prototype.Bt=function(t,e,n){for(var i=n.An,r=0;r<this.mutations.length;r++){var o=this.mutations[r];if(o.key.isEqual(t)){var s=i[r];e=o.Bt(e,s)}}return e},Fa.prototype.qt=function(t,e){for(var n=0,i=this.baseMutations;n<i.length;n++){var r=i[n];r.key.isEqual(t)&&(e=r.qt(e,e,this.In))}for(var o=e,s=0,a=this.mutations;s<a.length;s++){var u=a[s];u.key.isEqual(t)&&(e=u.qt(e,o,this.In))}return e},Fa.prototype.Pn=function(n){var i=this,r=n;return this.mutations.forEach(function(t){var e=i.qt(t.key,n.get(t.key));e&&(r=r.nt(t.key,e))}),r},Fa.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},Os())},Fa.prototype.isEqual=function(t){return this.batchId===t.batchId&&ba(this.mutations,t.mutations,function(t,e){return t.isEqual(e)})&&ba(this.baseMutations,t.baseMutations,function(t,e){return t.isEqual(e)})},Fa),Ta=(qa.from=function(t,e,n,i){va(t.mutations.length===n.length,"Mutations sent "+t.mutations.length+" must equal results received "+n.length);for(var r=Ls(),o=t.mutations,s=0;s<o.length;s++)r=r.nt(o[s].key,n[s].version);return new qa(t,e,n,i,r)},qa),_a=(Ma.prototype.q=function(){return this.gn.q()},Ma.prototype.vn=function(t,e){var n=new Sa(t,e);this.gn=this.gn.add(n),this.yn=this.yn.add(n)},Ma.prototype.Sn=function(t,e){var n=this;t.forEach(function(t){return n.vn(t,e)})},Ma.prototype.Cn=function(t,e){this.Dn(new Sa(t,e))},Ma.prototype.Fn=function(t,e){var n=this;t.forEach(function(t){return n.Cn(t,e)})},Ma.prototype.Nn=function(t){var e=this,n=sr.EMPTY,i=new Sa(n,t),r=new Sa(n,t+1),o=[];return this.yn.Dt([i,r],function(t){e.Dn(t),o.push(t.key)}),o},Ma.prototype.kn=function(){var e=this;this.gn.forEach(function(t){return e.Dn(t)})},Ma.prototype.Dn=function(t){this.gn=this.gn.delete(t),this.yn=this.yn.delete(t)},Ma.prototype.Ln=function(t){var e=sr.EMPTY,n=new Sa(e,t),i=new Sa(e,t+1),r=Os();return this.yn.Dt([n,i],function(t){r=r.add(t.key)}),r},Ma.prototype.$n=function(t){var e=new Sa(t,0),n=this.gn.Nt(e);return null!==n&&t.isEqual(n.key)},Ma),Sa=(Pa.me=function(t,e){return sr.k(t.key,e.key)||wa(t.On,e.On)},Pa.bn=function(t,e){return wa(t.On,e.On)||sr.k(t.key,e.key)},Pa),ka=(Ua.prototype.catch=function(t){return this.next(void 0,t)},Ua.prototype.next=function(i,r){var o=this;return this.Bn&&ya("Called next() or catch() twice for PersistencePromise"),this.Bn=!0,this.qn?this.error?this.xn(r,this.error):this.Qn(i,this.result):new Ua(function(e,n){o.Mn=function(t){o.Qn(i,t).next(e,n)},o.Un=function(t){o.xn(r,t).next(e,n)}})},Ua.prototype.Wn=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},Ua.prototype.jn=function(t){try{var e=t();return e instanceof Ua?e:Ua.resolve(e)}catch(t){return Ua.reject(t)}},Ua.prototype.Qn=function(t,e){return t?this.jn(function(){return t(e)}):Ua.resolve(e)},Ua.prototype.xn=function(t,e){return t?this.jn(function(){return t(e)}):Ua.reject(e)},Ua.resolve=function(n){return new Ua(function(t,e){t(n)})},Ua.reject=function(n){return new Ua(function(t,e){e(n)})},Ua.Gn=function(t){return new Ua(function(e,n){var i=0,r=0,o=!1;t.forEach(function(t){++i,t.next(function(){++r,o&&r===i&&e()},function(t){return n(t)})}),o=!0,r===i&&e()})},Ua.zn=function(t){for(var n=Ua.resolve(!1),e=function(e){n=n.next(function(t){return t?Ua.resolve(t):e()})},i=0,r=t;i<r.length;i++)e(r[i]);return n},Ua.forEach=function(t,n){var i=this,r=[];return t.forEach(function(t,e){r.push(n.call(i,t,e))}),this.Gn(r)},Ua),Ra=(Va.prototype.Yn=function(e,n){var i=this;return this.Hn.Xn(e,n).next(function(t){return i.Zn(e,n,t)})},Va.prototype.Zn=function(t,i,r){return this.Kn.tr(t,i).next(function(t){for(var e=0,n=r;e<n.length;e++)t=n[e].qt(i,t);return t})},Va.prototype.er=function(t,e,r){var o=_s();return e.forEach(function(t,e){for(var n=0,i=r;n<i.length;n++)e=i[n].qt(t,e);o=o.nt(t,e)}),o},Va.prototype.sr=function(e,t){var n=this;return this.Kn.getEntries(e,t).next(function(t){return n.ir(e,t)})},Va.prototype.ir=function(i,r){var o=this;return this.Hn.nr(i,r).next(function(t){var e=o.er(i,r,t),n=Ts();return e.forEach(function(t,e){e=e||new Oo(t,Bi.S()),n=n.nt(t,e)}),n})},Va.prototype.rr=function(t,e,n){return e.Pe()?this.hr(t,e.path):e.He()?this.or(t,e,n):this.ar(t,e,n)},Va.prototype.hr=function(t,e){return this.Yn(t,new sr(e)).next(function(t){var e=ks();return t instanceof Do&&(e=e.nt(t.key,t)),e})},Va.prototype.or=function(n,i,r){var o=this,s=i.collectionGroup,a=ks();return this.Jn.ur(n,s).next(function(t){return ka.forEach(t,function(t){var e=i.Oe(t.child(s));return o.ar(n,e,r).next(function(t){t.forEach(function(t,e){a=a.nt(t,e)})})}).next(function(){return a})})},Va.prototype.ar=function(e,n,t){var c,l,i=this;return this.Kn.rr(e,n,t).next(function(t){return c=t,i.Hn.cr(e,n)}).next(function(t){return l=t,i.lr(e,l,c).next(function(t){c=t;for(var e=0,n=l;e<n.length;e++)for(var i=n[e],r=0,o=i.mutations;r<o.length;r++){var s=o[r],a=s.key,u=c.get(a),h=s.qt(u,u,i.In);c=h instanceof Do?c.nt(a,h):c.remove(a)}})}).next(function(){return c.forEach(function(t,e){n.matches(e)||(c=c.remove(t))}),c})},Va.prototype.lr=function(t,e,n){for(var i=Os(),r=0,o=e;r<o.length;r++)for(var s=0,a=o[r].mutations;s<a.length;s++){var u=a[s];u instanceof po&&null===n.get(u.key)&&(i=i.add(u.key))}var h=n;return this.Kn.getEntries(t,i).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof Do&&(h=h.nt(t,e))}),h})},Va),La=(Ca.wr=function(t,e){for(var n=Os(),i=Os(),r=0,o=e.docChanges;r<o.length;r++){var s=o[r];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}}return new Ca(t,e.fromCache,n,i)},Ca),Da=(Oa.prototype.mr=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},Oa.prototype.next=function(){var t=++this.previousValue;return this.Er&&this.Er(t),t},Oa);function Oa(t,e){var n=this;this.previousValue=t,e&&(e.Tr=function(t){return n.mr(t)},this.Er=function(t){return e.Rr(t)})}function Ca(t,e,n,i){this.targetId=t,this.fromCache=e,this._r=n,this.dr=i}function Va(t,e,n){this.Kn=t,this.Hn=e,this.Jn=n}function Ua(t){var e=this;this.Mn=null,this.Un=null,this.result=void 0,this.error=void 0,this.qn=!1,this.Bn=!1,t(function(t){e.qn=!0,e.result=t,e.Mn&&e.Mn(t)},function(t){e.qn=!0,e.error=t,e.Un&&e.Un(t)})}function Pa(t,e){this.key=t,this.On=e}function Ma(){this.gn=new yr(Sa.me),this.yn=new yr(Sa.bn)}function qa(t,e,n,i,r){this.batch=t,this.Vn=e,this.An=n,this.streamToken=i,this.pn=r}function Fa(t,e,n,i){this.batchId=t,this.In=e,this.baseMutations=n,this.mutations=i}function Ga(t){this.En=t,this.Rn={}}function xa(t,e){this.projectId=t,this.database=e||"(default)"}function ja(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})}Da.Ir=-1;var Ba=(Wa.yr=function(t,e,n,i,r){var o=new Wa(t,e,Date.now()+n,i,r);return o.start(n),o},Wa.prototype.start=function(t){var e=this;this.br=setTimeout(function(){return e.vr()},t)},Wa.prototype.Sr=function(){return this.vr()},Wa.prototype.cancel=function(t){null!==this.br&&(this.clearTimeout(),this.gr.reject(new Mi(Pi.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},Wa.prototype.vr=function(){var e=this;this.Ar.Cr(function(){return null!==e.br?(e.clearTimeout(),e.op().then(function(t){return e.gr.resolve(t)})):Promise.resolve()})},Wa.prototype.clearTimeout=function(){null!==this.br&&(this.pr(this),clearTimeout(this.br),this.br=null)},Wa),Ha=(Object.defineProperty(Ya.prototype,"Or",{get:function(){return this.Fr},enumerable:!0,configurable:!0}),Ya.prototype.Cr=function(t){this.enqueue(t)},Ya.prototype.Mr=function(t){this.Ur(),this.qr(t)},Ya.prototype.Br=function(t){return this.Ur(),this.qr(t)},Ya.prototype.xr=function(e){return c(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.Ur(),this.Fr?[3,2]:(this.Fr=!0,[4,this.Br(e)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},Ya.prototype.enqueue=function(t){return this.Ur(),this.Fr?new Promise(function(t){}):this.qr(t)},Ya.prototype.qr=function(t){var e=this,n=this.Dr.then(function(){return e.Lr=!0,t().catch(function(t){throw e.kr=t,e.Lr=!1,pa("INTERNAL UNHANDLED ERROR: ",t.stack||t.message||""),t}).then(function(t){return e.Lr=!1,t})});return this.Dr=n},Ya.prototype.Qr=function(t,e,n){var i=this;this.Ur(),-1<this.$r.indexOf(t)&&(e=0);var r=Ba.yr(this,t,e,n,function(t){return i.Wr(t)});return this.Nr.push(r),r},Ya.prototype.Ur=function(){this.kr&&ya("AsyncQueue is already failed: "+(this.kr.stack||this.kr.message))},Ya.prototype.jr=function(){},Ya.prototype.Gr=function(){return c(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return[4,e=this.Dr];case 1:t.sent(),t.label=2;case 2:if(e!==this.Dr)return[3,0];t.label=3;case 3:return[2]}})})},Ya.prototype.zr=function(t){for(var e=0,n=this.Nr;e<n.length;e++)if(n[e].Pr===t)return!0;return!1},Ya.prototype.Kr=function(i){var r=this;return this.Gr().then(function(){r.Nr.sort(function(t,e){return t.Vr-e.Vr});for(var t=0,e=r.Nr;t<e.length;t++){var n=e[t];if(n.Sr(),"all"!==i&&n.Pr===i)break}return r.Gr()})},Ya.prototype.Hr=function(t){this.$r.push(t)},Ya.prototype.Wr=function(t){var e=this.Nr.indexOf(t);this.Nr.splice(e,1)},Ya),Qa=(za.Zr=function(t){return new za(t,za.th,za.eh)},za);function za(t,e,n){this.Jr=t,this.Yr=e,this.Xr=n}function Ya(){this.Dr=Promise.resolve(),this.Fr=!1,this.Nr=[],this.kr=null,this.Lr=!1,this.$r=[]}function Wa(t,e,n,i,r){this.Ar=t,this.Pr=e,this.Vr=n,this.op=i,this.pr=r,this.gr=new ja,this.then=this.gr.promise.then.bind(this.gr.promise),this.catch=this.gr.promise.catch.bind(this.gr.promise),this.gr.promise.catch(function(t){})}Qa.sh=-1,Qa.ih=1048576,Qa.nh=41943040,Qa.th=10,Qa.eh=1e3,Qa.rh=new Qa(Qa.nh,Qa.th,Qa.eh),Qa.DISABLED=new Qa(Qa.sh,0,0);var Xa=(Ja.prototype.start=function(){return this.Ph()},Ja.prototype.Vh=function(r){return c(this,void 0,void 0,function(){var e,m,n,i=this;return y(this,function(t){switch(t.label){case 0:return e=this.Hn,m=this.Rh,[4,this.persistence.runTransaction("Handle user change","readonly",function(v){var g;return i.Hn.ph(v).next(function(t){return g=t,e=i.persistence.fh(r),m=new Ra(i.wh,e,i.persistence.Ih()),e.ph(v)}).next(function(t){for(var e=[],n=[],i=Os(),r=0,o=g;r<o.length;r++){var s=o[r];e.push(s.batchId);for(var a=0,u=s.mutations;a<u.length;a++){var h=u[a];i=i.add(h.key)}}for(var c=0,l=t;c<l.length;c++){var f=l[c];n.push(f.batchId);for(var p=0,d=f.mutations;p<d.length;p++){var y=d[p];i=i.add(y.key)}}return m.sr(v,i).next(function(t){return{gh:t,yh:e,bh:n}})})})];case 1:return n=t.sent(),[2,(this.Hn=e,this.Rh=m,this.hh.Ah(this.Rh),n)]}})})},Ja.prototype.vh=function(a){var u,h=this,c=ji.now(),t=a.reduce(function(t,e){return t.add(e.key)},Os());return this.persistence.runTransaction("Locally write mutations","readwrite",function(s){return h.Rh.sr(s,t).next(function(t){u=t;for(var e=[],n=0,i=a;n<i.length;n++){var r=i[n],o=r.ee(u.get(r.key));null!=o&&e.push(new po(r.key,o,o.se(),no.exists(!0)))}return h.Hn.Sh(s,c,e,a)})}).then(function(t){var e=t.Pn(u);return{batchId:t.batchId,Ch:e}})},Ja.prototype.Dh=function(t){var n=this;return this.persistence.runTransaction("Lookup mutation documents","readonly",function(e){return n.Hn.Fh(e,t).next(function(t){return t?n.Rh.sr(e,t):ka.resolve(null)})})},Ja.prototype.Nh=function(i){var r=this;return this.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var e=i.batch.keys(),n=r.wh.kh({Lh:!0});return r.Hn.Nh(t,i.batch,i.streamToken).next(function(){return r.$h(t,i,n)}).next(function(){return n.apply(t)}).next(function(){return r.Hn.Oh(t)}).next(function(){return r.Rh.sr(t,e)})})},Ja.prototype.Mh=function(t){var i=this;return this.persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return i.Hn.Uh(e,t).next(function(t){return va(null!==t,"Attempt to reject nonexistent batch!"),n=t.keys(),i.Hn.qh(e,t)}).next(function(){return i.Hn.Oh(e)}).next(function(){return i.Rh.sr(e,n)})})},Ja.prototype.Bh=function(){var e=this;return this.persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.Hn.Bh(t)})},Ja.prototype.xh=function(){var e=this;return this.persistence.runTransaction("Get last stream token","readonly",function(t){return e.Hn.xh(t)})},Ja.prototype.Qh=function(e){var n=this;return this.persistence.runTransaction("Set last stream token","readwrite-primary",function(t){return n.Hn.Qh(t,e)})},Ja.prototype.Wh=function(){var e=this;return this.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.mh.Wh(t)})},Ja.prototype.jh=function(u){var h=this,c=u.ts,l=this.ah;return this.persistence.runTransaction("Apply remote event","readwrite-primary",function(o){var r=h.wh.kh({Lh:!0});l=h.ah;var s=[];u.ws.forEach(function(t,e){var n=l.get(e);if(n){s.push(h.mh.Gh(o,t.ps,e).next(function(){return h.mh.zh(o,t.Ps,e)}));var i=t.resumeToken;if(0<i.Mt()){var r=n.ss(i,c).es(o.Kh);l=l.nt(e,r),Ja.Hh(n,r,t)&&s.push(h.mh.Jh(o,r))}}});var a=Ts(),n=Os();if(u.ms.forEach(function(t,e){n=n.add(t)}),s.push(r.getEntries(o,n).next(function(i){u.ms.forEach(function(t,e){var n=i.get(t);e instanceof Oo&&e.version.isEqual(Bi.MIN)?(r.Yh(t,c),a=a.nt(t,e)):null==n||0<e.version.C(n.version)||0===e.version.C(n.version)&&n.hasPendingWrites?(r.Xh(e,c),a=a.nt(t,e)):fa("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version),u.Es.has(t)&&s.push(h.persistence.dh.Zh(o,t))})})),!c.isEqual(Bi.MIN)){var t=h.mh.Wh(o).next(function(t){return h.mh.to(o,o.Kh,c)});s.push(t)}return ka.Gn(s).next(function(){return r.apply(o)}).next(function(){return h.Rh.ir(o,a)})}).then(function(t){return h.ah=l,t})},Ja.Hh=function(t,e,n){return va(0<e.resumeToken.Mt(),"Attempted to persist target data with no resume token"),0===t.resumeToken.Mt()||e.ts.D()-t.ts.D()>=this.eo||0<n.Ps.size+n.Vs.size+n.ps.size},Ja.prototype.so=function(t){for(var n=this,e=0,i=t;e<i.length;e++){var r=i[e],o=r.targetId;if(this.oh.Sn(r._r,o),this.oh.Fn(r.dr,o),!r.fromCache){var s=this.ah.get(o),a=s.ts,u=s.ns(a);this.ah=this.ah.nt(o,u)}}return this.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(e){return ka.forEach(t,function(t){return ka.forEach(t.dr,function(t){return n.persistence.dh.Cn(e,t)})})})},Ja.prototype.io=function(e){var n=this;return this.persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===e&&(e=-1),n.Hn.no(t,e)})},Ja.prototype.ro=function(e){var n=this;return this.persistence.runTransaction("read document","readonly",function(t){return n.Rh.Yn(t,e)})},Ja.prototype.ho=function(i){var r=this;return this.persistence.runTransaction("Allocate target","readwrite",function(e){var n;return r.mh.oo(e,i).next(function(t){return t?(n=t,ka.resolve(n)):r.mh.ao(e).next(function(t){return n=new ms(i,t,0,e.Kh),r.mh.uo(e,n).next(function(){return n})})})}).then(function(t){return null===r.ah.get(t.targetId)&&(r.ah=r.ah.nt(t.targetId,t),r.uh.set(i,t.targetId)),t})},Ja.prototype.oo=function(t,e){var n=this.uh.get(e);return void 0!==n?ka.resolve(this.ah.get(n)):this.mh.oo(t,e)},Ja.prototype.co=function(n,i){var r=this,o=this.ah.get(n),t=i?"readwrite":"readwrite-primary";return this.persistence.runTransaction("Release target",t,function(e){var t=r.oh.Nn(n);return i?ka.resolve():ka.forEach(t,function(t){return r.persistence.dh.Cn(e,t)}).next(function(){r.persistence.dh.removeTarget(e,o)})}).then(function(){r.ah=r.ah.remove(n),r.uh.delete(o.target)})},Ja.prototype.lo=function(t,n){var i=this,r=Bi.MIN,o=Os();return this.persistence.runTransaction("Execute query","readonly",function(e){return i.oo(e,t.Ue()).next(function(t){if(t)return r=t.lastLimboFreeSnapshotVersion,i.mh._o(e,t.targetId).next(function(t){o=t})}).next(function(){return i.hh.rr(e,t,n?r:Bi.MIN,n?o:Os())}).next(function(t){return{documents:t,do:o}})})},Ja.prototype.fo=function(e){var n=this;return this.persistence.runTransaction("Remote document keys","readonly",function(t){return n.mh._o(t,e)})},Ja.prototype.wo=function(){return this.persistence.wo()},Ja.prototype.To=function(t){this.Hn.mo(t)},Ja.prototype.Eo=function(t){this.persistence.Eo(t)},Ja.prototype.$h=function(t,r,o){var e=this,s=r.batch,n=s.keys(),a=ka.resolve();return n.forEach(function(i){a=a.next(function(){return o.tr(t,i)}).next(function(t){var e=t,n=r.pn.get(i);va(null!==n,"ackVersions should contain every doc in the write."),(!e||e.version.C(n)<0)&&(e=s.Bt(i,e,r))&&o.Xh(e,r.Vn)})}),a.next(function(){return e.Hn.qh(t,s)})},Ja.prototype.Ro=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.Io(t,n.ah)})},Ja.prototype.Ao=function(e){var n=this,t=this.ah.get(e);return t?Promise.resolve(t.target):this.persistence.runTransaction("Get target data","readonly",function(t){return n.mh.ui(t,e).next(function(t){return t?t.target:null})})},Ja.prototype.Po=function(){var i=this;return this.persistence.runTransaction("Get new document changes","readonly",function(t){return i.wh.Po(t,i.lh)}).then(function(t){var e=t.Vo,n=t.readTime;return i.lh=n,e})},Ja.prototype.Ph=function(){return c(this,void 0,void 0,function(){var e,n=this;return y(this,function(t){switch(t.label){case 0:return[4,(e=this).persistence.runTransaction("Synchronize last document change read time","readonly",function(t){return n.wh.po(t)})];case 1:return e.lh=t.sent(),[2]}})})},Ja);function Ja(t,e,n){this.persistence=t,this.hh=e,this.oh=new _a,this.ah=new ur(wa),this.uh=new Ia(function(t){return t.canonicalId()}),this.lh=Bi.MIN,this.persistence.dh._h(this.oh),this.Hn=t.fh(n),this.wh=t.Th(),this.mh=t.Eh(),this.Rh=new Ra(this.wh,this.Hn,this.persistence.Ih()),this.hh.Ah(this.Rh)}function Ka(e){return c(this,void 0,void 0,function(){return y(this,function(t){if(e.code!==Pi.FAILED_PRECONDITION||"The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab."!==e.message)throw e;return fa("LocalStore","Unexpectedly lost primary lease"),[2]})})}function Za(t,e){if(0!==e.length)throw new Mi(Pi.INVALID_ARGUMENT,"Function "+t+"() does not support arguments, but was called with "+yu(e.length,"argument")+".")}function $a(t,e,n){if(e.length!==n)throw new Mi(Pi.INVALID_ARGUMENT,"Function "+t+"() requires "+yu(n,"argument")+", but was called with "+yu(e.length,"argument")+".")}function tu(t,e,n){if(e.length<n)throw new Mi(Pi.INVALID_ARGUMENT,"Function "+t+"() requires at least "+yu(n,"argument")+", but was called with "+yu(e.length,"argument")+".")}function eu(t,e,n,i){if(e.length<n||e.length>i)throw new Mi(Pi.INVALID_ARGUMENT,"Function "+t+"() requires between "+n+" and "+i+" arguments, but was called with "+yu(e.length,"argument")+".")}function nu(t,e,n,i){au(t,e,du(n)+" argument",i)}function iu(t,e,n,i){void 0!==i&&nu(t,e,n,i)}function ru(t,e,n,i){au(t,e,n+" option",i)}function ou(t,e,n,i){void 0!==i&&ru(t,e,n,i)}function su(t,e,n,i,u){void 0!==i&&function(t,e,n){for(var i=[],r=0,o=u;r<o.length;r++){var s=o[r];if(s===n)return;i.push(hu(s))}var a=hu(n);throw new Mi(Pi.INVALID_ARGUMENT,"Invalid value "+a+" provided to function "+t+'() for option "'+e+'". Acceptable values: '+i.join(", "))}(t,n,i)}function au(t,e,n,i){if(!("object"===e?uu(i):"non-empty string"===e?"string"==typeof i&&""!==i:typeof i===e)){var r=hu(i);throw new Mi(Pi.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" to be of type "+e+", but it was: "+r)}}function uu(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function hu(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":ya("Unknown wrong type: "+typeof e);if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function cu(t,e,n){if(void 0===n)throw new Mi(Pi.INVALID_ARGUMENT,"Function "+t+"() requires a valid "+du(e)+" argument, but it was undefined.")}function lu(n,t,i){br(t,function(t,e){if(i.indexOf(t)<0)throw new Mi(Pi.INVALID_ARGUMENT,"Unknown option '"+t+"' passed to function "+n+"(). Available options: "+i.join(", "))})}function fu(t,e,n,i){var r=hu(i);return new Mi(Pi.INVALID_ARGUMENT,"Function "+t+"() requires its "+du(n)+" argument to be a "+e+", but it was: "+r)}function pu(t,e,n){if(n<=0)throw new Mi(Pi.INVALID_ARGUMENT,'Function "'+t+'()" requires its '+du(e)+" argument to be a positive number, but it was: "+n+".")}function du(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function yu(t,e){return t+" "+e+(1===t?"":"s")}function vu(t,e){function n(){var t="This constructor is private.";throw e&&(t+=" ",t+=e),new Mi(Pi.INVALID_ARGUMENT,t)}return n.prototype=t.prototype,Object.assign(n,t),n}function gu(){if("undefined"==typeof Uint8Array)throw new Mi(Pi.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function mu(){if(!aa.Ot().yo)throw new Mi(Pi.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}Xa.eo=3e8;var wu=(Iu.fromBase64String=function(t){$a("Blob.fromBase64String",arguments,1),nu("Blob.fromBase64String","string",1,t),mu();try{return new Iu(Ar.fromBase64String(t))}catch(t){throw new Mi(Pi.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},Iu.fromUint8Array=function(t){if($a("Blob.fromUint8Array",arguments,1),gu(),!(t instanceof Uint8Array))throw fu("Blob.fromUint8Array","Uint8Array",1,t);return new Iu(Ar.fromUint8Array(t))},Iu.prototype.toBase64=function(){return $a("Blob.toBase64",arguments,0),mu(),this.bo.toBase64()},Iu.prototype.toUint8Array=function(){return $a("Blob.toUint8Array",arguments,0),gu(),this.bo.toUint8Array()},Iu.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},Iu.prototype.isEqual=function(t){return this.bo.isEqual(t.bo)},Iu),bu=vu(wu,"Use Blob.fromUint8Array() or Blob.fromBase64String() instead."),Eu=(Au.documentId=function(){return Au.So},Au.prototype.isEqual=function(t){if(!(t instanceof Au))throw fu("isEqual","FieldPath",1,t);return this.vo.isEqual(t.vo)},Au);function Au(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];!function(){if(!(t instanceof Array)||t.length<1)throw new Mi(Pi.INVALID_ARGUMENT,"Function FieldPath() requires its fieldNames argument to be an array with at least 1 element.")}();for(var n=0;n<t.length;++n)if(nu("FieldPath","string",n,t[n]),0===t[n].length)throw new Mi(Pi.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.vo=new rr(t)}function Iu(t){mu(),this.bo=t}Eu.So=new Eu(rr.X().G());var Nu,Tu=new RegExp("[~\\*/\\[\\]]"),_u=(Ru.delete=function(){return Za("FieldValue.delete",arguments),Su.instance},Ru.serverTimestamp=function(){return Za("FieldValue.serverTimestamp",arguments),Du.instance},Ru.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return tu("FieldValue.arrayUnion",arguments,1),new Pu(t)},Ru.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return tu("FieldValue.arrayRemove",arguments,1),new Mu(t)},Ru.increment=function(t){return nu("FieldValue.increment","number",1,t),$a("FieldValue.increment",arguments,1),new qu(t)},Ru.prototype.isEqual=function(t){return this===t},Ru),Su=(n(ku,Nu=_u),ku);function ku(){return Nu.call(this,"FieldValue.delete")||this}function Ru(t){this.Co=t}Su.instance=new Su;var Lu,Du=(n(Ou,Lu=_u),Ou);function Ou(){return Lu.call(this,"FieldValue.serverTimestamp")||this}Du.instance=new Du;var Cu,Vu,Uu,Pu=(n(Xu,Uu=_u),Xu),Mu=(n(Wu,Vu=_u),Wu),qu=(n(Yu,Cu=_u),Yu),Fu=vu(_u,"Use FieldValue.<field>() instead."),Gu=(Object.defineProperty(zu.prototype,"latitude",{get:function(){return this.No},enumerable:!0,configurable:!0}),Object.defineProperty(zu.prototype,"longitude",{get:function(){return this.ko},enumerable:!0,configurable:!0}),zu.prototype.isEqual=function(t){return this.No===t.No&&this.ko===t.ko},zu.prototype.g=function(t){return wa(this.No,t.No)||wa(this.ko,t.ko)},zu),xu=/^__.*__$/,ju=(Qu.prototype.Lo=function(t,e){var n=[];return null!==this.se?n.push(new po(t,this.data,this.se,e)):n.push(new fo(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new yo(t,this.fieldTransforms)),n},Qu),Bu=(Hu.prototype.Lo=function(t,e){var n=[new po(t,this.data,this.se,e)];return 0<this.fieldTransforms.length&&n.push(new yo(t,this.fieldTransforms)),n},Hu);function Hu(t,e,n){this.data=t,this.se=e,this.fieldTransforms=n}function Qu(t,e,n){this.data=t,this.se=e,this.fieldTransforms=n}function zu(t,e){if($a("GeoPoint",arguments,2),nu("GeoPoint","number",1,t),nu("GeoPoint","number",2,e),!isFinite(t)||t<-90||90<t)throw new Mi(Pi.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new Mi(Pi.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.No=t,this.ko=e}function Yu(t){var e=this;return(e=Cu.call(this,"FieldValue.increment")||this).Fo=t,e}function Wu(t){var e=this;return(e=Vu.call(this,"FieldValue.arrayRemove")||this).Do=t,e}function Xu(t){var e=this;return(e=Uu.call(this,"FieldValue.arrayUnion")||this).Do=t,e}function Ju(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw ya("Unexpected case for UserDataSource: "+t)}}var Ku=(eh.prototype.Uo=function(t){var e=null==this.path?null:this.path.child(t),n=new eh(this.$o,this.methodName,e,!1,this.fieldTransforms,this.se);return n.qo(t),n},eh.prototype.Bo=function(t){var e=null==this.path?null:this.path.child(t),n=new eh(this.$o,this.methodName,e,!1,this.fieldTransforms,this.se);return n.Mo(),n},eh.prototype.xo=function(t){return new eh(this.$o,this.methodName,null,!0,this.fieldTransforms,this.se)},eh.prototype.Qo=function(t){var e=null===this.path||this.path.q()?"":" (found in field "+this.path.toString()+")";return new Mi(Pi.INVALID_ARGUMENT,"Function "+this.methodName+"() called with invalid data. "+t+e)},eh.prototype.contains=function(e){return void 0!==this.se.find(function(t){return e.B(t)})||void 0!==this.fieldTransforms.find(function(t){return e.B(t.field)})},eh.prototype.Mo=function(){if(null!==this.path)for(var t=0;t<this.path.length;t++)this.qo(this.path.get(t))},eh.prototype.qo=function(t){if(0===t.length)throw this.Qo("Document fields must not be empty");if(Ju(this.$o)&&xu.test(t))throw this.Qo('Document fields cannot begin and end with "__"')},eh),Zu=function(t,e){this.ci=t,this.key=e},$u=(th.prototype.jo=function(t,e){var n=new Ku(0,t,rr.H);ih("Data must be an object, but it was:",n,e);var i=this.Go(e,n);return new ju(new mo(i),null,n.fieldTransforms)},th.prototype.zo=function(t,e,n){var i=new Ku(2,t,rr.H);ih("Data must be an object, but it was:",i,e);var r,o,s=this.Go(e,i);if(n){for(var a=new yr(rr.k),u=0,h=n;u<h.length;u++){var c=h[u],l=void 0;if(c instanceof Eu)l=c.vo;else{if("string"!=typeof c)throw ya("Expected stringOrFieldPath to be a string or a FieldPath");l=oh(t,c)}if(!i.contains(l))throw new Mi(Pi.INVALID_ARGUMENT,"Field '"+l+"' is specified in your field mask but missing from your input data.");a=a.add(l)}r=to.Gt(a),o=i.fieldTransforms.filter(function(t){return r.Kt(t.field)})}else r=to.zt(i.se),o=i.fieldTransforms;return new ju(new mo(s),r,o)},th.prototype.Ko=function(o,t){var s=this,a=new Ku(1,o,rr.H);ih("Data must be an object, but it was:",a,t);var u=new yr(rr.k),h=mo.le();br(t,function(t,e){var n=oh(o,t),i=a.Bo(n);if((e=s.Ho(e,i))instanceof Su)u=u.add(n);else{var r=s.Jo(e,i);null!=r&&(u=u.add(n),h.set(n,r))}});var e=to.Gt(u);return new Bu(h.he(),e,a.fieldTransforms)},th.prototype.Yo=function(t,e,n,i){var r=new Ku(1,t,rr.H),o=[rh(t,e)],s=[n];if(i.length%2!=0)throw new Mi(Pi.INVALID_ARGUMENT,"Function "+t+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var a=0;a<i.length;a+=2)o.push(rh(t,i[a])),s.push(i[a+1]);for(var u=new yr(rr.k),h=mo.le(),c=0;c<o.length;++c){var l=o[c],f=r.Bo(l),p=this.Ho(s[c],f);if(p instanceof Su)u=u.add(l);else{var d=this.Jo(p,f);null!=d&&(u=u.add(l),h.set(l,d))}}var y=to.Gt(u);return new Bu(h.he(),y,r.fieldTransforms)},th.prototype.Xo=function(t,e,n){void 0===n&&(n=!1);var i=new Ku(n?4:3,t,rr.H);return this.Jo(e,i)},th.prototype.Ho=function(t,e){try{return this.Wo(t)}catch(t){var n=sh(t);throw e.Qo(n)}},th.prototype.Jo=function(t,e){if(nh(t=this.Ho(t,e)))return ih("Unsupported field value:",e,t),this.Go(t,e);if(t instanceof _u)return this.Zo(t,e),null;if(e.path&&e.se.push(e.path),t instanceof Array){if(e.Oo&&4!==e.$o)throw e.Qo("Nested arrays are not supported");return this.ta(t,e)}return this.ea(t,e)},th.prototype.Go=function(t,i){var r=this,o={};return Er(t)?i.path&&0<i.path.length&&i.se.push(i.path):br(t,function(t,e){var n=r.Jo(e,i.Uo(t));null!=n&&(o[t]=n)}),{mapValue:{fields:o}}},th.prototype.ta=function(t,e){for(var n=[],i=0,r=0,o=t;r<o.length;r++){var s=o[r],a=this.Jo(s,e.xo(i));null==a&&(a={nullValue:"NULL_VALUE"}),n.push(a),i++}return{arrayValue:{values:n}}},th.prototype.Zo=function(t,e){if(!Ju(e.$o))throw e.Qo(t.Co+"() can only be used with update() and set()");if(null===e.path)throw e.Qo(t.Co+"() is not currently supported inside arrays");if(t instanceof Su){if(2!==e.$o)throw 1===e.$o?e.Qo("FieldValue.delete() can only appear at the top level of your update data"):e.Qo("FieldValue.delete() cannot be used with set() unless you pass {merge:true}");e.se.push(e.path)}else if(t instanceof Du)e.fieldTransforms.push(new eo(e.path,Hr.instance));else if(t instanceof Pu){var n=this.sa(t.Co,t.Do),i=new zr(n);e.fieldTransforms.push(new eo(e.path,i))}else if(t instanceof Mu){var r=this.sa(t.Co,t.Do),o=new Yr(r);e.fieldTransforms.push(new eo(e.path,o))}else if(t instanceof qu){var s=this.Xo("FieldValue.increment",t.Fo),a=new Wr(this.serializer,s);e.fieldTransforms.push(new eo(e.path,a))}else ya("Unknown FieldValue type: "+t)},th.prototype.ea=function(t,e){if(null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return this.serializer.wi(t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=ji.fromDate(t);return{timestampValue:this.serializer.F(n)}}if(t instanceof ji){var i=new ji(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:this.serializer.F(i)}}if(t instanceof Gu)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof wu)return{bytesValue:this.serializer.Ti(t)};if(t instanceof Zu)return{referenceValue:this.serializer.Ei(t.key.path,t.ci)};throw e.Qo("Unsupported field value: "+hu(t))},th.prototype.sa=function(i,t){var r=this;return t.map(function(t,e){var n=new Ku(3,i,rr.H);return r.Jo(t,n.xo(e))})},th);function th(t,e){this.serializer=t,this.Wo=e}function eh(t,e,n,i,r,o){this.$o=t,this.methodName=e,this.path=n,this.Oo=i,void 0===r&&this.Mo(),this.Oo=void 0!==i&&i,this.fieldTransforms=r||[],this.se=o||[]}function nh(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof ji||t instanceof Gu||t instanceof wu||t instanceof Zu||t instanceof _u)}function ih(t,e,n){if(!nh(n)||!uu(n)){var i=hu(n);throw"an object"===i?e.Qo(t+" a custom object"):e.Qo(t+" "+i)}}function rh(t,e){if(e instanceof Eu)return e.vo;if("string"==typeof e)return oh(t,e);throw new Mi(Pi.INVALID_ARGUMENT,"Function "+t+"() called with invalid data. Field path arguments must be of type string or FieldPath.")}function oh(t,e){try{return function(e){if(0<=e.search(Tu))throw new Mi(Pi.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(Eu.bind.apply(Eu,r([void 0],e.split("."))))}catch(t){throw new Mi(Pi.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e).vo}catch(e){var n=sh(e);throw new Mi(Pi.INVALID_ARGUMENT,"Function "+t+"() called with invalid data. "+n)}}function sh(t){return t instanceof Error?t.message:t.toString()}function ah(t){this.key=t}function uh(t){this.key=t}function hh(t,e,n){this.query=t,this.targetId=e,this.view=n}function ch(t){this.key=t,this.xc=!1}function lh(){this.yl=null,this.targetId=0,this.bl=[]}var fh,ph,dh,yh=(nc.prototype.reset=function(){this.oa=0},nc.prototype.ca=function(){this.oa=this.ha},nc.prototype.la=function(t){var e=this;this.cancel();var n=Math.floor(this.oa+this._a()),i=Math.max(0,Date.now()-this.ua),r=Math.max(0,n-i);0<this.oa&&fa("ExponentialBackoff","Backing off for "+r+" ms (base delay: "+this.oa+" ms, delay with jitter: "+n+" ms, last attempt: "+i+" ms ago)"),this.aa=this.ia.Qr(this.Pr,r,function(){return e.ua=Date.now(),t()}),this.oa*=this.ra,this.oa<this.na&&(this.oa=this.na),this.oa>this.ha&&(this.oa=this.ha)},nc.prototype.cancel=function(){null!==this.aa&&(this.aa.cancel(),this.aa=null)},nc.prototype._a=function(){return(Math.random()-.5)*this.oa},nc),vh=(ec.prototype.Ra=function(){return 1===this.state||2===this.state||4===this.state},ec.prototype.Ia=function(){return 2===this.state},ec.prototype.start=function(){3!==this.state?this.auth():this.Aa()},ec.prototype.stop=function(){return c(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.Ra()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},ec.prototype.Pa=function(){this.state=0,this.Ea.reset()},ec.prototype.Va=function(){var t=this;this.Ia()&&null===this.ma&&(this.ma=this.ia.Qr(this.da,6e4,function(){return t.pa()}))},ec.prototype.ga=function(t){this.ya(),this.stream.send(t)},ec.prototype.pa=function(){return c(this,void 0,void 0,function(){return y(this,function(t){return this.Ia()?[2,this.close(0)]:[2]})})},ec.prototype.ya=function(){this.ma&&(this.ma.cancel(),this.ma=null)},ec.prototype.close=function(e,n){return c(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.ya(),this.Ea.cancel(),this.Ta++,3!==e?this.Ea.reset():n&&n.code===Pi.RESOURCE_EXHAUSTED?(pa(n.toString()),pa("Using maximum backoff delay to prevent overloading the backend."),this.Ea.ca()):n&&n.code===Pi.UNAUTHENTICATED&&this.wa.l(),null!==this.stream&&(this.ba(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.va(n)];case 1:return t.sent(),[2]}})})},ec.prototype.ba=function(){},ec.prototype.auth=function(){var n=this;this.state=1;var t=this.Sa(this.Ta),e=this.Ta;this.wa.getToken().then(function(t){n.Ta===e&&n.Ca(t)},function(e){t(function(){var t=new Mi(Pi.UNKNOWN,"Fetching auth token failed: "+e.message);return n.Da(t)})})},ec.prototype.Ca=function(t){var e=this,n=this.Sa(this.Ta);this.stream=this.Fa(t),this.stream.Na(function(){n(function(){return e.state=2,e.listener.Na()})}),this.stream.va(function(t){n(function(){return e.Da(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},ec.prototype.Aa=function(){var t=this;this.state=4,this.Ea.la(function(){return c(t,void 0,void 0,function(){return y(this,function(t){return this.state=0,this.start(),[2]})})})},ec.prototype.Da=function(t){return fa("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},ec.prototype.Sa=function(e){var n=this;return function(t){n.ia.Cr(function(){return n.Ta===e?t():(fa("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},ec),gh=(n(tc,ph=vh),tc.prototype.Fa=function(t){return this.fa.ka("Listen",t)},tc.prototype.onMessage=function(t){this.Ea.reset();var e=this.serializer.Fi(t),n=this.serializer.ki(t);return this.listener.La(e,n)},tc.prototype.$a=function(t){var e={};e.database=this.serializer.gi,e.addTarget=this.serializer.Ue(t);var n=this.serializer.en(t);n&&(e.labels=n),this.ga(e)},tc.prototype.Oa=function(t){var e={};e.database=this.serializer.gi,e.removeTarget=t,this.ga(e)},tc),mh=(n($h,fh=vh),Object.defineProperty($h.prototype,"Ua",{get:function(){return this.Ma},enumerable:!0,configurable:!0}),$h.prototype.start=function(){this.Ma=!1,fh.prototype.start.call(this)},$h.prototype.ba=function(){this.Ma&&this.qa([])},$h.prototype.Fa=function(t){return this.fa.ka("Write",t)},$h.prototype.onMessage=function(t){if(va(!!t.streamToken,"Got a write response without a stream token"),this.lastStreamToken=this.serializer.mi(t.streamToken),this.Ma){this.Ea.reset();var e=this.serializer.Wi(t.writeResults,t.commitTime),n=this.serializer.fromVersion(t.commitTime);return this.listener.Ba(n,e)}return va(!t.writeResults||0===t.writeResults.length,"Got mutation results for handshake"),this.Ma=!0,this.listener.xa()},$h.prototype.Qa=function(){var t={};t.database=this.serializer.gi,this.ga(t)},$h.prototype.qa=function(t){var e=this,n={streamToken:this.serializer.Ti(this.lastStreamToken),writes:t.map(function(t){return e.serializer.Li(t)})};this.ga(n)},$h),wh=(Zh.prototype.Wa=function(t){return new mh(this.ia,this.fa,this.credentials,this.serializer,t)},Zh.prototype.ja=function(t){return new gh(this.ia,this.fa,this.credentials,this.serializer,t)},Zh.prototype.commit=function(t){var e=this,n={database:this.serializer.gi,writes:t.map(function(t){return e.serializer.Li(t)})};return this.Ga("Commit",n).then(function(t){return e.serializer.Wi(t.writeResults,t.commitTime)})},Zh.prototype.za=function(e){var r=this,t={database:this.serializer.gi,documents:e.map(function(t){return r.serializer.Ai(t)})};return this.Ka("BatchGetDocuments",t).then(function(t){var n=Ts();t.forEach(function(t){var e=r.serializer.Di(t);n=n.nt(e.key,e)});var i=[];return e.forEach(function(t){var e=n.get(t);va(!!e,"Missing entity in write response for "+t),i.push(e)}),i})},Zh.prototype.Ga=function(e,n){var i=this;return this.credentials.getToken().then(function(t){return i.fa.Ga(e,n,t)}).catch(function(t){throw t.code===Pi.UNAUTHENTICATED&&i.credentials.l(),t})},Zh.prototype.Ka=function(e,n){var i=this;return this.credentials.getToken().then(function(t){return i.fa.Ka(e,n,t)}).catch(function(t){throw t.code===Pi.UNAUTHENTICATED&&i.credentials.l(),t})},Zh),bh=(Kh.prototype.za=function(i){return c(this,void 0,void 0,function(){var e,n=this;return y(this,function(t){switch(t.label){case 0:if(this.tu(),0<this.mutations.length)throw new Mi(Pi.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,this.Ha.za(i)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof Oo||t instanceof Do?n.eu(t):ya("Document in a transaction was a "+t.constructor.name)}),e)]}})})},Kh.prototype.set=function(t,e){this.write(e.Lo(t,this.Zt(t))),this.Za.add(t)},Kh.prototype.update=function(t,e){try{this.write(e.Lo(t,this.su(t)))}catch(t){this.Xa=t}this.Za.add(t)},Kh.prototype.delete=function(t){this.write([new vo(t,this.Zt(t))]),this.Za.add(t)},Kh.prototype.commit=function(){return c(this,void 0,void 0,function(){var e,n=this;return y(this,function(t){switch(t.label){case 0:if(this.tu(),this.Xa)throw this.Xa;return e=this.Ja,this.mutations.forEach(function(t){e=e.remove(t.key)}),e.forEach(function(t,e){n.mutations.push(new go(t,n.Zt(t)))}),[4,this.Ha.commit(this.mutations)];case 1:return t.sent(),this.Ya=!0,[2]}})})},Kh.prototype.eu=function(t){var e;if(t instanceof Do)e=t.version;else{if(!(t instanceof Oo))throw ya("Document in a transaction was a "+t.constructor.name);e=Bi.S()}var n=this.Ja.get(t.key);if(null!==n){if(!e.isEqual(n))throw new Mi(Pi.ABORTED,"Document version changed between two reads.")}else this.Ja=this.Ja.nt(t.key,e)},Kh.prototype.Zt=function(t){var e=this.Ja.get(t);return!this.Za.has(t)&&e?no.updateTime(e):no.NONE},Kh.prototype.su=function(t){var e=this.Ja.get(t);if(this.Za.has(t)||!e)return no.exists(!0);if(e.isEqual(Bi.S()))throw new Mi(Pi.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return no.updateTime(e)},Kh.prototype.write=function(t){this.tu(),this.mutations=this.mutations.concat(t)},Kh.prototype.tu=function(){},Kh),Eh=(Jh.prototype.ou=function(){var t=this;0===this.nu&&(this.au("Unknown"),this.ru=this.Ar.Qr("online_state_timeout",1e4,function(){return t.ru=null,t.uu("Backend didn't respond within 10 seconds."),t.au("Offline"),Promise.resolve()}))},Jh.prototype.cu=function(t){"Online"===this.state?this.au("Unknown"):(this.nu++,1<=this.nu&&(this.lu(),this.uu("Connection failed 1 times. Most recent error: "+t.toString()),this.au("Offline")))},Jh.prototype.set=function(t){this.lu(),this.nu=0,"Online"===t&&(this.hu=!1),this.au(t)},Jh.prototype.au=function(t){t!==this.state&&(this.state=t,this.iu(t))},Jh.prototype.uu=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.hu?(pa(e),this.hu=!1):fa("OnlineStateTracker",e)},Jh.prototype.lu=function(){null!==this.ru&&(this.ru.cancel(),this.ru=null)},Jh),Ah=(Xh.prototype.start=function(){return this.enableNetwork()},Xh.prototype.enableNetwork=function(){return c(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return this.networkEnabled=!0,this.Eu()?(e=this.gu,[4,this._u.xh()]):[3,3];case 1:return e.lastStreamToken=t.sent(),this.Su()?this.Cu():this.Iu.set("Unknown"),[4,this.Du()];case 2:t.sent(),t.label=3;case 3:return[2]}})})},Xh.prototype.disableNetwork=function(){return c(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.networkEnabled=!1,[4,this.Fu()];case 1:return t.sent(),this.Iu.set("Offline"),[2]}})})},Xh.prototype.Fu=function(){return c(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return[4,this.gu.stop()];case 1:return t.sent(),[4,this.Au.stop()];case 2:return t.sent(),0<this.du.length&&(fa("RemoteStore","Stopping write stream with "+this.du.length+" pending writes"),this.du=[]),this.Nu(),[2]}})})},Xh.prototype.ku=function(){return c(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return fa("RemoteStore","RemoteStore shutting down."),this.networkEnabled=!1,[4,this.Fu()];case 1:return t.sent(),this.Tu.ku(),this.Iu.set("Unknown"),[2]}})})},Xh.prototype.listen=function(t){this.fu.has(t.targetId)||(this.fu.set(t.targetId,t),this.Su()?this.Cu():this.Au.Ia()&&this.Lu(t))},Xh.prototype.$u=function(t){this.fu.delete(t),this.Au.Ia()&&this.Ou(t),0===this.fu.size&&(this.Au.Ia()?this.Au.Va():this.Eu()&&this.Iu.set("Unknown"))},Xh.prototype.ui=function(t){return this.fu.get(t)||null},Xh.prototype.ai=function(t){return this.Mu.ai(t)},Xh.prototype.Lu=function(t){this.wu.qs(t.targetId),this.Au.$a(t)},Xh.prototype.Ou=function(t){this.wu.qs(t),this.Au.Oa(t)},Xh.prototype.Cu=function(){this.wu=new Hs(this),this.Au.start(),this.Iu.ou()},Xh.prototype.Su=function(){return this.Eu()&&!this.Au.Ra()&&0<this.fu.size},Xh.prototype.Eu=function(){return this.isPrimary&&this.networkEnabled},Xh.prototype.Nu=function(){this.wu=null},Xh.prototype.Pu=function(){return c(this,void 0,void 0,function(){var n=this;return y(this,function(t){return this.fu.forEach(function(t,e){n.Lu(t)}),[2]})})},Xh.prototype.Vu=function(e){return c(this,void 0,void 0,function(){return y(this,function(t){return this.Nu(),this.Su()?(this.Iu.cu(e),this.Cu()):this.Iu.set("Unknown"),[2]})})},Xh.prototype.pu=function(n,i){return c(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return this.Iu.set("Online"),n instanceof Ms&&2===n.state&&n.cause?[2,this.Uu(n)]:(n instanceof Us?this.wu.Ks(n):n instanceof Ps?this.wu.si(n):this.wu.Ys(n),i.isEqual(Bi.MIN)?[3,4]:[4,this._u.Wh()]);case 1:return e=t.sent(),0<=i.C(e)?[4,this.qu(i)]:[3,3];case 2:t.sent(),t.label=3;case 3:t.label=4;case 4:return[2]}})})},Xh.prototype.qu=function(i){var r=this,t=this.wu.ri(i);return t.ws.forEach(function(t,e){if(0<t.resumeToken.Mt()){var n=r.fu.get(e);n&&r.fu.set(e,n.ss(t.resumeToken,i))}}),t.Ts.forEach(function(t){var e=r.fu.get(t);if(e){r.fu.set(t,e.ss(Ar.Ut,e.ts)),r.Ou(t);var n=new ms(e.target,t,1,e.sequenceNumber);r.Lu(n)}}),this.Mu.jh(t)},Xh.prototype.Uu=function(t){var n=this,i=t.cause,r=Promise.resolve();return t.targetIds.forEach(function(e){r=r.then(function(){return c(n,void 0,void 0,function(){return y(this,function(t){return this.fu.has(e)?[2,(this.fu.delete(e),this.wu.removeTarget(e),this.Mu.Bu(e,i))]:[2]})})})}),r},Xh.prototype.Du=function(){return c(this,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:return this.xu()?(e=0<this.du.length?this.du[this.du.length-1].batchId:-1,[4,this._u.io(e)]):[3,5];case 1:return null!==(n=t.sent())?[3,2]:(0===this.du.length&&this.gu.Va(),[3,4]);case 2:return this.Qu(n),[4,this.Du()];case 3:t.sent(),t.label=4;case 4:t.label=5;case 5:return this.Wu()&&this.ju(),[2]}})})},Xh.prototype.xu=function(){return this.Eu()&&this.du.length<10},Xh.prototype.Gu=function(){return this.du.length},Xh.prototype.Qu=function(t){this.du.push(t),this.gu.Ia()&&this.gu.Ua&&this.gu.qa(t.mutations)},Xh.prototype.Wu=function(){return this.Eu()&&!this.gu.Ra()&&0<this.du.length},Xh.prototype.ju=function(){this.gu.start()},Xh.prototype.yu=function(){return c(this,void 0,void 0,function(){return y(this,function(t){return this.gu.Qa(),[2]})})},Xh.prototype.vu=function(){var i=this;return this._u.Qh(this.gu.lastStreamToken).then(function(){for(var t=0,e=i.du;t<e.length;t++){var n=e[t];i.gu.qa(n.mutations)}}).catch(Ka)},Xh.prototype.Ba=function(t,e){var n=this,i=this.du.shift(),r=Ta.from(i,t,e,this.gu.lastStreamToken);return this.Mu.zu(r).then(function(){return n.Du()})},Xh.prototype.bu=function(n){return c(this,void 0,void 0,function(){var e=this;return y(this,function(t){return n&&0<this.du.length?[2,(this.gu.Ua?this.Ku(n):this.Hu(n)).then(function(){e.Wu()&&e.ju()})]:[2]})})},Xh.prototype.Hu=function(e){return c(this,void 0,void 0,function(){return y(this,function(t){return As(e.code)?[2,(fa("RemoteStore","RemoteStore error before completed handshake; resetting stream token: ",this.gu.lastStreamToken),this.gu.lastStreamToken=Ar.Ut,this._u.Qh(Ar.Ut).catch(Ka))]:[2]})})},Xh.prototype.Ku=function(r){return c(this,void 0,void 0,function(){var e,n,i=this;return y(this,function(t){return As(n=r.code)&&n!==Pi.ABORTED?(e=this.du.shift(),[2,(this.gu.Pa(),this.Mu.Ju(e.batchId,r).then(function(){return i.Du()}))]):[2]})})},Xh.prototype.Yu=function(){return new bh(this.Ha)},Xh.prototype.Ru=function(){return c(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.networkEnabled=!1,[4,this.Fu()];case 1:return t.sent(),this.Iu.set("Unknown"),[4,this.enableNetwork()];case 2:return t.sent(),[2]}})})},Xh.prototype.Xu=function(){return c(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.Eu()?(fa("RemoteStore","RemoteStore restarting streams for new credential"),[4,this.Ru()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},Xh.prototype.Zu=function(e){return c(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return(this.isPrimary=e)&&this.networkEnabled?[4,this.enableNetwork()]:[3,2];case 1:return t.sent(),[3,5];case 2:return e?[3,4]:[4,this.Fu()];case 3:t.sent(),this.Iu.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})},Xh),Ih=(Wh.prototype.tc=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},Wh.prototype.ec=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},Wh.prototype.sc=function(){var t={activeTargetIds:this.activeTargetIds.j(),updateTimeMs:Date.now()};return JSON.stringify(t)},Wh),Nh=(Yh.prototype.rc=function(t){},Yh.prototype.hc=function(t,e,n){},Yh.prototype.oc=function(t){return this.ic.tc(t),this.nc[t]||"not-current"},Yh.prototype.ac=function(t,e,n){this.nc[t]=e},Yh.prototype.uc=function(t){this.ic.ec(t)},Yh.prototype.cc=function(t){return this.ic.activeTargetIds.has(t)},Yh.prototype.lc=function(t){delete this.nc[t]},Yh.prototype._c=function(){return this.ic.activeTargetIds},Yh.prototype.dc=function(t){return this.ic.activeTargetIds.has(t)},Yh.prototype.start=function(){return this.ic=new Ih,Promise.resolve()},Yh.prototype.Vh=function(t,e,n){},Yh.prototype.fc=function(t){},Yh.prototype.ku=function(){},Yh.prototype.Rr=function(t){},Yh),Th=(zh.prototype.next=function(){return this.wc+=2,this.wc},zh.Tc=function(){return new zh(0)},zh.mc=function(){return new zh(-1)},zh),_h=(Object.defineProperty(Qh.prototype,"Pc",{get:function(){return this.Ec},enumerable:!0,configurable:!0}),Qh.prototype.Vc=function(t,e){var a=this,u=e?e.pc:new Fs,h=e?e.Ac:this.Ac,c=e?e.ls:this.ls,l=h,f=!1,p=this.query.je()&&h.size===this.query.limit?h.last():null,d=this.query.Ge()&&h.size===this.query.limit?h.first():null;if(t.ut(function(t,e){var n=h.get(t),i=e instanceof Do?e:null;i=i&&(a.query.matches(i)?i:null);var r=!!n&&a.ls.has(n.key),o=!!i&&(i.te||a.ls.has(i.key)&&i.hasCommittedMutations),s=!1;n&&i?n.data().isEqual(i.data())?r!==o&&(u.track({type:3,doc:i}),s=!0):a.gc(n,i)||(u.track({type:2,doc:i}),s=!0,(p&&0<a.query.qe(i,p)||d&&a.query.qe(i,d)<0)&&(f=!0)):!n&&i?(u.track({type:0,doc:i}),s=!0):n&&!i&&(u.track({type:1,doc:n}),s=!0,(p||d)&&(f=!0)),s&&(c=i?(l=l.add(i),o?c.add(t):c.delete(t)):(l=l.delete(t),c.delete(t)))}),this.query.je()||this.query.Ge())for(;l.size>this.query.limit;){var n=this.query.je()?l.last():l.first();l=l.delete(n.key),c=c.delete(n.key),u.track({type:1,doc:n})}return{Ac:l,pc:u,yc:f,ls:c}},Qh.prototype.gc=function(t,e){return t.te&&e.hasCommittedMutations&&!e.te},Qh.prototype.bc=function(t,e,n){var o=this,i=this.Ac;this.Ac=t.Ac,this.ls=t.ls;var r=t.pc.us();r.sort(function(t,e){return i=t.type,r=e.type,n(i)-n(r)||o.query.qe(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ya("Unknown ChangeType: "+t)}}var i,r}),this.vc(n);var s=e?this.Sc():[],a=0===this.Ic.size&&this.As?1:0,u=a!==this.Rc;return this.Rc=a,0!==r.length||u?{snapshot:new Gs(this.query,t.Ac,i,r,t.ls,0==a,u,!1),Cc:s}:{Cc:s}},Qh.prototype.Dc=function(t){return this.As&&"Offline"===t?(this.As=!1,this.bc({Ac:this.Ac,pc:new Fs,ls:this.ls,yc:!1},!1)):{Cc:[]}},Qh.prototype.Fc=function(t){return!this.Ec.has(t)&&!!this.Ac.has(t)&&!this.Ac.get(t).te},Qh.prototype.vc=function(t){var e=this;t&&(t.Ps.forEach(function(t){return e.Ec=e.Ec.add(t)}),t.Vs.forEach(function(t){}),t.ps.forEach(function(t){return e.Ec=e.Ec.delete(t)}),this.As=t.As)},Qh.prototype.Sc=function(){var e=this;if(!this.As)return[];var n=this.Ic;this.Ic=Os(),this.Ac.forEach(function(t){e.Fc(t.key)&&(e.Ic=e.Ic.add(t.key))});var i=[];return n.forEach(function(t){e.Ic.has(t)||i.push(new uh(t))}),this.Ic.forEach(function(t){n.has(t)||i.push(new ah(t))}),i},Qh.prototype.Nc=function(t){this.Ec=t.do,this.Ic=Os();var e=this.Vc(t.documents);return this.bc(e,!0)},Qh.prototype.kc=function(){return Gs.fs(this.query,this.Ac,this.ls,0===this.Rc)},Qh),Sh=(Hh.prototype.Oc=function(){this.Mc()},Hh.prototype.Mc=function(){var t=this;this.Ea.la(function(){return c(t,void 0,void 0,function(){var e,n,i=this;return y(this,function(t){return e=this.Lc.Yu(),(n=this.Uc(e))&&n.then(function(t){i.Ar.Cr(function(){return e.commit().then(function(){i.gr.resolve(t)}).catch(function(t){i.qc(t)})})}).catch(function(t){i.qc(t)}),[2]})})})},Hh.prototype.Uc=function(t){try{var e=this.updateFunction(t);return!Nr(e)&&e.catch&&e.then?e:(this.gr.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.gr.reject(t),null}},Hh.prototype.qc=function(t){var e=this;0<this.$c&&this.Bc(t)?(--this.$c,this.Ar.Cr(function(){return e.Mc(),Promise.resolve()})):this.gr.reject(t)},Hh.prototype.Bc=function(t){if("FirebaseError"!==t.name)return!1;var e=t.code;return"aborted"===e||"failed-precondition"===e||!As(e)},Hh),kh=(Object.defineProperty(Bh.prototype,"el",{get:function(){return!0===this.isPrimary},enumerable:!0,configurable:!0}),Bh.prototype.subscribe=function(t){this.jc=t},Bh.prototype.listen=function(s){return c(this,void 0,void 0,function(){var e,n,i,r,o;return y(this,function(t){switch(t.label){case 0:return this.sl("listen()"),(i=this.Gc.get(s))?(e=i.targetId,this.Qc.oc(e),n=i.view.kc(),[3,4]):[3,1];case 1:return[4,this._u.ho(s.Ue())];case 2:return r=t.sent(),o=this.Qc.oc(r.targetId),e=r.targetId,[4,this.il(s,e,"current"===o)];case 3:n=t.sent(),this.isPrimary&&this.Lc.listen(r),t.label=4;case 4:return[2,(this.jc.La([n]),e)]}})})},Bh.prototype.il=function(a,u,h){return c(this,void 0,void 0,function(){var e,n,i,r,o,s;return y(this,function(t){switch(t.label){case 0:return[4,this._u.lo(a,!0)];case 1:return e=t.sent(),n=new _h(a,e.do),i=n.Vc(e.documents),r=js.Is(u,h&&"Offline"!==this.onlineState),o=n.bc(i,!0===this.isPrimary,r),s=new hh(a,u,n),[2,(this.Gc.set(a,s),this.zc.has(u)?this.zc.get(u).push(a):this.zc.set(u,[a]),o.snapshot)]}})})},Bh.prototype.nl=function(i){return c(this,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:return[4,this._u.lo(i.query,!0)];case 1:return e=t.sent(),n=i.view.Nc(e),[2,(this.isPrimary&&this.rl(i.targetId,n.Cc),n)]}})})},Bh.prototype.$u=function(r){return c(this,void 0,void 0,function(){var e,n,i=this;return y(this,function(t){switch(t.label){case 0:return this.sl("unlisten()"),e=this.Gc.get(r),1<(n=this.zc.get(e.targetId)).length?[2,(this.zc.set(e.targetId,n.filter(function(t){return!t.isEqual(r)})),void this.Gc.delete(r))]:this.isPrimary?(this.Qc.uc(e.targetId),this.Qc.dc(e.targetId)?[3,2]:[4,this._u.co(e.targetId,!1).then(function(){i.Qc.lc(e.targetId),i.Lc.$u(e.targetId),i.hl(e.targetId)}).catch(Ka)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return this.hl(e.targetId),[4,this._u.co(e.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})},Bh.prototype.write=function(n,i){return c(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return this.sl("write()"),[4,this._u.vh(n)];case 1:return e=t.sent(),this.Qc.rc(e.batchId),this.ol(e.batchId,i),[4,this.al(e.Ch)];case 2:return t.sent(),[4,this.Lc.Du()];case 3:return t.sent(),[2]}})})},Bh.prototype.runTransaction=function(t,e,n){new Sh(t,this.Lc,e,n).Oc()},Bh.prototype.jh=function(n){return c(this,void 0,void 0,function(){var e,i=this;return y(this,function(t){switch(t.label){case 0:this.sl("applyRemoteEvent()"),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this._u.jh(n)];case 2:return e=t.sent(),n.ws.forEach(function(t,e){var n=i.Jc.get(e);n&&(va(t.Ps.size+t.Vs.size+t.ps.size<=1,"Limbo resolution for single document contains multiple changes."),0<t.Ps.size?n.xc=!0:0<t.Vs.size?va(n.xc,"Received change for limbo target document without add."):0<t.ps.size&&(va(n.xc,"Received remove for limbo target document without add."),n.xc=!1))}),[4,this.al(e,n)];case 3:return t.sent(),[3,6];case 4:return[4,Ka(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},Bh.prototype.Dc=function(i,t){if(this.isPrimary&&0===t||!this.isPrimary&&1===t){this.sl("applyOnlineStateChange()");var r=[];this.Gc.forEach(function(t,e){var n=e.view.Dc(i);n.snapshot&&r.push(n.snapshot)}),this.jc.ul(i),this.jc.La(r),this.onlineState=i,this.isPrimary&&this.Qc.fc(i)}},Bh.prototype.Bu=function(a,u){return c(this,void 0,void 0,function(){var e,n,i,r,o,s=this;return y(this,function(t){switch(t.label){case 0:return this.sl("rejectListens()"),this.Qc.ac(a,"rejected",u),e=this.Jc.get(a),(n=e&&e.key)?(this.Hc=this.Hc.remove(n),this.Jc.delete(a),this.cl(),i=(i=new ur(sr.k)).nt(n,new Oo(n,Bi.S())),r=Os().add(n),o=new xs(Bi.MIN,new Map,new yr(wa),i,r),[2,this.jh(o)]):[4,this._u.co(a,!1).then(function(){return s.hl(a,u)}).catch(Ka)];case 1:return t.sent(),[2]}})})},Bh.prototype.ll=function(n,i,r){return c(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return this.sl("applyBatchState()"),[4,this._u.Dh(n)];case 1:return null===(e=t.sent())?[3,6]:"pending"!==i?[3,3]:[4,this.Lc.Du()];case 2:return t.sent(),[3,4];case 3:"acknowledged"===i||"rejected"===i?(this._l(n,r||null),this._u.To(n)):ya("Unknown batchState: "+i),t.label=4;case 4:return[4,this.al(e)];case 5:return t.sent(),[3,7];case 6:fa("SyncEngine","Cannot apply mutation batch with id: "+n),t.label=7;case 7:return[2]}})})},Bh.prototype.zu=function(i){return c(this,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:this.sl("applySuccessfulWrite()"),e=i.batch.batchId,this._l(e,null),this.dl(e),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this._u.Nh(i)];case 2:return n=t.sent(),this.Qc.hc(e,"acknowledged"),[4,this.al(n)];case 3:return t.sent(),[3,6];case 4:return[4,Ka(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},Bh.prototype.Ju=function(n,i){return c(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:this.sl("rejectFailedWrite()"),this._l(n,i),this.dl(n),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this._u.Mh(n)];case 2:return e=t.sent(),this.Qc.hc(n,"rejected",i),[4,this.al(e)];case 3:return t.sent(),[3,6];case 4:return[4,Ka(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},Bh.prototype.fl=function(i){return c(this,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:return this.Lc.Eu()||fa("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),[4,this._u.Bh()];case 1:return-1===(e=t.sent())?[2,void i.resolve()]:((n=this.Zc.get(e)||[]).push(i),this.Zc.set(e,n),[2])}})})},Bh.prototype.dl=function(t){(this.Zc.get(t)||[]).forEach(function(t){t.resolve()}),this.Zc.delete(t)},Bh.prototype.wl=function(e){this.Zc.forEach(function(t){t.forEach(function(t){t.reject(new Mi(Pi.CANCELLED,e))})}),this.Zc.clear()},Bh.prototype.ol=function(t,e){var n=this.Xc[this.currentUser.s()];n=(n=n||new ur(wa)).nt(t,e),this.Xc[this.currentUser.s()]=n},Bh.prototype._l=function(t,e){var n=this.Xc[this.currentUser.s()];if(n){var i=n.get(t);i&&(e?i.reject(e):i.resolve(),n=n.remove(t)),this.Xc[this.currentUser.s()]=n}},Bh.prototype.hl=function(t,e){var n=this;void 0===e&&(e=null),this.Qc.uc(t);for(var i=0,r=this.zc.get(t);i<r.length;i++){var o=r[i];this.Gc.delete(o),e&&this.jc.Tl(o,e)}if(this.zc.delete(t),this.isPrimary){var s=this.Yc.Ln(t);this.Yc.Nn(t),s.forEach(function(t){n.Yc.$n(t)||n.ml(t)})}},Bh.prototype.ml=function(t){var e=this.Hc.get(t);null!==e&&(this.Lc.$u(e),this.Hc=this.Hc.remove(t),this.Jc.delete(e),this.cl())},Bh.prototype.rl=function(t,e){for(var n=0,i=e;n<i.length;n++){var r=i[n];r instanceof ah?(this.Yc.vn(r.key,t),this.El(r)):r instanceof uh?(fa("SyncEngine","Document no longer in limbo: "+r.key),this.Yc.Cn(r.key,t),this.Yc.$n(r.key)||this.ml(r.key)):ya("Unknown limbo change: "+JSON.stringify(r))}},Bh.prototype.El=function(t){var e=t.key;this.Hc.get(e)||(fa("SyncEngine","New document in limbo: "+e),this.Kc.push(e),this.cl())},Bh.prototype.cl=function(){for(;0<this.Kc.length&&this.Hc.size<this.Wc;){var t=this.Kc.shift(),e=this.tl.next();this.Jc.set(e,new ch(t)),this.Hc=this.Hc.nt(t,e),this.Lc.listen(new ms(Uo.ve(t.path).Ue(),e,2,Da.Ir))}},Bh.prototype.Rl=function(){return this.Hc},Bh.prototype.Il=function(){return this.Kc},Bh.prototype.al=function(i,u){return c(this,void 0,void 0,function(){var o,s,e,a=this;return y(this,function(t){switch(t.label){case 0:return o=[],s=[],e=[],this.Gc.forEach(function(t,r){e.push(Promise.resolve().then(function(){var n=r.view.Vc(i);return n.yc?a._u.lo(r.query,!1).then(function(t){var e=t.documents;return r.view.Vc(e,n)}):n}).then(function(t){var e=u&&u.ws.get(r.targetId),n=r.view.bc(t,!0===a.isPrimary,e);if(a.rl(r.targetId,n.Cc),n.snapshot){a.isPrimary&&a.Qc.ac(r.targetId,n.snapshot.fromCache?"not-current":"current"),o.push(n.snapshot);var i=La.wr(r.targetId,n.snapshot);s.push(i)}}))}),[4,Promise.all(e)];case 1:return t.sent(),this.jc.La(o),[4,this._u.so(s)];case 2:return t.sent(),[2]}})})},Bh.prototype.sl=function(t){},Bh.prototype.Xu=function(i){return c(this,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:return e=!this.currentUser.isEqual(i),this.currentUser=i,e?(this.wl("'waitForPendingWrites' promise is rejected due to a user change."),[4,this._u.Vh(i)]):[3,3];case 1:return n=t.sent(),this.Qc.Vh(i,n.yh,n.bh),[4,this.al(n.gh)];case 2:t.sent(),t.label=3;case 3:return[4,this.Lc.Xu()];case 4:return t.sent(),[2]}})})},Bh.prototype.Zu=function(h){return c(this,void 0,void 0,function(){var e,n,i,r,o,s,a,u=this;return y(this,function(t){switch(t.label){case 0:return!0!==h||!0===this.isPrimary?[3,3]:(this.isPrimary=!0,[4,this.Lc.Zu(!0)]);case 1:return t.sent(),e=this.Qc._c(),[4,this.Al(e.j())];case 2:for(n=t.sent(),i=0,r=n;i<r.length;i++)o=r[i],this.Lc.listen(o);return[3,7];case 3:return!1!==h||!1===this.isPrimary?[3,7]:(this.isPrimary=!1,s=[],a=Promise.resolve(),this.zc.forEach(function(t,e){u.Qc.cc(e)?s.push(e):a=a.then(function(){return u.hl(e),u._u.co(e,!0)}),u.Lc.$u(e)}),[4,a]);case 4:return t.sent(),[4,this.Al(s)];case 5:return t.sent(),this.Pl(),[4,this.Lc.Zu(!1)];case 6:t.sent(),t.label=7;case 7:return[2]}})})},Bh.prototype.Pl=function(){var n=this;this.Jc.forEach(function(t,e){n.Lc.$u(e)}),this.Yc.kn(),this.Jc=new Map,this.Hc=new ur(sr.k)},Bh.prototype.Al=function(d){return c(this,void 0,void 0,function(){var e,n,i,r,o,s,a,u,h,c,l,f,p;return y(this,function(t){switch(t.label){case 0:e=[],n=[],i=0,r=d,t.label=1;case 1:return i<r.length?(o=r[i],s=void 0,(a=this.zc.get(o))&&0!==a.length?[4,this._u.co(o,!0)]:[3,8]):[3,14];case 2:return t.sent(),[4,this._u.ho(a[0].Ue())];case 3:s=t.sent(),u=0,h=a,t.label=4;case 4:return u<h.length?(c=h[u],l=this.Gc.get(c),[4,this.nl(l)]):[3,7];case 5:(f=t.sent()).snapshot&&n.push(f.snapshot),t.label=6;case 6:return u++,[3,4];case 7:return[3,12];case 8:return[4,this._u.Ao(o)];case 9:return p=t.sent(),[4,this._u.ho(p)];case 10:return s=t.sent(),[4,this.il(this.Vl(p),o,!1)];case 11:t.sent(),t.label=12;case 12:e.push(s),t.label=13;case 13:return i++,[3,1];case 14:return[2,(this.jc.La(n),e)]}})})},Bh.prototype.Vl=function(t){return new Uo(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)},Bh.prototype.wo=function(){return this._u.wo()},Bh.prototype.pl=function(i,r,o){return c(this,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:return this.isPrimary?(fa("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!this.zc.has(i))return[3,8];switch(r){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,this._u.Po()];case 3:return e=t.sent(),n=xs.Rs(i,"current"===r),[4,this.al(e,n)];case 4:return t.sent(),[3,8];case 5:return[4,this._u.co(i,!0)];case 6:return t.sent(),this.hl(i,o),[3,8];case 7:ya("Unexpected target state: "+r),t.label=8;case 8:return[2]}})})},Bh.prototype.gl=function(f,p){return c(this,void 0,void 0,function(){var e,n,i,r,o,s,a,u,h,c,l=this;return y(this,function(t){switch(t.label){case 0:if(!this.isPrimary)return[3,10];e=0,n=f,t.label=1;case 1:return e<n.length?(i=n[e],[4,this._u.Ao(i)]):[3,6];case 2:return r=t.sent(),[4,this._u.ho(r)];case 3:return o=t.sent(),[4,this.il(this.Vl(r),o.targetId,!1)];case 4:t.sent(),this.Lc.listen(o),t.label=5;case 5:return e++,[3,1];case 6:s=function(e){return y(this,function(t){switch(t.label){case 0:return a.zc.has(e)?[4,a._u.co(e,!1).then(function(){l.Lc.$u(e),l.hl(e)}).catch(Ka)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})},a=this,u=0,h=p,t.label=7;case 7:return u<h.length?(c=h[u],[5,s(c)]):[3,10];case 8:t.sent(),t.label=9;case 9:return u++,[3,7];case 10:return[2]}})})},Bh.prototype.enableNetwork=function(){return this._u.Eo(!0),this.Lc.enableNetwork()},Bh.prototype.disableNetwork=function(){return this._u.Eo(!1),this.Lc.disableNetwork()},Bh.prototype.ai=function(t){var e=this.Jc.get(t);if(e&&e.xc)return Os().add(e.key);var n=Os(),i=this.zc.get(t);if(!i)return n;for(var r=0,o=i;r<o.length;r++){var s=o[r],a=this.Gc.get(s);n=n.kt(a.view.Pc)}return n},Bh),Rh=(jh.prototype.listen=function(t){var e=t.query,n=!1,i=this.vl.get(e);return i||(n=!0,i=new lh,this.vl.set(e,i)),i.bl.push(t),t.Dc(this.onlineState),i.yl&&t.Cl(i.yl)&&this.Dl(),n?this.Mu.listen(e).then(function(t){return i.targetId=t}):Promise.resolve(i.targetId)},jh.prototype.$u=function(o){return c(this,void 0,void 0,function(){var e,n,i,r;return y(this,function(t){return e=o.query,n=!1,(i=this.vl.get(e))&&0<=(r=i.bl.indexOf(o))&&(i.bl.splice(r,1),n=0===i.bl.length),n?[2,(this.vl.delete(e),this.Mu.$u(e))]:[2]})})},jh.prototype.La=function(t){for(var e=!1,n=0,i=t;n<i.length;n++){var r=i[n],o=r.query,s=this.vl.get(o);if(s){for(var a=0,u=s.bl;a<u.length;a++)u[a].Cl(r)&&(e=!0);s.yl=r}}e&&this.Dl()},jh.prototype.Tl=function(t,e){var n=this.vl.get(t);if(n)for(var i=0,r=n.bl;i<r.length;i++)r[i].onError(e);this.vl.delete(t)},jh.prototype.ul=function(r){this.onlineState=r;var o=!1;this.vl.forEach(function(t,e){for(var n=0,i=e.bl;n<i.length;n++)i[n].Dc(r)&&(o=!0)}),o&&this.Dl()},jh.prototype.Fl=function(t){this.Sl.add(t),t.next()},jh.prototype.Nl=function(t){this.Sl.delete(t)},jh.prototype.Dl=function(){this.Sl.forEach(function(t){t.next()})},jh),Lh=(xh.prototype.Cl=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,i=t.docChanges;n<i.length;n++){var r=i[n];3!==r.type&&e.push(r)}t=new Gs(t.query,t.docs,t.cs,e,t.ls,t.fromCache,t._s,!0)}var o=!1;return this.Ll?this.Ol(t)&&(this.kl.next(t),o=!0):this.Ml(t,this.onlineState)&&(this.Ul(t),o=!0),this.$l=t,o},xh.prototype.onError=function(t){this.kl.error(t)},xh.prototype.Dc=function(t){this.onlineState=t;var e=!1;return this.$l&&!this.Ll&&this.Ml(this.$l,t)&&(this.Ul(this.$l),e=!0),e},xh.prototype.Ml=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.ql&&n||t.docs.q()&&"Offline"!==e)},xh.prototype.Ol=function(t){if(0<t.docChanges.length)return!0;var e=this.$l&&this.$l.hasPendingWrites!==t.hasPendingWrites;return!(!t._s&&!e)&&!0===this.options.includeMetadataChanges},xh.prototype.Ul=function(t){t=Gs.fs(t.query,t.docs,t.ls,t.fromCache),this.Ll=!0,this.kl.next(t)},xh),Dh=(Gh.prototype.Ah=function(t){this.Bl=t},Gh.prototype.rr=function(e,i,r,o){var s=this;return i.Me()||r.isEqual(Bi.MIN)?this.xl(e,i):this.Bl.sr(e,o).next(function(t){var n=s.Ql(i,t);return(i.je()||i.Ge())&&s.yc(i.pe,n,o,r)?s.xl(e,i):(ca()<=a.DEBUG&&fa("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),i.toString()),s.Bl.rr(e,i,r).next(function(e){return n.forEach(function(t){e=e.nt(t.key,t)}),e}))})},Gh.prototype.Ql=function(n,t){var i=new yr(function(t,e){return n.qe(t,e)});return t.forEach(function(t,e){e instanceof Do&&n.matches(e)&&(i=i.add(e))}),i},Gh.prototype.yc=function(t,e,n,i){if(n.size!==e.size)return!0;var r="F"===t?e.last():e.first();return!!r&&(r.hasPendingWrites||0<r.version.C(i))},Gh.prototype.xl=function(t,e){return ca()<=a.DEBUG&&fa("IndexFreeQueryEngine","Using full collection scan to execute query: %s",e.toString()),this.Bl.rr(t,e,Bi.MIN)},Gh),Oh=(Fh.prototype.jl=function(t,e){return this.Wl.add(e),ka.resolve()},Fh.prototype.ur=function(t,e){return ka.resolve(this.Wl.getEntries(e))},Fh),Ch=(qh.prototype.add=function(t){var e=t.U(),n=t.O(),i=this.index[e]||new yr($i.k),r=!i.has(n);return this.index[e]=i.add(n),r},qh.prototype.has=function(t){var e=t.U(),n=t.O(),i=this.index[e];return i&&i.has(n)},qh.prototype.getEntries=function(t){return(this.index[t]||new yr($i.k)).j()},qh),Vh=(Mh.prototype.Kl=function(t){return ka.resolve(0===this.Hn.length)},Mh.prototype.Nh=function(t,e,n){var i=e.batchId,r=this.Hl(i,"acknowledged");return va(0===r,"Can only acknowledge the first batch in the mutation queue"),this.Hn[r],this.lastStreamToken=n,ka.resolve()},Mh.prototype.xh=function(t){return ka.resolve(this.lastStreamToken)},Mh.prototype.Qh=function(t,e){return this.lastStreamToken=e,ka.resolve()},Mh.prototype.Sh=function(t,e,n,i){var r=this.Gl;this.Gl++,0<this.Hn.length&&this.Hn[this.Hn.length-1];var o=new Na(r,e,n,i);this.Hn.push(o);for(var s=0,a=i;s<a.length;s++){var u=a[s];this.zl=this.zl.add(new Sa(u.key,r)),this.Jn.jl(t,u.key.path.O())}return ka.resolve(o)},Mh.prototype.Uh=function(t,e){return ka.resolve(this.Jl(e))},Mh.prototype.Fh=function(t,e){var n=this.Jl(e);return ka.resolve(n.keys())},Mh.prototype.no=function(t,e){var n=e+1,i=this.Yl(n),r=i<0?0:i;return ka.resolve(this.Hn.length>r?this.Hn[r]:null)},Mh.prototype.Bh=function(){return ka.resolve(0===this.Hn.length?-1:this.Gl-1)},Mh.prototype.ph=function(t){return ka.resolve(this.Hn.slice())},Mh.prototype.Xn=function(t,e){var n=this,i=new Sa(e,0),r=new Sa(e,Number.POSITIVE_INFINITY),o=[];return this.zl.Dt([i,r],function(t){var e=n.Jl(t.On);o.push(e)}),ka.resolve(o)},Mh.prototype.nr=function(t,e){var i=this,r=new yr(wa);return e.forEach(function(t){var e=new Sa(t,0),n=new Sa(t,Number.POSITIVE_INFINITY);i.zl.Dt([e,n],function(t){r=r.add(t.On)})}),ka.resolve(this.Xl(r))},Mh.prototype.cr=function(t,e){var n=e.path,i=n.length+1,r=n;sr.st(r)||(r=r.child(""));var o=new Sa(new sr(r),0),s=new yr(wa);return this.zl.Ft(function(t){var e=t.key.path;return!!n.B(e)&&(e.length===i&&(s=s.add(t.On)),!0)},o),ka.resolve(this.Xl(s))},Mh.prototype.Xl=function(t){var n=this,i=[];return t.forEach(function(t){var e=n.Jl(t);null!==e&&i.push(e)}),i},Mh.prototype.qh=function(n,i){var r=this;va(0===this.Hl(i.batchId,"removed"),"Can only remove the first entry of the mutation queue"),this.Hn.shift();var o=this.zl;return ka.forEach(i.mutations,function(t){var e=new Sa(t.key,i.batchId);return o=o.delete(e),r.dh.Zl(n,t.key)}).next(function(){r.zl=o})},Mh.prototype.mo=function(t){},Mh.prototype.$n=function(t,e){var n=new Sa(e,0),i=this.zl.Nt(n);return ka.resolve(e.isEqual(i&&i.key))},Mh.prototype.Oh=function(t){return this.Hn.length,ka.resolve()},Mh.prototype.Hl=function(t,e){return this.Yl(t)},Mh.prototype.Yl=function(t){return 0===this.Hn.length?0:t-this.Hn[0].batchId},Mh.prototype.Jl=function(t){var e=this.Yl(t);return e<0||e>=this.Hn.length?null:this.Hn[e]},Mh),Uh=(Ph.prototype.Xh=function(t,e,n){var i=e.key,r=this.docs.get(i),o=r?r.size:0,s=this.t_(e);return this.docs=this.docs.nt(i,{e_:e,size:s,readTime:n}),this.size+=s-o,this.Jn.jl(t,i.path.O())},Ph.prototype.Yh=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},Ph.prototype.tr=function(t,e){var n=this.docs.get(e);return ka.resolve(n?n.e_:null)},Ph.prototype.getEntries=function(t,e){var n=this,i=_s();return e.forEach(function(t){var e=n.docs.get(t);i=i.nt(t,e?e.e_:null)}),ka.resolve(i)},Ph.prototype.rr=function(t,e,n){for(var i=ks(),r=new sr(e.path.child("")),o=this.docs._t(r);o.Rt();){var s=o.Et(),a=s.key,u=s.value,h=u.e_,c=u.readTime;if(!e.path.B(a.path))break;c.C(n)<=0||h instanceof Do&&e.matches(h)&&(i=i.nt(h.key,h))}return ka.resolve(i)},Ph.prototype.s_=function(t,e){return ka.forEach(this.docs,function(t){return e(t)})},Ph.prototype.Po=function(t,e){throw new Error("getNewDocumentChanges() is not supported with MemoryPersistence")},Ph.prototype.po=function(t){return ka.resolve(Bi.MIN)},Ph.prototype.kh=function(t){return new Ph.i_(this)},Ph.prototype.n_=function(t){return ka.resolve(this.size)},Ph);function Ph(t,e){this.Jn=t,this.t_=e,this.docs=new ur(sr.k),this.size=0}function Mh(t,e){this.Jn=t,this.dh=e,this.Hn=[],this.Gl=1,this.lastStreamToken=Ar.Ut,this.zl=new yr(Sa.me)}function qh(){this.index={}}function Fh(){this.Wl=new Ch}function Gh(){}function xh(t,e,n){this.query=t,this.kl=e,this.Ll=!1,this.$l=null,this.onlineState="Unknown",this.options=n||{}}function jh(t){this.Mu=t,this.vl=new Ia(function(t){return t.canonicalId()}),this.onlineState="Unknown",this.Sl=new Set,this.Mu.subscribe(this)}function Bh(t,e,n,i,r){this._u=t,this.Lc=e,this.Qc=n,this.currentUser=i,this.Wc=r,this.jc=null,this.Gc=new Ia(function(t){return t.canonicalId()}),this.zc=new Map,this.Kc=[],this.Hc=new ur(sr.k),this.Jc=new Map,this.Yc=new _a,this.Xc={},this.Zc=new Map,this.tl=Th.mc(),this.isPrimary=void 0,this.onlineState="Unknown"}function Hh(t,e,n,i){this.Ar=t,this.Lc=e,this.updateFunction=n,this.gr=i,this.$c=5,this.Ea=new yh(this.Ar,"retry_transaction")}function Qh(t,e){this.query=t,this.Ec=e,this.Rc=null,this.As=!1,this.Ic=Os(),this.ls=Os(),this.Ac=new qs(t.qe.bind(t))}function zh(t){this.wc=t}function Yh(){this.ic=new Ih,this.nc={},this.Mu=null,this.iu=null,this.Tr=null}function Wh(){this.activeTargetIds=Vs()}function Xh(t,e,n,i,r){var o=this;this._u=t,this.Ha=e,this.du=[],this.fu=new Map,this.wu=null,this.networkEnabled=!1,this.isPrimary=!1,this.Tu=r,this.Tu.mu(function(t){n.Cr(function(){return c(o,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.Eu()?(fa("RemoteStore","Restarting streams for network reachability change."),[4,this.Ru()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.Iu=new Eh(n,i),this.Au=this.Ha.ja({Na:this.Pu.bind(this),va:this.Vu.bind(this),La:this.pu.bind(this)}),this.gu=this.Ha.Wa({Na:this.yu.bind(this),va:this.bu.bind(this),xa:this.vu.bind(this),Ba:this.Ba.bind(this)})}function Jh(t,e){this.Ar=t,this.iu=e,this.state="Unknown",this.nu=0,this.ru=null,this.hu=!0}function Kh(t){this.Ha=t,this.Ja=Ls(),this.mutations=[],this.Ya=!1,this.Xa=null,this.Za=new Set}function Zh(t,e,n,i){this.ia=t,this.fa=e,this.credentials=n,this.serializer=i}function $h(t,e,n,i,r){var o=this;return(o=fh.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,r)||this).serializer=i,o.Ma=!1,o.lastStreamToken=Ar.Ut,o}function tc(t,e,n,i,r){var o=this;return(o=ph.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,r)||this).serializer=i,o}function ec(t,e,n,i,r,o){this.ia=t,this.da=n,this.fa=i,this.wa=r,this.listener=o,this.state=0,this.Ta=0,this.ma=null,this.stream=null,this.Ea=new yh(t,e)}function nc(t,e,n,i,r){void 0===n&&(n=1e3),void 0===i&&(i=1.5),void 0===r&&(r=6e4),this.ia=t,this.Pr=e,this.na=n,this.ra=i,this.ha=r,this.oa=0,this.aa=null,this.ua=Date.now(),this.reset()}function ic(t){var e=this;return(e=dh.call(this)||this).c_=t,e}function rc(){this.Ch=new Ia(function(t){return t.toString()}),this.r_=!1}Uh.i_=(Object.defineProperty(rc.prototype,"readTime",{get:function(){return this.h_},set:function(t){this.h_=t},enumerable:!0,configurable:!0}),rc.prototype.Xh=function(t,e){this.o_(),this.readTime=e,this.Ch.set(t.key,t)},rc.prototype.Yh=function(t,e){this.o_(),e&&(this.readTime=e),this.Ch.set(t,null)},rc.prototype.tr=function(t,e){this.o_();var n=this.Ch.get(e);return void 0!==n?ka.resolve(n):this.a_(t,e)},rc.prototype.getEntries=function(t,e){return this.u_(t,e)},rc.prototype.apply=function(t){return this.o_(),this.r_=!0,this.bc(t)},rc.prototype.o_=function(){},n(ic,dh=rc),ic.prototype.bc=function(n){var i=this,r=[];return this.Ch.forEach(function(t,e){e?r.push(i.c_.Xh(n,e,i.readTime)):i.c_.Yh(t)}),ka.Gn(r)},ic.prototype.a_=function(t,e){return this.c_.tr(t,e)},ic.prototype.u_=function(t,e){return this.c_.getEntries(t,e)},ic);var oc,sc=(Ec.prototype.Xs=function(t,n){return this.l_.forEach(function(t,e){return n(e)}),ka.resolve()},Ec.prototype.Wh=function(t){return ka.resolve(this.lastRemoteSnapshotVersion)},Ec.prototype.w_=function(t){return ka.resolve(this.__)},Ec.prototype.ao=function(t){return this.highestTargetId=this.f_.next(),ka.resolve(this.highestTargetId)},Ec.prototype.to=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.__&&(this.__=e),ka.resolve()},Ec.prototype.T_=function(t){this.l_.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.f_=new Th(e),this.highestTargetId=e),t.sequenceNumber>this.__&&(this.__=t.sequenceNumber)},Ec.prototype.uo=function(t,e){return this.T_(e),this.targetCount+=1,ka.resolve()},Ec.prototype.Jh=function(t,e){return this.T_(e),ka.resolve()},Ec.prototype.m_=function(t,e){return this.l_.delete(e.target),this.d_.Nn(e.targetId),--this.targetCount,ka.resolve()},Ec.prototype.E_=function(n,i,r){var o=this,s=0,a=[];return this.l_.forEach(function(t,e){e.sequenceNumber<=i&&null===r.get(e.targetId)&&(o.l_.delete(t),a.push(o.R_(n,e.targetId)),s++)}),ka.Gn(a).next(function(){return s})},Ec.prototype.I_=function(t){return ka.resolve(this.targetCount)},Ec.prototype.oo=function(t,e){var n=this.l_.get(e)||null;return ka.resolve(n)},Ec.prototype.ui=function(t,e){return ya("Not yet implemented.")},Ec.prototype.zh=function(e,t,n){this.d_.Sn(t,n);var i=this.persistence.dh,r=[];return i&&t.forEach(function(t){r.push(i.vn(e,t))}),ka.Gn(r)},Ec.prototype.Gh=function(e,t,n){this.d_.Fn(t,n);var i=this.persistence.dh,r=[];return i&&t.forEach(function(t){r.push(i.Cn(e,t))}),ka.Gn(r)},Ec.prototype.R_=function(t,e){return this.d_.Nn(e),ka.resolve()},Ec.prototype._o=function(t,e){var n=this.d_.Ln(e);return ka.resolve(n)},Ec.prototype.$n=function(t,e){return ka.resolve(this.d_.$n(e))},Ec),ac=(bc.prototype.ku=function(){return this.V_=!1,Promise.resolve()},Object.defineProperty(bc.prototype,"g_",{get:function(){return this.V_},enumerable:!0,configurable:!0}),bc.prototype.wo=function(){return c(this,void 0,void 0,function(){return y(this,function(t){return[2,[this.clientId]]})})},bc.prototype.y_=function(t){return t(!0)},bc.prototype.b_=function(){},bc.prototype.Eo=function(t){},bc.prototype.Ih=function(){return this.Jn},bc.prototype.fh=function(t){var e=this.A_[t.s()];return e||(e=new Vh(this.Jn,this.dh),this.A_[t.s()]=e),e},bc.prototype.Eh=function(){return this.mh},bc.prototype.Th=function(){return this.Kn},bc.prototype.runTransaction=function(t,e,n){var i=this;fa("MemoryPersistence","Starting transaction:",t);var r=new uc(this.P_.next());return this.dh.v_(),n(r).next(function(t){return i.dh.S_(r).next(function(){return t})}).Wn().then(function(t){return r.C_(),t})},bc.prototype.D_=function(e,n){return ka.zn(Object.values(this.A_).map(function(t){return function(){return t.$n(e,n)}}))},bc),uc=(wc.prototype.N_=function(t){this.F_.push(t)},wc.prototype.C_=function(){this.F_.forEach(function(t){return t()})},n(mc,oc=wc),mc),hc=(gc.O_=function(t){return new gc(t)},Object.defineProperty(gc.prototype,"M_",{get:function(){if(this.L_)return this.L_;throw ya("orphanedDocuments is only valid during a transaction.")},enumerable:!0,configurable:!0}),gc.prototype._h=function(t){this.k_=t},gc.prototype.vn=function(t,e){return this.M_.delete(e),ka.resolve()},gc.prototype.Cn=function(t,e){return this.M_.add(e),ka.resolve()},gc.prototype.Zl=function(t,e){return this.M_.add(e),ka.resolve()},gc.prototype.removeTarget=function(t,e){var n=this,i=this.persistence.Eh();return i._o(t,e.targetId).next(function(t){t.forEach(function(t){return n.M_.add(t)})}).next(function(){return i.m_(t,e)})},gc.prototype.v_=function(){this.L_=new Set},gc.prototype.S_=function(t){var n=this,i=this.persistence.Th().kh();return ka.forEach(this.M_,function(e){return n.U_(t,e).next(function(t){t||i.Yh(e)})}).next(function(){return n.L_=null,i.apply(t)})},gc.prototype.Zh=function(t,e){var n=this;return this.U_(t,e).next(function(t){t?n.M_.delete(e):n.M_.add(e)})},gc.prototype.p_=function(t){return 0},gc.prototype.U_=function(t,e){var n=this;return ka.zn([function(){return n.persistence.Eh().$n(t,e)},function(){return n.persistence.D_(t,e)},function(){return ka.resolve(n.k_.$n(e))}])},gc),cc="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",lc=(vc.prototype.initialize=function(n,t,i,r,o,s,a,u){return c(this,void 0,void 0,function(){var e=this;return y(this,function(t){switch(t.label){case 0:if(u.B_)throw new Mi(Pi.FAILED_PRECONDITION,cc);return this.persistence=new ac(o,this.q_),this.x_=null,this.Qc=new Nh,this._u=new Xa(this.persistence,new Dh,s),this.Lc=new Ah(this._u,r,n,function(t){return e.Mu.Dc(t,0)},i.Q_()),this.Mu=new kh(this._u,this.Lc,this.Qc,s,a),this.W_=new Rh(this.Mu),this.Lc.Mu=this.Mu,[4,this.Lc.start()];case 1:return t.sent(),[4,this.Lc.Zu(!0)];case 2:return t.sent(),[4,this.Mu.Zu(!0)];case 3:return t.sent(),[2]}})})},vc.prototype.clearPersistence=function(){throw new Mi(Pi.FAILED_PRECONDITION,cc)},vc),fc=(yc.prototype.start=function(e,n){var i=this;this.G_();var r=new ja,o=new ja,s=!1;return this.credentials._(function(t){if(!s)return s=!0,fa("FirestoreClient","Initializing. user=",t.uid),i.z_(e,n,t,o).then(r.resolve,r.reject);i.Ar.Cr(function(){return i.Xu(t)})}),this.Ar.Cr(function(){return r.promise}),o.promise},yc.prototype.enableNetwork=function(){var t=this;return this.G_(),this.Ar.enqueue(function(){return t.Mu.enableNetwork()})},yc.prototype.z_=function(s,a,u,h){return c(this,void 0,void 0,function(){var e,n,i,r,o=this;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),[4,this.platform.K_(this.j_)];case 1:return e=t.sent(),n=this.platform.H_(this.j_.ci),i=new wh(this.Ar,e,this.credentials,n),[4,s.initialize(this.Ar,this.j_,this.platform,i,this.clientId,u,100,a)];case 2:return t.sent(),this.persistence=s.persistence,this.Qc=s.Qc,this._u=s._u,this.Lc=s.Lc,this.Mu=s.Mu,this.x_=s.x_,this.J_=s.W_,this.persistence.b_(function(){return c(o,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return[4,this.terminate()];case 1:return t.sent(),[2]}})})}),h.resolve(),[3,4];case 3:if(r=t.sent(),h.reject(r),!this.Y_(r))throw r;return[2,(console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+r),this.z_(new lc,{B_:!1},u,h))];case 4:return[2]}})})},yc.prototype.Y_=function(t){return"FirebaseError"===t.name?t.code===Pi.FAILED_PRECONDITION||t.code===Pi.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code},yc.prototype.G_=function(){if(this.Ar.Or)throw new Mi(Pi.FAILED_PRECONDITION,"The client has already been terminated.")},yc.prototype.Xu=function(t){return this.Ar.jr(),fa("FirestoreClient","Credential Changed. Current user: "+t.uid),this.Mu.Xu(t)},yc.prototype.disableNetwork=function(){var t=this;return this.G_(),this.Ar.enqueue(function(){return t.Mu.disableNetwork()})},yc.prototype.terminate=function(){var t=this;return this.Ar.xr(function(){return c(t,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.x_&&this.x_.stop(),[4,this.Lc.ku()];case 1:return t.sent(),[4,this.Qc.ku()];case 2:return t.sent(),[4,this.persistence.ku()];case 3:return t.sent(),this.credentials.T(),[2]}})})})},yc.prototype.waitForPendingWrites=function(){var t=this;this.G_();var e=new ja;return this.Ar.Cr(function(){return t.Mu.fl(e)}),e.promise},yc.prototype.listen=function(t,e,n){var i=this;this.G_();var r=new Lh(t,e,n);return this.Ar.Cr(function(){return i.J_.listen(r)}),r},yc.prototype.$u=function(t){var e=this;this.X_||this.Ar.Cr(function(){return e.J_.$u(t)})},yc.prototype.Z_=function(t){var e=this;return this.G_(),this.Ar.enqueue(function(){return e._u.ro(t)}).then(function(t){if(t instanceof Do)return t;if(t instanceof Oo)return null;throw new Mi(Pi.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")})},yc.prototype.td=function(r){var t=this;return this.G_(),this.Ar.enqueue(function(){return c(t,void 0,void 0,function(){var e,n,i;return y(this,function(t){switch(t.label){case 0:return[4,this._u.lo(r,!0)];case 1:return e=t.sent(),n=new _h(r,e.do),i=n.Vc(e.documents),[2,n.bc(i,!1).snapshot]}})})})},yc.prototype.write=function(t){var e=this;this.G_();var n=new ja;return this.Ar.Cr(function(){return e.Mu.write(t,n)}),n.promise},yc.prototype.ci=function(){return this.j_.ci},yc.prototype.Fl=function(t){var e=this;this.G_(),this.Ar.Cr(function(){return e.J_.Fl(t),Promise.resolve()})},yc.prototype.Nl=function(t){this.X_||this.J_.Nl(t)},Object.defineProperty(yc.prototype,"X_",{get:function(){return this.Ar.Or},enumerable:!0,configurable:!0}),yc.prototype.transaction=function(t){var e=this;this.G_();var n=new ja;return this.Ar.Cr(function(){return e.Mu.runTransaction(e.Ar,t,n),Promise.resolve()}),n.promise},yc),pc=(dc.prototype.next=function(t){this.ed(this.observer.next,t)},dc.prototype.error=function(t){this.ed(this.observer.error,t)},dc.prototype.sd=function(){this.muted=!0},dc.prototype.ed=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},dc);function dc(t){this.observer=t,this.muted=!1}function yc(t,e,n,i){this.platform=t,this.j_=e,this.credentials=n,this.Ar=i,this.clientId=ga.Tn()}function vc(t){void 0===t&&(t=hc.O_),this.q_=t}function gc(t){this.persistence=t,this.k_=null,this.L_=null}function mc(t){var e=this;return(e=oc.call(this)||this).Kh=t,e}function wc(){this.F_=[]}function bc(t,e){var n=this;this.clientId=t,this.A_={},this.P_=new Da(0),this.V_=!1,this.V_=!0,this.dh=e(this),this.mh=new sc(this),this.Jn=new Oh,this.Kn=new Uh(this.Jn,function(t){return n.dh.p_(t)})}function Ec(t){this.persistence=t,this.l_=new Ia(function(t){return t.canonicalId()}),this.lastRemoteSnapshotVersion=Bi.MIN,this.highestTargetId=0,this.__=0,this.d_=new _a,this.targetCount=0,this.f_=Th.Tc()}function Ac(r){return function(){if("object"==typeof r&&null!==r)for(var t=r,e=0,n=["next","error","complete"];e<n.length;e++){var i=n[e];if(i in t&&"function"==typeof t[i])return 1}}()}var Ic,Nc,Tc=(Xc.prototype.rd=function(t){switch(Rr(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Pr(t.integerValue||t.doubleValue);case 3:return this.hd(t.timestampValue);case 4:return this.od(t);case 5:return t.stringValue;case 6:return new wu(Mr(t.bytesValue));case 7:return this.ad(t.referenceValue);case 8:return new Gu(t.geoPointValue.latitude,t.geoPointValue.longitude);case 9:return this.ud(t.arrayValue);case 10:return this.ld(t.mapValue);default:throw ya("Invalid value type: "+JSON.stringify(t))}},Xc.prototype.ld=function(t){var n=this,i={};return br(t.fields||{},function(t,e){i[t]=n.rd(e)}),i},Xc.prototype.ud=function(t){var e=this;return(t.values||[]).map(function(t){return e.rd(t)})},Xc.prototype.od=function(t){switch(this.nd){case"previous":var e=function t(e){var n=e.mapValue.fields.__previous_value__;return _r(n)?t(n):n}(t);return null==e?null:this.rd(e);case"estimate":return this.hd(Sr(t));default:return null}},Xc.prototype.hd=function(t){var e=Ur(t),n=new ji(e.seconds,e.nanos);return this.timestampsInSnapshots?n:n.toDate()},Xc.prototype.ad=function(t){var e=$i.K(t);va(sa(e),"ReferenceValue is not valid "+t);var n=new Aa(e.get(1),e.get(3)),i=new sr(e.$(5));return n.isEqual(this.firestore._d)||pa("Document "+i+" contains a document reference within a different database ("+n.projectId+"/"+n.database+") which is not supported. It will be treated as a reference in the current database ("+this.firestore._d.projectId+"/"+this.firestore._d.database+") instead."),new Dc(i,this.firestore,this.converter)},Xc),_c=Qa.sh,Sc=(Wc.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.timestampsInSnapshots===t.timestampsInSnapshots&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.forceLongPolling===t.forceLongPolling},Wc),kc=(Yc.prototype.settings=function(t){$a("Firestore.settings",arguments,1),nu("Firestore.settings","object",1,t);var e=new Sc(t);if(this.Td&&!this.Ad.isEqual(e))throw new Mi(Pi.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");void 0!==(this.Ad=e).credentials&&(this.Rd=function(t){if(!t)return new qi;switch(t.type){case"gapi":var e=t.pd;return va(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty),"unexpected gapi interface"),new xi(e,t.V||"0");case"provider":return t.pd;default:throw new Mi(Pi.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(e.credentials))},Yc.prototype.enableNetwork=function(){return this.wd(),this.Td.enableNetwork()},Yc.prototype.disableNetwork=function(){return this.wd(),this.Td.disableNetwork()},Yc.prototype.enablePersistence=function(t){var e,n;if(this.Td)throw new Mi(Pi.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var i=!1;return t&&(void 0!==t.experimentalTabSynchronization&&pa("The 'experimentalTabSynchronization' setting will be removed. Use 'synchronizeTabs' instead."),i=null!==(n=null!==(e=t.synchronizeTabs)&&void 0!==e?e:t.experimentalTabSynchronization)&&void 0!==n&&n),this.gd(this.Id,{B_:!0,cacheSizeBytes:this.Ad.cacheSizeBytes,synchronizeTabs:i})},Yc.prototype.clearPersistence=function(){return c(this,void 0,void 0,function(){var i,e=this;return y(this,function(t){if(void 0!==this.Td&&!this.Td.X_)throw new Mi(Pi.FAILED_PRECONDITION,"Persistence cannot be cleared after this Firestore instance is initialized.");return i=new ja,[2,(this.fd.Mr(function(){return c(e,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),e=this.yd(),[4,this.Id.clearPersistence(e)];case 1:return t.sent(),i.resolve(),[3,3];case 2:return n=t.sent(),i.reject(n),[3,3];case 3:return[2]}})})}),i.promise)]})})},Yc.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(Yc.prototype,"bd",{get:function(){return this.wd(),this.Td.X_},enumerable:!0,configurable:!0}),Yc.prototype.waitForPendingWrites=function(){return this.wd(),this.Td.waitForPendingWrites()},Yc.prototype.onSnapshotsInSync=function(t){if(this.wd(),Ac(t))return this.vd(t);nu("Firestore.onSnapshotsInSync","function",1,t);var e={next:t};return this.vd(e)},Yc.prototype.vd=function(t){var e=this,n=new pc({next:function(){t.next&&t.next()},error:function(t){throw ya("Uncaught Error in onSnapshotsInSync")}});return this.Td.Fl(n),function(){n.sd(),e.Td.Nl(n)}},Yc.prototype.wd=function(){return this.Td||this.gd(new lc,{B_:!1}),this.Td},Yc.prototype.yd=function(){return new Ea(this._d,this.Ed,this.Ad.host,this.Ad.ssl,this.Ad.forceLongPolling)},Yc.prototype.gd=function(t,e){var n=this.yd();return this.Td=new fc(aa.Ot(),n,this.Rd,this.fd),this.Td.start(t,e)},Yc.prototype.Vd=function(i){var t=new ra(i,{di:aa.Ot().di});return new $u(t,function(t){if(t instanceof Dc){var e=i,n=t.firestore._d;if(!n.isEqual(e))throw new Mi(Pi.INVALID_ARGUMENT,"Document reference is for database "+n.projectId+"/"+n.database+" but should be for database "+e.projectId+"/"+e.database);return new Zu(i,t.Sd)}return t})},Yc.md=function(t){if(e=t.options,!Object.prototype.hasOwnProperty.call(e,"projectId"))throw new Mi(Pi.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var e,n=t.options.projectId;if(!n||"string"!=typeof n)throw new Mi(Pi.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new Aa(n)},Object.defineProperty(Yc.prototype,"app",{get:function(){if(!this.dd)throw new Mi(Pi.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.dd},enumerable:!0,configurable:!0}),Yc.prototype.collection=function(t){return $a("Firestore.collection",arguments,1),nu("Firestore.collection","non-empty string",1,t),this.wd(),new Mc($i.K(t),this)},Yc.prototype.doc=function(t){return $a("Firestore.doc",arguments,1),nu("Firestore.doc","non-empty string",1,t),this.wd(),Dc.Cd($i.K(t),this)},Yc.prototype.collectionGroup=function(t){if($a("Firestore.collectionGroup",arguments,1),nu("Firestore.collectionGroup","non-empty string",1,t),0<=t.indexOf("/"))throw new Mi(Pi.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.wd(),new Uc(new Uo($i.H,t),this)},Yc.prototype.runTransaction=function(e){var n=this;return $a("Firestore.runTransaction",arguments,1),nu("Firestore.runTransaction","function",1,e),this.wd().transaction(function(t){return e(new Rc(n,t))})},Yc.prototype.batch=function(){return this.wd(),new Lc(this)},Object.defineProperty(Yc,"logLevel",{get:function(){switch(ca()){case a.DEBUG:return"debug";case a.SILENT:return"silent";default:return"error"}},enumerable:!0,configurable:!0}),Yc.setLogLevel=function(t){switch($a("Firestore.setLogLevel",arguments,1),nu("Firestore.setLogLevel","non-empty string",1,t),t){case"debug":la(a.DEBUG);break;case"error":la(a.ERROR);break;case"silent":la(a.SILENT);break;default:throw new Mi(Pi.INVALID_ARGUMENT,"Invalid log level: "+t)}},Yc.prototype.Dd=function(){return this.Ad.timestampsInSnapshots},Yc),Rc=(zc.prototype.get=function(t){var n=this;$a("Transaction.get",arguments,1);var i=$c("Transaction.get",t,this.Fd);return this.Nd.za([i.Sd]).then(function(t){if(!t||1!==t.length)return ya("Mismatch in docs returned from document lookup.");var e=t[0];if(e instanceof Oo)return new Cc(n.Fd,i.Sd,null,!1,!1,i.kd);if(e instanceof Do)return new Cc(n.Fd,i.Sd,e,!1,!1,i.kd);throw ya("BatchGetDocumentsRequest returned unexpected document type: "+e.constructor.name)})},zc.prototype.set=function(t,e,n){eu("Transaction.set",arguments,2,3);var i=$c("Transaction.set",t,this.Fd);n=Jc("Transaction.set",n);var r=tl(i.kd,e,"Transaction.set"),o=r[0],s=r[1],a=n.merge||n.mergeFields?this.Fd.Pd.zo(s,o,n.mergeFields):this.Fd.Pd.jo(s,o);return this.Nd.set(i.Sd,a),this},zc.prototype.update=function(t,e,n){for(var i,r,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return r="string"==typeof e||e instanceof Eu?(tu("Transaction.update",arguments,3),i=$c("Transaction.update",t,this.Fd),this.Fd.Pd.Yo("Transaction.update",e,n,o)):($a("Transaction.update",arguments,2),i=$c("Transaction.update",t,this.Fd),this.Fd.Pd.Ko("Transaction.update",e)),this.Nd.update(i.Sd,r),this},zc.prototype.delete=function(t){$a("Transaction.delete",arguments,1);var e=$c("Transaction.delete",t,this.Fd);return this.Nd.delete(e.Sd),this},zc),Lc=(Qc.prototype.set=function(t,e,n){eu("WriteBatch.set",arguments,2,3),this.Od();var i=$c("WriteBatch.set",t,this.Fd);n=Jc("WriteBatch.set",n);var r=tl(i.kd,e,"WriteBatch.set"),o=r[0],s=r[1],a=n.merge||n.mergeFields?this.Fd.Pd.zo(s,o,n.mergeFields):this.Fd.Pd.jo(s,o);return this.Ld=this.Ld.concat(a.Lo(i.Sd,no.NONE)),this},Qc.prototype.update=function(t,e,n){for(var i,r,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return this.Od(),r="string"==typeof e||e instanceof Eu?(tu("WriteBatch.update",arguments,3),i=$c("WriteBatch.update",t,this.Fd),this.Fd.Pd.Yo("WriteBatch.update",e,n,o)):($a("WriteBatch.update",arguments,2),i=$c("WriteBatch.update",t,this.Fd),this.Fd.Pd.Ko("WriteBatch.update",e)),this.Ld=this.Ld.concat(r.Lo(i.Sd,no.exists(!0))),this},Qc.prototype.delete=function(t){$a("WriteBatch.delete",arguments,1),this.Od();var e=$c("WriteBatch.delete",t,this.Fd);return this.Ld=this.Ld.concat(new vo(e.Sd,no.NONE)),this},Qc.prototype.commit=function(){return this.Od(),this.$d=!0,0<this.Ld.length?this.Fd.wd().write(this.Ld):Promise.resolve()},Qc.prototype.Od=function(){if(this.$d)throw new Mi(Pi.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},Qc),Dc=(Hc.Cd=function(t,e,n){if(t.length%2!=0)throw new Mi(Pi.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.G()+" has "+t.length);return new Hc(new sr(t),e,n)},Object.defineProperty(Hc.prototype,"id",{get:function(){return this.Sd.path.U()},enumerable:!0,configurable:!0}),Object.defineProperty(Hc.prototype,"parent",{get:function(){return new Mc(this.Sd.path.O(),this.firestore,this.kd)},enumerable:!0,configurable:!0}),Object.defineProperty(Hc.prototype,"path",{get:function(){return this.Sd.path.G()},enumerable:!0,configurable:!0}),Hc.prototype.collection=function(t){if($a("DocumentReference.collection",arguments,1),nu("DocumentReference.collection","non-empty string",1,t),!t)throw new Mi(Pi.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");var e=$i.K(t);return new Mc(this.Sd.path.child(e),this.firestore)},Hc.prototype.isEqual=function(t){if(!(t instanceof Hc))throw fu("isEqual","DocumentReference",1,t);return this.firestore===t.firestore&&this.Sd.isEqual(t.Sd)&&this.kd===t.kd},Hc.prototype.set=function(t,e){eu("DocumentReference.set",arguments,1,2),e=Jc("DocumentReference.set",e);var n=tl(this.kd,t,"DocumentReference.set"),i=n[0],r=n[1],o=e.merge||e.mergeFields?this.firestore.Pd.zo(r,i,e.mergeFields):this.firestore.Pd.jo(r,i);return this.Td.write(o.Lo(this.Sd,no.NONE))},Hc.prototype.update=function(t,e){for(var n,i=[],r=2;r<arguments.length;r++)i[r-2]=arguments[r];return n="string"==typeof t||t instanceof Eu?(tu("DocumentReference.update",arguments,2),this.firestore.Pd.Yo("DocumentReference.update",t,e,i)):($a("DocumentReference.update",arguments,1),this.firestore.Pd.Ko("DocumentReference.update",t)),this.Td.write(n.Lo(this.Sd,no.exists(!0)))},Hc.prototype.delete=function(){return $a("DocumentReference.delete",arguments,0),this.Td.write([new vo(this.Sd,no.NONE)])},Hc.prototype.onSnapshot=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];eu("DocumentReference.onSnapshot",arguments,1,4);var n,i={includeMetadataChanges:!1},r=0;"object"!=typeof t[r]||Ac(t[r])||(lu("DocumentReference.onSnapshot",i=t[r],["includeMetadataChanges"]),ou("DocumentReference.onSnapshot","boolean","includeMetadataChanges",i.includeMetadataChanges),r++);var o={includeMetadataChanges:i.includeMetadataChanges};return n=Ac(t[r])?t[r]:(nu("DocumentReference.onSnapshot","function",r,t[r]),iu("DocumentReference.onSnapshot","function",r+1,t[r+1]),iu("DocumentReference.onSnapshot","function",r+2,t[r+2]),{next:t[r],error:t[r+1],complete:t[r+2]}),this.Md(o,n)},Hc.prototype.Md=function(t,n){var i=this,e=function(t){console.error("Uncaught Error in onSnapshot:",t)};n.error&&(e=n.error.bind(n));var r=new pc({next:function(t){if(n.next){var e=t.docs.get(i.Sd);n.next(new Cc(i.firestore,i.Sd,e,t.fromCache,t.hasPendingWrites,i.kd))}},error:e}),o=this.Td.listen(Uo.ve(this.Sd.path),r,t);return function(){r.sd(),i.Td.$u(o)}},Hc.prototype.get=function(n){var i=this;return eu("DocumentReference.get",arguments,0,1),Zc("DocumentReference.get",n),new Promise(function(e,t){n&&"cache"===n.source?i.firestore.wd().Z_(i.Sd).then(function(t){e(new Cc(i.firestore,i.Sd,t,!0,t instanceof Do&&t.te,i.kd))},t):i.Ud(e,t,n)})},Hc.prototype.Ud=function(e,n,i){var r=this.Md({includeMetadataChanges:!0,ql:!0},{next:function(t){r(),!t.exists&&t.metadata.fromCache?n(new Mi(Pi.UNAVAILABLE,"Failed to get document because the client is offline.")):t.exists&&t.metadata.fromCache&&i&&"server"===i.source?n(new Mi(Pi.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):e(t)},error:n})},Hc.prototype.withConverter=function(t){return new Hc(this.Sd,this.firestore,t)},Hc),Oc=(Bc.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},Bc),Cc=(jc.prototype.data=function(t){if(eu("DocumentSnapshot.data",arguments,0,1),t=Kc("DocumentSnapshot.data",t),this.qd){if(this.kd){var e=new Vc(this.Fd,this.Sd,this.qd,this.Bd,this.xd);return this.kd.fromFirestore(e,t)}return new Tc(this.Fd,this.Fd.Dd(),t.serverTimestamps,void 0).rd(this.qd.Re())}},jc.prototype.get=function(t,e){if(eu("DocumentSnapshot.get",arguments,1,2),e=Kc("DocumentSnapshot.get",e),this.qd){var n=this.qd.data().field(rh("DocumentSnapshot.get",t));if(null!==n)return new Tc(this.Fd,this.Fd.Dd(),e.serverTimestamps,this.kd).rd(n)}},Object.defineProperty(jc.prototype,"id",{get:function(){return this.Sd.path.U()},enumerable:!0,configurable:!0}),Object.defineProperty(jc.prototype,"ref",{get:function(){return new Dc(this.Sd,this.Fd,this.kd)},enumerable:!0,configurable:!0}),Object.defineProperty(jc.prototype,"exists",{get:function(){return null!==this.qd},enumerable:!0,configurable:!0}),Object.defineProperty(jc.prototype,"metadata",{get:function(){return new Oc(this.xd,this.Bd)},enumerable:!0,configurable:!0}),jc.prototype.isEqual=function(t){if(!(t instanceof jc))throw fu("isEqual","DocumentSnapshot",1,t);return this.Fd===t.Fd&&this.Bd===t.Bd&&this.Sd.isEqual(t.Sd)&&(null===this.qd?null===t.qd:this.qd.isEqual(t.qd))&&this.kd===t.kd},jc),Vc=(n(xc,Nc=Cc),xc.prototype.data=function(t){return Nc.prototype.data.call(this,t)},xc),Uc=(Gc.prototype.where=function(t,e,n){var i;$a("Query.where",arguments,3),cu("Query.where",3,n),function(t,e){if(!t.some(function(t){return t===e}))throw new Mi(Pi.INVALID_ARGUMENT,"Invalid value "+hu(e)+" provided to function Query.where() for its "+du(2)+" argument. Acceptable values: "+t.join(", "))}(["<","<=","==",">=",">","array-contains","in","array-contains-any"],e);var r=rh("Query.where",t),o=Po.K(e);if(r.Y()){if(o===Po.ARRAY_CONTAINS||o===Po.ARRAY_CONTAINS_ANY)throw new Mi(Pi.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o.toString()+"' queries on FieldPath.documentId().");if(o===Po.IN){this.Wd(n,o);for(var s=[],a=0,u=n;a<u.length;a++){var h=u[a];s.push(this.jd(h))}i={arrayValue:{values:s}}}else i=this.jd(n)}else o!==Po.IN&&o!==Po.ARRAY_CONTAINS_ANY||this.Wd(n,o),i=this.firestore.Pd.Xo("Query.where",n,o===Po.IN);var c=Ko.create(r,o,i);return this.Gd(c),new Gc(this.Qd.De(c),this.firestore,this.kd)},Gc.prototype.orderBy=function(t,e){var n;if(eu("Query.orderBy",arguments,1,2),iu("Query.orderBy","non-empty string",2,e),void 0===e||"asc"===e)n=is.ASCENDING;else{if("desc"!==e)throw new Mi(Pi.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+e+"', expected 'asc' or 'desc'.");n=is.DESCENDING}if(null!==this.Qd.startAt)throw new Mi(Pi.INVALID_ARGUMENT,"Invalid query. You must not call Query.startAt() or Query.startAfter() before calling Query.orderBy().");if(null!==this.Qd.endAt)throw new Mi(Pi.INVALID_ARGUMENT,"Invalid query. You must not call Query.endAt() or Query.endBefore() before calling Query.orderBy().");var i=rh("Query.orderBy",t),r=new ys(i,n);return this.zd(r),new Gc(this.Qd.Fe(r),this.firestore,this.kd)},Gc.prototype.limit=function(t){return $a("Query.limit",arguments,1),nu("Query.limit","number",1,t),pu("Query.limit",1,t),new Gc(this.Qd.Ne(t),this.firestore,this.kd)},Gc.prototype.limitToLast=function(t){return $a("Query.limitToLast",arguments,1),nu("Query.limitToLast","number",1,t),pu("Query.limitToLast",1,t),new Gc(this.Qd.ke(t),this.firestore,this.kd)},Gc.prototype.startAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];tu("Query.startAt",arguments,1);var i=this.Kd("Query.startAt",t,e,!0);return new Gc(this.Qd.Le(i),this.firestore,this.kd)},Gc.prototype.startAfter=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];tu("Query.startAfter",arguments,1);var i=this.Kd("Query.startAfter",t,e,!1);return new Gc(this.Qd.Le(i),this.firestore,this.kd)},Gc.prototype.endBefore=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];tu("Query.endBefore",arguments,1);var i=this.Kd("Query.endBefore",t,e,!0);return new Gc(this.Qd.$e(i),this.firestore,this.kd)},Gc.prototype.endAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];tu("Query.endAt",arguments,1);var i=this.Kd("Query.endAt",t,e,!1);return new Gc(this.Qd.$e(i),this.firestore,this.kd)},Gc.prototype.isEqual=function(t){if(!(t instanceof Gc))throw fu("isEqual","Query",1,t);return this.firestore===t.firestore&&this.Qd.isEqual(t.Qd)},Gc.prototype.withConverter=function(t){return new Gc(this.Qd,this.firestore,t)},Gc.prototype.Kd=function(t,e,n,i){if(cu(t,1,e),e instanceof Cc){if(0<n.length)throw new Mi(Pi.INVALID_ARGUMENT,"Too many arguments provided to "+t+"().");var r=e;if(!r.exists)throw new Mi(Pi.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+t+"().");return this.Hd(r.qd,i)}var o=[e].concat(n);return this.Jd(t,o,i)},Gc.prototype.Hd=function(t,e){for(var n=[],i=0,r=this.Qd.orderBy;i<r.length;i++){var o=r[i];if(o.field.Y())n.push(qr(this.firestore._d,t.key));else{var s=t.field(o.field);if(_r(s))throw new Mi(Pi.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+o.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===s){var a=o.field.G();throw new Mi(Pi.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+a+"' (used as the orderBy) does not exist.")}n.push(s)}}return new ds(n,e)},Gc.prototype.Jd=function(t,e,n){var i=this.Qd.Ve;if(e.length>i.length)throw new Mi(Pi.INVALID_ARGUMENT,"Too many arguments provided to "+t+"(). The number of arguments must be less than or equal to the number of Query.orderBy() clauses");for(var r=[],o=0;o<e.length;o++){var s=e[o];if(i[o].field.Y()){if("string"!=typeof s)throw new Mi(Pi.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+t+"(), but got a "+typeof s);if(!this.Qd.He()&&-1!==s.indexOf("/"))throw new Mi(Pi.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+t+"() must be a plain document ID, but '"+s+"' contains a slash.");var a=this.Qd.path.child($i.K(s));if(!sr.st(a))throw new Mi(Pi.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+t+"() must result in a valid document path, but '"+a+"' is not because it contains an odd number of segments.");var u=new sr(a);r.push(qr(this.firestore._d,u))}else{var h=this.firestore.Pd.Xo(t,s);r.push(h)}}return new ds(r,n)},Gc.prototype.onSnapshot=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];eu("Query.onSnapshot",arguments,1,4);var n,i={},r=0;return"object"!=typeof t[r]||Ac(t[r])||(lu("Query.onSnapshot",i=t[r],["includeMetadataChanges"]),ou("Query.onSnapshot","boolean","includeMetadataChanges",i.includeMetadataChanges),r++),n=Ac(t[r])?t[r]:(nu("Query.onSnapshot","function",r,t[r]),iu("Query.onSnapshot","function",r+1,t[r+1]),iu("Query.onSnapshot","function",r+2,t[r+2]),{next:t[r],error:t[r+1],complete:t[r+2]}),this.Yd(this.Qd),this.Md(i,n)},Gc.prototype.Md=function(t,e){var n=this,i=function(t){console.error("Uncaught Error in onSnapshot:",t)};e.error&&(i=e.error.bind(e));var r=new pc({next:function(t){e.next&&e.next(new Pc(n.firestore,n.Qd,t,n.kd))},error:i}),o=this.firestore.wd(),s=o.listen(this.Qd,r,t);return function(){r.sd(),o.$u(s)}},Gc.prototype.Yd=function(t){if(t.Ge()&&0===t.Ve.length)throw new Mi(Pi.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")},Gc.prototype.get=function(n){var i=this;return eu("Query.get",arguments,0,1),Zc("Query.get",n),this.Yd(this.Qd),new Promise(function(e,t){n&&"cache"===n.source?i.firestore.wd().td(i.Qd).then(function(t){e(new Pc(i.firestore,i.Qd,t,i.kd))},t):i.Ud(e,t,n)})},Gc.prototype.Ud=function(e,n,i){var r=this.Md({includeMetadataChanges:!0,ql:!0},{next:function(t){r(),t.metadata.fromCache&&i&&"server"===i.source?n(new Mi(Pi.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):e(t)},error:n})},Gc.prototype.jd=function(t){if("string"==typeof t){if(""===t)throw new Mi(Pi.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!this.Qd.He()&&-1!==t.indexOf("/"))throw new Mi(Pi.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+t+"' contains a '/' character.");var e=this.Qd.path.child($i.K(t));if(!sr.st(e))throw new Mi(Pi.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return qr(this.firestore._d,new sr(e))}if(t instanceof Dc){var n=t;return qr(this.firestore._d,n.Sd)}throw new Mi(Pi.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+hu(t)+".")},Gc.prototype.Wd=function(t,e){if(!Array.isArray(t)||0===t.length)throw new Mi(Pi.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new Mi(Pi.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.");if(0<=t.indexOf(null))throw new Mi(Pi.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'null' in the value array.");if(0<t.filter(function(t){return Number.isNaN(t)}).length)throw new Mi(Pi.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'NaN' in the value array.")},Gc.prototype.Gd=function(t){if(t instanceof Ko){var e=[Po.ARRAY_CONTAINS,Po.ARRAY_CONTAINS_ANY],n=[Po.IN,Po.ARRAY_CONTAINS_ANY],i=0<=e.indexOf(t.op),r=0<=n.indexOf(t.op);if(t.ze()){var o=this.Qd.Se();if(null!==o&&!o.isEqual(t.field))throw new Mi(Pi.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+o.toString()+"' and '"+t.field.toString()+"'");var s=this.Qd.Ce();null!==s&&this.Xd(t.field,s)}else if(r||i){var a=null;if(r&&(a=this.Qd.Ke(n)),null===a&&i&&(a=this.Qd.Ke(e)),null!=a)throw a===t.op?new Mi(Pi.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+t.op.toString()+"' filter."):new Mi(Pi.INVALID_ARGUMENT,"Invalid query. You cannot use '"+t.op.toString()+"' filters with '"+a.toString()+"' filters.")}}},Gc.prototype.zd=function(t){if(null===this.Qd.Ce()){var e=this.Qd.Se();null!==e&&this.Xd(e,t.field)}},Gc.prototype.Xd=function(t,e){if(!e.isEqual(t))throw new Mi(Pi.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+t.toString()+"' and so you must also use '"+t.toString()+"' as your first Query.orderBy(), but your first Query.orderBy() is on field '"+e.toString()+"' instead.")},Gc),Pc=(Object.defineProperty(Fc.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!0,configurable:!0}),Object.defineProperty(Fc.prototype,"empty",{get:function(){return this.tf.docs.q()},enumerable:!0,configurable:!0}),Object.defineProperty(Fc.prototype,"size",{get:function(){return this.tf.docs.size},enumerable:!0,configurable:!0}),Fc.prototype.forEach=function(e,n){var i=this;eu("QuerySnapshot.forEach",arguments,1,2),nu("QuerySnapshot.forEach","function",1,e),this.tf.docs.forEach(function(t){e.call(n,i.if(t))})},Object.defineProperty(Fc.prototype,"query",{get:function(){return new Uc(this.Zd,this.Fd,this.kd)},enumerable:!0,configurable:!0}),Fc.prototype.docChanges=function(t){t&&(lu("QuerySnapshot.docChanges",t,["includeMetadataChanges"]),ou("QuerySnapshot.docChanges","boolean","includeMetadataChanges",t.includeMetadataChanges));var e=!(!t||!t.includeMetadataChanges);if(e&&this.tf.ds)throw new Mi(Pi.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.ef&&this.sf===e||(this.ef=function(r,e,o,s){if(o.cs.q()){var n=0;return o.docChanges.map(function(t){var e=new Vc(r,t.doc.key,t.doc,o.fromCache,o.ls.has(t.doc.key),s);return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var a=o.cs;return o.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=new Vc(r,t.doc.key,t.doc,o.fromCache,o.ls.has(t.doc.key),s),n=-1,i=-1;return 0!==t.type&&(n=a.indexOf(t.doc.key),a=a.delete(t.doc.key)),1!==t.type&&(i=(a=a.add(t.doc)).indexOf(t.doc.key)),{type:function(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ya("Unknown change type: "+t)}}(t.type),doc:e,oldIndex:n,newIndex:i}})}(this.Fd,e,this.tf,this.kd),this.sf=e),this.ef},Fc.prototype.isEqual=function(t){if(!(t instanceof Fc))throw fu("isEqual","QuerySnapshot",1,t);return this.Fd===t.Fd&&this.Zd.isEqual(t.Zd)&&this.tf.isEqual(t.tf)&&this.kd===t.kd},Fc.prototype.if=function(t){return new Vc(this.Fd,t.key,t,this.metadata.fromCache,this.tf.ls.has(t.key),this.kd)},Fc),Mc=(n(qc,Ic=Uc),Object.defineProperty(qc.prototype,"id",{get:function(){return this.Qd.path.U()},enumerable:!0,configurable:!0}),Object.defineProperty(qc.prototype,"parent",{get:function(){var t=this.Qd.path.O();return t.q()?null:new Dc(new sr(t),this.firestore)},enumerable:!0,configurable:!0}),Object.defineProperty(qc.prototype,"path",{get:function(){return this.Qd.path.G()},enumerable:!0,configurable:!0}),qc.prototype.doc=function(t){if(eu("CollectionReference.doc",arguments,0,1),0===arguments.length&&(t=ga.Tn()),nu("CollectionReference.doc","non-empty string",1,t),""===t)throw new Mi(Pi.INVALID_ARGUMENT,"Document path must be a non-empty string");var e=$i.K(t);return Dc.Cd(this.Qd.path.child(e),this.firestore,this.kd)},qc.prototype.add=function(t){$a("CollectionReference.add",arguments,1),nu("CollectionReference.add","object",1,this.kd?this.kd.toFirestore(t):t);var e=this.doc();return e.set(t).then(function(){return e})},qc.prototype.withConverter=function(t){return new qc(this.nf,this.firestore,t)},qc);function qc(t,e,n){var i=this;if(((i=Ic.call(this,Uo.ve(t),e,n)||this).nf=t).length%2!=1)throw new Mi(Pi.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t.G()+" has "+t.length);return i}function Fc(t,e,n,i){this.Fd=t,this.Zd=e,this.tf=n,this.kd=i,this.ef=null,this.sf=null,this.metadata=new Oc(n.hasPendingWrites,n.fromCache)}function Gc(t,e,n){this.Qd=t,this.firestore=e,this.kd=n}function xc(){return null!==Nc&&Nc.apply(this,arguments)||this}function jc(t,e,n,i,r,o){this.Fd=t,this.Sd=e,this.qd=n,this.Bd=i,this.xd=r,this.kd=o}function Bc(t,e){this.hasPendingWrites=t,this.fromCache=e}function Hc(t,e,n){this.Sd=t,this.firestore=e,this.kd=n,this.Td=this.firestore.wd()}function Qc(t){this.Fd=t,this.Ld=[],this.$d=!1}function zc(t,e){this.Fd=t,this.Nd=e}function Yc(t,e,n){var i=this;if(void 0===n&&(n=new lc),this.dd=null,this.fd=new Ha,this.INTERNAL={delete:function(){return c(i,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.wd(),[4,this.Td.terminate()];case 1:return t.sent(),[2]}})})}},"object"==typeof t.options){var r=t;this.dd=r,this._d=Yc.md(r),this.Ed=r.name,this.Rd=new Fi(e)}else{var o=t;if(!o.projectId)throw new Mi(Pi.INVALID_ARGUMENT,"Must provide projectId");this._d=new Aa(o.projectId,o.database),this.Ed="[DEFAULT]",this.Rd=new qi}this.Id=n,this.Ad=new Sc({}),this.Pd=this.Vd(this._d)}function Wc(t){var e,n;if(void 0===t.host){if(void 0!==t.ssl)throw new Mi(Pi.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else ru("settings","non-empty string","host",t.host),this.host=t.host,ou("settings","boolean","ssl",t.ssl),this.ssl=null===(e=t.ssl)||void 0===e||e;if(lu("settings",t,["host","ssl","credentials","timestampsInSnapshots","cacheSizeBytes","experimentalForceLongPolling"]),ou("settings","object","credentials",t.credentials),this.credentials=t.credentials,ou("settings","boolean","timestampsInSnapshots",t.timestampsInSnapshots),!0===t.timestampsInSnapshots?pa("The setting 'timestampsInSnapshots: true' is no longer required and should be removed."):!1===t.timestampsInSnapshots&&pa("Support for 'timestampsInSnapshots: false' will be removed soon. You must update your code to handle Timestamp objects."),this.timestampsInSnapshots=null===(n=t.timestampsInSnapshots)||void 0===n||n,ou("settings","number","cacheSizeBytes",t.cacheSizeBytes),void 0===t.cacheSizeBytes)this.cacheSizeBytes=Qa.nh;else{if(t.cacheSizeBytes!==_c&&t.cacheSizeBytes<Qa.ih)throw new Mi(Pi.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+Qa.ih);this.cacheSizeBytes=t.cacheSizeBytes}ou("settings","boolean","experimentalForceLongPolling",t.experimentalForceLongPolling),this.forceLongPolling=void 0!==t.experimentalForceLongPolling&&t.experimentalForceLongPolling}function Xc(t,e,n,i){this.firestore=t,this.timestampsInSnapshots=e,this.nd=n,this.converter=i}function Jc(t,e){if(void 0===e)return{merge:!1};if(lu(t,e,["merge","mergeFields"]),ou(t,"boolean","merge",e.merge),void 0!==(n=e.mergeFields)&&function(t,e,n){if(!(n instanceof Array))throw new Mi(Pi.INVALID_ARGUMENT,"Function "+t+"() requires its "+e+" option to be an array, but it was: "+hu(n));for(var i=0;i<n.length;++i)if(!("string"==typeof(r=n[i])||r instanceof Eu))throw new Mi(Pi.INVALID_ARGUMENT,"Function "+t+"() requires all "+e+" elements to be a string or a FieldPath, but the value at index "+i+" was: "+hu(n[i]));var r}(t,"mergeFields",n),void 0!==e.mergeFields&&void 0!==e.merge)throw new Mi(Pi.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');var n;return e}function Kc(t,e){return void 0===e?{}:(lu(t,e,["serverTimestamps"]),su(t,0,"serverTimestamps",e.serverTimestamps,["estimate","previous","none"]),e)}function Zc(t,e){iu(t,"object",1,e),e&&(lu(t,e,["source"]),su(t,0,"source",e.source,["default","server","cache"]))}function $c(t,e,n){if(e instanceof Dc){if(e.firestore!==n)throw new Mi(Pi.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}throw fu(t,"DocumentReference",1,e)}function tl(t,e,n){var i;return t?(i=t.toFirestore(e),n="toFirestore() in "+n):i=e,[i,n]}var el,nl=vu(kc,"Use firebase.firestore() instead."),il=vu(Rc,"Use firebase.firestore().runTransaction() instead."),rl=vu(Lc,"Use firebase.firestore().batch() instead."),ol=vu(Dc,"Use firebase.firestore().doc() instead."),sl=vu(Cc),al=vu(Vc),ul=vu(Uc),hl=vu(Pc),cl=vu(Mc,"Use firebase.firestore().collection() instead."),ll={Firestore:nl,GeoPoint:Gu,Timestamp:ji,Blob:bu,Transaction:il,WriteBatch:rl,DocumentReference:ol,DocumentSnapshot:sl,Query:ul,QueryDocumentSnapshot:al,QuerySnapshot:hl,CollectionReference:cl,FieldPath:Eu,FieldValue:Fu,setLogLevel:kc.setLogLevel,CACHE_SIZE_UNLIMITED:_c},fl=(El.prototype.mu=function(t){},El.prototype.ku=function(){},El),pl=(bl.prototype.mu=function(t){this.cf.push(t)},bl.prototype.ku=function(){window.removeEventListener("online",this.rf),window.removeEventListener("offline",this.af)},bl.prototype.lf=function(){window.addEventListener("online",this.rf),window.addEventListener("offline",this.af)},bl.prototype.hf=function(){fa("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.cf;t<e.length;t++)(0,e[t])(0)},bl.prototype.uf=function(){fa("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.cf;t<e.length;t++)(0,e[t])(1)},bl._f=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},bl),dl=(wl.prototype.Na=function(t){this.wf=t},wl.prototype.va=function(t){this.Tf=t},wl.prototype.onMessage=function(t){this.mf=t},wl.prototype.close=function(){this.ff()},wl.prototype.send=function(t){this.df(t)},wl.prototype.Ef=function(){this.wf()},wl.prototype.Rf=function(t){this.Tf(t)},wl.prototype.If=function(t){this.mf(t)},wl),yl={BatchGetDocuments:"batchGet",Commit:"commit"},vl="gl-js/ fire/"+Di,gl=(ml.prototype.Pf=function(t,e){if(e)for(var n in e.o)e.o.hasOwnProperty(n)&&(t[n]=e.o[n]);t["X-Goog-Api-Client"]=vl},ml.prototype.Ga=function(u,i,r){var h=this,c=this.Vf(u);return new Promise(function(o,s){var a=new Li;a.listenOnce(ki.COMPLETE,function(){try{switch(a.getLastErrorCode()){case Si.NO_ERROR:var t=a.getResponseJson();fa("Connection","XHR received:",JSON.stringify(t)),o(t);break;case Si.TIMEOUT:fa("Connection",'RPC "'+u+'" timed out'),s(new Mi(Pi.DEADLINE_EXCEEDED,"Request time out"));break;case Si.HTTP_ERROR:var e=a.getStatus();if(fa("Connection",'RPC "'+u+'" failed with status:',e,"response text:",a.getResponseText()),0<e){var n=a.getResponseJson().error;if(n&&n.status&&n.message){var i=(r=n.status.toLowerCase().replace("_","-"),0<=Object.values(Pi).indexOf(r)?r:Pi.UNKNOWN);s(new Mi(i,n.message))}else s(new Mi(Pi.UNKNOWN,"Server responded with status "+a.getStatus()))}else fa("Connection",'RPC "'+u+'" failed'),s(new Mi(Pi.UNAVAILABLE,"Connection failed."));break;default:ya('RPC "'+u+'" failed with unanticipated webchannel error '+a.getLastErrorCode()+": "+a.getLastError()+", giving up.")}}finally{fa("Connection",'RPC "'+u+'" completed.')}var r});var t=Object.assign({},i);delete t.database;var e=JSON.stringify(t);fa("Connection","XHR sending: ",c+" "+e);var n={"Content-Type":"text/plain"};h.Pf(n,r),a.send(c,"POST",e,n,15)})},ml.prototype.Ka=function(t,e,n){return this.Ga(t,e,n)},ml.prototype.ka=function(t,e){var n,i,r=[this.Af,"/","google.firestore.v1.Firestore","/",t,"/channel"],o=_i(),s={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.ci.projectId+"/databases/"+this.ci.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling};this.Pf(s.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(p())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=p().indexOf("Electron/")||0<=(i=p()).indexOf("MSIE ")||0<=i.indexOf("Trident/")||0<=p().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(s.httpHeadersOverwriteParam="$httpHeaders");var a=r.join("");function u(t,e){h.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})}fa("Connection","Creating WebChannel: "+a+" "+s);var h=o.createWebChannel(a,s),c=!1,l=!1,f=new dl({df:function(t){l?fa("Connection","Not sending because WebChannel is closed:",t):(c||(fa("Connection","Opening WebChannel transport."),h.open(),c=!0),fa("Connection","WebChannel sending:",t),h.send(t))},ff:function(){return h.close()}});return u(Ri.EventType.OPEN,function(){l||fa("Connection","WebChannel transport opened.")}),u(Ri.EventType.CLOSE,function(){l||(l=!0,fa("Connection","WebChannel transport closed"),f.Rf())}),u(Ri.EventType.ERROR,function(t){l||(l=!0,fa("Connection","WebChannel transport errored:",t),f.Rf(new Mi(Pi.UNAVAILABLE,"The operation could not be completed")))}),u(Ri.EventType.MESSAGE,function(t){var e;if(!l){var n=t.data[0];va(!!n,"Got a webchannel message without data.");var i=n.error||(null===(e=n[0])||void 0===e?void 0:e.error);if(i){fa("Connection","WebChannel received error:",i);var r=i.status,o=function(){var t=fs[r];if(void 0!==t)return Is(t)}(),s=i.message;void 0===o&&(o=Pi.INTERNAL,s="Unknown error status: "+r+" with message "+i.message),l=!0,f.Rf(new Mi(o,s)),h.close()}else fa("Connection","WebChannel received:",n),f.If(n)}}),setTimeout(function(){f.Ef()},0),f},ml.prototype.Vf=function(t){var e=yl[t];return this.Af+"/v1/projects/"+this.ci.projectId+"/databases/"+this.ci.database+"/documents:"+e},ml);function ml(t){this.ci=t.ci;var e=t.ssl?"https":"http";this.Af=e+"://"+t.host,this.forceLongPolling=t.forceLongPolling}function wl(t){this.df=t.df,this.ff=t.ff}function bl(){var t=this;this.rf=function(){return t.hf()},this.af=function(){return t.uf()},this.cf=[],this.lf()}function El(){}function Al(){this.di=!0,this.yo="undefined"!=typeof atob}aa.fn((Object.defineProperty(Al.prototype,"document",{get:function(){return"undefined"!=typeof document?document:null},enumerable:!0,configurable:!0}),Object.defineProperty(Al.prototype,"window",{get:function(){return"undefined"!=typeof window?window:null},enumerable:!0,configurable:!0}),Al.prototype.K_=function(t){return Promise.resolve(new gl(t))},Al.prototype.Q_=function(){return new(pl._f()?pl:fl)},Al.prototype.H_=function(t){return new ra(t,{di:!0})},Al.prototype.wn=function(t){return JSON.stringify(t)},Al.prototype.atob=function(t){return atob(t)},Al.prototype.btoa=function(t){return btoa(t)},new Al)),(el=Il).INTERNAL.registerComponent(new E("firestore",function(t){return e=t.getProvider("app").getImmediate(),n=t.getProvider("auth-internal"),new kc(e,n,new lc);var e,n},"PUBLIC").setServiceProps(Object.assign({},ll))),el.registerVersion("@firebase/firestore","1.14.0")}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.memory.js - be sure to load firebase-app.js first.")}});