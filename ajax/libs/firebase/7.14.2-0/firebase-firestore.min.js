!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t=t||self).firebase)}(this,function(_p){"use strict";try{(function(){_p=_p&&Object.prototype.hasOwnProperty.call(_p,"default")?_p.default:_p;var t,l,e,r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function n(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function f(t,s,u,a){return new(u=u||Promise)(function(n,e){function r(t){try{o(a.next(t))}catch(t){e(t)}}function i(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,i)}o((a=a.apply(t,s||[])).next())})}function y(n,r){var i,o,s,t,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function i(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function o(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=a[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,s(["["+i+"]  "+t.name+":"],n))}}(e=l=l||{})[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT",l.DEBUG,l.VERBOSE,l.INFO,l.WARN,l.ERROR,l.SILENT;var u=l.INFO,a=((t={})[l.DEBUG]="log",t[l.VERBOSE]="log",t[l.INFO]="info",t[l.WARN]="warn",t[l.ERROR]="error",t),h=(Object.defineProperty(c.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in l))throw new TypeError("Invalid value assigned to `logLevel`");this._logLevel=t},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!0,configurable:!0}),c.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.DEBUG],t)),this._logHandler.apply(this,s([this,l.DEBUG],t))},c.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.VERBOSE],t)),this._logHandler.apply(this,s([this,l.VERBOSE],t))},c.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.INFO],t)),this._logHandler.apply(this,s([this,l.INFO],t))},c.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.WARN],t)),this._logHandler.apply(this,s([this,l.WARN],t))},c.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.ERROR],t)),this._logHandler.apply(this,s([this,l.ERROR],t))},c);function c(t){this.name=t,this._logLevel=u,this._logHandler=o,this._userLogHandler=null}function p(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var d,v=(n(g,d=Error),g);function g(t,e){var n=d.call(this,e)||this;return n.code=t,n.name="FirebaseError",Object.setPrototypeOf(n,g.prototype),Error.captureStackTrace&&Error.captureStackTrace(n,m.prototype.create),n}var m=(E.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r,i=e[0]||{},o=this.service+"/"+t,s=this.errors[t],u=s?(r=i,s.replace(w,function(t,e){var n=r[e];return null!=n?n.toString():"<"+e+"?>"})):"Error",a=this.serviceName+": "+u+" ("+o+").",h=new v(o,a),c=0,f=Object.keys(i);c<f.length;c++){var l=f[c];"_"!==l.slice(-1)&&(l in h&&console.warn('Overwriting FirebaseError base field "'+l+'" can cause unexpected behavior.'),h[l]=i[l])}return h},E);function E(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var w=/\{\$([^}]+)}/g,b=(T.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},T.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},T.prototype.setServiceProps=function(t){return this.serviceProps=t,this},T);function T(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var I,N="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},_=_||{},A=N;function S(t){return"string"==typeof t}function D(t){return"number"==typeof t}function k(t,e){t=t.split("."),e=e||A;for(var n=0;n<t.length;n++)if(null==(e=e[t[n]]))return null;return e}function R(){}function x(t){var e=typeof t;if("object"==e){if(!t)return"null";if(t instanceof Array)return"array";if(t instanceof Object)return e;var n=Object.prototype.toString.call(t);if("[object Window]"==n)return"object";if("[object Array]"==n||"number"==typeof t.length&&void 0!==t.splice&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("splice"))return"array";if("[object Function]"==n||void 0!==t.call&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("call"))return"function"}else if("function"==e&&void 0===t.call)return"object";return e}function O(t){return"array"==x(t)}function L(t){var e=x(t);return"array"==e||"object"==e&&"number"==typeof t.length}function P(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var C="closure_uid_"+(1e9*Math.random()>>>0),V=0;function j(t,e,n){return t.call.apply(t.bind,arguments)}function M(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function U(t,e,n){return(U=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?j:M).apply(null,arguments)}function q(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var F=Date.now||function(){return+new Date};function G(t,o){function e(){}e.prototype=o.prototype,t.N=o.prototype,t.prototype=new e,(t.prototype.constructor=t).yb=function(t,e,n){for(var r=Array(arguments.length-2),i=2;i<arguments.length;i++)r[i-2]=arguments[i];return o.prototype[e].apply(t,r)}}function B(){this.j=this.j,this.i=this.i}B.prototype.j=!1,B.prototype.la=function(){!this.j&&(this.j=!0,this.G(),0)&&(this[C]||(this[C]=++V))},B.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var z=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(S(t))return S(e)&&1==e.length?t.indexOf(e,0):-1;for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},K=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i=S(t)?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function Y(t){return Array.prototype.concat.apply([],arguments)}function H(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function W(t){return/^[\s\xa0]*$/.test(t)}var Q,Z=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function X(t,e){return-1!=t.indexOf(e)}function J(t,e){return t<e?-1:e<t?1:0}t:{var $=A.navigator;if($){var tt=$.userAgent;if(tt){Q=tt;break t}}Q=""}function et(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function nt(t){var e,n={};for(e in t)n[e]=t[e];return n}var rt="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function it(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<rt.length;o++)n=rt[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function ot(t){return ot[" "](t),t}ot[" "]=R;var st,ut,at=X(Q,"Opera"),ht=X(Q,"Trident")||X(Q,"MSIE"),ct=X(Q,"Edge"),ft=ct||ht,lt=X(Q,"Gecko")&&!(X(Q.toLowerCase(),"webkit")&&!X(Q,"Edge"))&&!(X(Q,"Trident")||X(Q,"MSIE"))&&!X(Q,"Edge"),pt=X(Q.toLowerCase(),"webkit")&&!X(Q,"Edge");function dt(){var t=A.document;return t?t.documentMode:void 0}t:{var yt="",vt=(ut=Q,lt?/rv:([^\);]+)(\)|;)/.exec(ut):ct?/Edge\/([\d\.]+)/.exec(ut):ht?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(ut):pt?/WebKit\/(\S+)/.exec(ut):at?/(?:Version)[ \/]?(\S+)/.exec(ut):void 0);if(vt&&(yt=vt?vt[1]:""),ht){var gt=dt();if(null!=gt&&gt>parseFloat(yt)){st=String(gt);break t}}st=yt}var mt,Et={};function wt(u){return t=u,e=function(){for(var t=0,e=Z(String(st)).split("."),n=Z(String(u)).split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++){var o=e[i]||"",s=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=J(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||J(0==o[2].length,0==s[2].length)||J(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t},n=Et,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e();var t,e,n}var bt=A.document;mt=bt&&ht?dt()||("CSS1Compat"==bt.compatMode?parseInt(st,10):5):void 0;var Tt=!ht||9<=Number(mt),It=ht&&!wt("9"),Nt=function(){if(!A.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{A.addEventListener("test",R,e),A.removeEventListener("test",R,e)}catch(t){}return t}();function _t(t,e){this.type=t,this.a=this.target=e,this.Ia=!0}function At(t,e){if(_t.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(lt){t:{try{ot(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=S(t.pointerType)?t.pointerType:St[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}_t.prototype.b=function(){this.Ia=!1},G(At,_t);var St={2:"touch",3:"pen",4:"mouse"};At.prototype.b=function(){At.N.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,It)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var Dt="closure_listenable_"+(1e6*Math.random()|0),kt=0;function Rt(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.da=i,this.key=++kt,this.X=this.Z=!1}function xt(t){t.X=!0,t.listener=null,t.proxy=null,t.src=null,t.da=null}function Ot(t){this.src=t,this.a={},this.b=0}function Lt(t,e){var n=e.type;if(n in t.a){var r,i=t.a[n],o=z(i,e);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(xt(e),0==t.a[n].length&&(delete t.a[n],t.b--))}}function Pt(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.X&&o.listener==e&&o.capture==!!n&&o.da==r)return i}return-1}Ot.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=Pt(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new Rt(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var Ct="closure_lm_"+(1e6*Math.random()|0),Vt={};function jt(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(O(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}return r=Kt(r),e&&e[Dt]?e.Aa(n,r,P(i)?!!i.capture:!!i,o):Mt(e,n,r,!0,i,o)}(t,e,n,r,i);if(O(e)){for(var o=0;o<e.length;o++)jt(t,e[o],n,r,i);return null}return n=Kt(n),t&&t[Dt]?t.za(e,n,P(r)?!!r.capture:!!r,i):Mt(t,e,n,!1,r,i)}function Mt(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=P(i)?!!i.capture:!!i;if(s&&!Tt)return null;var u,a,h=Bt(t);if(h||(t[Ct]=h=new Ot(t)),(n=h.add(e,n,r,s,o)).proxy)return n;if(u=Gt,r=a=Tt?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)Nt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(qt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Ut(t){if(!D(t)&&t&&!t.X){var e=t.src;if(e&&e[Dt])Lt(e.c,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(qt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Bt(e))?(Lt(n,t),0==n.b&&(n.src=null,e[Ct]=null)):xt(t)}}}function qt(t){return t in Vt?Vt[t]:Vt[t]="on"+t}function Ft(t,e){var n=t.listener,r=t.da||t.src;return t.Z&&Ut(t),n.call(r,e)}function Gt(t,e){return!!t.X||Ft(t,Tt?new At(e,this):e=new At(e||k("window.event"),this))}function Bt(t){return(t=t[Ct])instanceof Ot?t:null}var zt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Kt(e){return"function"==x(e)?e:(e[zt]||(e[zt]=function(t){return e.handleEvent(t)}),e[zt])}function Yt(){B.call(this),this.c=new Ot(this),(this.J=this).B=null}function Ht(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s=e[o];if(s&&!s.X&&s.capture==n){var u=s.listener,a=s.da||s.src;s.Z&&Lt(t.c,s),i=!1!==u.call(a,r)&&i}}return i&&0!=r.Ia}G(Yt,B),Yt.prototype[Dt]=!0,(I=Yt.prototype).addEventListener=function(t,e,n,r){jt(this,t,e,n,r)},I.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(O(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=P(i)?!!i.capture:!!i,r=Kt(r),e&&e[Dt]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=Pt(s=e.a[n],r,i,o))&&(xt(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&Bt(e))&&(n=e.a[n.toString()],e=-1,n&&(e=Pt(n,r,i,o)),(r=-1<e?n[e]:null)&&Ut(r))}(this,t,e,n,r)},I.dispatchEvent=function(t){var e,n=this.B;if(n)for(e=[];n;n=n.B)e.push(n);n=this.J;var r=t.type||t;if(S(t))t=new _t(t,n);else if(t instanceof _t)t.target=t.target||n;else{var i=t;it(t=new _t(r,n),i)}if(i=!0,e)for(var o=e.length-1;0<=o;o--){var s=t.a=e[o];i=Ht(s,r,!0,t)&&i}if(i=Ht(s=t.a=n,r,!0,t)&&i,i=Ht(s,r,!1,t)&&i,e)for(o=0;o<e.length;o++)i=Ht(s=t.a=e[o],r,!1,t)&&i;return i},I.G=function(){if(Yt.N.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)xt(n[r]);delete e.a[t],e.b--}}this.B=null},I.za=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},I.Aa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Wt=A.JSON.stringify;function Qt(t,e){this.c=t,this.f=e,this.b=0,this.a=null}function Zt(){this.b=this.a=null}Qt.prototype.get=function(){if(0<this.b){this.b--;var t=this.a;this.a=t.next,t.next=null}else t=this.c();return t};var Xt,Jt=new Qt(function(){return new $t},function(t){t.reset()});function $t(){this.next=this.b=this.a=null}function te(t){A.setTimeout(function(){throw t},0)}function ee(t,e){var n;Xt||(n=A.Promise.resolve(void 0),Xt=function(){n.then(ie)}),ne||(Xt(),ne=!0),re.add(t,e)}Zt.prototype.add=function(t,e){var n=Jt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},$t.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var ne=!($t.prototype.reset=function(){this.next=this.b=this.a=null}),re=new Zt;function ie(){for(var t;r=n=void 0,r=null,(n=re).a&&(r=n.a,n.a=n.a.next,n.a||(n.b=null),r.next=null),t=r;){try{t.a.call(t.b)}catch(t){te(t)}var e=Jt;e.f(t),e.b<100&&(e.b++,t.next=e.a,e.a=t)}var n,r;ne=!1}function oe(t,e){Yt.call(this),this.b=t||1,this.a=e||A,this.f=U(this.gb,this),this.g=F()}function se(t){t.ba=!1,t.L&&(t.a.clearTimeout(t.L),t.L=null)}function ue(t,e,n){if("function"==x(t))n&&(t=U(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=U(t.handleEvent,t)}return 2147483647<Number(e)?-1:A.setTimeout(t,e||0)}function ae(t,e,n){B.call(this),this.f=null!=n?U(t,n):t,this.c=e,this.b=U(this.$a,this),this.a=[]}function he(t){t.U=ue(t.b,t.c),t.f.apply(null,t.a)}function ce(t){B.call(this),this.b=t,this.a={}}G(oe,Yt),(I=oe.prototype).ba=!1,I.L=null,I.gb=function(){if(this.ba){var t=F()-this.g;0<t&&t<.8*this.b?this.L=this.a.setTimeout(this.f,this.b-t):(this.L&&(this.a.clearTimeout(this.L),this.L=null),this.dispatchEvent("tick"),this.ba&&(se(this),this.start()))}},I.start=function(){this.ba=!0,this.L||(this.L=this.a.setTimeout(this.f,this.b),this.g=F())},I.G=function(){oe.N.G.call(this),se(this),delete this.a},G(ae,B),(I=ae.prototype).ea=!1,I.U=null,I.Ta=function(t){this.a=arguments,this.U?this.ea=!0:he(this)},I.G=function(){ae.N.G.call(this),this.U&&(A.clearTimeout(this.U),this.U=null,this.ea=!1,this.a=[])},I.$a=function(){this.U=null,this.ea&&(this.ea=!1,he(this))},G(ce,B);var fe=[];function le(t,e,n,r){O(n)||(n&&(fe[0]=n.toString()),n=fe);for(var i=0;i<n.length;i++){var o=jt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function pe(t){et(t.a,function(t,e){this.a.hasOwnProperty(e)&&Ut(t)},t),t.a={}}function de(){}ce.prototype.G=function(){ce.N.G.call(this),pe(this)},ce.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ye=new Yt;function ve(t){_t.call(this,"serverreachability",t)}function ge(){ye.dispatchEvent(new ve(ye))}function me(t){_t.call(this,"statevent",t)}function Ee(){ye.dispatchEvent(new me(ye))}function we(t){_t.call(this,"timingevent",t)}function be(t,e){if("function"!=x(t))throw Error("Fn must not be null and must be a function");return A.setTimeout(function(){t()},e)}G(ve,_t),G(me,_t),G(we,_t);var Te={NO_ERROR:0,hb:1,ob:2,nb:3,kb:4,mb:5,pb:6,La:7,TIMEOUT:8,sb:9},Ie={jb:"complete",wb:"success",Ma:"error",La:"abort",ub:"ready",vb:"readystatechange",TIMEOUT:"timeout",qb:"incrementaldata",tb:"progress",lb:"downloadprogress",xb:"uploadprogress"};function Ne(){}function _e(t){var e;return(e=t.a)||(e=t.a={}),e}function Ae(){}Ne.prototype.a=null;var Se,De={OPEN:"a",ib:"b",Ma:"c",rb:"d"};function ke(){_t.call(this,"d")}function Re(){_t.call(this,"c")}function xe(){}function Oe(t,e,n){this.g=t,this.W=e,this.V=n||1,this.I=new ce(this),this.O=Le,t=ft?125:void 0,this.P=new oe(t),this.h=null,this.b=!1,this.l=this.D=this.f=this.F=this.v=this.R=this.i=null,this.j=[],this.a=null,this.A=0,this.c=this.w=null,this.o=-1,this.m=!1,this.J=0,this.B=null,this.s=this.S=this.H=!1}G(ke,_t),G(Re,_t),G(xe,Ne),Se=new xe;var Le=45e3,Pe={},Ce={};function Ve(t,e,n){t.F=1,t.f=un($e(e)),t.l=n,t.H=!0,Me(t,null)}function je(t,e,n,r){t.F=1,t.f=un($e(e)),t.l=null,t.H=n,Me(t,r)}function Me(t,e){t.v=F(),qe(t),t.D=$e(t.f),sn(t.D,"t",t.V),t.A=0,t.a=t.g.$(t.g.Y()?e:null),0<t.J&&(t.B=new ae(U(t.Ja,t,t.a),t.J)),le(t.I,t.a,"readystatechange",t.cb),e=t.h?nt(t.h):{},t.l?(t.w||(t.w="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ca(t.D,t.w,t.l,e)):(t.w="GET",t.a.ca(t.D,t.w,null,e)),ge()}function Ue(t,e,n){for(var r=!0;!t.m&&t.A<n.length;){var i=(s=n,a=u=void 0,u=(o=t).A,-1==(a=s.indexOf("\n",u))?Ce:(u=Number(s.substring(u,a)),isNaN(u)?Pe:(a+=1)+u>s.length?Ce:(s=s.substr(a,u),o.A=a+u,s)));if(i==Ce){4==e&&(t.c=4,Ee(),r=!1);break}if(i==Pe){t.c=4,Ee(),r=!1;break}Ke(t,i)}var o,s,u,a;4==e&&0==n.length&&(t.c=1,Ee(),r=!1),t.b=t.b&&r,r||(ze(t),Be(t))}function qe(t){t.R=F()+t.O,Fe(t,t.O)}function Fe(t,e){if(null!=t.i)throw Error("WatchDog timer not null");t.i=be(U(t.ab,t),e)}function Ge(t){t.i&&(A.clearTimeout(t.i),t.i=null)}function Be(t){t.g.Ca()||t.m||t.g.na(t)}function ze(t){Ge(t);var e=t.B;e&&"function"==typeof e.la&&e.la(),t.B=null,se(t.P),pe(t.I),t.a&&(e=t.a,t.a=null,e.abort(),e.la())}function Ke(t,e){try{t.g.Fa(t,e),ge()}catch(t){}}function Ye(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(L(t)||S(t))K(t,e,void 0);else{if(t.K&&"function"==typeof t.K)var n=t.K();else if(t.C&&"function"==typeof t.C)n=void 0;else if(L(t)||S(t)){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.C&&"function"==typeof t.C)return t.C();if(S(t))return t.split("");if(L(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function He(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof He)for(n=t.K(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function We(t,e){Ze(t.b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Qe(t))}function Qe(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Ze(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)Ze(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function Ze(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(I=Oe.prototype).setTimeout=function(t){this.O=t},I.cb=function(t){t=t.target;var e=this.B;e&&3==$n(t)?e.Ta():this.Ja(t)},I.Ja=function(t){try{if(t==this.a)t:{var e=$n(this.a),n=this.a.ya();this.a.T();if(!(e<3||3==e&&!ft&&!this.a.aa())){this.m||4!=e||7==n||ge(),Ge(this);var r=this.a.T();this.o=r;var i=this.a.aa();if(this.b=200==r){if(this.S&&!this.s){e:{if(this.a){var o=tr(this.a,"X-HTTP-Initial-Response");if(o&&!W(o)){var s=o;break e}}s=null}if(!s){this.b=!1,this.c=3,Ee(),ze(this),Be(this);break t}this.s=!0,Ke(this,s)}this.H?(Ue(this,e,i),ft&&this.b&&3==e&&(le(this.I,this.P,"tick",this.bb),this.P.start())):Ke(this,i),4==e&&ze(this),this.b&&!this.m&&(4==e?this.g.na(this):(this.b=!1,qe(this)))}else 400==r&&0<i.indexOf("Unknown SID")?this.c=3:this.c=0,Ee(),ze(this),Be(this)}}}catch(t){}},I.bb=function(){if(this.a){var t=$n(this.a),e=this.a.aa();this.A<e.length&&(Ge(this),Ue(this,t,e),this.b&&4!=t&&qe(this))}},I.cancel=function(){this.m=!0,ze(this)},I.ab=function(){this.i=null;var t=F();0<=t-this.R?(2!=this.F&&(ge(),Ee()),ze(this),this.c=2,Be(this)):Fe(this,this.R-t)},(I=He.prototype).C=function(){Qe(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},I.K=function(){return Qe(this),this.a.concat()},I.get=function(t,e){return Ze(this.b,t)?this.b[t]:e},I.set=function(t,e){Ze(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},I.forEach=function(t,e){for(var n=this.K(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Xe=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Je(t,e){var n;this.b=this.j=this.f="",this.i=null,this.g=this.a="",this.h=!1,t instanceof Je?(this.h=void 0!==e?e:t.h,tn(this,t.f),this.j=t.j,en(this,t.b),nn(this,t.i),this.a=t.a,rn(this,bn(t.c)),this.g=t.g):t&&(n=String(t).match(Xe))?(this.h=!!e,tn(this,n[1]||"",!0),this.j=an(n[2]||""),en(this,n[3]||"",!0),nn(this,n[4]),this.a=an(n[5]||"",!0),rn(this,n[6]||"",!0),this.g=an(n[7]||"")):(this.h=!!e,this.c=new vn(null,this.h))}function $e(t){return new Je(t)}function tn(t,e,n){t.f=n?an(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function en(t,e,n){t.b=n?an(e,!0):e}function nn(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.i=e}else t.i=null}function rn(t,e,n){var r,i;e instanceof vn?(t.c=e,r=t.c,(i=t.h)&&!r.f&&(gn(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(mn(this,e),wn(this,n,t))},r)),r.f=i):(n||(e=hn(e,dn)),t.c=new vn(e,t.h))}function on(t,e,n){t.c.set(e,n)}function sn(t,e,n){O(n)||(n=[String(n)]),wn(t.c,e,n)}function un(t){return on(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^F()).toString(36)),t}function an(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function hn(t,e,n){return S(t)?(t=encodeURI(t).replace(e,cn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function cn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Je.prototype.toString=function(){var t=[],e=this.f;e&&t.push(hn(e,fn,!0),":");var n=this.b;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(hn(e,fn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.i)&&t.push(":",String(n))),(n=this.a)&&(this.b&&"/"!=n.charAt(0)&&t.push("/"),t.push(hn(n,"/"==n.charAt(0)?pn:ln,!0))),(n=this.c.toString())&&t.push("?",n),(n=this.g)&&t.push("#",hn(n,yn)),t.join("")},Je.prototype.resolve=function(t){var e=$e(this),n=!!t.f;n?tn(e,t.f):n=!!t.j,n?e.j=t.j:n=!!t.b,n?en(e,t.b):n=null!=t.i;var r=t.a;if(n)nn(e,t.i);else if(n=!!t.a){if("/"!=r.charAt(0))if(this.b&&!this.a)r="/"+r;else{var i=e.a.lastIndexOf("/");-1!=i&&(r=e.a.substr(0,i+1)+r)}if(".."==(i=r)||"."==i)r="";else if(X(i,"./")||X(i,"/.")){r=0==i.lastIndexOf("/",0),i=i.split("/");for(var o=[],s=0;s<i.length;){var u=i[s++];"."==u?r&&s==i.length&&o.push(""):".."==u?((1<o.length||1==o.length&&""!=o[0])&&o.pop(),r&&s==i.length&&o.push("")):(o.push(u),r=!0)}r=o.join("/")}else r=i}return n?e.a=r:n=""!==t.c.toString(),n?rn(e,bn(t.c)):n=!!t.g,n&&(e.g=t.g),e};var fn=/[#\/\?@]/g,ln=/[#\?:]/g,pn=/[#\?]/g,dn=/[#\?@]/g,yn=/#/g;function vn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function gn(u){u.a||(u.a=new He,u.b=0,u.c&&function(t){if(t){t=t.split("&");for(var e=0;e<t.length;e++){var n=t[e].indexOf("="),r=null;if(0<=n){var i=t[e].substring(0,n);r=t[e].substring(n+1)}else i=t[e];o=i,s=r?decodeURIComponent(r.replace(/\+/g," ")):"",u.add(decodeURIComponent(o.replace(/\+/g," ")),s)}}var o,s}(u.c))}function mn(t,e){gn(t),e=Tn(t,e),Ze(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,We(t.a,e))}function En(t,e){return gn(t),e=Tn(t,e),Ze(t.a.b,e)}function wn(t,e,n){mn(t,e),0<n.length&&(t.c=null,t.a.set(Tn(t,e),H(n)),t.b+=n.length)}function bn(t){var e=new vn;return e.c=t.c,t.a&&(e.a=new He(t.a),e.b=t.b),e}function Tn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function In(t){this.a=t,this.b=this.h=null,this.g=!1,this.i=null,this.c=-1,this.l=this.f=null}function Nn(t){var e=t.a.F.a;if(null!=e)Ee(),e?(Ee(),lr(t.a,t,!1)):(Ee(),lr(t.a,t,!0));else{t.b=new Oe(t,void 0,void 0),t.b.h=t.h,e=gr(e=t.a,e.Y()?t.f:null,t.i),Ee(),sn(e,"TYPE","xmlhttp");var n=t.a.j,r=t.a.I;n&&r&&on(e,n,r),je(t.b,e,!1,t.f)}}function _n(){this.a=this.b=null}function An(){this.a=new He}function Sn(t){var e=typeof t;return"object"==e&&t||"function"==e?"o"+(t[C]||(t[C]=++V)):e.charAt(0)+t}function Dn(t,e){this.b=t,this.a=e}function kn(t){this.g=t||Rn,t=A.PerformanceNavigationTiming?0<(t=A.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(A.ka&&A.ka.Da&&A.ka.Da()&&A.ka.Da().zb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new An),this.b=null,this.c=[]}(I=vn.prototype).add=function(t,e){gn(this),this.c=null,t=Tn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},I.forEach=function(n,r){gn(this),this.a.forEach(function(t,e){K(t,function(t){n.call(r,t,e,this)},this)},this)},I.K=function(){gn(this);for(var t=this.a.C(),e=this.a.K(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},I.C=function(t){gn(this);var e=[];if(S(t))En(this,t)&&(e=Y(e,this.a.get(Tn(this,t))));else{t=this.a.C();for(var n=0;n<t.length;n++)e=Y(e,t[n])}return e},I.set=function(t,e){return gn(this),this.c=null,En(this,t=Tn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},I.get=function(t,e){return t&&0<(t=this.C(t)).length?String(t[0]):e},I.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.K(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.C(r);for(var o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}}return this.c=t.join("&")},G(function(){},function(){}),(I=In.prototype).M=null,I.$=function(t){return this.a.$(t)},I.abort=function(){this.b&&(this.b.cancel(),this.b=null),this.c=-1},I.Ca=function(){return!1},I.Fa=function(t,e){if(this.c=t.o,0==this.M){if(!this.a.o&&(t=t.a)){var n=tr(t,"X-Client-Wire-Protocol");this.l=n||null,this.a.j&&(t=tr(t,"X-HTTP-Session-Id"))&&(this.a.I=t)}if(e){try{var r=this.a.ja.a.parse(e)}catch(t){return(e=this.a).m=this.c,void yr(e,2)}this.f=r[0]}else(e=this.a).m=this.c,yr(e,2)}else 1==this.M&&(this.g?Ee():"11111"==e?(Ee(),this.g=!0,(!ht||10<=Number(mt))&&(this.c=200,this.b.cancel(),Ee(),lr(this.a,this,!0))):(Ee(),this.g=!1))},I.na=function(){if(this.c=this.b.o,this.b.b)0==this.M?(this.M=1,Nn(this)):1==this.M&&(this.g?(Ee(),lr(this.a,this,!0)):(Ee(),lr(this.a,this,!1)));else{0!=this.M&&1!=this.M||Ee();var t=this.a;t.m=this.c,yr(t,2)}},I.Y=function(){return this.a.Y()},I.ma=function(){return this.a.ma()},An.prototype.add=function(t){this.a.set(Sn(t),t)},An.prototype.C=function(){return this.a.C()};var Rn=10;function xn(t,e){!t.a&&(X(e,"spdy")||X(e,"quic")||X(e,"h2"))&&(t.f=t.g,t.a=new An,t.b&&(Cn(t,t.b),t.b=null))}function On(t){return t.b||t.a&&t.a.a.c>=t.f}function Ln(t){return t.b?1:t.a?t.a.a.c:0}function Pn(t,e){return t.b?t.b==e:!!t.a&&(e=Sn(e),Ze(t.a.a.b,e))}function Cn(t,e){t.a?t.a.add(e):t.b=e}function Vn(t,e){var n;t.b&&t.b==e?t.b=null:((n=t.a)&&(n=Sn(e),n=Ze(t.a.a.b,n)),n&&We(t.a.a,Sn(e)))}function jn(t){if(null!=t.b)return t.c.concat(t.b.j);if(null==t.a||0==t.a.a.c)return H(t.c);var e=t.c;return K(t.a.C(),function(t){e=e.concat(t.j)}),e}function Mn(){}function Un(){this.a=new Mn}function qn(t,r,e){var i=e||"";try{Ye(t,function(t,e){var n=t;P(t)&&(n=Wt(t)),r.push(i+e+"="+encodeURIComponent(n))})}catch(t){throw r.push(i+"type="+encodeURIComponent("_badmap")),t}}function Fn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}kn.prototype.cancel=function(){var t;this.c=jn(this),this.b?(this.b.cancel(),this.b=null):this.a&&0!=this.a.a.c&&(K(this.a.C(),function(t){t.cancel()}),(t=this.a.a).b={},t.a.length=0,t.c=0)},Mn.prototype.stringify=function(t){return A.JSON.stringify(t,void 0)},Mn.prototype.parse=function(t){return A.JSON.parse(t,void 0)};var Gn=A.JSON.parse;function Bn(t){Yt.call(this),this.headers=new He,this.H=t||null,this.b=!1,this.s=this.a=null,this.A="",this.h=0,this.f="",this.g=this.w=this.l=this.v=!1,this.o=0,this.m=null,this.I=zn,this.D=this.F=!1}G(Bn,Yt);var zn="",Kn=/^https?$/i,Yn=["POST","PUT"];function Hn(t){return"content-type"==t.toLowerCase()}function Wn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Qn(t),Xn(t)}function Qn(t){t.v||(t.v=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function Zn(t){if(t.b&&void 0!==_&&(!t.s[1]||4!=$n(t)||2!=t.T()))if(t.l&&4==$n(t))ue(t.Ea,0,t);else if(t.dispatchEvent("readystatechange"),4==$n(t)){t.b=!1;try{var e,n=t.T();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var o=String(t.A).match(Xe)[1]||null;if(!o&&A.self&&A.self.location){var s=A.self.location.protocol;o=s.substr(0,s.length-1)}i=!Kn.test(o?o.toLowerCase():"")}e=i}if(e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{t.h=6;try{var u=2<$n(t)?t.a.statusText:""}catch(t){u=""}t.f=u+" ["+t.T()+"]",Qn(t)}}finally{Xn(t)}}}function Xn(t,e){if(t.a){Jn(t);var n=t.a,r=t.s[0]?R:null;t.a=null,t.s=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(t){}}}function Jn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(A.clearTimeout(t.m),t.m=null)}function $n(t){return t.a?t.a.readyState:0}function tr(t,e){return t.a?t.a.getResponseHeader(e):null}function er(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}if(r)return t;var i;if(i="",et(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,S(t)){if(e=encodeURIComponent(String(e)),e+=n=null!=n?"="+encodeURIComponent(String(n)):""){if((n=t.indexOf("#"))<0&&(n=t.length),(r=t.indexOf("?"))<0||n<r){r=n;var o=""}else o=t.substring(r+1,n);n=(t=[t.substr(0,r),o,t.substr(n)])[1],t[1]=e?n?n+"&"+e:e:n,t=t[0]+(t[1]?"?"+t[1]:"")+t[2]}return t}return on(t,e,n),t}function nr(t){this.f=[],this.F=new _n,this.ga=this.pa=this.B=this.ha=this.a=this.I=this.j=this.V=this.g=this.J=this.i=null,this.Qa=this.P=0,this.Oa=!!k("internalChannelParams.failFast",t),this.ia=this.w=this.s=this.l=this.h=this.c=null,this.oa=!0,this.m=this.ra=this.O=-1,this.S=this.v=this.A=0,this.Na=k("internalChannelParams.baseRetryDelayMs",t)||5e3,this.Ra=k("internalChannelParams.retryDelaySeedMs",t)||1e4,this.Pa=k("internalChannelParams.forwardChannelMaxRetries",t)||2,this.qa=k("internalChannelParams.forwardChannelRequestTimeoutMs",t)||2e4,this.Ka=t&&t.Ab||void 0,this.D=void 0,this.R=t&&t.supportsCrossDomainXhr||!1,this.H="",this.b=new kn(t&&t.concurrentRequestLimit),this.ja=new Un,this.o=!t||void 0===t.backgroundChannelTest||t.backgroundChannelTest,(this.W=t&&t.fastHandshake||!1)&&!this.o&&(this.o=!0),t&&t.forceLongPolling&&(this.oa=!1),this.fa=void 0}function rr(t){if(ir(t),3==t.u){var e=t.P++,n=$e(t.B);on(n,"SID",t.H),on(n,"RID",e),on(n,"TYPE","terminate"),ar(t,n),(e=new Oe(t,e,void 0)).F=2,e.f=un($e(n)),n=!1,A.navigator&&A.navigator.sendBeacon&&(n=A.navigator.sendBeacon(e.f.toString(),"")),!n&&A.Image&&((new Image).src=e.f,n=!0),n||(e.a=e.g.$(null),e.a.ca(e.f)),e.v=F(),qe(e)}vr(t)}function ir(t){t.w&&(t.w.abort(),t.w=null),t.a&&(t.a.cancel(),t.a=null),t.l&&(A.clearTimeout(t.l),t.l=null),pr(t),t.b.cancel(),t.h&&(D(t.h)&&A.clearTimeout(t.h),t.h=null)}function or(t,e){t.f.push(new Dn(t.Qa++,e)),3==t.u&&sr(t)}function sr(t){On(t.b)||t.h||(t.h=!0,ee(t.Ha,t),t.A=0)}function ur(t,e){var n;n=e?e.W:t.P++;var r=$e(t.B);on(r,"SID",t.H),on(r,"RID",n),on(r,"AID",t.O),ar(t,r),t.g&&t.i&&er(r,t.g,t.i),n=new Oe(t,n,t.A+1),null===t.g&&(n.h=t.i),e&&(t.f=e.j.concat(t.f)),e=hr(t,n,1e3),n.setTimeout(Math.round(.5*t.qa)+Math.round(.5*t.qa*Math.random())),Cn(t.b,n),Ve(n,r,e)}function ar(t,n){t.c&&Ye({},function(t,e){on(n,e,t)})}function hr(t,e,n){n=Math.min(t.f.length,n);var r=t.c?U(t.c.Sa,t.c,t):null;t:for(var i=t.f,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var h=i[a].b,c=i[a].a;if((h-=o)<0)o=Math.max(0,i[a].b-100),u=!1;else try{qn(c,s,"req"+h+"_")}catch(t){r&&r(c)}}if(u){r=s.join("&");break t}}return t=t.f.splice(0,n),e.j=t,r}function cr(t){t.a||t.l||(t.S=1,ee(t.Ga,t),t.v=0)}function fr(t){return!(t.a||t.l||3<=t.v)&&(t.S++,t.l=be(U(t.Ga,t),dr(t,t.v)),t.v++,1)}function lr(t,e,n){var r=e.l;r&&xn(t.b,r),t.ia=t.oa&&n,t.m=e.c,t.B=gr(t,null,t.ha),sr(t)}function pr(t){null!=t.s&&(A.clearTimeout(t.s),t.s=null)}function dr(t,e){var n=t.Na+Math.floor(Math.random()*t.Ra);return t.ma()||(n*=2),n*e}function yr(t,e){if(2==e){var n=null;t.c&&(n=null);var r=U(t.eb,t);n||(n=new Je("//www.google.com/images/cleardot.gif"),A.location&&"http"==A.location.protocol||tn(n,"https"),un(n)),function(t,e){var n=new de;if(A.Image){var r=new Image;r.onload=q(Fn,n,r,"TestLoadImage: loaded",!0,e),r.onerror=q(Fn,n,r,"TestLoadImage: error",!1,e),r.onabort=q(Fn,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=q(Fn,n,r,"TestLoadImage: timeout",!1,e),A.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}else e(!1)}(n.toString(),r)}else Ee();t.u=0,t.c&&t.c.ta(e),vr(t),ir(t)}function vr(t){t.u=0,t.m=-1,t.c&&(0==jn(t.b).length&&0==t.f.length||(t.b.c.length=0,H(t.f),t.f.length=0),t.c.sa())}function gr(t,e,n){var r,i,o,s,u,a,h=(r=n)instanceof Je?$e(r):new Je(r,void 0);if(""!=h.b)e&&en(h,e+"."+h.b),nn(h,h.i);else{var c,f=A.location;c=e?e+"."+f.hostname:f.hostname,i=f.protocol,o=c,s=+f.port,u=n,a=new Je(null,void 0),i&&tn(a,i),o&&en(a,o),s&&nn(a,s),u&&(a.a=u),h=a}return t.V&&et(t.V,function(t,e){on(h,e,t)}),e=t.j,n=t.I,e&&n&&on(h,e,n),on(h,"VER",t.wa),ar(t,h),h}function mr(){}function Er(){if(ht&&!(10<=Number(mt)))throw Error("Environmental error: no available transport.")}function wr(t,e){Yt.call(this),this.a=new nr(e),this.g=t,this.m=e&&e.fb?e.fb:function(t){for(var e=t,n=1;n<arguments.length;n++){var r,i=arguments[n];0==i.lastIndexOf("/",0)?e=i:((r=""==e)||(r=0<=(r=e.length-1)&&e.indexOf("/",r)==r),e+=r?i:"/"+i)}return e}(this.g,"test"),this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.i=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.xa&&(t?t["X-WebChannel-Client-Profile"]=e.xa:t={"X-WebChannel-Client-Profile":e.xa}),this.a.J=t,(t=e&&e.httpHeadersOverwriteParam)&&!W(t)&&(this.a.g=t),this.l=e&&e.supportsCrossDomainXhr||!1,this.h=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!W(e)&&(this.a.j=e,null!==(t=this.b)&&e in t&&e in(t=this.b)&&delete t[e]),this.f=new Ir(this)}function br(t){ke.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function Tr(){Re.call(this),this.status=1}function Ir(t){this.a=t}(I=Bn.prototype).ca=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.A+"; newUri="+t);e=e?e.toUpperCase():"GET",this.A=t,this.f="",this.h=0,this.v=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?_e(this.H):_e(Se),this.a.onreadystatechange=U(this.Ea,this);try{this.w=!0,this.a.open(e,String(t),!0),this.w=!1}catch(t){return void Wn(this,t)}t=n||"";var i,o=new He(this.headers);r&&Ye(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=Hn,n=t.length,r=S(t)?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:S(t)?t.charAt(e):t[e]}(o.K()),n=A.FormData&&t instanceof A.FormData,0<=z(Yn,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Jn(this),0<this.o&&((this.D=(i=this.a,ht&&wt(9)&&D(i.timeout)&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=U(this.Ba,this)):this.m=ue(this.Ba,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){Wn(this,t)}},I.Ba=function(){void 0!==_&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},I.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Xn(this))},I.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Xn(this,!0)),Bn.N.G.call(this)},I.Ea=function(){this.j||(this.w||this.l||this.g?Zn(this):this.Za())},I.Za=function(){Zn(this)},I.T=function(){try{return 2<$n(this)?this.a.status:-1}catch(t){return-1}},I.aa=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},I.Ua=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Gn(e)}},I.ya=function(){return this.h},I.Xa=function(){return S(this.f)?this.f:String(this.f)},(I=nr.prototype).wa=8,I.u=1,I.Ca=function(){return 0==this.u},I.Ha=function(t){if(this.h)if(this.h=null,1==this.u){if(!t){this.P=Math.floor(1e5*Math.random()),t=this.P++;var e,n=new Oe(this,t,void 0),r=this.i;if(this.J&&(r?it(r=nt(r),this.J):r=this.J),null===this.g&&(n.h=r),this.W)t:{for(var i=e=0;i<this.f.length;i++){var o=this.f[i];if(void 0===(o="__data__"in o.a&&S(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.f.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=hr(this,n,e),on(i=$e(this.B),"RID",t),on(i,"CVER",22),this.o&&this.j&&on(i,"X-HTTP-Session-Id",this.j),ar(this,i),this.g&&r&&er(i,this.g,r),Cn(this.b,n),this.W?(on(i,"$req",e),on(i,"SID","null"),n.S=!0,Ve(n,i,null)):Ve(n,i,e),this.u=2}}else 3==this.u&&(t?ur(this,t):0==this.f.length||On(this.b)||ur(this))},I.Ga=function(){this.l=null,this.a=new Oe(this,"rpc",this.S),null===this.g&&(this.a.h=this.i),this.a.J=0;var t=$e(this.pa);on(t,"RID","rpc"),on(t,"SID",this.H),on(t,"CI",this.ia?"0":"1"),on(t,"AID",this.O),ar(this,t),on(t,"TYPE","xmlhttp"),this.g&&this.i&&er(t,this.g,this.i),this.D&&this.a.setTimeout(this.D),je(this.a,t,!0,this.ga)},I.Fa=function(t,e){if(0!=this.u&&(this.a==t||Pn(this.b,t)))if(this.m=t.o,!t.s&&Pn(this.b,t)&&3==this.u){try{var n=this.ja.a.parse(e)}catch(t){n=null}if(O(n)&&3==n.length){if(0==(e=n)[0]){t:if(!this.l){if(this.a){if(!(this.a.v+3e3<t.v))break t;pr(this),this.a.cancel(),this.a=null}fr(this),Ee()}}else this.ra=e[1],0<this.ra-this.O&&e[2]<37500&&this.ia&&0==this.v&&!this.s&&(this.s=be(U(this.Ya,this),6e3));if(Ln(this.b)<=1&&this.fa){try{this.fa()}catch(t){}this.fa=void 0}}else yr(this,11)}else if(!t.s&&this.a!=t||pr(this),!W(e))for(e=n=this.ja.a.parse(e),n=0;n<e.length;n++){var r=e[n];if(this.O=r[0],r=r[1],2==this.u)if("c"==r[0]){this.H=r[1],this.ga=r[2];var i=r[3];null!=i&&(this.wa=i),null!=(r=r[5])&&D(r)&&0<r&&(this.D=1.5*r),this.o&&(r=t.a)&&((i=tr(r,"X-Client-Wire-Protocol"))&&xn(this.b,i),this.j&&(r=tr(r,"X-HTTP-Session-Id")))&&(this.I=r,on(this.B,this.j,r)),this.u=3,this.c&&this.c.va(),r=t,this.pa=gr(this,this.Y()?this.ga:null,this.ha),r.s?(Vn(this.b,r),(i=this.D)&&r.setTimeout(i),r.i&&(Ge(r),qe(r)),this.a=r):cr(this),0<this.f.length&&sr(this)}else"stop"!=r[0]&&"close"!=r[0]||yr(this,7);else 3==this.u&&("stop"==r[0]||"close"==r[0]?"stop"==r[0]?yr(this,7):rr(this):"noop"!=r[0]&&this.c&&this.c.ua(r),this.v=0)}},I.Ya=function(){null!=this.s&&(this.s=null,this.a.cancel(),this.a=null,fr(this),Ee())},I.na=function(t){var e=null;if(this.a==t){pr(this),this.a=null;var n=2}else{if(!Pn(this.b,t))return;e=t.j,Vn(this.b,t),n=1}if(this.m=t.o,0!=this.u)if(t.b)1==n?(e=F()-t.v,ye.dispatchEvent(new we(ye,t.l&&t.l.length,this.A)),sr(this)):cr(this);else{var r=t.c;if(3==r||0==r&&0<this.m||!(1==n&&function(t,e){if(!(Ln(t.b)>=t.b.f-(t.h?1:0))){if(t.h)return t.f=e.j.concat(t.f),1;if(!(1==t.u||2==t.u||t.A>=(t.Oa?0:t.Pa)))return t.h=be(U(t.Ha,t,e),dr(t,t.A)),t.A++,1}}(this,t)||2==n&&fr(this)))switch(e&&0<e.length&&(t=this.b,t.c=t.c.concat(e)),r){case 1:yr(this,5);break;case 4:yr(this,10);break;case 3:yr(this,6);break;default:yr(this,2)}}},I.eb=function(t){Ee()},I.$=function(t){if(t&&!this.R)throw Error("Can't create secondary domain capable XhrIo object.");return(t=new Bn(this.Ka)).F=this.R,t},I.ma=function(){return!!this.c&&!0},I.Y=function(){return this.R},(I=mr.prototype).va=function(){},I.ua=function(){},I.ta=function(){},I.sa=function(){},I.Sa=function(){},Er.prototype.a=function(t,e){return new wr(t,e)},G(wr,Yt),(I=wr.prototype).addEventListener=function(t,e,n,r){wr.N.addEventListener.call(this,t,e,n,r)},I.removeEventListener=function(t,e,n,r){wr.N.removeEventListener.call(this,t,e,n,r)},I.Va=function(){this.a.c=this.f,this.l&&(this.a.R=!0);var t=this.a,e=this.m,n=this.g,r=this.b||void 0;Ee(),t.ha=n,t.V=r||{},t.o&&(t.F.b=[],t.F.a=!1),t.w=new In(t),null===t.g&&(t.w.h=t.i),n=e,t.g&&t.i&&(n=er(e,t.g,t.i)),(t=t.w).i=n,e=gr(t.a,null,t.i),Ee(),null!=(n=t.a.F.b)?(t.f=n[0],t.M=1,Nn(t)):(sn(e,"MODE","init"),!t.a.o&&t.a.j&&sn(e,"X-HTTP-Session-Id",t.a.j),t.b=new Oe(t,void 0,void 0),t.b.h=t.h,je(t.b,e,!1,null),t.M=0)},I.close=function(){rr(this.a)},I.Wa=function(t){if(S(t)){var e={};e.__data__=t,or(this.a,e)}else this.h?((e={}).__data__=Wt(t),or(this.a,e)):or(this.a,t)},I.G=function(){this.a.c=null,delete this.f,rr(this.a),delete this.a,wr.N.G.call(this)},G(br,ke),G(Tr,Re),G(Ir,mr),Ir.prototype.va=function(){this.a.dispatchEvent("a")},Ir.prototype.ua=function(t){this.a.dispatchEvent(new br(t))},Ir.prototype.ta=function(t){this.a.dispatchEvent(new Tr)},Ir.prototype.sa=function(){this.a.dispatchEvent("b")};var Nr=q(function(t,e){function n(){}n.prototype=t.prototype;var r=new n;return t.apply(r,Array.prototype.slice.call(arguments,1)),r},Er);Er.prototype.createWebChannel=Er.prototype.a,wr.prototype.send=wr.prototype.Wa,wr.prototype.open=wr.prototype.Va,wr.prototype.close=wr.prototype.close,Te.NO_ERROR=0,Te.TIMEOUT=8,Te.HTTP_ERROR=6,Ie.COMPLETE="complete",(Ae.EventType=De).OPEN="a",De.CLOSE="b",De.ERROR="c",De.MESSAGE="d",Yt.prototype.listen=Yt.prototype.za,Bn.prototype.listenOnce=Bn.prototype.Aa,Bn.prototype.getLastError=Bn.prototype.Xa,Bn.prototype.getLastErrorCode=Bn.prototype.ya,Bn.prototype.getStatus=Bn.prototype.T,Bn.prototype.getResponseJson=Bn.prototype.Ua,Bn.prototype.getResponseText=Bn.prototype.aa,Bn.prototype.send=Bn.prototype.ca;var _r={createWebChannelTransport:Nr,ErrorCode:Te,EventType:Ie,WebChannel:Ae,XhrIo:Bn},Ar=_r.createWebChannelTransport,Sr=_r.ErrorCode,Dr=_r.EventType,kr=_r.WebChannel,Rr=_r.XhrIo,xr=_p.SDK_VERSION,Or=(Lr.prototype.t=function(){return null!=this.uid},Lr.prototype.s=function(){return this.t()?"uid:"+this.uid:"anonymous-user"},Lr.prototype.isEqual=function(t){return t.uid===this.uid},Lr);function Lr(t){this.uid=t}function Pr(t,e){this.user=e,this.type="OAuth",this.o={},this.o.Authorization="Bearer "+t}Or.UNAUTHENTICATED=new Or(null),Or.i=new Or("google-credentials-uid"),Or.h=new Or("first-party-uid");var Cr,Vr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},jr=(n(Zr,Cr=Error),Zr),Mr=(Qr.prototype.getToken=function(){return Promise.resolve(null)},Qr.prototype._=function(){},Qr.prototype.l=function(t){(this.u=t)(Or.UNAUTHENTICATED)},Qr.prototype.T=function(){this.u=null},Qr),Ur=(Wr.prototype.getToken=function(){var e=this,n=this.A,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){if(e.A!==n)throw new jr(Vr.ABORTED,"getToken aborted due to token change.");return t?(gu("string"==typeof t.accessToken),new Pr(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},Wr.prototype._=function(){this.forceRefresh=!0},Wr.prototype.l=function(t){this.u=t,this.R&&t(this.currentUser)},Wr.prototype.T=function(){this.auth&&this.auth.removeAuthTokenListener(this.I),this.I=null,this.u=null},Wr.prototype.m=function(){var t=this.auth&&this.auth.getUid();return gu(null===t||"string"==typeof t),new Or(t)},Wr),qr=(Object.defineProperty(Hr.prototype,"o",{get:function(){var t={"X-Goog-AuthUser":this.V},e=this.P.auth.g([]);return e&&(t.Authorization=e),t},enumerable:!0,configurable:!0}),Hr),Fr=(Yr.prototype.getToken=function(){return Promise.resolve(new qr(this.P,this.V))},Yr.prototype.l=function(t){t(Or.h)},Yr.prototype.T=function(){},Yr.prototype._=function(){},Yr),Gr=(Kr.now=function(){return Kr.fromMillis(Date.now())},Kr.fromDate=function(t){return Kr.fromMillis(t.getTime())},Kr.fromMillis=function(t){var e=Math.floor(t/1e3);return new Kr(e,1e6*(t-1e3*e))},Kr.prototype.toDate=function(){return new Date(this.toMillis())},Kr.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},Kr.prototype.p=function(t){return this.seconds===t.seconds?wu(this.nanoseconds,t.nanoseconds):wu(this.seconds,t.seconds)},Kr.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},Kr.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},Kr.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},Kr),Br=(zr.v=function(t){return new zr(t)},zr.S=function(){return zr.MIN},zr.prototype.D=function(t){return this.timestamp.p(t.timestamp)},zr.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},zr.prototype.C=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},zr.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},zr.prototype.F=function(){return this.timestamp},zr);function zr(t){this.timestamp=t}function Kr(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new jr(Vr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new jr(Vr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new jr(Vr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new jr(Vr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function Yr(t,e){this.P=t,this.V=e}function Hr(t,e){this.P=t,this.V=e,this.type="FirstParty",this.user=Or.h}function Wr(t){var e=this;this.I=null,this.currentUser=Or.UNAUTHENTICATED,this.R=!1,this.A=0,this.u=null,this.forceRefresh=!1,this.I=function(){e.A++,e.currentUser=e.m(),e.R=!0,e.u&&e.u(e.currentUser)},this.A=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.I):(this.I(null),t.get().then(function(t){e.auth=t,e.I&&e.auth.addAuthTokenListener(e.I)},function(){}))}function Qr(){this.u=null}function Zr(t,e){var n=this;return(n=Cr.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}Br.MIN=new Br(new Gr(0,0));var Xr,Jr=(Object.defineProperty(ei.prototype,"length",{get:function(){return this.N},enumerable:!0,configurable:!0}),ei.prototype.isEqual=function(t){return 0===ei.k(this,t)},ei.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof ei?t.forEach(function(t){e.push(t)}):e.push(t),this.$(e)},ei.prototype.limit=function(){return this.offset+this.length},ei.prototype.M=function(t){return t=void 0===t?1:t,this.$(this.segments,this.offset+t,this.length-t)},ei.prototype.L=function(){return this.$(this.segments,this.offset,this.length-1)},ei.prototype.O=function(){return this.segments[this.offset]},ei.prototype.B=function(){return this.get(this.length-1)},ei.prototype.get=function(t){return this.segments[this.offset+t]},ei.prototype.q=function(){return 0===this.length},ei.prototype.U=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},ei.prototype.W=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},ei.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},ei.prototype.j=function(){return this.segments.slice(this.offset,this.limit())},ei.k=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},ei),$r=(n(ti,Xr=Jr),ti.prototype.$=function(t,e,n){return new ti(t,e,n)},ti.prototype.K=function(){return this.j().join("/")},ti.prototype.toString=function(){return this.K()},ti.G=function(t){if(0<=t.indexOf("//"))throw new jr(Vr.INVALID_ARGUMENT,"Invalid path ("+t+"). Paths must not contain // in them.");return new ti(t.split("/").filter(function(t){return 0<t.length}))},ti);function ti(){return null!==Xr&&Xr.apply(this,arguments)||this}function ei(t,e,n){void 0===e?e=0:e>t.length&&vu(),void 0===n?n=t.length-e:n>t.length-e&&vu(),this.segments=t,this.offset=e,this.N=n}$r.H=new $r([]);var ni,ri=/^[_a-zA-Z][_a-zA-Z0-9]*$/,ii=(n(oi,ni=Jr),oi.prototype.$=function(t,e,n){return new oi(t,e,n)},oi.Y=function(t){return ri.test(t)},oi.prototype.K=function(){return this.j().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),oi.Y(t)||(t="`"+t+"`"),t}).join(".")},oi.prototype.toString=function(){return this.K()},oi.prototype.J=function(){return 1===this.length&&"__name__"===this.get(0)},oi.X=function(){return new oi(["__name__"])},oi.Z=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new jr(Vr.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new jr(Vr.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[r+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new jr(Vr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new jr(Vr.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new oi(e)},oi);function oi(){return null!==ni&&ni.apply(this,arguments)||this}ii.H=new ii([]);var si=(ui.tt=function(t){return new ui($r.G(t).M(5))},ui.prototype.et=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},ui.prototype.isEqual=function(t){return null!==t&&0===$r.k(this.path,t.path)},ui.prototype.toString=function(){return this.path.toString()},ui.k=function(t,e){return $r.k(t.path,e.path)},ui.st=function(t){return t.length%2==0},ui.it=function(t){return new ui(new $r(t.slice()))},ui);function ui(t){this.path=t}si.EMPTY=new si(new $r([]));var ai=(pi.prototype.nt=function(t,e){return new pi(this.k,this.root.nt(t,e,this.k).rt(null,null,ci.ht,null,null))},pi.prototype.remove=function(t){return new pi(this.k,this.root.remove(t,this.k).rt(null,null,ci.ht,null,null))},pi.prototype.get=function(t){for(var e=this.root;!e.q();){var n=this.k(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},pi.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.q();){var r=this.k(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},pi.prototype.q=function(){return this.root.q()},Object.defineProperty(pi.prototype,"size",{get:function(){return this.root.size},enumerable:!0,configurable:!0}),pi.prototype.ot=function(){return this.root.ot()},pi.prototype.at=function(){return this.root.at()},pi.prototype.ut=function(t){return this.root.ut(t)},pi.prototype.forEach=function(n){this.ut(function(t,e){return n(t,e),!1})},pi.prototype.toString=function(){var n=[];return this.ut(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},pi.prototype.ct=function(t){return this.root.ct(t)},pi.prototype._t=function(){return new hi(this.root,null,this.k,!1)},pi.prototype.lt=function(t){return new hi(this.root,t,this.k,!1)},pi.prototype.dt=function(){return new hi(this.root,null,this.k,!0)},pi.prototype.ft=function(t){return new hi(this.root,t,this.k,!0)},pi),hi=(li.prototype.It=function(){var t=this.Et.pop(),e={key:t.key,value:t.value};if(this.Tt)for(t=t.left;!t.q();)this.Et.push(t),t=t.right;else for(t=t.right;!t.q();)this.Et.push(t),t=t.left;return e},li.prototype.wt=function(){return 0<this.Et.length},li.prototype.Rt=function(){if(0===this.Et.length)return null;var t=this.Et[this.Et.length-1];return{key:t.key,value:t.value}},li),ci=(fi.prototype.rt=function(t,e,n,r,i){return new fi(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},fi.prototype.q=function(){return!1},fi.prototype.ut=function(t){return this.left.ut(t)||t(this.key,this.value)||this.right.ut(t)},fi.prototype.ct=function(t){return this.right.ct(t)||t(this.key,this.value)||this.left.ct(t)},fi.prototype.min=function(){return this.left.q()?this:this.left.min()},fi.prototype.ot=function(){return this.min().key},fi.prototype.at=function(){return this.right.q()?this.key:this.right.at()},fi.prototype.nt=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.rt(null,null,null,r.left.nt(t,e,n),null):0===i?r.rt(null,e,null,null,null):r.rt(null,null,null,null,r.right.nt(t,e,n))).At()},fi.prototype.Pt=function(){if(this.left.q())return fi.EMPTY;var t=this;return t.left.Vt()||t.left.left.Vt()||(t=t.gt()),(t=t.rt(null,null,null,t.left.Pt(),null)).At()},fi.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r.left.q()||r.left.Vt()||r.left.left.Vt()||(r=r.gt()),r=r.rt(null,null,null,r.left.remove(t,e),null);else{if(r.left.Vt()&&(r=r.pt()),r.right.q()||r.right.Vt()||r.right.left.Vt()||(r=r.yt()),0===e(t,r.key)){if(r.right.q())return fi.EMPTY;n=r.right.min(),r=r.rt(n.key,n.value,null,null,r.right.Pt())}r=r.rt(null,null,null,null,r.right.remove(t,e))}return r.At()},fi.prototype.Vt=function(){return this.color},fi.prototype.At=function(){var t=this;return t.right.Vt()&&!t.left.Vt()&&(t=t.bt()),t.left.Vt()&&t.left.left.Vt()&&(t=t.pt()),t.left.Vt()&&t.right.Vt()&&(t=t.vt()),t},fi.prototype.gt=function(){var t=this.vt();return t.right.left.Vt()&&(t=(t=(t=t.rt(null,null,null,null,t.right.pt())).bt()).vt()),t},fi.prototype.yt=function(){var t=this.vt();return t.left.left.Vt()&&(t=(t=t.pt()).vt()),t},fi.prototype.bt=function(){var t=this.rt(null,null,fi.RED,null,this.right.left);return this.right.rt(null,null,this.color,t,null)},fi.prototype.pt=function(){var t=this.rt(null,null,fi.RED,this.left.right,null);return this.left.rt(null,null,this.color,null,t)},fi.prototype.vt=function(){var t=this.left.rt(null,null,!this.left.color,null,null),e=this.right.rt(null,null,!this.right.color,null,null);return this.rt(null,null,!this.color,t,e)},fi.prototype.St=function(){var t=this.Dt();return Math.pow(2,t)<=this.size+1},fi.prototype.Dt=function(){if(this.Vt()&&this.left.Vt())throw vu();if(this.right.Vt())throw vu();var t=this.left.Dt();if(t!==this.right.Dt())throw vu();return t+(this.Vt()?0:1)},fi);function fi(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:fi.RED,this.left=null!=r?r:fi.EMPTY,this.right=null!=i?i:fi.EMPTY,this.size=this.left.size+1+this.right.size}function li(t,e,n,r){this.Tt=r,this.Et=[];for(var i=1;!t.q();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.Tt?t.left:t.right;else{if(0===i){this.Et.push(t);break}this.Et.push(t),t=this.Tt?t.right:t.left}}function pi(t,e){this.k=t,this.root=e||ci.EMPTY}function di(){this.size=0}ci.EMPTY=null,ci.RED=!0,ci.ht=!1,ci.EMPTY=(Object.defineProperty(di.prototype,"key",{get:function(){throw vu()},enumerable:!0,configurable:!0}),Object.defineProperty(di.prototype,"value",{get:function(){throw vu()},enumerable:!0,configurable:!0}),Object.defineProperty(di.prototype,"color",{get:function(){throw vu()},enumerable:!0,configurable:!0}),Object.defineProperty(di.prototype,"left",{get:function(){throw vu()},enumerable:!0,configurable:!0}),Object.defineProperty(di.prototype,"right",{get:function(){throw vu()},enumerable:!0,configurable:!0}),di.prototype.rt=function(t,e,n,r,i){return this},di.prototype.nt=function(t,e,n){return new ci(t,e)},di.prototype.remove=function(t,e){return this},di.prototype.q=function(){return!0},di.prototype.ut=function(t){return!1},di.prototype.ct=function(t){return!1},di.prototype.ot=function(){return null},di.prototype.at=function(){return null},di.prototype.Vt=function(){return!1},di.prototype.St=function(){return!0},di.prototype.Dt=function(){return 0},new di);var yi=(mi.prototype.has=function(t){return null!==this.data.get(t)},mi.prototype.first=function(){return this.data.ot()},mi.prototype.last=function(){return this.data.at()},Object.defineProperty(mi.prototype,"size",{get:function(){return this.data.size},enumerable:!0,configurable:!0}),mi.prototype.indexOf=function(t){return this.data.indexOf(t)},mi.prototype.forEach=function(n){this.data.ut(function(t,e){return n(t),!1})},mi.prototype.Ct=function(t,e){for(var n=this.data.lt(t[0]);n.wt();){var r=n.It();if(0<=this.k(r.key,t[1]))return;e(r.key)}},mi.prototype.Ft=function(t,e){var n;for(n=void 0!==e?this.data.lt(e):this.data._t();n.wt();)if(!t(n.It().key))return},mi.prototype.Nt=function(t){var e=this.data.lt(t);return e.wt()?e.It().key:null},mi.prototype._t=function(){return new vi(this.data._t())},mi.prototype.lt=function(t){return new vi(this.data.lt(t))},mi.prototype.add=function(t){return this.rt(this.data.remove(t).nt(t,!0))},mi.prototype.delete=function(t){return this.has(t)?this.rt(this.data.remove(t)):this},mi.prototype.q=function(){return this.data.q()},mi.prototype.kt=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},mi.prototype.isEqual=function(t){if(!(t instanceof mi))return!1;if(this.size!==t.size)return!1;for(var e=this.data._t(),n=t.data._t();e.wt();){var r=e.It().key,i=n.It().key;if(0!==this.k(r,i))return!1}return!0},mi.prototype.j=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},mi.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},mi.prototype.rt=function(t){var e=new mi(this.k);return e.data=t,e},mi),vi=(gi.prototype.It=function(){return this.$t.It().key},gi.prototype.wt=function(){return this.$t.wt()},gi);function gi(t){this.$t=t}function mi(t){this.k=t,this.data=new ai(this.k)}function Ei(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function wi(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function bi(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Ti=(Ii.fromBase64String=function(t){return new Ii(au.Lt().atob(t))},Ii.fromUint8Array=function(t){return new Ii(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},Ii.prototype.toBase64=function(){return au.Lt().btoa(this.Mt)},Ii.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.Mt)},Ii.prototype.Ot=function(){return 2*this.Mt.length},Ii.prototype.D=function(t){return wu(this.Mt,t.Mt)},Ii.prototype.isEqual=function(t){return this.Mt===t.Mt},Ii);function Ii(t){this.Mt=t}function Ni(t){return null==t}function _i(t){return-0===t&&1/t==-1/0}function Ai(t){return"number"==typeof t&&Number.isInteger(t)&&!_i(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}function Si(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function Di(t){var e=Vi(t.mapValue.fields.__local_write_time__.timestampValue);return new Gr(e.seconds,e.nanos)}Ti.xt=new Ti("");var ki=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ri(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Si(t)?4:10:vu()}function xi(i,t){var e,n,r,o=Ri(i);if(o!==Ri(t))return!1;switch(o){case 0:return!0;case 1:return i.booleanValue===t.booleanValue;case 4:return Di(i).isEqual(Di(t));case 3:return function(t){if("string"==typeof i.timestampValue&&"string"==typeof t.timestampValue&&i.timestampValue.length===t.timestampValue.length)return i.timestampValue===t.timestampValue;var e=Vi(i.timestampValue),n=Vi(t.timestampValue);return e.seconds===n.seconds&&e.nanos===n.nanos}(t);case 5:return i.stringValue===t.stringValue;case 6:return r=t,Mi(i.bytesValue).isEqual(Mi(r.bytesValue));case 7:return i.referenceValue===t.referenceValue;case 8:return n=t,ji((e=i).geoPointValue.latitude)===ji(n.geoPointValue.latitude)&&ji(e.geoPointValue.longitude)===ji(n.geoPointValue.longitude);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return ji(t.integerValue)===ji(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=ji(t.doubleValue),r=ji(e.doubleValue);return n===r?_i(n)===_i(r):isNaN(n)&&isNaN(r)}return!1}(i,t);case 9:return bu(i.arrayValue.values||[],t.arrayValue.values||[],xi);case 10:return function(t){var e=i.mapValue.fields||{},n=t.mapValue.fields||{};if(Ei(e)!==Ei(n))return!1;for(var r in e)if(e.hasOwnProperty(r)&&(void 0===n[r]||!xi(e[r],n[r])))return!1;return!0}(t);default:return vu()}}function Oi(t,e){return void 0!==(t.values||[]).find(function(t){return xi(t,e)})}function Li(t,e){var n,r,i,o,s,u,a,h,c,f,l=Ri(t),p=Ri(e);if(l!==p)return wu(l,p);switch(l){case 0:return 0;case 1:return wu(t.booleanValue,e.booleanValue);case 2:return h=e,(c=ji(t.integerValue||t.doubleValue))<(f=ji(h.integerValue||h.doubleValue))?-1:f<c?1:c===f?0:isNaN(c)?isNaN(f)?0:-1:1;case 3:return Pi(t.timestampValue,e.timestampValue);case 4:return Pi(Di(t),Di(e));case 5:return wu(t.stringValue,e.stringValue);case 6:return o=t.bytesValue,s=e.bytesValue,u=Mi(o),a=Mi(s),u.D(a);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=wu(n[i],r[i]);if(0!==o)return o}return wu(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return n=t.geoPointValue,r=e.geoPointValue,0!==(i=wu(ji(n.latitude),ji(r.latitude)))?i:wu(ji(n.longitude),ji(r.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=Li(n[i],r[i]);if(o)return o}return wu(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=wu(r[s],o[s]);if(0!==u)return u;var a=Li(n[r[s]],i[o[s]]);if(0!==a)return a}return wu(r.length,o.length)}(t.mapValue,e.mapValue);default:throw vu()}}function Pi(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return wu(t,e);var n=Vi(t),r=Vi(e),i=wu(n.seconds,r.seconds);return 0!==i?i:wu(n.nanos,r.nanos)}function Ci(t){return function s(i){return"nullValue"in i?"null":"booleanValue"in i?""+i.booleanValue:"integerValue"in i?""+i.integerValue:"doubleValue"in i?""+i.doubleValue:"timestampValue"in i?"time("+(t=Vi(i.timestampValue)).seconds+","+t.nanos+")":"stringValue"in i?i.stringValue:"bytesValue"in i?Mi(i.bytesValue).toBase64():"referenceValue"in i?(n=i.referenceValue,si.tt(n).toString()):"geoPointValue"in i?"geo("+(e=i.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in i?function(){for(var t="[",e=!0,n=0,r=i.arrayValue.values||[];n<r.length;n++)e?e=!1:t+=",",t+=s(r[n]);return t+"]"}():"mapValue"in i?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(i.mapValue):vu();var t,e,n}(t)}function Vi(t){if(gu(!!t),"string"!=typeof t)return{seconds:ji(t.seconds),nanos:ji(t.nanos)};var e=0,n=ki.exec(t);if(gu(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}function ji(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Mi(t){return"string"==typeof t?Ti.fromBase64String(t):Ti.fromUint8Array(t)}function Ui(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.K()}}function qi(t){return t&&"integerValue"in t}function Fi(t){return!!t&&"arrayValue"in t}function Gi(t){return t&&"nullValue"in t}function Bi(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function zi(t){return t&&"mapValue"in t}var Ki=(Yi.prototype.Bt=function(t,e){return n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}},t&&(n.fields.__previous_value__=t),{mapValue:n};var n},Yi.prototype.qt=function(t,e){return e},Yi.prototype.Ut=function(t){return null},Yi.prototype.isEqual=function(t){return t instanceof Yi},Yi);function Yi(){}Ki.instance=new Ki;var Hi=(Ji.prototype.Bt=function(t,e){return this.apply(t)},Ji.prototype.qt=function(t,e){return this.apply(t)},Ji.prototype.apply=function(t){for(var n=$i(t),e=function(e){n.some(function(t){return xi(t,e)})||n.push(e)},r=0,i=this.elements;r<i.length;r++)e(i[r]);return{arrayValue:{values:n}}},Ji.prototype.Ut=function(t){return null},Ji.prototype.isEqual=function(t){return t instanceof Ji&&bu(this.elements,t.elements,xi)},Ji),Wi=(Xi.prototype.Bt=function(t,e){return this.apply(t)},Xi.prototype.qt=function(t,e){return this.apply(t)},Xi.prototype.apply=function(t){for(var n=$i(t),e=function(e){n=n.filter(function(t){return!xi(t,e)})},r=0,i=this.elements;r<i.length;r++)e(i[r]);return{arrayValue:{values:n}}},Xi.prototype.Ut=function(t){return null},Xi.prototype.isEqual=function(t){return t instanceof Xi&&bu(this.elements,t.elements,xi)},Xi),Qi=(Zi.prototype.Bt=function(t,e){var n=this.Ut(t),r=this.asNumber(n)+this.asNumber(this.Qt);return qi(n)&&qi(this.Qt)?this.serializer.Wt(r):this.serializer.jt(r)},Zi.prototype.qt=function(t,e){return e},Zi.prototype.Ut=function(t){return qi(e=t)||e&&"doubleValue"in e?t:{integerValue:0};var e},Zi.prototype.isEqual=function(t){return t instanceof Zi&&xi(this.Qt,t.Qt)},Zi.prototype.asNumber=function(t){return ji(t.integerValue||t.doubleValue)},Zi);function Zi(t,e){this.serializer=t,this.Qt=e}function Xi(t){this.elements=t}function Ji(t){this.elements=t}function $i(t){return Fi(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function to(t,e){this.version=t,this.transformResults=e}var eo=(so.Kt=function(t){return new so(t)},so.Gt=function(t){var e=new yi(ii.k);return t.forEach(function(t){return e=e.add(t)}),new so(e)},so.prototype.zt=function(e){var n=!1;return this.fields.forEach(function(t){t.U(e)&&(n=!0)}),n},so.prototype.isEqual=function(t){return this.fields.isEqual(t.fields)},so),no=(oo.prototype.isEqual=function(t){return this.field.isEqual(t.field)&&this.transform.isEqual(t.transform)},oo),ro=(io.exists=function(t){return new io(void 0,t)},io.updateTime=function(t){return new io(t)},Object.defineProperty(io.prototype,"Ht",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!0,configurable:!0}),io.prototype.Yt=function(t){return void 0!==this.updateTime?t instanceof Oo&&t.version.isEqual(this.updateTime):void 0===this.exists||this.exists===t instanceof Oo},io.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},io);function io(t,e){this.updateTime=t,this.exists=e}function oo(t,e){this.field=t,this.transform=e}function so(t){this.fields=t}ro.NONE=new ro;var uo,ao,ho,co,fo,lo=(Ao.prototype.Jt=function(t){},Ao.Xt=function(t){return t instanceof Oo?t.version:Br.MIN},Ao),po=(n(_o,fo=lo),_o.prototype.qt=function(t,e){this.Jt(t);var n=e.version;return new Oo(this.key,n,this.value,{hasCommittedMutations:!0})},_o.prototype.Bt=function(t,e,n){if(this.Jt(t),!this.Zt.Yt(t))return t;var r=lo.Xt(t);return new Oo(this.key,r,this.value,{te:!0})},_o.prototype.ee=function(t){return null},_o.prototype.isEqual=function(t){return t instanceof _o&&this.key.isEqual(t.key)&&this.value.isEqual(t.value)&&this.Zt.isEqual(t.Zt)},_o),yo=(n(No,co=lo),No.prototype.qt=function(t,e){if(this.Jt(t),!this.Zt.Yt(t))return new Po(this.key,e.version);var n=this.ie(t);return new Oo(this.key,e.version,n,{hasCommittedMutations:!0})},No.prototype.Bt=function(t,e,n){if(this.Jt(t),!this.Zt.Yt(t))return t;var r=lo.Xt(t),i=this.ie(t);return new Oo(this.key,r,i,{te:!0})},No.prototype.ee=function(t){return null},No.prototype.isEqual=function(t){return t instanceof No&&this.key.isEqual(t.key)&&this.se.isEqual(t.se)&&this.Zt.isEqual(t.Zt)},No.prototype.ie=function(t){var e;return e=t instanceof Oo?t.data():Eo.EMPTY,this.ne(e)},No.prototype.ne=function(t){var n=this,r=t.re();return this.se.fields.forEach(function(t){if(!t.q()){var e=n.data.field(t);null!==e?r.set(t,e):r.delete(t)}}),r.he()},No),vo=(n(Io,ho=lo),Io.prototype.qt=function(t,e){if(this.Jt(t),gu(null!=e.transformResults),!this.Zt.Yt(t))return new Po(this.key,e.version);var n=this.oe(t),r=this.ae(t,e.transformResults),i=e.version,o=this.ue(n.data(),r);return new Oo(this.key,i,o,{hasCommittedMutations:!0})},Io.prototype.Bt=function(t,e,n){if(this.Jt(t),!this.Zt.Yt(t))return t;var r=this.oe(t),i=this.ce(n,t,e),o=this.ue(r.data(),i);return new Oo(this.key,r.version,o,{te:!0})},Io.prototype.ee=function(t){for(var e=null,n=0,r=this.fieldTransforms;n<r.length;n++){var i=r[n],o=t instanceof Oo?t.field(i.field):void 0,s=i.transform.Ut(o||null);null!=s&&(e=null==e?Eo._e().set(i.field,s):e.set(i.field,s))}return e?e.he():null},Io.prototype.isEqual=function(t){return t instanceof Io&&this.key.isEqual(t.key)&&bu(this.fieldTransforms,t.fieldTransforms,function(t,e){return t.isEqual(e)})&&this.Zt.isEqual(t.Zt)},Io.prototype.oe=function(t){return t},Io.prototype.ae=function(t,e){var n=[];gu(this.fieldTransforms.length===e.length);for(var r=0;r<e.length;r++){var i=this.fieldTransforms[r],o=i.transform,s=null;t instanceof Oo&&(s=t.field(i.field)),n.push(o.qt(s,e[r]))}return n},Io.prototype.ce=function(t,e,n){for(var r=[],i=0,o=this.fieldTransforms;i<o.length;i++){var s=o[i],u=s.transform,a=null;e instanceof Oo&&(a=e.field(s.field)),null===a&&n instanceof Oo&&(a=n.field(s.field)),r.push(u.Bt(a,t))}return r},Io.prototype.ue=function(t,e){for(var n=t.re(),r=0;r<this.fieldTransforms.length;r++){var i=this.fieldTransforms[r].field;n.set(i,e[r])}return n.he()},Io),go=(n(To,ao=lo),To.prototype.qt=function(t,e){return this.Jt(t),new Lo(this.key,e.version,{hasCommittedMutations:!0})},To.prototype.Bt=function(t,e,n){return this.Jt(t),this.Zt.Yt(t)?new Lo(this.key,Br.S()):t},To.prototype.ee=function(t){return null},To.prototype.isEqual=function(t){return t instanceof To&&this.key.isEqual(t.key)&&this.Zt.isEqual(t.Zt)},To),mo=(n(bo,uo=lo),bo.prototype.qt=function(t,e){vu()},bo.prototype.Bt=function(t,e,n){vu()},bo.prototype.ee=function(t){vu()},bo.prototype.isEqual=function(t){return t instanceof bo&&this.key.isEqual(t.key)&&this.Zt.isEqual(t.Zt)},bo),Eo=(wo._e=function(){return wo.EMPTY.re()},wo.prototype.field=function(t){if(t.q())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!zi(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.B()])||null},wo.prototype.se=function(){return this.le(this.proto.mapValue)},wo.prototype.le=function(t){var i=this,o=new yi(ii.k);return wi(t.fields||{},function(t,e){var n=new ii([t]);if(10===Ri(e)){var r=i.le(e.mapValue).fields;r.q()?o=o.add(n):r.forEach(function(t){o=o.add(n.child(t))})}else o=o.add(n)}),eo.Kt(o)},wo.prototype.isEqual=function(t){return xi(this.proto,t.proto)},wo.prototype.re=function(){return new Ro(this)},wo);function wo(t){this.proto=t}function bo(t,e){var n=this;return(n=uo.call(this)||this).key=t,n.Zt=e,n.type=4,n}function To(t,e){var n=this;return(n=ao.call(this)||this).key=t,n.Zt=e,n.type=3,n}function Io(t,e){var n=this;return(n=ho.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.Zt=ro.exists(!0),n}function No(t,e,n,r){var i=this;return(i=co.call(this)||this).key=t,i.data=e,i.se=n,i.Zt=r,i.type=1,i}function _o(t,e,n){var r=this;return(r=fo.call(this)||this).key=t,r.value=e,r.Zt=n,r.type=0,r}function Ao(){}Eo.EMPTY=new Eo({mapValue:{}});var So,Do,ko,Ro=(Ko.prototype.set=function(t,e){return this.Te(t,e),this},Ko.prototype.delete=function(t){return this.Te(t,null),this},Ko.prototype.Te=function(t,e){for(var n=this.fe,r=0;r<t.length-1;++r){var i=t.get(r),o=n.get(i);o instanceof Map||(o=o&&10===Ri(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),n=o}n.set(t.B(),e)},Ko.prototype.he=function(){var t=this.Ee(ii.H,this.fe);return null!=t?new Eo(t):this.de},Ko.prototype.Ee=function(r,t){var i=this,o=!1,e=this.de.field(r),s=zi(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){if(t instanceof Map){var n=i.Ee(r.child(e),t);null!=n&&(s[e]=n,o=!0)}else null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},Ko),xo=(zo.Ie=function(t,e){return si.k(t.key,e.key)},zo),Oo=(n(Bo,ko=xo),Bo.prototype.field=function(t){return this.we.field(t)},Bo.prototype.data=function(){return this.we},Bo.prototype.Re=function(){return this.we.proto},Bo.prototype.isEqual=function(t){return t instanceof Bo&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.te===t.te&&this.hasCommittedMutations===t.hasCommittedMutations&&this.we.isEqual(t.we)},Bo.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.we.toString()+", {hasLocalMutations: "+this.te+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(Bo.prototype,"hasPendingWrites",{get:function(){return this.te||this.hasCommittedMutations},enumerable:!0,configurable:!0}),Bo.Ae=function(t,e,n){var r=e.field(t),i=n.field(t);return null!==r&&null!==i?Li(r,i):vu()},Bo),Lo=(n(Go,Do=xo),Go.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(Go.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!0,configurable:!0}),Go.prototype.isEqual=function(t){return t instanceof Go&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},Go),Po=(n(Fo,So=xo),Fo.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(Fo.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!0,configurable:!0}),Fo.prototype.isEqual=function(t){return t instanceof Fo&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},Fo),Co=(qo.prototype.canonicalId=function(){if(null===this.me){var t=this.path.K();null!==this.collectionGroup&&(t+="|cg:"+this.collectionGroup),t+="|f:",t+=this.filters.map(function(t){return t.canonicalId()}).join(","),t+="|ob:",t+=this.orderBy.map(function(t){return t.canonicalId()}).join(","),Ni(this.limit)||(t+="|l:",t+=this.limit),this.startAt&&(t+="|lb:",t+=this.startAt.canonicalId()),this.endAt&&(t+="|ub:",t+=this.endAt.canonicalId()),this.me=t}return this.me},qo.prototype.toString=function(){var t=this.path.K();return null!==this.collectionGroup&&(t+=" collectionGroup="+this.collectionGroup),0<this.filters.length&&(t+=", filters: ["+this.filters.join(", ")+"]"),Ni(this.limit)||(t+=", limit: "+this.limit),0<this.orderBy.length&&(t+=", orderBy: ["+this.orderBy.join(", ")+"]"),this.startAt&&(t+=", startAt: "+this.startAt.canonicalId()),this.endAt&&(t+=", endAt: "+this.endAt.canonicalId()),"Target("+t+")"},qo.prototype.isEqual=function(t){if(this.limit!==t.limit)return!1;if(this.orderBy.length!==t.orderBy.length)return!1;for(var e=0;e<this.orderBy.length;e++)if(!this.orderBy[e].isEqual(t.orderBy[e]))return!1;if(this.filters.length!==t.filters.length)return!1;for(var n=0;n<this.filters.length;n++)if(!this.filters[n].isEqual(t.filters[n]))return!1;return this.collectionGroup===t.collectionGroup&&!!this.path.isEqual(t.path)&&!!(null!==this.startAt?this.startAt.isEqual(t.startAt):null===t.startAt)&&(null!==this.endAt?this.endAt.isEqual(t.endAt):null===t.endAt)},qo.prototype.Pe=function(){return si.st(this.path)&&null===this.collectionGroup&&0===this.filters.length},qo),Vo=(Uo.ve=function(t){return new Uo(t)},Object.defineProperty(Uo.prototype,"orderBy",{get:function(){if(null===this.pe){var t=this.Se(),e=this.De();if(null!==t&&null===e)t.J()?this.pe=[gs]:this.pe=[new vs(t),gs];else{for(var n=!(this.pe=[]),r=0,i=this.Ve;r<i.length;r++){var o=i[r];this.pe.push(o),o.field.J()&&(n=!0)}if(!n){var s=0<this.Ve.length?this.Ve[this.Ve.length-1].dir:is.ASCENDING;this.pe.push(s===is.ASCENDING?gs:ms)}}}return this.pe},enumerable:!0,configurable:!0}),Uo.prototype.Ce=function(t){var e=this.filters.concat([t]);return new Uo(this.path,this.collectionGroup,this.Ve.slice(),e,this.limit,this.ge,this.startAt,this.endAt)},Uo.prototype.Fe=function(t){var e=this.Ve.concat([t]);return new Uo(this.path,this.collectionGroup,e,this.filters.slice(),this.limit,this.ge,this.startAt,this.endAt)},Uo.prototype.Ne=function(t){return new Uo(this.path,this.collectionGroup,this.Ve.slice(),this.filters.slice(),t,"F",this.startAt,this.endAt)},Uo.prototype.ke=function(t){return new Uo(this.path,this.collectionGroup,this.Ve.slice(),this.filters.slice(),t,"L",this.startAt,this.endAt)},Uo.prototype.$e=function(t){return new Uo(this.path,this.collectionGroup,this.Ve.slice(),this.filters.slice(),this.limit,this.ge,t,this.endAt)},Uo.prototype.Me=function(t){return new Uo(this.path,this.collectionGroup,this.Ve.slice(),this.filters.slice(),this.limit,this.ge,this.startAt,t)},Uo.prototype.Le=function(t){return new Uo(t,null,this.Ve.slice(),this.filters.slice(),this.limit,this.ge,this.startAt,this.endAt)},Uo.prototype.Oe=function(){return 0===this.filters.length&&null===this.limit&&null==this.startAt&&null==this.endAt&&(0===this.Ve.length||1===this.Ve.length&&this.Ve[0].field.J())},Uo.prototype.canonicalId=function(){return this.xe().canonicalId()+"|lt:"+this.ge},Uo.prototype.toString=function(){return"Query(target="+this.xe().toString()+"; limitType="+this.ge+")"},Uo.prototype.isEqual=function(t){return this.xe().isEqual(t.xe())&&this.ge===t.ge},Uo.prototype.Be=function(t,e){for(var n=!1,r=0,i=this.orderBy;r<i.length;r++){var o=i[r],s=o.compare(t,e);if(0!==s)return s;n=n||o.field.J()}return 0},Uo.prototype.matches=function(t){return this.qe(t)&&this.Ue(t)&&this.Qe(t)&&this.We(t)},Uo.prototype.je=function(){return!Ni(this.limit)&&"F"===this.ge},Uo.prototype.Ke=function(){return!Ni(this.limit)&&"L"===this.ge},Uo.prototype.De=function(){return 0<this.Ve.length?this.Ve[0].field:null},Uo.prototype.Se=function(){for(var t=0,e=this.filters;t<e.length;t++){var n=e[t];if(n instanceof Jo&&n.Ge())return n.field}return null},Uo.prototype.ze=function(t){for(var e=0,n=this.filters;e<n.length;e++){var r=n[e];if(r instanceof Jo&&0<=t.indexOf(r.op))return r.op}return null},Uo.prototype.Pe=function(){return this.xe().Pe()},Uo.prototype.He=function(){return null!==this.collectionGroup},Uo.prototype.xe=function(){if(!this.ye)if("F"===this.ge)this.ye=new Co(this.path,this.collectionGroup,this.orderBy,this.filters,this.limit,this.startAt,this.endAt);else{for(var t=[],e=0,n=this.orderBy;e<n.length;e++){var r=n[e],i=r.dir===is.DESCENDING?is.ASCENDING:is.DESCENDING;t.push(new vs(r.field,i))}var o=this.endAt?new ys(this.endAt.position,!this.endAt.before):null,s=this.startAt?new ys(this.startAt.position,!this.startAt.before):null;this.ye=new Co(this.path,this.collectionGroup,t,this.filters,this.limit,o,s)}return this.ye},Uo.prototype.qe=function(t){var e=t.key.path;return null!==this.collectionGroup?t.key.et(this.collectionGroup)&&this.path.U(e):si.st(this.path)?this.path.isEqual(e):this.path.W(e)},Uo.prototype.Ue=function(t){for(var e=0,n=this.Ve;e<n.length;e++){var r=n[e];if(!r.field.J()&&null===t.field(r.field))return!1}return!0},Uo.prototype.Qe=function(t){for(var e=0,n=this.filters;e<n.length;e++)if(!n[e].matches(t))return!1;return!0},Uo.prototype.We=function(t){return!(this.startAt&&!this.startAt.Ye(this.orderBy,t)||this.endAt&&this.endAt.Ye(this.orderBy,t))},Uo.prototype.be=function(t){},Uo),jo=(Mo.G=function(t){switch(t){case"<":return Mo.LESS_THAN;case"<=":return Mo.LESS_THAN_OR_EQUAL;case"==":return Mo.EQUAL;case">=":return Mo.GREATER_THAN_OR_EQUAL;case">":return Mo.GREATER_THAN;case"array-contains":return Mo.ARRAY_CONTAINS;case"in":return Mo.IN;case"array-contains-any":return Mo.ARRAY_CONTAINS_ANY;default:return vu()}},Mo.prototype.toString=function(){return this.name},Mo.prototype.isEqual=function(t){return this.name===t.name},Mo);function Mo(t){this.name=t}function Uo(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.Ve=n,this.filters=r,this.limit=i,this.ge=o,this.startAt=s,this.endAt=u,this.pe=null,this.ye=null,this.startAt&&this.be(this.startAt),this.endAt&&this.be(this.endAt)}function qo(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.me=null}function Fo(){return null!==So&&So.apply(this,arguments)||this}function Go(t,e,n){var r=this;return(r=Do.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function Bo(t,e,n,r){var i=this;return(i=ko.call(this,t,e)||this).we=n,i.te=!!r.te,i.hasCommittedMutations=!!r.hasCommittedMutations,i}function zo(t,e){this.key=t,this.version=e}function Ko(t){this.de=t,this.fe=new Map}jo.LESS_THAN=new jo("<"),jo.LESS_THAN_OR_EQUAL=new jo("<="),jo.EQUAL=new jo("=="),jo.GREATER_THAN=new jo(">"),jo.GREATER_THAN_OR_EQUAL=new jo(">="),jo.ARRAY_CONTAINS=new jo("array-contains"),jo.IN=new jo("in"),jo.ARRAY_CONTAINS_ANY=new jo("array-contains-any");var Yo,Ho,Wo,Qo,Zo,Xo,Jo=(n(fs,Xo=function(){}),fs.create=function(t,e,n){if(t.J())return e===jo.IN?new ts(t,n):new $o(t,e,n);if(Gi(n)){if(e!==jo.EQUAL)throw new jr(Vr.INVALID_ARGUMENT,"Invalid query. Null supports only equality comparisons.");return new fs(t,e,n)}if(Bi(n)){if(e!==jo.EQUAL)throw new jr(Vr.INVALID_ARGUMENT,"Invalid query. NaN supports only equality comparisons.");return new fs(t,e,n)}return e===jo.ARRAY_CONTAINS?new es(t,n):e===jo.IN?new ns(t,n):e===jo.ARRAY_CONTAINS_ANY?new rs(t,n):new fs(t,e,n)},fs.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&Ri(this.value)===Ri(e)&&this.Je(Li(e,this.value))},fs.prototype.Je=function(t){switch(this.op){case jo.LESS_THAN:return t<0;case jo.LESS_THAN_OR_EQUAL:return t<=0;case jo.EQUAL:return 0===t;case jo.GREATER_THAN:return 0<t;case jo.GREATER_THAN_OR_EQUAL:return 0<=t;default:return vu()}},fs.prototype.Ge=function(){return 0<=[jo.LESS_THAN,jo.LESS_THAN_OR_EQUAL,jo.GREATER_THAN,jo.GREATER_THAN_OR_EQUAL].indexOf(this.op)},fs.prototype.canonicalId=function(){return this.field.K()+this.op.toString()+Ci(this.value)},fs.prototype.isEqual=function(t){return t instanceof fs&&this.op.isEqual(t.op)&&this.field.isEqual(t.field)&&xi(this.value,t.value)},fs.prototype.toString=function(){return this.field.K()+" "+this.op+" "+Ci(this.value)},fs),$o=(n(cs,Zo=Jo),cs.prototype.matches=function(t){var e=si.k(t.key,this.key);return this.Je(e)},cs),ts=(n(hs,Qo=Jo),hs.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},hs),es=(n(as,Wo=Jo),as.prototype.matches=function(t){var e=t.field(this.field);return Fi(e)&&Oi(e.arrayValue,this.value)},as),ns=(n(us,Ho=Jo),us.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&Oi(this.value.arrayValue,e)},us),rs=(n(ss,Yo=Jo),ss.prototype.matches=function(t){var e=this,n=t.field(this.field);return!(!Fi(n)||!n.arrayValue.values)&&n.arrayValue.values.some(function(t){return Oi(e.value.arrayValue,t)})},ss),is=(os.prototype.toString=function(){return this.name},os);function os(t){this.name=t}function ss(t,e){return Yo.call(this,t,jo.ARRAY_CONTAINS_ANY,e)||this}function us(t,e){return Ho.call(this,t,jo.IN,e)||this}function as(t,e){return Wo.call(this,t,jo.ARRAY_CONTAINS,e)||this}function hs(t,e){var n=this;return(n=Qo.call(this,t,jo.IN,e)||this).keys=(e.arrayValue.values||[]).map(function(t){return si.tt(t.referenceValue)}),n}function cs(t,e,n){var r=this;return(r=Zo.call(this,t,e,n)||this).key=si.tt(n.referenceValue),r}function fs(t,e,n){var r=this;return(r=Xo.call(this)||this).field=t,r.op=e,r.value=n,r}function ls(t){this.count=t}is.ASCENDING=new is("asc"),is.DESCENDING=new is("desc");var ps,ds,ys=(Ts.prototype.canonicalId=function(){return(this.before?"b":"a")+":"+this.position.map(function(t){return Ci(t)}).join(",")},Ts.prototype.Ye=function(t,e){for(var n=0,r=0;r<this.position.length;r++){var i=t[r],o=this.position[r];if(n=i.field.J()?si.k(si.tt(o.referenceValue),e.key):Li(o,e.field(i.field)),i.dir===is.DESCENDING&&(n*=-1),0!==n)break}return this.before?n<=0:n<0},Ts.prototype.isEqual=function(t){if(null===t)return!1;if(this.before!==t.before||this.position.length!==t.position.length)return!1;for(var e=0;e<this.position.length;e++)if(!xi(this.position[e],t.position[e]))return!1;return!0},Ts),vs=(bs.prototype.compare=function(t,e){var n=this.Xe?Oo.Ie(t,e):Oo.Ae(this.field,t,e);switch(this.dir){case is.ASCENDING:return n;case is.DESCENDING:return-1*n;default:return vu()}},bs.prototype.canonicalId=function(){return this.field.K()+this.dir.toString()},bs.prototype.toString=function(){return this.field.K()+" ("+this.dir+")"},bs.prototype.isEqual=function(t){return this.dir===t.dir&&this.field.isEqual(t.field)},bs),gs=new vs(ii.X(),is.ASCENDING),ms=new vs(ii.X(),is.DESCENDING),Es=(ws.prototype.es=function(t){return new ws(this.target,this.targetId,this.Ze,t,this.ts,this.lastLimboFreeSnapshotVersion,this.resumeToken)},ws.prototype.ss=function(t,e){return new ws(this.target,this.targetId,this.Ze,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},ws.prototype.ns=function(t){return new ws(this.target,this.targetId,this.Ze,this.sequenceNumber,this.ts,t,this.resumeToken)},ws);function ws(t,e,n,r,i,o,s){void 0===i&&(i=Br.MIN),void 0===o&&(o=Br.MIN),void 0===s&&(s=Ti.xt),this.target=t,this.targetId=e,this.Ze=n,this.sequenceNumber=r,this.ts=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function bs(t,e){this.field=t,void 0===e&&(e=is.ASCENDING),this.dir=e,this.Xe=t.J()}function Ts(t,e){this.position=t,this.before=e}function Is(t){switch(t){case Vr.OK:return vu();case Vr.CANCELLED:case Vr.UNKNOWN:case Vr.DEADLINE_EXCEEDED:case Vr.RESOURCE_EXHAUSTED:case Vr.INTERNAL:case Vr.UNAVAILABLE:case Vr.UNAUTHENTICATED:return;case Vr.INVALID_ARGUMENT:case Vr.NOT_FOUND:case Vr.ALREADY_EXISTS:case Vr.PERMISSION_DENIED:case Vr.FAILED_PRECONDITION:case Vr.ABORTED:case Vr.OUT_OF_RANGE:case Vr.UNIMPLEMENTED:case Vr.DATA_LOSS:return 1;default:return vu()}}function Ns(t){if(void 0===t)return du("GRPC error has no .code"),Vr.UNKNOWN;switch(t){case ps.OK:return Vr.OK;case ps.CANCELLED:return Vr.CANCELLED;case ps.UNKNOWN:return Vr.UNKNOWN;case ps.DEADLINE_EXCEEDED:return Vr.DEADLINE_EXCEEDED;case ps.RESOURCE_EXHAUSTED:return Vr.RESOURCE_EXHAUSTED;case ps.INTERNAL:return Vr.INTERNAL;case ps.UNAVAILABLE:return Vr.UNAVAILABLE;case ps.UNAUTHENTICATED:return Vr.UNAUTHENTICATED;case ps.INVALID_ARGUMENT:return Vr.INVALID_ARGUMENT;case ps.NOT_FOUND:return Vr.NOT_FOUND;case ps.ALREADY_EXISTS:return Vr.ALREADY_EXISTS;case ps.PERMISSION_DENIED:return Vr.PERMISSION_DENIED;case ps.FAILED_PRECONDITION:return Vr.FAILED_PRECONDITION;case ps.ABORTED:return Vr.ABORTED;case ps.OUT_OF_RANGE:return Vr.OUT_OF_RANGE;case ps.UNIMPLEMENTED:return Vr.UNIMPLEMENTED;case ps.DATA_LOSS:return Vr.DATA_LOSS;default:return vu()}}(ds=ps=ps||{})[ds.OK=0]="OK",ds[ds.CANCELLED=1]="CANCELLED",ds[ds.UNKNOWN=2]="UNKNOWN",ds[ds.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ds[ds.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ds[ds.NOT_FOUND=5]="NOT_FOUND",ds[ds.ALREADY_EXISTS=6]="ALREADY_EXISTS",ds[ds.PERMISSION_DENIED=7]="PERMISSION_DENIED",ds[ds.UNAUTHENTICATED=16]="UNAUTHENTICATED",ds[ds.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ds[ds.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ds[ds.ABORTED=10]="ABORTED",ds[ds.OUT_OF_RANGE=11]="OUT_OF_RANGE",ds[ds.UNIMPLEMENTED=12]="UNIMPLEMENTED",ds[ds.INTERNAL=13]="INTERNAL",ds[ds.UNAVAILABLE=14]="UNAVAILABLE",ds[ds.DATA_LOSS=15]="DATA_LOSS";var _s=new ai(si.k);function As(){return _s}function Ss(){return As()}var Ds=new ai(si.k);function ks(){return Ds}var Rs=new ai(si.k);function xs(){return Rs}var Os=new yi(si.k);function Ls(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Os,r=0,i=t;r<i.length;r++){var o=i[r];n=n.add(o)}return n}var Ps=new yi(wu);function Cs(){return Ps}function Vs(t,e,n,r){this.ps=t,this.removedTargetIds=e,this.key=n,this.ys=r}function js(t,e){this.targetId=t,this.bs=e}function Ms(t,e,n,r){void 0===n&&(n=Ti.xt),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r}var Us=(Js.os=function(t){return new Js(t.k)},Js.prototype.has=function(t){return null!=this.rs.get(t)},Js.prototype.get=function(t){return this.rs.get(t)},Js.prototype.first=function(){return this.hs.ot()},Js.prototype.last=function(){return this.hs.at()},Js.prototype.q=function(){return this.hs.q()},Js.prototype.indexOf=function(t){var e=this.rs.get(t);return e?this.hs.indexOf(e):-1},Object.defineProperty(Js.prototype,"size",{get:function(){return this.hs.size},enumerable:!0,configurable:!0}),Js.prototype.forEach=function(n){this.hs.ut(function(t,e){return n(t),!1})},Js.prototype.add=function(t){var e=this.delete(t.key);return e.rt(e.rs.nt(t.key,t),e.hs.nt(t,null))},Js.prototype.delete=function(t){var e=this.get(t);return e?this.rt(this.rs.remove(t),this.hs.remove(e)):this},Js.prototype.isEqual=function(t){if(!(t instanceof Js))return!1;if(this.size!==t.size)return!1;for(var e=this.hs._t(),n=t.hs._t();e.wt();){var r=e.It().key,i=n.It().key;if(!r.isEqual(i))return!1}return!0},Js.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},Js.prototype.rt=function(t,e){var n=new Js;return n.k=this.k,n.rs=t,n.hs=e,n},Js),qs=(Xs.prototype.track=function(t){var e=t.doc.key,n=this.as.get(e);!n||0!==t.type&&3===n.type?this.as=this.as.nt(e,t):3===t.type&&1!==n.type?this.as=this.as.nt(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.as=this.as.nt(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.as=this.as.nt(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.as=this.as.remove(e):1===t.type&&2===n.type?this.as=this.as.nt(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.as=this.as.nt(e,{type:2,doc:t.doc}):vu()},Xs.prototype.us=function(){var n=[];return this.as.ut(function(t,e){n.push(e)}),n},Xs),Fs=(Zs.fs=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:0,doc:t})}),new Zs(t,e,Us.os(e),i,n,r,!0,!1)},Object.defineProperty(Zs.prototype,"hasPendingWrites",{get:function(){return!this._s.q()},enumerable:!0,configurable:!0}),Zs.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.ls===t.ls&&this._s.isEqual(t._s)&&this.query.isEqual(t.query)&&this.docs.isEqual(t.docs)&&this.cs.isEqual(t.cs)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},Zs),Gs=(Qs.Rs=function(t,e){var n=new Map;return n.set(t,Bs.As(t,e)),new Qs(Br.MIN,n,Cs(),As(),Ls())},Qs),Bs=(Ws.As=function(t,e){return new Ws(Ti.xt,e,Ls(),Ls(),Ls())},Ws),zs=(Object.defineProperty(Hs.prototype,"ms",{get:function(){return this.Cs},enumerable:!0,configurable:!0}),Object.defineProperty(Hs.prototype,"resumeToken",{get:function(){return this.Ds},enumerable:!0,configurable:!0}),Object.defineProperty(Hs.prototype,"Ns",{get:function(){return 0!==this.vs},enumerable:!0,configurable:!0}),Object.defineProperty(Hs.prototype,"ks",{get:function(){return this.Fs},enumerable:!0,configurable:!0}),Hs.prototype.$s=function(t){0<t.Ot()&&(this.Fs=!0,this.Ds=t)},Hs.prototype.Ms=function(){var n=Ls(),r=Ls(),i=Ls();return this.Ss.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:r=r.add(t);break;case 1:i=i.add(t);break;default:vu()}}),new Bs(this.Ds,this.Cs,n,r,i)},Hs.prototype.Ls=function(){this.Fs=!1,this.Ss=tu()},Hs.prototype.Os=function(t,e){this.Fs=!0,this.Ss=this.Ss.nt(t,e)},Hs.prototype.xs=function(t){this.Fs=!0,this.Ss=this.Ss.remove(t)},Hs.prototype.Bs=function(){this.vs+=1},Hs.prototype.qs=function(){--this.vs},Hs.prototype.Us=function(){this.Fs=!0,this.Cs=!0},Hs),Ks=(Ys.prototype.zs=function(t){for(var e=0,n=t.ps;e<n.length;e++){var r=n[e];t.ys instanceof Oo?this.Hs(r,t.ys):t.ys instanceof Lo&&this.Ys(r,t.key,t.ys)}for(var i=0,o=t.removedTargetIds;i<o.length;i++){var s=o[i];this.Ys(s,t.key,t.ys)}},Ys.prototype.Js=function(n){var r=this;this.Xs(n,function(t){var e=r.Zs(t);switch(n.state){case 0:r.ti(t)&&e.$s(n.resumeToken);break;case 1:e.qs(),e.Ns||e.Ls(),e.$s(n.resumeToken);break;case 2:e.qs(),e.Ns||r.removeTarget(t);break;case 3:r.ti(t)&&(e.Us(),e.$s(n.resumeToken));break;case 4:r.ti(t)&&(r.ei(t),e.$s(n.resumeToken));break;default:vu()}})},Ys.prototype.Xs=function(t,n){var r=this;0<t.targetIds.length?t.targetIds.forEach(n):this.Ws.forEach(function(t,e){r.ti(e)&&n(e)})},Ys.prototype.si=function(t){var e=t.targetId,n=t.bs.count,r=this.ii(e);if(r){var i=r.target;if(i.Pe())if(0===n){var o=new si(i.path);this.Ys(e,o,new Lo(o,Br.S()))}else gu(1===n);else this.ni(e)!==n&&(this.ei(e),this.Gs=this.Gs.add(e))}},Ys.prototype.ri=function(i){var o=this,s=new Map;this.Ws.forEach(function(t,e){var n=o.ii(e);if(n){if(t.ms&&n.target.Pe()){var r=new si(n.target.path);null!==o.js.get(r)||o.hi(e,r)||o.Ys(e,r,new Lo(r,i))}t.ks&&(s.set(e,t.Ms()),t.Ls())}});var r=Ls();this.Ks.forEach(function(t,e){var n=!0;e.Ft(function(t){var e=o.ii(t);return!e||2===e.Ze||(n=!1)}),n&&(r=r.add(t))});var t=new Gs(i,s,this.Gs,this.js,r);return this.js=As(),this.Ks=$s(),this.Gs=new yi(wu),t},Ys.prototype.Hs=function(t,e){if(this.ti(t)){var n=this.hi(t,e.key)?2:0;this.Zs(t).Os(e.key,n),this.js=this.js.nt(e.key,e),this.Ks=this.Ks.nt(e.key,this.oi(e.key).add(t))}},Ys.prototype.Ys=function(t,e,n){if(this.ti(t)){var r=this.Zs(t);this.hi(t,e)?r.Os(e,1):r.xs(e),this.Ks=this.Ks.nt(e,this.oi(e).delete(t)),n&&(this.js=this.js.nt(e,n))}},Ys.prototype.removeTarget=function(t){this.Ws.delete(t)},Ys.prototype.ni=function(t){var e=this.Zs(t).Ms();return this.Qs.ai(t).size+e.Ps.size-e.gs.size},Ys.prototype.Bs=function(t){this.Zs(t).Bs()},Ys.prototype.Zs=function(t){var e=this.Ws.get(t);return e||(e=new zs,this.Ws.set(t,e)),e},Ys.prototype.oi=function(t){var e=this.Ks.get(t);return e||(e=new yi(wu),this.Ks=this.Ks.nt(t,e)),e},Ys.prototype.ti=function(t){var e=null!==this.ii(t);return e||pu("WatchChangeAggregator","Detected inactive target",t),e},Ys.prototype.ii=function(t){var e=this.Ws.get(t);return e&&e.Ns?null:this.Qs.ui(t)},Ys.prototype.ei=function(e){var n=this;this.Ws.set(e,new zs),this.Qs.ai(e).forEach(function(t){n.Ys(e,t,null)})},Ys.prototype.hi=function(t,e){return this.Qs.ai(t).has(e)},Ys);function Ys(t){this.Qs=t,this.Ws=new Map,this.js=As(),this.Ks=$s(),this.Gs=new yi(wu)}function Hs(){this.vs=0,this.Ss=tu(),this.Ds=Ti.xt,this.Cs=!1,this.Fs=!0}function Ws(t,e,n,r,i){this.resumeToken=t,this.ms=e,this.Ps=n,this.Vs=r,this.gs=i}function Qs(t,e,n,r,i){this.ts=t,this.Ts=e,this.Es=n,this.Is=r,this.ws=i}function Zs(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.cs=n,this.docChanges=r,this._s=i,this.fromCache=o,this.ls=s,this.ds=u}function Xs(){this.as=new ai(si.k)}function Js(n){this.k=n?function(t,e){return n(t,e)||si.k(t.key,e.key)}:function(t,e){return si.k(t.key,e.key)},this.rs=ks(),this.hs=new ai(this.k)}function $s(){return new ai(si.k)}function tu(){return new ai(si.k)}var eu,nu,ru=((nu={})[is.ASCENDING.name]="ASCENDING",nu[is.DESCENDING.name]="DESCENDING",nu),iu=((eu={})[jo.LESS_THAN.name]="LESS_THAN",eu[jo.LESS_THAN_OR_EQUAL.name]="LESS_THAN_OR_EQUAL",eu[jo.GREATER_THAN.name]="GREATER_THAN",eu[jo.GREATER_THAN_OR_EQUAL.name]="GREATER_THAN_OR_EQUAL",eu[jo.EQUAL.name]="EQUAL",eu[jo.ARRAY_CONTAINS.name]="ARRAY_CONTAINS",eu[jo.IN.name]="IN",eu[jo.ARRAY_CONTAINS_ANY.name]="ARRAY_CONTAINS_ANY",eu),ou=(su.prototype._i=function(t){var e=void 0===t.code?Vr.UNKNOWN:Ns(t.code);return new jr(e,t.message||"")},su.prototype.li=function(t){return this.options.di||Ni(t)?t:{value:t}},su.prototype.fi=function(t){var e;return Ni(e="object"==typeof t?t.value:t)?null:e},su.prototype.Wt=function(t){return{integerValue:""+t}},su.prototype.jt=function(t){if(this.options.di){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:_i(t)?"-0":t}},su.prototype.Ti=function(t){return Ai(t)?this.Wt(t):this.jt(t)},su.prototype.F=function(t){return this.options.di?new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+t.nanoseconds).slice(-9)+"Z":{seconds:""+t.seconds,nanos:t.nanoseconds}},su.prototype.v=function(t){var e=Vi(t);return new Gr(e.seconds,e.nanos)},su.prototype.Ei=function(t){return this.options.di?t.toBase64():t.toUint8Array()},su.prototype.Ii=function(t){return this.options.di?(gu(void 0===t||"string"==typeof t),Ti.fromBase64String(t||"")):(gu(void 0===t||t instanceof Uint8Array),Ti.fromUint8Array(t||new Uint8Array))},su.prototype.toVersion=function(t){return this.F(t.F())},su.prototype.fromVersion=function(t){return gu(!!t),Br.v(this.v(t))},su.prototype.wi=function(t,e){return this.Ri(e||this.ci).child("documents").child(t).K()},su.prototype.Ai=function(t){var e=$r.G(t);return gu(uu(e)),e},su.prototype.mi=function(t){return this.wi(t.path)},su.prototype.tt=function(t){var e=this.Ai(t);return gu(e.get(1)===this.ci.projectId),gu(!e.get(3)&&!this.ci.database||e.get(3)===this.ci.database),new si(this.Pi(e))},su.prototype.Vi=function(t){return this.wi(t)},su.prototype.gi=function(t){var e=this.Ai(t);return 4===e.length?$r.H:this.Pi(e)},Object.defineProperty(su.prototype,"pi",{get:function(){return new $r(["projects",this.ci.projectId,"databases",this.ci.database]).K()},enumerable:!0,configurable:!0}),su.prototype.Ri=function(t){return new $r(["projects",t.projectId,"databases",t.database])},su.prototype.Pi=function(t){return gu(4<t.length&&"documents"===t.get(4)),t.M(5)},su.prototype.yi=function(t,e){return{name:this.mi(t),fields:e.proto.mapValue.fields}},su.prototype.bi=function(t){return{name:this.mi(t.key),fields:t.Re().mapValue.fields,updateTime:this.F(t.version.F())}},su.prototype.vi=function(t,e){var n=this.tt(t.name),r=this.fromVersion(t.updateTime),i=new Eo({mapValue:{fields:t.fields}});return new Oo(n,r,i,{hasCommittedMutations:!!e})},su.prototype.Si=function(t){gu(!!t.found),t.found.name,t.found.updateTime;var e=this.tt(t.found.name),n=this.fromVersion(t.found.updateTime),r=new Eo({mapValue:{fields:t.found.fields}});return new Oo(e,n,r,{})},su.prototype.Di=function(t){gu(!!t.missing),gu(!!t.readTime);var e=this.tt(t.missing),n=this.fromVersion(t.readTime);return new Lo(e,n)},su.prototype.Ci=function(t){return"found"in t?this.Si(t):"missing"in t?this.Di(t):vu()},su.prototype.Fi=function(t){var e;if("targetChange"in t){t.targetChange;var n=this.Ni(t.targetChange.targetChangeType||"NO_CHANGE"),r=t.targetChange.targetIds||[],i=this.Ii(t.targetChange.resumeToken),o=t.targetChange.cause;e=new Ms(n,r,i,o&&this._i(o)||null)}else if("documentChange"in t){t.documentChange;var s=t.documentChange;s.document,s.document.name,s.document.updateTime;var u=this.tt(s.document.name),a=this.fromVersion(s.document.updateTime),h=new Eo({mapValue:{fields:s.document.fields}}),c=new Oo(u,a,h,{});e=new Vs(s.targetIds||[],s.removedTargetIds||[],c.key,c)}else if("documentDelete"in t){t.documentDelete;var f=t.documentDelete;f.document;var l=this.tt(f.document),p=f.readTime?this.fromVersion(f.readTime):Br.S(),d=new Lo(l,p);e=new Vs([],f.removedTargetIds||[],d.key,d)}else if("documentRemove"in t){t.documentRemove;var y=t.documentRemove;y.document;var v=this.tt(y.document);e=new Vs([],y.removedTargetIds||[],v,null)}else{if(!("filter"in t))return vu();t.filter;var g=t.filter;g.targetId;var m=new ls(g.count||0);e=new js(g.targetId,m)}return e},su.prototype.Ni=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:vu()},su.prototype.ki=function(t){if(!("targetChange"in t))return Br.MIN;var e=t.targetChange;return e.targetIds&&e.targetIds.length||!e.readTime?Br.MIN:this.fromVersion(e.readTime)},su.prototype.$i=function(t){var e,n=this;if(t instanceof po)e={update:this.yi(t.key,t.value)};else if(t instanceof go)e={delete:this.mi(t.key)};else if(t instanceof yo)e={update:this.yi(t.key,t.data),updateMask:this.Mi(t.se)};else if(t instanceof vo)e={transform:{document:this.mi(t.key),fieldTransforms:t.fieldTransforms.map(function(t){return n.Li(t)})}};else{if(!(t instanceof mo))return vu();e={verify:this.mi(t.key)}}return t.Zt.Ht||(e.currentDocument=this.Oi(t.Zt)),e},su.prototype.xi=function(t){var e=this,n=t.currentDocument?this.Bi(t.currentDocument):ro.NONE;if(t.update){t.update.name;var r=this.tt(t.update.name),i=new Eo({mapValue:{fields:t.update.fields}});if(t.updateMask){var o=this.qi(t.updateMask);return new yo(r,i,o,n)}return new po(r,i,n)}if(t.delete){var s=this.tt(t.delete);return new go(s,n)}if(t.transform){var u=this.tt(t.transform.document),a=t.transform.fieldTransforms.map(function(t){return e.Ui(t)});return gu(!0===n.exists),new vo(u,a)}if(t.verify){var h=this.tt(t.verify);return new mo(h,n)}return vu()},su.prototype.Oi=function(t){return void 0!==t.updateTime?{updateTime:this.toVersion(t.updateTime)}:void 0!==t.exists?{exists:t.exists}:vu()},su.prototype.Bi=function(t){return void 0!==t.updateTime?ro.updateTime(this.fromVersion(t.updateTime)):void 0!==t.exists?ro.exists(t.exists):ro.NONE},su.prototype.Qi=function(t,e){var n=t.updateTime?this.fromVersion(t.updateTime):this.fromVersion(e);n.isEqual(Br.MIN)&&(n=this.fromVersion(e));var r=null;return t.transformResults&&0<t.transformResults.length&&(r=t.transformResults),new to(n,r)},su.prototype.Wi=function(t,e){var n=this;return t&&0<t.length?(gu(void 0!==e),t.map(function(t){return n.Qi(t,e)})):[]},su.prototype.Li=function(t){var e=t.transform;if(e instanceof Ki)return{fieldPath:t.field.K(),setToServerValue:"REQUEST_TIME"};if(e instanceof Hi)return{fieldPath:t.field.K(),appendMissingElements:{values:e.elements}};if(e instanceof Wi)return{fieldPath:t.field.K(),removeAllFromArray:{values:e.elements}};if(e instanceof Qi)return{fieldPath:t.field.K(),increment:e.Qt};throw vu()},su.prototype.Ui=function(t){var e=null;if("setToServerValue"in t)gu("REQUEST_TIME"===t.setToServerValue),e=Ki.instance;else if("appendMissingElements"in t){var n=t.appendMissingElements.values||[];e=new Hi(n)}else if("removeAllFromArray"in t){var r=t.removeAllFromArray.values||[];e=new Wi(r)}else"increment"in t?e=new Qi(this,t.increment):vu();var i=ii.Z(t.fieldPath);return new no(i,e)},su.prototype.ji=function(t){return{documents:[this.Vi(t.path)]}},su.prototype.Ki=function(t){gu(1===t.documents.length);var e=t.documents[0];return Vo.ve(this.gi(e)).xe()},su.prototype.Gi=function(t){var e={structuredQuery:{}},n=t.path;null!==t.collectionGroup?(e.parent=this.Vi(n),e.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(e.parent=this.Vi(n.L()),e.structuredQuery.from=[{collectionId:n.B()}]);var r=this.zi(t.filters);r&&(e.structuredQuery.where=r);var i=this.Hi(t.orderBy);i&&(e.structuredQuery.orderBy=i);var o=this.li(t.limit);return null!==o&&(e.structuredQuery.limit=o),t.startAt&&(e.structuredQuery.startAt=this.Yi(t.startAt)),t.endAt&&(e.structuredQuery.endAt=this.Yi(t.endAt)),e},su.prototype.Ji=function(t){var e=this.gi(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(0<r){gu(1===r);var o=n.from[0];o.allDescendants?i=o.collectionId:e=e.child(o.collectionId)}var s=[];n.where&&(s=this.Xi(n.where));var u=[];n.orderBy&&(u=this.Zi(n.orderBy));var a=null;n.limit&&(a=this.fi(n.limit));var h=null;n.startAt&&(h=this.tn(n.startAt));var c=null;return n.endAt&&(c=this.tn(n.endAt)),new Vo(e,i,u,s,a,"F",h,c).xe()},su.prototype.en=function(t){var e=this.sn(t.Ze);return null==e?null:{"goog-listen-tags":e}},su.prototype.sn=function(t){switch(t){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return vu()}},su.prototype.xe=function(t){var e,n=t.target;return(e=n.Pe()?{documents:this.ji(n)}:{query:this.Gi(n)}).targetId=t.targetId,0<t.resumeToken.Ot()&&(e.resumeToken=this.Ei(t.resumeToken)),e},su.prototype.zi=function(t){var e=this;if(0!==t.length){var n=t.map(function(t){return t instanceof Jo?e.in(t):vu()});return 1===n.length?n[0]:{compositeFilter:{op:"AND",filters:n}}}},su.prototype.Xi=function(t){var e=this;return t?void 0!==t.unaryFilter?[this.nn(t)]:void 0!==t.fieldFilter?[this.rn(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map(function(t){return e.Xi(t)}).reduce(function(t,e){return t.concat(e)}):vu():[]},su.prototype.Hi=function(t){var e=this;if(0!==t.length)return t.map(function(t){return e.hn(t)})},su.prototype.Zi=function(t){var e=this;return t.map(function(t){return e.on(t)})},su.prototype.Yi=function(t){return{before:t.before,values:t.position}},su.prototype.tn=function(t){var e=!!t.before,n=t.values||[];return new ys(n,e)},su.prototype.an=function(t){return ru[t.name]},su.prototype.un=function(t){switch(t){case"ASCENDING":return is.ASCENDING;case"DESCENDING":return is.DESCENDING;default:return}},su.prototype.cn=function(t){return iu[t.name]},su.prototype._n=function(t){switch(t){case"EQUAL":return jo.EQUAL;case"GREATER_THAN":return jo.GREATER_THAN;case"GREATER_THAN_OR_EQUAL":return jo.GREATER_THAN_OR_EQUAL;case"LESS_THAN":return jo.LESS_THAN;case"LESS_THAN_OR_EQUAL":return jo.LESS_THAN_OR_EQUAL;case"ARRAY_CONTAINS":return jo.ARRAY_CONTAINS;case"IN":return jo.IN;case"ARRAY_CONTAINS_ANY":return jo.ARRAY_CONTAINS_ANY;case"OPERATOR_UNSPECIFIED":default:return vu()}},su.prototype.ln=function(t){return{fieldPath:t.K()}},su.prototype.dn=function(t){return ii.Z(t.fieldPath)},su.prototype.hn=function(t){return{field:this.ln(t.field),direction:this.an(t.dir)}},su.prototype.on=function(t){return new vs(this.dn(t.field),this.un(t.direction))},su.prototype.rn=function(t){return Jo.create(this.dn(t.fieldFilter.field),this._n(t.fieldFilter.op),t.fieldFilter.value)},su.prototype.in=function(t){if(t.op===jo.EQUAL){if(Bi(t.value))return{unaryFilter:{field:this.ln(t.field),op:"IS_NAN"}};if(Gi(t.value))return{unaryFilter:{field:this.ln(t.field),op:"IS_NULL"}}}return{fieldFilter:{field:this.ln(t.field),op:this.cn(t.op),value:t.value}}},su.prototype.nn=function(t){switch(t.unaryFilter.op){case"IS_NAN":var e=this.dn(t.unaryFilter.field);return Jo.create(e,jo.EQUAL,{doubleValue:NaN});case"IS_NULL":var n=this.dn(t.unaryFilter.field);return Jo.create(n,jo.EQUAL,{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return vu()}},su.prototype.Mi=function(t){var e=[];return t.fields.forEach(function(t){return e.push(t.K())}),{fieldPaths:e}},su.prototype.qi=function(t){var e=(t.fieldPaths||[]).map(function(t){return ii.Z(t)});return eo.Gt(e)},su);function su(t,e){this.ci=t,this.options=e}function uu(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}var au=(cu.fn=function(t){cu.platform&&vu(),cu.platform=t},cu.Lt=function(){return cu.platform||vu(),cu.platform},cu),hu=new h("@firebase/firestore");function cu(){}function fu(){return hu.logLevel}function lu(t){hu.logLevel=t}function pu(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(hu.logLevel<=l.DEBUG){var r=e.map(yu);hu.debug.apply(hu,i(["Firestore ("+xr+"): "+t],r))}}function du(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(hu.logLevel<=l.ERROR){var r=e.map(yu);hu.error.apply(hu,i(["Firestore ("+xr+"): "+t],r))}}function yu(t){if("string"==typeof t)return t;var e=au.Lt();try{return e.Tn(t)}catch(e){return t}}function vu(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE ("+xr+") INTERNAL ASSERTION FAILED: "+t;throw du(e),new Error(e)}function gu(t){t||vu()}var mu=(Eu.En=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e="",n=0;n<20;n++)e+=t.charAt(Math.floor(Math.random()*t.length));return e},Eu);function Eu(){}function wu(t,e){return t<e?-1:e<t?1:0}function bu(t,n,r){return t.length===n.length&&t.every(function(t,e){return r(t,n[e])})}function Tu(t){return t+"\0"}function Iu(t,e,n,r,i){this.ci=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i}var Nu=(Object.defineProperty(Wu.prototype,"In",{get:function(){return"(default)"===this.database},enumerable:!0,configurable:!0}),Wu.prototype.isEqual=function(t){return t instanceof Wu&&t.projectId===this.projectId&&t.database===this.database},Wu.prototype.D=function(t){return wu(this.projectId,t.projectId)||wu(this.database,t.database)},Wu),_u=(Hu.prototype.get=function(t){var e=this.wn(t),n=this.Rn[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],u=o[1];if(s.isEqual(t))return u}},Hu.prototype.has=function(t){return void 0!==this.get(t)},Hu.prototype.set=function(t,e){var n=this.wn(t),r=this.Rn[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(r[i][0].isEqual(t))return void(r[i]=[t,e]);r.push([t,e])}else this.Rn[n]=[[t,e]]},Hu.prototype.delete=function(t){var e=this.wn(t),n=this.Rn[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(n[r][0].isEqual(t))return 1===n.length?delete this.Rn[e]:n.splice(r,1),!0;return!1},Hu.prototype.forEach=function(u){wi(this.Rn,function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],s=i[1];u(o,s)}})},Hu.prototype.q=function(){return bi(this.Rn)},Hu),Au=(Yu.prototype.qt=function(t,e,n){for(var r=n.mn,i=0;i<this.mutations.length;i++){var o=this.mutations[i];if(o.key.isEqual(t)){var s=r[i];e=o.qt(e,s)}}return e},Yu.prototype.Bt=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=i.Bt(e,e,this.An))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=a.Bt(e,o,this.An))}return e},Yu.prototype.Pn=function(n){var r=this,i=n;return this.mutations.forEach(function(t){var e=r.Bt(t.key,n.get(t.key));e&&(i=i.nt(t.key,e))}),i},Yu.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},Ls())},Yu.prototype.isEqual=function(t){return this.batchId===t.batchId&&bu(this.mutations,t.mutations,function(t,e){return t.isEqual(e)})&&bu(this.baseMutations,t.baseMutations,function(t,e){return t.isEqual(e)})},Yu),Su=(Ku.from=function(t,e,n,r){gu(t.mutations.length===n.length);for(var i=xs(),o=t.mutations,s=0;s<o.length;s++)i=i.nt(o[s].key,n[s].version);return new Ku(t,e,n,r,i)},Ku),Du=(zu.prototype.q=function(){return this.pn.q()},zu.prototype.vn=function(t,e){var n=new ku(t,e);this.pn=this.pn.add(n),this.yn=this.yn.add(n)},zu.prototype.Sn=function(t,e){var n=this;t.forEach(function(t){return n.vn(t,e)})},zu.prototype.Dn=function(t,e){this.Cn(new ku(t,e))},zu.prototype.Fn=function(t,e){var n=this;t.forEach(function(t){return n.Dn(t,e)})},zu.prototype.Nn=function(t){var e=this,n=si.EMPTY,r=new ku(n,t),i=new ku(n,t+1),o=[];return this.yn.Ct([r,i],function(t){e.Cn(t),o.push(t.key)}),o},zu.prototype.kn=function(){var e=this;this.pn.forEach(function(t){return e.Cn(t)})},zu.prototype.Cn=function(t){this.pn=this.pn.delete(t),this.yn=this.yn.delete(t)},zu.prototype.$n=function(t){var e=si.EMPTY,n=new ku(e,t),r=new ku(e,t+1),i=Ls();return this.yn.Ct([n,r],function(t){i=i.add(t.key)}),i},zu.prototype.Mn=function(t){var e=new ku(t,0),n=this.pn.Nt(e);return null!==n&&t.isEqual(n.key)},zu),ku=(Bu.Ie=function(t,e){return si.k(t.key,e.key)||wu(t.Ln,e.Ln)},Bu.bn=function(t,e){return wu(t.Ln,e.Ln)||si.k(t.key,e.key)},Bu),Ru=(Gu.prototype.catch=function(t){return this.next(void 0,t)},Gu.prototype.next=function(r,i){var o=this;return this.qn&&vu(),this.qn=!0,this.Bn?this.error?this.Un(i,this.error):this.Qn(r,this.result):new Gu(function(e,n){o.On=function(t){o.Qn(r,t).next(e,n)},o.xn=function(t){o.Un(i,t).next(e,n)}})},Gu.prototype.Wn=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},Gu.prototype.jn=function(t){try{var e=t();return e instanceof Gu?e:Gu.resolve(e)}catch(t){return Gu.reject(t)}},Gu.prototype.Qn=function(t,e){return t?this.jn(function(){return t(e)}):Gu.resolve(e)},Gu.prototype.Un=function(t,e){return t?this.jn(function(){return t(e)}):Gu.reject(e)},Gu.resolve=function(n){return new Gu(function(t,e){t(n)})},Gu.reject=function(n){return new Gu(function(t,e){e(n)})},Gu.Kn=function(t){return new Gu(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},Gu.Gn=function(t){for(var n=Gu.resolve(!1),e=function(e){n=n.next(function(t){return t?Gu.resolve(t):e()})},r=0,i=t;r<i.length;r++)e(i[r]);return n},Gu.forEach=function(t,n){var r=this,i=[];return t.forEach(function(t,e){i.push(n.call(r,t,e))}),this.Kn(i)},Gu),xu=(Object.defineProperty(Fu.prototype,"readTime",{get:function(){return this.Yn},set:function(t){this.Yn=t},enumerable:!0,configurable:!0}),Fu.prototype.Jn=function(t,e){this.Xn(),this.readTime=e,this.zn.set(t.key,t)},Fu.prototype.Zn=function(t,e){this.Xn(),e&&(this.readTime=e),this.zn.set(t,null)},Fu.prototype.tr=function(t,e){this.Xn();var n=this.zn.get(e);return void 0!==n?Ru.resolve(n):this.er(t,e)},Fu.prototype.getEntries=function(t,e){return this.sr(t,e)},Fu.prototype.apply=function(t){return this.Xn(),this.Hn=!0,this.ir(t)},Fu.prototype.Xn=function(){},Fu),Ou="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Lu=(qu.prototype.rr=function(t){this.nr.push(t)},qu.prototype.hr=function(){this.nr.forEach(function(t){return t()})},qu),Pu=(Uu.prototype.cr=function(e,n){var r=this;return this.ar._r(e,n).next(function(t){return r.lr(e,n,t)})},Uu.prototype.lr=function(t,r,i){return this.or.tr(t,r).next(function(t){for(var e=0,n=i;e<n.length;e++)t=n[e].Bt(r,t);return t})},Uu.prototype.dr=function(t,e,i){var o=Ss();return e.forEach(function(t,e){for(var n=0,r=i;n<r.length;n++)e=r[n].Bt(t,e);o=o.nt(t,e)}),o},Uu.prototype.Tr=function(e,t){var n=this;return this.or.getEntries(e,t).next(function(t){return n.Er(e,t)})},Uu.prototype.Er=function(r,i){var o=this;return this.ar.Ir(r,i).next(function(t){var e=o.dr(r,i,t),n=As();return e.forEach(function(t,e){e=e||new Lo(t,Br.S()),n=n.nt(t,e)}),n})},Uu.prototype.wr=function(t,e,n){return e.Pe()?this.Rr(t,e.path):e.He()?this.Ar(t,e,n):this.mr(t,e,n)},Uu.prototype.Rr=function(t,e){return this.cr(t,new si(e)).next(function(t){var e=ks();return t instanceof Oo&&(e=e.nt(t.key,t)),e})},Uu.prototype.Ar=function(n,r,i){var o=this,s=r.collectionGroup,u=ks();return this.ur.Pr(n,s).next(function(t){return Ru.forEach(t,function(t){var e=r.Le(t.child(s));return o.mr(n,e,i).next(function(t){t.forEach(function(t,e){u=u.nt(t,e)})})}).next(function(){return u})})},Uu.prototype.mr=function(e,n,t){var c,f,r=this;return this.or.wr(e,n,t).next(function(t){return c=t,r.ar.Vr(e,n)}).next(function(t){return f=t,r.gr(e,f,c).next(function(t){c=t;for(var e=0,n=f;e<n.length;e++)for(var r=n[e],i=0,o=r.mutations;i<o.length;i++){var s=o[i],u=s.key,a=c.get(u),h=s.Bt(a,a,r.An);c=h instanceof Oo?c.nt(u,h):c.remove(u)}})}).next(function(){return c.forEach(function(t,e){n.matches(e)||(c=c.remove(t))}),c})},Uu.prototype.gr=function(t,e,n){for(var r=Ls(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof yo&&null===n.get(a.key)&&(r=r.add(a.key))}var h=n;return this.or.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof Oo&&(h=h.nt(t,e))}),h})},Uu),Cu=(Mu.br=function(t,e){for(var n=Ls(),r=Ls(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new Mu(t,e.fromCache,n,r)},Mu),Vu=(ju.prototype.Sr=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},ju.prototype.next=function(){var t=++this.previousValue;return this.Dr&&this.Dr(t),t},ju);function ju(t,e){var n=this;this.previousValue=t,e&&(e.vr=function(t){return n.Sr(t)},this.Dr=function(t){return e.Cr(t)})}function Mu(t,e,n,r){this.targetId=t,this.fromCache=e,this.pr=n,this.yr=r}function Uu(t,e,n){this.or=t,this.ar=e,this.ur=n}function qu(){this.nr=[]}function Fu(){this.zn=new _u(function(t){return t.toString()}),this.Hn=!1}function Gu(t){var e=this;this.On=null,this.xn=null,this.result=void 0,this.error=void 0,this.Bn=!1,this.qn=!1,t(function(t){e.Bn=!0,e.result=t,e.On&&e.On(t)},function(t){e.Bn=!0,e.error=t,e.xn&&e.xn(t)})}function Bu(t,e){this.key=t,this.Ln=e}function zu(){this.pn=new yi(ku.Ie),this.yn=new yi(ku.bn)}function Ku(t,e,n,r,i){this.batch=t,this.Vn=e,this.mn=n,this.streamToken=r,this.gn=i}function Yu(t,e,n,r){this.batchId=t,this.An=e,this.baseMutations=n,this.mutations=r}function Hu(t){this.wn=t,this.Rn={}}function Wu(t,e){this.projectId=t,this.database=e||"(default)"}function Qu(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})}Vu.Fr=-1;var Zu=(ea.prototype.reset=function(){this.Or=0},ea.prototype.qr=function(){this.Or=this.Lr},ea.prototype.Ur=function(t){var e=this;this.cancel();var n=Math.floor(this.Or+this.Qr()),r=Math.max(0,Date.now()-this.Br),i=Math.max(0,n-r);0<i&&pu("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.Or+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.xr=this.Nr.Wr(this.kr,i,function(){return e.Br=Date.now(),t()}),this.Or*=this.Mr,this.Or<this.$r&&(this.Or=this.$r),this.Or>this.Lr&&(this.Or=this.Lr)},ea.prototype.cancel=function(){null!==this.xr&&(this.xr.cancel(),this.xr=null)},ea.prototype.Qr=function(){return(Math.random()-.5)*this.Or},ea),Xu=(ta.Hr=function(t,e,n,r,i){var o=new ta(t,e,Date.now()+n,r,i);return o.start(n),o},ta.prototype.start=function(t){var e=this;this.Yr=setTimeout(function(){return e.Jr()},t)},ta.prototype.Xr=function(){return this.Jr()},ta.prototype.cancel=function(t){null!==this.Yr&&(this.clearTimeout(),this.zr.reject(new jr(Vr.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},ta.prototype.Jr=function(){var e=this;this.jr.Zr(function(){return null!==e.Yr?(e.clearTimeout(),e.op().then(function(t){return e.zr.resolve(t)})):Promise.resolve()})},ta.prototype.clearTimeout=function(){null!==this.Yr&&(this.Gr(this),clearTimeout(this.Yr),this.Yr=null)},ta),Ju=(Object.defineProperty($u.prototype,"_h",{get:function(){return this.sh},enumerable:!0,configurable:!0}),$u.prototype.Zr=function(t){this.enqueue(t)},$u.prototype.lh=function(t){this.dh(),this.fh(t)},$u.prototype.Th=function(t){return this.dh(),this.fh(t)},$u.prototype.Eh=function(n){return f(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return this.dh(),this.sh?[3,2]:(this.sh=!0,(e=au.Lt().window)&&e.removeEventListener("visibilitychange",this.ah),[4,this.Th(n)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},$u.prototype.enqueue=function(t){return this.dh(),this.sh?new Promise(function(t){}):this.fh(t)},$u.prototype.Ih=function(i){var t=this;this.dh(),this.sh||(this.eh=this.eh.then(function(){var n=new Qu,r=function(){return f(t,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,i()];case 1:return t.sent(),n.resolve(),this.oh.reset(),[3,3];case 2:if("IndexedDbTransactionError"!==(e=t.sent()).name)throw n.resolve(),e;return pu("AsyncQueue","Operation failed with retryable error: "+e),this.oh.Ur(r),[3,3];case 3:return[2]}})})};return t.Zr(r),n.promise}))},$u.prototype.fh=function(t){var e=this,n=this.th.then(function(){return e.rh=!0,t().catch(function(t){throw e.nh=t,e.rh=!1,du("INTERNAL UNHANDLED ERROR: ",t.stack||t.message||""),t}).then(function(t){return e.rh=!1,t})});return this.th=n},$u.prototype.Wr=function(t,e,n){var r=this;this.dh(),-1<this.hh.indexOf(t)&&(e=0);var i=Xu.Hr(this,t,e,n,function(t){return r.wh(t)});return this.ih.push(i),i},$u.prototype.dh=function(){this.nh&&vu()},$u.prototype.Rh=function(){},$u.prototype.Ah=function(){return f(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return[4,e=this.th];case 1:t.sent(),t.label=2;case 2:if(e!==this.th)return[3,0];t.label=3;case 3:return[2]}})})},$u.prototype.mh=function(t){for(var e=0,n=this.ih;e<n.length;e++)if(n[e].kr===t)return!0;return!1},$u.prototype.uh=function(r){var i=this;return this.Ah().then(function(){i.ih.sort(function(t,e){return t.Kr-e.Kr});for(var t=0,e=i.ih;t<e.length;t++){var n=e[t];if(n.Xr(),"all"!==r&&n.kr===r)break}return i.Ah()})},$u.prototype.Ph=function(t){this.hh.push(t)},$u.prototype.wh=function(t){var e=this.ih.indexOf(t);this.ih.splice(e,1)},$u);function $u(){var t=this;this.th=Promise.resolve(),this.eh=Promise.resolve(),this.sh=!1,this.ih=[],this.nh=null,this.rh=!1,this.hh=[],this.oh=new Zu(this,"async_queue_retry"),this.ah=function(){t.uh("async_queue_retry")};var e=au.Lt().window;e&&e.addEventListener("visibilitychange",this.ah)}function ta(t,e,n,r,i){this.jr=t,this.kr=e,this.Kr=n,this.op=r,this.Gr=i,this.zr=new Qu,this.then=this.zr.promise.then.bind(this.zr.promise),this.catch=this.zr.promise.catch.bind(this.zr.promise),this.zr.promise.catch(function(t){})}function ea(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.Nr=t,this.kr=e,this.$r=n,this.Mr=r,this.Lr=i,this.Or=0,this.xr=null,this.Br=Date.now(),this.reset()}function na(t,e){var n=t[0],r=t[1],i=e[0],o=e[1],s=wu(n,i);return 0===s?wu(r,o):s}var ra=(ua.prototype.ph=function(){return++this.gh},ua.prototype.yh=function(t){var e=[t,this.ph()];if(this.buffer.size<this.Vh)this.buffer=this.buffer.add(e);else{var n=this.buffer.last();na(e,n)<0&&(this.buffer=this.buffer.delete(n).add(e))}},Object.defineProperty(ua.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!0,configurable:!0}),ua),ia={bh:!1,vh:0,Sh:0,Dh:0},oa=(sa.kh=function(t){return new sa(t,sa.$h,sa.Mh)},sa);function sa(t,e,n){this.Ch=t,this.Fh=e,this.Nh=n}function ua(t){this.Vh=t,this.buffer=new yi(na),this.gh=0}oa.Lh=-1,oa.Oh=1048576,oa.xh=41943040,oa.$h=10,oa.Mh=1e3,oa.Bh=new oa(oa.xh,oa.$h,oa.Mh),oa.DISABLED=new oa(oa.Lh,0,0);var aa=(fa.prototype.start=function(t){this.qh.Wh.Ch!==oa.Lh&&this.jh(t)},fa.prototype.stop=function(){this.Qh&&(this.Qh.cancel(),this.Qh=null)},Object.defineProperty(fa.prototype,"Kh",{get:function(){return null!==this.Qh},enumerable:!0,configurable:!0}),fa.prototype.jh=function(t){var e=this,n=this.Uh?3e5:6e4;pu("LruGarbageCollector","Garbage collection scheduled in "+n+"ms"),this.Qh=this.jr.Wr("lru_garbage_collection",n,function(){return e.Qh=null,e.Uh=!0,t.Gh(e.qh).then(function(){return e.jh(t)}).catch(zh)})},fa),ha=(ca.prototype.Hh=function(t,e){return this.zh.Yh(t).next(function(t){return Math.floor(e/100*t)})},ca.prototype.Jh=function(t,e){var n=this;if(0===e)return Ru.resolve(Vu.Fr);var r=new ra(e);return this.zh.Xs(t,function(t){return r.yh(t.sequenceNumber)}).next(function(){return n.zh.Xh(t,function(t){return r.yh(t)})}).next(function(){return r.maxValue})},ca.prototype.Zh=function(t,e,n){return this.zh.Zh(t,e,n)},ca.prototype.to=function(t,e){return this.zh.to(t,e)},ca.prototype.eo=function(e,n){var r=this;return this.Wh.Ch===oa.Lh?(pu("LruGarbageCollector","Garbage collection skipped; disabled"),Ru.resolve(ia)):this.so(e).next(function(t){return t<r.Wh.Ch?(pu("LruGarbageCollector","Garbage collection skipped; Cache size "+t+" is lower than threshold "+r.Wh.Ch),ia):r.io(e,n)})},ca.prototype.so=function(t){return this.zh.so(t)},ca.prototype.io=function(e,n){var r,i,o,s,u,a,h,c=this,f=Date.now();return this.Hh(e,this.Wh.Fh).next(function(t){return i=t>c.Wh.Nh?(pu("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+c.Wh.Nh+" from "+t),c.Wh.Nh):t,s=Date.now(),c.Jh(e,i)}).next(function(t){return r=t,u=Date.now(),c.Zh(e,r,n)}).next(function(t){return o=t,a=Date.now(),c.to(e,r)}).next(function(t){return h=Date.now(),fu()<=l.DEBUG&&pu("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(s-f)+"ms\n\tDetermined least recently used "+i+" in "+(u-s)+"ms\n\tRemoved "+o+" targets in "+(a-u)+"ms\n\tRemoved "+t+" documents in "+(h-a)+"ms\nTotal Duration: "+(h-f)+"ms"),Ru.resolve({bh:!0,vh:i,Sh:o,Dh:t})})},ca);function ca(t,e){this.zh=t,this.Wh=e}function fa(t,e){this.qh=t,this.jr=e,this.Uh=!1,this.Qh=null}function la(t){for(var e="",n=0;n<t.length;n++)0<e.length&&(e=da(e)),e=pa(t.get(n),e);return da(e)}function pa(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="";break;case"":n+="";break;default:n+=o}}return n}function da(t){return t+""}function ya(t){var e=t.length;if(gu(2<=e),2===e)return gu(""===t.charAt(0)&&""===t.charAt(1)),$r.H;for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("",o);switch((s<0||n<s)&&vu(),t.charAt(s+1)){case"":var u=t.substring(o,s),a=void 0;0===i.length?a=u:(a=i+=u,i=""),r.push(a);break;case"":i+=t.substring(o,s),i+="\0";break;case"":i+=t.substring(o,s+1);break;default:vu()}o=s+2}return new $r(r)}var va,ga=(Aa.ro=function(o,t,s){return pu("SimpleDb","Opening database:",o),new Ru(function(n,r){var i=window.indexedDB.open(o,t);i.onsuccess=function(t){var e=t.target.result;n(new Aa(e))},i.onblocked=function(){r(new jr(Vr.FAILED_PRECONDITION,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(t){var e=t.target.error;"VersionError"===e.name?r(new jr(Vr.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):r(e)},i.onupgradeneeded=function(t){pu("SimpleDb",'Database "'+o+'" requires upgrade from version:',t.oldVersion);var e=t.target.result;s.createOrUpgrade(e,i.transaction,t.oldVersion,nh).next(function(){pu("SimpleDb","Database upgrade to version "+nh+" complete")})}}).Wn()},Aa.delete=function(t){return pu("SimpleDb","Removing database:",t),Sa(window.indexedDB.deleteDatabase(t)).Wn()},Aa.ho=function(){if("undefined"==typeof window||null==window.indexedDB)return!1;if(Aa.oo())return!0;if(void 0===window.navigator)return!1;var t=p(),e=Aa.no(t),n=0<e&&e<10,r=Aa.ao(t),i=0<r&&r<4.5;return!(0<t.indexOf("MSIE ")||0<t.indexOf("Trident/")||0<t.indexOf("Edge/")||n||i)},Aa.oo=function(){var t;return"undefined"!=typeof __PRIVATE_process&&"YES"===(null===(t=__PRIVATE_process.__PRIVATE_env)||void 0===t?void 0:t.uo)},Aa.co=function(t,e){return t.store(e)},Aa.no=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},Aa.ao=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},Aa.prototype._o=function(e){this.db.onversionchange=function(t){return e(t)}},Aa.prototype.runTransaction=function(r,h,c){return f(this,void 0,void 0,function(){var s,u,e,a,n;return y(this,function(t){switch(t.label){case 0:s="readonly"===r,u=0,e=function(){var e,n,r,i,o;return y(this,function(t){switch(t.label){case 0:++u,e=wa.open(a.db,s?"readonly":"readwrite",h),t.label=1;case 1:return t.trys.push([1,3,,4]),n=c(e).catch(function(t){return e.abort(t),Ru.reject(t)}).Wn(),r={},n.catch(function(){}),[4,e.lo];case 2:return[2,(r.value=(t.sent(),n),r)];case 3:return i=t.sent(),o="FirebaseError"!==i.name&&u<3,pu("SimpleDb","Transaction failed with error: %s. Retrying: %s.",i.message,o),o?[3,4]:[2,{value:Promise.reject(i)}];case 4:return[2]}})},a=this,t.label=1;case 1:return[5,e()];case 2:if("object"==typeof(n=t.sent()))return[2,n.value];t.label=3;case 3:return[3,1];case 4:return[2]}})})},Aa.prototype.close=function(){this.db.close()},Aa),ma=(Object.defineProperty(_a.prototype,"Bn",{get:function(){return this.fo},enumerable:!0,configurable:!0}),Object.defineProperty(_a.prototype,"Eo",{get:function(){return this.To},enumerable:!0,configurable:!0}),Object.defineProperty(_a.prototype,"cursor",{set:function(t){this.do=t},enumerable:!0,configurable:!0}),_a.prototype.done=function(){this.fo=!0},_a.prototype.Io=function(t){this.To=t},_a.prototype.delete=function(){return Sa(this.do.delete())},_a),Ea=(n(Na,va=jr),Na),wa=(Ia.open=function(t,e,n){return new Ia(t.transaction(n,e))},Object.defineProperty(Ia.prototype,"lo",{get:function(){return this.wo.promise},enumerable:!0,configurable:!0}),Ia.prototype.abort=function(t){t&&this.wo.reject(t),this.aborted||(pu("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},Ia.prototype.store=function(t){var e=this.transaction.objectStore(t);return new ba(e)},Ia),ba=(Ta.prototype.put=function(t,e){return Sa(void 0!==e?(pu("SimpleDb","PUT",this.store.name,t,e),this.store.put(e,t)):(pu("SimpleDb","PUT",this.store.name,"<auto-key>",t),this.store.put(t)))},Ta.prototype.add=function(t){return pu("SimpleDb","ADD",this.store.name,t,t),Sa(this.store.add(t))},Ta.prototype.get=function(e){var n=this;return Sa(this.store.get(e)).next(function(t){return void 0===t&&(t=null),pu("SimpleDb","GET",n.store.name,e,t),t})},Ta.prototype.delete=function(t){return pu("SimpleDb","DELETE",this.store.name,t),Sa(this.store.delete(t))},Ta.prototype.count=function(){return pu("SimpleDb","COUNT",this.store.name),Sa(this.store.count())},Ta.prototype.Ro=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.Ao(n,function(t,e){r.push(e)}).next(function(){return r})},Ta.prototype.mo=function(t,e){pu("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.Po=!1;var r=this.cursor(n);return this.Ao(r,function(t,e,n){return n.delete()})},Ta.prototype.Vo=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.Ao(r,e)},Ta.prototype.po=function(i){var t=this.cursor({});return new Ru(function(n,r){t.onerror=function(t){var e=ka(t.target.error);r(e)},t.onsuccess=function(t){var e=t.target.result;e?i(e.primaryKey,e.value).next(function(t){t?e.continue():n()}):n()}})},Ta.prototype.Ao=function(t,s){var u=[];return new Ru(function(o,e){t.onerror=function(t){e(t.target.error)},t.onsuccess=function(t){var e=t.target.result;if(e){var n=new ma(e),r=s(e.primaryKey,e.value,n);if(r instanceof Ru){var i=r.catch(function(t){return n.done(),Ru.reject(t)});u.push(i)}n.Bn?o():null===n.Eo?e.continue():e.continue(n.Eo)}else o()}}).next(function(){return Ru.Kn(u)})},Ta.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},Ta.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.Po?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},Ta);function Ta(t){this.store=t}function Ia(t){var n=this;this.transaction=t,this.aborted=!1,this.wo=new Qu,this.transaction.oncomplete=function(){n.wo.resolve()},this.transaction.onabort=function(){t.error?n.wo.reject(new Ea(t.error)):n.wo.resolve()},this.transaction.onerror=function(t){var e=ka(t.target.error);n.wo.reject(new Ea(e))}}function Na(t){var e=this;return(e=va.call(this,Vr.UNAVAILABLE,"IndexedDB transaction failed: "+t)||this).name="IndexedDbTransactionError",e}function _a(t){this.do=t,this.fo=!1,this.To=null}function Aa(t){this.db=t,12.2===Aa.no(p())&&du("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}function Sa(t){return new Ru(function(n,r){t.onsuccess=function(t){var e=t.target.result;n(e)},t.onerror=function(t){var e=ka(t.target.error);r(e)}})}var Da=!1;function ka(t){var e=ga.no(p());if(12.2<=e&&e<13){var n="An internal error was encountered in the Indexed Database server";if(0<=t.message.indexOf(n)){var r=new jr("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return Da||(Da=!0,setTimeout(function(){throw r},0)),r}}return t}var Ra=(xa.vo=function(t,e,n,r){return gu(""!==t.uid),new xa(t.t()?t.uid:"",e,n,r)},xa.prototype.So=function(t){var r=!0,e=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Pa(t).Vo({index:hh.userMutationsIndex,range:e},function(t,e,n){r=!1,n.done()}).next(function(){return r})},xa.prototype.Do=function(e,t,n){return this.Co(e).next(function(t){return t.lastStreamToken=n.toBase64(),Va(e).put(t)})},xa.prototype.Fo=function(t){return this.Co(t).next(function(t){return Ti.fromBase64String(t.lastStreamToken)})},xa.prototype.No=function(e,n){return this.Co(e).next(function(t){return t.lastStreamToken=n.toBase64(),Va(e).put(t)})},xa.prototype.ko=function(h,c,f,l){var p=this,d=Ca(h),y=Pa(h);return y.add({}).next(function(t){gu("number"==typeof t);for(var e=new Au(t,c,f,l),n=p.serializer.$o(p.userId,e),r=[],i=new yi(function(t,e){return wu(t.K(),e.K())}),o=0,s=l;o<s.length;o++){var u=s[o],a=ch.key(p.userId,u.key.path,t);i=i.add(u.key.path.L()),r.push(y.put(n)),r.push(d.put(a,ch.PLACEHOLDER))}return i.forEach(function(t){r.push(p.ur.Mo(h,t))}),h.rr(function(){p.bo[t]=e.keys()}),Ru.Kn(r).next(function(){return e})})},xa.prototype.Lo=function(t,e){var n=this;return Pa(t).get(e).next(function(t){return t?(gu(t.userId===n.userId),n.serializer.Oo(t)):null})},xa.prototype.xo=function(t,n){var r=this;return this.bo[n]?Ru.resolve(this.bo[n]):this.Lo(t,n).next(function(t){if(t){var e=t.keys();return r.bo[n]=e}return null})},xa.prototype.Bo=function(t,e){var r=this,i=e+1,n=IDBKeyRange.lowerBound([this.userId,i]),o=null;return Pa(t).Vo({index:hh.userMutationsIndex,range:n},function(t,e,n){e.userId===r.userId&&(gu(e.batchId>=i),o=r.serializer.Oo(e)),n.done()}).next(function(){return o})},xa.prototype.qo=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return Pa(t).Vo({index:hh.userMutationsIndex,range:e,reverse:!0},function(t,e,n){r=e.batchId,n.done()}).next(function(){return r})},xa.prototype.Uo=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Pa(t).Ro(hh.userMutationsIndex,n).next(function(t){return t.map(function(t){return e.serializer.Oo(t)})})},xa.prototype._r=function(u,a){var h=this,t=ch.prefixForPath(this.userId,a.path),e=IDBKeyRange.lowerBound(t),c=[];return Ca(u).Vo({range:e},function(t,e,n){var r=t[0],i=t[1],o=t[2],s=ya(i);if(r===h.userId&&a.path.isEqual(s))return Pa(u).get(o).next(function(t){if(!t)throw vu();gu(t.userId===h.userId),c.push(h.serializer.Oo(t))});n.done()}).next(function(){return c})},xa.prototype.Ir=function(r,t){var a=this,h=new yi(wu),i=[];return t.forEach(function(u){var t=ch.prefixForPath(a.userId,u.path),e=IDBKeyRange.lowerBound(t),n=Ca(r).Vo({range:e},function(t,e,n){var r=t[0],i=t[1],o=t[2],s=ya(i);r===a.userId&&u.path.isEqual(s)?h=h.add(o):n.done()});i.push(n)}),Ru.Kn(i).next(function(){return a.Qo(r,h)})},xa.prototype.Vr=function(t,e){var u=this,a=e.path,h=a.length+1,n=ch.prefixForPath(this.userId,a),r=IDBKeyRange.lowerBound(n),c=new yi(wu);return Ca(t).Vo({range:r},function(t,e,n){var r=t[0],i=t[1],o=t[2],s=ya(i);r===u.userId&&a.U(s)?s.length===h&&(c=c.add(o)):n.done()}).next(function(){return u.Qo(t,c)})},xa.prototype.Qo=function(e,t){var n=this,r=[],i=[];return t.forEach(function(t){i.push(Pa(e).get(t).next(function(t){if(null===t)throw vu();gu(t.userId===n.userId),r.push(n.serializer.Oo(t))}))}),Ru.Kn(i).next(function(){return r})},xa.prototype.Wo=function(e,n){var r=this;return La(e.jo,this.userId,n).next(function(t){return e.rr(function(){r.Ko(n.batchId)}),Ru.forEach(t,function(t){return r.yo.Go(e,t)})})},xa.prototype.Ko=function(t){delete this.bo[t]},xa.prototype.zo=function(n){var o=this;return this.So(n).next(function(t){if(!t)return Ru.resolve();var e=IDBKeyRange.lowerBound(ch.prefixForUser(o.userId)),i=[];return Ca(n).Vo({range:e},function(t,e,n){if(t[0]===o.userId){var r=ya(t[1]);i.push(r)}else n.done()}).next(function(){gu(0===i.length)})})},xa.prototype.Mn=function(t,e){return Oa(t,this.userId,e)},xa.prototype.Co=function(t){var e=this;return Va(t).get(this.userId).next(function(t){return t||new ah(e.userId,-1,"")})},xa);function xa(t,e,n,r){this.userId=t,this.serializer=e,this.ur=n,this.yo=r,this.bo={}}function Oa(t,o,e){var n=ch.prefixForPath(o,e.path),s=n[1],r=IDBKeyRange.lowerBound(n),u=!1;return Ca(t).Vo({range:r,Po:!0},function(t,e,n){var r=t[0],i=t[1];t[2],r===o&&i===s&&(u=!0),n.done()}).next(function(){return u})}function La(t,e,n){var r=t.store(hh.store),i=t.store(ch.store),o=[],s=IDBKeyRange.only(n.batchId),u=0,a=r.Vo({range:s},function(t,e,n){return u++,n.delete()});o.push(a.next(function(){gu(1===u)}));for(var h=[],c=0,f=n.mutations;c<f.length;c++){var l=f[c],p=ch.key(e,l.key.path,n.batchId);o.push(i.delete(p)),h.push(l.key)}return Ru.Kn(o).next(function(){return h})}function Pa(t){return Rh.co(t,hh.store)}function Ca(t){return Rh.co(t,ch.store)}function Va(t){return Rh.co(t,ah.store)}var ja=(qa.prototype.next=function(){return this.Ho+=2,this.Ho},qa.Yo=function(){return new qa(0)},qa.Jo=function(){return new qa(-1)},qa),Ma=(Ua.prototype.Xo=function(n){var r=this;return this.Zo(n).next(function(t){var e=new ja(t.highestTargetId);return t.highestTargetId=e.next(),r.ta(n,t).next(function(){return t.highestTargetId})})},Ua.prototype.ea=function(t){return this.Zo(t).next(function(t){return Br.v(new Gr(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))})},Ua.prototype.sa=function(t){return Ba(t.jo)},Ua.prototype.ia=function(e,n,r){var i=this;return this.Zo(e).next(function(t){return t.highestListenSequenceNumber=n,r&&(t.lastRemoteSnapshotVersion=r.F()),n>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=n),i.ta(e,t)})},Ua.prototype.na=function(e,n){var r=this;return this.ra(e,n).next(function(){return r.Zo(e).next(function(t){return t.targetCount+=1,r.ha(n,t),r.ta(e,t)})})},Ua.prototype.oa=function(t,e){return this.ra(t,e)},Ua.prototype.aa=function(e,t){var n=this;return this.ua(e,t.targetId).next(function(){return Fa(e).delete(t.targetId)}).next(function(){return n.Zo(e)}).next(function(t){return gu(0<t.targetCount),--t.targetCount,n.ta(e,t)})},Ua.prototype.Zh=function(r,i,o){var s=this,u=0,a=[];return Fa(r).Vo(function(t,e){var n=s.serializer.ca(e);n.sequenceNumber<=i&&null===o.get(n.targetId)&&(u++,a.push(s.aa(r,n)))}).next(function(){return Ru.Kn(a)}).next(function(){return u})},Ua.prototype.Xs=function(t,r){var i=this;return Fa(t).Vo(function(t,e){var n=i.serializer.ca(e);r(n)})},Ua.prototype.Zo=function(t){return Ga(t.jo)},Ua.prototype.ta=function(t,e){return Rh.co(t,mh.store).put(mh.key,e)},Ua.prototype.ra=function(t,e){return Fa(t).put(this.serializer._a(e))},Ua.prototype.ha=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},Ua.prototype.la=function(t){return this.Zo(t).next(function(t){return t.targetCount})},Ua.prototype.da=function(t,i){var o=this,e=i.canonicalId(),n=IDBKeyRange.bound([e,Number.NEGATIVE_INFINITY],[e,Number.POSITIVE_INFINITY]),s=null;return Fa(t).Vo({range:n,index:vh.queryTargetsIndexName},function(t,e,n){var r=o.serializer.ca(e);i.isEqual(r.target)&&(s=r,n.done())}).next(function(){return s})},Ua.prototype.fa=function(n,t,r){var i=this,o=[],s=za(n);return t.forEach(function(t){var e=la(t.path);o.push(s.put(new gh(r,e))),o.push(i.yo.vn(n,t))}),Ru.Kn(o)},Ua.prototype.Ta=function(n,t,r){var i=this,o=za(n);return Ru.forEach(t,function(t){var e=la(t.path);return Ru.Kn([o.delete([r,e]),i.yo.Dn(n,t)])})},Ua.prototype.ua=function(t,e){var n=za(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},Ua.prototype.Ea=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=za(t),o=Ls();return r.Vo({range:n,Po:!0},function(t,e,n){var r=ya(t[1]),i=new si(r);o=o.add(i)}).next(function(){return o})},Ua.prototype.Mn=function(t,e){var n=la(e.path),r=IDBKeyRange.bound([n],[Tu(n)],!1,!0),i=0;return za(t).Vo({index:gh.documentTargetsIndex,Po:!0,range:r},function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())}).next(function(){return 0<i})},Ua.prototype.ui=function(t,e){var n=this;return Fa(t).get(e).next(function(t){return t?n.serializer.ca(t):null})},Ua);function Ua(t,e){this.yo=t,this.serializer=e}function qa(t){this.Ho=t}function Fa(t){return Rh.co(t,vh.store)}function Ga(t){return ga.co(t,mh.store).get(mh.key).next(function(t){return gu(null!==t),t})}function Ba(t){return Ga(t).next(function(t){return t.highestListenSequenceNumber})}function za(t){return Rh.co(t,gh.store)}var Ka,Ya=(Ha.prototype.Jn=function(t,e,n){return Qa(t).put(Za(e),n)},Ha.prototype.Zn=function(t,e){var n=Qa(t),r=Za(e);return n.delete(r)},Ha.prototype.updateMetadata=function(e,n){var r=this;return this.getMetadata(e).next(function(t){return t.byteSize+=n,r.Ia(e,t)})},Ha.prototype.tr=function(t,e){var n=this;return Qa(t).get(Za(e)).next(function(t){return n.wa(t)})},Ha.prototype.Ra=function(t,e){var n=this;return Qa(t).get(Za(e)).next(function(t){var e=n.wa(t);return e?{Aa:e,size:Xa(t)}:null})},Ha.prototype.getEntries=function(t,e){var r=this,i=Ss();return this.ma(t,e,function(t,e){var n=r.wa(e);i=i.nt(t,n)}).next(function(){return i})},Ha.prototype.Pa=function(t,e){var r=this,i=Ss(),o=new ai(si.k);return this.ma(t,e,function(t,e){var n=r.wa(e);o=n?(i=i.nt(t,n),o.nt(t,Xa(e))):(i=i.nt(t,null),o.nt(t,0))}).next(function(){return{Va:i,ga:o}})},Ha.prototype.ma=function(t,e,i){if(e.q())return Ru.resolve();var n=IDBKeyRange.bound(e.first().path.j(),e.last().path.j()),o=e._t(),s=o.It();return Qa(t).Vo({range:n},function(t,e,n){for(var r=si.it(t);s&&si.k(s,r)<0;)i(s,null),s=o.It();s&&s.isEqual(r)&&(i(s,e),s=o.wt()?o.It():null),s?n.Io(s.path.j()):n.done()}).next(function(){for(;s;)i(s,null),s=o.wt()?o.It():null})},Ha.prototype.wr=function(t,i,e){var o=this,s=ks(),u=i.path.length+1,n={};if(e.isEqual(Br.MIN)){var r=i.path.j();n.range=IDBKeyRange.lowerBound(r)}else{var a=i.path.j(),h=this.serializer.pa(e);n.range=IDBKeyRange.lowerBound([a,h],!0),n.index=dh.collectionReadTimeIndex}return Qa(t).Vo(n,function(t,e,n){if(t.length===u){var r=o.serializer.ya(e);i.path.U(r.key.path)?r instanceof Oo&&i.matches(r)&&(s=s.nt(r.key,r)):n.done()}}).next(function(){return s})},Ha.prototype.ba=function(t,e){var r=this,i=As(),o=this.serializer.pa(e),n=Qa(t),s=IDBKeyRange.lowerBound(o,!0);return n.Vo({index:dh.readTimeIndex,range:s},function(t,e){var n=r.serializer.ya(e);i=i.nt(n.key,n),o=e.readTime}).next(function(){return{va:i,readTime:r.serializer.Sa(o)}})},Ha.prototype.Da=function(t){var r=this,e=Qa(t),i=Br.MIN;return e.Vo({index:dh.readTimeIndex,reverse:!0},function(t,e,n){e.readTime&&(i=r.serializer.Sa(e.readTime)),n.done()}).next(function(){return i})},Ha.prototype.Ca=function(t){return new Ha.Fa(this,!!t&&t.Na)},Ha.prototype.ka=function(t){return this.getMetadata(t).next(function(t){return t.byteSize})},Ha.prototype.getMetadata=function(t){return Wa(t).get(yh.key).next(function(t){return gu(!!t),t})},Ha.prototype.Ia=function(t,e){return Wa(t).put(yh.key,e)},Ha.prototype.wa=function(t){if(t){var e=this.serializer.ya(t);return e instanceof Lo&&e.version.isEqual(Br.S())?null:e}return null},Ha);function Ha(t,e){this.serializer=t,this.ur=e}function Wa(t){return Rh.co(t,yh.store)}function Qa(t){return Rh.co(t,dh.store)}function Za(t){return t.path.j()}function Xa(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw vu();e=t.noDocument}return JSON.stringify(e).length}function Ja(t,e){var n=this;return(n=Ka.call(this)||this).$a=t,n.Na=e,n.Ma=new _u(function(t){return t.toString()}),n}function $a(t,e){this.seconds=t,this.nanoseconds=e}Ya.Fa=(n(Ja,Ka=xu),Ja.prototype.ir=function(s){var u=this,a=[],h=0,c=new yi(function(t,e){return wu(t.K(),e.K())});return this.zn.forEach(function(t,e){var n=u.Ma.get(t);if(e){var r=u.$a.serializer.La(e,u.readTime);c=c.add(t.path.L());var i=Xa(r);h+=i-n,a.push(u.$a.Jn(s,t,r))}else if(h-=n,u.Na){var o=u.$a.serializer.La(new Lo(t,Br.S()),u.readTime);a.push(u.$a.Jn(s,t,o))}else a.push(u.$a.Zn(s,t))}),c.forEach(function(t){a.push(u.$a.ur.Mo(s,t))}),a.push(this.$a.updateMetadata(s,h)),Ru.Kn(a)},Ja.prototype.er=function(t,e){var n=this;return this.$a.Ra(t,e).next(function(t){return null===t?(n.Ma.set(e,0),null):(n.Ma.set(e,t.size),t.Aa)})},Ja.prototype.sr=function(t,e){var n=this;return this.$a.Pa(t,e).next(function(t){var e=t.Va;return t.ga.forEach(function(t,e){n.Ma.set(t,e)}),e})},Ja);var th=(uh.prototype.Mo=function(t,e){return this.Oa.add(e),Ru.resolve()},uh.prototype.Pr=function(t,e){return Ru.resolve(this.Oa.getEntries(e))},uh),eh=(sh.prototype.add=function(t){var e=t.B(),n=t.L(),r=this.index[e]||new yi($r.k),i=!r.has(n);return this.index[e]=r.add(n),i},sh.prototype.has=function(t){var e=t.B(),n=t.L(),r=this.index[e];return r&&r.has(n)},sh.prototype.getEntries=function(t){return(this.index[t]||new yi($r.k)).j()},sh),nh=10,rh=(oh.prototype.createOrUpgrade=function(n,r,t,e){var i=this;gu(t<e&&0<=t&&e<=nh);var o,s=new wa(r);t<1&&1<=e&&(n.createObjectStore(ih.store),(o=n).createObjectStore(ah.store,{keyPath:ah.keyPath}),o.createObjectStore(hh.store,{keyPath:hh.keyPath,autoIncrement:!0}).createIndex(hh.userMutationsIndex,hh.userMutationsKeyPath,{unique:!0}),o.createObjectStore(ch.store),wh(n),n.createObjectStore(dh.store));var u,a=Ru.resolve();return t<3&&3<=e&&(0!==t&&((u=n).deleteObjectStore(gh.store),u.deleteObjectStore(vh.store),u.deleteObjectStore(mh.store),wh(n)),a=a.next(function(){return t=s.store(mh.store),e=new mh(0,0,Br.MIN.F(),0),t.put(mh.key,e);var t,e})),t<4&&4<=e&&(0!==t&&(a=a.next(function(){return r=n,(i=s).store(hh.store).Ro().next(function(t){r.deleteObjectStore(hh.store),r.createObjectStore(hh.store,{keyPath:hh.keyPath,autoIncrement:!0}).createIndex(hh.userMutationsIndex,hh.userMutationsKeyPath,{unique:!0});var e=i.store(hh.store),n=t.map(function(t){return e.put(t)});return Ru.Kn(n)});var r,i})),a=a.next(function(){n.createObjectStore(bh.store,{keyPath:bh.keyPath})})),t<5&&5<=e&&(a=a.next(function(){return i.removeAcknowledgedMutations(s)})),t<6&&6<=e&&(a=a.next(function(){return n.createObjectStore(yh.store),i.addDocumentGlobal(s)})),t<7&&7<=e&&(a=a.next(function(){return i.ensureSequenceNumbers(s)})),t<8&&8<=e&&(a=a.next(function(){return i.createCollectionParentIndex(n,s)})),t<9&&9<=e&&(a=a.next(function(){var t,e;(e=n).objectStoreNames.contains("remoteDocumentChanges")&&e.deleteObjectStore("remoteDocumentChanges"),(t=r.objectStore(dh.store)).createIndex(dh.readTimeIndex,dh.readTimeIndexPath,{unique:!1}),t.createIndex(dh.collectionReadTimeIndex,dh.collectionReadTimeIndexPath,{unique:!1})})),t<10&&10<=e&&(a=a.next(function(){return i.rewriteCanonicalIds(s)})),a},oh.prototype.addDocumentGlobal=function(e){var n=0;return e.store(dh.store).Vo(function(t,e){n+=Xa(e)}).next(function(){var t=new yh(n);return e.store(yh.store).put(yh.key,t)})},oh.prototype.removeAcknowledgedMutations=function(r){var i=this,t=r.store(ah.store),e=r.store(hh.store);return t.Ro().next(function(t){return Ru.forEach(t,function(n){var t=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return e.Ro(hh.userMutationsIndex,t).next(function(t){return Ru.forEach(t,function(t){gu(t.userId===n.userId);var e=i.serializer.Oo(t);return La(r,n.userId,e).next(function(){})})})})})},oh.prototype.ensureSequenceNumbers=function(t){var s=t.store(gh.store),e=t.store(dh.store);return Ba(t).next(function(i){var o=[];return e.Vo(function(t,e){var n=new $r(t),r=[0,la(n)];o.push(s.get(r).next(function(t){return t?Ru.resolve():s.put(new gh(0,la(n),i))}))}).next(function(){return Ru.Kn(o)})})},oh.prototype.createCollectionParentIndex=function(t,e){function r(t){if(o.add(t)){var e=t.B(),n=t.L();return i.put({collectionId:e,parent:la(n)})}}t.createObjectStore(Eh.store,{keyPath:Eh.keyPath});var i=e.store(Eh.store),o=new eh;return e.store(dh.store).Vo({Po:!0},function(t,e){return r(new $r(t).L())}).next(function(){return e.store(ch.store).Vo({Po:!0},function(t,e){t[0];var n=t[1];return r((t[2],ya(n)).L())})})},oh.prototype.rewriteCanonicalIds=function(t){var i=this,o=t.store(vh.store);return o.Vo(function(t,e){var n=i.serializer.ca(e),r=i.serializer._a(n);return o.put(r)})},oh),ih=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};function oh(t){this.serializer=t}function sh(){this.index={}}function uh(){this.Oa=new eh}ih.store="owner",ih.key="owner";var ah=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};ah.store="mutationQueues",ah.keyPath="userId";var hh=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};hh.store="mutations",hh.keyPath="batchId",hh.userMutationsIndex="userMutationsIndex",hh.userMutationsKeyPath=["userId","batchId"];var ch=(fh.prefixForUser=function(t){return[t]},fh.prefixForPath=function(t,e){return[t,la(e)]},fh.key=function(t,e,n){return[t,la(e),n]},fh);function fh(){}function lh(t,e){this.path=t,this.readTime=e}function ph(t,e){this.path=t,this.version=e}ch.store="documentMutations",ch.PLACEHOLDER=new ch;var dh=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};dh.store="remoteDocuments",dh.readTimeIndex="readTimeIndex",dh.readTimeIndexPath="readTime",dh.collectionReadTimeIndex="collectionReadTimeIndex",dh.collectionReadTimeIndexPath=["parentPath","readTime"];var yh=function(t){this.byteSize=t};yh.store="remoteDocumentGlobal",yh.key="remoteDocumentGlobalKey";var vh=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};vh.store="targets",vh.keyPath="targetId",vh.queryTargetsIndexName="queryTargetsIndex",vh.queryTargetsKeyPath=["canonicalId","targetId"];var gh=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};gh.store="targetDocuments",gh.keyPath=["targetId","path"],gh.documentTargetsIndex="documentTargetsIndex",gh.documentTargetsKeyPath=["path","targetId"];var mh=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};mh.key="targetGlobalKey",mh.store="targetGlobal";var Eh=function(t,e){this.collectionId=t,this.parent=e};function wh(t){t.createObjectStore(gh.store,{keyPath:gh.keyPath}).createIndex(gh.documentTargetsIndex,gh.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(vh.store,{keyPath:vh.keyPath}).createIndex(vh.queryTargetsIndexName,vh.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(mh.store)}Eh.store="collectionParents",Eh.keyPath=["collectionId","parent"];var bh=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};bh.store="clientMetadata",bh.keyPath="clientId";var Th=i(i(i([ah.store,hh.store,ch.store,dh.store,vh.store,ih.store,mh.store,gh.store],[bh.store]),[yh.store]),[Eh.store]),Ih=(Nh.prototype.Mo=function(t,e){var n=this;if(this.xa.has(e))return Ru.resolve();var r=e.B(),i=e.L();t.rr(function(){n.xa.add(e)});var o={collectionId:r,parent:la(i)};return _h(t).put(o)},Nh.prototype.Pr=function(t,i){var o=[],e=IDBKeyRange.bound([i,""],[Tu(i),""],!1,!0);return _h(t).Ro(e).next(function(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if(r.collectionId!==i)break;o.push(ya(r.parent))}return o})},Nh);function Nh(){this.xa=new eh}function _h(t){return Rh.co(t,Eh.store)}var Ah,Sh=(Lh.prototype.ya=function(t){if(t.document)return this.Ba.vi(t.document,!!t.hasCommittedMutations);if(t.noDocument){var e=si.it(t.noDocument.path),n=this.qa(t.noDocument.readTime);return new Lo(e,n,{hasCommittedMutations:!!t.hasCommittedMutations})}if(t.unknownDocument){var r=si.it(t.unknownDocument.path),i=this.qa(t.unknownDocument.version);return new Po(r,i)}return vu()},Lh.prototype.La=function(t,e){var n=this.pa(e),r=t.key.path.L().j();if(t instanceof Oo){var i=this.Ba.bi(t),o=t.hasCommittedMutations;return new dh(null,null,i,o,n,r)}if(t instanceof Lo){var s=t.key.path.j(),u=this.Ua(t.version),a=t.hasCommittedMutations;return new dh(null,new lh(s,u),null,a,n,r)}if(t instanceof Po){var h=t.key.path.j(),c=this.Ua(t.version);return new dh(new ph(h,c),null,null,!0,n,r)}return vu()},Lh.prototype.pa=function(t){var e=t.F();return[e.seconds,e.nanoseconds]},Lh.prototype.Sa=function(t){var e=new Gr(t[0],t[1]);return Br.v(e)},Lh.prototype.Ua=function(t){var e=t.F();return new $a(e.seconds,e.nanoseconds)},Lh.prototype.qa=function(t){var e=new Gr(t.seconds,t.nanoseconds);return Br.v(e)},Lh.prototype.$o=function(t,e){var n=this,r=e.baseMutations.map(function(t){return n.Ba.$i(t)}),i=e.mutations.map(function(t){return n.Ba.$i(t)});return new hh(t,e.batchId,e.An.toMillis(),r,i)},Lh.prototype.Oo=function(t){var e=this,n=(t.baseMutations||[]).map(function(t){return e.Ba.xi(t)}),r=t.mutations.map(function(t){return e.Ba.xi(t)}),i=Gr.fromMillis(t.localWriteTimeMs);return new Au(t.batchId,i,n,r)},Lh.prototype.ca=function(t){var e,n=this.qa(t.readTime),r=void 0!==t.lastLimboFreeSnapshotVersion?this.qa(t.lastLimboFreeSnapshotVersion):Br.MIN;return e=void 0!==t.query.documents?this.Ba.Ki(t.query):this.Ba.Ji(t.query),new Es(e,t.targetId,0,t.lastListenSequenceNumber,n,r,Ti.fromBase64String(t.resumeToken))},Lh.prototype._a=function(t){var e,n=this.Ua(t.ts),r=this.Ua(t.lastLimboFreeSnapshotVersion);e=t.target.Pe()?this.Ba.ji(t.target):this.Ba.Gi(t.target);var i=t.resumeToken.toBase64();return new vh(t.targetId,t.target.canonicalId(),n,i,t.sequenceNumber,r,e)},Lh),Dh="Another tab has exclusive access to the persistence layer. To allow shared access, make sure to invoke `enablePersistence()` with `synchronizeTabs:true` in all tabs.",kh=(n(Oh,Ah=Lu),Oh),Rh=(xh.co=function(t,e){if(t instanceof kh)return ga.co(t.jo,e);throw vu()},xh.prototype.start=function(){var e=this;return ga.ro(this.Ja,nh,new rh(this.serializer)).then(function(t){return e.eu=t,e.su()}).then(function(){return e.iu(),e.nu(),e.ru(),e.eu.runTransaction("readonly",[mh.store],function(t){return Ba(t)})}).then(function(t){e.hu=new Vu(t,e.Wa)}).then(function(){e.ja=!0}).catch(function(t){return e.eu&&e.eu.close(),Promise.reject(t)})},xh.prototype.ou=function(n){var t=this;return this.Ya=function(e){return f(t,void 0,void 0,function(){return y(this,function(t){return this.Kh?[2,n(e)]:[2]})})},n(this.isPrimary)},xh.prototype.au=function(n){var t=this;this.eu._o(function(e){return f(t,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return null===e.newVersion?[4,n()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})},xh.prototype.uu=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.Nr.Zr(function(){return f(e,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.Kh?[4,this.su()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})}))},xh.prototype.su=function(){var n=this;return this.eu.runTransaction("readwrite",Th,function(e){return Ch(e).put(new bh(n.clientId,Date.now(),n.networkEnabled,n.inForeground)).next(function(){if(n.isPrimary)return n.cu(e).next(function(t){t||(n.isPrimary=!1,n.Nr.Zr(function(){return n.Ya(!1)}))})}).next(function(){return n._u(e)}).next(function(t){return n.isPrimary&&!t?n.lu(e).next(function(){return!1}):!!t&&n.du(e).next(function(){return!0})})}).catch(function(t){if(!n.allowTabSynchronization)throw t;return pu("IndexedDbPersistence","Releasing owner lease after error during lease refresh",t),!1}).then(function(t){n.isPrimary!==t&&n.Nr.Zr(function(){return n.Ya(t)}),n.isPrimary=t})},xh.prototype.cu=function(t){var e=this;return Ph(t).get(ih.key).next(function(t){return Ru.resolve(e.fu(t))})},xh.prototype.Tu=function(t){return Ch(t).delete(this.clientId)},xh.prototype.Eu=function(){return f(this,void 0,void 0,function(){var i=this;return y(this,function(t){switch(t.label){case 0:return!this.isPrimary||this.Iu(this.Ha,18e5)?[3,2]:(this.Ha=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",function(t){var r=xh.co(t,bh.store);return r.Ro().next(function(t){var e=i.wu(t,18e5),n=t.filter(function(t){return-1===e.indexOf(t)});return Ru.forEach(n,function(t){return r.delete(t.clientId)}).next(function(){return n})})}).catch(function(){return[]})]);case 1:t.sent().forEach(function(t){i.window.localStorage.removeItem(i.Ru(t.clientId))}),t.label=2;case 2:return[2]}})})},xh.prototype.ru=function(){var t=this;this.za=this.Nr.Wr("client_metadata_refresh",4e3,function(){return t.su().then(function(){return t.Eu()}).then(function(){return t.ru()})})},xh.prototype.fu=function(t){return!!t&&t.ownerId===this.clientId},xh.prototype._u=function(e){var i=this;return Ph(e).get(ih.key).next(function(t){if(null!==t&&i.Iu(t.leaseTimestampMs,5e3)&&!i.Au(t.ownerId)){if(i.fu(t)&&i.networkEnabled)return!0;if(!i.fu(t)){if(!t.allowTabSynchronization)throw new jr(Vr.FAILED_PRECONDITION,Dh);return!1}}return!(!i.networkEnabled||!i.inForeground)||Ch(e).Ro().next(function(t){return void 0===i.wu(t,5e3).find(function(t){if(i.clientId!==t.clientId){var e=!i.networkEnabled&&t.networkEnabled,n=!i.inForeground&&t.inForeground,r=i.networkEnabled===t.networkEnabled;if(e||n&&r)return!0}return!1})})}).next(function(t){return i.isPrimary!==t&&pu("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t})},xh.prototype.mu=function(){return f(this,void 0,void 0,function(){var e=this;return y(this,function(t){switch(t.label){case 0:return this.ja=!1,this.Pu(),this.za&&(this.za.cancel(),this.za=null),this.Vu(),this.gu(),[4,this.eu.runTransaction("readwrite",[ih.store,bh.store],function(t){return e.lu(t).next(function(){return e.Tu(t)})})];case 1:return t.sent(),this.eu.close(),this.pu(),[2]}})})},xh.prototype.wu=function(t,e){var n=this;return t.filter(function(t){return n.Iu(t.updateTimeMs,e)&&!n.Au(t.clientId)})},xh.prototype.yu=function(){var e=this;return this.eu.runTransaction("readonly",[bh.store],function(t){return Ch(t).Ro().next(function(t){return e.wu(t,18e5).map(function(t){return t.clientId})})})},xh.clearPersistence=function(n){return f(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return xh.ho()?(e=n+xh.Xa,[4,ga.delete(e)]):[2,Promise.resolve()];case 1:return t.sent(),[2]}})})},Object.defineProperty(xh.prototype,"Kh",{get:function(){return this.ja},enumerable:!0,configurable:!0}),xh.prototype.bu=function(t){return Ra.vo(t,this.serializer,this.ur,this.yo)},xh.prototype.vu=function(){return this.Za},xh.prototype.Su=function(){return this.or},xh.prototype.Du=function(){return this.ur},xh.prototype.runTransaction=function(n,t,r){var i=this;pu("IndexedDbPersistence","Starting transaction:",n);var o,e="readonly"===t?"readonly":"readwrite";return this.eu.runTransaction(e,Th,function(e){return o=new kh(e,i.hu.next()),"readwrite-primary"===t?i.cu(e).next(function(t){return!!t||i._u(e)}).next(function(t){if(!t)throw du("Failed to obtain primary lease for action '"+n+"'."),i.isPrimary=!1,i.Nr.Zr(function(){return i.Ya(!1)}),new jr(Vr.FAILED_PRECONDITION,Ou);return r(o)}).next(function(t){return i.du(e).next(function(){return t})}):i.Cu(e).next(function(){return r(o)})}).then(function(t){return o.hr(),t})},xh.prototype.Cu=function(t){var e=this;return Ph(t).get(ih.key).next(function(t){if(null!==t&&e.Iu(t.leaseTimestampMs,5e3)&&!e.Au(t.ownerId)&&!e.fu(t)&&!t.allowTabSynchronization)throw new jr(Vr.FAILED_PRECONDITION,Dh)})},xh.prototype.du=function(t){var e=new ih(this.clientId,this.allowTabSynchronization,Date.now());return Ph(t).put(ih.key,e)},xh.ho=function(){return ga.ho()},xh.Fu=function(t){var e=t.ci.projectId;return t.ci.In||(e+="."+t.ci.database),"firestore/"+t.persistenceKey+"/"+e+"/"},xh.prototype.lu=function(t){var e=this,n=Ph(t);return n.get(ih.key).next(function(t){return e.fu(t)?(pu("IndexedDbPersistence","Releasing primary lease."),n.delete(ih.key)):Ru.resolve()})},xh.prototype.Iu=function(t,e){var n=Date.now();return!(t<n-e||n<t&&(du("Detected an update time that is in the future: "+t+" > "+n),1))},xh.prototype.iu=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Ga=function(){t.Nr.Zr(function(){return t.inForeground="visible"===t.document.visibilityState,t.su()})},this.document.addEventListener("visibilitychange",this.Ga),this.inForeground="visible"===this.document.visibilityState)},xh.prototype.Vu=function(){this.Ga&&(this.document.removeEventListener("visibilitychange",this.Ga),this.Ga=null)},xh.prototype.nu=function(){var t=this;"function"==typeof this.window.addEventListener&&(this.Ka=function(){t.Pu(),t.Nr.Zr(function(){return t.mu()})},this.window.addEventListener("unload",this.Ka))},xh.prototype.gu=function(){this.Ka&&(this.window.removeEventListener("unload",this.Ka),this.Ka=null)},xh.prototype.Au=function(t){try{var e=null!==this.tu.getItem(this.Ru(t));return pu("IndexedDbPersistence","Client '"+t+"' "+(e?"is":"is not")+" zombied in LocalStorage"),e}catch(t){return du("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},xh.prototype.Pu=function(){try{this.tu.setItem(this.Ru(this.clientId),String(Date.now()))}catch(t){du("Failed to set zombie client id.",t)}},xh.prototype.pu=function(){try{this.tu.removeItem(this.Ru(this.clientId))}catch(t){}},xh.prototype.Ru=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},xh);function xh(t,e,n,r,i,o,s,u){if(this.allowTabSynchronization=t,this.persistenceKey=e,this.clientId=n,this.Nr=o,this.Wa=u,this.ja=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Ka=null,this.inForeground=!1,this.Ga=null,this.za=null,this.Ha=Number.NEGATIVE_INFINITY,this.Ya=function(t){return Promise.resolve()},!xh.ho())throw new jr(Vr.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");if(this.yo=new Vh(this,i),this.Ja=e+xh.Xa,this.serializer=new Sh(s),this.document=r.document,this.Za=new Ma(this.yo,this.serializer),this.ur=new Ih,this.or=new Ya(this.serializer,this.ur),!r.window||!r.window.localStorage)throw new jr(Vr.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");this.window=r.window,this.tu=this.window.localStorage}function Oh(t,e){var n=this;return(n=Ah.call(this)||this).jo=t,n.Qa=e,n}function Lh(t){this.Ba=t}function Ph(t){return t.store(ih.store)}function Ch(t){return t.store(bh.store)}Rh.Xa="main";var Vh=(jh.prototype.Yh=function(t){var n=this.ku(t);return this.db.vu().la(t).next(function(e){return n.next(function(t){return e+t})})},jh.prototype.ku=function(t){var e=0;return this.Xh(t,function(t){e++}).next(function(){return e})},jh.prototype.Xs=function(t,e){return this.db.vu().Xs(t,e)},jh.prototype.Xh=function(t,n){return this.$u(t,function(t,e){return n(e)})},jh.prototype.Mu=function(t){this.Nu=t},jh.prototype.vn=function(t,e){return Mh(t,e)},jh.prototype.Dn=function(t,e){return Mh(t,e)},jh.prototype.Zh=function(t,e,n){return this.db.vu().Zh(t,e,n)},jh.prototype.Go=function(t,e){return Mh(t,e)},jh.prototype.Lu=function(t,e){return this.Nu.Mn(e)?Ru.resolve(!0):(r=e,i=!1,Va(n=t).po(function(t){return Oa(n,t,r).next(function(t){return t&&(i=!0),Ru.resolve(!t)})}).next(function(){return i}));var n,r,i},jh.prototype.to=function(r,i){var o=this,s=this.db.Su().Ca(),u=[],a=0;return this.$u(r,function(e,t){if(t<=i){var n=o.Lu(r,e).next(function(t){if(!t)return a++,s.tr(r,e).next(function(){return s.Zn(e),za(r).delete([0,la(e.path)])})});u.push(n)}}).next(function(){return Ru.Kn(u)}).next(function(){return s.apply(r)}).next(function(){return a})},jh.prototype.removeTarget=function(t,e){var n=e.es(t.Qa);return this.db.vu().oa(t,n)},jh.prototype.Ou=function(t,e){return Mh(t,e)},jh.prototype.$u=function(t,o){var s,e=za(t),u=Vu.Fr;return e.Vo({index:gh.documentTargetsIndex},function(t,e){var n=t[0],r=(t[1],e.path),i=e.sequenceNumber;0===n?(u!==Vu.Fr&&o(new si(ya(s)),u),u=i,s=r):u=Vu.Fr}).next(function(){u!==Vu.Fr&&o(new si(ya(s)),u)})},jh.prototype.so=function(t){return this.db.Su().ka(t)},jh);function jh(t,e){this.db=t,this.Nu=null,this.qh=new ha(this,e)}function Mh(t,e){return za(t).put((n=t.Qa,new gh(0,la(e.path),n)));var n}var Uh=(qh.prototype.start=function(){return Promise.resolve()},qh.prototype.Gu=function(i){return f(this,void 0,void 0,function(){var e,m,n,r=this;return y(this,function(t){switch(t.label){case 0:return e=this.ar,m=this.ju,[4,this.persistence.runTransaction("Handle user change","readonly",function(v){var g;return r.ar.Uo(v).next(function(t){return g=t,e=r.persistence.bu(i),m=new Pu(r.Wu,e,r.persistence.Du()),e.Uo(v)}).next(function(t){for(var e=[],n=[],r=Ls(),i=0,o=g;i<o.length;i++){var s=o[i];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++){var h=a[u];r=r.add(h.key)}}for(var c=0,f=t;c<f.length;c++){var l=f[c];n.push(l.batchId);for(var p=0,d=l.mutations;p<d.length;p++){var y=d[p];r=r.add(y.key)}}return m.Tr(v,r).next(function(t){return{zu:t,Hu:e,Yu:n}})})})];case 1:return n=t.sent(),[2,(this.ar=e,this.ju=m,this.xu.Ku(this.ju),n)]}})})},qh.prototype.Ju=function(u){var a,h=this,c=Gr.now(),t=u.reduce(function(t,e){return t.add(e.key)},Ls());return this.persistence.runTransaction("Locally write mutations","readwrite",function(s){return h.ju.Tr(s,t).next(function(t){a=t;for(var e=[],n=0,r=u;n<r.length;n++){var i=r[n],o=i.ee(a.get(i.key));null!=o&&e.push(new yo(i.key,o,o.se(),ro.exists(!0)))}return h.ar.ko(s,c,e,u)})}).then(function(t){var e=t.Pn(a);return{batchId:t.batchId,zn:e}})},qh.prototype.Do=function(r){var i=this;return this.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var e=r.batch.keys(),n=i.Wu.Ca({Na:!0});return i.ar.Do(t,r.batch,r.streamToken).next(function(){return i.Xu(t,r,n)}).next(function(){return n.apply(t)}).next(function(){return i.ar.zo(t)}).next(function(){return i.ju.Tr(t,e)})})},qh.prototype.Zu=function(t){var r=this;return this.persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return r.ar.Lo(e,t).next(function(t){return gu(null!==t),n=t.keys(),r.ar.Wo(e,t)}).next(function(){return r.ar.zo(e)}).next(function(){return r.ju.Tr(e,n)})})},qh.prototype.qo=function(){var e=this;return this.persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.ar.qo(t)})},qh.prototype.Fo=function(){var e=this;return this.persistence.runTransaction("Get last stream token","readonly",function(t){return e.ar.Fo(t)})},qh.prototype.No=function(e){var n=this;return this.persistence.runTransaction("Set last stream token","readwrite-primary",function(t){return n.ar.No(t,e)})},qh.prototype.ea=function(){var e=this;return this.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.Za.ea(t)})},qh.prototype.tc=function(a){var h=this,c=a.ts,f=this.qu;return this.persistence.runTransaction("Apply remote event","readwrite-primary",function(o){var i=h.Wu.Ca({Na:!0});f=h.qu;var s=[];a.Ts.forEach(function(t,e){var n=f.get(e);if(n){s.push(h.Za.Ta(o,t.gs,e).next(function(){return h.Za.fa(o,t.Ps,e)}));var r=t.resumeToken;if(0<r.Ot()){var i=n.ss(r,c).es(o.Qa);f=f.nt(e,i),qh.ec(n,i,t)&&s.push(h.Za.oa(o,i))}}});var u=As(),n=Ls();if(a.Is.forEach(function(t,e){n=n.add(t)}),s.push(i.getEntries(o,n).next(function(r){a.Is.forEach(function(t,e){var n=r.get(t);e instanceof Lo&&e.version.isEqual(Br.MIN)?(i.Zn(t,c),u=u.nt(t,e)):null==n||0<e.version.D(n.version)||0===e.version.D(n.version)&&n.hasPendingWrites?(i.Jn(e,c),u=u.nt(t,e)):pu("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version),a.ws.has(t)&&s.push(h.persistence.yo.Ou(o,t))})})),!c.isEqual(Br.MIN)){var t=h.Za.ea(o).next(function(t){return h.Za.ia(o,o.Qa,c)});s.push(t)}return Ru.Kn(s).next(function(){return i.apply(o)}).next(function(){return h.ju.Er(o,u)})}).then(function(t){return h.qu=f,t})},qh.ec=function(t,e,n){return gu(0<e.resumeToken.Ot()),0===t.resumeToken.Ot()||e.ts.C()-t.ts.C()>=this.sc||0<n.Ps.size+n.Vs.size+n.gs.size},qh.prototype.ic=function(t){for(var n=this,e=0,r=t;e<r.length;e++){var i=r[e],o=i.targetId;if(this.Bu.Sn(i.pr,o),this.Bu.Fn(i.yr,o),!i.fromCache){var s=this.qu.get(o),u=s.ts,a=s.ns(u);this.qu=this.qu.nt(o,a)}}return this.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(e){return Ru.forEach(t,function(t){return Ru.forEach(t.yr,function(t){return n.persistence.yo.Dn(e,t)})})})},qh.prototype.nc=function(e){var n=this;return this.persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===e&&(e=-1),n.ar.Bo(t,e)})},qh.prototype.rc=function(e){var n=this;return this.persistence.runTransaction("read document","readonly",function(t){return n.ju.cr(t,e)})},qh.prototype.hc=function(r){var i=this;return this.persistence.runTransaction("Allocate target","readwrite",function(e){var n;return i.Za.da(e,r).next(function(t){return t?(n=t,Ru.resolve(n)):i.Za.Xo(e).next(function(t){return n=new Es(r,t,0,e.Qa),i.Za.na(e,n).next(function(){return n})})})}).then(function(t){return null===i.qu.get(t.targetId)&&(i.qu=i.qu.nt(t.targetId,t),i.Uu.set(r,t.targetId)),t})},qh.prototype.da=function(t,e){var n=this.Uu.get(e);return void 0!==n?Ru.resolve(this.qu.get(n)):this.Za.da(t,e)},qh.prototype.oc=function(n,r){var i=this,o=this.qu.get(n),t=r?"readwrite":"readwrite-primary";return this.persistence.runTransaction("Release target",t,function(e){var t=i.Bu.Nn(n);return r?Ru.resolve():Ru.forEach(t,function(t){return i.persistence.yo.Dn(e,t)}).next(function(){i.persistence.yo.removeTarget(e,o)})}).then(function(){i.qu=i.qu.remove(n),i.Uu.delete(o.target)})},qh.prototype.ac=function(t,n){var r=this,i=Br.MIN,o=Ls();return this.persistence.runTransaction("Execute query","readonly",function(e){return r.da(e,t.xe()).next(function(t){if(t)return i=t.lastLimboFreeSnapshotVersion,r.Za.Ea(e,t.targetId).next(function(t){o=t})}).next(function(){return r.xu.wr(e,t,n?i:Br.MIN,n?o:Ls())}).next(function(t){return{documents:t,uc:o}})})},qh.prototype.cc=function(e){var n=this;return this.persistence.runTransaction("Remote document keys","readonly",function(t){return n.Za.Ea(t,e)})},qh.prototype.Xu=function(t,i,o){var e=this,s=i.batch,n=s.keys(),u=Ru.resolve();return n.forEach(function(r){u=u.next(function(){return o.tr(t,r)}).next(function(t){var e=t,n=i.gn.get(r);gu(null!==n),(!e||e.version.D(n)<0)&&(e=s.qt(r,e,i))&&o.Jn(e,i.Vn)})}),u.next(function(){return e.ar.Wo(t,s)})},qh.prototype.Gh=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.eo(t,n.qu)})},qh);function qh(t,e,n){this.persistence=t,this.xu=e,this.Bu=new Du,this.qu=new ai(wu),this.Uu=new _u(function(t){return t.canonicalId()}),this.Qu=Br.MIN,this.persistence.yo.Mu(this.Bu),this.ar=t.bu(n),this.Wu=t.Su(),this.Za=t.vu(),this.ju=new Pu(this.Wu,this.ar,this.persistence.Du()),this.xu.Ku(this.ju)}Uh.sc=3e8;var Fh,Gh=(n(Bh,Fh=Uh),Bh.prototype.start=function(){return this._c()},Bh.prototype.lc=function(t){var n=this;return this.persistence.runTransaction("Lookup mutation documents","readonly",function(e){return n.ar.xo(e,t).next(function(t){return t?n.ju.Tr(e,t):Ru.resolve(null)})})},Bh.prototype.dc=function(t){this.ar.Ko(t)},Bh.prototype.uu=function(t){this.persistence.uu(t)},Bh.prototype.yu=function(){return this.persistence.yu()},Bh.prototype.fc=function(e){var n=this,t=this.qu.get(e);return t?Promise.resolve(t.target):this.persistence.runTransaction("Get target data","readonly",function(t){return n.Za.ui(t,e).next(function(t){return t?t.target:null})})},Bh.prototype.ba=function(){var r=this;return this.persistence.runTransaction("Get new document changes","readonly",function(t){return r.Wu.ba(t,r.Qu)}).then(function(t){var e=t.va,n=t.readTime;return r.Qu=n,e})},Bh.prototype._c=function(){return f(this,void 0,void 0,function(){var e,n=this;return y(this,function(t){switch(t.label){case 0:return[4,(e=this).persistence.runTransaction("Synchronize last document change read time","readonly",function(t){return n.Wu.Da(t)})];case 1:return e.Qu=t.sent(),[2]}})})},Bh);function Bh(t,e,n){var r=this;return(r=Fh.call(this,t,e,n)||this).persistence=t,r.ar=t.bu(n),r.Wu=t.Su(),r.Za=t.vu(),r}function zh(e){return f(this,void 0,void 0,function(){return y(this,function(t){if(e.code!==Vr.FAILED_PRECONDITION||e.message!==Ou)throw e;return pu("LocalStore","Unexpectedly lost primary lease"),[2]})})}function Kh(t,e){if(0!==e.length)throw new jr(Vr.INVALID_ARGUMENT,"Function "+t+"() does not support arguments, but was called with "+ac(e.length,"argument")+".")}function Yh(t,e,n){if(e.length!==n)throw new jr(Vr.INVALID_ARGUMENT,"Function "+t+"() requires "+ac(n,"argument")+", but was called with "+ac(e.length,"argument")+".")}function Hh(t,e,n){if(e.length<n)throw new jr(Vr.INVALID_ARGUMENT,"Function "+t+"() requires at least "+ac(n,"argument")+", but was called with "+ac(e.length,"argument")+".")}function Wh(t,e,n,r){if(e.length<n||e.length>r)throw new jr(Vr.INVALID_ARGUMENT,"Function "+t+"() requires between "+n+" and "+r+" arguments, but was called with "+ac(e.length,"argument")+".")}function Qh(t,e,n,r){tc(t,e,uc(n)+" argument",r)}function Zh(t,e,n,r){void 0!==r&&Qh(t,e,n,r)}function Xh(t,e,n,r){tc(t,e,n+" option",r)}function Jh(t,e,n,r){void 0!==r&&Xh(t,e,n,r)}function $h(t,e,n,r,a){void 0!==r&&function(t,e,n){for(var r=[],i=0,o=a;i<o.length;i++){var s=o[i];if(s===n)return;r.push(nc(s))}var u=nc(n);throw new jr(Vr.INVALID_ARGUMENT,"Invalid value "+u+" provided to function "+t+'() for option "'+e+'". Acceptable values: '+r.join(", "))}(t,n,r)}function tc(t,e,n,r){if(!("object"===e?ec(r):"non-empty string"===e?"string"==typeof r&&""!==r:typeof r===e)){var i=nc(r);throw new jr(Vr.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" to be of type "+e+", but it was: "+i)}}function ec(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function nc(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":vu();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function rc(t,e,n){if(void 0===n)throw new jr(Vr.INVALID_ARGUMENT,"Function "+t+"() requires a valid "+uc(e)+" argument, but it was undefined.")}function ic(n,t,r){wi(t,function(t,e){if(r.indexOf(t)<0)throw new jr(Vr.INVALID_ARGUMENT,"Unknown option '"+t+"' passed to function "+n+"(). Available options: "+r.join(", "))})}function oc(t,e,n,r){var i=nc(r);return new jr(Vr.INVALID_ARGUMENT,"Function "+t+"() requires its "+uc(n)+" argument to be a "+e+", but it was: "+i)}function sc(t,e,n){if(n<=0)throw new jr(Vr.INVALID_ARGUMENT,'Function "'+t+'()" requires its '+uc(e)+" argument to be a positive number, but it was: "+n+".")}function uc(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function ac(t,e){return t+" "+e+(1===t?"":"s")}function hc(t,e){function n(){var t="This constructor is private.";throw e&&(t+=" ",t+=e),new jr(Vr.INVALID_ARGUMENT,t)}return n.prototype=t.prototype,Object.assign(n,t),n}function cc(){if("undefined"==typeof Uint8Array)throw new jr(Vr.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function fc(){if(!au.Lt().Tc)throw new jr(Vr.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var lc=(vc.fromBase64String=function(t){Yh("Blob.fromBase64String",arguments,1),Qh("Blob.fromBase64String","string",1,t),fc();try{return new vc(Ti.fromBase64String(t))}catch(t){throw new jr(Vr.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},vc.fromUint8Array=function(t){if(Yh("Blob.fromUint8Array",arguments,1),cc(),!(t instanceof Uint8Array))throw oc("Blob.fromUint8Array","Uint8Array",1,t);return new vc(Ti.fromUint8Array(t))},vc.prototype.toBase64=function(){return Yh("Blob.toBase64",arguments,0),fc(),this.Ec.toBase64()},vc.prototype.toUint8Array=function(){return Yh("Blob.toUint8Array",arguments,0),cc(),this.Ec.toUint8Array()},vc.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},vc.prototype.isEqual=function(t){return this.Ec.isEqual(t.Ec)},vc),pc=hc(lc,"Use Blob.fromUint8Array() or Blob.fromBase64String() instead."),dc=(yc.documentId=function(){return yc.wc},yc.prototype.isEqual=function(t){if(!(t instanceof yc))throw oc("isEqual","FieldPath",1,t);return this.Ic.isEqual(t.Ic)},yc);function yc(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];!function(){if(!(t instanceof Array)||t.length<1)throw new jr(Vr.INVALID_ARGUMENT,"Function FieldPath() requires its fieldNames argument to be an array with at least 1 element.")}();for(var n=0;n<t.length;++n)if(Qh("FieldPath","string",n,t[n]),0===t[n].length)throw new jr(Vr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.Ic=new ii(t)}function vc(t){fc(),this.Ec=t}dc.wc=new dc(ii.X().K());var gc,mc=new RegExp("[~\\*/\\[\\]]"),Ec=(Tc.delete=function(){return Kh("FieldValue.delete",arguments),wc.instance},Tc.serverTimestamp=function(){return Kh("FieldValue.serverTimestamp",arguments),Nc.instance},Tc.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Hh("FieldValue.arrayUnion",arguments,1),new kc(t)},Tc.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Hh("FieldValue.arrayRemove",arguments,1),new Rc(t)},Tc.increment=function(t){return Qh("FieldValue.increment","number",1,t),Yh("FieldValue.increment",arguments,1),new xc(t)},Tc.prototype.isEqual=function(t){return this===t},Tc),wc=(n(bc,gc=Ec),bc);function bc(){return gc.call(this,"FieldValue.delete")||this}function Tc(t){this.Rc=t}wc.instance=new wc;var Ic,Nc=(n(_c,Ic=Ec),_c);function _c(){return Ic.call(this,"FieldValue.serverTimestamp")||this}Nc.instance=new Nc;var Ac,Sc,Dc,kc=(n(Gc,Dc=Ec),Gc),Rc=(n(Fc,Sc=Ec),Fc),xc=(n(qc,Ac=Ec),qc),Oc=hc(Ec,"Use FieldValue.<field>() instead."),Lc=(Object.defineProperty(Uc.prototype,"latitude",{get:function(){return this.Pc},enumerable:!0,configurable:!0}),Object.defineProperty(Uc.prototype,"longitude",{get:function(){return this.Vc},enumerable:!0,configurable:!0}),Uc.prototype.isEqual=function(t){return this.Pc===t.Pc&&this.Vc===t.Vc},Uc.prototype.p=function(t){return wu(this.Pc,t.Pc)||wu(this.Vc,t.Vc)},Uc),Pc=/^__.*__$/,Cc=(Mc.prototype.gc=function(t,e){var n=[];return null!==this.se?n.push(new yo(t,this.data,this.se,e)):n.push(new po(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new vo(t,this.fieldTransforms)),n},Mc),Vc=(jc.prototype.gc=function(t,e){var n=[new yo(t,this.data,this.se,e)];return 0<this.fieldTransforms.length&&n.push(new vo(t,this.fieldTransforms)),n},jc);function jc(t,e,n){this.data=t,this.se=e,this.fieldTransforms=n}function Mc(t,e,n){this.data=t,this.se=e,this.fieldTransforms=n}function Uc(t,e){if(Yh("GeoPoint",arguments,2),Qh("GeoPoint","number",1,t),Qh("GeoPoint","number",2,e),!isFinite(t)||t<-90||90<t)throw new jr(Vr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new jr(Vr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.Pc=t,this.Vc=e}function qc(t){var e=this;return(e=Ac.call(this,"FieldValue.increment")||this).mc=t,e}function Fc(t){var e=this;return(e=Sc.call(this,"FieldValue.arrayRemove")||this).Ac=t,e}function Gc(t){var e=this;return(e=Dc.call(this,"FieldValue.arrayUnion")||this).Ac=t,e}function Bc(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw vu()}}var zc=(Wc.prototype.vc=function(t){var e=null==this.path?null:this.path.child(t),n=new Wc(this.pc,this.methodName,e,!1,this.fieldTransforms,this.se);return n.Sc(t),n},Wc.prototype.Dc=function(t){var e=null==this.path?null:this.path.child(t),n=new Wc(this.pc,this.methodName,e,!1,this.fieldTransforms,this.se);return n.bc(),n},Wc.prototype.Cc=function(t){return new Wc(this.pc,this.methodName,null,!0,this.fieldTransforms,this.se)},Wc.prototype.Fc=function(t){var e=null===this.path||this.path.q()?"":" (found in field "+this.path.toString()+")";return new jr(Vr.INVALID_ARGUMENT,"Function "+this.methodName+"() called with invalid data. "+t+e)},Wc.prototype.contains=function(e){return void 0!==this.se.find(function(t){return e.U(t)})||void 0!==this.fieldTransforms.find(function(t){return e.U(t.field)})},Wc.prototype.bc=function(){if(null!==this.path)for(var t=0;t<this.path.length;t++)this.Sc(this.path.get(t))},Wc.prototype.Sc=function(t){if(0===t.length)throw this.Fc("Document fields must not be empty");if(Bc(this.pc)&&Pc.test(t))throw this.Fc('Document fields cannot begin and end with "__"')},Wc),Kc=function(t,e){this.ci=t,this.key=e},Yc=(Hc.prototype.kc=function(t,e){var n=new zc(0,t,ii.H);Zc("Data must be an object, but it was:",n,e);var r=this.$c(e,n);return new Cc(new Eo(r),null,n.fieldTransforms)},Hc.prototype.Mc=function(t,e,n){var r=new zc(2,t,ii.H);Zc("Data must be an object, but it was:",r,e);var i,o,s=this.$c(e,r);if(n){for(var u=new yi(ii.k),a=0,h=n;a<h.length;a++){var c=h[a],f=void 0;if(c instanceof dc)f=c.Ic;else{if("string"!=typeof c)throw vu();f=Jc(t,c)}if(!r.contains(f))throw new jr(Vr.INVALID_ARGUMENT,"Field '"+f+"' is specified in your field mask but missing from your input data.");u=u.add(f)}i=eo.Kt(u),o=r.fieldTransforms.filter(function(t){return i.zt(t.field)})}else i=eo.Gt(r.se),o=r.fieldTransforms;return new Cc(new Eo(s),i,o)},Hc.prototype.Lc=function(o,t){var s=this,u=new zc(1,o,ii.H);Zc("Data must be an object, but it was:",u,t);var a=new yi(ii.k),h=Eo._e();wi(t,function(t,e){var n=Jc(o,t),r=u.Dc(n);if((e=s.Oc(e,r))instanceof wc)a=a.add(n);else{var i=s.xc(e,r);null!=i&&(a=a.add(n),h.set(n,i))}});var e=eo.Kt(a);return new Vc(h.he(),e,u.fieldTransforms)},Hc.prototype.Bc=function(t,e,n,r){var i=new zc(1,t,ii.H),o=[Xc(t,e)],s=[n];if(r.length%2!=0)throw new jr(Vr.INVALID_ARGUMENT,"Function "+t+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var u=0;u<r.length;u+=2)o.push(Xc(t,r[u])),s.push(r[u+1]);for(var a=new yi(ii.k),h=Eo._e(),c=0;c<o.length;++c){var f=o[c],l=i.Dc(f),p=this.Oc(s[c],l);if(p instanceof wc)a=a.add(f);else{var d=this.xc(p,l);null!=d&&(a=a.add(f),h.set(f,d))}}var y=eo.Kt(a);return new Vc(h.he(),y,i.fieldTransforms)},Hc.prototype.qc=function(t,e,n){void 0===n&&(n=!1);var r=new zc(n?4:3,t,ii.H);return this.xc(e,r)},Hc.prototype.Oc=function(t,e){try{return this.Nc(t)}catch(t){var n=$c(t);throw e.Fc(n)}},Hc.prototype.xc=function(t,e){if(Qc(t=this.Oc(t,e)))return Zc("Unsupported field value:",e,t),this.$c(t,e);if(t instanceof Ec)return this.Uc(t,e),null;if(e.path&&e.se.push(e.path),t instanceof Array){if(e.yc&&4!==e.pc)throw e.Fc("Nested arrays are not supported");return this.Qc(t,e)}return this.Wc(t,e)},Hc.prototype.$c=function(t,r){var i=this,o={};return bi(t)?r.path&&0<r.path.length&&r.se.push(r.path):wi(t,function(t,e){var n=i.xc(e,r.vc(t));null!=n&&(o[t]=n)}),{mapValue:{fields:o}}},Hc.prototype.Qc=function(t,e){for(var n=[],r=0,i=0,o=t;i<o.length;i++){var s=o[i],u=this.xc(s,e.Cc(r));null==u&&(u={nullValue:"NULL_VALUE"}),n.push(u),r++}return{arrayValue:{values:n}}},Hc.prototype.Uc=function(t,e){if(!Bc(e.pc))throw e.Fc(t.Rc+"() can only be used with update() and set()");if(null===e.path)throw e.Fc(t.Rc+"() is not currently supported inside arrays");if(t instanceof wc){if(2!==e.pc)throw 1===e.pc?e.Fc("FieldValue.delete() can only appear at the top level of your update data"):e.Fc("FieldValue.delete() cannot be used with set() unless you pass {merge:true}");e.se.push(e.path)}else if(t instanceof Nc)e.fieldTransforms.push(new no(e.path,Ki.instance));else if(t instanceof kc){var n=this.jc(t.Rc,t.Ac),r=new Hi(n);e.fieldTransforms.push(new no(e.path,r))}else if(t instanceof Rc){var i=this.jc(t.Rc,t.Ac),o=new Wi(i);e.fieldTransforms.push(new no(e.path,o))}else if(t instanceof xc){var s=this.qc("FieldValue.increment",t.mc),u=new Qi(this.serializer,s);e.fieldTransforms.push(new no(e.path,u))}else vu()},Hc.prototype.Wc=function(t,e){if(null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return this.serializer.Ti(t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=Gr.fromDate(t);return{timestampValue:this.serializer.F(n)}}if(t instanceof Gr){var r=new Gr(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:this.serializer.F(r)}}if(t instanceof Lc)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof lc)return{bytesValue:this.serializer.Ei(t)};if(t instanceof Kc)return{referenceValue:this.serializer.wi(t.key.path,t.ci)};throw e.Fc("Unsupported field value: "+nc(t))},Hc.prototype.jc=function(r,t){var i=this;return t.map(function(t,e){var n=new zc(3,r,ii.H);return i.xc(t,n.Cc(e))})},Hc);function Hc(t,e){this.serializer=t,this.Nc=e}function Wc(t,e,n,r,i,o){this.pc=t,this.methodName=e,this.path=n,this.yc=r,void 0===i&&this.bc(),this.yc=void 0!==r&&r,this.fieldTransforms=i||[],this.se=o||[]}function Qc(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Gr||t instanceof Lc||t instanceof lc||t instanceof Kc||t instanceof Ec)}function Zc(t,e,n){if(!Qc(n)||!ec(n)){var r=nc(n);throw"an object"===r?e.Fc(t+" a custom object"):e.Fc(t+" "+r)}}function Xc(t,e){if(e instanceof dc)return e.Ic;if("string"==typeof e)return Jc(t,e);throw new jr(Vr.INVALID_ARGUMENT,"Function "+t+"() called with invalid data. Field path arguments must be of type string or FieldPath.")}function Jc(t,e){try{return function(e){if(0<=e.search(mc))throw new jr(Vr.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(dc.bind.apply(dc,i([void 0],e.split("."))))}catch(t){throw new jr(Vr.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e).Ic}catch(e){var n=$c(e);throw new jr(Vr.INVALID_ARGUMENT,"Function "+t+"() called with invalid data. "+n)}}function $c(t){return t instanceof Error?t.message:t.toString()}var tf,ef,nf=(vf.prototype.Jc=function(){return 1===this.state||2===this.state||4===this.state},vf.prototype.Xc=function(){return 2===this.state},vf.prototype.start=function(){3!==this.state?this.auth():this.Zc()},vf.prototype.stop=function(){return f(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.Jc()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},vf.prototype.t_=function(){this.state=0,this.oh.reset()},vf.prototype.e_=function(){var t=this;this.Xc()&&null===this.Yc&&(this.Yc=this.Nr.Wr(this.Kc,6e4,function(){return t.s_()}))},vf.prototype.i_=function(t){this.n_(),this.stream.send(t)},vf.prototype.s_=function(){return f(this,void 0,void 0,function(){return y(this,function(t){return this.Xc()?[2,this.close(0)]:[2]})})},vf.prototype.n_=function(){this.Yc&&(this.Yc.cancel(),this.Yc=null)},vf.prototype.close=function(e,n){return f(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.n_(),this.oh.cancel(),this.Hc++,3!==e?this.oh.reset():n&&n.code===Vr.RESOURCE_EXHAUSTED?(du(n.toString()),du("Using maximum backoff delay to prevent overloading the backend."),this.oh.qr()):n&&n.code===Vr.UNAUTHENTICATED&&this.zc._(),null!==this.stream&&(this.r_(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.h_(n)];case 1:return t.sent(),[2]}})})},vf.prototype.r_=function(){},vf.prototype.auth=function(){var n=this;this.state=1;var t=this.o_(this.Hc),e=this.Hc;this.zc.getToken().then(function(t){n.Hc===e&&n.a_(t)},function(e){t(function(){var t=new jr(Vr.UNKNOWN,"Fetching auth token failed: "+e.message);return n.u_(t)})})},vf.prototype.a_=function(t){var e=this,n=this.o_(this.Hc);this.stream=this.c_(t),this.stream.__(function(){n(function(){return e.state=2,e.listener.__()})}),this.stream.h_(function(t){n(function(){return e.u_(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},vf.prototype.Zc=function(){var t=this;this.state=4,this.oh.Ur(function(){return f(t,void 0,void 0,function(){return y(this,function(t){return this.state=0,this.start(),[2]})})})},vf.prototype.u_=function(t){return pu("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},vf.prototype.o_=function(e){var n=this;return function(t){n.Nr.Zr(function(){return n.Hc===e?t():(pu("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},vf),rf=(n(yf,ef=nf),yf.prototype.c_=function(t){return this.Gc.l_("Listen",t)},yf.prototype.onMessage=function(t){this.oh.reset();var e=this.serializer.Fi(t),n=this.serializer.ki(t);return this.listener.d_(e,n)},yf.prototype.f_=function(t){var e={};e.database=this.serializer.pi,e.addTarget=this.serializer.xe(t);var n=this.serializer.en(t);n&&(e.labels=n),this.i_(e)},yf.prototype.T_=function(t){var e={};e.database=this.serializer.pi,e.removeTarget=t,this.i_(e)},yf),of=(n(df,tf=nf),Object.defineProperty(df.prototype,"I_",{get:function(){return this.E_},enumerable:!0,configurable:!0}),df.prototype.start=function(){this.E_=!1,tf.prototype.start.call(this)},df.prototype.r_=function(){this.E_&&this.w_([])},df.prototype.c_=function(t){return this.Gc.l_("Write",t)},df.prototype.onMessage=function(t){if(gu(!!t.streamToken),this.lastStreamToken=this.serializer.Ii(t.streamToken),this.E_){this.oh.reset();var e=this.serializer.Wi(t.writeResults,t.commitTime),n=this.serializer.fromVersion(t.commitTime);return this.listener.R_(n,e)}return gu(!t.writeResults||0===t.writeResults.length),this.E_=!0,this.listener.A_()},df.prototype.m_=function(){var t={};t.database=this.serializer.pi,this.i_(t)},df.prototype.w_=function(t){var e=this,n={streamToken:this.serializer.Ei(this.lastStreamToken),writes:t.map(function(t){return e.serializer.$i(t)})};this.i_(n)},df),sf=(pf.prototype.P_=function(t){return new of(this.Nr,this.Gc,this.credentials,this.serializer,t)},pf.prototype.V_=function(t){return new rf(this.Nr,this.Gc,this.credentials,this.serializer,t)},pf.prototype.commit=function(t){var e=this,n={database:this.serializer.pi,writes:t.map(function(t){return e.serializer.$i(t)})};return this.g_("Commit",n).then(function(t){return e.serializer.Wi(t.writeResults,t.commitTime)})},pf.prototype.p_=function(e){var i=this,t={database:this.serializer.pi,documents:e.map(function(t){return i.serializer.mi(t)})};return this.y_("BatchGetDocuments",t).then(function(t){var n=As();t.forEach(function(t){var e=i.serializer.Ci(t);n=n.nt(e.key,e)});var r=[];return e.forEach(function(t){var e=n.get(t);gu(!!e),r.push(e)}),r})},pf.prototype.g_=function(e,n){var r=this;return this.credentials.getToken().then(function(t){return r.Gc.g_(e,n,t)}).catch(function(t){throw t.code===Vr.UNAUTHENTICATED&&r.credentials._(),t})},pf.prototype.y_=function(e,n){var r=this;return this.credentials.getToken().then(function(t){return r.Gc.y_(e,n,t)}).catch(function(t){throw t.code===Vr.UNAUTHENTICATED&&r.credentials._(),t})},pf),uf=(lf.prototype.p_=function(r){return f(this,void 0,void 0,function(){var e,n=this;return y(this,function(t){switch(t.label){case 0:if(this.F_(),0<this.mutations.length)throw new jr(Vr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,this.b_.p_(r)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof Lo||t instanceof Oo?n.N_(t):vu()}),e)]}})})},lf.prototype.set=function(t,e){this.write(e.gc(t,this.Zt(t))),this.C_.add(t)},lf.prototype.update=function(t,e){try{this.write(e.gc(t,this.k_(t)))}catch(t){this.D_=t}this.C_.add(t)},lf.prototype.delete=function(t){this.write([new go(t,this.Zt(t))]),this.C_.add(t)},lf.prototype.commit=function(){return f(this,void 0,void 0,function(){var e,n=this;return y(this,function(t){switch(t.label){case 0:if(this.F_(),this.D_)throw this.D_;return e=this.v_,this.mutations.forEach(function(t){e=e.remove(t.key)}),e.forEach(function(t,e){n.mutations.push(new mo(t,n.Zt(t)))}),[4,this.b_.commit(this.mutations)];case 1:return t.sent(),this.S_=!0,[2]}})})},lf.prototype.N_=function(t){var e;if(t instanceof Oo)e=t.version;else{if(!(t instanceof Lo))throw vu();e=Br.S()}var n=this.v_.get(t.key);if(null!==n){if(!e.isEqual(n))throw new jr(Vr.ABORTED,"Document version changed between two reads.")}else this.v_=this.v_.nt(t.key,e)},lf.prototype.Zt=function(t){var e=this.v_.get(t);return!this.C_.has(t)&&e?ro.updateTime(e):ro.NONE},lf.prototype.k_=function(t){var e=this.v_.get(t);if(this.C_.has(t)||!e)return ro.exists(!0);if(e.isEqual(Br.S()))throw new jr(Vr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return ro.updateTime(e)},lf.prototype.write=function(t){this.F_(),this.mutations=this.mutations.concat(t)},lf.prototype.F_=function(){},lf),af=(ff.prototype.B_=function(){var t=this;0===this.L_&&(this.q_("Unknown"),this.O_=this.jr.Wr("online_state_timeout",1e4,function(){return t.O_=null,t.U_("Backend didn't respond within 10 seconds."),t.q_("Offline"),Promise.resolve()}))},ff.prototype.Q_=function(t){"Online"===this.state?this.q_("Unknown"):(this.L_++,1<=this.L_&&(this.W_(),this.U_("Connection failed 1 times. Most recent error: "+t.toString()),this.q_("Offline")))},ff.prototype.set=function(t){this.W_(),this.L_=0,"Online"===t&&(this.x_=!1),this.q_(t)},ff.prototype.q_=function(t){t!==this.state&&(this.state=t,this.M_(t))},ff.prototype.U_=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.x_?(du(e),this.x_=!1):pu("OnlineStateTracker",e)},ff.prototype.W_=function(){null!==this.O_&&(this.O_.cancel(),this.O_=null)},ff),hf=(cf.prototype.start=function(){return this.enableNetwork()},cf.prototype.enableNetwork=function(){return f(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return this.networkEnabled=!0,this.J_()?(e=this.nl,[4,this.j_.Fo()]):[3,3];case 1:return e.lastStreamToken=t.sent(),this.al()?this.ul():this.Z_.set("Unknown"),[4,this.cl()];case 2:t.sent(),t.label=3;case 3:return[2]}})})},cf.prototype.disableNetwork=function(){return f(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.networkEnabled=!1,[4,this._l()];case 1:return t.sent(),this.Z_.set("Offline"),[2]}})})},cf.prototype._l=function(){return f(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return[4,this.nl.stop()];case 1:return t.sent(),[4,this.tl.stop()];case 2:return t.sent(),0<this.K_.length&&(pu("RemoteStore","Stopping write stream with "+this.K_.length+" pending writes"),this.K_=[]),this.ll(),[2]}})})},cf.prototype.mu=function(){return f(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return pu("RemoteStore","RemoteStore shutting down."),this.networkEnabled=!1,[4,this._l()];case 1:return t.sent(),this.H_.mu(),this.Z_.set("Unknown"),[2]}})})},cf.prototype.listen=function(t){this.G_.has(t.targetId)||(this.G_.set(t.targetId,t),this.al()?this.ul():this.tl.Xc()&&this.dl(t))},cf.prototype.fl=function(t){this.G_.delete(t),this.tl.Xc()&&this.Tl(t),0===this.G_.size&&(this.tl.Xc()?this.tl.e_():this.J_()&&this.Z_.set("Unknown"))},cf.prototype.ui=function(t){return this.G_.get(t)||null},cf.prototype.ai=function(t){return this.El.ai(t)},cf.prototype.dl=function(t){this.z_.Bs(t.targetId),this.tl.f_(t)},cf.prototype.Tl=function(t){this.z_.Bs(t),this.tl.T_(t)},cf.prototype.ul=function(){this.z_=new Ks(this),this.tl.start(),this.Z_.B_()},cf.prototype.al=function(){return this.J_()&&!this.tl.Jc()&&0<this.G_.size},cf.prototype.J_=function(){return this.isPrimary&&this.networkEnabled},cf.prototype.ll=function(){this.z_=null},cf.prototype.el=function(){return f(this,void 0,void 0,function(){var n=this;return y(this,function(t){return this.G_.forEach(function(t,e){n.dl(t)}),[2]})})},cf.prototype.sl=function(e){return f(this,void 0,void 0,function(){return y(this,function(t){return this.ll(),this.al()?(this.Z_.Q_(e),this.ul()):this.Z_.set("Unknown"),[2]})})},cf.prototype.il=function(n,r){return f(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return this.Z_.set("Online"),n instanceof Ms&&2===n.state&&n.cause?[2,this.Il(n)]:(n instanceof Vs?this.z_.zs(n):n instanceof js?this.z_.si(n):this.z_.Js(n),r.isEqual(Br.MIN)?[3,4]:[4,this.j_.ea()]);case 1:return e=t.sent(),0<=r.D(e)?[4,this.wl(r)]:[3,3];case 2:t.sent(),t.label=3;case 3:t.label=4;case 4:return[2]}})})},cf.prototype.wl=function(r){var i=this,t=this.z_.ri(r);return t.Ts.forEach(function(t,e){if(0<t.resumeToken.Ot()){var n=i.G_.get(e);n&&i.G_.set(e,n.ss(t.resumeToken,r))}}),t.Es.forEach(function(t){var e=i.G_.get(t);if(e){i.G_.set(t,e.ss(Ti.xt,e.ts)),i.Tl(t);var n=new Es(e.target,t,1,e.sequenceNumber);i.dl(n)}}),this.El.tc(t)},cf.prototype.Il=function(t){var n=this,r=t.cause,i=Promise.resolve();return t.targetIds.forEach(function(e){i=i.then(function(){return f(n,void 0,void 0,function(){return y(this,function(t){return this.G_.has(e)?[2,(this.G_.delete(e),this.z_.removeTarget(e),this.El.Rl(e,r))]:[2]})})})}),i},cf.prototype.cl=function(){return f(this,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:return this.Al()?(e=0<this.K_.length?this.K_[this.K_.length-1].batchId:-1,[4,this.j_.nc(e)]):[3,5];case 1:return null!==(n=t.sent())?[3,2]:(0===this.K_.length&&this.nl.e_(),[3,4]);case 2:return this.ml(n),[4,this.cl()];case 3:t.sent(),t.label=4;case 4:t.label=5;case 5:return this.Pl()&&this.Vl(),[2]}})})},cf.prototype.Al=function(){return this.J_()&&this.K_.length<10},cf.prototype.gl=function(){return this.K_.length},cf.prototype.ml=function(t){this.K_.push(t),this.nl.Xc()&&this.nl.I_&&this.nl.w_(t.mutations)},cf.prototype.Pl=function(){return this.J_()&&!this.nl.Jc()&&0<this.K_.length},cf.prototype.Vl=function(){this.nl.start()},cf.prototype.rl=function(){return f(this,void 0,void 0,function(){return y(this,function(t){return this.nl.m_(),[2]})})},cf.prototype.ol=function(){var r=this;return this.j_.No(this.nl.lastStreamToken).then(function(){for(var t=0,e=r.K_;t<e.length;t++){var n=e[t];r.nl.w_(n.mutations)}}).catch(zh)},cf.prototype.R_=function(t,e){var n=this,r=this.K_.shift(),i=Su.from(r,t,e,this.nl.lastStreamToken);return this.El.pl(i).then(function(){return n.cl()})},cf.prototype.hl=function(n){return f(this,void 0,void 0,function(){var e=this;return y(this,function(t){return n&&0<this.K_.length?[2,(this.nl.I_?this.yl(n):this.bl(n)).then(function(){e.Pl()&&e.Vl()})]:[2]})})},cf.prototype.bl=function(e){return f(this,void 0,void 0,function(){return y(this,function(t){return Is(e.code)?[2,(pu("RemoteStore","RemoteStore error before completed handshake; resetting stream token: ",this.nl.lastStreamToken),this.nl.lastStreamToken=Ti.xt,this.j_.No(Ti.xt).catch(zh))]:[2]})})},cf.prototype.yl=function(i){return f(this,void 0,void 0,function(){var e,n,r=this;return y(this,function(t){return Is(n=i.code)&&n!==Vr.ABORTED?(e=this.K_.shift(),[2,(this.nl.t_(),this.El.vl(e.batchId,i).then(function(){return r.cl()}))]):[2]})})},cf.prototype.Sl=function(){return new uf(this.b_)},cf.prototype.X_=function(){return f(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.networkEnabled=!1,[4,this._l()];case 1:return t.sent(),this.Z_.set("Unknown"),[4,this.enableNetwork()];case 2:return t.sent(),[2]}})})},cf.prototype.Dl=function(){return f(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.J_()?(pu("RemoteStore","RemoteStore restarting streams for new credential"),[4,this.X_()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},cf.prototype.Cl=function(e){return f(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return(this.isPrimary=e)&&this.networkEnabled?[4,this.enableNetwork()]:[3,2];case 1:return t.sent(),[3,5];case 2:return e?[3,4]:[4,this._l()];case 3:t.sent(),this.Z_.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})},cf);function cf(t,e,n,r,i){var o=this;this.j_=t,this.b_=e,this.K_=[],this.G_=new Map,this.z_=null,this.networkEnabled=!1,this.isPrimary=!1,this.H_=i,this.H_.Y_(function(t){n.Zr(function(){return f(o,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.J_()?(pu("RemoteStore","Restarting streams for network reachability change."),[4,this.X_()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.Z_=new af(n,r),this.tl=this.b_.V_({__:this.el.bind(this),h_:this.sl.bind(this),d_:this.il.bind(this)}),this.nl=this.b_.P_({__:this.rl.bind(this),h_:this.hl.bind(this),A_:this.ol.bind(this),R_:this.R_.bind(this)})}function ff(t,e){this.jr=t,this.M_=e,this.state="Unknown",this.L_=0,this.O_=null,this.x_=!0}function lf(t){this.b_=t,this.v_=xs(),this.mutations=[],this.S_=!1,this.D_=null,this.C_=new Set}function pf(t,e,n,r){this.Nr=t,this.Gc=e,this.credentials=n,this.serializer=r}function df(t,e,n,r,i){var o=this;return(o=tf.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).serializer=r,o.E_=!1,o.lastStreamToken=Ti.xt,o}function yf(t,e,n,r,i){var o=this;return(o=ef.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).serializer=r,o}function vf(t,e,n,r,i,o){this.Nr=t,this.Kc=n,this.Gc=r,this.zc=i,this.listener=o,this.state=0,this.Hc=0,this.Yc=null,this.stream=null,this.oh=new Zu(t,e)}function gf(t,e){return"firestore_clients_"+t+"_"+e}function mf(t,e,n){var r="firestore_mutations_"+t+"_"+n;return e.t()&&(r+="_"+e.uid),r}function Ef(t,e){return"firestore_targets_"+t+"_"+e}function wf(t){this.key=t}function bf(t){this.key=t}function Tf(t,e,n){this.query=t,this.targetId=e,this.view=n}function If(t){this.key=t,this.Hd=!1}function Nf(){this.Cf=null,this.targetId=0,this.Ff=[]}var _f,Af,Sf=(il.Fl=function(t,e,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["pending","acknowledged","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new jr(r.error.code,r.error.message)),i?new il(t,e,r.state,o):(du("SharedClientState","Failed to parse mutation state for ID '"+e+"': "+n),null)},il.prototype.Nl=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},il),Df=(rl.Fl=function(t,e){var n=JSON.parse(e),r="object"==typeof n&&-1!==["not-current","current","rejected"].indexOf(n.state)&&(void 0===n.error||"object"==typeof n.error),i=void 0;return r&&n.error&&(r="string"==typeof n.error.message&&"string"==typeof n.error.code)&&(i=new jr(n.error.code,n.error.message)),r?new rl(t,n.state,i):(du("SharedClientState","Failed to parse target state for ID '"+t+"': "+e),null)},rl.prototype.Nl=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},rl),kf=(nl.Fl=function(t,e){for(var n=JSON.parse(e),r="object"==typeof n&&n.activeTargetIds instanceof Array,i=Cs(),o=0;r&&o<n.activeTargetIds.length;++o)r=Ai(n.activeTargetIds[o]),i=i.add(n.activeTargetIds[o]);return r?new nl(t,i):(du("SharedClientState","Failed to parse client data for instance '"+t+"': "+e),null)},nl),Rf=(el.Fl=function(t){var e=JSON.parse(t);return"object"==typeof e&&-1!==["Unknown","Online","Offline"].indexOf(e.onlineState)&&"string"==typeof e.clientId?new el(e.clientId,e.onlineState):(du("SharedClientState","Failed to parse online state: "+t),null)},el),xf=(tl.prototype.kl=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},tl.prototype.$l=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},tl.prototype.Nl=function(){var t={activeTargetIds:this.activeTargetIds.j(),updateTimeMs:Date.now()};return JSON.stringify(t)},tl),Of=($f.ho=function(t){return!(!t.window||null==t.window.localStorage)},$f.prototype.start=function(){return f(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,h,c,f,l=this;return y(this,function(t){switch(t.label){case 0:return[4,this.El.yu()];case 1:for(e=t.sent(),n=0,r=e;n<r.length;n++)(i=r[n])!==this.Ml&&(o=this.getItem(gf(this.persistenceKey,i)))&&(s=kf.Fl(i,o))&&(this.xl=this.xl.nt(s.clientId,s));for(this.Gl(),(u=this.storage.getItem(this.Kl))&&(a=this.zl(u))&&this.Hl(a),h=0,c=this.Bl;h<c.length;h++)f=c[h],this.Ol(f);return this.Bl=[],this.platform.window.addEventListener("unload",function(){return l.mu()}),this.Kh=!0,[2]}})})},$f.prototype.Cr=function(t){this.setItem(this.Ul,JSON.stringify(t))},$f.prototype.Yl=function(){return this.Jl(this.xl)},$f.prototype.Xl=function(n){var r=!1;return this.xl.forEach(function(t,e){e.activeTargetIds.has(n)&&(r=!0)}),r},$f.prototype.Zl=function(t){this.td(t,"pending")},$f.prototype.ed=function(t,e,n){this.td(t,e,n),this.sd(t)},$f.prototype.nd=function(t){var e="not-current";if(this.Xl(t)){var n=this.storage.getItem(Ef(this.persistenceKey,t));if(n){var r=Df.Fl(t,n);r&&(e=r.state)}}return this.rd.kl(t),this.Gl(),e},$f.prototype.hd=function(t){this.rd.$l(t),this.Gl()},$f.prototype.od=function(t){return this.rd.activeTargetIds.has(t)},$f.prototype.ad=function(t){this.removeItem(Ef(this.persistenceKey,t))},$f.prototype.ud=function(t,e,n){this._d(t,e,n)},$f.prototype.Gu=function(t,e,n){var r=this;e.forEach(function(t){r.sd(t)}),this.currentUser=t,n.forEach(function(t){r.Zl(t)})},$f.prototype.ld=function(t){this.dd(t)},$f.prototype.mu=function(){this.Kh&&(this.platform.window.removeEventListener("storage",this.Ll),this.removeItem(this.ql),this.Kh=!1)},$f.prototype.getItem=function(t){var e=this.storage.getItem(t);return pu("SharedClientState","READ",t,e),e},$f.prototype.setItem=function(t,e){pu("SharedClientState","SET",t,e),this.storage.setItem(t,e)},$f.prototype.removeItem=function(t){pu("SharedClientState","REMOVE",t),this.storage.removeItem(t)},$f.prototype.Ol=function(u){var t=this;if(u.storageArea===this.storage){if(pu("SharedClientState","EVENT",u.key,u.newValue),u.key===this.ql)return void du("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Nr.Ih(function(){return f(t,void 0,void 0,function(){var e,n,r,i,o,s;return y(this,function(t){if(this.Kh){if(null!==u.key)if(this.Ql.test(u.key)){if(null==u.newValue)return e=this.fd(u.key),[2,this.Td(e,null)];if(n=this.Ed(u.key,u.newValue))return[2,this.Td(n.clientId,n)]}else if(this.Wl.test(u.key)){if(null!==u.newValue&&(r=this.Id(u.key,u.newValue)))return[2,this.wd(r)]}else if(this.jl.test(u.key)){if(null!==u.newValue&&(i=this.Rd(u.key,u.newValue)))return[2,this.Ad(i)]}else if(u.key===this.Kl){if(null!==u.newValue&&(o=this.zl(u.newValue)))return[2,this.Hl(o)]}else u.key===this.Ul&&(s=function(t){var e=Vu.Fr;if(null!=t)try{var n=JSON.parse(t);gu("number"==typeof n),e=n}catch(t){du("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(u.newValue))!==Vu.Fr&&this.vr(s)}else this.Bl.push(u);return[2]})})})}},Object.defineProperty($f.prototype,"rd",{get:function(){return this.xl.get(this.Ml)},enumerable:!0,configurable:!0}),$f.prototype.Gl=function(){this.setItem(this.ql,this.rd.Nl())},$f.prototype.td=function(t,e,n){var r=new Sf(this.currentUser,t,e,n),i=mf(this.persistenceKey,this.currentUser,t);this.setItem(i,r.Nl())},$f.prototype.sd=function(t){var e=mf(this.persistenceKey,this.currentUser,t);this.removeItem(e)},$f.prototype.dd=function(t){var e={clientId:this.Ml,onlineState:t};this.storage.setItem(this.Kl,JSON.stringify(e))},$f.prototype._d=function(t,e,n){var r=Ef(this.persistenceKey,t),i=new Df(t,e,n);this.setItem(r,i.Nl())},$f.prototype.fd=function(t){var e=this.Ql.exec(t);return e?e[1]:null},$f.prototype.Ed=function(t,e){var n=this.fd(t);return kf.Fl(n,e)},$f.prototype.Id=function(t,e){var n=this.Wl.exec(t),r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return Sf.Fl(new Or(i),r,e)},$f.prototype.Rd=function(t,e){var n=this.jl.exec(t),r=Number(n[1]);return Df.Fl(r,e)},$f.prototype.zl=function(t){return Rf.Fl(t)},$f.prototype.wd=function(e){return f(this,void 0,void 0,function(){return y(this,function(t){return e.user.uid===this.currentUser.uid?[2,this.El.md(e.batchId,e.state,e.error)]:(pu("SharedClientState","Ignoring mutation for non-active user "+e.user.uid),[2])})})},$f.prototype.Ad=function(t){return this.El.Pd(t.targetId,t.state,t.error)},$f.prototype.Td=function(t,e){var n=this,r=e?this.xl.nt(t,e):this.xl.remove(t),i=this.Jl(this.xl),o=this.Jl(r),s=[],u=[];return o.forEach(function(t){i.has(t)||s.push(t)}),i.forEach(function(t){o.has(t)||u.push(t)}),this.El.Vd(s,u).then(function(){n.xl=r})},$f.prototype.Hl=function(t){this.xl.get(t.clientId)&&this.M_(t.onlineState)},$f.prototype.Jl=function(t){var n=Cs();return t.forEach(function(t,e){n=n.kt(e.activeTargetIds)}),n},$f),Lf=(Jf.prototype.Zl=function(t){},Jf.prototype.ed=function(t,e,n){},Jf.prototype.nd=function(t){return this.gd.kl(t),this.pd[t]||"not-current"},Jf.prototype.ud=function(t,e,n){this.pd[t]=e},Jf.prototype.hd=function(t){this.gd.$l(t)},Jf.prototype.od=function(t){return this.gd.activeTargetIds.has(t)},Jf.prototype.ad=function(t){delete this.pd[t]},Jf.prototype.Yl=function(){return this.gd.activeTargetIds},Jf.prototype.Xl=function(t){return this.gd.activeTargetIds.has(t)},Jf.prototype.start=function(){return this.gd=new xf,Promise.resolve()},Jf.prototype.Gu=function(t,e,n){},Jf.prototype.ld=function(t){},Jf.prototype.mu=function(){},Jf.prototype.Cr=function(t){},Jf),Pf=(Object.defineProperty(Xf.prototype,"Dd",{get:function(){return this.yd},enumerable:!0,configurable:!0}),Xf.prototype.Cd=function(t,e){var u=this,a=e?e.Fd:new qs,h=e?e.Sd:this.Sd,c=e?e._s:this._s,f=h,l=!1,p=this.query.je()&&h.size===this.query.limit?h.last():null,d=this.query.Ke()&&h.size===this.query.limit?h.first():null;if(t.ut(function(t,e){var n=h.get(t),r=e instanceof Oo?e:null;r=r&&(u.query.matches(r)?r:null);var i=!!n&&u._s.has(n.key),o=!!r&&(r.te||u._s.has(r.key)&&r.hasCommittedMutations),s=!1;n&&r?n.data().isEqual(r.data())?i!==o&&(a.track({type:3,doc:r}),s=!0):u.Nd(n,r)||(a.track({type:2,doc:r}),s=!0,(p&&0<u.query.Be(r,p)||d&&u.query.Be(r,d)<0)&&(l=!0)):!n&&r?(a.track({type:0,doc:r}),s=!0):n&&!r&&(a.track({type:1,doc:n}),s=!0,(p||d)&&(l=!0)),s&&(c=r?(f=f.add(r),o?c.add(t):c.delete(t)):(f=f.delete(t),c.delete(t)))}),this.query.je()||this.query.Ke())for(;f.size>this.query.limit;){var n=this.query.je()?f.last():f.first();f=f.delete(n.key),c=c.delete(n.key),a.track({type:1,doc:n})}return{Sd:f,Fd:a,kd:l,_s:c}},Xf.prototype.Nd=function(t,e){return t.te&&e.hasCommittedMutations&&!e.te},Xf.prototype.ir=function(t,e,n){var o=this,r=this.Sd;this.Sd=t.Sd,this._s=t._s;var i=t.Fd.us();i.sort(function(t,e){return r=t.type,i=e.type,n(r)-n(i)||o.query.Be(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return vu()}}var r,i}),this.$d(n);var s=e?this.Md():[],u=0===this.vd.size&&this.ms?1:0,a=u!==this.bd;return this.bd=u,0!==i.length||a?{snapshot:new Fs(this.query,t.Sd,r,i,t._s,0==u,a,!1),Ld:s}:{Ld:s}},Xf.prototype.Od=function(t){return this.ms&&"Offline"===t?(this.ms=!1,this.ir({Sd:this.Sd,Fd:new qs,_s:this._s,kd:!1},!1)):{Ld:[]}},Xf.prototype.xd=function(t){return!this.yd.has(t)&&!!this.Sd.has(t)&&!this.Sd.get(t).te},Xf.prototype.$d=function(t){var e=this;t&&(t.Ps.forEach(function(t){return e.yd=e.yd.add(t)}),t.Vs.forEach(function(t){}),t.gs.forEach(function(t){return e.yd=e.yd.delete(t)}),this.ms=t.ms)},Xf.prototype.Md=function(){var e=this;if(!this.ms)return[];var n=this.vd;this.vd=Ls(),this.Sd.forEach(function(t){e.xd(t.key)&&(e.vd=e.vd.add(t.key))});var r=[];return n.forEach(function(t){e.vd.has(t)||r.push(new bf(t))}),this.vd.forEach(function(t){n.has(t)||r.push(new wf(t))}),r},Xf.prototype.Bd=function(t){this.yd=t.uc,this.vd=Ls();var e=this.Cd(t.documents);return this.ir(e,!0)},Xf.prototype.qd=function(){return Fs.fs(this.query,this.Sd,this._s,0===this.bd)},Xf),Cf=(Zf.prototype.Wd=function(){this.jd()},Zf.prototype.jd=function(){var t=this;this.oh.Ur(function(){return f(t,void 0,void 0,function(){var e,n,r=this;return y(this,function(t){return e=this.Ud.Sl(),(n=this.Kd(e))&&n.then(function(t){r.jr.Zr(function(){return e.commit().then(function(){r.zr.resolve(t)}).catch(function(t){r.Gd(t)})})}).catch(function(t){r.Gd(t)}),[2]})})})},Zf.prototype.Kd=function(t){try{var e=this.updateFunction(t);return!Ni(e)&&e.catch&&e.then?e:(this.zr.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.zr.reject(t),null}},Zf.prototype.Gd=function(t){var e=this;0<this.Qd&&this.zd(t)?(--this.Qd,this.jr.Zr(function(){return e.jd(),Promise.resolve()})):this.zr.reject(t)},Zf.prototype.zd=function(t){if("FirebaseError"!==t.name)return!1;var e=t.code;return"aborted"===e||"failed-precondition"===e||!Is(e)},Zf),Vf=(Object.defineProperty(Qf.prototype,"uf",{get:function(){return!0},enumerable:!0,configurable:!0}),Qf.prototype.subscribe=function(t){this.Xd=t},Qf.prototype.listen=function(s){return f(this,void 0,void 0,function(){var e,n,r,i,o;return y(this,function(t){switch(t.label){case 0:return this.cf("listen()"),(r=this.Zd.get(s))?(e=r.targetId,this.Yd.nd(e),n=r.view.qd(),[3,4]):[3,1];case 1:return[4,this.j_.hc(s.xe())];case 2:return i=t.sent(),o=this.Yd.nd(i.targetId),e=i.targetId,[4,this._f(s,e,"current"===o)];case 3:n=t.sent(),this.uf&&this.Ud.listen(i),t.label=4;case 4:return[2,(this.Xd.d_([n]),e)]}})})},Qf.prototype._f=function(u,a,h){return f(this,void 0,void 0,function(){var e,n,r,i,o,s;return y(this,function(t){switch(t.label){case 0:return[4,this.j_.ac(u,!0)];case 1:return e=t.sent(),n=new Pf(u,e.uc),r=n.Cd(e.documents),i=Bs.As(a,h&&"Offline"!==this.onlineState),o=n.ir(r,this.uf,i),this.lf(a,o.Ld),s=new Tf(u,a,n),[2,(this.Zd.set(u,s),this.tf.has(a)?this.tf.get(a).push(u):this.tf.set(a,[u]),o.snapshot)]}})})},Qf.prototype.fl=function(i){return f(this,void 0,void 0,function(){var e,n,r=this;return y(this,function(t){switch(t.label){case 0:return this.cf("unlisten()"),e=this.Zd.get(i),1<(n=this.tf.get(e.targetId)).length?[2,(this.tf.set(e.targetId,n.filter(function(t){return!t.isEqual(i)})),void this.Zd.delete(i))]:this.uf?(this.Yd.hd(e.targetId),this.Yd.Xl(e.targetId)?[3,2]:[4,this.j_.oc(e.targetId,!1).then(function(){r.Yd.ad(e.targetId),r.Ud.fl(e.targetId),r.df(e.targetId)}).catch(zh)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return this.df(e.targetId),[4,this.j_.oc(e.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})},Qf.prototype.write=function(r,i){return f(this,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:this.cf("write()"),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.j_.Ju(r)];case 2:return e=t.sent(),[3,4];case 3:if("IndexedDbTransactionError"===(n=t.sent()).name)return[2,(du("SyncEngine","Dropping write that cannot be persisted: "+n),void i.reject(new jr(Vr.UNAVAILABLE,"Failed to persist write: "+n)))];throw n;case 4:return this.Yd.Zl(e.batchId),this.ff(e.batchId,i),[4,this.Tf(e.zn)];case 5:return t.sent(),[4,this.Ud.cl()];case 6:return t.sent(),[2]}})})},Qf.prototype.runTransaction=function(t,e,n){new Cf(t,this.Ud,e,n).Wd()},Qf.prototype.tc=function(n){return f(this,void 0,void 0,function(){var e,r=this;return y(this,function(t){switch(t.label){case 0:this.cf("applyRemoteEvent()"),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.j_.tc(n)];case 2:return e=t.sent(),n.Ts.forEach(function(t,e){var n=r.if.get(e);n&&(gu(t.Ps.size+t.Vs.size+t.gs.size<=1),0<t.Ps.size?n.Hd=!0:0<t.Vs.size?gu(n.Hd):0<t.gs.size&&(gu(n.Hd),n.Hd=!1))}),[4,this.Tf(e,n)];case 3:return t.sent(),[3,6];case 4:return[4,zh(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},Qf.prototype.Od=function(r,t){this.cf("applyOnlineStateChange()");var i=[];this.Zd.forEach(function(t,e){var n=e.view.Od(r);n.snapshot&&i.push(n.snapshot)}),this.Xd.Ef(r),this.Xd.d_(i),this.onlineState=r},Qf.prototype.Rl=function(u,a){return f(this,void 0,void 0,function(){var e,n,r,i,o,s=this;return y(this,function(t){switch(t.label){case 0:return this.cf("rejectListens()"),this.Yd.ud(u,"rejected",a),e=this.if.get(u),(n=e&&e.key)?(this.sf=this.sf.remove(n),this.if.delete(u),this.If(),r=(r=new ai(si.k)).nt(n,new Lo(n,Br.S())),i=Ls().add(n),o=new Gs(Br.MIN,new Map,new yi(wu),r,i),[2,this.tc(o)]):[4,this.j_.oc(u,!1).then(function(){return s.df(u,a)}).catch(zh)];case 1:return t.sent(),[2]}})})},Qf.prototype.pl=function(r){return f(this,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:this.cf("applySuccessfulWrite()"),e=r.batch.batchId,this.wf(e,null),this.Rf(e),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.j_.Do(r)];case 2:return n=t.sent(),this.Yd.ed(e,"acknowledged"),[4,this.Tf(n)];case 3:return t.sent(),[3,6];case 4:return[4,zh(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},Qf.prototype.vl=function(n,r){return f(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:this.cf("rejectFailedWrite()"),this.wf(n,r),this.Rf(n),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.j_.Zu(n)];case 2:return e=t.sent(),this.Yd.ed(n,"rejected",r),[4,this.Tf(e)];case 3:return t.sent(),[3,6];case 4:return[4,zh(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},Qf.prototype.Af=function(r){return f(this,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:return this.Ud.J_()||pu("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),[4,this.j_.qo()];case 1:return-1===(e=t.sent())?[2,void r.resolve()]:((n=this.hf.get(e)||[]).push(r),this.hf.set(e,n),[2])}})})},Qf.prototype.Rf=function(t){(this.hf.get(t)||[]).forEach(function(t){t.resolve()}),this.hf.delete(t)},Qf.prototype.mf=function(e){this.hf.forEach(function(t){t.forEach(function(t){t.reject(new jr(Vr.CANCELLED,e))})}),this.hf.clear()},Qf.prototype.ff=function(t,e){var n=this.rf[this.currentUser.s()];n=(n=n||new ai(wu)).nt(t,e),this.rf[this.currentUser.s()]=n},Qf.prototype.wf=function(t,e){var n=this.rf[this.currentUser.s()];if(n){var r=n.get(t);r&&(e?r.reject(e):r.resolve(),n=n.remove(t)),this.rf[this.currentUser.s()]=n}},Qf.prototype.df=function(t,e){var n=this;void 0===e&&(e=null),this.Yd.hd(t);for(var r=0,i=this.tf.get(t);r<i.length;r++){var o=i[r];this.Zd.delete(o),e&&this.Xd.Pf(o,e)}if(this.tf.delete(t),this.uf){var s=this.nf.$n(t);this.nf.Nn(t),s.forEach(function(t){n.nf.Mn(t)||n.Vf(t)})}},Qf.prototype.Vf=function(t){var e=this.sf.get(t);null!==e&&(this.Ud.fl(e),this.sf=this.sf.remove(t),this.if.delete(e),this.If())},Qf.prototype.lf=function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n];i instanceof wf?(this.nf.vn(i.key,t),this.gf(i)):i instanceof bf?(pu("SyncEngine","Document no longer in limbo: "+i.key),this.nf.Dn(i.key,t),this.nf.Mn(i.key)||this.Vf(i.key)):vu()}},Qf.prototype.gf=function(t){var e=t.key;this.sf.get(e)||(pu("SyncEngine","New document in limbo: "+e),this.ef.push(e),this.If())},Qf.prototype.If=function(){for(;0<this.ef.length&&this.sf.size<this.Jd;){var t=this.ef.shift(),e=this.af.next();this.if.set(e,new If(t)),this.sf=this.sf.nt(t,e),this.Ud.listen(new Es(Vo.ve(t.path).xe(),e,2,Vu.Fr))}},Qf.prototype.pf=function(){return this.sf},Qf.prototype.yf=function(){return this.ef},Qf.prototype.Tf=function(r,a){return f(this,void 0,void 0,function(){var o,s,e,u=this;return y(this,function(t){switch(t.label){case 0:return o=[],s=[],e=[],this.Zd.forEach(function(t,i){e.push(Promise.resolve().then(function(){var n=i.view.Cd(r);return n.kd?u.j_.ac(i.query,!1).then(function(t){var e=t.documents;return i.view.Cd(e,n)}):n}).then(function(t){var e=a&&a.Ts.get(i.targetId),n=i.view.ir(t,u.uf,e);if(u.lf(i.targetId,n.Ld),n.snapshot){u.uf&&u.Yd.ud(i.targetId,n.snapshot.fromCache?"not-current":"current"),o.push(n.snapshot);var r=Cu.br(i.targetId,n.snapshot);s.push(r)}}))}),[4,Promise.all(e)];case 1:return t.sent(),this.Xd.d_(o),[4,this.j_.ic(s)];case 2:return t.sent(),[2]}})})},Qf.prototype.cf=function(t){},Qf.prototype.Dl=function(r){return f(this,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:return e=!this.currentUser.isEqual(r),this.currentUser=r,e?(this.mf("'waitForPendingWrites' promise is rejected due to a user change."),[4,this.j_.Gu(r)]):[3,3];case 1:return n=t.sent(),this.Yd.Gu(r,n.Hu,n.Yu),[4,this.Tf(n.zu)];case 2:t.sent(),t.label=3;case 3:return[4,this.Ud.Dl()];case 4:return t.sent(),[2]}})})},Qf.prototype.enableNetwork=function(){return this.Ud.enableNetwork()},Qf.prototype.disableNetwork=function(){return this.Ud.disableNetwork()},Qf.prototype.ai=function(t){var e=this.if.get(t);if(e&&e.Hd)return Ls().add(e.key);var n=Ls(),r=this.tf.get(t);if(!r)return n;for(var i=0,o=r;i<o.length;i++){var s=o[i],u=this.Zd.get(s);n=n.kt(u.view.Dd)}return n},Qf),jf=(n(Wf,_f=Vf),Object.defineProperty(Wf.prototype,"uf",{get:function(){return!0===this.isPrimary},enumerable:!0,configurable:!0}),Wf.prototype.enableNetwork=function(){return this.j_.uu(!0),_f.prototype.enableNetwork.call(this)},Wf.prototype.disableNetwork=function(){return this.j_.uu(!1),_f.prototype.disableNetwork.call(this)},Wf.prototype.bf=function(r){return f(this,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:return[4,this.j_.ac(r.query,!0)];case 1:return e=t.sent(),n=r.view.Bd(e),[2,(this.isPrimary&&this.lf(r.targetId,n.Ld),n)]}})})},Wf.prototype.Od=function(t,e){this.uf&&0===e&&(_f.prototype.Od.call(this,t,e),this.Yd.ld(t)),this.uf||1!==e||_f.prototype.Od.call(this,t,e)},Wf.prototype.md=function(n,r,i){return f(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return this.cf("applyBatchState()"),[4,this.j_.lc(n)];case 1:return null===(e=t.sent())?[3,6]:"pending"!==r?[3,3]:[4,this.Ud.cl()];case 2:return t.sent(),[3,4];case 3:"acknowledged"===r||"rejected"===r?(this.wf(n,i||null),this.j_.dc(n)):vu(),t.label=4;case 4:return[4,this.Tf(e)];case 5:return t.sent(),[3,7];case 6:pu("SyncEngine","Cannot apply mutation batch with id: "+n),t.label=7;case 7:return[2]}})})},Wf.prototype.Cl=function(h){return f(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a=this;return y(this,function(t){switch(t.label){case 0:return!0!==h||!0===this.isPrimary?[3,3]:(this.isPrimary=!0,[4,this.Ud.Cl(!0)]);case 1:return t.sent(),e=this.Yd.Yl(),[4,this.vf(e.j())];case 2:for(n=t.sent(),r=0,i=n;r<i.length;r++)o=i[r],this.Ud.listen(o);return[3,7];case 3:return!1!==h||!1===this.isPrimary?[3,7]:(this.isPrimary=!1,s=[],u=Promise.resolve(),this.tf.forEach(function(t,e){a.Yd.od(e)?s.push(e):u=u.then(function(){return a.df(e),a.j_.oc(e,!0)}),a.Ud.fl(e)}),[4,u]);case 4:return t.sent(),[4,this.vf(s)];case 5:return t.sent(),this.Sf(),[4,this.Ud.Cl(!1)];case 6:t.sent(),t.label=7;case 7:return[2]}})})},Wf.prototype.Sf=function(){var n=this;this.if.forEach(function(t,e){n.Ud.fl(e)}),this.nf.kn(),this.if=new Map,this.sf=new ai(si.k)},Wf.prototype.vf=function(d){return f(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,h,c,f,l,p;return y(this,function(t){switch(t.label){case 0:e=[],n=[],r=0,i=d,t.label=1;case 1:return r<i.length?(o=i[r],s=void 0,(u=this.tf.get(o))&&0!==u.length?[4,this.j_.oc(o,!0)]:[3,8]):[3,14];case 2:return t.sent(),[4,this.j_.hc(u[0].xe())];case 3:s=t.sent(),a=0,h=u,t.label=4;case 4:return a<h.length?(c=h[a],f=this.Zd.get(c),[4,this.bf(f)]):[3,7];case 5:(l=t.sent()).snapshot&&n.push(l.snapshot),t.label=6;case 6:return a++,[3,4];case 7:return[3,12];case 8:return[4,this.j_.fc(o)];case 9:return p=t.sent(),[4,this.j_.hc(p)];case 10:return s=t.sent(),[4,this._f(this.Df(p),o,!1)];case 11:t.sent(),t.label=12;case 12:e.push(s),t.label=13;case 13:return r++,[3,1];case 14:return[2,(this.Xd.d_(n),e)]}})})},Wf.prototype.Df=function(t){return new Vo(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)},Wf.prototype.yu=function(){return this.j_.yu()},Wf.prototype.Pd=function(r,i,o){return f(this,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:return this.isPrimary?(pu("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!this.tf.has(r))return[3,8];switch(i){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,this.j_.ba()];case 3:return e=t.sent(),n=Gs.Rs(r,"current"===i),[4,this.Tf(e,n)];case 4:return t.sent(),[3,8];case 5:return[4,this.j_.oc(r,!0)];case 6:return t.sent(),this.df(r,o),[3,8];case 7:vu(),t.label=8;case 8:return[2]}})})},Wf.prototype.Vd=function(l,p){return f(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,h,c,f=this;return y(this,function(t){switch(t.label){case 0:if(!this.isPrimary)return[3,10];e=0,n=l,t.label=1;case 1:return e<n.length?(r=n[e],this.tf.has(r)?(pu("SyncEngine","Adding an already active target "+r),[3,5]):[4,this.j_.fc(r)]):[3,6];case 2:return i=t.sent(),[4,this.j_.hc(i)];case 3:return o=t.sent(),[4,this._f(this.Df(i),o.targetId,!1)];case 4:t.sent(),this.Ud.listen(o),t.label=5;case 5:return e++,[3,1];case 6:s=function(e){return y(this,function(t){switch(t.label){case 0:return u.tf.has(e)?[4,u.j_.oc(e,!1).then(function(){f.Ud.fl(e),f.df(e)}).catch(zh)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})},u=this,a=0,h=p,t.label=7;case 7:return a<h.length?(c=h[a],[5,s(c)]):[3,10];case 8:t.sent(),t.label=9;case 9:return a++,[3,7];case 10:return[2]}})})},Wf),Mf=(Hf.prototype.listen=function(t){var e=t.query,n=!1,r=this.Nf.get(e);return r||(n=!0,r=new Nf,this.Nf.set(e,r)),r.Ff.push(t),t.Od(this.onlineState),r.Cf&&t.$f(r.Cf)&&this.Mf(),n?this.El.listen(e).then(function(t){return r.targetId=t}):Promise.resolve(r.targetId)},Hf.prototype.fl=function(o){return f(this,void 0,void 0,function(){var e,n,r,i;return y(this,function(t){return e=o.query,n=!1,(r=this.Nf.get(e))&&0<=(i=r.Ff.indexOf(o))&&(r.Ff.splice(i,1),n=0===r.Ff.length),n?[2,(this.Nf.delete(e),this.El.fl(e))]:[2]})})},Hf.prototype.d_=function(t){for(var e=!1,n=0,r=t;n<r.length;n++){var i=r[n],o=i.query,s=this.Nf.get(o);if(s){for(var u=0,a=s.Ff;u<a.length;u++)a[u].$f(i)&&(e=!0);s.Cf=i}}e&&this.Mf()},Hf.prototype.Pf=function(t,e){var n=this.Nf.get(t);if(n)for(var r=0,i=n.Ff;r<i.length;r++)i[r].onError(e);this.Nf.delete(t)},Hf.prototype.Ef=function(i){this.onlineState=i;var o=!1;this.Nf.forEach(function(t,e){for(var n=0,r=e.Ff;n<r.length;n++)r[n].Od(i)&&(o=!0)}),o&&this.Mf()},Hf.prototype.Lf=function(t){this.kf.add(t),t.next()},Hf.prototype.Of=function(t){this.kf.delete(t)},Hf.prototype.Mf=function(){this.kf.forEach(function(t){t.next()})},Hf),Uf=(Yf.prototype.$f=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new Fs(t.query,t.docs,t.cs,e,t._s,t.fromCache,t.ls,!0)}var o=!1;return this.Bf?this.Uf(t)&&(this.xf.next(t),o=!0):this.Qf(t,this.onlineState)&&(this.Wf(t),o=!0),this.qf=t,o},Yf.prototype.onError=function(t){this.xf.error(t)},Yf.prototype.Od=function(t){this.onlineState=t;var e=!1;return this.qf&&!this.Bf&&this.Qf(this.qf,t)&&(this.Wf(this.qf),e=!0),e},Yf.prototype.Qf=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.jf&&n||t.docs.q()&&"Offline"!==e)},Yf.prototype.Uf=function(t){if(0<t.docChanges.length)return!0;var e=this.qf&&this.qf.hasPendingWrites!==t.hasPendingWrites;return!(!t.ls&&!e)&&!0===this.options.includeMetadataChanges},Yf.prototype.Wf=function(t){t=Fs.fs(t.query,t.docs,t._s,t.fromCache),this.Bf=!0,this.xf.next(t)},Yf),qf=(Kf.prototype.Ku=function(t){this.Kf=t},Kf.prototype.wr=function(e,r,i,o){var s=this;return r.Oe()||i.isEqual(Br.MIN)?this.Gf(e,r):this.Kf.Tr(e,o).next(function(t){var n=s.zf(r,t);return(r.je()||r.Ke())&&s.kd(r.ge,n,o,i)?s.Gf(e,r):(fu()<=l.DEBUG&&pu("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),r.toString()),s.Kf.wr(e,r,i).next(function(e){return n.forEach(function(t){e=e.nt(t.key,t)}),e}))})},Kf.prototype.zf=function(n,t){var r=new yi(function(t,e){return n.Be(t,e)});return t.forEach(function(t,e){e instanceof Oo&&n.matches(e)&&(r=r.add(e))}),r},Kf.prototype.kd=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||0<i.version.D(r))},Kf.prototype.Gf=function(t,e){return fu()<=l.DEBUG&&pu("IndexFreeQueryEngine","Using full collection scan to execute query: %s",e.toString()),this.Kf.wr(t,e,Br.MIN)},Kf),Ff=(zf.prototype.So=function(t){return Ru.resolve(0===this.ar.length)},zf.prototype.Do=function(t,e,n){var r=e.batchId,i=this.Jf(r,"acknowledged");return gu(0===i),this.ar[i],this.lastStreamToken=n,Ru.resolve()},zf.prototype.Fo=function(t){return Ru.resolve(this.lastStreamToken)},zf.prototype.No=function(t,e){return this.lastStreamToken=e,Ru.resolve()},zf.prototype.ko=function(t,e,n,r){var i=this.Hf;this.Hf++,0<this.ar.length&&this.ar[this.ar.length-1];var o=new Au(i,e,n,r);this.ar.push(o);for(var s=0,u=r;s<u.length;s++){var a=u[s];this.Yf=this.Yf.add(new ku(a.key,i)),this.ur.Mo(t,a.key.path.L())}return Ru.resolve(o)},zf.prototype.Lo=function(t,e){return Ru.resolve(this.Xf(e))},zf.prototype.Bo=function(t,e){var n=e+1,r=this.Zf(n),i=r<0?0:r;return Ru.resolve(this.ar.length>i?this.ar[i]:null)},zf.prototype.qo=function(){return Ru.resolve(0===this.ar.length?-1:this.Hf-1)},zf.prototype.Uo=function(t){return Ru.resolve(this.ar.slice())},zf.prototype._r=function(t,e){var n=this,r=new ku(e,0),i=new ku(e,Number.POSITIVE_INFINITY),o=[];return this.Yf.Ct([r,i],function(t){var e=n.Xf(t.Ln);o.push(e)}),Ru.resolve(o)},zf.prototype.Ir=function(t,e){var r=this,i=new yi(wu);return e.forEach(function(t){var e=new ku(t,0),n=new ku(t,Number.POSITIVE_INFINITY);r.Yf.Ct([e,n],function(t){i=i.add(t.Ln)})}),Ru.resolve(this.tT(i))},zf.prototype.Vr=function(t,e){var n=e.path,r=n.length+1,i=n;si.st(i)||(i=i.child(""));var o=new ku(new si(i),0),s=new yi(wu);return this.Yf.Ft(function(t){var e=t.key.path;return!!n.U(e)&&(e.length===r&&(s=s.add(t.Ln)),!0)},o),Ru.resolve(this.tT(s))},zf.prototype.tT=function(t){var n=this,r=[];return t.forEach(function(t){var e=n.Xf(t);null!==e&&r.push(e)}),r},zf.prototype.Wo=function(n,r){var i=this;gu(0===this.Jf(r.batchId,"removed")),this.ar.shift();var o=this.Yf;return Ru.forEach(r.mutations,function(t){var e=new ku(t.key,r.batchId);return o=o.delete(e),i.yo.Go(n,t.key)}).next(function(){i.Yf=o})},zf.prototype.Ko=function(t){},zf.prototype.Mn=function(t,e){var n=new ku(e,0),r=this.Yf.Nt(n);return Ru.resolve(e.isEqual(r&&r.key))},zf.prototype.zo=function(t){return this.ar.length,Ru.resolve()},zf.prototype.Jf=function(t,e){return this.Zf(t)},zf.prototype.Zf=function(t){return 0===this.ar.length?0:t-this.ar[0].batchId},zf.prototype.Xf=function(t){var e=this.Zf(t);return e<0||e>=this.ar.length?null:this.ar[e]},zf),Gf=(Bf.prototype.Jn=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,s=this.eT(e);return this.docs=this.docs.nt(r,{Aa:e,size:s,readTime:n}),this.size+=s-o,this.ur.Mo(t,r.path.L())},Bf.prototype.Zn=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},Bf.prototype.tr=function(t,e){var n=this.docs.get(e);return Ru.resolve(n?n.Aa:null)},Bf.prototype.getEntries=function(t,e){var n=this,r=Ss();return e.forEach(function(t){var e=n.docs.get(t);r=r.nt(t,e?e.Aa:null)}),Ru.resolve(r)},Bf.prototype.wr=function(t,e,n){for(var r=ks(),i=new si(e.path.child("")),o=this.docs.lt(i);o.wt();){var s=o.It(),u=s.key,a=s.value,h=a.Aa,c=a.readTime;if(!e.path.U(u.path))break;c.D(n)<=0||h instanceof Oo&&e.matches(h)&&(r=r.nt(h.key,h))}return Ru.resolve(r)},Bf.prototype.sT=function(t,e){return Ru.forEach(this.docs,function(t){return e(t)})},Bf.prototype.Ca=function(t){return new Bf.Fa(this)},Bf.prototype.ka=function(t){return Ru.resolve(this.size)},Bf);function Bf(t,e){this.ur=t,this.eT=e,this.docs=new ai(si.k),this.size=0}function zf(t,e){this.ur=t,this.yo=e,this.ar=[],this.Hf=1,this.lastStreamToken=Ti.xt,this.Yf=new yi(ku.Ie)}function Kf(){}function Yf(t,e,n){this.query=t,this.xf=e,this.Bf=!1,this.qf=null,this.onlineState="Unknown",this.options=n||{}}function Hf(t){this.El=t,this.Nf=new _u(function(t){return t.canonicalId()}),this.onlineState="Unknown",this.kf=new Set,this.El.subscribe(this)}function Wf(t,e,n,r,i){var o=this;return(o=_f.call(this,t,e,n,r,i)||this).j_=t,o.isPrimary=void 0,o}function Qf(t,e,n,r,i){this.j_=t,this.Ud=e,this.Yd=n,this.currentUser=r,this.Jd=i,this.Xd=null,this.Zd=new _u(function(t){return t.canonicalId()}),this.tf=new Map,this.ef=[],this.sf=new ai(si.k),this.if=new Map,this.nf=new Du,this.rf={},this.hf=new Map,this.af=ja.Jo(),this.onlineState="Unknown"}function Zf(t,e,n,r){this.jr=t,this.Ud=e,this.updateFunction=n,this.zr=r,this.Qd=5,this.oh=new Zu(this.jr,"transaction_retry")}function Xf(t,e){this.query=t,this.yd=e,this.bd=null,this.ms=!1,this.vd=Ls(),this._s=Ls(),this.Sd=new Us(t.Be.bind(t))}function Jf(){this.gd=new xf,this.pd={},this.El=null,this.M_=null,this.vr=null}function $f(t,e,n,r,i){if(this.Nr=t,this.platform=e,this.persistenceKey=n,this.Ml=r,this.El=null,this.M_=null,this.vr=null,this.Ll=this.Ol.bind(this),this.xl=new ai(wu),this.Kh=!1,this.Bl=[],!$f.ho(this.platform))throw new jr(Vr.UNIMPLEMENTED,"LocalStorage is not available on this platform.");var o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.platform.window.localStorage,this.currentUser=i,this.ql=gf(this.persistenceKey,this.Ml),this.Ul="firestore_sequence_number_"+this.persistenceKey,this.xl=this.xl.nt(this.Ml,new xf),this.Ql=new RegExp("^firestore_clients_"+o+"_([^_]*)$"),this.Wl=new RegExp("^firestore_mutations_"+o+"_(\\d+)(?:_(.*))?$"),this.jl=new RegExp("^firestore_targets_"+o+"_(\\d+)$"),this.Kl="firestore_online_state_"+this.persistenceKey,this.platform.window.addEventListener("storage",this.Ll)}function tl(){this.activeTargetIds=Cs()}function el(t,e){this.clientId=t,this.onlineState=e}function nl(t,e){this.clientId=t,this.activeTargetIds=e}function rl(t,e,n){this.targetId=t,this.state=e,this.error=n}function il(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}function ol(t){var e=this;return(e=Af.call(this)||this).$a=t,e}Gf.Fa=(n(ol,Af=xu),ol.prototype.ir=function(n){var r=this,i=[];return this.zn.forEach(function(t,e){e?i.push(r.$a.Jn(n,e,r.readTime)):r.$a.Zn(t)}),Ru.Kn(i)},ol.prototype.er=function(t,e){return this.$a.tr(t,e)},ol.prototype.sr=function(t,e){return this.$a.getEntries(t,e)},ol);var sl,ul,al=(Il.prototype.Xs=function(t,n){return this.iT.forEach(function(t,e){return n(e)}),Ru.resolve()},Il.prototype.ea=function(t){return Ru.resolve(this.lastRemoteSnapshotVersion)},Il.prototype.sa=function(t){return Ru.resolve(this.nT)},Il.prototype.Xo=function(t){return this.highestTargetId=this.hT.next(),Ru.resolve(this.highestTargetId)},Il.prototype.ia=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.nT&&(this.nT=e),Ru.resolve()},Il.prototype.ra=function(t){this.iT.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.hT=new ja(e),this.highestTargetId=e),t.sequenceNumber>this.nT&&(this.nT=t.sequenceNumber)},Il.prototype.na=function(t,e){return this.ra(e),this.targetCount+=1,Ru.resolve()},Il.prototype.oa=function(t,e){return this.ra(e),Ru.resolve()},Il.prototype.aa=function(t,e){return this.iT.delete(e.target),this.rT.Nn(e.targetId),--this.targetCount,Ru.resolve()},Il.prototype.Zh=function(n,r,i){var o=this,s=0,u=[];return this.iT.forEach(function(t,e){e.sequenceNumber<=r&&null===i.get(e.targetId)&&(o.iT.delete(t),u.push(o.ua(n,e.targetId)),s++)}),Ru.Kn(u).next(function(){return s})},Il.prototype.la=function(t){return Ru.resolve(this.targetCount)},Il.prototype.da=function(t,e){var n=this.iT.get(e)||null;return Ru.resolve(n)},Il.prototype.fa=function(e,t,n){this.rT.Sn(t,n);var r=this.persistence.yo,i=[];return r&&t.forEach(function(t){i.push(r.vn(e,t))}),Ru.Kn(i)},Il.prototype.Ta=function(e,t,n){this.rT.Fn(t,n);var r=this.persistence.yo,i=[];return r&&t.forEach(function(t){i.push(r.Dn(e,t))}),Ru.Kn(i)},Il.prototype.ua=function(t,e){return this.rT.Nn(e),Ru.resolve()},Il.prototype.Ea=function(t,e){var n=this.rT.$n(e);return Ru.resolve(n)},Il.prototype.Mn=function(t,e){return Ru.resolve(this.rT.Mn(e))},Il),hl=(Tl.prototype.start=function(){return Promise.resolve()},Tl.prototype.mu=function(){return this.ja=!1,Promise.resolve()},Object.defineProperty(Tl.prototype,"Kh",{get:function(){return this.ja},enumerable:!0,configurable:!0}),Tl.prototype.au=function(){},Tl.prototype.Du=function(){return this.ur},Tl.prototype.bu=function(t){var e=this.oT[t.s()];return e||(e=new Ff(this.ur,this.yo),this.oT[t.s()]=e),e},Tl.prototype.vu=function(){return this.Za},Tl.prototype.Su=function(){return this.or},Tl.prototype.runTransaction=function(t,e,n){var r=this;pu("MemoryPersistence","Starting transaction:",t);var i=new cl(this.hu.next());return this.yo.uT(),n(i).next(function(t){return r.yo.cT(i).next(function(){return t})}).Wn().then(function(t){return i.hr(),t})},Tl.prototype._T=function(e,n){return Ru.Gn(Object.values(this.oT).map(function(t){return function(){return t.Mn(e,n)}}))},Tl),cl=(n(bl,ul=Lu),bl),fl=(wl.dT=function(t){return new wl(t)},Object.defineProperty(wl.prototype,"fT",{get:function(){if(this.lT)return this.lT;throw vu()},enumerable:!0,configurable:!0}),wl.prototype.Mu=function(t){this.Nu=t},wl.prototype.vn=function(t,e){return this.fT.delete(e),Ru.resolve()},wl.prototype.Dn=function(t,e){return this.fT.add(e),Ru.resolve()},wl.prototype.Go=function(t,e){return this.fT.add(e),Ru.resolve()},wl.prototype.removeTarget=function(t,e){var n=this,r=this.persistence.vu();return r.Ea(t,e.targetId).next(function(t){t.forEach(function(t){return n.fT.add(t)})}).next(function(){return r.aa(t,e)})},wl.prototype.uT=function(){this.lT=new Set},wl.prototype.cT=function(t){var n=this,r=this.persistence.Su().Ca();return Ru.forEach(this.fT,function(e){return n.TT(t,e).next(function(t){t||r.Zn(e)})}).next(function(){return n.lT=null,r.apply(t)})},wl.prototype.Ou=function(t,e){var n=this;return this.TT(t,e).next(function(t){t?n.fT.delete(e):n.fT.add(e)})},wl.prototype.aT=function(t){return 0},wl.prototype.TT=function(t,e){var n=this;return Ru.Gn([function(){return n.persistence.vu().Mn(t,e)},function(){return n.persistence._T(t,e)},function(){return Ru.resolve(n.Nu.Mn(e))}])},wl),ll=(El.prototype.initialize=function(n){return f(this,void 0,void 0,function(){var e=this;return y(this,function(t){switch(t.label){case 0:return this.Yd=this.ET(n),this.persistence=this.IT(n),[4,this.persistence.start()];case 1:return t.sent(),this.wT=this.RT(n),this.j_=this.AT(n),this.Ud=this.mT(n),this.El=this.PT(n),this.VT=this.gT(n),this.Yd.M_=function(t){return e.El.Od(t,1)},this.Ud.El=this.El,[4,this.j_.start()];case 2:return t.sent(),[4,this.Yd.start()];case 3:return t.sent(),[4,this.Ud.start()];case 4:return t.sent(),[4,this.Ud.Cl(this.El.uf)];case 5:return t.sent(),[2]}})})},El.prototype.gT=function(t){return new Mf(this.El)},El.prototype.RT=function(t){return null},El.prototype.AT=function(t){return new Uh(this.persistence,new qf,t.pT)},El.prototype.IT=function(t){return new hl(fl.dT)},El.prototype.mT=function(t){var e=this;return new hf(this.j_,t.b_,t.jr,function(t){return e.El.Od(t,0)},t.platform.yT())},El.prototype.ET=function(t){return new Lf},El.prototype.PT=function(t){return new Vf(this.j_,this.Ud,this.Yd,t.pT,t.Jd)},El.prototype.clearPersistence=function(t){throw new jr(Vr.FAILED_PRECONDITION,"You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.")},El),pl=(n(ml,sl=ll),ml.prototype.initialize=function(e){return f(this,void 0,void 0,function(){var n=this;return y(this,function(t){switch(t.label){case 0:return[4,sl.prototype.initialize.call(this,e)];case 1:return t.sent(),[4,this.persistence.ou(function(e){return f(n,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return[4,this.El.Cl(e)];case 1:return t.sent(),this.wT&&(e&&!this.wT.Kh?this.wT.start(this.j_):e||this.wT.stop()),[2]}})})})];case 2:return t.sent(),[2]}})})},ml.prototype.AT=function(t){return new Gh(this.persistence,new qf,t.pT)},ml.prototype.PT=function(t){var e=new jf(this.j_,this.Ud,this.Yd,t.pT,t.Jd);return this.Yd instanceof Of&&(this.Yd.El=e),e},ml.prototype.RT=function(t){var e=this.persistence.yo.qh;return new aa(e,t.jr)},ml.prototype.IT=function(t){var e=Rh.Fu(t.bT),n=t.platform.vT(t.bT.ci);return new Rh(t.ST.synchronizeTabs,e,t.clientId,t.platform,oa.kh(t.ST.cacheSizeBytes),t.jr,n,this.Yd)},ml.prototype.ET=function(t){if(t.ST.DT&&t.ST.synchronizeTabs){if(!Of.ho(t.platform))throw new jr(Vr.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var e=Rh.Fu(t.bT);return new Of(t.jr,t.platform,e,t.clientId,t.pT)}return new Lf},ml.prototype.clearPersistence=function(t){var e=Rh.Fu(t);return Rh.clearPersistence(e)},ml),dl=(gl.prototype.start=function(e,n){var r=this;this.CT();var i=new Qu,o=new Qu,s=!1;return this.credentials.l(function(t){if(!s)return s=!0,pu("FirestoreClient","Initializing. user=",t.uid),r.FT(e,n,t,o).then(i.resolve,i.reject);r.jr.Zr(function(){return r.Dl(t)})}),this.jr.Zr(function(){return i.promise}),o.promise},gl.prototype.enableNetwork=function(){var t=this;return this.CT(),this.jr.enqueue(function(){return t.El.enableNetwork()})},gl.prototype.FT=function(s,u,a,h){return f(this,void 0,void 0,function(){var e,n,r,i,o=this;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),[4,this.platform.NT(this.bT)];case 1:return e=t.sent(),n=this.platform.vT(this.bT.ci),r=new sf(this.jr,e,this.credentials,n),[4,s.initialize({jr:this.jr,bT:this.bT,platform:this.platform,b_:r,clientId:this.clientId,pT:a,Jd:100,ST:u})];case 2:return t.sent(),this.persistence=s.persistence,this.Yd=s.Yd,this.j_=s.j_,this.Ud=s.Ud,this.El=s.El,this.wT=s.wT,this.kT=s.VT,this.persistence.au(function(){return f(o,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return[4,this.terminate()];case 1:return t.sent(),[2]}})})}),h.resolve(),[3,4];case 3:if(i=t.sent(),h.reject(i),!this.$T(i))throw i;return[2,(console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+i),this.FT(new ll,{DT:!1},a,h))];case 4:return[2]}})})},gl.prototype.$T=function(t){return"FirebaseError"===t.name?t.code===Vr.FAILED_PRECONDITION||t.code===Vr.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code},gl.prototype.CT=function(){if(this.jr._h)throw new jr(Vr.FAILED_PRECONDITION,"The client has already been terminated.")},gl.prototype.Dl=function(t){return this.jr.Rh(),pu("FirestoreClient","Credential Changed. Current user: "+t.uid),this.El.Dl(t)},gl.prototype.disableNetwork=function(){var t=this;return this.CT(),this.jr.enqueue(function(){return t.El.disableNetwork()})},gl.prototype.terminate=function(){var t=this;return this.jr.Eh(function(){return f(t,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.wT&&this.wT.stop(),[4,this.Ud.mu()];case 1:return t.sent(),[4,this.Yd.mu()];case 2:return t.sent(),[4,this.persistence.mu()];case 3:return t.sent(),this.credentials.T(),[2]}})})})},gl.prototype.waitForPendingWrites=function(){var t=this;this.CT();var e=new Qu;return this.jr.Zr(function(){return t.El.Af(e)}),e.promise},gl.prototype.listen=function(t,e,n){var r=this;this.CT();var i=new Uf(t,e,n);return this.jr.Zr(function(){return r.kT.listen(i)}),i},gl.prototype.fl=function(t){var e=this;this.MT||this.jr.Zr(function(){return e.kT.fl(t)})},gl.prototype.LT=function(t){var e=this;return this.CT(),this.jr.enqueue(function(){return e.j_.rc(t)}).then(function(t){if(t instanceof Oo)return t;if(t instanceof Lo)return null;throw new jr(Vr.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")})},gl.prototype.OT=function(i){var t=this;return this.CT(),this.jr.enqueue(function(){return f(t,void 0,void 0,function(){var e,n,r;return y(this,function(t){switch(t.label){case 0:return[4,this.j_.ac(i,!0)];case 1:return e=t.sent(),n=new Pf(i,e.uc),r=n.Cd(e.documents),[2,n.ir(r,!1).snapshot]}})})})},gl.prototype.write=function(t){var e=this;this.CT();var n=new Qu;return this.jr.Zr(function(){return e.El.write(t,n)}),n.promise},gl.prototype.ci=function(){return this.bT.ci},gl.prototype.Lf=function(t){var e=this;this.CT(),this.jr.Zr(function(){return e.kT.Lf(t),Promise.resolve()})},gl.prototype.Of=function(t){this.MT||this.kT.Of(t)},Object.defineProperty(gl.prototype,"MT",{get:function(){return this.jr._h},enumerable:!0,configurable:!0}),gl.prototype.transaction=function(t){var e=this;this.CT();var n=new Qu;return this.jr.Zr(function(){return e.El.runTransaction(e.jr,t,n),Promise.resolve()}),n.promise},gl),yl=(vl.prototype.next=function(t){this.xT(this.observer.next,t)},vl.prototype.error=function(t){this.xT(this.observer.error,t)},vl.prototype.BT=function(){this.muted=!0},vl.prototype.xT=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},vl);function vl(t){this.observer=t,this.muted=!1}function gl(t,e,n,r){this.platform=t,this.bT=e,this.credentials=n,this.jr=r,this.clientId=mu.En()}function ml(){return null!==sl&&sl.apply(this,arguments)||this}function El(){}function wl(t){this.persistence=t,this.Nu=null,this.lT=null}function bl(t){var e=this;return(e=ul.call(this)||this).Qa=t,e}function Tl(t){var e=this;this.oT={},this.hu=new Vu(0),this.ja=!1,this.ja=!0,this.yo=t(this),this.Za=new al(this),this.ur=new th,this.or=new Gf(this.ur,function(t){return e.yo.aT(t)})}function Il(t){this.persistence=t,this.iT=new _u(function(t){return t.canonicalId()}),this.lastRemoteSnapshotVersion=Br.MIN,this.highestTargetId=0,this.nT=0,this.rT=new Du,this.targetCount=0,this.hT=ja.Yo()}function Nl(i){return function(){if("object"==typeof i&&null!==i)for(var t=i,e=0,n=["next","error","complete"];e<n.length;e++){var r=n[e];if(r in t&&"function"==typeof t[r])return 1}}()}var _l,Al,Sl=(Xl.prototype.UT=function(t){switch(Ri(t)){case 0:return null;case 1:return t.booleanValue;case 2:return ji(t.integerValue||t.doubleValue);case 3:return this.QT(t.timestampValue);case 4:return this.WT(t);case 5:return t.stringValue;case 6:return new lc(Mi(t.bytesValue));case 7:return this.jT(t.referenceValue);case 8:return new Lc(t.geoPointValue.latitude,t.geoPointValue.longitude);case 9:return this.KT(t.arrayValue);case 10:return this.GT(t.mapValue);default:throw vu()}},Xl.prototype.GT=function(t){var n=this,r={};return wi(t.fields||{},function(t,e){r[t]=n.UT(e)}),r},Xl.prototype.KT=function(t){var e=this;return(t.values||[]).map(function(t){return e.UT(t)})},Xl.prototype.WT=function(t){switch(this.qT){case"previous":var e=function t(e){var n=e.mapValue.fields.__previous_value__;return Si(n)?t(n):n}(t);return null==e?null:this.UT(e);case"estimate":return this.QT(Di(t));default:return null}},Xl.prototype.QT=function(t){var e=Vi(t),n=new Gr(e.seconds,e.nanos);return this.timestampsInSnapshots?n:n.toDate()},Xl.prototype.jT=function(t){var e=$r.G(t);gu(uu(e));var n=new Nu(e.get(1),e.get(3)),r=new si(e.M(5));return n.isEqual(this.firestore.zT)||du("Document "+r+" contains a document reference within a different database ("+n.projectId+"/"+n.database+") which is not supported. It will be treated as a reference in the current database ("+this.firestore.zT.projectId+"/"+this.firestore.zT.database+") instead."),new Ll(r,this.firestore,this.converter)},Xl),Dl=oa.Lh,kl=(Zl.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.timestampsInSnapshots===t.timestampsInSnapshots&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.forceLongPolling===t.forceLongPolling},Zl),Rl=(Ql.prototype.settings=function(t){Yh("Firestore.settings",arguments,1),Qh("Firestore.settings","object",1,t);var e=new kl(t);if(this.XT&&!this.iE.isEqual(e))throw new jr(Vr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");void 0!==(this.iE=e).credentials&&(this.eE=function(t){if(!t)return new Mr;switch(t.type){case"gapi":var e=t.hE;return gu(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Fr(e,t.V||"0");case"provider":return t.hE;default:throw new jr(Vr.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(e.credentials))},Ql.prototype.enableNetwork=function(){return this.JT(),this.XT.enableNetwork()},Ql.prototype.disableNetwork=function(){return this.JT(),this.XT.disableNetwork()},Ql.prototype.enablePersistence=function(t){var e,n;if(this.XT)throw new jr(Vr.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var r=!1;return t&&(void 0!==t.experimentalTabSynchronization&&du("The 'experimentalTabSynchronization' setting will be removed. Use 'synchronizeTabs' instead."),r=null!==(n=null!==(e=t.synchronizeTabs)&&void 0!==e?e:t.experimentalTabSynchronization)&&void 0!==n&&n),this.oE(this.sE,{DT:!0,cacheSizeBytes:this.iE.cacheSizeBytes,synchronizeTabs:r})},Ql.prototype.clearPersistence=function(){return f(this,void 0,void 0,function(){var r,e=this;return y(this,function(t){if(void 0!==this.XT&&!this.XT.MT)throw new jr(Vr.FAILED_PRECONDITION,"Persistence cannot be cleared after this Firestore instance is initialized.");return r=new Qu,[2,(this.YT.lh(function(){return f(e,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),e=this.aE(),[4,this.sE.clearPersistence(e)];case 1:return t.sent(),r.resolve(),[3,3];case 2:return n=t.sent(),r.reject(n),[3,3];case 3:return[2]}})})}),r.promise)]})})},Ql.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(Ql.prototype,"uE",{get:function(){return this.JT(),this.XT.MT},enumerable:!0,configurable:!0}),Ql.prototype.waitForPendingWrites=function(){return this.JT(),this.XT.waitForPendingWrites()},Ql.prototype.onSnapshotsInSync=function(t){if(this.JT(),Nl(t))return this.cE(t);Qh("Firestore.onSnapshotsInSync","function",1,t);var e={next:t};return this.cE(e)},Ql.prototype.cE=function(t){var e=this,n=new yl({next:function(){t.next&&t.next()},error:function(t){throw vu()}});return this.XT.Lf(n),function(){n.BT(),e.XT.Of(n)}},Ql.prototype.JT=function(){return this.XT||this.oE(new ll,{DT:!1}),this.XT},Ql.prototype.aE=function(){return new Iu(this.zT,this.tE,this.iE.host,this.iE.ssl,this.iE.forceLongPolling)},Ql.prototype.oE=function(t,e){var n=this.aE();return this.XT=new dl(au.Lt(),n,this.eE,this.YT),this.XT.start(t,e)},Ql.prototype.rE=function(r){var t=au.Lt().vT(r);return new Yc(t,function(t){if(t instanceof Ll){var e=r,n=t.firestore.zT;if(!n.isEqual(e))throw new jr(Vr.INVALID_ARGUMENT,"Document reference is for database "+n.projectId+"/"+n.database+" but should be for database "+e.projectId+"/"+e.database);return new Kc(r,t._E)}return t})},Ql.ZT=function(t){if(e=t.options,!Object.prototype.hasOwnProperty.call(e,"projectId"))throw new jr(Vr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var e,n=t.options.projectId;if(!n||"string"!=typeof n)throw new jr(Vr.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new Nu(n)},Object.defineProperty(Ql.prototype,"app",{get:function(){if(!this.HT)throw new jr(Vr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.HT},enumerable:!0,configurable:!0}),Ql.prototype.collection=function(t){return Yh("Firestore.collection",arguments,1),Qh("Firestore.collection","non-empty string",1,t),this.JT(),new Ul($r.G(t),this)},Ql.prototype.doc=function(t){return Yh("Firestore.doc",arguments,1),Qh("Firestore.doc","non-empty string",1,t),this.JT(),Ll.lE($r.G(t),this)},Ql.prototype.collectionGroup=function(t){if(Yh("Firestore.collectionGroup",arguments,1),Qh("Firestore.collectionGroup","non-empty string",1,t),0<=t.indexOf("/"))throw new jr(Vr.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.JT(),new jl(new Vo($r.H,t),this)},Ql.prototype.runTransaction=function(e){var n=this;return Yh("Firestore.runTransaction",arguments,1),Qh("Firestore.runTransaction","function",1,e),this.JT().transaction(function(t){return e(new xl(n,t))})},Ql.prototype.batch=function(){return this.JT(),new Ol(this)},Object.defineProperty(Ql,"logLevel",{get:function(){switch(fu()){case l.DEBUG:return"debug";case l.SILENT:return"silent";default:return"error"}},enumerable:!0,configurable:!0}),Ql.setLogLevel=function(t){switch(Yh("Firestore.setLogLevel",arguments,1),Qh("Firestore.setLogLevel","non-empty string",1,t),t){case"debug":lu(l.DEBUG);break;case"error":lu(l.ERROR);break;case"silent":lu(l.SILENT);break;default:throw new jr(Vr.INVALID_ARGUMENT,"Invalid log level: "+t)}},Ql.prototype.dE=function(){return this.iE.timestampsInSnapshots},Ql),xl=(Wl.prototype.get=function(t){var n=this;Yh("Transaction.get",arguments,1);var r=ep("Transaction.get",t,this.fE);return this.TE.p_([r._E]).then(function(t){if(!t||1!==t.length)return vu();var e=t[0];if(e instanceof Lo)return new Cl(n.fE,r._E,null,!1,!1,r.EE);if(e instanceof Oo)return new Cl(n.fE,r._E,e,!1,!1,r.EE);throw vu()})},Wl.prototype.set=function(t,e,n){Wh("Transaction.set",arguments,2,3);var r=ep("Transaction.set",t,this.fE);n=Jl("Transaction.set",n);var i=np(r.EE,e,"Transaction.set"),o=i[0],s=i[1],u=n.merge||n.mergeFields?this.fE.nE.Mc(s,o,n.mergeFields):this.fE.nE.kc(s,o);return this.TE.set(r._E,u),this},Wl.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return i="string"==typeof e||e instanceof dc?(Hh("Transaction.update",arguments,3),r=ep("Transaction.update",t,this.fE),this.fE.nE.Bc("Transaction.update",e,n,o)):(Yh("Transaction.update",arguments,2),r=ep("Transaction.update",t,this.fE),this.fE.nE.Lc("Transaction.update",e)),this.TE.update(r._E,i),this},Wl.prototype.delete=function(t){Yh("Transaction.delete",arguments,1);var e=ep("Transaction.delete",t,this.fE);return this.TE.delete(e._E),this},Wl),Ol=(Hl.prototype.set=function(t,e,n){Wh("WriteBatch.set",arguments,2,3),this.RE();var r=ep("WriteBatch.set",t,this.fE);n=Jl("WriteBatch.set",n);var i=np(r.EE,e,"WriteBatch.set"),o=i[0],s=i[1],u=n.merge||n.mergeFields?this.fE.nE.Mc(s,o,n.mergeFields):this.fE.nE.kc(s,o);return this.IE=this.IE.concat(u.gc(r._E,ro.NONE)),this},Hl.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return this.RE(),i="string"==typeof e||e instanceof dc?(Hh("WriteBatch.update",arguments,3),r=ep("WriteBatch.update",t,this.fE),this.fE.nE.Bc("WriteBatch.update",e,n,o)):(Yh("WriteBatch.update",arguments,2),r=ep("WriteBatch.update",t,this.fE),this.fE.nE.Lc("WriteBatch.update",e)),this.IE=this.IE.concat(i.gc(r._E,ro.exists(!0))),this},Hl.prototype.delete=function(t){Yh("WriteBatch.delete",arguments,1),this.RE();var e=ep("WriteBatch.delete",t,this.fE);return this.IE=this.IE.concat(new go(e._E,ro.NONE)),this},Hl.prototype.commit=function(){return this.RE(),this.wE=!0,0<this.IE.length?this.fE.JT().write(this.IE):Promise.resolve()},Hl.prototype.RE=function(){if(this.wE)throw new jr(Vr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},Hl),Ll=(Yl.lE=function(t,e,n){if(t.length%2!=0)throw new jr(Vr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.K()+" has "+t.length);return new Yl(new si(t),e,n)},Object.defineProperty(Yl.prototype,"id",{get:function(){return this._E.path.B()},enumerable:!0,configurable:!0}),Object.defineProperty(Yl.prototype,"parent",{get:function(){return new Ul(this._E.path.L(),this.firestore,this.EE)},enumerable:!0,configurable:!0}),Object.defineProperty(Yl.prototype,"path",{get:function(){return this._E.path.K()},enumerable:!0,configurable:!0}),Yl.prototype.collection=function(t){if(Yh("DocumentReference.collection",arguments,1),Qh("DocumentReference.collection","non-empty string",1,t),!t)throw new jr(Vr.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");var e=$r.G(t);return new Ul(this._E.path.child(e),this.firestore)},Yl.prototype.isEqual=function(t){if(!(t instanceof Yl))throw oc("isEqual","DocumentReference",1,t);return this.firestore===t.firestore&&this._E.isEqual(t._E)&&this.EE===t.EE},Yl.prototype.set=function(t,e){Wh("DocumentReference.set",arguments,1,2),e=Jl("DocumentReference.set",e);var n=np(this.EE,t,"DocumentReference.set"),r=n[0],i=n[1],o=e.merge||e.mergeFields?this.firestore.nE.Mc(i,r,e.mergeFields):this.firestore.nE.kc(i,r);return this.XT.write(o.gc(this._E,ro.NONE))},Yl.prototype.update=function(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];return n="string"==typeof t||t instanceof dc?(Hh("DocumentReference.update",arguments,2),this.firestore.nE.Bc("DocumentReference.update",t,e,r)):(Yh("DocumentReference.update",arguments,1),this.firestore.nE.Lc("DocumentReference.update",t)),this.XT.write(n.gc(this._E,ro.exists(!0)))},Yl.prototype.delete=function(){return Yh("DocumentReference.delete",arguments,0),this.XT.write([new go(this._E,ro.NONE)])},Yl.prototype.onSnapshot=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];Wh("DocumentReference.onSnapshot",arguments,1,4);var n,r={includeMetadataChanges:!1},i=0;"object"!=typeof t[i]||Nl(t[i])||(ic("DocumentReference.onSnapshot",r=t[i],["includeMetadataChanges"]),Jh("DocumentReference.onSnapshot","boolean","includeMetadataChanges",r.includeMetadataChanges),i++);var o={includeMetadataChanges:r.includeMetadataChanges};return n=Nl(t[i])?t[i]:(Qh("DocumentReference.onSnapshot","function",i,t[i]),Zh("DocumentReference.onSnapshot","function",i+1,t[i+1]),Zh("DocumentReference.onSnapshot","function",i+2,t[i+2]),{next:t[i],error:t[i+1],complete:t[i+2]}),this.AE(o,n)},Yl.prototype.AE=function(t,n){var r=this,e=function(t){console.error("Uncaught Error in onSnapshot:",t)};n.error&&(e=n.error.bind(n));var i=new yl({next:function(t){if(n.next){var e=t.docs.get(r._E);n.next(new Cl(r.firestore,r._E,e,t.fromCache,t.hasPendingWrites,r.EE))}},error:e}),o=this.XT.listen(Vo.ve(this._E.path),i,t);return function(){i.BT(),r.XT.fl(o)}},Yl.prototype.get=function(n){var r=this;return Wh("DocumentReference.get",arguments,0,1),tp("DocumentReference.get",n),new Promise(function(e,t){n&&"cache"===n.source?r.firestore.JT().LT(r._E).then(function(t){e(new Cl(r.firestore,r._E,t,!0,t instanceof Oo&&t.te,r.EE))},t):r.mE(e,t,n)})},Yl.prototype.mE=function(e,n,r){var i=this.AE({includeMetadataChanges:!0,jf:!0},{next:function(t){i(),!t.exists&&t.metadata.fromCache?n(new jr(Vr.UNAVAILABLE,"Failed to get document because the client is offline.")):t.exists&&t.metadata.fromCache&&r&&"server"===r.source?n(new jr(Vr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):e(t)},error:n})},Yl.prototype.withConverter=function(t){return new Yl(this._E,this.firestore,t)},Yl),Pl=(Kl.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},Kl),Cl=(zl.prototype.data=function(t){if(Wh("DocumentSnapshot.data",arguments,0,1),t=$l("DocumentSnapshot.data",t),this.PE){if(this.EE){var e=new Vl(this.fE,this._E,this.PE,this.VE,this.gE);return this.EE.fromFirestore(e,t)}return new Sl(this.fE,this.fE.dE(),t.serverTimestamps,void 0).UT(this.PE.Re())}},zl.prototype.get=function(t,e){if(Wh("DocumentSnapshot.get",arguments,1,2),e=$l("DocumentSnapshot.get",e),this.PE){var n=this.PE.data().field(Xc("DocumentSnapshot.get",t));if(null!==n)return new Sl(this.fE,this.fE.dE(),e.serverTimestamps,this.EE).UT(n)}},Object.defineProperty(zl.prototype,"id",{get:function(){return this._E.path.B()},enumerable:!0,configurable:!0}),Object.defineProperty(zl.prototype,"ref",{get:function(){return new Ll(this._E,this.fE,this.EE)},enumerable:!0,configurable:!0}),Object.defineProperty(zl.prototype,"exists",{get:function(){return null!==this.PE},enumerable:!0,configurable:!0}),Object.defineProperty(zl.prototype,"metadata",{get:function(){return new Pl(this.gE,this.VE)},enumerable:!0,configurable:!0}),zl.prototype.isEqual=function(t){if(!(t instanceof zl))throw oc("isEqual","DocumentSnapshot",1,t);return this.fE===t.fE&&this.VE===t.VE&&this._E.isEqual(t._E)&&(null===this.PE?null===t.PE:this.PE.isEqual(t.PE))&&this.EE===t.EE},zl),Vl=(n(Bl,Al=Cl),Bl.prototype.data=function(t){return Al.prototype.data.call(this,t)},Bl),jl=(Gl.prototype.where=function(t,e,n){var r;Yh("Query.where",arguments,3),rc("Query.where",3,n),function(t,e){if(!t.some(function(t){return t===e}))throw new jr(Vr.INVALID_ARGUMENT,"Invalid value "+nc(e)+" provided to function Query.where() for its "+uc(2)+" argument. Acceptable values: "+t.join(", "))}(["<","<=","==",">=",">","array-contains","in","array-contains-any"],e);var i=Xc("Query.where",t),o=jo.G(e);if(i.J()){if(o===jo.ARRAY_CONTAINS||o===jo.ARRAY_CONTAINS_ANY)throw new jr(Vr.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o.toString()+"' queries on FieldPath.documentId().");if(o===jo.IN){this.yE(n,o);for(var s=[],u=0,a=n;u<a.length;u++){var h=a[u];s.push(this.bE(h))}r={arrayValue:{values:s}}}else r=this.bE(n)}else o!==jo.IN&&o!==jo.ARRAY_CONTAINS_ANY||this.yE(n,o),r=this.firestore.nE.qc("Query.where",n,o===jo.IN);var c=Jo.create(i,o,r);return this.vE(c),new Gl(this.pE.Ce(c),this.firestore,this.EE)},Gl.prototype.orderBy=function(t,e){var n;if(Wh("Query.orderBy",arguments,1,2),Zh("Query.orderBy","non-empty string",2,e),void 0===e||"asc"===e)n=is.ASCENDING;else{if("desc"!==e)throw new jr(Vr.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+e+"', expected 'asc' or 'desc'.");n=is.DESCENDING}if(null!==this.pE.startAt)throw new jr(Vr.INVALID_ARGUMENT,"Invalid query. You must not call Query.startAt() or Query.startAfter() before calling Query.orderBy().");if(null!==this.pE.endAt)throw new jr(Vr.INVALID_ARGUMENT,"Invalid query. You must not call Query.endAt() or Query.endBefore() before calling Query.orderBy().");var r=Xc("Query.orderBy",t),i=new vs(r,n);return this.SE(i),new Gl(this.pE.Fe(i),this.firestore,this.EE)},Gl.prototype.limit=function(t){return Yh("Query.limit",arguments,1),Qh("Query.limit","number",1,t),sc("Query.limit",1,t),new Gl(this.pE.Ne(t),this.firestore,this.EE)},Gl.prototype.limitToLast=function(t){return Yh("Query.limitToLast",arguments,1),Qh("Query.limitToLast","number",1,t),sc("Query.limitToLast",1,t),new Gl(this.pE.ke(t),this.firestore,this.EE)},Gl.prototype.startAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Hh("Query.startAt",arguments,1);var r=this.DE("Query.startAt",t,e,!0);return new Gl(this.pE.$e(r),this.firestore,this.EE)},Gl.prototype.startAfter=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Hh("Query.startAfter",arguments,1);var r=this.DE("Query.startAfter",t,e,!1);return new Gl(this.pE.$e(r),this.firestore,this.EE)},Gl.prototype.endBefore=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Hh("Query.endBefore",arguments,1);var r=this.DE("Query.endBefore",t,e,!0);return new Gl(this.pE.Me(r),this.firestore,this.EE)},Gl.prototype.endAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Hh("Query.endAt",arguments,1);var r=this.DE("Query.endAt",t,e,!1);return new Gl(this.pE.Me(r),this.firestore,this.EE)},Gl.prototype.isEqual=function(t){if(!(t instanceof Gl))throw oc("isEqual","Query",1,t);return this.firestore===t.firestore&&this.pE.isEqual(t.pE)},Gl.prototype.withConverter=function(t){return new Gl(this.pE,this.firestore,t)},Gl.prototype.DE=function(t,e,n,r){if(rc(t,1,e),e instanceof Cl){if(0<n.length)throw new jr(Vr.INVALID_ARGUMENT,"Too many arguments provided to "+t+"().");var i=e;if(!i.exists)throw new jr(Vr.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+t+"().");return this.CE(i.PE,r)}var o=[e].concat(n);return this.FE(t,o,r)},Gl.prototype.CE=function(t,e){for(var n=[],r=0,i=this.pE.orderBy;r<i.length;r++){var o=i[r];if(o.field.J())n.push(Ui(this.firestore.zT,t.key));else{var s=t.field(o.field);if(Si(s))throw new jr(Vr.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+o.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===s){var u=o.field.K();throw new jr(Vr.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.")}n.push(s)}}return new ys(n,e)},Gl.prototype.FE=function(t,e,n){var r=this.pE.Ve;if(e.length>r.length)throw new jr(Vr.INVALID_ARGUMENT,"Too many arguments provided to "+t+"(). The number of arguments must be less than or equal to the number of Query.orderBy() clauses");for(var i=[],o=0;o<e.length;o++){var s=e[o];if(r[o].field.J()){if("string"!=typeof s)throw new jr(Vr.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+t+"(), but got a "+typeof s);if(!this.pE.He()&&-1!==s.indexOf("/"))throw new jr(Vr.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+t+"() must be a plain document ID, but '"+s+"' contains a slash.");var u=this.pE.path.child($r.G(s));if(!si.st(u))throw new jr(Vr.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+t+"() must result in a valid document path, but '"+u+"' is not because it contains an odd number of segments.");var a=new si(u);i.push(Ui(this.firestore.zT,a))}else{var h=this.firestore.nE.qc(t,s);i.push(h)}}return new ys(i,n)},Gl.prototype.onSnapshot=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];Wh("Query.onSnapshot",arguments,1,4);var n,r={},i=0;return"object"!=typeof t[i]||Nl(t[i])||(ic("Query.onSnapshot",r=t[i],["includeMetadataChanges"]),Jh("Query.onSnapshot","boolean","includeMetadataChanges",r.includeMetadataChanges),i++),n=Nl(t[i])?t[i]:(Qh("Query.onSnapshot","function",i,t[i]),Zh("Query.onSnapshot","function",i+1,t[i+1]),Zh("Query.onSnapshot","function",i+2,t[i+2]),{next:t[i],error:t[i+1],complete:t[i+2]}),this.NE(this.pE),this.AE(r,n)},Gl.prototype.AE=function(t,e){var n=this,r=function(t){console.error("Uncaught Error in onSnapshot:",t)};e.error&&(r=e.error.bind(e));var i=new yl({next:function(t){e.next&&e.next(new Ml(n.firestore,n.pE,t,n.EE))},error:r}),o=this.firestore.JT(),s=o.listen(this.pE,i,t);return function(){i.BT(),o.fl(s)}},Gl.prototype.NE=function(t){if(t.Ke()&&0===t.Ve.length)throw new jr(Vr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")},Gl.prototype.get=function(n){var r=this;return Wh("Query.get",arguments,0,1),tp("Query.get",n),this.NE(this.pE),new Promise(function(e,t){n&&"cache"===n.source?r.firestore.JT().OT(r.pE).then(function(t){e(new Ml(r.firestore,r.pE,t,r.EE))},t):r.mE(e,t,n)})},Gl.prototype.mE=function(e,n,r){var i=this.AE({includeMetadataChanges:!0,jf:!0},{next:function(t){i(),t.metadata.fromCache&&r&&"server"===r.source?n(new jr(Vr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):e(t)},error:n})},Gl.prototype.bE=function(t){if("string"==typeof t){if(""===t)throw new jr(Vr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!this.pE.He()&&-1!==t.indexOf("/"))throw new jr(Vr.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+t+"' contains a '/' character.");var e=this.pE.path.child($r.G(t));if(!si.st(e))throw new jr(Vr.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return Ui(this.firestore.zT,new si(e))}if(t instanceof Ll){var n=t;return Ui(this.firestore.zT,n._E)}throw new jr(Vr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+nc(t)+".")},Gl.prototype.yE=function(t,e){if(!Array.isArray(t)||0===t.length)throw new jr(Vr.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new jr(Vr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.");if(0<=t.indexOf(null))throw new jr(Vr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'null' in the value array.");if(0<t.filter(function(t){return Number.isNaN(t)}).length)throw new jr(Vr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'NaN' in the value array.")},Gl.prototype.vE=function(t){if(t instanceof Jo){var e=[jo.ARRAY_CONTAINS,jo.ARRAY_CONTAINS_ANY],n=[jo.IN,jo.ARRAY_CONTAINS_ANY],r=0<=e.indexOf(t.op),i=0<=n.indexOf(t.op);if(t.Ge()){var o=this.pE.Se();if(null!==o&&!o.isEqual(t.field))throw new jr(Vr.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+o.toString()+"' and '"+t.field.toString()+"'");var s=this.pE.De();null!==s&&this.kE(t.field,s)}else if(i||r){var u=null;if(i&&(u=this.pE.ze(n)),null===u&&r&&(u=this.pE.ze(e)),null!=u)throw u===t.op?new jr(Vr.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+t.op.toString()+"' filter."):new jr(Vr.INVALID_ARGUMENT,"Invalid query. You cannot use '"+t.op.toString()+"' filters with '"+u.toString()+"' filters.")}}},Gl.prototype.SE=function(t){if(null===this.pE.De()){var e=this.pE.Se();null!==e&&this.kE(e,t.field)}},Gl.prototype.kE=function(t,e){if(!e.isEqual(t))throw new jr(Vr.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+t.toString()+"' and so you must also use '"+t.toString()+"' as your first Query.orderBy(), but your first Query.orderBy() is on field '"+e.toString()+"' instead.")},Gl),Ml=(Object.defineProperty(Fl.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!0,configurable:!0}),Object.defineProperty(Fl.prototype,"empty",{get:function(){return this.ME.docs.q()},enumerable:!0,configurable:!0}),Object.defineProperty(Fl.prototype,"size",{get:function(){return this.ME.docs.size},enumerable:!0,configurable:!0}),Fl.prototype.forEach=function(e,n){var r=this;Wh("QuerySnapshot.forEach",arguments,1,2),Qh("QuerySnapshot.forEach","function",1,e),this.ME.docs.forEach(function(t){e.call(n,r.xE(t))})},Object.defineProperty(Fl.prototype,"query",{get:function(){return new jl(this.$E,this.fE,this.EE)},enumerable:!0,configurable:!0}),Fl.prototype.docChanges=function(t){t&&(ic("QuerySnapshot.docChanges",t,["includeMetadataChanges"]),Jh("QuerySnapshot.docChanges","boolean","includeMetadataChanges",t.includeMetadataChanges));var e=!(!t||!t.includeMetadataChanges);if(e&&this.ME.ds)throw new jr(Vr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.LE&&this.OE===e||(this.LE=function(i,e,o,s){if(o.cs.q()){var n=0;return o.docChanges.map(function(t){var e=new Vl(i,t.doc.key,t.doc,o.fromCache,o._s.has(t.doc.key),s);return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var u=o.cs;return o.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=new Vl(i,t.doc.key,t.doc,o.fromCache,o._s.has(t.doc.key),s),n=-1,r=-1;return 0!==t.type&&(n=u.indexOf(t.doc.key),u=u.delete(t.doc.key)),1!==t.type&&(r=(u=u.add(t.doc)).indexOf(t.doc.key)),{type:function(){switch(t.type){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return vu()}}(),doc:e,oldIndex:n,newIndex:r}})}(this.fE,e,this.ME,this.EE),this.OE=e),this.LE},Fl.prototype.isEqual=function(t){if(!(t instanceof Fl))throw oc("isEqual","QuerySnapshot",1,t);return this.fE===t.fE&&this.$E.isEqual(t.$E)&&this.ME.isEqual(t.ME)&&this.EE===t.EE},Fl.prototype.xE=function(t){return new Vl(this.fE,t.key,t,this.metadata.fromCache,this.ME._s.has(t.key),this.EE)},Fl),Ul=(n(ql,_l=jl),Object.defineProperty(ql.prototype,"id",{get:function(){return this.pE.path.B()},enumerable:!0,configurable:!0}),Object.defineProperty(ql.prototype,"parent",{get:function(){var t=this.pE.path.L();return t.q()?null:new Ll(new si(t),this.firestore)},enumerable:!0,configurable:!0}),Object.defineProperty(ql.prototype,"path",{get:function(){return this.pE.path.K()},enumerable:!0,configurable:!0}),ql.prototype.doc=function(t){if(Wh("CollectionReference.doc",arguments,0,1),0===arguments.length&&(t=mu.En()),Qh("CollectionReference.doc","non-empty string",1,t),""===t)throw new jr(Vr.INVALID_ARGUMENT,"Document path must be a non-empty string");var e=$r.G(t);return Ll.lE(this.pE.path.child(e),this.firestore,this.EE)},ql.prototype.add=function(t){Yh("CollectionReference.add",arguments,1),Qh("CollectionReference.add","object",1,this.EE?this.EE.toFirestore(t):t);var e=this.doc();return e.set(t).then(function(){return e})},ql.prototype.withConverter=function(t){return new ql(this.BE,this.firestore,t)},ql);function ql(t,e,n){var r=this;if(((r=_l.call(this,Vo.ve(t),e,n)||this).BE=t).length%2!=1)throw new jr(Vr.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t.K()+" has "+t.length);return r}function Fl(t,e,n,r){this.fE=t,this.$E=e,this.ME=n,this.EE=r,this.LE=null,this.OE=null,this.metadata=new Pl(n.hasPendingWrites,n.fromCache)}function Gl(t,e,n){this.pE=t,this.firestore=e,this.EE=n}function Bl(){return null!==Al&&Al.apply(this,arguments)||this}function zl(t,e,n,r,i,o){this.fE=t,this._E=e,this.PE=n,this.VE=r,this.gE=i,this.EE=o}function Kl(t,e){this.hasPendingWrites=t,this.fromCache=e}function Yl(t,e,n){this._E=t,this.firestore=e,this.EE=n,this.XT=this.firestore.JT()}function Hl(t){this.fE=t,this.IE=[],this.wE=!1}function Wl(t,e){this.fE=t,this.TE=e}function Ql(t,e,n){var r=this;if(void 0===n&&(n=new ll),this.HT=null,this.YT=new Ju,this.INTERNAL={delete:function(){return f(r,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.JT(),[4,this.XT.terminate()];case 1:return t.sent(),[2]}})})}},"object"==typeof t.options){var i=t;this.HT=i,this.zT=Ql.ZT(i),this.tE=i.name,this.eE=new Ur(e)}else{var o=t;if(!o.projectId)throw new jr(Vr.INVALID_ARGUMENT,"Must provide projectId");this.zT=new Nu(o.projectId,o.database),this.tE="[DEFAULT]",this.eE=new Mr}this.sE=n,this.iE=new kl({}),this.nE=this.rE(this.zT)}function Zl(t){var e,n;if(void 0===t.host){if(void 0!==t.ssl)throw new jr(Vr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else Xh("settings","non-empty string","host",t.host),this.host=t.host,Jh("settings","boolean","ssl",t.ssl),this.ssl=null===(e=t.ssl)||void 0===e||e;if(ic("settings",t,["host","ssl","credentials","timestampsInSnapshots","cacheSizeBytes","experimentalForceLongPolling"]),Jh("settings","object","credentials",t.credentials),this.credentials=t.credentials,Jh("settings","boolean","timestampsInSnapshots",t.timestampsInSnapshots),!0===t.timestampsInSnapshots?du("The setting 'timestampsInSnapshots: true' is no longer required and should be removed."):!1===t.timestampsInSnapshots&&du("Support for 'timestampsInSnapshots: false' will be removed soon. You must update your code to handle Timestamp objects."),this.timestampsInSnapshots=null===(n=t.timestampsInSnapshots)||void 0===n||n,Jh("settings","number","cacheSizeBytes",t.cacheSizeBytes),void 0===t.cacheSizeBytes)this.cacheSizeBytes=oa.xh;else{if(t.cacheSizeBytes!==Dl&&t.cacheSizeBytes<oa.Oh)throw new jr(Vr.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+oa.Oh);this.cacheSizeBytes=t.cacheSizeBytes}Jh("settings","boolean","experimentalForceLongPolling",t.experimentalForceLongPolling),this.forceLongPolling=void 0!==t.experimentalForceLongPolling&&t.experimentalForceLongPolling}function Xl(t,e,n,r){this.firestore=t,this.timestampsInSnapshots=e,this.qT=n,this.converter=r}function Jl(t,e){if(void 0===e)return{merge:!1};if(ic(t,e,["merge","mergeFields"]),Jh(t,"boolean","merge",e.merge),void 0!==(n=e.mergeFields)&&function(t,e,n){if(!(n instanceof Array))throw new jr(Vr.INVALID_ARGUMENT,"Function "+t+"() requires its "+e+" option to be an array, but it was: "+nc(n));for(var r=0;r<n.length;++r)if(!("string"==typeof(i=n[r])||i instanceof dc))throw new jr(Vr.INVALID_ARGUMENT,"Function "+t+"() requires all "+e+" elements to be a string or a FieldPath, but the value at index "+r+" was: "+nc(n[r]));var i}(t,"mergeFields",n),void 0!==e.mergeFields&&void 0!==e.merge)throw new jr(Vr.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');var n;return e}function $l(t,e){return void 0===e?{}:(ic(t,e,["serverTimestamps"]),$h(t,0,"serverTimestamps",e.serverTimestamps,["estimate","previous","none"]),e)}function tp(t,e){Zh(t,"object",1,e),e&&(ic(t,e,["source"]),$h(t,0,"source",e.source,["default","server","cache"]))}function ep(t,e,n){if(e instanceof Ll){if(e.firestore!==n)throw new jr(Vr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}throw oc(t,"DocumentReference",1,e)}function np(t,e,n){var r;return t?(r=t.toFirestore(e),n="toFirestore() in "+n):r=e,[r,n]}var rp,ip=hc(Rl,"Use firebase.firestore() instead."),op=hc(xl,"Use firebase.firestore().runTransaction() instead."),sp=hc(Ol,"Use firebase.firestore().batch() instead."),up=hc(Ll,"Use firebase.firestore().doc() instead."),ap=hc(Cl),hp=hc(Vl),cp=hc(jl),fp=hc(Ml),lp=hc(Ul,"Use firebase.firestore().collection() instead."),pp={Firestore:ip,GeoPoint:Lc,Timestamp:Gr,Blob:pc,Transaction:op,WriteBatch:sp,DocumentReference:up,DocumentSnapshot:ap,Query:cp,QueryDocumentSnapshot:hp,QuerySnapshot:fp,CollectionReference:lp,FieldPath:dc,FieldValue:Oc,setLogLevel:Rl.setLogLevel,CACHE_SIZE_UNLIMITED:Dl},dp=(Ip.prototype.Y_=function(t){},Ip.prototype.mu=function(){},Ip),yp=(Tp.prototype.Y_=function(t){this.jE.push(t)},Tp.prototype.mu=function(){window.removeEventListener("online",this.qE),window.removeEventListener("offline",this.QE)},Tp.prototype.KE=function(){window.addEventListener("online",this.qE),window.addEventListener("offline",this.QE)},Tp.prototype.UE=function(){pu("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.jE;t<e.length;t++)(0,e[t])(0)},Tp.prototype.WE=function(){pu("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.jE;t<e.length;t++)(0,e[t])(1)},Tp.ho=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},Tp),vp=(bp.prototype.__=function(t){this.HE=t},bp.prototype.h_=function(t){this.YE=t},bp.prototype.onMessage=function(t){this.JE=t},bp.prototype.close=function(){this.zE()},bp.prototype.send=function(t){this.GE(t)},bp.prototype.XE=function(){this.HE()},bp.prototype.ZE=function(t){this.YE(t)},bp.prototype.tI=function(t){this.JE(t)},bp),gp={BatchGetDocuments:"batchGet",Commit:"commit"},mp="gl-js/ fire/"+xr,Ep=(wp.prototype.sI=function(t,e){if(e)for(var n in e.o)e.o.hasOwnProperty(n)&&(t[n]=e.o[n]);t["X-Goog-Api-Client"]=mp},wp.prototype.g_=function(a,r,i){var h=this,c=this.iI(a);return new Promise(function(o,s){var u=new Rr;u.listenOnce(Dr.COMPLETE,function(){try{switch(u.getLastErrorCode()){case Sr.NO_ERROR:var t=u.getResponseJson();pu("Connection","XHR received:",JSON.stringify(t)),o(t);break;case Sr.TIMEOUT:pu("Connection",'RPC "'+a+'" timed out'),s(new jr(Vr.DEADLINE_EXCEEDED,"Request time out"));break;case Sr.HTTP_ERROR:var e=u.getStatus();if(pu("Connection",'RPC "'+a+'" failed with status:',e,"response text:",u.getResponseText()),0<e){var n=u.getResponseJson().error;if(n&&n.status&&n.message){var r=(i=n.status.toLowerCase().replace("_","-"),0<=Object.values(Vr).indexOf(i)?i:Vr.UNKNOWN);s(new jr(r,n.message))}else s(new jr(Vr.UNKNOWN,"Server responded with status "+u.getStatus()))}else pu("Connection",'RPC "'+a+'" failed'),s(new jr(Vr.UNAVAILABLE,"Connection failed."));break;default:vu()}}finally{pu("Connection",'RPC "'+a+'" completed.')}var i});var t=Object.assign({},r);delete t.database;var e=JSON.stringify(t);pu("Connection","XHR sending: ",c+" "+e);var n={"Content-Type":"text/plain"};h.sI(n,i),u.send(c,"POST",e,n,15)})},wp.prototype.y_=function(t,e,n){return this.g_(t,e,n)},wp.prototype.l_=function(t,e){var n,r,i=[this.eI,"/","google.firestore.v1.Firestore","/",t,"/channel"],o=Ar(),s={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.ci.projectId+"/databases/"+this.ci.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling};this.sI(s.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(p())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=p().indexOf("Electron/")||0<=(r=p()).indexOf("MSIE ")||0<=r.indexOf("Trident/")||0<=p().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(s.httpHeadersOverwriteParam="$httpHeaders");var u=i.join("");function a(t,e){h.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})}pu("Connection","Creating WebChannel: "+u+" "+s);var h=o.createWebChannel(u,s),c=!1,f=!1,l=new vp({GE:function(t){f?pu("Connection","Not sending because WebChannel is closed:",t):(c||(pu("Connection","Opening WebChannel transport."),h.open(),c=!0),pu("Connection","WebChannel sending:",t),h.send(t))},zE:function(){return h.close()}});return a(kr.EventType.OPEN,function(){f||pu("Connection","WebChannel transport opened.")}),a(kr.EventType.CLOSE,function(){f||(f=!0,pu("Connection","WebChannel transport closed"),l.ZE())}),a(kr.EventType.ERROR,function(t){f||(f=!0,pu("Connection","WebChannel transport errored:",t),l.ZE(new jr(Vr.UNAVAILABLE,"The operation could not be completed")))}),a(kr.EventType.MESSAGE,function(t){var e;if(!f){var n=t.data[0];gu(!!n);var r=n.error||(null===(e=n[0])||void 0===e?void 0:e.error);if(r){pu("Connection","WebChannel received error:",r);var i=r.status,o=function(){var t=ps[i];if(void 0!==t)return Ns(t)}(),s=r.message;void 0===o&&(o=Vr.INTERNAL,s="Unknown error status: "+i+" with message "+r.message),f=!0,l.ZE(new jr(o,s)),h.close()}else pu("Connection","WebChannel received:",n),l.tI(n)}}),setTimeout(function(){l.XE()},0),l},wp.prototype.iI=function(t){var e=gp[t];return this.eI+"/v1/projects/"+this.ci.projectId+"/databases/"+this.ci.database+"/documents:"+e},wp);function wp(t){this.ci=t.ci;var e=t.ssl?"https":"http";this.eI=e+"://"+t.host,this.forceLongPolling=t.forceLongPolling}function bp(t){this.GE=t.GE,this.zE=t.zE}function Tp(){var t=this;this.qE=function(){return t.UE()},this.QE=function(){return t.WE()},this.jE=[],this.KE()}function Ip(){}function Np(){this.Tc="undefined"!=typeof atob}au.fn((Object.defineProperty(Np.prototype,"document",{get:function(){return"undefined"!=typeof document?document:null},enumerable:!0,configurable:!0}),Object.defineProperty(Np.prototype,"window",{get:function(){return"undefined"!=typeof window?window:null},enumerable:!0,configurable:!0}),Np.prototype.NT=function(t){return Promise.resolve(new Ep(t))},Np.prototype.yT=function(){return new(yp.ho()?yp:dp)},Np.prototype.vT=function(t){return new ou(t,{di:!0})},Np.prototype.Tn=function(t){return JSON.stringify(t)},Np.prototype.atob=function(t){return atob(t)},Np.prototype.btoa=function(t){return btoa(t)},new Np)),(rp=_p).INTERNAL.registerComponent(new b("firestore",function(t){return e=t.getProvider("app").getImmediate(),n=t.getProvider("auth-internal"),new Rl(e,n,new pl);var e,n},"PUBLIC").setServiceProps(Object.assign({},pp))),rp.registerVersion("@firebase/firestore","1.14.2-0")}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.js - be sure to load firebase-app.js first.")}});