!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t=t||self).firebase)}(this,function(If){"use strict";try{(function(){If=If&&Object.prototype.hasOwnProperty.call(If,"default")?If.default:If;var t,u,e,i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function n(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function c(t,s,u,a){return new(u=u||Promise)(function(n,e){function i(t){try{o(a.next(t))}catch(t){e(t)}}function r(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(i,r)}o((a=a.apply(t,s||[])).next())})}function f(n,i){var r,o,s,t,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(r)throw new TypeError("Generator is already executing.");for(;u;)try{if(r=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=i.call(n,u)}catch(t){e=[6,t],o=0}finally{r=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function r(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var i=Array(t),r=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,r++)i[r]=o[s];return i}function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var i=Array(t),r=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,r++)i[r]=o[s];return i}function o(t,e){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];if(!(e<t.logLevel)){var r=(new Date).toISOString(),o=h[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,s(["["+r+"]  "+t.name+":"],n))}}(e=u=u||{})[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT",u.DEBUG,u.VERBOSE,u.INFO,u.WARN,u.ERROR,u.SILENT;var a=u.INFO,h=((t={})[u.DEBUG]="log",t[u.VERBOSE]="log",t[u.INFO]="info",t[u.WARN]="warn",t[u.ERROR]="error",t),l=(Object.defineProperty(p.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in u))throw new TypeError("Invalid value assigned to `logLevel`");this._logLevel=t},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!0,configurable:!0}),p.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.DEBUG],t)),this._logHandler.apply(this,s([this,u.DEBUG],t))},p.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.VERBOSE],t)),this._logHandler.apply(this,s([this,u.VERBOSE],t))},p.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.INFO],t)),this._logHandler.apply(this,s([this,u.INFO],t))},p.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.WARN],t)),this._logHandler.apply(this,s([this,u.WARN],t))},p.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.ERROR],t)),this._logHandler.apply(this,s([this,u.ERROR],t))},p);function p(t){this.name=t,this._logLevel=a,this._logHandler=o,this._userLogHandler=null}function d(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var y,v=(n(g,y=Error),g);function g(t,e){var n=y.call(this,e)||this;return n.code=t,n.name="FirebaseError",Object.setPrototypeOf(n,g.prototype),Error.captureStackTrace&&Error.captureStackTrace(n,m.prototype.create),n}var m=(w.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var i,r=e[0]||{},o=this.service+"/"+t,s=this.errors[t],u=s?(i=r,s.replace(b,function(t,e){var n=i[e];return null!=n?n.toString():"<"+e+"?>"})):"Error",a=this.serviceName+": "+u+" ("+o+").",h=new v(o,a),c=0,f=Object.keys(r);c<f.length;c++){var l=f[c];"_"!==l.slice(-1)&&(l in h&&console.warn('Overwriting FirebaseError base field "'+l+'" can cause unexpected behavior.'),h[l]=r[l])}return h},w);function w(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var b=/\{\$([^}]+)}/g,E=(A.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},A.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},A.prototype.setServiceProps=function(t){return this.serviceProps=t,this},A);function A(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var I,N="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},T=T||{},_=N;function S(t){return"string"==typeof t}function R(t){return"number"==typeof t}function k(t,e){t=t.split("."),e=e||_;for(var n=0;n<t.length;n++)if(null==(e=e[t[n]]))return null;return e}function O(){}function L(t){var e=typeof t;if("object"==e){if(!t)return"null";if(t instanceof Array)return"array";if(t instanceof Object)return e;var n=Object.prototype.toString.call(t);if("[object Window]"==n)return"object";if("[object Array]"==n||"number"==typeof t.length&&void 0!==t.splice&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("splice"))return"array";if("[object Function]"==n||void 0!==t.call&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("call"))return"function"}else if("function"==e&&void 0===t.call)return"object";return e}function D(t){return"array"==L(t)}function V(t){var e=L(t);return"array"==e||"object"==e&&"number"==typeof t.length}function C(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var P="closure_uid_"+(1e9*Math.random()>>>0),U=0;function M(t,e,n){return t.call.apply(t.bind,arguments)}function x(e,n,t){if(!e)throw Error();if(2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,i),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function F(t,e,n){return(F=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?M:x).apply(null,arguments)}function q(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var G=Date.now||function(){return+new Date};function j(t,o){function e(){}e.prototype=o.prototype,t.N=o.prototype,t.prototype=new e,(t.prototype.constructor=t).yb=function(t,e,n){for(var i=Array(arguments.length-2),r=2;r<arguments.length;r++)i[r-2]=arguments[r];return o.prototype[e].apply(t,i)}}function B(){this.j=this.j,this.i=this.i}B.prototype.j=!1,B.prototype.la=function(){!this.j&&(this.j=!0,this.G(),0)&&(this[P]||(this[P]=++U))},B.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var z=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(S(t))return S(e)&&1==e.length?t.indexOf(e,0):-1;for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},H=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var i=t.length,r=S(t)?t.split(""):t,o=0;o<i;o++)o in r&&e.call(n,r[o],o,t)};function Y(t){return Array.prototype.concat.apply([],arguments)}function Q(t){var e=t.length;if(0<e){for(var n=Array(e),i=0;i<e;i++)n[i]=t[i];return n}return[]}function W(t){return/^[\s\xa0]*$/.test(t)}var X,K=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function $(t,e){return-1!=t.indexOf(e)}function Z(t,e){return t<e?-1:e<t?1:0}t:{var J=_.navigator;if(J){var tt=J.userAgent;if(tt){X=tt;break t}}X=""}function et(t,e,n){for(var i in t)e.call(n,t[i],i,t)}function nt(t){var e,n={};for(e in t)n[e]=t[e];return n}var it="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function rt(t,e){for(var n,i,r=1;r<arguments.length;r++){for(n in i=arguments[r])t[n]=i[n];for(var o=0;o<it.length;o++)n=it[o],Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}}function ot(t){return ot[" "](t),t}ot[" "]=O;var st,ut,at=$(X,"Opera"),ht=$(X,"Trident")||$(X,"MSIE"),ct=$(X,"Edge"),ft=ct||ht,lt=$(X,"Gecko")&&!($(X.toLowerCase(),"webkit")&&!$(X,"Edge"))&&!($(X,"Trident")||$(X,"MSIE"))&&!$(X,"Edge"),pt=$(X.toLowerCase(),"webkit")&&!$(X,"Edge");function dt(){var t=_.document;return t?t.documentMode:void 0}t:{var yt="",vt=(ut=X,lt?/rv:([^\);]+)(\)|;)/.exec(ut):ct?/Edge\/([\d\.]+)/.exec(ut):ht?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(ut):pt?/WebKit\/(\S+)/.exec(ut):at?/(?:Version)[ \/]?(\S+)/.exec(ut):void 0);if(vt&&(yt=vt?vt[1]:""),ht){var gt=dt();if(null!=gt&&gt>parseFloat(yt)){st=String(gt);break t}}st=yt}var mt,wt={};function bt(u){return t=u,e=function(){for(var t=0,e=K(String(st)).split("."),n=K(String(u)).split("."),i=Math.max(e.length,n.length),r=0;0==t&&r<i;r++){var o=e[r]||"",s=n[r]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=Z(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||Z(0==o[2].length,0==s[2].length)||Z(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t},n=wt,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e();var t,e,n}var Et=_.document;mt=Et&&ht?dt()||("CSS1Compat"==Et.compatMode?parseInt(st,10):5):void 0;var At=!ht||9<=Number(mt),It=ht&&!bt("9"),Nt=function(){if(!_.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{_.addEventListener("test",O,e),_.removeEventListener("test",O,e)}catch(t){}return t}();function Tt(t,e){this.type=t,this.a=this.target=e,this.Ia=!0}function _t(t,e){if(Tt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,i=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(lt){t:{try{ot(e.nodeName);var r=!0;break t}catch(t){}r=!1}r||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,i?(this.clientX=void 0!==i.clientX?i.clientX:i.pageX,this.clientY=void 0!==i.clientY?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=S(t.pointerType)?t.pointerType:St[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}Tt.prototype.b=function(){this.Ia=!1},j(_t,Tt);var St={2:"touch",3:"pen",4:"mouse"};_t.prototype.b=function(){_t.N.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,It)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var Rt="closure_listenable_"+(1e6*Math.random()|0),kt=0;function Ot(t,e,n,i,r){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!i,this.da=r,this.key=++kt,this.X=this.Z=!1}function Lt(t){t.X=!0,t.listener=null,t.proxy=null,t.src=null,t.da=null}function Dt(t){this.src=t,this.a={},this.b=0}function Vt(t,e){var n=e.type;if(n in t.a){var i,r=t.a[n],o=z(r,e);(i=0<=o)&&Array.prototype.splice.call(r,o,1),i&&(Lt(e),0==t.a[n].length&&(delete t.a[n],t.b--))}}function Ct(t,e,n,i){for(var r=0;r<t.length;++r){var o=t[r];if(!o.X&&o.listener==e&&o.capture==!!n&&o.da==i)return r}return-1}Dt.prototype.add=function(t,e,n,i,r){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=Ct(t,e,i,r);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new Ot(e,this.src,o,!!i,r)).Z=n,t.push(e)),e};var Pt="closure_lm_"+(1e6*Math.random()|0),Ut={};function Mt(t,e,n,i,r){if(i&&i.once)return function t(e,n,i,r,o){if(D(n)){for(var s=0;s<n.length;s++)t(e,n[s],i,r,o);return null}return i=Ht(i),e&&e[Rt]?e.Aa(n,i,C(r)?!!r.capture:!!r,o):xt(e,n,i,!0,r,o)}(t,e,n,i,r);if(D(e)){for(var o=0;o<e.length;o++)Mt(t,e[o],n,i,r);return null}return n=Ht(n),t&&t[Rt]?t.za(e,n,C(i)?!!i.capture:!!i,r):xt(t,e,n,!1,i,r)}function xt(t,e,n,i,r,o){if(!e)throw Error("Invalid event type");var s=C(r)?!!r.capture:!!r;if(s&&!At)return null;var u,a,h=Bt(t);if(h||(t[Pt]=h=new Dt(t)),(n=h.add(e,n,i,s,o)).proxy)return n;if(u=jt,i=a=At?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=i).src=t,i.listener=n,t.addEventListener)Nt||(r=s),void 0===r&&(r=!1),t.addEventListener(e.toString(),i,r);else if(t.attachEvent)t.attachEvent(qt(e.toString()),i);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(i)}return n}function Ft(t){if(!R(t)&&t&&!t.X){var e=t.src;if(e&&e[Rt])Vt(e.c,t);else{var n=t.type,i=t.proxy;e.removeEventListener?e.removeEventListener(n,i,t.capture):e.detachEvent?e.detachEvent(qt(n),i):e.addListener&&e.removeListener&&e.removeListener(i),(n=Bt(e))?(Vt(n,t),0==n.b&&(n.src=null,e[Pt]=null)):Lt(t)}}}function qt(t){return t in Ut?Ut[t]:Ut[t]="on"+t}function Gt(t,e){var n=t.listener,i=t.da||t.src;return t.Z&&Ft(t),n.call(i,e)}function jt(t,e){return!!t.X||Gt(t,At?new _t(e,this):e=new _t(e||k("window.event"),this))}function Bt(t){return(t=t[Pt])instanceof Dt?t:null}var zt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ht(e){return"function"==L(e)?e:(e[zt]||(e[zt]=function(t){return e.handleEvent(t)}),e[zt])}function Yt(){B.call(this),this.c=new Dt(this),(this.J=this).B=null}function Qt(t,e,n,i){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var r=!0,o=0;o<e.length;++o){var s=e[o];if(s&&!s.X&&s.capture==n){var u=s.listener,a=s.da||s.src;s.Z&&Vt(t.c,s),r=!1!==u.call(a,i)&&r}}return r&&0!=i.Ia}j(Yt,B),Yt.prototype[Rt]=!0,(I=Yt.prototype).addEventListener=function(t,e,n,i){Mt(this,t,e,n,i)},I.removeEventListener=function(t,e,n,i){!function t(e,n,i,r,o){if(D(n))for(var s=0;s<n.length;s++)t(e,n[s],i,r,o);else r=C(r)?!!r.capture:!!r,i=Ht(i),e&&e[Rt]?(e=e.c,(n=String(n).toString())in e.a&&-1<(i=Ct(s=e.a[n],i,r,o))&&(Lt(s[i]),Array.prototype.splice.call(s,i,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&Bt(e))&&(n=e.a[n.toString()],e=-1,n&&(e=Ct(n,i,r,o)),(i=-1<e?n[e]:null)&&Ft(i))}(this,t,e,n,i)},I.dispatchEvent=function(t){var e,n=this.B;if(n)for(e=[];n;n=n.B)e.push(n);n=this.J;var i=t.type||t;if(S(t))t=new Tt(t,n);else if(t instanceof Tt)t.target=t.target||n;else{var r=t;rt(t=new Tt(i,n),r)}if(r=!0,e)for(var o=e.length-1;0<=o;o--){var s=t.a=e[o];r=Qt(s,i,!0,t)&&r}if(r=Qt(s=t.a=n,i,!0,t)&&r,r=Qt(s,i,!1,t)&&r,e)for(o=0;o<e.length;o++)r=Qt(s=t.a=e[o],i,!1,t)&&r;return r},I.G=function(){if(Yt.N.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],i=0;i<n.length;i++)Lt(n[i]);delete e.a[t],e.b--}}this.B=null},I.za=function(t,e,n,i){return this.c.add(String(t),e,!1,n,i)},I.Aa=function(t,e,n,i){return this.c.add(String(t),e,!0,n,i)};var Wt=_.JSON.stringify;function Xt(t,e){this.c=t,this.f=e,this.b=0,this.a=null}function Kt(){this.b=this.a=null}Xt.prototype.get=function(){if(0<this.b){this.b--;var t=this.a;this.a=t.next,t.next=null}else t=this.c();return t};var $t,Zt=new Xt(function(){return new Jt},function(t){t.reset()});function Jt(){this.next=this.b=this.a=null}function te(t){_.setTimeout(function(){throw t},0)}function ee(t,e){var n;$t||(n=_.Promise.resolve(void 0),$t=function(){n.then(re)}),ne||($t(),ne=!0),ie.add(t,e)}Kt.prototype.add=function(t,e){var n=Zt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Jt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var ne=!(Jt.prototype.reset=function(){this.next=this.b=this.a=null}),ie=new Kt;function re(){for(var t;i=n=void 0,i=null,(n=ie).a&&(i=n.a,n.a=n.a.next,n.a||(n.b=null),i.next=null),t=i;){try{t.a.call(t.b)}catch(t){te(t)}var e=Zt;e.f(t),e.b<100&&(e.b++,t.next=e.a,e.a=t)}var n,i;ne=!1}function oe(t,e){Yt.call(this),this.b=t||1,this.a=e||_,this.f=F(this.gb,this),this.g=G()}function se(t){t.ba=!1,t.L&&(t.a.clearTimeout(t.L),t.L=null)}function ue(t,e,n){if("function"==L(t))n&&(t=F(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=F(t.handleEvent,t)}return 2147483647<Number(e)?-1:_.setTimeout(t,e||0)}function ae(t,e,n){B.call(this),this.f=null!=n?F(t,n):t,this.c=e,this.b=F(this.$a,this),this.a=[]}function he(t){t.U=ue(t.b,t.c),t.f.apply(null,t.a)}function ce(t){B.call(this),this.b=t,this.a={}}j(oe,Yt),(I=oe.prototype).ba=!1,I.L=null,I.gb=function(){if(this.ba){var t=G()-this.g;0<t&&t<.8*this.b?this.L=this.a.setTimeout(this.f,this.b-t):(this.L&&(this.a.clearTimeout(this.L),this.L=null),this.dispatchEvent("tick"),this.ba&&(se(this),this.start()))}},I.start=function(){this.ba=!0,this.L||(this.L=this.a.setTimeout(this.f,this.b),this.g=G())},I.G=function(){oe.N.G.call(this),se(this),delete this.a},j(ae,B),(I=ae.prototype).ea=!1,I.U=null,I.Ta=function(t){this.a=arguments,this.U?this.ea=!0:he(this)},I.G=function(){ae.N.G.call(this),this.U&&(_.clearTimeout(this.U),this.U=null,this.ea=!1,this.a=[])},I.$a=function(){this.U=null,this.ea&&(this.ea=!1,he(this))},j(ce,B);var fe=[];function le(t,e,n,i){D(n)||(n&&(fe[0]=n.toString()),n=fe);for(var r=0;r<n.length;r++){var o=Mt(e,n[r],i||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function pe(t){et(t.a,function(t,e){this.a.hasOwnProperty(e)&&Ft(t)},t),t.a={}}function de(){}ce.prototype.G=function(){ce.N.G.call(this),pe(this)},ce.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ye=new Yt;function ve(t){Tt.call(this,"serverreachability",t)}function ge(){ye.dispatchEvent(new ve(ye))}function me(t){Tt.call(this,"statevent",t)}function we(){ye.dispatchEvent(new me(ye))}function be(t){Tt.call(this,"timingevent",t)}function Ee(t,e){if("function"!=L(t))throw Error("Fn must not be null and must be a function");return _.setTimeout(function(){t()},e)}j(ve,Tt),j(me,Tt),j(be,Tt);var Ae={NO_ERROR:0,hb:1,ob:2,nb:3,kb:4,mb:5,pb:6,La:7,TIMEOUT:8,sb:9},Ie={jb:"complete",wb:"success",Ma:"error",La:"abort",ub:"ready",vb:"readystatechange",TIMEOUT:"timeout",qb:"incrementaldata",tb:"progress",lb:"downloadprogress",xb:"uploadprogress"};function Ne(){}function Te(t){var e;return(e=t.a)||(e=t.a={}),e}function _e(){}Ne.prototype.a=null;var Se,Re={OPEN:"a",ib:"b",Ma:"c",rb:"d"};function ke(){Tt.call(this,"d")}function Oe(){Tt.call(this,"c")}function Le(){}function De(t,e,n){this.g=t,this.W=e,this.V=n||1,this.I=new ce(this),this.O=Ve,t=ft?125:void 0,this.P=new oe(t),this.h=null,this.b=!1,this.l=this.D=this.f=this.F=this.v=this.R=this.i=null,this.j=[],this.a=null,this.A=0,this.c=this.w=null,this.o=-1,this.m=!1,this.J=0,this.B=null,this.s=this.S=this.H=!1}j(ke,Tt),j(Oe,Tt),j(Le,Ne),Se=new Le;var Ve=45e3,Ce={},Pe={};function Ue(t,e,n){t.F=1,t.f=un(Je(e)),t.l=n,t.H=!0,xe(t,null)}function Me(t,e,n,i){t.F=1,t.f=un(Je(e)),t.l=null,t.H=n,xe(t,i)}function xe(t,e){t.v=G(),qe(t),t.D=Je(t.f),sn(t.D,"t",t.V),t.A=0,t.a=t.g.$(t.g.Y()?e:null),0<t.J&&(t.B=new ae(F(t.Ja,t,t.a),t.J)),le(t.I,t.a,"readystatechange",t.cb),e=t.h?nt(t.h):{},t.l?(t.w||(t.w="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ca(t.D,t.w,t.l,e)):(t.w="GET",t.a.ca(t.D,t.w,null,e)),ge()}function Fe(t,e,n){for(var i=!0;!t.m&&t.A<n.length;){var r=(s=n,a=u=void 0,u=(o=t).A,-1==(a=s.indexOf("\n",u))?Pe:(u=Number(s.substring(u,a)),isNaN(u)?Ce:(a+=1)+u>s.length?Pe:(s=s.substr(a,u),o.A=a+u,s)));if(r==Pe){4==e&&(t.c=4,we(),i=!1);break}if(r==Ce){t.c=4,we(),i=!1;break}He(t,r)}var o,s,u,a;4==e&&0==n.length&&(t.c=1,we(),i=!1),t.b=t.b&&i,i||(ze(t),Be(t))}function qe(t){t.R=G()+t.O,Ge(t,t.O)}function Ge(t,e){if(null!=t.i)throw Error("WatchDog timer not null");t.i=Ee(F(t.ab,t),e)}function je(t){t.i&&(_.clearTimeout(t.i),t.i=null)}function Be(t){t.g.Ca()||t.m||t.g.na(t)}function ze(t){je(t);var e=t.B;e&&"function"==typeof e.la&&e.la(),t.B=null,se(t.P),pe(t.I),t.a&&(e=t.a,t.a=null,e.abort(),e.la())}function He(t,e){try{t.g.Fa(t,e),ge()}catch(t){}}function Ye(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(V(t)||S(t))H(t,e,void 0);else{if(t.K&&"function"==typeof t.K)var n=t.K();else if(t.C&&"function"==typeof t.C)n=void 0;else if(V(t)||S(t)){n=[];for(var i=t.length,r=0;r<i;r++)n.push(r)}else for(r in n=[],i=0,t)n[i++]=r;r=(i=function(t){if(t.C&&"function"==typeof t.C)return t.C();if(S(t))return t.split("");if(V(t)){for(var e=[],n=t.length,i=0;i<n;i++)e.push(t[i]);return e}for(i in e=[],n=0,t)e[n++]=t[i];return e}(t)).length;for(var o=0;o<r;o++)e.call(void 0,i[o],n&&n[o],t)}}function Qe(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var i=0;i<n;i+=2)this.set(arguments[i],arguments[i+1])}else if(t)if(t instanceof Qe)for(n=t.K(),i=0;i<n.length;i++)this.set(n[i],t.get(n[i]));else for(i in t)this.set(i,t[i])}function We(t,e){Ke(t.b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Xe(t))}function Xe(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var i=t.a[e];Ke(t.b,i)&&(t.a[n++]=i),e++}t.a.length=n}if(t.c!=t.a.length){var r={};for(n=e=0;e<t.a.length;)Ke(r,i=t.a[e])||(r[t.a[n++]=i]=1),e++;t.a.length=n}}function Ke(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(I=De.prototype).setTimeout=function(t){this.O=t},I.cb=function(t){t=t.target;var e=this.B;e&&3==Jn(t)?e.Ta():this.Ja(t)},I.Ja=function(t){try{if(t==this.a)t:{var e=Jn(this.a),n=this.a.ya();this.a.T();if(!(e<3||3==e&&!ft&&!this.a.aa())){this.m||4!=e||7==n||ge(),je(this);var i=this.a.T();this.o=i;var r=this.a.aa();if(this.b=200==i){if(this.S&&!this.s){e:{if(this.a){var o=ti(this.a,"X-HTTP-Initial-Response");if(o&&!W(o)){var s=o;break e}}s=null}if(!s){this.b=!1,this.c=3,we(),ze(this),Be(this);break t}this.s=!0,He(this,s)}this.H?(Fe(this,e,r),ft&&this.b&&3==e&&(le(this.I,this.P,"tick",this.bb),this.P.start())):He(this,r),4==e&&ze(this),this.b&&!this.m&&(4==e?this.g.na(this):(this.b=!1,qe(this)))}else 400==i&&0<r.indexOf("Unknown SID")?this.c=3:this.c=0,we(),ze(this),Be(this)}}}catch(t){}},I.bb=function(){if(this.a){var t=Jn(this.a),e=this.a.aa();this.A<e.length&&(je(this),Fe(this,t,e),this.b&&4!=t&&qe(this))}},I.cancel=function(){this.m=!0,ze(this)},I.ab=function(){this.i=null;var t=G();0<=t-this.R?(2!=this.F&&(ge(),we()),ze(this),this.c=2,Be(this)):Ge(this,this.R-t)},(I=Qe.prototype).C=function(){Xe(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},I.K=function(){return Xe(this),this.a.concat()},I.get=function(t,e){return Ke(this.b,t)?this.b[t]:e},I.set=function(t,e){Ke(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},I.forEach=function(t,e){for(var n=this.K(),i=0;i<n.length;i++){var r=n[i],o=this.get(r);t.call(e,o,r,this)}};var $e=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Ze(t,e){var n;this.b=this.j=this.f="",this.i=null,this.g=this.a="",this.h=!1,t instanceof Ze?(this.h=void 0!==e?e:t.h,tn(this,t.f),this.j=t.j,en(this,t.b),nn(this,t.i),this.a=t.a,rn(this,En(t.c)),this.g=t.g):t&&(n=String(t).match($e))?(this.h=!!e,tn(this,n[1]||"",!0),this.j=an(n[2]||""),en(this,n[3]||"",!0),nn(this,n[4]),this.a=an(n[5]||"",!0),rn(this,n[6]||"",!0),this.g=an(n[7]||"")):(this.h=!!e,this.c=new vn(null,this.h))}function Je(t){return new Ze(t)}function tn(t,e,n){t.f=n?an(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function en(t,e,n){t.b=n?an(e,!0):e}function nn(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.i=e}else t.i=null}function rn(t,e,n){var i,r;e instanceof vn?(t.c=e,i=t.c,(r=t.h)&&!i.f&&(gn(i),i.c=null,i.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(mn(this,e),bn(this,n,t))},i)),i.f=r):(n||(e=hn(e,dn)),t.c=new vn(e,t.h))}function on(t,e,n){t.c.set(e,n)}function sn(t,e,n){D(n)||(n=[String(n)]),bn(t.c,e,n)}function un(t){return on(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^G()).toString(36)),t}function an(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function hn(t,e,n){return S(t)?(t=encodeURI(t).replace(e,cn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function cn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Ze.prototype.toString=function(){var t=[],e=this.f;e&&t.push(hn(e,fn,!0),":");var n=this.b;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(hn(e,fn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.i)&&t.push(":",String(n))),(n=this.a)&&(this.b&&"/"!=n.charAt(0)&&t.push("/"),t.push(hn(n,"/"==n.charAt(0)?pn:ln,!0))),(n=this.c.toString())&&t.push("?",n),(n=this.g)&&t.push("#",hn(n,yn)),t.join("")},Ze.prototype.resolve=function(t){var e=Je(this),n=!!t.f;n?tn(e,t.f):n=!!t.j,n?e.j=t.j:n=!!t.b,n?en(e,t.b):n=null!=t.i;var i=t.a;if(n)nn(e,t.i);else if(n=!!t.a){if("/"!=i.charAt(0))if(this.b&&!this.a)i="/"+i;else{var r=e.a.lastIndexOf("/");-1!=r&&(i=e.a.substr(0,r+1)+i)}if(".."==(r=i)||"."==r)i="";else if($(r,"./")||$(r,"/.")){i=0==r.lastIndexOf("/",0),r=r.split("/");for(var o=[],s=0;s<r.length;){var u=r[s++];"."==u?i&&s==r.length&&o.push(""):".."==u?((1<o.length||1==o.length&&""!=o[0])&&o.pop(),i&&s==r.length&&o.push("")):(o.push(u),i=!0)}i=o.join("/")}else i=r}return n?e.a=i:n=""!==t.c.toString(),n?rn(e,En(t.c)):n=!!t.g,n&&(e.g=t.g),e};var fn=/[#\/\?@]/g,ln=/[#\?:]/g,pn=/[#\?]/g,dn=/[#\?@]/g,yn=/#/g;function vn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function gn(u){u.a||(u.a=new Qe,u.b=0,u.c&&function(t){if(t){t=t.split("&");for(var e=0;e<t.length;e++){var n=t[e].indexOf("="),i=null;if(0<=n){var r=t[e].substring(0,n);i=t[e].substring(n+1)}else r=t[e];o=r,s=i?decodeURIComponent(i.replace(/\+/g," ")):"",u.add(decodeURIComponent(o.replace(/\+/g," ")),s)}}var o,s}(u.c))}function mn(t,e){gn(t),e=An(t,e),Ke(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,We(t.a,e))}function wn(t,e){return gn(t),e=An(t,e),Ke(t.a.b,e)}function bn(t,e,n){mn(t,e),0<n.length&&(t.c=null,t.a.set(An(t,e),Q(n)),t.b+=n.length)}function En(t){var e=new vn;return e.c=t.c,t.a&&(e.a=new Qe(t.a),e.b=t.b),e}function An(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function In(t){this.a=t,this.b=this.h=null,this.g=!1,this.i=null,this.c=-1,this.l=this.f=null}function Nn(t){var e=t.a.F.a;if(null!=e)we(),e?(we(),li(t.a,t,!1)):(we(),li(t.a,t,!0));else{t.b=new De(t,void 0,void 0),t.b.h=t.h,e=gi(e=t.a,e.Y()?t.f:null,t.i),we(),sn(e,"TYPE","xmlhttp");var n=t.a.j,i=t.a.I;n&&i&&on(e,n,i),Me(t.b,e,!1,t.f)}}function Tn(){this.a=this.b=null}function _n(){this.a=new Qe}function Sn(t){var e=typeof t;return"object"==e&&t||"function"==e?"o"+(t[P]||(t[P]=++U)):e.charAt(0)+t}function Rn(t,e){this.b=t,this.a=e}function kn(t){this.g=t||On,t=_.PerformanceNavigationTiming?0<(t=_.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(_.ka&&_.ka.Da&&_.ka.Da()&&_.ka.Da().zb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new _n),this.b=null,this.c=[]}(I=vn.prototype).add=function(t,e){gn(this),this.c=null,t=An(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},I.forEach=function(n,i){gn(this),this.a.forEach(function(t,e){H(t,function(t){n.call(i,t,e,this)},this)},this)},I.K=function(){gn(this);for(var t=this.a.C(),e=this.a.K(),n=[],i=0;i<e.length;i++)for(var r=t[i],o=0;o<r.length;o++)n.push(e[i]);return n},I.C=function(t){gn(this);var e=[];if(S(t))wn(this,t)&&(e=Y(e,this.a.get(An(this,t))));else{t=this.a.C();for(var n=0;n<t.length;n++)e=Y(e,t[n])}return e},I.set=function(t,e){return gn(this),this.c=null,wn(this,t=An(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},I.get=function(t,e){return t&&0<(t=this.C(t)).length?String(t[0]):e},I.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.K(),n=0;n<e.length;n++){var i=e[n],r=encodeURIComponent(String(i));i=this.C(i);for(var o=0;o<i.length;o++){var s=r;""!==i[o]&&(s+="="+encodeURIComponent(String(i[o]))),t.push(s)}}return this.c=t.join("&")},j(function(){},function(){}),(I=In.prototype).M=null,I.$=function(t){return this.a.$(t)},I.abort=function(){this.b&&(this.b.cancel(),this.b=null),this.c=-1},I.Ca=function(){return!1},I.Fa=function(t,e){if(this.c=t.o,0==this.M){if(!this.a.o&&(t=t.a)){var n=ti(t,"X-Client-Wire-Protocol");this.l=n||null,this.a.j&&(t=ti(t,"X-HTTP-Session-Id"))&&(this.a.I=t)}if(e){try{var i=this.a.ja.a.parse(e)}catch(t){return(e=this.a).m=this.c,void yi(e,2)}this.f=i[0]}else(e=this.a).m=this.c,yi(e,2)}else 1==this.M&&(this.g?we():"11111"==e?(we(),this.g=!0,(!ht||10<=Number(mt))&&(this.c=200,this.b.cancel(),we(),li(this.a,this,!0))):(we(),this.g=!1))},I.na=function(){if(this.c=this.b.o,this.b.b)0==this.M?(this.M=1,Nn(this)):1==this.M&&(this.g?(we(),li(this.a,this,!0)):(we(),li(this.a,this,!1)));else{0!=this.M&&1!=this.M||we();var t=this.a;t.m=this.c,yi(t,2)}},I.Y=function(){return this.a.Y()},I.ma=function(){return this.a.ma()},_n.prototype.add=function(t){this.a.set(Sn(t),t)},_n.prototype.C=function(){return this.a.C()};var On=10;function Ln(t,e){!t.a&&($(e,"spdy")||$(e,"quic")||$(e,"h2"))&&(t.f=t.g,t.a=new _n,t.b&&(Pn(t,t.b),t.b=null))}function Dn(t){return t.b||t.a&&t.a.a.c>=t.f}function Vn(t){return t.b?1:t.a?t.a.a.c:0}function Cn(t,e){return t.b?t.b==e:!!t.a&&(e=Sn(e),Ke(t.a.a.b,e))}function Pn(t,e){t.a?t.a.add(e):t.b=e}function Un(t,e){var n;t.b&&t.b==e?t.b=null:((n=t.a)&&(n=Sn(e),n=Ke(t.a.a.b,n)),n&&We(t.a.a,Sn(e)))}function Mn(t){if(null!=t.b)return t.c.concat(t.b.j);if(null==t.a||0==t.a.a.c)return Q(t.c);var e=t.c;return H(t.a.C(),function(t){e=e.concat(t.j)}),e}function xn(){}function Fn(){this.a=new xn}function qn(t,i,e){var r=e||"";try{Ye(t,function(t,e){var n=t;C(t)&&(n=Wt(t)),i.push(r+e+"="+encodeURIComponent(n))})}catch(t){throw i.push(r+"type="+encodeURIComponent("_badmap")),t}}function Gn(t,e,n,i,r){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,r(i)}catch(t){}}kn.prototype.cancel=function(){var t;this.c=Mn(this),this.b?(this.b.cancel(),this.b=null):this.a&&0!=this.a.a.c&&(H(this.a.C(),function(t){t.cancel()}),(t=this.a.a).b={},t.a.length=0,t.c=0)},xn.prototype.stringify=function(t){return _.JSON.stringify(t,void 0)},xn.prototype.parse=function(t){return _.JSON.parse(t,void 0)};var jn=_.JSON.parse;function Bn(t){Yt.call(this),this.headers=new Qe,this.H=t||null,this.b=!1,this.s=this.a=null,this.A="",this.h=0,this.f="",this.g=this.w=this.l=this.v=!1,this.o=0,this.m=null,this.I=zn,this.D=this.F=!1}j(Bn,Yt);var zn="",Hn=/^https?$/i,Yn=["POST","PUT"];function Qn(t){return"content-type"==t.toLowerCase()}function Wn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Xn(t),$n(t)}function Xn(t){t.v||(t.v=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function Kn(t){if(t.b&&void 0!==T&&(!t.s[1]||4!=Jn(t)||2!=t.T()))if(t.l&&4==Jn(t))ue(t.Ea,0,t);else if(t.dispatchEvent("readystatechange"),4==Jn(t)){t.b=!1;try{var e,n=t.T();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var i=!0;break t;default:i=!1}if(!(e=i)){var r;if(r=0===n){var o=String(t.A).match($e)[1]||null;if(!o&&_.self&&_.self.location){var s=_.self.location.protocol;o=s.substr(0,s.length-1)}r=!Hn.test(o?o.toLowerCase():"")}e=r}if(e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{t.h=6;try{var u=2<Jn(t)?t.a.statusText:""}catch(t){u=""}t.f=u+" ["+t.T()+"]",Xn(t)}}finally{$n(t)}}}function $n(t,e){if(t.a){Zn(t);var n=t.a,i=t.s[0]?O:null;t.a=null,t.s=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=i}catch(t){}}}function Zn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(_.clearTimeout(t.m),t.m=null)}function Jn(t){return t.a?t.a.readyState:0}function ti(t,e){return t.a?t.a.getResponseHeader(e):null}function ei(t,e,n){t:{for(i in n){var i=!1;break t}i=!0}if(i)return t;var r;if(r="",et(n,function(t,e){r+=e,r+=":",r+=t,r+="\r\n"}),n=r,S(t)){if(e=encodeURIComponent(String(e)),e+=n=null!=n?"="+encodeURIComponent(String(n)):""){if((n=t.indexOf("#"))<0&&(n=t.length),(i=t.indexOf("?"))<0||n<i){i=n;var o=""}else o=t.substring(i+1,n);n=(t=[t.substr(0,i),o,t.substr(n)])[1],t[1]=e?n?n+"&"+e:e:n,t=t[0]+(t[1]?"?"+t[1]:"")+t[2]}return t}return on(t,e,n),t}function ni(t){this.f=[],this.F=new Tn,this.ga=this.pa=this.B=this.ha=this.a=this.I=this.j=this.V=this.g=this.J=this.i=null,this.Qa=this.P=0,this.Oa=!!k("internalChannelParams.failFast",t),this.ia=this.w=this.s=this.l=this.h=this.c=null,this.oa=!0,this.m=this.ra=this.O=-1,this.S=this.v=this.A=0,this.Na=k("internalChannelParams.baseRetryDelayMs",t)||5e3,this.Ra=k("internalChannelParams.retryDelaySeedMs",t)||1e4,this.Pa=k("internalChannelParams.forwardChannelMaxRetries",t)||2,this.qa=k("internalChannelParams.forwardChannelRequestTimeoutMs",t)||2e4,this.Ka=t&&t.Ab||void 0,this.D=void 0,this.R=t&&t.supportsCrossDomainXhr||!1,this.H="",this.b=new kn(t&&t.concurrentRequestLimit),this.ja=new Fn,this.o=!t||void 0===t.backgroundChannelTest||t.backgroundChannelTest,(this.W=t&&t.fastHandshake||!1)&&!this.o&&(this.o=!0),t&&t.forceLongPolling&&(this.oa=!1),this.fa=void 0}function ii(t){if(ri(t),3==t.u){var e=t.P++,n=Je(t.B);on(n,"SID",t.H),on(n,"RID",e),on(n,"TYPE","terminate"),ai(t,n),(e=new De(t,e,void 0)).F=2,e.f=un(Je(n)),n=!1,_.navigator&&_.navigator.sendBeacon&&(n=_.navigator.sendBeacon(e.f.toString(),"")),!n&&_.Image&&((new Image).src=e.f,n=!0),n||(e.a=e.g.$(null),e.a.ca(e.f)),e.v=G(),qe(e)}vi(t)}function ri(t){t.w&&(t.w.abort(),t.w=null),t.a&&(t.a.cancel(),t.a=null),t.l&&(_.clearTimeout(t.l),t.l=null),pi(t),t.b.cancel(),t.h&&(R(t.h)&&_.clearTimeout(t.h),t.h=null)}function oi(t,e){t.f.push(new Rn(t.Qa++,e)),3==t.u&&si(t)}function si(t){Dn(t.b)||t.h||(t.h=!0,ee(t.Ha,t),t.A=0)}function ui(t,e){var n;n=e?e.W:t.P++;var i=Je(t.B);on(i,"SID",t.H),on(i,"RID",n),on(i,"AID",t.O),ai(t,i),t.g&&t.i&&ei(i,t.g,t.i),n=new De(t,n,t.A+1),null===t.g&&(n.h=t.i),e&&(t.f=e.j.concat(t.f)),e=hi(t,n,1e3),n.setTimeout(Math.round(.5*t.qa)+Math.round(.5*t.qa*Math.random())),Pn(t.b,n),Ue(n,i,e)}function ai(t,n){t.c&&Ye({},function(t,e){on(n,e,t)})}function hi(t,e,n){n=Math.min(t.f.length,n);var i=t.c?F(t.c.Sa,t.c,t):null;t:for(var r=t.f,o=-1;;){var s=["count="+n];-1==o?0<n?(o=r[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var h=r[a].b,c=r[a].a;if((h-=o)<0)o=Math.max(0,r[a].b-100),u=!1;else try{qn(c,s,"req"+h+"_")}catch(t){i&&i(c)}}if(u){i=s.join("&");break t}}return t=t.f.splice(0,n),e.j=t,i}function ci(t){t.a||t.l||(t.S=1,ee(t.Ga,t),t.v=0)}function fi(t){return!(t.a||t.l||3<=t.v)&&(t.S++,t.l=Ee(F(t.Ga,t),di(t,t.v)),t.v++,1)}function li(t,e,n){var i=e.l;i&&Ln(t.b,i),t.ia=t.oa&&n,t.m=e.c,t.B=gi(t,null,t.ha),si(t)}function pi(t){null!=t.s&&(_.clearTimeout(t.s),t.s=null)}function di(t,e){var n=t.Na+Math.floor(Math.random()*t.Ra);return t.ma()||(n*=2),n*e}function yi(t,e){if(2==e){var n=null;t.c&&(n=null);var i=F(t.eb,t);n||(n=new Ze("//www.google.com/images/cleardot.gif"),_.location&&"http"==_.location.protocol||tn(n,"https"),un(n)),function(t,e){var n=new de;if(_.Image){var i=new Image;i.onload=q(Gn,n,i,"TestLoadImage: loaded",!0,e),i.onerror=q(Gn,n,i,"TestLoadImage: error",!1,e),i.onabort=q(Gn,n,i,"TestLoadImage: abort",!1,e),i.ontimeout=q(Gn,n,i,"TestLoadImage: timeout",!1,e),_.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=t}else e(!1)}(n.toString(),i)}else we();t.u=0,t.c&&t.c.ta(e),vi(t),ri(t)}function vi(t){t.u=0,t.m=-1,t.c&&(0==Mn(t.b).length&&0==t.f.length||(t.b.c.length=0,Q(t.f),t.f.length=0),t.c.sa())}function gi(t,e,n){var i,r,o,s,u,a,h=(i=n)instanceof Ze?Je(i):new Ze(i,void 0);if(""!=h.b)e&&en(h,e+"."+h.b),nn(h,h.i);else{var c,f=_.location;c=e?e+"."+f.hostname:f.hostname,r=f.protocol,o=c,s=+f.port,u=n,a=new Ze(null,void 0),r&&tn(a,r),o&&en(a,o),s&&nn(a,s),u&&(a.a=u),h=a}return t.V&&et(t.V,function(t,e){on(h,e,t)}),e=t.j,n=t.I,e&&n&&on(h,e,n),on(h,"VER",t.wa),ai(t,h),h}function mi(){}function wi(){if(ht&&!(10<=Number(mt)))throw Error("Environmental error: no available transport.")}function bi(t,e){Yt.call(this),this.a=new ni(e),this.g=t,this.m=e&&e.fb?e.fb:function(t){for(var e=t,n=1;n<arguments.length;n++){var i,r=arguments[n];0==r.lastIndexOf("/",0)?e=r:((i=""==e)||(i=0<=(i=e.length-1)&&e.indexOf("/",i)==i),e+=i?r:"/"+r)}return e}(this.g,"test"),this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.i=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.xa&&(t?t["X-WebChannel-Client-Profile"]=e.xa:t={"X-WebChannel-Client-Profile":e.xa}),this.a.J=t,(t=e&&e.httpHeadersOverwriteParam)&&!W(t)&&(this.a.g=t),this.l=e&&e.supportsCrossDomainXhr||!1,this.h=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!W(e)&&(this.a.j=e,null!==(t=this.b)&&e in t&&e in(t=this.b)&&delete t[e]),this.f=new Ii(this)}function Ei(t){ke.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function Ai(){Oe.call(this),this.status=1}function Ii(t){this.a=t}(I=Bn.prototype).ca=function(t,e,n,i){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.A+"; newUri="+t);e=e?e.toUpperCase():"GET",this.A=t,this.f="",this.h=0,this.v=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?Te(this.H):Te(Se),this.a.onreadystatechange=F(this.Ea,this);try{this.w=!0,this.a.open(e,String(t),!0),this.w=!1}catch(t){return void Wn(this,t)}t=n||"";var r,o=new Qe(this.headers);i&&Ye(i,function(t,e){o.set(e,t)}),i=function(t){t:{for(var e=Qn,n=t.length,i=S(t)?t.split(""):t,r=0;r<n;r++)if(r in i&&e.call(void 0,i[r],r,t)){e=r;break t}e=-1}return e<0?null:S(t)?t.charAt(e):t[e]}(o.K()),n=_.FormData&&t instanceof _.FormData,0<=z(Yn,e)&&!i&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Zn(this),0<this.o&&((this.D=(r=this.a,ht&&bt(9)&&R(r.timeout)&&void 0!==r.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=F(this.Ba,this)):this.m=ue(this.Ba,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){Wn(this,t)}},I.Ba=function(){void 0!==T&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},I.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),$n(this))},I.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),$n(this,!0)),Bn.N.G.call(this)},I.Ea=function(){this.j||(this.w||this.l||this.g?Kn(this):this.Za())},I.Za=function(){Kn(this)},I.T=function(){try{return 2<Jn(this)?this.a.status:-1}catch(t){return-1}},I.aa=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},I.Ua=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),jn(e)}},I.ya=function(){return this.h},I.Xa=function(){return S(this.f)?this.f:String(this.f)},(I=ni.prototype).wa=8,I.u=1,I.Ca=function(){return 0==this.u},I.Ha=function(t){if(this.h)if(this.h=null,1==this.u){if(!t){this.P=Math.floor(1e5*Math.random()),t=this.P++;var e,n=new De(this,t,void 0),i=this.i;if(this.J&&(i?rt(i=nt(i),this.J):i=this.J),null===this.g&&(n.h=i),this.W)t:{for(var r=e=0;r<this.f.length;r++){var o=this.f[r];if(void 0===(o="__data__"in o.a&&S(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=r;break t}if(4096===e||r===this.f.length-1){e=r+1;break t}}e=1e3}else e=1e3;e=hi(this,n,e),on(r=Je(this.B),"RID",t),on(r,"CVER",22),this.o&&this.j&&on(r,"X-HTTP-Session-Id",this.j),ai(this,r),this.g&&i&&ei(r,this.g,i),Pn(this.b,n),this.W?(on(r,"$req",e),on(r,"SID","null"),n.S=!0,Ue(n,r,null)):Ue(n,r,e),this.u=2}}else 3==this.u&&(t?ui(this,t):0==this.f.length||Dn(this.b)||ui(this))},I.Ga=function(){this.l=null,this.a=new De(this,"rpc",this.S),null===this.g&&(this.a.h=this.i),this.a.J=0;var t=Je(this.pa);on(t,"RID","rpc"),on(t,"SID",this.H),on(t,"CI",this.ia?"0":"1"),on(t,"AID",this.O),ai(this,t),on(t,"TYPE","xmlhttp"),this.g&&this.i&&ei(t,this.g,this.i),this.D&&this.a.setTimeout(this.D),Me(this.a,t,!0,this.ga)},I.Fa=function(t,e){if(0!=this.u&&(this.a==t||Cn(this.b,t)))if(this.m=t.o,!t.s&&Cn(this.b,t)&&3==this.u){try{var n=this.ja.a.parse(e)}catch(t){n=null}if(D(n)&&3==n.length){if(0==(e=n)[0]){t:if(!this.l){if(this.a){if(!(this.a.v+3e3<t.v))break t;pi(this),this.a.cancel(),this.a=null}fi(this),we()}}else this.ra=e[1],0<this.ra-this.O&&e[2]<37500&&this.ia&&0==this.v&&!this.s&&(this.s=Ee(F(this.Ya,this),6e3));if(Vn(this.b)<=1&&this.fa){try{this.fa()}catch(t){}this.fa=void 0}}else yi(this,11)}else if(!t.s&&this.a!=t||pi(this),!W(e))for(e=n=this.ja.a.parse(e),n=0;n<e.length;n++){var i=e[n];if(this.O=i[0],i=i[1],2==this.u)if("c"==i[0]){this.H=i[1],this.ga=i[2];var r=i[3];null!=r&&(this.wa=r),null!=(i=i[5])&&R(i)&&0<i&&(this.D=1.5*i),this.o&&(i=t.a)&&((r=ti(i,"X-Client-Wire-Protocol"))&&Ln(this.b,r),this.j&&(i=ti(i,"X-HTTP-Session-Id")))&&(this.I=i,on(this.B,this.j,i)),this.u=3,this.c&&this.c.va(),i=t,this.pa=gi(this,this.Y()?this.ga:null,this.ha),i.s?(Un(this.b,i),(r=this.D)&&i.setTimeout(r),i.i&&(je(i),qe(i)),this.a=i):ci(this),0<this.f.length&&si(this)}else"stop"!=i[0]&&"close"!=i[0]||yi(this,7);else 3==this.u&&("stop"==i[0]||"close"==i[0]?"stop"==i[0]?yi(this,7):ii(this):"noop"!=i[0]&&this.c&&this.c.ua(i),this.v=0)}},I.Ya=function(){null!=this.s&&(this.s=null,this.a.cancel(),this.a=null,fi(this),we())},I.na=function(t){var e=null;if(this.a==t){pi(this),this.a=null;var n=2}else{if(!Cn(this.b,t))return;e=t.j,Un(this.b,t),n=1}if(this.m=t.o,0!=this.u)if(t.b)1==n?(e=G()-t.v,ye.dispatchEvent(new be(ye,t.l&&t.l.length,this.A)),si(this)):ci(this);else{var i=t.c;if(3==i||0==i&&0<this.m||!(1==n&&function(t,e){if(!(Vn(t.b)>=t.b.f-(t.h?1:0))){if(t.h)return t.f=e.j.concat(t.f),1;if(!(1==t.u||2==t.u||t.A>=(t.Oa?0:t.Pa)))return t.h=Ee(F(t.Ha,t,e),di(t,t.A)),t.A++,1}}(this,t)||2==n&&fi(this)))switch(e&&0<e.length&&(t=this.b,t.c=t.c.concat(e)),i){case 1:yi(this,5);break;case 4:yi(this,10);break;case 3:yi(this,6);break;default:yi(this,2)}}},I.eb=function(t){we()},I.$=function(t){if(t&&!this.R)throw Error("Can't create secondary domain capable XhrIo object.");return(t=new Bn(this.Ka)).F=this.R,t},I.ma=function(){return!!this.c&&!0},I.Y=function(){return this.R},(I=mi.prototype).va=function(){},I.ua=function(){},I.ta=function(){},I.sa=function(){},I.Sa=function(){},wi.prototype.a=function(t,e){return new bi(t,e)},j(bi,Yt),(I=bi.prototype).addEventListener=function(t,e,n,i){bi.N.addEventListener.call(this,t,e,n,i)},I.removeEventListener=function(t,e,n,i){bi.N.removeEventListener.call(this,t,e,n,i)},I.Va=function(){this.a.c=this.f,this.l&&(this.a.R=!0);var t=this.a,e=this.m,n=this.g,i=this.b||void 0;we(),t.ha=n,t.V=i||{},t.o&&(t.F.b=[],t.F.a=!1),t.w=new In(t),null===t.g&&(t.w.h=t.i),n=e,t.g&&t.i&&(n=ei(e,t.g,t.i)),(t=t.w).i=n,e=gi(t.a,null,t.i),we(),null!=(n=t.a.F.b)?(t.f=n[0],t.M=1,Nn(t)):(sn(e,"MODE","init"),!t.a.o&&t.a.j&&sn(e,"X-HTTP-Session-Id",t.a.j),t.b=new De(t,void 0,void 0),t.b.h=t.h,Me(t.b,e,!1,null),t.M=0)},I.close=function(){ii(this.a)},I.Wa=function(t){if(S(t)){var e={};e.__data__=t,oi(this.a,e)}else this.h?((e={}).__data__=Wt(t),oi(this.a,e)):oi(this.a,t)},I.G=function(){this.a.c=null,delete this.f,ii(this.a),delete this.a,bi.N.G.call(this)},j(Ei,ke),j(Ai,Oe),j(Ii,mi),Ii.prototype.va=function(){this.a.dispatchEvent("a")},Ii.prototype.ua=function(t){this.a.dispatchEvent(new Ei(t))},Ii.prototype.ta=function(t){this.a.dispatchEvent(new Ai)},Ii.prototype.sa=function(){this.a.dispatchEvent("b")};var Ni=q(function(t,e){function n(){}n.prototype=t.prototype;var i=new n;return t.apply(i,Array.prototype.slice.call(arguments,1)),i},wi);wi.prototype.createWebChannel=wi.prototype.a,bi.prototype.send=bi.prototype.Wa,bi.prototype.open=bi.prototype.Va,bi.prototype.close=bi.prototype.close,Ae.NO_ERROR=0,Ae.TIMEOUT=8,Ae.HTTP_ERROR=6,Ie.COMPLETE="complete",(_e.EventType=Re).OPEN="a",Re.CLOSE="b",Re.ERROR="c",Re.MESSAGE="d",Yt.prototype.listen=Yt.prototype.za,Bn.prototype.listenOnce=Bn.prototype.Aa,Bn.prototype.getLastError=Bn.prototype.Xa,Bn.prototype.getLastErrorCode=Bn.prototype.ya,Bn.prototype.getStatus=Bn.prototype.T,Bn.prototype.getResponseJson=Bn.prototype.Ua,Bn.prototype.getResponseText=Bn.prototype.aa,Bn.prototype.send=Bn.prototype.ca;var Ti={createWebChannelTransport:Ni,ErrorCode:Ae,EventType:Ie,WebChannel:_e,XhrIo:Bn},_i=Ti.createWebChannelTransport,Si=Ti.ErrorCode,Ri=Ti.EventType,ki=Ti.WebChannel,Oi=Ti.XhrIo,Li=If.SDK_VERSION,Di=(Vi.prototype.t=function(){return null!=this.uid},Vi.prototype.s=function(){return this.t()?"uid:"+this.uid:"anonymous-user"},Vi.prototype.isEqual=function(t){return t.uid===this.uid},Vi);function Vi(t){this.uid=t}function Ci(t,e){this.user=e,this.type="OAuth",this.o={},this.o.Authorization="Bearer "+t}Di.UNAUTHENTICATED=new Di(null),Di.i=new Di("google-credentials-uid"),Di.h=new Di("first-party-uid");var Pi,Ui={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Mi=(n(Ki,Pi=Error),Ki),xi=(Xi.prototype.getToken=function(){return Promise.resolve(null)},Xi.prototype.l=function(){},Xi.prototype._=function(t){(this.u=t)(Di.UNAUTHENTICATED)},Xi.prototype.T=function(){this.u=null},Xi),Fi=(Wi.prototype.getToken=function(){var e=this,n=this.R,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){if(e.R!==n)throw new Mi(Ui.ABORTED,"getToken aborted due to token change.");return t?(vu("string"==typeof t.accessToken),new Ci(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},Wi.prototype.l=function(){this.forceRefresh=!0},Wi.prototype._=function(t){this.u=t,this.m&&t(this.currentUser)},Wi.prototype.T=function(){this.auth&&this.auth.removeAuthTokenListener(this.I),this.I=null,this.u=null},Wi.prototype.A=function(){var t=this.auth&&this.auth.getUid();return vu(null===t||"string"==typeof t),new Di(t)},Wi),qi=(Object.defineProperty(Qi.prototype,"o",{get:function(){var t={"X-Goog-AuthUser":this.V},e=this.P.auth.p([]);return e&&(t.Authorization=e),t},enumerable:!0,configurable:!0}),Qi),Gi=(Yi.prototype.getToken=function(){return Promise.resolve(new qi(this.P,this.V))},Yi.prototype._=function(t){t(Di.h)},Yi.prototype.T=function(){},Yi.prototype.l=function(){},Yi),ji=(Hi.now=function(){return Hi.fromMillis(Date.now())},Hi.fromDate=function(t){return Hi.fromMillis(t.getTime())},Hi.fromMillis=function(t){var e=Math.floor(t/1e3);return new Hi(e,1e6*(t-1e3*e))},Hi.prototype.toDate=function(){return new Date(this.toMillis())},Hi.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},Hi.prototype.g=function(t){return this.seconds===t.seconds?wu(this.nanoseconds,t.nanoseconds):wu(this.seconds,t.seconds)},Hi.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},Hi.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},Hi.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},Hi),Bi=(zi.v=function(t){return new zi(t)},zi.S=function(){return zi.MIN},zi.prototype.D=function(t){return this.timestamp.g(t.timestamp)},zi.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},zi.prototype.C=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},zi.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},zi.prototype.F=function(){return this.timestamp},zi);function zi(t){this.timestamp=t}function Hi(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new Mi(Ui.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new Mi(Ui.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Mi(Ui.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new Mi(Ui.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function Yi(t,e){this.P=t,this.V=e}function Qi(t,e){this.P=t,this.V=e,this.type="FirstParty",this.user=Di.h}function Wi(t){var e=this;this.I=null,this.currentUser=Di.UNAUTHENTICATED,this.m=!1,this.R=0,this.u=null,this.forceRefresh=!1,this.I=function(){e.R++,e.currentUser=e.A(),e.m=!0,e.u&&e.u(e.currentUser)},this.R=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.I):(this.I(null),t.get().then(function(t){e.auth=t,e.I&&e.auth.addAuthTokenListener(e.I)},function(){}))}function Xi(){this.u=null}function Ki(t,e){var n=this;return(n=Pi.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}Bi.MIN=new Bi(new ji(0,0));var $i,Zi=(Object.defineProperty(er.prototype,"length",{get:function(){return this.N},enumerable:!0,configurable:!0}),er.prototype.isEqual=function(t){return 0===er.$(this,t)},er.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof er?t.forEach(function(t){e.push(t)}):e.push(t),this.k(e)},er.prototype.limit=function(){return this.offset+this.length},er.prototype.L=function(t){return t=void 0===t?1:t,this.k(this.segments,this.offset+t,this.length-t)},er.prototype.O=function(){return this.k(this.segments,this.offset,this.length-1)},er.prototype.M=function(){return this.segments[this.offset]},er.prototype.q=function(){return this.get(this.length-1)},er.prototype.get=function(t){return this.segments[this.offset+t]},er.prototype.B=function(){return 0===this.length},er.prototype.U=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},er.prototype.W=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},er.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},er.prototype.j=function(){return this.segments.slice(this.offset,this.limit())},er.$=function(t,e){for(var n=Math.min(t.length,e.length),i=0;i<n;i++){var r=t.get(i),o=e.get(i);if(r<o)return-1;if(o<r)return 1}return t.length<e.length?-1:t.length>e.length?1:0},er),Ji=(n(tr,$i=Zi),tr.prototype.k=function(t,e,n){return new tr(t,e,n)},tr.prototype.G=function(){return this.j().join("/")},tr.prototype.toString=function(){return this.G()},tr.K=function(t){if(0<=t.indexOf("//"))throw new Mi(Ui.INVALID_ARGUMENT,"Invalid path ("+t+"). Paths must not contain // in them.");return new tr(t.split("/").filter(function(t){return 0<t.length}))},tr);function tr(){return null!==$i&&$i.apply(this,arguments)||this}function er(t,e,n){void 0===e?e=0:e>t.length&&yu(),void 0===n?n=t.length-e:n>t.length-e&&yu(),this.segments=t,this.offset=e,this.N=n}Ji.H=new Ji([]);var nr,ir=/^[_a-zA-Z][_a-zA-Z0-9]*$/,rr=(n(or,nr=Zi),or.prototype.k=function(t,e,n){return new or(t,e,n)},or.Y=function(t){return ir.test(t)},or.prototype.G=function(){return this.j().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),or.Y(t)||(t="`"+t+"`"),t}).join(".")},or.prototype.toString=function(){return this.G()},or.prototype.X=function(){return 1===this.length&&"__name__"===this.get(0)},or.J=function(){return new or(["__name__"])},or.Z=function(t){for(var e=[],n="",i=0,r=function(){if(0===n.length)throw new Mi(Ui.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;i<t.length;){var s=t[i];if("\\"===s){if(i+1===t.length)throw new Mi(Ui.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[i+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Mi(Ui.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,i+=2}else"`"===s?o=!o:"."!==s||o?n+=s:r(),i++}if(r(),o)throw new Mi(Ui.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new or(e)},or);function or(){return null!==nr&&nr.apply(this,arguments)||this}rr.H=new rr([]);var sr=(ur.tt=function(t){return new ur(Ji.K(t).L(5))},ur.prototype.et=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},ur.prototype.isEqual=function(t){return null!==t&&0===Ji.$(this.path,t.path)},ur.prototype.toString=function(){return this.path.toString()},ur.$=function(t,e){return Ji.$(t.path,e.path)},ur.st=function(t){return t.length%2==0},ur.it=function(t){return new ur(new Ji(t.slice()))},ur);function ur(t){this.path=t}sr.EMPTY=new sr(new Ji([]));var ar=(pr.prototype.nt=function(t,e){return new pr(this.$,this.root.nt(t,e,this.$).rt(null,null,cr.ht,null,null))},pr.prototype.remove=function(t){return new pr(this.$,this.root.remove(t,this.$).rt(null,null,cr.ht,null,null))},pr.prototype.get=function(t){for(var e=this.root;!e.B();){var n=this.$(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},pr.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.B();){var i=this.$(t,n.key);if(0===i)return e+n.left.size;n=i<0?n.left:(e+=n.left.size+1,n.right)}return-1},pr.prototype.B=function(){return this.root.B()},Object.defineProperty(pr.prototype,"size",{get:function(){return this.root.size},enumerable:!0,configurable:!0}),pr.prototype.ot=function(){return this.root.ot()},pr.prototype.at=function(){return this.root.at()},pr.prototype.ut=function(t){return this.root.ut(t)},pr.prototype.forEach=function(n){this.ut(function(t,e){return n(t,e),!1})},pr.prototype.toString=function(){var n=[];return this.ut(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},pr.prototype.ct=function(t){return this.root.ct(t)},pr.prototype.lt=function(){return new hr(this.root,null,this.$,!1)},pr.prototype._t=function(t){return new hr(this.root,t,this.$,!1)},pr.prototype.ft=function(){return new hr(this.root,null,this.$,!0)},pr.prototype.dt=function(t){return new hr(this.root,t,this.$,!0)},pr),hr=(lr.prototype.Et=function(){var t=this.Tt.pop(),e={key:t.key,value:t.value};if(this.wt)for(t=t.left;!t.B();)this.Tt.push(t),t=t.right;else for(t=t.right;!t.B();)this.Tt.push(t),t=t.left;return e},lr.prototype.It=function(){return 0<this.Tt.length},lr.prototype.Rt=function(){if(0===this.Tt.length)return null;var t=this.Tt[this.Tt.length-1];return{key:t.key,value:t.value}},lr),cr=(fr.prototype.rt=function(t,e,n,i,r){return new fr(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=i?i:this.left,null!=r?r:this.right)},fr.prototype.B=function(){return!1},fr.prototype.ut=function(t){return this.left.ut(t)||t(this.key,this.value)||this.right.ut(t)},fr.prototype.ct=function(t){return this.right.ct(t)||t(this.key,this.value)||this.left.ct(t)},fr.prototype.min=function(){return this.left.B()?this:this.left.min()},fr.prototype.ot=function(){return this.min().key},fr.prototype.at=function(){return this.right.B()?this.key:this.right.at()},fr.prototype.nt=function(t,e,n){var i=this,r=n(t,i.key);return(i=r<0?i.rt(null,null,null,i.left.nt(t,e,n),null):0===r?i.rt(null,e,null,null,null):i.rt(null,null,null,null,i.right.nt(t,e,n))).At()},fr.prototype.Pt=function(){if(this.left.B())return fr.EMPTY;var t=this;return t.left.Vt()||t.left.left.Vt()||(t=t.pt()),(t=t.rt(null,null,null,t.left.Pt(),null)).At()},fr.prototype.remove=function(t,e){var n,i=this;if(e(t,i.key)<0)i.left.B()||i.left.Vt()||i.left.left.Vt()||(i=i.pt()),i=i.rt(null,null,null,i.left.remove(t,e),null);else{if(i.left.Vt()&&(i=i.gt()),i.right.B()||i.right.Vt()||i.right.left.Vt()||(i=i.yt()),0===e(t,i.key)){if(i.right.B())return fr.EMPTY;n=i.right.min(),i=i.rt(n.key,n.value,null,null,i.right.Pt())}i=i.rt(null,null,null,null,i.right.remove(t,e))}return i.At()},fr.prototype.Vt=function(){return this.color},fr.prototype.At=function(){var t=this;return t.right.Vt()&&!t.left.Vt()&&(t=t.bt()),t.left.Vt()&&t.left.left.Vt()&&(t=t.gt()),t.left.Vt()&&t.right.Vt()&&(t=t.vt()),t},fr.prototype.pt=function(){var t=this.vt();return t.right.left.Vt()&&(t=(t=(t=t.rt(null,null,null,null,t.right.gt())).bt()).vt()),t},fr.prototype.yt=function(){var t=this.vt();return t.left.left.Vt()&&(t=(t=t.gt()).vt()),t},fr.prototype.bt=function(){var t=this.rt(null,null,fr.RED,null,this.right.left);return this.right.rt(null,null,this.color,t,null)},fr.prototype.gt=function(){var t=this.rt(null,null,fr.RED,this.left.right,null);return this.left.rt(null,null,this.color,null,t)},fr.prototype.vt=function(){var t=this.left.rt(null,null,!this.left.color,null,null),e=this.right.rt(null,null,!this.right.color,null,null);return this.rt(null,null,!this.color,t,e)},fr.prototype.St=function(){var t=this.Dt();return Math.pow(2,t)<=this.size+1},fr.prototype.Dt=function(){if(this.Vt()&&this.left.Vt())throw yu();if(this.right.Vt())throw yu();var t=this.left.Dt();if(t!==this.right.Dt())throw yu();return t+(this.Vt()?0:1)},fr);function fr(t,e,n,i,r){this.key=t,this.value=e,this.color=null!=n?n:fr.RED,this.left=null!=i?i:fr.EMPTY,this.right=null!=r?r:fr.EMPTY,this.size=this.left.size+1+this.right.size}function lr(t,e,n,i){this.wt=i,this.Tt=[];for(var r=1;!t.B();)if(r=e?n(t.key,e):1,i&&(r*=-1),r<0)t=this.wt?t.left:t.right;else{if(0===r){this.Tt.push(t);break}this.Tt.push(t),t=this.wt?t.right:t.left}}function pr(t,e){this.$=t,this.root=e||cr.EMPTY}function dr(){this.size=0}cr.EMPTY=null,cr.RED=!0,cr.ht=!1,cr.EMPTY=(Object.defineProperty(dr.prototype,"key",{get:function(){throw yu()},enumerable:!0,configurable:!0}),Object.defineProperty(dr.prototype,"value",{get:function(){throw yu()},enumerable:!0,configurable:!0}),Object.defineProperty(dr.prototype,"color",{get:function(){throw yu()},enumerable:!0,configurable:!0}),Object.defineProperty(dr.prototype,"left",{get:function(){throw yu()},enumerable:!0,configurable:!0}),Object.defineProperty(dr.prototype,"right",{get:function(){throw yu()},enumerable:!0,configurable:!0}),dr.prototype.rt=function(t,e,n,i,r){return this},dr.prototype.nt=function(t,e,n){return new cr(t,e)},dr.prototype.remove=function(t,e){return this},dr.prototype.B=function(){return!0},dr.prototype.ut=function(t){return!1},dr.prototype.ct=function(t){return!1},dr.prototype.ot=function(){return null},dr.prototype.at=function(){return null},dr.prototype.Vt=function(){return!1},dr.prototype.St=function(){return!0},dr.prototype.Dt=function(){return 0},new dr);var yr=(mr.prototype.has=function(t){return null!==this.data.get(t)},mr.prototype.first=function(){return this.data.ot()},mr.prototype.last=function(){return this.data.at()},Object.defineProperty(mr.prototype,"size",{get:function(){return this.data.size},enumerable:!0,configurable:!0}),mr.prototype.indexOf=function(t){return this.data.indexOf(t)},mr.prototype.forEach=function(n){this.data.ut(function(t,e){return n(t),!1})},mr.prototype.Ct=function(t,e){for(var n=this.data._t(t[0]);n.It();){var i=n.Et();if(0<=this.$(i.key,t[1]))return;e(i.key)}},mr.prototype.Ft=function(t,e){var n;for(n=void 0!==e?this.data._t(e):this.data.lt();n.It();)if(!t(n.Et().key))return},mr.prototype.Nt=function(t){var e=this.data._t(t);return e.It()?e.Et().key:null},mr.prototype.lt=function(){return new vr(this.data.lt())},mr.prototype._t=function(t){return new vr(this.data._t(t))},mr.prototype.add=function(t){return this.rt(this.data.remove(t).nt(t,!0))},mr.prototype.delete=function(t){return this.has(t)?this.rt(this.data.remove(t)):this},mr.prototype.B=function(){return this.data.B()},mr.prototype.$t=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},mr.prototype.isEqual=function(t){if(!(t instanceof mr))return!1;if(this.size!==t.size)return!1;for(var e=this.data.lt(),n=t.data.lt();e.It();){var i=e.Et().key,r=n.Et().key;if(0!==this.$(i,r))return!1}return!0},mr.prototype.j=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},mr.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},mr.prototype.rt=function(t){var e=new mr(this.$);return e.data=t,e},mr),vr=(gr.prototype.Et=function(){return this.kt.Et().key},gr.prototype.It=function(){return this.kt.It()},gr);function gr(t){this.kt=t}function mr(t){this.$=t,this.data=new ar(this.$)}function wr(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function br(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Er(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Ar=(Ir.fromBase64String=function(t){return new Ir(uu.Ot().atob(t))},Ir.fromUint8Array=function(t){return new Ir(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},Ir.prototype.toBase64=function(){return uu.Ot().btoa(this.Lt)},Ir.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.Lt)},Ir.prototype.Mt=function(){return 2*this.Lt.length},Ir.prototype.D=function(t){return wu(this.Lt,t.Lt)},Ir.prototype.isEqual=function(t){return this.Lt===t.Lt},Ir);function Ir(t){this.Lt=t}function Nr(t){return null==t}function Tr(t){return-0===t&&1/t==-1/0}function _r(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function Sr(t){var e=Pr(t.mapValue.fields.__local_write_time__.timestampValue);return new ji(e.seconds,e.nanos)}Ar.qt=new Ar("");var Rr=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function kr(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?_r(t)?4:10:yu()}function Or(r,t){var e,n,i,o=kr(r);if(o!==kr(t))return!1;switch(o){case 0:return!0;case 1:return r.booleanValue===t.booleanValue;case 4:return Sr(r).isEqual(Sr(t));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=Pr(r.timestampValue),n=Pr(t.timestampValue);return e.seconds===n.seconds&&e.nanos===n.nanos}(t);case 5:return r.stringValue===t.stringValue;case 6:return i=t,Mr(r.bytesValue).isEqual(Mr(i.bytesValue));case 7:return r.referenceValue===t.referenceValue;case 8:return n=t,Ur((e=r).geoPointValue.latitude)===Ur(n.geoPointValue.latitude)&&Ur(e.geoPointValue.longitude)===Ur(n.geoPointValue.longitude);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return Ur(t.integerValue)===Ur(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=Ur(t.doubleValue),i=Ur(e.doubleValue);return n===i?Tr(n)===Tr(i):isNaN(n)&&isNaN(i)}return!1}(r,t);case 9:return bu(r.arrayValue.values||[],t.arrayValue.values||[],Or);case 10:return function(t){var e=r.mapValue.fields||{},n=t.mapValue.fields||{};if(wr(e)!==wr(n))return!1;for(var i in e)if(e.hasOwnProperty(i)&&(void 0===n[i]||!Or(e[i],n[i])))return!1;return!0}(t);default:return yu()}}function Lr(t,e){return void 0!==(t.values||[]).find(function(t){return Or(t,e)})}function Dr(t,e){var n,i,r,o,s,u,a,h,c,f,l=kr(t),p=kr(e);if(l!==p)return wu(l,p);switch(l){case 0:return 0;case 1:return wu(t.booleanValue,e.booleanValue);case 2:return h=e,(c=Ur(t.integerValue||t.doubleValue))<(f=Ur(h.integerValue||h.doubleValue))?-1:f<c?1:c===f?0:isNaN(c)?isNaN(f)?0:-1:1;case 3:return Vr(t.timestampValue,e.timestampValue);case 4:return Vr(Sr(t),Sr(e));case 5:return wu(t.stringValue,e.stringValue);case 6:return o=t.bytesValue,s=e.bytesValue,u=Mr(o),a=Mr(s),u.D(a);case 7:return function(t,e){for(var n=t.split("/"),i=e.split("/"),r=0;r<n.length&&r<i.length;r++){var o=wu(n[r],i[r]);if(0!==o)return o}return wu(n.length,i.length)}(t.referenceValue,e.referenceValue);case 8:return n=t.geoPointValue,i=e.geoPointValue,0!==(r=wu(Ur(n.latitude),Ur(i.latitude)))?r:wu(Ur(n.longitude),Ur(i.longitude));case 9:return function(t,e){for(var n=t.values||[],i=e.values||[],r=0;r<n.length&&r<i.length;++r){var o=Dr(n[r],i[r]);if(o)return o}return wu(n.length,i.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},i=Object.keys(n),r=e.fields||{},o=Object.keys(r);i.sort(),o.sort();for(var s=0;s<i.length&&s<o.length;++s){var u=wu(i[s],o[s]);if(0!==u)return u;var a=Dr(n[i[s]],r[o[s]]);if(0!==a)return a}return wu(i.length,o.length)}(t.mapValue,e.mapValue);default:throw yu()}}function Vr(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return wu(t,e);var n=Pr(t),i=Pr(e),r=wu(n.seconds,i.seconds);return 0!==r?r:wu(n.nanos,i.nanos)}function Cr(t){return function s(r){return"nullValue"in r?"null":"booleanValue"in r?""+r.booleanValue:"integerValue"in r?""+r.integerValue:"doubleValue"in r?""+r.doubleValue:"timestampValue"in r?"time("+(t=Pr(r.timestampValue)).seconds+","+t.nanos+")":"stringValue"in r?r.stringValue:"bytesValue"in r?Mr(r.bytesValue).toBase64():"referenceValue"in r?(n=r.referenceValue,sr.tt(n).toString()):"geoPointValue"in r?"geo("+(e=r.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in r?function(){for(var t="[",e=!0,n=0,i=r.arrayValue.values||[];n<i.length;n++)e?e=!1:t+=",",t+=s(i[n]);return t+"]"}():"mapValue"in r?function(t){for(var e="{",n=!0,i=0,r=Object.keys(t.fields||{}).sort();i<r.length;i++){var o=r[i];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(r.mapValue):yu();var t,e,n}(t)}function Pr(t){if(vu(!!t),"string"!=typeof t)return{seconds:Ur(t.seconds),nanos:Ur(t.nanos)};var e=0,n=Rr.exec(t);if(vu(!!n),n[1]){var i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}var r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}function Ur(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Mr(t){return"string"==typeof t?Ar.fromBase64String(t):Ar.fromUint8Array(t)}function xr(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.G()}}function Fr(t){return t&&"integerValue"in t}function qr(t){return!!t&&"arrayValue"in t}function Gr(t){return t&&"nullValue"in t}function jr(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Br(t){return t&&"mapValue"in t}var zr=(Hr.prototype.Bt=function(t,e){return n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}},t&&(n.fields.__previous_value__=t),{mapValue:n};var n},Hr.prototype.xt=function(t,e){return e},Hr.prototype.Ut=function(t){return null},Hr.prototype.isEqual=function(t){return t instanceof Hr},Hr);function Hr(){}zr.instance=new zr;var Yr=($r.prototype.Bt=function(t,e){return this.apply(t)},$r.prototype.xt=function(t,e){return this.apply(t)},$r.prototype.apply=function(t){for(var n=Zr(t),e=function(e){n.some(function(t){return Or(t,e)})||n.push(e)},i=0,r=this.elements;i<r.length;i++)e(r[i]);return{arrayValue:{values:n}}},$r.prototype.Ut=function(t){return null},$r.prototype.isEqual=function(t){return t instanceof $r&&bu(this.elements,t.elements,Or)},$r),Qr=(Kr.prototype.Bt=function(t,e){return this.apply(t)},Kr.prototype.xt=function(t,e){return this.apply(t)},Kr.prototype.apply=function(t){for(var n=Zr(t),e=function(e){n=n.filter(function(t){return!Or(t,e)})},i=0,r=this.elements;i<r.length;i++)e(r[i]);return{arrayValue:{values:n}}},Kr.prototype.Ut=function(t){return null},Kr.prototype.isEqual=function(t){return t instanceof Kr&&bu(this.elements,t.elements,Or)},Kr),Wr=(Xr.prototype.Bt=function(t,e){var n=this.Ut(t),i=this.asNumber(n)+this.asNumber(this.Qt);return Fr(n)&&Fr(this.Qt)?this.serializer.Wt(i):this.serializer.jt(i)},Xr.prototype.xt=function(t,e){return e},Xr.prototype.Ut=function(t){return Fr(e=t)||e&&"doubleValue"in e?t:{integerValue:0};var e},Xr.prototype.isEqual=function(t){return t instanceof Xr&&Or(this.Qt,t.Qt)},Xr.prototype.asNumber=function(t){return Ur(t.integerValue||t.doubleValue)},Xr);function Xr(t,e){this.serializer=t,this.Qt=e}function Kr(t){this.elements=t}function $r(t){this.elements=t}function Zr(t){return qr(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function Jr(t,e){this.version=t,this.transformResults=e}var to=(oo.Gt=function(t){return new oo(t)},oo.Kt=function(t){var e=new yr(rr.$);return t.forEach(function(t){return e=e.add(t)}),new oo(e)},oo.prototype.Ht=function(e){var n=!1;return this.fields.forEach(function(t){t.U(e)&&(n=!0)}),n},oo.prototype.isEqual=function(t){return this.fields.isEqual(t.fields)},oo),eo=(ro.prototype.isEqual=function(t){return this.field.isEqual(t.field)&&this.transform.isEqual(t.transform)},ro),no=(io.exists=function(t){return new io(void 0,t)},io.updateTime=function(t){return new io(t)},Object.defineProperty(io.prototype,"zt",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!0,configurable:!0}),io.prototype.Yt=function(t){return void 0!==this.updateTime?t instanceof Lo&&t.version.isEqual(this.updateTime):void 0===this.exists||this.exists===t instanceof Lo},io.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},io);function io(t,e){this.updateTime=t,this.exists=e}function ro(t,e){this.field=t,this.transform=e}function oo(t){this.fields=t}no.NONE=new no;var so,uo,ao,ho,co,fo=(To.prototype.Xt=function(t){},To.Jt=function(t){return t instanceof Lo?t.version:Bi.MIN},To),lo=(n(No,co=fo),No.prototype.xt=function(t,e){this.Xt(t);var n=e.version;return new Lo(this.key,n,this.value,{hasCommittedMutations:!0})},No.prototype.Bt=function(t,e,n){if(this.Xt(t),!this.Zt.Yt(t))return t;var i=fo.Jt(t);return new Lo(this.key,i,this.value,{te:!0})},No.prototype.ee=function(t){return null},No.prototype.isEqual=function(t){return t instanceof No&&this.key.isEqual(t.key)&&this.value.isEqual(t.value)&&this.Zt.isEqual(t.Zt)},No),po=(n(Io,ho=fo),Io.prototype.xt=function(t,e){if(this.Xt(t),!this.Zt.Yt(t))return new Vo(this.key,e.version);var n=this.ie(t);return new Lo(this.key,e.version,n,{hasCommittedMutations:!0})},Io.prototype.Bt=function(t,e,n){if(this.Xt(t),!this.Zt.Yt(t))return t;var i=fo.Jt(t),r=this.ie(t);return new Lo(this.key,i,r,{te:!0})},Io.prototype.ee=function(t){return null},Io.prototype.isEqual=function(t){return t instanceof Io&&this.key.isEqual(t.key)&&this.se.isEqual(t.se)&&this.Zt.isEqual(t.Zt)},Io.prototype.ie=function(t){var e;return e=t instanceof Lo?t.data():mo.EMPTY,this.ne(e)},Io.prototype.ne=function(t){var n=this,i=t.re();return this.se.fields.forEach(function(t){if(!t.B()){var e=n.data.field(t);null!==e?i.set(t,e):i.delete(t)}}),i.he()},Io),yo=(n(Ao,ao=fo),Ao.prototype.xt=function(t,e){if(this.Xt(t),vu(null!=e.transformResults),!this.Zt.Yt(t))return new Vo(this.key,e.version);var n=this.oe(t),i=this.ae(t,e.transformResults),r=e.version,o=this.ue(n.data(),i);return new Lo(this.key,r,o,{hasCommittedMutations:!0})},Ao.prototype.Bt=function(t,e,n){if(this.Xt(t),!this.Zt.Yt(t))return t;var i=this.oe(t),r=this.ce(n,t,e),o=this.ue(i.data(),r);return new Lo(this.key,i.version,o,{te:!0})},Ao.prototype.ee=function(t){for(var e=null,n=0,i=this.fieldTransforms;n<i.length;n++){var r=i[n],o=t instanceof Lo?t.field(r.field):void 0,s=r.transform.Ut(o||null);null!=s&&(e=null==e?mo.le().set(r.field,s):e.set(r.field,s))}return e?e.he():null},Ao.prototype.isEqual=function(t){return t instanceof Ao&&this.key.isEqual(t.key)&&bu(this.fieldTransforms,t.fieldTransforms,function(t,e){return t.isEqual(e)})&&this.Zt.isEqual(t.Zt)},Ao.prototype.oe=function(t){return t},Ao.prototype.ae=function(t,e){var n=[];vu(this.fieldTransforms.length===e.length);for(var i=0;i<e.length;i++){var r=this.fieldTransforms[i],o=r.transform,s=null;t instanceof Lo&&(s=t.field(r.field)),n.push(o.xt(s,e[i]))}return n},Ao.prototype.ce=function(t,e,n){for(var i=[],r=0,o=this.fieldTransforms;r<o.length;r++){var s=o[r],u=s.transform,a=null;e instanceof Lo&&(a=e.field(s.field)),null===a&&n instanceof Lo&&(a=n.field(s.field)),i.push(u.Bt(a,t))}return i},Ao.prototype.ue=function(t,e){for(var n=t.re(),i=0;i<this.fieldTransforms.length;i++){var r=this.fieldTransforms[i].field;n.set(r,e[i])}return n.he()},Ao),vo=(n(Eo,uo=fo),Eo.prototype.xt=function(t,e){return this.Xt(t),new Do(this.key,e.version,{hasCommittedMutations:!0})},Eo.prototype.Bt=function(t,e,n){return this.Xt(t),this.Zt.Yt(t)?new Do(this.key,Bi.S()):t},Eo.prototype.ee=function(t){return null},Eo.prototype.isEqual=function(t){return t instanceof Eo&&this.key.isEqual(t.key)&&this.Zt.isEqual(t.Zt)},Eo),go=(n(bo,so=fo),bo.prototype.xt=function(t,e){yu()},bo.prototype.Bt=function(t,e,n){yu()},bo.prototype.ee=function(t){yu()},bo.prototype.isEqual=function(t){return t instanceof bo&&this.key.isEqual(t.key)&&this.Zt.isEqual(t.Zt)},bo),mo=(wo.le=function(){return wo.EMPTY.re()},wo.prototype.field=function(t){if(t.B())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!Br(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.q()])||null},wo.prototype.se=function(){return this._e(this.proto.mapValue)},wo.prototype._e=function(t){var r=this,o=new yr(rr.$);return br(t.fields||{},function(t,e){var n=new rr([t]);if(10===kr(e)){var i=r._e(e.mapValue).fields;i.B()?o=o.add(n):i.forEach(function(t){o=o.add(n.child(t))})}else o=o.add(n)}),to.Gt(o)},wo.prototype.isEqual=function(t){return Or(this.proto,t.proto)},wo.prototype.re=function(){return new ko(this)},wo);function wo(t){this.proto=t}function bo(t,e){var n=this;return(n=so.call(this)||this).key=t,n.Zt=e,n.type=4,n}function Eo(t,e){var n=this;return(n=uo.call(this)||this).key=t,n.Zt=e,n.type=3,n}function Ao(t,e){var n=this;return(n=ao.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.Zt=no.exists(!0),n}function Io(t,e,n,i){var r=this;return(r=ho.call(this)||this).key=t,r.data=e,r.se=n,r.Zt=i,r.type=1,r}function No(t,e,n){var i=this;return(i=co.call(this)||this).key=t,i.value=e,i.Zt=n,i.type=0,i}function To(){}mo.EMPTY=new mo({mapValue:{}});var _o,So,Ro,ko=(zo.prototype.set=function(t,e){return this.we(t,e),this},zo.prototype.delete=function(t){return this.we(t,null),this},zo.prototype.we=function(t,e){for(var n=this.de,i=0;i<t.length-1;++i){var r=t.get(i),o=n.get(r);o instanceof Map||(o=o&&10===kr(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(r,o)),n=o}n.set(t.q(),e)},zo.prototype.he=function(){var t=this.Te(rr.H,this.de);return null!=t?new mo(t):this.fe},zo.prototype.Te=function(i,t){var r=this,o=!1,e=this.fe.field(i),s=Br(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){if(t instanceof Map){var n=r.Te(i.child(e),t);null!=n&&(s[e]=n,o=!0)}else null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},zo),Oo=(Bo.Ee=function(t,e){return sr.$(t.key,e.key)},Bo),Lo=(n(jo,Ro=Oo),jo.prototype.field=function(t){return this.Ie.field(t)},jo.prototype.data=function(){return this.Ie},jo.prototype.me=function(){return this.Ie.proto},jo.prototype.isEqual=function(t){return t instanceof jo&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.te===t.te&&this.hasCommittedMutations===t.hasCommittedMutations&&this.Ie.isEqual(t.Ie)},jo.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.Ie.toString()+", {hasLocalMutations: "+this.te+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(jo.prototype,"hasPendingWrites",{get:function(){return this.te||this.hasCommittedMutations},enumerable:!0,configurable:!0}),jo.Re=function(t,e,n){var i=e.field(t),r=n.field(t);return null!==i&&null!==r?Dr(i,r):yu()},jo),Do=(n(Go,So=Oo),Go.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(Go.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!0,configurable:!0}),Go.prototype.isEqual=function(t){return t instanceof Go&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},Go),Vo=(n(qo,_o=Oo),qo.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(qo.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!0,configurable:!0}),qo.prototype.isEqual=function(t){return t instanceof qo&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},qo),Co=(Fo.prototype.canonicalId=function(){if(null===this.Ae){var t=this.path.G();null!==this.collectionGroup&&(t+="|cg:"+this.collectionGroup),t+="|f:",t+=this.filters.map(function(t){return t.canonicalId()}).join(","),t+="|ob:",t+=this.orderBy.map(function(t){return t.canonicalId()}).join(","),Nr(this.limit)||(t+="|l:",t+=this.limit),this.startAt&&(t+="|lb:",t+=this.startAt.canonicalId()),this.endAt&&(t+="|ub:",t+=this.endAt.canonicalId()),this.Ae=t}return this.Ae},Fo.prototype.toString=function(){var t=this.path.G();return null!==this.collectionGroup&&(t+=" collectionGroup="+this.collectionGroup),0<this.filters.length&&(t+=", filters: ["+this.filters.join(", ")+"]"),Nr(this.limit)||(t+=", limit: "+this.limit),0<this.orderBy.length&&(t+=", orderBy: ["+this.orderBy.join(", ")+"]"),this.startAt&&(t+=", startAt: "+this.startAt.canonicalId()),this.endAt&&(t+=", endAt: "+this.endAt.canonicalId()),"Target("+t+")"},Fo.prototype.isEqual=function(t){if(this.limit!==t.limit)return!1;if(this.orderBy.length!==t.orderBy.length)return!1;for(var e=0;e<this.orderBy.length;e++)if(!this.orderBy[e].isEqual(t.orderBy[e]))return!1;if(this.filters.length!==t.filters.length)return!1;for(var n=0;n<this.filters.length;n++)if(!this.filters[n].isEqual(t.filters[n]))return!1;return this.collectionGroup===t.collectionGroup&&!!this.path.isEqual(t.path)&&!!(null!==this.startAt?this.startAt.isEqual(t.startAt):null===t.startAt)&&(null!==this.endAt?this.endAt.isEqual(t.endAt):null===t.endAt)},Fo.prototype.Pe=function(){return sr.st(this.path)&&null===this.collectionGroup&&0===this.filters.length},Fo),Po=(xo.ve=function(t){return new xo(t)},Object.defineProperty(xo.prototype,"orderBy",{get:function(){if(null===this.ge){var t=this.Se(),e=this.De();if(null!==t&&null===e)t.X()?this.ge=[vs]:this.ge=[new ys(t),vs];else{for(var n=!(this.ge=[]),i=0,r=this.Ve;i<r.length;i++){var o=r[i];this.ge.push(o),o.field.X()&&(n=!0)}if(!n){var s=0<this.Ve.length?this.Ve[this.Ve.length-1].dir:is.ASCENDING;this.ge.push(s===is.ASCENDING?vs:gs)}}}return this.ge},enumerable:!0,configurable:!0}),xo.prototype.Ce=function(t){var e=this.filters.concat([t]);return new xo(this.path,this.collectionGroup,this.Ve.slice(),e,this.limit,this.pe,this.startAt,this.endAt)},xo.prototype.Fe=function(t){var e=this.Ve.concat([t]);return new xo(this.path,this.collectionGroup,e,this.filters.slice(),this.limit,this.pe,this.startAt,this.endAt)},xo.prototype.Ne=function(t){return new xo(this.path,this.collectionGroup,this.Ve.slice(),this.filters.slice(),t,"F",this.startAt,this.endAt)},xo.prototype.$e=function(t){return new xo(this.path,this.collectionGroup,this.Ve.slice(),this.filters.slice(),t,"L",this.startAt,this.endAt)},xo.prototype.ke=function(t){return new xo(this.path,this.collectionGroup,this.Ve.slice(),this.filters.slice(),this.limit,this.pe,t,this.endAt)},xo.prototype.Le=function(t){return new xo(this.path,this.collectionGroup,this.Ve.slice(),this.filters.slice(),this.limit,this.pe,this.startAt,t)},xo.prototype.Oe=function(t){return new xo(t,null,this.Ve.slice(),this.filters.slice(),this.limit,this.pe,this.startAt,this.endAt)},xo.prototype.Me=function(){return 0===this.filters.length&&null===this.limit&&null==this.startAt&&null==this.endAt&&(0===this.Ve.length||1===this.Ve.length&&this.Ve[0].field.X())},xo.prototype.canonicalId=function(){return this.qe().canonicalId()+"|lt:"+this.pe},xo.prototype.toString=function(){return"Query(target="+this.qe().toString()+"; limitType="+this.pe+")"},xo.prototype.isEqual=function(t){return this.qe().isEqual(t.qe())&&this.pe===t.pe},xo.prototype.Be=function(t,e){for(var n=!1,i=0,r=this.orderBy;i<r.length;i++){var o=r[i],s=o.compare(t,e);if(0!==s)return s;n=n||o.field.X()}return 0},xo.prototype.matches=function(t){return this.xe(t)&&this.Ue(t)&&this.Qe(t)&&this.We(t)},xo.prototype.je=function(){return!Nr(this.limit)&&"F"===this.pe},xo.prototype.Ge=function(){return!Nr(this.limit)&&"L"===this.pe},xo.prototype.De=function(){return 0<this.Ve.length?this.Ve[0].field:null},xo.prototype.Se=function(){for(var t=0,e=this.filters;t<e.length;t++){var n=e[t];if(n instanceof $o&&n.Ke())return n.field}return null},xo.prototype.He=function(t){for(var e=0,n=this.filters;e<n.length;e++){var i=n[e];if(i instanceof $o&&0<=t.indexOf(i.op))return i.op}return null},xo.prototype.Pe=function(){return this.qe().Pe()},xo.prototype.ze=function(){return null!==this.collectionGroup},xo.prototype.qe=function(){if(!this.ye)if("F"===this.pe)this.ye=new Co(this.path,this.collectionGroup,this.orderBy,this.filters,this.limit,this.startAt,this.endAt);else{for(var t=[],e=0,n=this.orderBy;e<n.length;e++){var i=n[e],r=i.dir===is.DESCENDING?is.ASCENDING:is.DESCENDING;t.push(new ys(i.field,r))}var o=this.endAt?new ds(this.endAt.position,!this.endAt.before):null,s=this.startAt?new ds(this.startAt.position,!this.startAt.before):null;this.ye=new Co(this.path,this.collectionGroup,t,this.filters,this.limit,o,s)}return this.ye},xo.prototype.xe=function(t){var e=t.key.path;return null!==this.collectionGroup?t.key.et(this.collectionGroup)&&this.path.U(e):sr.st(this.path)?this.path.isEqual(e):this.path.W(e)},xo.prototype.Ue=function(t){for(var e=0,n=this.Ve;e<n.length;e++){var i=n[e];if(!i.field.X()&&null===t.field(i.field))return!1}return!0},xo.prototype.Qe=function(t){for(var e=0,n=this.filters;e<n.length;e++)if(!n[e].matches(t))return!1;return!0},xo.prototype.We=function(t){return!(this.startAt&&!this.startAt.Ye(this.orderBy,t)||this.endAt&&this.endAt.Ye(this.orderBy,t))},xo.prototype.be=function(t){},xo),Uo=(Mo.K=function(t){switch(t){case"<":return Mo.LESS_THAN;case"<=":return Mo.LESS_THAN_OR_EQUAL;case"==":return Mo.EQUAL;case">=":return Mo.GREATER_THAN_OR_EQUAL;case">":return Mo.GREATER_THAN;case"array-contains":return Mo.ARRAY_CONTAINS;case"in":return Mo.IN;case"array-contains-any":return Mo.ARRAY_CONTAINS_ANY;default:return yu()}},Mo.prototype.toString=function(){return this.name},Mo.prototype.isEqual=function(t){return this.name===t.name},Mo);function Mo(t){this.name=t}function xo(t,e,n,i,r,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===i&&(i=[]),void 0===r&&(r=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.Ve=n,this.filters=i,this.limit=r,this.pe=o,this.startAt=s,this.endAt=u,this.ge=null,this.ye=null,this.startAt&&this.be(this.startAt),this.endAt&&this.be(this.endAt)}function Fo(t,e,n,i,r,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===i&&(i=[]),void 0===r&&(r=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=i,this.limit=r,this.startAt=o,this.endAt=s,this.Ae=null}function qo(){return null!==_o&&_o.apply(this,arguments)||this}function Go(t,e,n){var i=this;return(i=So.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),i}function jo(t,e,n,i){var r=this;return(r=Ro.call(this,t,e)||this).Ie=n,r.te=!!i.te,r.hasCommittedMutations=!!i.hasCommittedMutations,r}function Bo(t,e){this.key=t,this.version=e}function zo(t){this.fe=t,this.de=new Map}Uo.LESS_THAN=new Uo("<"),Uo.LESS_THAN_OR_EQUAL=new Uo("<="),Uo.EQUAL=new Uo("=="),Uo.GREATER_THAN=new Uo(">"),Uo.GREATER_THAN_OR_EQUAL=new Uo(">="),Uo.ARRAY_CONTAINS=new Uo("array-contains"),Uo.IN=new Uo("in"),Uo.ARRAY_CONTAINS_ANY=new Uo("array-contains-any");var Ho,Yo,Qo,Wo,Xo,Ko,$o=(n(cs,Ko=function(){}),cs.create=function(t,e,n){if(t.X())return e===Uo.IN?new Jo(t,n):new Zo(t,e,n);if(Gr(n)){if(e!==Uo.EQUAL)throw new Mi(Ui.INVALID_ARGUMENT,"Invalid query. Null supports only equality comparisons.");return new cs(t,e,n)}if(jr(n)){if(e!==Uo.EQUAL)throw new Mi(Ui.INVALID_ARGUMENT,"Invalid query. NaN supports only equality comparisons.");return new cs(t,e,n)}return e===Uo.ARRAY_CONTAINS?new ts(t,n):e===Uo.IN?new es(t,n):e===Uo.ARRAY_CONTAINS_ANY?new ns(t,n):new cs(t,e,n)},cs.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&kr(this.value)===kr(e)&&this.Xe(Dr(e,this.value))},cs.prototype.Xe=function(t){switch(this.op){case Uo.LESS_THAN:return t<0;case Uo.LESS_THAN_OR_EQUAL:return t<=0;case Uo.EQUAL:return 0===t;case Uo.GREATER_THAN:return 0<t;case Uo.GREATER_THAN_OR_EQUAL:return 0<=t;default:return yu()}},cs.prototype.Ke=function(){return 0<=[Uo.LESS_THAN,Uo.LESS_THAN_OR_EQUAL,Uo.GREATER_THAN,Uo.GREATER_THAN_OR_EQUAL].indexOf(this.op)},cs.prototype.canonicalId=function(){return this.field.G()+this.op.toString()+Cr(this.value)},cs.prototype.isEqual=function(t){return t instanceof cs&&this.op.isEqual(t.op)&&this.field.isEqual(t.field)&&Or(this.value,t.value)},cs.prototype.toString=function(){return this.field.G()+" "+this.op+" "+Cr(this.value)},cs),Zo=(n(hs,Xo=$o),hs.prototype.matches=function(t){var e=sr.$(t.key,this.key);return this.Xe(e)},hs),Jo=(n(as,Wo=$o),as.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},as),ts=(n(us,Qo=$o),us.prototype.matches=function(t){var e=t.field(this.field);return qr(e)&&Lr(e.arrayValue,this.value)},us),es=(n(ss,Yo=$o),ss.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&Lr(this.value.arrayValue,e)},ss),ns=(n(os,Ho=$o),os.prototype.matches=function(t){var e=this,n=t.field(this.field);return!(!qr(n)||!n.arrayValue.values)&&n.arrayValue.values.some(function(t){return Lr(e.value.arrayValue,t)})},os),is=(rs.prototype.toString=function(){return this.name},rs);function rs(t){this.name=t}function os(t,e){return Ho.call(this,t,Uo.ARRAY_CONTAINS_ANY,e)||this}function ss(t,e){return Yo.call(this,t,Uo.IN,e)||this}function us(t,e){return Qo.call(this,t,Uo.ARRAY_CONTAINS,e)||this}function as(t,e){var n=this;return(n=Wo.call(this,t,Uo.IN,e)||this).keys=(e.arrayValue.values||[]).map(function(t){return sr.tt(t.referenceValue)}),n}function hs(t,e,n){var i=this;return(i=Xo.call(this,t,e,n)||this).key=sr.tt(n.referenceValue),i}function cs(t,e,n){var i=this;return(i=Ko.call(this)||this).field=t,i.op=e,i.value=n,i}function fs(t){this.count=t}is.ASCENDING=new is("asc"),is.DESCENDING=new is("desc");var ls,ps,ds=(Es.prototype.canonicalId=function(){return(this.before?"b":"a")+":"+this.position.map(function(t){return Cr(t)}).join(",")},Es.prototype.Ye=function(t,e){for(var n=0,i=0;i<this.position.length;i++){var r=t[i],o=this.position[i];if(n=r.field.X()?sr.$(sr.tt(o.referenceValue),e.key):Dr(o,e.field(r.field)),r.dir===is.DESCENDING&&(n*=-1),0!==n)break}return this.before?n<=0:n<0},Es.prototype.isEqual=function(t){if(null===t)return!1;if(this.before!==t.before||this.position.length!==t.position.length)return!1;for(var e=0;e<this.position.length;e++)if(!Or(this.position[e],t.position[e]))return!1;return!0},Es),ys=(bs.prototype.compare=function(t,e){var n=this.Je?Lo.Ee(t,e):Lo.Re(this.field,t,e);switch(this.dir){case is.ASCENDING:return n;case is.DESCENDING:return-1*n;default:return yu()}},bs.prototype.canonicalId=function(){return this.field.G()+this.dir.toString()},bs.prototype.toString=function(){return this.field.G()+" ("+this.dir+")"},bs.prototype.isEqual=function(t){return this.dir===t.dir&&this.field.isEqual(t.field)},bs),vs=new ys(rr.J(),is.ASCENDING),gs=new ys(rr.J(),is.DESCENDING),ms=(ws.prototype.es=function(t){return new ws(this.target,this.targetId,this.Ze,t,this.ts,this.lastLimboFreeSnapshotVersion,this.resumeToken)},ws.prototype.ss=function(t,e){return new ws(this.target,this.targetId,this.Ze,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},ws.prototype.ns=function(t){return new ws(this.target,this.targetId,this.Ze,this.sequenceNumber,this.ts,t,this.resumeToken)},ws);function ws(t,e,n,i,r,o,s){void 0===r&&(r=Bi.MIN),void 0===o&&(o=Bi.MIN),void 0===s&&(s=Ar.qt),this.target=t,this.targetId=e,this.Ze=n,this.sequenceNumber=i,this.ts=r,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function bs(t,e){this.field=t,void 0===e&&(e=is.ASCENDING),this.dir=e,this.Je=t.X()}function Es(t,e){this.position=t,this.before=e}function As(t){switch(t){case Ui.OK:return yu();case Ui.CANCELLED:case Ui.UNKNOWN:case Ui.DEADLINE_EXCEEDED:case Ui.RESOURCE_EXHAUSTED:case Ui.INTERNAL:case Ui.UNAVAILABLE:case Ui.UNAUTHENTICATED:return;case Ui.INVALID_ARGUMENT:case Ui.NOT_FOUND:case Ui.ALREADY_EXISTS:case Ui.PERMISSION_DENIED:case Ui.FAILED_PRECONDITION:case Ui.ABORTED:case Ui.OUT_OF_RANGE:case Ui.UNIMPLEMENTED:case Ui.DATA_LOSS:return 1;default:return yu()}}function Is(t){if(void 0===t)return pu("GRPC error has no .code"),Ui.UNKNOWN;switch(t){case ls.OK:return Ui.OK;case ls.CANCELLED:return Ui.CANCELLED;case ls.UNKNOWN:return Ui.UNKNOWN;case ls.DEADLINE_EXCEEDED:return Ui.DEADLINE_EXCEEDED;case ls.RESOURCE_EXHAUSTED:return Ui.RESOURCE_EXHAUSTED;case ls.INTERNAL:return Ui.INTERNAL;case ls.UNAVAILABLE:return Ui.UNAVAILABLE;case ls.UNAUTHENTICATED:return Ui.UNAUTHENTICATED;case ls.INVALID_ARGUMENT:return Ui.INVALID_ARGUMENT;case ls.NOT_FOUND:return Ui.NOT_FOUND;case ls.ALREADY_EXISTS:return Ui.ALREADY_EXISTS;case ls.PERMISSION_DENIED:return Ui.PERMISSION_DENIED;case ls.FAILED_PRECONDITION:return Ui.FAILED_PRECONDITION;case ls.ABORTED:return Ui.ABORTED;case ls.OUT_OF_RANGE:return Ui.OUT_OF_RANGE;case ls.UNIMPLEMENTED:return Ui.UNIMPLEMENTED;case ls.DATA_LOSS:return Ui.DATA_LOSS;default:return yu()}}(ps=ls=ls||{})[ps.OK=0]="OK",ps[ps.CANCELLED=1]="CANCELLED",ps[ps.UNKNOWN=2]="UNKNOWN",ps[ps.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ps[ps.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ps[ps.NOT_FOUND=5]="NOT_FOUND",ps[ps.ALREADY_EXISTS=6]="ALREADY_EXISTS",ps[ps.PERMISSION_DENIED=7]="PERMISSION_DENIED",ps[ps.UNAUTHENTICATED=16]="UNAUTHENTICATED",ps[ps.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ps[ps.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ps[ps.ABORTED=10]="ABORTED",ps[ps.OUT_OF_RANGE=11]="OUT_OF_RANGE",ps[ps.UNIMPLEMENTED=12]="UNIMPLEMENTED",ps[ps.INTERNAL=13]="INTERNAL",ps[ps.UNAVAILABLE=14]="UNAVAILABLE",ps[ps.DATA_LOSS=15]="DATA_LOSS";var Ns=new ar(sr.$);function Ts(){return Ns}function _s(){return Ts()}var Ss=new ar(sr.$);function Rs(){return Ss}var ks=new ar(sr.$);function Os(){return ks}var Ls=new yr(sr.$);function Ds(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Ls,i=0,r=t;i<r.length;i++){var o=r[i];n=n.add(o)}return n}var Vs=new yr(wu);function Cs(){return Vs}function Ps(t,e,n,i){this.gs=t,this.removedTargetIds=e,this.key=n,this.ys=i}function Us(t,e){this.targetId=t,this.bs=e}function Ms(t,e,n,i){void 0===n&&(n=Ar.qt),void 0===i&&(i=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=i}var xs=($s.os=function(t){return new $s(t.$)},$s.prototype.has=function(t){return null!=this.rs.get(t)},$s.prototype.get=function(t){return this.rs.get(t)},$s.prototype.first=function(){return this.hs.ot()},$s.prototype.last=function(){return this.hs.at()},$s.prototype.B=function(){return this.hs.B()},$s.prototype.indexOf=function(t){var e=this.rs.get(t);return e?this.hs.indexOf(e):-1},Object.defineProperty($s.prototype,"size",{get:function(){return this.hs.size},enumerable:!0,configurable:!0}),$s.prototype.forEach=function(n){this.hs.ut(function(t,e){return n(t),!1})},$s.prototype.add=function(t){var e=this.delete(t.key);return e.rt(e.rs.nt(t.key,t),e.hs.nt(t,null))},$s.prototype.delete=function(t){var e=this.get(t);return e?this.rt(this.rs.remove(t),this.hs.remove(e)):this},$s.prototype.isEqual=function(t){if(!(t instanceof $s))return!1;if(this.size!==t.size)return!1;for(var e=this.hs.lt(),n=t.hs.lt();e.It();){var i=e.Et().key,r=n.Et().key;if(!i.isEqual(r))return!1}return!0},$s.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},$s.prototype.rt=function(t,e){var n=new $s;return n.$=this.$,n.rs=t,n.hs=e,n},$s),Fs=(Ks.prototype.track=function(t){var e=t.doc.key,n=this.as.get(e);!n||0!==t.type&&3===n.type?this.as=this.as.nt(e,t):3===t.type&&1!==n.type?this.as=this.as.nt(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.as=this.as.nt(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.as=this.as.nt(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.as=this.as.remove(e):1===t.type&&2===n.type?this.as=this.as.nt(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.as=this.as.nt(e,{type:2,doc:t.doc}):yu()},Ks.prototype.us=function(){var n=[];return this.as.ut(function(t,e){n.push(e)}),n},Ks),qs=(Xs.ds=function(t,e,n,i){var r=[];return e.forEach(function(t){r.push({type:0,doc:t})}),new Xs(t,e,xs.os(e),r,n,i,!0,!1)},Object.defineProperty(Xs.prototype,"hasPendingWrites",{get:function(){return!this.ls.B()},enumerable:!0,configurable:!0}),Xs.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this._s===t._s&&this.ls.isEqual(t.ls)&&this.query.isEqual(t.query)&&this.docs.isEqual(t.docs)&&this.cs.isEqual(t.cs)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var i=0;i<e.length;i++)if(e[i].type!==n[i].type||!e[i].doc.isEqual(n[i].doc))return!1;return!0},Xs),Gs=(Ws.ms=function(t,e){var n=new Map;return n.set(t,js.Rs(t,e)),new Ws(Bi.MIN,n,Cs(),Ts(),Ds())},Ws),js=(Qs.Rs=function(t,e){return new Qs(Ar.qt,e,Ds(),Ds(),Ds())},Qs),Bs=(Object.defineProperty(Ys.prototype,"As",{get:function(){return this.Cs},enumerable:!0,configurable:!0}),Object.defineProperty(Ys.prototype,"resumeToken",{get:function(){return this.Ds},enumerable:!0,configurable:!0}),Object.defineProperty(Ys.prototype,"Ns",{get:function(){return 0!==this.vs},enumerable:!0,configurable:!0}),Object.defineProperty(Ys.prototype,"$s",{get:function(){return this.Fs},enumerable:!0,configurable:!0}),Ys.prototype.ks=function(t){0<t.Mt()&&(this.Fs=!0,this.Ds=t)},Ys.prototype.Ls=function(){var n=Ds(),i=Ds(),r=Ds();return this.Ss.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:i=i.add(t);break;case 1:r=r.add(t);break;default:yu()}}),new js(this.Ds,this.Cs,n,i,r)},Ys.prototype.Os=function(){this.Fs=!1,this.Ss=Js()},Ys.prototype.Ms=function(t,e){this.Fs=!0,this.Ss=this.Ss.nt(t,e)},Ys.prototype.qs=function(t){this.Fs=!0,this.Ss=this.Ss.remove(t)},Ys.prototype.Bs=function(){this.vs+=1},Ys.prototype.xs=function(){--this.vs},Ys.prototype.Us=function(){this.Fs=!0,this.Cs=!0},Ys),zs=(Hs.prototype.Hs=function(t){for(var e=0,n=t.gs;e<n.length;e++){var i=n[e];t.ys instanceof Lo?this.zs(i,t.ys):t.ys instanceof Do&&this.Ys(i,t.key,t.ys)}for(var r=0,o=t.removedTargetIds;r<o.length;r++){var s=o[r];this.Ys(s,t.key,t.ys)}},Hs.prototype.Xs=function(n){var i=this;this.Js(n,function(t){var e=i.Zs(t);switch(n.state){case 0:i.ti(t)&&e.ks(n.resumeToken);break;case 1:e.xs(),e.Ns||e.Os(),e.ks(n.resumeToken);break;case 2:e.xs(),e.Ns||i.removeTarget(t);break;case 3:i.ti(t)&&(e.Us(),e.ks(n.resumeToken));break;case 4:i.ti(t)&&(i.ei(t),e.ks(n.resumeToken));break;default:yu()}})},Hs.prototype.Js=function(t,n){var i=this;0<t.targetIds.length?t.targetIds.forEach(n):this.Ws.forEach(function(t,e){i.ti(e)&&n(e)})},Hs.prototype.si=function(t){var e=t.targetId,n=t.bs.count,i=this.ii(e);if(i){var r=i.target;if(r.Pe())if(0===n){var o=new sr(r.path);this.Ys(e,o,new Do(o,Bi.S()))}else vu(1===n);else this.ni(e)!==n&&(this.ei(e),this.Ks=this.Ks.add(e))}},Hs.prototype.ri=function(r){var o=this,s=new Map;this.Ws.forEach(function(t,e){var n=o.ii(e);if(n){if(t.As&&n.target.Pe()){var i=new sr(n.target.path);null!==o.js.get(i)||o.hi(e,i)||o.Ys(e,i,new Do(i,r))}t.$s&&(s.set(e,t.Ls()),t.Os())}});var i=Ds();this.Gs.forEach(function(t,e){var n=!0;e.Ft(function(t){var e=o.ii(t);return!e||2===e.Ze||(n=!1)}),n&&(i=i.add(t))});var t=new Gs(r,s,this.Ks,this.js,i);return this.js=Ts(),this.Gs=Zs(),this.Ks=new yr(wu),t},Hs.prototype.zs=function(t,e){if(this.ti(t)){var n=this.hi(t,e.key)?2:0;this.Zs(t).Ms(e.key,n),this.js=this.js.nt(e.key,e),this.Gs=this.Gs.nt(e.key,this.oi(e.key).add(t))}},Hs.prototype.Ys=function(t,e,n){if(this.ti(t)){var i=this.Zs(t);this.hi(t,e)?i.Ms(e,1):i.qs(e),this.Gs=this.Gs.nt(e,this.oi(e).delete(t)),n&&(this.js=this.js.nt(e,n))}},Hs.prototype.removeTarget=function(t){this.Ws.delete(t)},Hs.prototype.ni=function(t){var e=this.Zs(t).Ls();return this.Qs.ai(t).size+e.Ps.size-e.ps.size},Hs.prototype.Bs=function(t){this.Zs(t).Bs()},Hs.prototype.Zs=function(t){var e=this.Ws.get(t);return e||(e=new Bs,this.Ws.set(t,e)),e},Hs.prototype.oi=function(t){var e=this.Gs.get(t);return e||(e=new yr(wu),this.Gs=this.Gs.nt(t,e)),e},Hs.prototype.ti=function(t){var e=null!==this.ii(t);return e||lu("WatchChangeAggregator","Detected inactive target",t),e},Hs.prototype.ii=function(t){var e=this.Ws.get(t);return e&&e.Ns?null:this.Qs.ui(t)},Hs.prototype.ei=function(e){var n=this;this.Ws.set(e,new Bs),this.Qs.ai(e).forEach(function(t){n.Ys(e,t,null)})},Hs.prototype.hi=function(t,e){return this.Qs.ai(t).has(e)},Hs);function Hs(t){this.Qs=t,this.Ws=new Map,this.js=Ts(),this.Gs=Zs(),this.Ks=new yr(wu)}function Ys(){this.vs=0,this.Ss=Js(),this.Ds=Ar.qt,this.Cs=!1,this.Fs=!0}function Qs(t,e,n,i,r){this.resumeToken=t,this.As=e,this.Ps=n,this.Vs=i,this.ps=r}function Ws(t,e,n,i,r){this.ts=t,this.ws=e,this.Ts=n,this.Es=i,this.Is=r}function Xs(t,e,n,i,r,o,s,u){this.query=t,this.docs=e,this.cs=n,this.docChanges=i,this.ls=r,this.fromCache=o,this._s=s,this.fs=u}function Ks(){this.as=new ar(sr.$)}function $s(n){this.$=n?function(t,e){return n(t,e)||sr.$(t.key,e.key)}:function(t,e){return sr.$(t.key,e.key)},this.rs=Rs(),this.hs=new ar(this.$)}function Zs(){return new ar(sr.$)}function Js(){return new ar(sr.$)}var tu,eu,nu=((eu={})[is.ASCENDING.name]="ASCENDING",eu[is.DESCENDING.name]="DESCENDING",eu),iu=((tu={})[Uo.LESS_THAN.name]="LESS_THAN",tu[Uo.LESS_THAN_OR_EQUAL.name]="LESS_THAN_OR_EQUAL",tu[Uo.GREATER_THAN.name]="GREATER_THAN",tu[Uo.GREATER_THAN_OR_EQUAL.name]="GREATER_THAN_OR_EQUAL",tu[Uo.EQUAL.name]="EQUAL",tu[Uo.ARRAY_CONTAINS.name]="ARRAY_CONTAINS",tu[Uo.IN.name]="IN",tu[Uo.ARRAY_CONTAINS_ANY.name]="ARRAY_CONTAINS_ANY",tu),ru=(ou.prototype.li=function(t){var e=void 0===t.code?Ui.UNKNOWN:Is(t.code);return new Mi(e,t.message||"")},ou.prototype._i=function(t){return this.options.fi||Nr(t)?t:{value:t}},ou.prototype.di=function(t){var e;return Nr(e="object"==typeof t?t.value:t)?null:e},ou.prototype.Wt=function(t){return{integerValue:""+t}},ou.prototype.jt=function(t){if(this.options.fi){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Tr(t)?"-0":t}},ou.prototype.wi=function(t){return"number"==typeof(e=t)&&Number.isInteger(e)&&!Tr(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER?this.Wt(t):this.jt(t);var e},ou.prototype.F=function(t){return this.options.fi?new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+t.nanoseconds).slice(-9)+"Z":{seconds:""+t.seconds,nanos:t.nanoseconds}},ou.prototype.v=function(t){var e=Pr(t);return new ji(e.seconds,e.nanos)},ou.prototype.Ti=function(t){return this.options.fi?t.toBase64():t.toUint8Array()},ou.prototype.Ei=function(t){return this.options.fi?(vu(void 0===t||"string"==typeof t),Ar.fromBase64String(t||"")):(vu(void 0===t||t instanceof Uint8Array),Ar.fromUint8Array(t||new Uint8Array))},ou.prototype.toVersion=function(t){return this.F(t.F())},ou.prototype.fromVersion=function(t){return vu(!!t),Bi.v(this.v(t))},ou.prototype.Ii=function(t,e){return this.mi(e||this.ci).child("documents").child(t).G()},ou.prototype.Ri=function(t){var e=Ji.K(t);return vu(su(e)),e},ou.prototype.Ai=function(t){return this.Ii(t.path)},ou.prototype.tt=function(t){var e=this.Ri(t);return vu(e.get(1)===this.ci.projectId),vu(!e.get(3)&&!this.ci.database||e.get(3)===this.ci.database),new sr(this.Pi(e))},ou.prototype.Vi=function(t){return this.Ii(t)},ou.prototype.pi=function(t){var e=this.Ri(t);return 4===e.length?Ji.H:this.Pi(e)},Object.defineProperty(ou.prototype,"gi",{get:function(){return new Ji(["projects",this.ci.projectId,"databases",this.ci.database]).G()},enumerable:!0,configurable:!0}),ou.prototype.mi=function(t){return new Ji(["projects",t.projectId,"databases",t.database])},ou.prototype.Pi=function(t){return vu(4<t.length&&"documents"===t.get(4)),t.L(5)},ou.prototype.yi=function(t,e){return{name:this.Ai(t),fields:e.proto.mapValue.fields}},ou.prototype.bi=function(t){return{name:this.Ai(t.key),fields:t.me().mapValue.fields,updateTime:this.F(t.version.F())}},ou.prototype.vi=function(t,e){var n=this.tt(t.name),i=this.fromVersion(t.updateTime),r=new mo({mapValue:{fields:t.fields}});return new Lo(n,i,r,{hasCommittedMutations:!!e})},ou.prototype.Si=function(t){vu(!!t.found),t.found.name,t.found.updateTime;var e=this.tt(t.found.name),n=this.fromVersion(t.found.updateTime),i=new mo({mapValue:{fields:t.found.fields}});return new Lo(e,n,i,{})},ou.prototype.Di=function(t){vu(!!t.missing),vu(!!t.readTime);var e=this.tt(t.missing),n=this.fromVersion(t.readTime);return new Do(e,n)},ou.prototype.Ci=function(t){return"found"in t?this.Si(t):"missing"in t?this.Di(t):yu()},ou.prototype.Fi=function(t){var e;if("targetChange"in t){t.targetChange;var n=this.Ni(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],r=this.Ei(t.targetChange.resumeToken),o=t.targetChange.cause;e=new Ms(n,i,r,o&&this.li(o)||null)}else if("documentChange"in t){t.documentChange;var s=t.documentChange;s.document,s.document.name,s.document.updateTime;var u=this.tt(s.document.name),a=this.fromVersion(s.document.updateTime),h=new mo({mapValue:{fields:s.document.fields}}),c=new Lo(u,a,h,{});e=new Ps(s.targetIds||[],s.removedTargetIds||[],c.key,c)}else if("documentDelete"in t){t.documentDelete;var f=t.documentDelete;f.document;var l=this.tt(f.document),p=f.readTime?this.fromVersion(f.readTime):Bi.S(),d=new Do(l,p);e=new Ps([],f.removedTargetIds||[],d.key,d)}else if("documentRemove"in t){t.documentRemove;var y=t.documentRemove;y.document;var v=this.tt(y.document);e=new Ps([],y.removedTargetIds||[],v,null)}else{if(!("filter"in t))return yu();t.filter;var g=t.filter;g.targetId;var m=new fs(g.count||0);e=new Us(g.targetId,m)}return e},ou.prototype.Ni=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:yu()},ou.prototype.$i=function(t){if(!("targetChange"in t))return Bi.MIN;var e=t.targetChange;return e.targetIds&&e.targetIds.length||!e.readTime?Bi.MIN:this.fromVersion(e.readTime)},ou.prototype.ki=function(t){var e,n=this;if(t instanceof lo)e={update:this.yi(t.key,t.value)};else if(t instanceof vo)e={delete:this.Ai(t.key)};else if(t instanceof po)e={update:this.yi(t.key,t.data),updateMask:this.Li(t.se)};else if(t instanceof yo)e={transform:{document:this.Ai(t.key),fieldTransforms:t.fieldTransforms.map(function(t){return n.Oi(t)})}};else{if(!(t instanceof go))return yu();e={verify:this.Ai(t.key)}}return t.Zt.zt||(e.currentDocument=this.Mi(t.Zt)),e},ou.prototype.qi=function(t){var e=this,n=t.currentDocument?this.Bi(t.currentDocument):no.NONE;if(t.update){t.update.name;var i=this.tt(t.update.name),r=new mo({mapValue:{fields:t.update.fields}});if(t.updateMask){var o=this.xi(t.updateMask);return new po(i,r,o,n)}return new lo(i,r,n)}if(t.delete){var s=this.tt(t.delete);return new vo(s,n)}if(t.transform){var u=this.tt(t.transform.document),a=t.transform.fieldTransforms.map(function(t){return e.Ui(t)});return vu(!0===n.exists),new yo(u,a)}if(t.verify){var h=this.tt(t.verify);return new go(h,n)}return yu()},ou.prototype.Mi=function(t){return void 0!==t.updateTime?{updateTime:this.toVersion(t.updateTime)}:void 0!==t.exists?{exists:t.exists}:yu()},ou.prototype.Bi=function(t){return void 0!==t.updateTime?no.updateTime(this.fromVersion(t.updateTime)):void 0!==t.exists?no.exists(t.exists):no.NONE},ou.prototype.Qi=function(t,e){var n=t.updateTime?this.fromVersion(t.updateTime):this.fromVersion(e);n.isEqual(Bi.MIN)&&(n=this.fromVersion(e));var i=null;return t.transformResults&&0<t.transformResults.length&&(i=t.transformResults),new Jr(n,i)},ou.prototype.Wi=function(t,e){var n=this;return t&&0<t.length?(vu(void 0!==e),t.map(function(t){return n.Qi(t,e)})):[]},ou.prototype.Oi=function(t){var e=t.transform;if(e instanceof zr)return{fieldPath:t.field.G(),setToServerValue:"REQUEST_TIME"};if(e instanceof Yr)return{fieldPath:t.field.G(),appendMissingElements:{values:e.elements}};if(e instanceof Qr)return{fieldPath:t.field.G(),removeAllFromArray:{values:e.elements}};if(e instanceof Wr)return{fieldPath:t.field.G(),increment:e.Qt};throw yu()},ou.prototype.Ui=function(t){var e=null;if("setToServerValue"in t)vu("REQUEST_TIME"===t.setToServerValue),e=zr.instance;else if("appendMissingElements"in t){var n=t.appendMissingElements.values||[];e=new Yr(n)}else if("removeAllFromArray"in t){var i=t.removeAllFromArray.values||[];e=new Qr(i)}else"increment"in t?e=new Wr(this,t.increment):yu();var r=rr.Z(t.fieldPath);return new eo(r,e)},ou.prototype.ji=function(t){return{documents:[this.Vi(t.path)]}},ou.prototype.Gi=function(t){vu(1===t.documents.length);var e=t.documents[0];return Po.ve(this.pi(e)).qe()},ou.prototype.Ki=function(t){var e={structuredQuery:{}},n=t.path;null!==t.collectionGroup?(e.parent=this.Vi(n),e.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(e.parent=this.Vi(n.O()),e.structuredQuery.from=[{collectionId:n.q()}]);var i=this.Hi(t.filters);i&&(e.structuredQuery.where=i);var r=this.zi(t.orderBy);r&&(e.structuredQuery.orderBy=r);var o=this._i(t.limit);return null!==o&&(e.structuredQuery.limit=o),t.startAt&&(e.structuredQuery.startAt=this.Yi(t.startAt)),t.endAt&&(e.structuredQuery.endAt=this.Yi(t.endAt)),e},ou.prototype.Xi=function(t){var e=this.pi(t.parent),n=t.structuredQuery,i=n.from?n.from.length:0,r=null;if(0<i){vu(1===i);var o=n.from[0];o.allDescendants?r=o.collectionId:e=e.child(o.collectionId)}var s=[];n.where&&(s=this.Ji(n.where));var u=[];n.orderBy&&(u=this.Zi(n.orderBy));var a=null;n.limit&&(a=this.di(n.limit));var h=null;n.startAt&&(h=this.tn(n.startAt));var c=null;return n.endAt&&(c=this.tn(n.endAt)),new Po(e,r,u,s,a,"F",h,c).qe()},ou.prototype.en=function(t){var e=this.sn(t.Ze);return null==e?null:{"goog-listen-tags":e}},ou.prototype.sn=function(t){switch(t){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return yu()}},ou.prototype.qe=function(t){var e,n=t.target;return(e=n.Pe()?{documents:this.ji(n)}:{query:this.Ki(n)}).targetId=t.targetId,0<t.resumeToken.Mt()&&(e.resumeToken=this.Ti(t.resumeToken)),e},ou.prototype.Hi=function(t){var e=this;if(0!==t.length){var n=t.map(function(t){return t instanceof $o?e.in(t):yu()});return 1===n.length?n[0]:{compositeFilter:{op:"AND",filters:n}}}},ou.prototype.Ji=function(t){var e=this;return t?void 0!==t.unaryFilter?[this.nn(t)]:void 0!==t.fieldFilter?[this.rn(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map(function(t){return e.Ji(t)}).reduce(function(t,e){return t.concat(e)}):yu():[]},ou.prototype.zi=function(t){var e=this;if(0!==t.length)return t.map(function(t){return e.hn(t)})},ou.prototype.Zi=function(t){var e=this;return t.map(function(t){return e.on(t)})},ou.prototype.Yi=function(t){return{before:t.before,values:t.position}},ou.prototype.tn=function(t){var e=!!t.before,n=t.values||[];return new ds(n,e)},ou.prototype.an=function(t){return nu[t.name]},ou.prototype.un=function(t){switch(t){case"ASCENDING":return is.ASCENDING;case"DESCENDING":return is.DESCENDING;default:return}},ou.prototype.cn=function(t){return iu[t.name]},ou.prototype.ln=function(t){switch(t){case"EQUAL":return Uo.EQUAL;case"GREATER_THAN":return Uo.GREATER_THAN;case"GREATER_THAN_OR_EQUAL":return Uo.GREATER_THAN_OR_EQUAL;case"LESS_THAN":return Uo.LESS_THAN;case"LESS_THAN_OR_EQUAL":return Uo.LESS_THAN_OR_EQUAL;case"ARRAY_CONTAINS":return Uo.ARRAY_CONTAINS;case"IN":return Uo.IN;case"ARRAY_CONTAINS_ANY":return Uo.ARRAY_CONTAINS_ANY;case"OPERATOR_UNSPECIFIED":default:return yu()}},ou.prototype._n=function(t){return{fieldPath:t.G()}},ou.prototype.fn=function(t){return rr.Z(t.fieldPath)},ou.prototype.hn=function(t){return{field:this._n(t.field),direction:this.an(t.dir)}},ou.prototype.on=function(t){return new ys(this.fn(t.field),this.un(t.direction))},ou.prototype.rn=function(t){return $o.create(this.fn(t.fieldFilter.field),this.ln(t.fieldFilter.op),t.fieldFilter.value)},ou.prototype.in=function(t){if(t.op===Uo.EQUAL){if(jr(t.value))return{unaryFilter:{field:this._n(t.field),op:"IS_NAN"}};if(Gr(t.value))return{unaryFilter:{field:this._n(t.field),op:"IS_NULL"}}}return{fieldFilter:{field:this._n(t.field),op:this.cn(t.op),value:t.value}}},ou.prototype.nn=function(t){switch(t.unaryFilter.op){case"IS_NAN":var e=this.fn(t.unaryFilter.field);return $o.create(e,Uo.EQUAL,{doubleValue:NaN});case"IS_NULL":var n=this.fn(t.unaryFilter.field);return $o.create(n,Uo.EQUAL,{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return yu()}},ou.prototype.Li=function(t){var e=[];return t.fields.forEach(function(t){return e.push(t.G())}),{fieldPaths:e}},ou.prototype.xi=function(t){var e=(t.fieldPaths||[]).map(function(t){return rr.Z(t)});return to.Kt(e)},ou);function ou(t,e){this.ci=t,this.options=e}function su(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}var uu=(hu.dn=function(t){hu.platform&&yu(),hu.platform=t},hu.Ot=function(){return hu.platform||yu(),hu.platform},hu),au=new l("@firebase/firestore");function hu(){}function cu(){return au.logLevel}function fu(t){au.logLevel=t}function lu(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(au.logLevel<=u.DEBUG){var i=e.map(du);au.debug.apply(au,r(["Firestore ("+Li+"): "+t],i))}}function pu(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(au.logLevel<=u.ERROR){var i=e.map(du);au.error.apply(au,r(["Firestore ("+Li+"): "+t],i))}}function du(t){if("string"==typeof t)return t;var e=uu.Ot();try{return e.wn(t)}catch(e){return t}}function yu(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE ("+Li+") INTERNAL ASSERTION FAILED: "+t;throw pu(e),new Error(e)}function vu(t){t||yu()}var gu=(mu.Tn=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e="",n=0;n<20;n++)e+=t.charAt(Math.floor(Math.random()*t.length));return e},mu);function mu(){}function wu(t,e){return t<e?-1:e<t?1:0}function bu(t,n,i){return t.length===n.length&&t.every(function(t,e){return i(t,n[e])})}function Eu(t,e,n,i,r){this.ci=t,this.persistenceKey=e,this.host=n,this.ssl=i,this.forceLongPolling=r}var Au=(Object.defineProperty(Gu.prototype,"En",{get:function(){return"(default)"===this.database},enumerable:!0,configurable:!0}),Gu.prototype.isEqual=function(t){return t instanceof Gu&&t.projectId===this.projectId&&t.database===this.database},Gu.prototype.D=function(t){return wu(this.projectId,t.projectId)||wu(this.database,t.database)},Gu),Iu=(qu.prototype.get=function(t){var e=this.In(t),n=this.mn[e];if(void 0!==n)for(var i=0,r=n;i<r.length;i++){var o=r[i],s=o[0],u=o[1];if(s.isEqual(t))return u}},qu.prototype.has=function(t){return void 0!==this.get(t)},qu.prototype.set=function(t,e){var n=this.In(t),i=this.mn[n];if(void 0!==i){for(var r=0;r<i.length;r++)if(i[r][0].isEqual(t))return void(i[r]=[t,e]);i.push([t,e])}else this.mn[n]=[[t,e]]},qu.prototype.delete=function(t){var e=this.In(t),n=this.mn[e];if(void 0===n)return!1;for(var i=0;i<n.length;i++)if(n[i][0].isEqual(t))return 1===n.length?delete this.mn[e]:n.splice(i,1),!0;return!1},qu.prototype.forEach=function(u){br(this.mn,function(t,e){for(var n=0,i=e;n<i.length;n++){var r=i[n],o=r[0],s=r[1];u(o,s)}})},qu.prototype.B=function(){return Er(this.mn)},qu),Nu=(Fu.prototype.xt=function(t,e,n){for(var i=n.An,r=0;r<this.mutations.length;r++){var o=this.mutations[r];if(o.key.isEqual(t)){var s=i[r];e=o.xt(e,s)}}return e},Fu.prototype.Bt=function(t,e){for(var n=0,i=this.baseMutations;n<i.length;n++){var r=i[n];r.key.isEqual(t)&&(e=r.Bt(e,e,this.Rn))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=a.Bt(e,o,this.Rn))}return e},Fu.prototype.Pn=function(n){var i=this,r=n;return this.mutations.forEach(function(t){var e=i.Bt(t.key,n.get(t.key));e&&(r=r.nt(t.key,e))}),r},Fu.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},Ds())},Fu.prototype.isEqual=function(t){return this.batchId===t.batchId&&bu(this.mutations,t.mutations,function(t,e){return t.isEqual(e)})&&bu(this.baseMutations,t.baseMutations,function(t,e){return t.isEqual(e)})},Fu),Tu=(xu.from=function(t,e,n,i){vu(t.mutations.length===n.length);for(var r=Os(),o=t.mutations,s=0;s<o.length;s++)r=r.nt(o[s].key,n[s].version);return new xu(t,e,n,i,r)},xu),_u=(Mu.prototype.B=function(){return this.gn.B()},Mu.prototype.vn=function(t,e){var n=new Su(t,e);this.gn=this.gn.add(n),this.yn=this.yn.add(n)},Mu.prototype.Sn=function(t,e){var n=this;t.forEach(function(t){return n.vn(t,e)})},Mu.prototype.Dn=function(t,e){this.Cn(new Su(t,e))},Mu.prototype.Fn=function(t,e){var n=this;t.forEach(function(t){return n.Dn(t,e)})},Mu.prototype.Nn=function(t){var e=this,n=sr.EMPTY,i=new Su(n,t),r=new Su(n,t+1),o=[];return this.yn.Ct([i,r],function(t){e.Cn(t),o.push(t.key)}),o},Mu.prototype.$n=function(){var e=this;this.gn.forEach(function(t){return e.Cn(t)})},Mu.prototype.Cn=function(t){this.gn=this.gn.delete(t),this.yn=this.yn.delete(t)},Mu.prototype.kn=function(t){var e=sr.EMPTY,n=new Su(e,t),i=new Su(e,t+1),r=Ds();return this.yn.Ct([n,i],function(t){r=r.add(t.key)}),r},Mu.prototype.Ln=function(t){var e=new Su(t,0),n=this.gn.Nt(e);return null!==n&&t.isEqual(n.key)},Mu),Su=(Uu.Ee=function(t,e){return sr.$(t.key,e.key)||wu(t.On,e.On)},Uu.bn=function(t,e){return wu(t.On,e.On)||sr.$(t.key,e.key)},Uu),Ru=(Pu.prototype.catch=function(t){return this.next(void 0,t)},Pu.prototype.next=function(i,r){var o=this;return this.xn&&yu(),this.xn=!0,this.Bn?this.error?this.Un(r,this.error):this.Qn(i,this.result):new Pu(function(e,n){o.Mn=function(t){o.Qn(i,t).next(e,n)},o.qn=function(t){o.Un(r,t).next(e,n)}})},Pu.prototype.Wn=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},Pu.prototype.jn=function(t){try{var e=t();return e instanceof Pu?e:Pu.resolve(e)}catch(t){return Pu.reject(t)}},Pu.prototype.Qn=function(t,e){return t?this.jn(function(){return t(e)}):Pu.resolve(e)},Pu.prototype.Un=function(t,e){return t?this.jn(function(){return t(e)}):Pu.reject(e)},Pu.resolve=function(n){return new Pu(function(t,e){t(n)})},Pu.reject=function(n){return new Pu(function(t,e){e(n)})},Pu.Gn=function(t){return new Pu(function(e,n){var i=0,r=0,o=!1;t.forEach(function(t){++i,t.next(function(){++r,o&&r===i&&e()},function(t){return n(t)})}),o=!0,r===i&&e()})},Pu.Kn=function(t){for(var n=Pu.resolve(!1),e=function(e){n=n.next(function(t){return t?Pu.resolve(t):e()})},i=0,r=t;i<r.length;i++)e(r[i]);return n},Pu.forEach=function(t,n){var i=this,r=[];return t.forEach(function(t,e){r.push(n.call(i,t,e))}),this.Gn(r)},Pu),ku=(Cu.prototype.Xn=function(e,n){var i=this;return this.zn.Jn(e,n).next(function(t){return i.Zn(e,n,t)})},Cu.prototype.Zn=function(t,i,r){return this.Hn.tr(t,i).next(function(t){for(var e=0,n=r;e<n.length;e++)t=n[e].Bt(i,t);return t})},Cu.prototype.er=function(t,e,r){var o=_s();return e.forEach(function(t,e){for(var n=0,i=r;n<i.length;n++)e=i[n].Bt(t,e);o=o.nt(t,e)}),o},Cu.prototype.sr=function(e,t){var n=this;return this.Hn.getEntries(e,t).next(function(t){return n.ir(e,t)})},Cu.prototype.ir=function(i,r){var o=this;return this.zn.nr(i,r).next(function(t){var e=o.er(i,r,t),n=Ts();return e.forEach(function(t,e){e=e||new Do(t,Bi.S()),n=n.nt(t,e)}),n})},Cu.prototype.rr=function(t,e,n){return e.Pe()?this.hr(t,e.path):e.ze()?this.or(t,e,n):this.ar(t,e,n)},Cu.prototype.hr=function(t,e){return this.Xn(t,new sr(e)).next(function(t){var e=Rs();return t instanceof Lo&&(e=e.nt(t.key,t)),e})},Cu.prototype.or=function(n,i,r){var o=this,s=i.collectionGroup,u=Rs();return this.Yn.ur(n,s).next(function(t){return Ru.forEach(t,function(t){var e=i.Oe(t.child(s));return o.ar(n,e,r).next(function(t){t.forEach(function(t,e){u=u.nt(t,e)})})}).next(function(){return u})})},Cu.prototype.ar=function(e,n,t){var c,f,i=this;return this.Hn.rr(e,n,t).next(function(t){return c=t,i.zn.cr(e,n)}).next(function(t){return f=t,i.lr(e,f,c).next(function(t){c=t;for(var e=0,n=f;e<n.length;e++)for(var i=n[e],r=0,o=i.mutations;r<o.length;r++){var s=o[r],u=s.key,a=c.get(u),h=s.Bt(a,a,i.Rn);c=h instanceof Lo?c.nt(u,h):c.remove(u)}})}).next(function(){return c.forEach(function(t,e){n.matches(e)||(c=c.remove(t))}),c})},Cu.prototype.lr=function(t,e,n){for(var i=Ds(),r=0,o=e;r<o.length;r++)for(var s=0,u=o[r].mutations;s<u.length;s++){var a=u[s];a instanceof po&&null===n.get(a.key)&&(i=i.add(a.key))}var h=n;return this.Hn.getEntries(t,i).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof Lo&&(h=h.nt(t,e))}),h})},Cu),Ou=(Vu.wr=function(t,e){for(var n=Ds(),i=Ds(),r=0,o=e.docChanges;r<o.length;r++){var s=o[r];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}}return new Vu(t,e.fromCache,n,i)},Vu),Lu=(Du.prototype.Er=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},Du.prototype.next=function(){var t=++this.previousValue;return this.Ir&&this.Ir(t),t},Du);function Du(t,e){var n=this;this.previousValue=t,e&&(e.Tr=function(t){return n.Er(t)},this.Ir=function(t){return e.mr(t)})}function Vu(t,e,n,i){this.targetId=t,this.fromCache=e,this._r=n,this.dr=i}function Cu(t,e,n){this.Hn=t,this.zn=e,this.Yn=n}function Pu(t){var e=this;this.Mn=null,this.qn=null,this.result=void 0,this.error=void 0,this.Bn=!1,this.xn=!1,t(function(t){e.Bn=!0,e.result=t,e.Mn&&e.Mn(t)},function(t){e.Bn=!0,e.error=t,e.qn&&e.qn(t)})}function Uu(t,e){this.key=t,this.On=e}function Mu(){this.gn=new yr(Su.Ee),this.yn=new yr(Su.bn)}function xu(t,e,n,i,r){this.batch=t,this.Vn=e,this.An=n,this.streamToken=i,this.pn=r}function Fu(t,e,n,i){this.batchId=t,this.Rn=e,this.baseMutations=n,this.mutations=i}function qu(t){this.In=t,this.mn={}}function Gu(t,e){this.projectId=t,this.database=e||"(default)"}function ju(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})}Lu.Rr=-1;var Bu=(Ku.prototype.reset=function(){this.yr=0},Ku.prototype.Sr=function(){this.yr=this.gr},Ku.prototype.Dr=function(t){var e=this;this.cancel();var n=Math.floor(this.yr+this.Cr()),i=Math.max(0,Date.now()-this.vr),r=Math.max(0,n-i);0<r&&lu("ExponentialBackoff","Backing off for "+r+" ms (base delay: "+this.yr+" ms, delay with jitter: "+n+" ms, last attempt: "+i+" ms ago)"),this.br=this.Ar.Fr(this.Pr,r,function(){return e.vr=Date.now(),t()}),this.yr*=this.pr,this.yr<this.Vr&&(this.yr=this.Vr),this.yr>this.gr&&(this.yr=this.gr)},Ku.prototype.cancel=function(){null!==this.br&&(this.br.cancel(),this.br=null)},Ku.prototype.Cr=function(){return(Math.random()-.5)*this.yr},Ku),zu=(Xu.Or=function(t,e,n,i,r){var o=new Xu(t,e,Date.now()+n,i,r);return o.start(n),o},Xu.prototype.start=function(t){var e=this;this.Mr=setTimeout(function(){return e.qr()},t)},Xu.prototype.Br=function(){return this.qr()},Xu.prototype.cancel=function(t){null!==this.Mr&&(this.clearTimeout(),this.Lr.reject(new Mi(Ui.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},Xu.prototype.qr=function(){var e=this;this.Nr.xr(function(){return null!==e.Mr?(e.clearTimeout(),e.op().then(function(t){return e.Lr.resolve(t)})):Promise.resolve()})},Xu.prototype.clearTimeout=function(){null!==this.Mr&&(this.kr(this),clearTimeout(this.Mr),this.Mr=null)},Xu),Hu=(Object.defineProperty(Wu.prototype,"Jr",{get:function(){return this.Wr},enumerable:!0,configurable:!0}),Wu.prototype.xr=function(t){this.enqueue(t)},Wu.prototype.Zr=function(t){this.th(),this.eh(t)},Wu.prototype.sh=function(t){return this.th(),this.eh(t)},Wu.prototype.ih=function(n){return c(this,void 0,void 0,function(){var e;return f(this,function(t){switch(t.label){case 0:return this.th(),this.Wr?[3,2]:(this.Wr=!0,(e=uu.Ot().window)&&e.removeEventListener("visibilitychange",this.Yr),[4,this.sh(n)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},Wu.prototype.enqueue=function(t){return this.th(),this.Wr?new Promise(function(t){}):this.eh(t)},Wu.prototype.nh=function(r){var t=this;this.th(),this.Wr||(this.Qr=this.Qr.then(function(){var n=new ju,i=function(){return c(t,void 0,void 0,function(){var e;return f(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,r()];case 1:return t.sent(),n.resolve(),this.zr.reset(),[3,3];case 2:if("IndexedDbTransactionError"!==(e=t.sent()).name)throw n.resolve(),e;return lu("AsyncQueue","Operation failed with retryable error: "+e),this.zr.Dr(i),[3,3];case 3:return[2]}})})};return t.xr(i),n.promise}))},Wu.prototype.eh=function(t){var e=this,n=this.Ur.then(function(){return e.Kr=!0,t().catch(function(t){throw e.Gr=t,e.Kr=!1,pu("INTERNAL UNHANDLED ERROR: ",t.stack||t.message||""),t}).then(function(t){return e.Kr=!1,t})});return this.Ur=n},Wu.prototype.Fr=function(t,e,n){var i=this;this.th(),-1<this.Hr.indexOf(t)&&(e=0);var r=zu.Or(this,t,e,n,function(t){return i.rh(t)});return this.jr.push(r),r},Wu.prototype.th=function(){this.Gr&&yu()},Wu.prototype.hh=function(){},Wu.prototype.oh=function(){return c(this,void 0,void 0,function(){var e;return f(this,function(t){switch(t.label){case 0:return[4,e=this.Ur];case 1:t.sent(),t.label=2;case 2:if(e!==this.Ur)return[3,0];t.label=3;case 3:return[2]}})})},Wu.prototype.ah=function(t){for(var e=0,n=this.jr;e<n.length;e++)if(n[e].Pr===t)return!0;return!1},Wu.prototype.Xr=function(i){var r=this;return this.oh().then(function(){r.jr.sort(function(t,e){return t.$r-e.$r});for(var t=0,e=r.jr;t<e.length;t++){var n=e[t];if(n.Br(),"all"!==i&&n.Pr===i)break}return r.oh()})},Wu.prototype.uh=function(t){this.Hr.push(t)},Wu.prototype.rh=function(t){var e=this.jr.indexOf(t);this.jr.splice(e,1)},Wu),Yu=(Qu.dh=function(t){return new Qu(t,Qu.wh,Qu.Th)},Qu);function Qu(t,e,n){this.lh=t,this._h=e,this.fh=n}function Wu(){var t=this;this.Ur=Promise.resolve(),this.Qr=Promise.resolve(),this.Wr=!1,this.jr=[],this.Gr=null,this.Kr=!1,this.Hr=[],this.zr=new Bu(this,"async_queue_retry"),this.Yr=function(){t.Xr("async_queue_retry")};var e=uu.Ot().window;e&&e.addEventListener("visibilitychange",this.Yr)}function Xu(t,e,n,i,r){this.Nr=t,this.Pr=e,this.$r=n,this.op=i,this.kr=r,this.Lr=new ju,this.then=this.Lr.promise.then.bind(this.Lr.promise),this.catch=this.Lr.promise.catch.bind(this.Lr.promise),this.Lr.promise.catch(function(t){})}function Ku(t,e,n,i,r){void 0===n&&(n=1e3),void 0===i&&(i=1.5),void 0===r&&(r=6e4),this.Ar=t,this.Pr=e,this.Vr=n,this.pr=i,this.gr=r,this.yr=0,this.br=null,this.vr=Date.now(),this.reset()}Yu.Eh=-1,Yu.Ih=1048576,Yu.mh=41943040,Yu.wh=10,Yu.Th=1e3,Yu.Rh=new Yu(Yu.mh,Yu.wh,Yu.Th),Yu.DISABLED=new Yu(Yu.Eh,0,0);var $u=(ra.prototype.next=function(){return this.Ah+=2,this.Ah},ra.Ph=function(){return new ra(0)},ra.Vh=function(){return new ra(-1)},ra),Zu=(ia.prototype.gh=function(t,e){return this.ph.add(e),Ru.resolve()},ia.prototype.ur=function(t,e){return Ru.resolve(this.ph.getEntries(e))},ia),Ju=(na.prototype.add=function(t){var e=t.q(),n=t.O(),i=this.index[e]||new yr(Ji.$),r=!i.has(n);return this.index[e]=i.add(n),r},na.prototype.has=function(t){var e=t.q(),n=t.O(),i=this.index[e];return i&&i.has(n)},na.prototype.getEntries=function(t){return(this.index[t]||new yr(Ji.$)).j()},na),ta=(ea.prototype.start=function(){return Promise.resolve()},ea.prototype.xh=function(r){return c(this,void 0,void 0,function(){var e,m,n,i=this;return f(this,function(t){switch(t.label){case 0:return e=this.zn,m=this.Mh,[4,this.persistence.runTransaction("Handle user change","readonly",function(v){var g;return i.zn.Uh(v).next(function(t){return g=t,e=i.persistence.Nh(r),m=new ku(i.$h,e,i.persistence.qh()),e.Uh(v)}).next(function(t){for(var e=[],n=[],i=Ds(),r=0,o=g;r<o.length;r++){var s=o[r];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++){var h=a[u];i=i.add(h.key)}}for(var c=0,f=t;c<f.length;c++){var l=f[c];n.push(l.batchId);for(var p=0,d=l.mutations;p<d.length;p++){var y=d[p];i=i.add(y.key)}}return m.sr(v,i).next(function(t){return{Qh:t,Wh:e,jh:n}})})})];case 1:return n=t.sent(),[2,(this.zn=e,this.Mh=m,this.yh.Bh(this.Mh),n)]}})})},ea.prototype.Gh=function(u){var a,h=this,c=ji.now(),t=u.reduce(function(t,e){return t.add(e.key)},Ds());return this.persistence.runTransaction("Locally write mutations","readwrite",function(s){return h.Mh.sr(s,t).next(function(t){a=t;for(var e=[],n=0,i=u;n<i.length;n++){var r=i[n],o=r.ee(a.get(r.key));null!=o&&e.push(new po(r.key,o,o.se(),no.exists(!0)))}return h.zn.Kh(s,c,e,u)})}).then(function(t){var e=t.Pn(a);return{batchId:t.batchId,Hh:e}})},ea.prototype.zh=function(i){var r=this;return this.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var e=i.batch.keys(),n=r.$h.Yh({Xh:!0});return r.zn.zh(t,i.batch,i.streamToken).next(function(){return r.Jh(t,i,n)}).next(function(){return n.apply(t)}).next(function(){return r.zn.Zh(t)}).next(function(){return r.Mh.sr(t,e)})})},ea.prototype.to=function(t){var i=this;return this.persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return i.zn.eo(e,t).next(function(t){return vu(null!==t),n=t.keys(),i.zn.so(e,t)}).next(function(){return i.zn.Zh(e)}).next(function(){return i.Mh.sr(e,n)})})},ea.prototype.io=function(){var e=this;return this.persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.zn.io(t)})},ea.prototype.no=function(){var e=this;return this.persistence.runTransaction("Get last stream token","readonly",function(t){return e.zn.no(t)})},ea.prototype.ro=function(e){var n=this;return this.persistence.runTransaction("Set last stream token","readwrite-primary",function(t){return n.zn.ro(t,e)})},ea.prototype.ho=function(){var e=this;return this.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.Lh.ho(t)})},ea.prototype.oo=function(a){var h=this,c=a.ts,f=this.vh;return this.persistence.runTransaction("Apply remote event","readwrite-primary",function(o){var r=h.$h.Yh({Xh:!0});f=h.vh;var s=[];a.ws.forEach(function(t,e){var n=f.get(e);if(n){s.push(h.Lh.ao(o,t.ps,e).next(function(){return h.Lh.uo(o,t.Ps,e)}));var i=t.resumeToken;if(0<i.Mt()){var r=n.ss(i,c).es(o.co);f=f.nt(e,r),ea.lo(n,r,t)&&s.push(h.Lh._o(o,r))}}});var u=Ts(),n=Ds();if(a.Es.forEach(function(t,e){n=n.add(t)}),s.push(r.getEntries(o,n).next(function(i){a.Es.forEach(function(t,e){var n=i.get(t);e instanceof Do&&e.version.isEqual(Bi.MIN)?(r.fo(t,c),u=u.nt(t,e)):null==n||0<e.version.D(n.version)||0===e.version.D(n.version)&&n.hasPendingWrites?(r.do(e,c),u=u.nt(t,e)):lu("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version),a.Is.has(t)&&s.push(h.persistence.Fh.wo(o,t))})})),!c.isEqual(Bi.MIN)){var t=h.Lh.ho(o).next(function(t){return h.Lh.To(o,o.co,c)});s.push(t)}return Ru.Gn(s).next(function(){return r.apply(o)}).next(function(){return h.Mh.ir(o,u)})}).then(function(t){return h.vh=f,t})},ea.lo=function(t,e,n){return vu(0<e.resumeToken.Mt()),0===t.resumeToken.Mt()||e.ts.C()-t.ts.C()>=this.Eo||0<n.Ps.size+n.Vs.size+n.ps.size},ea.prototype.Io=function(t){for(var n=this,e=0,i=t;e<i.length;e++){var r=i[e],o=r.targetId;if(this.bh.Sn(r._r,o),this.bh.Fn(r.dr,o),!r.fromCache){var s=this.vh.get(o),u=s.ts,a=s.ns(u);this.vh=this.vh.nt(o,a)}}return this.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(e){return Ru.forEach(t,function(t){return Ru.forEach(t.dr,function(t){return n.persistence.Fh.Dn(e,t)})})})},ea.prototype.mo=function(e){var n=this;return this.persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===e&&(e=-1),n.zn.Ro(t,e)})},ea.prototype.Ao=function(e){var n=this;return this.persistence.runTransaction("read document","readonly",function(t){return n.Mh.Xn(t,e)})},ea.prototype.Po=function(i){var r=this;return this.persistence.runTransaction("Allocate target","readwrite",function(e){var n;return r.Lh.Vo(e,i).next(function(t){return t?(n=t,Ru.resolve(n)):r.Lh.po(e).next(function(t){return n=new ms(i,t,0,e.co),r.Lh.yo(e,n).next(function(){return n})})})}).then(function(t){return null===r.vh.get(t.targetId)&&(r.vh=r.vh.nt(t.targetId,t),r.Sh.set(i,t.targetId)),t})},ea.prototype.Vo=function(t,e){var n=this.Sh.get(e);return void 0!==n?Ru.resolve(this.vh.get(n)):this.Lh.Vo(t,e)},ea.prototype.bo=function(n,i){var r=this,o=this.vh.get(n),t=i?"readwrite":"readwrite-primary";return this.persistence.runTransaction("Release target",t,function(e){var t=r.bh.Nn(n);return i?Ru.resolve():Ru.forEach(t,function(t){return r.persistence.Fh.Dn(e,t)}).next(function(){r.persistence.Fh.removeTarget(e,o)})}).then(function(){r.vh=r.vh.remove(n),r.Sh.delete(o.target)})},ea.prototype.vo=function(t,n){var i=this,r=Bi.MIN,o=Ds();return this.persistence.runTransaction("Execute query","readonly",function(e){return i.Vo(e,t.qe()).next(function(t){if(t)return r=t.lastLimboFreeSnapshotVersion,i.Lh.So(e,t.targetId).next(function(t){o=t})}).next(function(){return i.yh.rr(e,t,n?r:Bi.MIN,n?o:Ds())}).next(function(t){return{documents:t,Do:o}})})},ea.prototype.Co=function(e){var n=this;return this.persistence.runTransaction("Remote document keys","readonly",function(t){return n.Lh.So(t,e)})},ea.prototype.Jh=function(t,r,o){var e=this,s=r.batch,n=s.keys(),u=Ru.resolve();return n.forEach(function(i){u=u.next(function(){return o.tr(t,i)}).next(function(t){var e=t,n=r.pn.get(i);vu(null!==n),(!e||e.version.D(n)<0)&&(e=s.xt(i,e,r))&&o.do(e,r.Vn)})}),u.next(function(){return e.zn.so(t,s)})},ea.prototype.Fo=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.No(t,n.vh)})},ea);function ea(t,e,n){this.persistence=t,this.yh=e,this.bh=new _u,this.vh=new ar(wu),this.Sh=new Iu(function(t){return t.canonicalId()}),this.Dh=Bi.MIN,this.persistence.Fh.Ch(this.bh),this.zn=t.Nh(n),this.$h=t.kh(),this.Lh=t.Oh(),this.Mh=new ku(this.$h,this.zn,this.persistence.qh()),this.yh.Bh(this.Mh)}function na(){this.index={}}function ia(){this.ph=new Ju}function ra(t){this.Ah=t}function oa(e){return c(this,void 0,void 0,function(){return f(this,function(t){if(e.code!==Ui.FAILED_PRECONDITION||"The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab."!==e.message)throw e;return lu("LocalStore","Unexpectedly lost primary lease"),[2]})})}function sa(t,e){if(0!==e.length)throw new Mi(Ui.INVALID_ARGUMENT,"Function "+t+"() does not support arguments, but was called with "+Ia(e.length,"argument")+".")}function ua(t,e,n){if(e.length!==n)throw new Mi(Ui.INVALID_ARGUMENT,"Function "+t+"() requires "+Ia(n,"argument")+", but was called with "+Ia(e.length,"argument")+".")}function aa(t,e,n){if(e.length<n)throw new Mi(Ui.INVALID_ARGUMENT,"Function "+t+"() requires at least "+Ia(n,"argument")+", but was called with "+Ia(e.length,"argument")+".")}function ha(t,e,n,i){if(e.length<n||e.length>i)throw new Mi(Ui.INVALID_ARGUMENT,"Function "+t+"() requires between "+n+" and "+i+" arguments, but was called with "+Ia(e.length,"argument")+".")}function ca(t,e,n,i){ya(t,e,Aa(n)+" argument",i)}function fa(t,e,n,i){void 0!==i&&ca(t,e,n,i)}function la(t,e,n,i){ya(t,e,n+" option",i)}function pa(t,e,n,i){void 0!==i&&la(t,e,n,i)}function da(t,e,n,i,a){void 0!==i&&function(t,e,n){for(var i=[],r=0,o=a;r<o.length;r++){var s=o[r];if(s===n)return;i.push(ga(s))}var u=ga(n);throw new Mi(Ui.INVALID_ARGUMENT,"Invalid value "+u+" provided to function "+t+'() for option "'+e+'". Acceptable values: '+i.join(", "))}(t,n,i)}function ya(t,e,n,i){if(!("object"===e?va(i):"non-empty string"===e?"string"==typeof i&&""!==i:typeof i===e)){var r=ga(i);throw new Mi(Ui.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" to be of type "+e+", but it was: "+r)}}function va(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function ga(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":yu();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function ma(t,e,n){if(void 0===n)throw new Mi(Ui.INVALID_ARGUMENT,"Function "+t+"() requires a valid "+Aa(e)+" argument, but it was undefined.")}function wa(n,t,i){br(t,function(t,e){if(i.indexOf(t)<0)throw new Mi(Ui.INVALID_ARGUMENT,"Unknown option '"+t+"' passed to function "+n+"(). Available options: "+i.join(", "))})}function ba(t,e,n,i){var r=ga(i);return new Mi(Ui.INVALID_ARGUMENT,"Function "+t+"() requires its "+Aa(n)+" argument to be a "+e+", but it was: "+r)}function Ea(t,e,n){if(n<=0)throw new Mi(Ui.INVALID_ARGUMENT,'Function "'+t+'()" requires its '+Aa(e)+" argument to be a positive number, but it was: "+n+".")}function Aa(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function Ia(t,e){return t+" "+e+(1===t?"":"s")}function Na(t,e){function n(){var t="This constructor is private.";throw e&&(t+=" ",t+=e),new Mi(Ui.INVALID_ARGUMENT,t)}return n.prototype=t.prototype,Object.assign(n,t),n}function Ta(){if("undefined"==typeof Uint8Array)throw new Mi(Ui.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function _a(){if(!uu.Ot().$o)throw new Mi(Ui.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}ta.Eo=3e8;var Sa=(La.fromBase64String=function(t){ua("Blob.fromBase64String",arguments,1),ca("Blob.fromBase64String","string",1,t),_a();try{return new La(Ar.fromBase64String(t))}catch(t){throw new Mi(Ui.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},La.fromUint8Array=function(t){if(ua("Blob.fromUint8Array",arguments,1),Ta(),!(t instanceof Uint8Array))throw ba("Blob.fromUint8Array","Uint8Array",1,t);return new La(Ar.fromUint8Array(t))},La.prototype.toBase64=function(){return ua("Blob.toBase64",arguments,0),_a(),this.ko.toBase64()},La.prototype.toUint8Array=function(){return ua("Blob.toUint8Array",arguments,0),Ta(),this.ko.toUint8Array()},La.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},La.prototype.isEqual=function(t){return this.ko.isEqual(t.ko)},La),Ra=Na(Sa,"Use Blob.fromUint8Array() or Blob.fromBase64String() instead."),ka=(Oa.documentId=function(){return Oa.Oo},Oa.prototype.isEqual=function(t){if(!(t instanceof Oa))throw ba("isEqual","FieldPath",1,t);return this.Lo.isEqual(t.Lo)},Oa);function Oa(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];!function(){if(!(t instanceof Array)||t.length<1)throw new Mi(Ui.INVALID_ARGUMENT,"Function FieldPath() requires its fieldNames argument to be an array with at least 1 element.")}();for(var n=0;n<t.length;++n)if(ca("FieldPath","string",n,t[n]),0===t[n].length)throw new Mi(Ui.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.Lo=new rr(t)}function La(t){_a(),this.ko=t}ka.Oo=new ka(rr.J().G());var Da,Va=new RegExp("[~\\*/\\[\\]]"),Ca=(Ma.delete=function(){return sa("FieldValue.delete",arguments),Pa.instance},Ma.serverTimestamp=function(){return sa("FieldValue.serverTimestamp",arguments),Fa.instance},Ma.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return aa("FieldValue.arrayUnion",arguments,1),new za(t)},Ma.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return aa("FieldValue.arrayRemove",arguments,1),new Ha(t)},Ma.increment=function(t){return ca("FieldValue.increment","number",1,t),ua("FieldValue.increment",arguments,1),new Ya(t)},Ma.prototype.isEqual=function(t){return this===t},Ma),Pa=(n(Ua,Da=Ca),Ua);function Ua(){return Da.call(this,"FieldValue.delete")||this}function Ma(t){this.Mo=t}Pa.instance=new Pa;var xa,Fa=(n(qa,xa=Ca),qa);function qa(){return xa.call(this,"FieldValue.serverTimestamp")||this}Fa.instance=new Fa;var Ga,ja,Ba,za=(n(ih,Ba=Ca),ih),Ha=(n(nh,ja=Ca),nh),Ya=(n(eh,Ga=Ca),eh),Qa=Na(Ca,"Use FieldValue.<field>() instead."),Wa=(Object.defineProperty(th.prototype,"latitude",{get:function(){return this.xo},enumerable:!0,configurable:!0}),Object.defineProperty(th.prototype,"longitude",{get:function(){return this.Uo},enumerable:!0,configurable:!0}),th.prototype.isEqual=function(t){return this.xo===t.xo&&this.Uo===t.Uo},th.prototype.g=function(t){return wu(this.xo,t.xo)||wu(this.Uo,t.Uo)},th),Xa=/^__.*__$/,Ka=(Ja.prototype.Qo=function(t,e){var n=[];return null!==this.se?n.push(new po(t,this.data,this.se,e)):n.push(new lo(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new yo(t,this.fieldTransforms)),n},Ja),$a=(Za.prototype.Qo=function(t,e){var n=[new po(t,this.data,this.se,e)];return 0<this.fieldTransforms.length&&n.push(new yo(t,this.fieldTransforms)),n},Za);function Za(t,e,n){this.data=t,this.se=e,this.fieldTransforms=n}function Ja(t,e,n){this.data=t,this.se=e,this.fieldTransforms=n}function th(t,e){if(ua("GeoPoint",arguments,2),ca("GeoPoint","number",1,t),ca("GeoPoint","number",2,e),!isFinite(t)||t<-90||90<t)throw new Mi(Ui.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new Mi(Ui.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.xo=t,this.Uo=e}function eh(t){var e=this;return(e=Ga.call(this,"FieldValue.increment")||this).Bo=t,e}function nh(t){var e=this;return(e=ja.call(this,"FieldValue.arrayRemove")||this).qo=t,e}function ih(t){var e=this;return(e=Ba.call(this,"FieldValue.arrayUnion")||this).qo=t,e}function rh(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw yu()}}var oh=(hh.prototype.Ko=function(t){var e=null==this.path?null:this.path.child(t),n=new hh(this.Wo,this.methodName,e,!1,this.fieldTransforms,this.se);return n.Ho(t),n},hh.prototype.zo=function(t){var e=null==this.path?null:this.path.child(t),n=new hh(this.Wo,this.methodName,e,!1,this.fieldTransforms,this.se);return n.Go(),n},hh.prototype.Yo=function(t){return new hh(this.Wo,this.methodName,null,!0,this.fieldTransforms,this.se)},hh.prototype.Xo=function(t){var e=null===this.path||this.path.B()?"":" (found in field "+this.path.toString()+")";return new Mi(Ui.INVALID_ARGUMENT,"Function "+this.methodName+"() called with invalid data. "+t+e)},hh.prototype.contains=function(e){return void 0!==this.se.find(function(t){return e.U(t)})||void 0!==this.fieldTransforms.find(function(t){return e.U(t.field)})},hh.prototype.Go=function(){if(null!==this.path)for(var t=0;t<this.path.length;t++)this.Ho(this.path.get(t))},hh.prototype.Ho=function(t){if(0===t.length)throw this.Xo("Document fields must not be empty");if(rh(this.Wo)&&Xa.test(t))throw this.Xo('Document fields cannot begin and end with "__"')},hh),sh=function(t,e){this.ci=t,this.key=e},uh=(ah.prototype.Zo=function(t,e){var n=new oh(0,t,rr.H);fh("Data must be an object, but it was:",n,e);var i=this.ta(e,n);return new Ka(new mo(i),null,n.fieldTransforms)},ah.prototype.ea=function(t,e,n){var i=new oh(2,t,rr.H);fh("Data must be an object, but it was:",i,e);var r,o,s=this.ta(e,i);if(n){for(var u=new yr(rr.$),a=0,h=n;a<h.length;a++){var c=h[a],f=void 0;if(c instanceof ka)f=c.Lo;else{if("string"!=typeof c)throw yu();f=ph(t,c)}if(!i.contains(f))throw new Mi(Ui.INVALID_ARGUMENT,"Field '"+f+"' is specified in your field mask but missing from your input data.");u=u.add(f)}r=to.Gt(u),o=i.fieldTransforms.filter(function(t){return r.Ht(t.field)})}else r=to.Kt(i.se),o=i.fieldTransforms;return new Ka(new mo(s),r,o)},ah.prototype.sa=function(o,t){var s=this,u=new oh(1,o,rr.H);fh("Data must be an object, but it was:",u,t);var a=new yr(rr.$),h=mo.le();br(t,function(t,e){var n=ph(o,t),i=u.zo(n);if((e=s.ia(e,i))instanceof Pa)a=a.add(n);else{var r=s.na(e,i);null!=r&&(a=a.add(n),h.set(n,r))}});var e=to.Gt(a);return new $a(h.he(),e,u.fieldTransforms)},ah.prototype.ra=function(t,e,n,i){var r=new oh(1,t,rr.H),o=[lh(t,e)],s=[n];if(i.length%2!=0)throw new Mi(Ui.INVALID_ARGUMENT,"Function "+t+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var u=0;u<i.length;u+=2)o.push(lh(t,i[u])),s.push(i[u+1]);for(var a=new yr(rr.$),h=mo.le(),c=0;c<o.length;++c){var f=o[c],l=r.zo(f),p=this.ia(s[c],l);if(p instanceof Pa)a=a.add(f);else{var d=this.na(p,l);null!=d&&(a=a.add(f),h.set(f,d))}}var y=to.Gt(a);return new $a(h.he(),y,r.fieldTransforms)},ah.prototype.ha=function(t,e,n){void 0===n&&(n=!1);var i=new oh(n?4:3,t,rr.H);return this.na(e,i)},ah.prototype.ia=function(t,e){try{return this.Jo(t)}catch(t){var n=dh(t);throw e.Xo(n)}},ah.prototype.na=function(t,e){if(ch(t=this.ia(t,e)))return fh("Unsupported field value:",e,t),this.ta(t,e);if(t instanceof Ca)return this.oa(t,e),null;if(e.path&&e.se.push(e.path),t instanceof Array){if(e.jo&&4!==e.Wo)throw e.Xo("Nested arrays are not supported");return this.aa(t,e)}return this.ua(t,e)},ah.prototype.ta=function(t,i){var r=this,o={};return Er(t)?i.path&&0<i.path.length&&i.se.push(i.path):br(t,function(t,e){var n=r.na(e,i.Ko(t));null!=n&&(o[t]=n)}),{mapValue:{fields:o}}},ah.prototype.aa=function(t,e){for(var n=[],i=0,r=0,o=t;r<o.length;r++){var s=o[r],u=this.na(s,e.Yo(i));null==u&&(u={nullValue:"NULL_VALUE"}),n.push(u),i++}return{arrayValue:{values:n}}},ah.prototype.oa=function(t,e){if(!rh(e.Wo))throw e.Xo(t.Mo+"() can only be used with update() and set()");if(null===e.path)throw e.Xo(t.Mo+"() is not currently supported inside arrays");if(t instanceof Pa){if(2!==e.Wo)throw 1===e.Wo?e.Xo("FieldValue.delete() can only appear at the top level of your update data"):e.Xo("FieldValue.delete() cannot be used with set() unless you pass {merge:true}");e.se.push(e.path)}else if(t instanceof Fa)e.fieldTransforms.push(new eo(e.path,zr.instance));else if(t instanceof za){var n=this.ca(t.Mo,t.qo),i=new Yr(n);e.fieldTransforms.push(new eo(e.path,i))}else if(t instanceof Ha){var r=this.ca(t.Mo,t.qo),o=new Qr(r);e.fieldTransforms.push(new eo(e.path,o))}else if(t instanceof Ya){var s=this.ha("FieldValue.increment",t.Bo),u=new Wr(this.serializer,s);e.fieldTransforms.push(new eo(e.path,u))}else yu()},ah.prototype.ua=function(t,e){if(null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return this.serializer.wi(t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=ji.fromDate(t);return{timestampValue:this.serializer.F(n)}}if(t instanceof ji){var i=new ji(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:this.serializer.F(i)}}if(t instanceof Wa)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Sa)return{bytesValue:this.serializer.Ti(t)};if(t instanceof sh)return{referenceValue:this.serializer.Ii(t.key.path,t.ci)};throw e.Xo("Unsupported field value: "+ga(t))},ah.prototype.ca=function(i,t){var r=this;return t.map(function(t,e){var n=new oh(3,i,rr.H);return r.na(t,n.Yo(e))})},ah);function ah(t,e){this.serializer=t,this.Jo=e}function hh(t,e,n,i,r,o){this.Wo=t,this.methodName=e,this.path=n,this.jo=i,void 0===r&&this.Go(),this.jo=void 0!==i&&i,this.fieldTransforms=r||[],this.se=o||[]}function ch(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof ji||t instanceof Wa||t instanceof Sa||t instanceof sh||t instanceof Ca)}function fh(t,e,n){if(!ch(n)||!va(n)){var i=ga(n);throw"an object"===i?e.Xo(t+" a custom object"):e.Xo(t+" "+i)}}function lh(t,e){if(e instanceof ka)return e.Lo;if("string"==typeof e)return ph(t,e);throw new Mi(Ui.INVALID_ARGUMENT,"Function "+t+"() called with invalid data. Field path arguments must be of type string or FieldPath.")}function ph(t,e){try{return function(e){if(0<=e.search(Va))throw new Mi(Ui.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(ka.bind.apply(ka,r([void 0],e.split("."))))}catch(t){throw new Mi(Ui.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e).Lo}catch(e){var n=dh(e);throw new Mi(Ui.INVALID_ARGUMENT,"Function "+t+"() called with invalid data. "+n)}}function dh(t){return t instanceof Error?t.message:t.toString()}function yh(t){this.key=t}function vh(t){this.key=t}function gh(t,e,n){this.query=t,this.targetId=e,this.view=n}function mh(t){this.key=t,this.Lc=!1}function wh(){this.fl=null,this.targetId=0,this.dl=[]}var bh,Eh,Ah,Ih=(nc.prototype.Ta=function(){return 1===this.state||2===this.state||4===this.state},nc.prototype.Ea=function(){return 2===this.state},nc.prototype.start=function(){3!==this.state?this.auth():this.Ia()},nc.prototype.stop=function(){return c(this,void 0,void 0,function(){return f(this,function(t){switch(t.label){case 0:return this.Ta()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},nc.prototype.ma=function(){this.state=0,this.zr.reset()},nc.prototype.Ra=function(){var t=this;this.Ea()&&null===this.wa&&(this.wa=this.Ar.Fr(this.la,6e4,function(){return t.Aa()}))},nc.prototype.Pa=function(t){this.Va(),this.stream.send(t)},nc.prototype.Aa=function(){return c(this,void 0,void 0,function(){return f(this,function(t){return this.Ea()?[2,this.close(0)]:[2]})})},nc.prototype.Va=function(){this.wa&&(this.wa.cancel(),this.wa=null)},nc.prototype.close=function(e,n){return c(this,void 0,void 0,function(){return f(this,function(t){switch(t.label){case 0:return this.Va(),this.zr.cancel(),this.da++,3!==e?this.zr.reset():n&&n.code===Ui.RESOURCE_EXHAUSTED?(pu(n.toString()),pu("Using maximum backoff delay to prevent overloading the backend."),this.zr.Sr()):n&&n.code===Ui.UNAUTHENTICATED&&this.fa.l(),null!==this.stream&&(this.pa(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.ga(n)];case 1:return t.sent(),[2]}})})},nc.prototype.pa=function(){},nc.prototype.auth=function(){var n=this;this.state=1;var t=this.ya(this.da),e=this.da;this.fa.getToken().then(function(t){n.da===e&&n.ba(t)},function(e){t(function(){var t=new Mi(Ui.UNKNOWN,"Fetching auth token failed: "+e.message);return n.va(t)})})},nc.prototype.ba=function(t){var e=this,n=this.ya(this.da);this.stream=this.Sa(t),this.stream.Da(function(){n(function(){return e.state=2,e.listener.Da()})}),this.stream.ga(function(t){n(function(){return e.va(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},nc.prototype.Ia=function(){var t=this;this.state=4,this.zr.Dr(function(){return c(t,void 0,void 0,function(){return f(this,function(t){return this.state=0,this.start(),[2]})})})},nc.prototype.va=function(t){return lu("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},nc.prototype.ya=function(e){var n=this;return function(t){n.Ar.xr(function(){return n.da===e?t():(lu("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},nc),Nh=(n(ec,Eh=Ih),ec.prototype.Sa=function(t){return this._a.Ca("Listen",t)},ec.prototype.onMessage=function(t){this.zr.reset();var e=this.serializer.Fi(t),n=this.serializer.$i(t);return this.listener.Fa(e,n)},ec.prototype.Na=function(t){var e={};e.database=this.serializer.gi,e.addTarget=this.serializer.qe(t);var n=this.serializer.en(t);n&&(e.labels=n),this.Pa(e)},ec.prototype.$a=function(t){var e={};e.database=this.serializer.gi,e.removeTarget=t,this.Pa(e)},ec),Th=(n(tc,bh=Ih),Object.defineProperty(tc.prototype,"La",{get:function(){return this.ka},enumerable:!0,configurable:!0}),tc.prototype.start=function(){this.ka=!1,bh.prototype.start.call(this)},tc.prototype.pa=function(){this.ka&&this.Oa([])},tc.prototype.Sa=function(t){return this._a.Ca("Write",t)},tc.prototype.onMessage=function(t){if(vu(!!t.streamToken),this.lastStreamToken=this.serializer.Ei(t.streamToken),this.ka){this.zr.reset();var e=this.serializer.Wi(t.writeResults,t.commitTime),n=this.serializer.fromVersion(t.commitTime);return this.listener.Ma(n,e)}return vu(!t.writeResults||0===t.writeResults.length),this.ka=!0,this.listener.qa()},tc.prototype.Ba=function(){var t={};t.database=this.serializer.gi,this.Pa(t)},tc.prototype.Oa=function(t){var e=this,n={streamToken:this.serializer.Ti(this.lastStreamToken),writes:t.map(function(t){return e.serializer.ki(t)})};this.Pa(n)},tc),_h=(Jh.prototype.xa=function(t){return new Th(this.Ar,this._a,this.credentials,this.serializer,t)},Jh.prototype.Ua=function(t){return new Nh(this.Ar,this._a,this.credentials,this.serializer,t)},Jh.prototype.commit=function(t){var e=this,n={database:this.serializer.gi,writes:t.map(function(t){return e.serializer.ki(t)})};return this.Qa("Commit",n).then(function(t){return e.serializer.Wi(t.writeResults,t.commitTime)})},Jh.prototype.Wa=function(e){var r=this,t={database:this.serializer.gi,documents:e.map(function(t){return r.serializer.Ai(t)})};return this.ja("BatchGetDocuments",t).then(function(t){var n=Ts();t.forEach(function(t){var e=r.serializer.Ci(t);n=n.nt(e.key,e)});var i=[];return e.forEach(function(t){var e=n.get(t);vu(!!e),i.push(e)}),i})},Jh.prototype.Qa=function(e,n){var i=this;return this.credentials.getToken().then(function(t){return i._a.Qa(e,n,t)}).catch(function(t){throw t.code===Ui.UNAUTHENTICATED&&i.credentials.l(),t})},Jh.prototype.ja=function(e,n){var i=this;return this.credentials.getToken().then(function(t){return i._a.ja(e,n,t)}).catch(function(t){throw t.code===Ui.UNAUTHENTICATED&&i.credentials.l(),t})},Jh),Sh=(Zh.prototype.Wa=function(i){return c(this,void 0,void 0,function(){var e,n=this;return f(this,function(t){switch(t.label){case 0:if(this.Xa(),0<this.mutations.length)throw new Mi(Ui.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,this.Ga.Wa(i)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof Do||t instanceof Lo?n.Ja(t):yu()}),e)]}})})},Zh.prototype.set=function(t,e){this.write(e.Qo(t,this.Zt(t))),this.Ya.add(t)},Zh.prototype.update=function(t,e){try{this.write(e.Qo(t,this.Za(t)))}catch(t){this.za=t}this.Ya.add(t)},Zh.prototype.delete=function(t){this.write([new vo(t,this.Zt(t))]),this.Ya.add(t)},Zh.prototype.commit=function(){return c(this,void 0,void 0,function(){var e,n=this;return f(this,function(t){switch(t.label){case 0:if(this.Xa(),this.za)throw this.za;return e=this.Ka,this.mutations.forEach(function(t){e=e.remove(t.key)}),e.forEach(function(t,e){n.mutations.push(new go(t,n.Zt(t)))}),[4,this.Ga.commit(this.mutations)];case 1:return t.sent(),this.Ha=!0,[2]}})})},Zh.prototype.Ja=function(t){var e;if(t instanceof Lo)e=t.version;else{if(!(t instanceof Do))throw yu();e=Bi.S()}var n=this.Ka.get(t.key);if(null!==n){if(!e.isEqual(n))throw new Mi(Ui.ABORTED,"Document version changed between two reads.")}else this.Ka=this.Ka.nt(t.key,e)},Zh.prototype.Zt=function(t){var e=this.Ka.get(t);return!this.Ya.has(t)&&e?no.updateTime(e):no.NONE},Zh.prototype.Za=function(t){var e=this.Ka.get(t);if(this.Ya.has(t)||!e)return no.exists(!0);if(e.isEqual(Bi.S()))throw new Mi(Ui.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return no.updateTime(e)},Zh.prototype.write=function(t){this.Xa(),this.mutations=this.mutations.concat(t)},Zh.prototype.Xa=function(){},Zh),Rh=($h.prototype.nu=function(){var t=this;0===this.eu&&(this.ru("Unknown"),this.su=this.Nr.Fr("online_state_timeout",1e4,function(){return t.su=null,t.hu("Backend didn't respond within 10 seconds."),t.ru("Offline"),Promise.resolve()}))},$h.prototype.ou=function(t){"Online"===this.state?this.ru("Unknown"):(this.eu++,1<=this.eu&&(this.au(),this.hu("Connection failed 1 times. Most recent error: "+t.toString()),this.ru("Offline")))},$h.prototype.set=function(t){this.au(),this.eu=0,"Online"===t&&(this.iu=!1),this.ru(t)},$h.prototype.ru=function(t){t!==this.state&&(this.state=t,this.tu(t))},$h.prototype.hu=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.iu?(pu(e),this.iu=!1):lu("OnlineStateTracker",e)},$h.prototype.au=function(){null!==this.su&&(this.su.cancel(),this.su=null)},$h),kh=(Kh.prototype.start=function(){return this.enableNetwork()},Kh.prototype.enableNetwork=function(){return c(this,void 0,void 0,function(){var e;return f(this,function(t){switch(t.label){case 0:return this.networkEnabled=!0,this.wu()?(e=this.Pu,[4,this.uu.no()]):[3,3];case 1:return e.lastStreamToken=t.sent(),this.yu()?this.bu():this.Eu.set("Unknown"),[4,this.vu()];case 2:t.sent(),t.label=3;case 3:return[2]}})})},Kh.prototype.disableNetwork=function(){return c(this,void 0,void 0,function(){return f(this,function(t){switch(t.label){case 0:return this.networkEnabled=!1,[4,this.Su()];case 1:return t.sent(),this.Eu.set("Offline"),[2]}})})},Kh.prototype.Su=function(){return c(this,void 0,void 0,function(){return f(this,function(t){switch(t.label){case 0:return[4,this.Pu.stop()];case 1:return t.sent(),[4,this.Iu.stop()];case 2:return t.sent(),0<this.cu.length&&(lu("RemoteStore","Stopping write stream with "+this.cu.length+" pending writes"),this.cu=[]),this.Du(),[2]}})})},Kh.prototype.Cu=function(){return c(this,void 0,void 0,function(){return f(this,function(t){switch(t.label){case 0:return lu("RemoteStore","RemoteStore shutting down."),this.networkEnabled=!1,[4,this.Su()];case 1:return t.sent(),this.fu.Cu(),this.Eu.set("Unknown"),[2]}})})},Kh.prototype.listen=function(t){this.lu.has(t.targetId)||(this.lu.set(t.targetId,t),this.yu()?this.bu():this.Iu.Ea()&&this.Fu(t))},Kh.prototype.Nu=function(t){this.lu.delete(t),this.Iu.Ea()&&this.$u(t),0===this.lu.size&&(this.Iu.Ea()?this.Iu.Ra():this.wu()&&this.Eu.set("Unknown"))},Kh.prototype.ui=function(t){return this.lu.get(t)||null},Kh.prototype.ai=function(t){return this.ku.ai(t)},Kh.prototype.Fu=function(t){this._u.Bs(t.targetId),this.Iu.Na(t)},Kh.prototype.$u=function(t){this._u.Bs(t),this.Iu.$a(t)},Kh.prototype.bu=function(){this._u=new zs(this),this.Iu.start(),this.Eu.nu()},Kh.prototype.yu=function(){return this.wu()&&!this.Iu.Ta()&&0<this.lu.size},Kh.prototype.wu=function(){return this.isPrimary&&this.networkEnabled},Kh.prototype.Du=function(){this._u=null},Kh.prototype.mu=function(){return c(this,void 0,void 0,function(){var n=this;return f(this,function(t){return this.lu.forEach(function(t,e){n.Fu(t)}),[2]})})},Kh.prototype.Ru=function(e){return c(this,void 0,void 0,function(){return f(this,function(t){return this.Du(),this.yu()?(this.Eu.ou(e),this.bu()):this.Eu.set("Unknown"),[2]})})},Kh.prototype.Au=function(n,i){return c(this,void 0,void 0,function(){var e;return f(this,function(t){switch(t.label){case 0:return this.Eu.set("Online"),n instanceof Ms&&2===n.state&&n.cause?[2,this.Lu(n)]:(n instanceof Ps?this._u.Hs(n):n instanceof Us?this._u.si(n):this._u.Xs(n),i.isEqual(Bi.MIN)?[3,4]:[4,this.uu.ho()]);case 1:return e=t.sent(),0<=i.D(e)?[4,this.Ou(i)]:[3,3];case 2:t.sent(),t.label=3;case 3:t.label=4;case 4:return[2]}})})},Kh.prototype.Ou=function(i){var r=this,t=this._u.ri(i);return t.ws.forEach(function(t,e){if(0<t.resumeToken.Mt()){var n=r.lu.get(e);n&&r.lu.set(e,n.ss(t.resumeToken,i))}}),t.Ts.forEach(function(t){var e=r.lu.get(t);if(e){r.lu.set(t,e.ss(Ar.qt,e.ts)),r.$u(t);var n=new ms(e.target,t,1,e.sequenceNumber);r.Fu(n)}}),this.ku.oo(t)},Kh.prototype.Lu=function(t){var n=this,i=t.cause,r=Promise.resolve();return t.targetIds.forEach(function(e){r=r.then(function(){return c(n,void 0,void 0,function(){return f(this,function(t){return this.lu.has(e)?[2,(this.lu.delete(e),this._u.removeTarget(e),this.ku.Mu(e,i))]:[2]})})})}),r},Kh.prototype.vu=function(){return c(this,void 0,void 0,function(){var e,n;return f(this,function(t){switch(t.label){case 0:return this.qu()?(e=0<this.cu.length?this.cu[this.cu.length-1].batchId:-1,[4,this.uu.mo(e)]):[3,5];case 1:return null!==(n=t.sent())?[3,2]:(0===this.cu.length&&this.Pu.Ra(),[3,4]);case 2:return this.Bu(n),[4,this.vu()];case 3:t.sent(),t.label=4;case 4:t.label=5;case 5:return this.xu()&&this.Uu(),[2]}})})},Kh.prototype.qu=function(){return this.wu()&&this.cu.length<10},Kh.prototype.Qu=function(){return this.cu.length},Kh.prototype.Bu=function(t){this.cu.push(t),this.Pu.Ea()&&this.Pu.La&&this.Pu.Oa(t.mutations)},Kh.prototype.xu=function(){return this.wu()&&!this.Pu.Ta()&&0<this.cu.length},Kh.prototype.Uu=function(){this.Pu.start()},Kh.prototype.Vu=function(){return c(this,void 0,void 0,function(){return f(this,function(t){return this.Pu.Ba(),[2]})})},Kh.prototype.gu=function(){var i=this;return this.uu.ro(this.Pu.lastStreamToken).then(function(){for(var t=0,e=i.cu;t<e.length;t++){var n=e[t];i.Pu.Oa(n.mutations)}}).catch(oa)},Kh.prototype.Ma=function(t,e){var n=this,i=this.cu.shift(),r=Tu.from(i,t,e,this.Pu.lastStreamToken);return this.ku.Wu(r).then(function(){return n.vu()})},Kh.prototype.pu=function(n){return c(this,void 0,void 0,function(){var e=this;return f(this,function(t){return n&&0<this.cu.length?[2,(this.Pu.La?this.ju(n):this.Gu(n)).then(function(){e.xu()&&e.Uu()})]:[2]})})},Kh.prototype.Gu=function(e){return c(this,void 0,void 0,function(){return f(this,function(t){return As(e.code)?[2,(lu("RemoteStore","RemoteStore error before completed handshake; resetting stream token: ",this.Pu.lastStreamToken),this.Pu.lastStreamToken=Ar.qt,this.uu.ro(Ar.qt).catch(oa))]:[2]})})},Kh.prototype.ju=function(r){return c(this,void 0,void 0,function(){var e,n,i=this;return f(this,function(t){return As(n=r.code)&&n!==Ui.ABORTED?(e=this.cu.shift(),[2,(this.Pu.ma(),this.ku.Ku(e.batchId,r).then(function(){return i.vu()}))]):[2]})})},Kh.prototype.Hu=function(){return new Sh(this.Ga)},Kh.prototype.Tu=function(){return c(this,void 0,void 0,function(){return f(this,function(t){switch(t.label){case 0:return this.networkEnabled=!1,[4,this.Su()];case 1:return t.sent(),this.Eu.set("Unknown"),[4,this.enableNetwork()];case 2:return t.sent(),[2]}})})},Kh.prototype.zu=function(){return c(this,void 0,void 0,function(){return f(this,function(t){switch(t.label){case 0:return this.wu()?(lu("RemoteStore","RemoteStore restarting streams for new credential"),[4,this.Tu()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},Kh.prototype.Yu=function(e){return c(this,void 0,void 0,function(){return f(this,function(t){switch(t.label){case 0:return(this.isPrimary=e)&&this.networkEnabled?[4,this.enableNetwork()]:[3,2];case 1:return t.sent(),[3,5];case 2:return e?[3,4]:[4,this.Su()];case 3:t.sent(),this.Eu.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})},Kh),Oh=(Xh.prototype.Xu=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},Xh.prototype.Ju=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},Xh.prototype.Zu=function(){var t={activeTargetIds:this.activeTargetIds.j(),updateTimeMs:Date.now()};return JSON.stringify(t)},Xh),Lh=(Wh.prototype.sc=function(t){},Wh.prototype.ic=function(t,e,n){},Wh.prototype.nc=function(t){return this.tc.Xu(t),this.ec[t]||"not-current"},Wh.prototype.rc=function(t,e,n){this.ec[t]=e},Wh.prototype.hc=function(t){this.tc.Ju(t)},Wh.prototype.oc=function(t){return this.tc.activeTargetIds.has(t)},Wh.prototype.ac=function(t){delete this.ec[t]},Wh.prototype.uc=function(){return this.tc.activeTargetIds},Wh.prototype.cc=function(t){return this.tc.activeTargetIds.has(t)},Wh.prototype.start=function(){return this.tc=new Oh,Promise.resolve()},Wh.prototype.xh=function(t,e,n){},Wh.prototype.lc=function(t){},Wh.prototype.Cu=function(){},Wh.prototype.mr=function(t){},Wh),Dh=(Object.defineProperty(Qh.prototype,"Tc",{get:function(){return this._c},enumerable:!0,configurable:!0}),Qh.prototype.Ec=function(t,e){var u=this,a=e?e.Ic:new Fs,h=e?e.wc:this.wc,c=e?e.ls:this.ls,f=h,l=!1,p=this.query.je()&&h.size===this.query.limit?h.last():null,d=this.query.Ge()&&h.size===this.query.limit?h.first():null;if(t.ut(function(t,e){var n=h.get(t),i=e instanceof Lo?e:null;i=i&&(u.query.matches(i)?i:null);var r=!!n&&u.ls.has(n.key),o=!!i&&(i.te||u.ls.has(i.key)&&i.hasCommittedMutations),s=!1;n&&i?n.data().isEqual(i.data())?r!==o&&(a.track({type:3,doc:i}),s=!0):u.mc(n,i)||(a.track({type:2,doc:i}),s=!0,(p&&0<u.query.Be(i,p)||d&&u.query.Be(i,d)<0)&&(l=!0)):!n&&i?(a.track({type:0,doc:i}),s=!0):n&&!i&&(a.track({type:1,doc:n}),s=!0,(p||d)&&(l=!0)),s&&(c=i?(f=f.add(i),o?c.add(t):c.delete(t)):(f=f.delete(t),c.delete(t)))}),this.query.je()||this.query.Ge())for(;f.size>this.query.limit;){var n=this.query.je()?f.last():f.first();f=f.delete(n.key),c=c.delete(n.key),a.track({type:1,doc:n})}return{wc:f,Ic:a,Rc:l,ls:c}},Qh.prototype.mc=function(t,e){return t.te&&e.hasCommittedMutations&&!e.te},Qh.prototype.Ac=function(t,e,n){var o=this,i=this.wc;this.wc=t.wc,this.ls=t.ls;var r=t.Ic.us();r.sort(function(t,e){return i=t.type,r=e.type,n(i)-n(r)||o.query.Be(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return yu()}}var i,r}),this.Pc(n);var s=e?this.Vc():[],u=0===this.dc.size&&this.As?1:0,a=u!==this.fc;return this.fc=u,0!==r.length||a?{snapshot:new qs(this.query,t.wc,i,r,t.ls,0==u,a,!1),pc:s}:{pc:s}},Qh.prototype.gc=function(t){return this.As&&"Offline"===t?(this.As=!1,this.Ac({wc:this.wc,Ic:new Fs,ls:this.ls,Rc:!1},!1)):{pc:[]}},Qh.prototype.yc=function(t){return!this._c.has(t)&&!!this.wc.has(t)&&!this.wc.get(t).te},Qh.prototype.Pc=function(t){var e=this;t&&(t.Ps.forEach(function(t){return e._c=e._c.add(t)}),t.Vs.forEach(function(t){}),t.ps.forEach(function(t){return e._c=e._c.delete(t)}),this.As=t.As)},Qh.prototype.Vc=function(){var e=this;if(!this.As)return[];var n=this.dc;this.dc=Ds(),this.wc.forEach(function(t){e.yc(t.key)&&(e.dc=e.dc.add(t.key))});var i=[];return n.forEach(function(t){e.dc.has(t)||i.push(new vh(t))}),this.dc.forEach(function(t){n.has(t)||i.push(new yh(t))}),i},Qh.prototype.bc=function(t){this._c=t.Do,this.dc=Ds();var e=this.Ec(t.documents);return this.Ac(e,!0)},Qh.prototype.vc=function(){return qs.ds(this.query,this.wc,this.ls,0===this.fc)},Qh),Vh=(Yh.prototype.Cc=function(){this.Fc()},Yh.prototype.Fc=function(){var t=this;this.zr.Dr(function(){return c(t,void 0,void 0,function(){var e,n,i=this;return f(this,function(t){return e=this.Sc.Hu(),(n=this.Nc(e))&&n.then(function(t){i.Nr.xr(function(){return e.commit().then(function(){i.Lr.resolve(t)}).catch(function(t){i.$c(t)})})}).catch(function(t){i.$c(t)}),[2]})})})},Yh.prototype.Nc=function(t){try{var e=this.updateFunction(t);return!Nr(e)&&e.catch&&e.then?e:(this.Lr.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.Lr.reject(t),null}},Yh.prototype.$c=function(t){var e=this;0<this.Dc&&this.kc(t)?(--this.Dc,this.Nr.xr(function(){return e.Fc(),Promise.resolve()})):this.Lr.reject(t)},Yh.prototype.kc=function(t){if("FirebaseError"!==t.name)return!1;var e=t.code;return"aborted"===e||"failed-precondition"===e||!As(e)},Yh),Ch=(Object.defineProperty(Hh.prototype,"zc",{get:function(){return!0},enumerable:!0,configurable:!0}),Hh.prototype.subscribe=function(t){this.qc=t},Hh.prototype.listen=function(s){return c(this,void 0,void 0,function(){var e,n,i,r,o;return f(this,function(t){switch(t.label){case 0:return this.Yc("listen()"),(i=this.Bc.get(s))?(e=i.targetId,this.Oc.nc(e),n=i.view.vc(),[3,4]):[3,1];case 1:return[4,this.uu.Po(s.qe())];case 2:return r=t.sent(),o=this.Oc.nc(r.targetId),e=r.targetId,[4,this.Xc(s,e,"current"===o)];case 3:n=t.sent(),this.zc&&this.Sc.listen(r),t.label=4;case 4:return[2,(this.qc.Fa([n]),e)]}})})},Hh.prototype.Xc=function(u,a,h){return c(this,void 0,void 0,function(){var e,n,i,r,o,s;return f(this,function(t){switch(t.label){case 0:return[4,this.uu.vo(u,!0)];case 1:return e=t.sent(),n=new Dh(u,e.Do),i=n.Ec(e.documents),r=js.Rs(a,h&&"Offline"!==this.onlineState),o=n.Ac(i,this.zc,r),this.Jc(a,o.pc),s=new gh(u,a,n),[2,(this.Bc.set(u,s),this.xc.has(a)?this.xc.get(a).push(u):this.xc.set(a,[u]),o.snapshot)]}})})},Hh.prototype.Nu=function(r){return c(this,void 0,void 0,function(){var e,n,i=this;return f(this,function(t){switch(t.label){case 0:return this.Yc("unlisten()"),e=this.Bc.get(r),1<(n=this.xc.get(e.targetId)).length?[2,(this.xc.set(e.targetId,n.filter(function(t){return!t.isEqual(r)})),void this.Bc.delete(r))]:this.zc?(this.Oc.hc(e.targetId),this.Oc.cc(e.targetId)?[3,2]:[4,this.uu.bo(e.targetId,!1).then(function(){i.Oc.ac(e.targetId),i.Sc.Nu(e.targetId),i.Zc(e.targetId)}).catch(oa)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return this.Zc(e.targetId),[4,this.uu.bo(e.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})},Hh.prototype.write=function(i,r){return c(this,void 0,void 0,function(){var e,n;return f(this,function(t){switch(t.label){case 0:this.Yc("write()"),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.uu.Gh(i)];case 2:return e=t.sent(),[3,4];case 3:if("IndexedDbTransactionError"===(n=t.sent()).name)return[2,(pu("SyncEngine","Dropping write that cannot be persisted: "+n),void r.reject(new Mi(Ui.UNAVAILABLE,"Failed to persist write: "+n)))];throw n;case 4:return this.Oc.sc(e.batchId),this.tl(e.batchId,r),[4,this.el(e.Hh)];case 5:return t.sent(),[4,this.Sc.vu()];case 6:return t.sent(),[2]}})})},Hh.prototype.runTransaction=function(t,e,n){new Vh(t,this.Sc,e,n).Cc()},Hh.prototype.oo=function(n){return c(this,void 0,void 0,function(){var e,i=this;return f(this,function(t){switch(t.label){case 0:this.Yc("applyRemoteEvent()"),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.uu.oo(n)];case 2:return e=t.sent(),n.ws.forEach(function(t,e){var n=i.Wc.get(e);n&&(vu(t.Ps.size+t.Vs.size+t.ps.size<=1),0<t.Ps.size?n.Lc=!0:0<t.Vs.size?vu(n.Lc):0<t.ps.size&&(vu(n.Lc),n.Lc=!1))}),[4,this.el(e,n)];case 3:return t.sent(),[3,6];case 4:return[4,oa(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},Hh.prototype.gc=function(i,t){this.Yc("applyOnlineStateChange()");var r=[];this.Bc.forEach(function(t,e){var n=e.view.gc(i);n.snapshot&&r.push(n.snapshot)}),this.qc.sl(i),this.qc.Fa(r),this.onlineState=i},Hh.prototype.Mu=function(u,a){return c(this,void 0,void 0,function(){var e,n,i,r,o,s=this;return f(this,function(t){switch(t.label){case 0:return this.Yc("rejectListens()"),this.Oc.rc(u,"rejected",a),e=this.Wc.get(u),(n=e&&e.key)?(this.Qc=this.Qc.remove(n),this.Wc.delete(u),this.il(),i=(i=new ar(sr.$)).nt(n,new Do(n,Bi.S())),r=Ds().add(n),o=new Gs(Bi.MIN,new Map,new yr(wu),i,r),[2,this.oo(o)]):[4,this.uu.bo(u,!1).then(function(){return s.Zc(u,a)}).catch(oa)];case 1:return t.sent(),[2]}})})},Hh.prototype.Wu=function(i){return c(this,void 0,void 0,function(){var e,n;return f(this,function(t){switch(t.label){case 0:this.Yc("applySuccessfulWrite()"),e=i.batch.batchId,this.nl(e,null),this.rl(e),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.uu.zh(i)];case 2:return n=t.sent(),this.Oc.ic(e,"acknowledged"),[4,this.el(n)];case 3:return t.sent(),[3,6];case 4:return[4,oa(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},Hh.prototype.Ku=function(n,i){return c(this,void 0,void 0,function(){var e;return f(this,function(t){switch(t.label){case 0:this.Yc("rejectFailedWrite()"),this.nl(n,i),this.rl(n),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.uu.to(n)];case 2:return e=t.sent(),this.Oc.ic(n,"rejected",i),[4,this.el(e)];case 3:return t.sent(),[3,6];case 4:return[4,oa(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},Hh.prototype.hl=function(i){return c(this,void 0,void 0,function(){var e,n;return f(this,function(t){switch(t.label){case 0:return this.Sc.wu()||lu("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),[4,this.uu.io()];case 1:return-1===(e=t.sent())?[2,void i.resolve()]:((n=this.Kc.get(e)||[]).push(i),this.Kc.set(e,n),[2])}})})},Hh.prototype.rl=function(t){(this.Kc.get(t)||[]).forEach(function(t){t.resolve()}),this.Kc.delete(t)},Hh.prototype.ol=function(e){this.Kc.forEach(function(t){t.forEach(function(t){t.reject(new Mi(Ui.CANCELLED,e))})}),this.Kc.clear()},Hh.prototype.tl=function(t,e){var n=this.Gc[this.currentUser.s()];n=(n=n||new ar(wu)).nt(t,e),this.Gc[this.currentUser.s()]=n},Hh.prototype.nl=function(t,e){var n=this.Gc[this.currentUser.s()];if(n){var i=n.get(t);i&&(e?i.reject(e):i.resolve(),n=n.remove(t)),this.Gc[this.currentUser.s()]=n}},Hh.prototype.Zc=function(t,e){var n=this;void 0===e&&(e=null),this.Oc.hc(t);for(var i=0,r=this.xc.get(t);i<r.length;i++){var o=r[i];this.Bc.delete(o),e&&this.qc.al(o,e)}if(this.xc.delete(t),this.zc){var s=this.jc.kn(t);this.jc.Nn(t),s.forEach(function(t){n.jc.Ln(t)||n.ul(t)})}},Hh.prototype.ul=function(t){var e=this.Qc.get(t);null!==e&&(this.Sc.Nu(e),this.Qc=this.Qc.remove(t),this.Wc.delete(e),this.il())},Hh.prototype.Jc=function(t,e){for(var n=0,i=e;n<i.length;n++){var r=i[n];r instanceof yh?(this.jc.vn(r.key,t),this.cl(r)):r instanceof vh?(lu("SyncEngine","Document no longer in limbo: "+r.key),this.jc.Dn(r.key,t),this.jc.Ln(r.key)||this.ul(r.key)):yu()}},Hh.prototype.cl=function(t){var e=t.key;this.Qc.get(e)||(lu("SyncEngine","New document in limbo: "+e),this.Uc.push(e),this.il())},Hh.prototype.il=function(){for(;0<this.Uc.length&&this.Qc.size<this.Mc;){var t=this.Uc.shift(),e=this.Hc.next();this.Wc.set(e,new mh(t)),this.Qc=this.Qc.nt(t,e),this.Sc.listen(new ms(Po.ve(t.path).qe(),e,2,Lu.Rr))}},Hh.prototype.ll=function(){return this.Qc},Hh.prototype._l=function(){return this.Uc},Hh.prototype.el=function(i,a){return c(this,void 0,void 0,function(){var o,s,e,u=this;return f(this,function(t){switch(t.label){case 0:return o=[],s=[],e=[],this.Bc.forEach(function(t,r){e.push(Promise.resolve().then(function(){var n=r.view.Ec(i);return n.Rc?u.uu.vo(r.query,!1).then(function(t){var e=t.documents;return r.view.Ec(e,n)}):n}).then(function(t){var e=a&&a.ws.get(r.targetId),n=r.view.Ac(t,u.zc,e);if(u.Jc(r.targetId,n.pc),n.snapshot){u.zc&&u.Oc.rc(r.targetId,n.snapshot.fromCache?"not-current":"current"),o.push(n.snapshot);var i=Ou.wr(r.targetId,n.snapshot);s.push(i)}}))}),[4,Promise.all(e)];case 1:return t.sent(),this.qc.Fa(o),[4,this.uu.Io(s)];case 2:return t.sent(),[2]}})})},Hh.prototype.Yc=function(t){},Hh.prototype.zu=function(i){return c(this,void 0,void 0,function(){var e,n;return f(this,function(t){switch(t.label){case 0:return e=!this.currentUser.isEqual(i),this.currentUser=i,e?(this.ol("'waitForPendingWrites' promise is rejected due to a user change."),[4,this.uu.xh(i)]):[3,3];case 1:return n=t.sent(),this.Oc.xh(i,n.Wh,n.jh),[4,this.el(n.Qh)];case 2:t.sent(),t.label=3;case 3:return[4,this.Sc.zu()];case 4:return t.sent(),[2]}})})},Hh.prototype.enableNetwork=function(){return this.Sc.enableNetwork()},Hh.prototype.disableNetwork=function(){return this.Sc.disableNetwork()},Hh.prototype.ai=function(t){var e=this.Wc.get(t);if(e&&e.Lc)return Ds().add(e.key);var n=Ds(),i=this.xc.get(t);if(!i)return n;for(var r=0,o=i;r<o.length;r++){var s=o[r],u=this.Bc.get(s);n=n.$t(u.view.Tc)}return n},Hh),Ph=(zh.prototype.listen=function(t){var e=t.query,n=!1,i=this.wl.get(e);return i||(n=!0,i=new wh,this.wl.set(e,i)),i.dl.push(t),t.gc(this.onlineState),i.fl&&t.El(i.fl)&&this.Il(),n?this.ku.listen(e).then(function(t){return i.targetId=t}):Promise.resolve(i.targetId)},zh.prototype.Nu=function(o){return c(this,void 0,void 0,function(){var e,n,i,r;return f(this,function(t){return e=o.query,n=!1,(i=this.wl.get(e))&&0<=(r=i.dl.indexOf(o))&&(i.dl.splice(r,1),n=0===i.dl.length),n?[2,(this.wl.delete(e),this.ku.Nu(e))]:[2]})})},zh.prototype.Fa=function(t){for(var e=!1,n=0,i=t;n<i.length;n++){var r=i[n],o=r.query,s=this.wl.get(o);if(s){for(var u=0,a=s.dl;u<a.length;u++)a[u].El(r)&&(e=!0);s.fl=r}}e&&this.Il()},zh.prototype.al=function(t,e){var n=this.wl.get(t);if(n)for(var i=0,r=n.dl;i<r.length;i++)r[i].onError(e);this.wl.delete(t)},zh.prototype.sl=function(r){this.onlineState=r;var o=!1;this.wl.forEach(function(t,e){for(var n=0,i=e.dl;n<i.length;n++)i[n].gc(r)&&(o=!0)}),o&&this.Il()},zh.prototype.ml=function(t){this.Tl.add(t),t.next()},zh.prototype.Rl=function(t){this.Tl.delete(t)},zh.prototype.Il=function(){this.Tl.forEach(function(t){t.next()})},zh),Uh=(Bh.prototype.El=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,i=t.docChanges;n<i.length;n++){var r=i[n];3!==r.type&&e.push(r)}t=new qs(t.query,t.docs,t.cs,e,t.ls,t.fromCache,t._s,!0)}var o=!1;return this.Pl?this.pl(t)&&(this.Al.next(t),o=!0):this.gl(t,this.onlineState)&&(this.yl(t),o=!0),this.Vl=t,o},Bh.prototype.onError=function(t){this.Al.error(t)},Bh.prototype.gc=function(t){this.onlineState=t;var e=!1;return this.Vl&&!this.Pl&&this.gl(this.Vl,t)&&(this.yl(this.Vl),e=!0),e},Bh.prototype.gl=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.bl&&n||t.docs.B()&&"Offline"!==e)},Bh.prototype.pl=function(t){if(0<t.docChanges.length)return!0;var e=this.Vl&&this.Vl.hasPendingWrites!==t.hasPendingWrites;return!(!t._s&&!e)&&!0===this.options.includeMetadataChanges},Bh.prototype.yl=function(t){t=qs.ds(t.query,t.docs,t.ls,t.fromCache),this.Pl=!0,this.Al.next(t)},Bh),Mh=(jh.prototype.Bh=function(t){this.vl=t},jh.prototype.rr=function(e,i,r,o){var s=this;return i.Me()||r.isEqual(Bi.MIN)?this.Sl(e,i):this.vl.sr(e,o).next(function(t){var n=s.Dl(i,t);return(i.je()||i.Ge())&&s.Rc(i.pe,n,o,r)?s.Sl(e,i):(cu()<=u.DEBUG&&lu("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),i.toString()),s.vl.rr(e,i,r).next(function(e){return n.forEach(function(t){e=e.nt(t.key,t)}),e}))})},jh.prototype.Dl=function(n,t){var i=new yr(function(t,e){return n.Be(t,e)});return t.forEach(function(t,e){e instanceof Lo&&n.matches(e)&&(i=i.add(e))}),i},jh.prototype.Rc=function(t,e,n,i){if(n.size!==e.size)return!0;var r="F"===t?e.last():e.first();return!!r&&(r.hasPendingWrites||0<r.version.D(i))},jh.prototype.Sl=function(t,e){return cu()<=u.DEBUG&&lu("IndexFreeQueryEngine","Using full collection scan to execute query: %s",e.toString()),this.vl.rr(t,e,Bi.MIN)},jh),xh=(Gh.prototype.Nl=function(t){return Ru.resolve(0===this.zn.length)},Gh.prototype.zh=function(t,e,n){var i=e.batchId,r=this.$l(i,"acknowledged");return vu(0===r),this.zn[r],this.lastStreamToken=n,Ru.resolve()},Gh.prototype.no=function(t){return Ru.resolve(this.lastStreamToken)},Gh.prototype.ro=function(t,e){return this.lastStreamToken=e,Ru.resolve()},Gh.prototype.Kh=function(t,e,n,i){var r=this.Cl;this.Cl++,0<this.zn.length&&this.zn[this.zn.length-1];var o=new Nu(r,e,n,i);this.zn.push(o);for(var s=0,u=i;s<u.length;s++){var a=u[s];this.Fl=this.Fl.add(new Su(a.key,r)),this.Yn.gh(t,a.key.path.O())}return Ru.resolve(o)},Gh.prototype.eo=function(t,e){return Ru.resolve(this.kl(e))},Gh.prototype.Ro=function(t,e){var n=e+1,i=this.Ll(n),r=i<0?0:i;return Ru.resolve(this.zn.length>r?this.zn[r]:null)},Gh.prototype.io=function(){return Ru.resolve(0===this.zn.length?-1:this.Cl-1)},Gh.prototype.Uh=function(t){return Ru.resolve(this.zn.slice())},Gh.prototype.Jn=function(t,e){var n=this,i=new Su(e,0),r=new Su(e,Number.POSITIVE_INFINITY),o=[];return this.Fl.Ct([i,r],function(t){var e=n.kl(t.On);o.push(e)}),Ru.resolve(o)},Gh.prototype.nr=function(t,e){var i=this,r=new yr(wu);return e.forEach(function(t){var e=new Su(t,0),n=new Su(t,Number.POSITIVE_INFINITY);i.Fl.Ct([e,n],function(t){r=r.add(t.On)})}),Ru.resolve(this.Ol(r))},Gh.prototype.cr=function(t,e){var n=e.path,i=n.length+1,r=n;sr.st(r)||(r=r.child(""));var o=new Su(new sr(r),0),s=new yr(wu);return this.Fl.Ft(function(t){var e=t.key.path;return!!n.U(e)&&(e.length===i&&(s=s.add(t.On)),!0)},o),Ru.resolve(this.Ol(s))},Gh.prototype.Ol=function(t){var n=this,i=[];return t.forEach(function(t){var e=n.kl(t);null!==e&&i.push(e)}),i},Gh.prototype.so=function(n,i){var r=this;vu(0===this.$l(i.batchId,"removed")),this.zn.shift();var o=this.Fl;return Ru.forEach(i.mutations,function(t){var e=new Su(t.key,i.batchId);return o=o.delete(e),r.Fh.Ml(n,t.key)}).next(function(){r.Fl=o})},Gh.prototype.ql=function(t){},Gh.prototype.Ln=function(t,e){var n=new Su(e,0),i=this.Fl.Nt(n);return Ru.resolve(e.isEqual(i&&i.key))},Gh.prototype.Zh=function(t){return this.zn.length,Ru.resolve()},Gh.prototype.$l=function(t,e){return this.Ll(t)},Gh.prototype.Ll=function(t){return 0===this.zn.length?0:t-this.zn[0].batchId},Gh.prototype.kl=function(t){var e=this.Ll(t);return e<0||e>=this.zn.length?null:this.zn[e]},Gh),Fh=(qh.prototype.do=function(t,e,n){var i=e.key,r=this.docs.get(i),o=r?r.size:0,s=this.Bl(e);return this.docs=this.docs.nt(i,{xl:e,size:s,readTime:n}),this.size+=s-o,this.Yn.gh(t,i.path.O())},qh.prototype.fo=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},qh.prototype.tr=function(t,e){var n=this.docs.get(e);return Ru.resolve(n?n.xl:null)},qh.prototype.getEntries=function(t,e){var n=this,i=_s();return e.forEach(function(t){var e=n.docs.get(t);i=i.nt(t,e?e.xl:null)}),Ru.resolve(i)},qh.prototype.rr=function(t,e,n){for(var i=Rs(),r=new sr(e.path.child("")),o=this.docs._t(r);o.It();){var s=o.Et(),u=s.key,a=s.value,h=a.xl,c=a.readTime;if(!e.path.U(u.path))break;c.D(n)<=0||h instanceof Lo&&e.matches(h)&&(i=i.nt(h.key,h))}return Ru.resolve(i)},qh.prototype.Ul=function(t,e){return Ru.forEach(this.docs,function(t){return e(t)})},qh.prototype.Yh=function(t){return new qh.Ql(this)},qh.prototype.Wl=function(t){return Ru.resolve(this.size)},qh);function qh(t,e){this.Yn=t,this.Bl=e,this.docs=new ar(sr.$),this.size=0}function Gh(t,e){this.Yn=t,this.Fh=e,this.zn=[],this.Cl=1,this.lastStreamToken=Ar.qt,this.Fl=new yr(Su.Ee)}function jh(){}function Bh(t,e,n){this.query=t,this.Al=e,this.Pl=!1,this.Vl=null,this.onlineState="Unknown",this.options=n||{}}function zh(t){this.ku=t,this.wl=new Iu(function(t){return t.canonicalId()}),this.onlineState="Unknown",this.Tl=new Set,this.ku.subscribe(this)}function Hh(t,e,n,i,r){this.uu=t,this.Sc=e,this.Oc=n,this.currentUser=i,this.Mc=r,this.qc=null,this.Bc=new Iu(function(t){return t.canonicalId()}),this.xc=new Map,this.Uc=[],this.Qc=new ar(sr.$),this.Wc=new Map,this.jc=new _u,this.Gc={},this.Kc=new Map,this.Hc=$u.Vh(),this.onlineState="Unknown"}function Yh(t,e,n,i){this.Nr=t,this.Sc=e,this.updateFunction=n,this.Lr=i,this.Dc=5,this.zr=new Bu(this.Nr,"transaction_retry")}function Qh(t,e){this.query=t,this._c=e,this.fc=null,this.As=!1,this.dc=Ds(),this.ls=Ds(),this.wc=new xs(t.Be.bind(t))}function Wh(){this.tc=new Oh,this.ec={},this.ku=null,this.tu=null,this.Tr=null}function Xh(){this.activeTargetIds=Cs()}function Kh(t,e,n,i,r){var o=this;this.uu=t,this.Ga=e,this.cu=[],this.lu=new Map,this._u=null,this.networkEnabled=!1,this.isPrimary=!1,this.fu=r,this.fu.du(function(t){n.xr(function(){return c(o,void 0,void 0,function(){return f(this,function(t){switch(t.label){case 0:return this.wu()?(lu("RemoteStore","Restarting streams for network reachability change."),[4,this.Tu()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.Eu=new Rh(n,i),this.Iu=this.Ga.Ua({Da:this.mu.bind(this),ga:this.Ru.bind(this),Fa:this.Au.bind(this)}),this.Pu=this.Ga.xa({Da:this.Vu.bind(this),ga:this.pu.bind(this),qa:this.gu.bind(this),Ma:this.Ma.bind(this)})}function $h(t,e){this.Nr=t,this.tu=e,this.state="Unknown",this.eu=0,this.su=null,this.iu=!0}function Zh(t){this.Ga=t,this.Ka=Os(),this.mutations=[],this.Ha=!1,this.za=null,this.Ya=new Set}function Jh(t,e,n,i){this.Ar=t,this._a=e,this.credentials=n,this.serializer=i}function tc(t,e,n,i,r){var o=this;return(o=bh.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,r)||this).serializer=i,o.ka=!1,o.lastStreamToken=Ar.qt,o}function ec(t,e,n,i,r){var o=this;return(o=Eh.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,r)||this).serializer=i,o}function nc(t,e,n,i,r,o){this.Ar=t,this.la=n,this._a=i,this.fa=r,this.listener=o,this.state=0,this.da=0,this.wa=null,this.stream=null,this.zr=new Bu(t,e)}function ic(t){var e=this;return(e=Ah.call(this)||this).Yl=t,e}function rc(){this.Hh=new Iu(function(t){return t.toString()}),this.jl=!1}Fh.Ql=(Object.defineProperty(rc.prototype,"readTime",{get:function(){return this.Gl},set:function(t){this.Gl=t},enumerable:!0,configurable:!0}),rc.prototype.do=function(t,e){this.Kl(),this.readTime=e,this.Hh.set(t.key,t)},rc.prototype.fo=function(t,e){this.Kl(),e&&(this.readTime=e),this.Hh.set(t,null)},rc.prototype.tr=function(t,e){this.Kl();var n=this.Hh.get(e);return void 0!==n?Ru.resolve(n):this.Hl(t,e)},rc.prototype.getEntries=function(t,e){return this.zl(t,e)},rc.prototype.apply=function(t){return this.Kl(),this.jl=!0,this.Ac(t)},rc.prototype.Kl=function(){},n(ic,Ah=rc),ic.prototype.Ac=function(n){var i=this,r=[];return this.Hh.forEach(function(t,e){e?r.push(i.Yl.do(n,e,i.readTime)):i.Yl.fo(t)}),Ru.Gn(r)},ic.prototype.Hl=function(t,e){return this.Yl.tr(t,e)},ic.prototype.zl=function(t,e){return this.Yl.getEntries(t,e)},ic);var oc,sc=(bc.prototype.Js=function(t,n){return this.Xl.forEach(function(t,e){return n(e)}),Ru.resolve()},bc.prototype.ho=function(t){return Ru.resolve(this.lastRemoteSnapshotVersion)},bc.prototype.e_=function(t){return Ru.resolve(this.Jl)},bc.prototype.po=function(t){return this.highestTargetId=this.t_.next(),Ru.resolve(this.highestTargetId)},bc.prototype.To=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.Jl&&(this.Jl=e),Ru.resolve()},bc.prototype.s_=function(t){this.Xl.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.t_=new $u(e),this.highestTargetId=e),t.sequenceNumber>this.Jl&&(this.Jl=t.sequenceNumber)},bc.prototype.yo=function(t,e){return this.s_(e),this.targetCount+=1,Ru.resolve()},bc.prototype._o=function(t,e){return this.s_(e),Ru.resolve()},bc.prototype.i_=function(t,e){return this.Xl.delete(e.target),this.Zl.Nn(e.targetId),--this.targetCount,Ru.resolve()},bc.prototype.n_=function(n,i,r){var o=this,s=0,u=[];return this.Xl.forEach(function(t,e){e.sequenceNumber<=i&&null===r.get(e.targetId)&&(o.Xl.delete(t),u.push(o.r_(n,e.targetId)),s++)}),Ru.Gn(u).next(function(){return s})},bc.prototype.h_=function(t){return Ru.resolve(this.targetCount)},bc.prototype.Vo=function(t,e){var n=this.Xl.get(e)||null;return Ru.resolve(n)},bc.prototype.uo=function(e,t,n){this.Zl.Sn(t,n);var i=this.persistence.Fh,r=[];return i&&t.forEach(function(t){r.push(i.vn(e,t))}),Ru.Gn(r)},bc.prototype.ao=function(e,t,n){this.Zl.Fn(t,n);var i=this.persistence.Fh,r=[];return i&&t.forEach(function(t){r.push(i.Dn(e,t))}),Ru.Gn(r)},bc.prototype.r_=function(t,e){return this.Zl.Nn(e),Ru.resolve()},bc.prototype.So=function(t,e){var n=this.Zl.kn(e);return Ru.resolve(n)},bc.prototype.Ln=function(t,e){return Ru.resolve(this.Zl.Ln(e))},bc),uc=(wc.prototype.start=function(){return Promise.resolve()},wc.prototype.Cu=function(){return this.u_=!1,Promise.resolve()},Object.defineProperty(wc.prototype,"l_",{get:function(){return this.u_},enumerable:!0,configurable:!0}),wc.prototype.__=function(){},wc.prototype.qh=function(){return this.Yn},wc.prototype.Nh=function(t){var e=this.o_[t.s()];return e||(e=new xh(this.Yn,this.Fh),this.o_[t.s()]=e),e},wc.prototype.Oh=function(){return this.Lh},wc.prototype.kh=function(){return this.Hn},wc.prototype.runTransaction=function(t,e,n){var i=this;lu("MemoryPersistence","Starting transaction:",t);var r=new ac(this.a_.next());return this.Fh.f_(),n(r).next(function(t){return i.Fh.d_(r).next(function(){return t})}).Wn().then(function(t){return r.w_(),t})},wc.prototype.T_=function(e,n){return Ru.Kn(Object.values(this.o_).map(function(t){return function(){return t.Ln(e,n)}}))},wc),ac=(mc.prototype.I_=function(t){this.E_.push(t)},mc.prototype.w_=function(){this.E_.forEach(function(t){return t()})},n(gc,oc=mc),gc),hc=(vc.A_=function(t){return new vc(t)},Object.defineProperty(vc.prototype,"P_",{get:function(){if(this.R_)return this.R_;throw yu()},enumerable:!0,configurable:!0}),vc.prototype.Ch=function(t){this.m_=t},vc.prototype.vn=function(t,e){return this.P_.delete(e),Ru.resolve()},vc.prototype.Dn=function(t,e){return this.P_.add(e),Ru.resolve()},vc.prototype.Ml=function(t,e){return this.P_.add(e),Ru.resolve()},vc.prototype.removeTarget=function(t,e){var n=this,i=this.persistence.Oh();return i.So(t,e.targetId).next(function(t){t.forEach(function(t){return n.P_.add(t)})}).next(function(){return i.i_(t,e)})},vc.prototype.f_=function(){this.R_=new Set},vc.prototype.d_=function(t){var n=this,i=this.persistence.kh().Yh();return Ru.forEach(this.P_,function(e){return n.V_(t,e).next(function(t){t||i.fo(e)})}).next(function(){return n.R_=null,i.apply(t)})},vc.prototype.wo=function(t,e){var n=this;return this.V_(t,e).next(function(t){t?n.P_.delete(e):n.P_.add(e)})},vc.prototype.c_=function(t){return 0},vc.prototype.V_=function(t,e){var n=this;return Ru.Kn([function(){return n.persistence.Oh().Ln(t,e)},function(){return n.persistence.T_(t,e)},function(){return Ru.resolve(n.m_.Ln(e))}])},vc),cc=(yc.prototype.initialize=function(n){return c(this,void 0,void 0,function(){var e=this;return f(this,function(t){switch(t.label){case 0:return this.Oc=this.p_(n),this.persistence=this.g_(n),[4,this.persistence.start()];case 1:return t.sent(),this.y_=this.b_(n),this.uu=this.v_(n),this.Sc=this.S_(n),this.ku=this.D_(n),this.C_=this.F_(n),this.Oc.tu=function(t){return e.ku.gc(t,1)},this.Sc.ku=this.ku,[4,this.uu.start()];case 2:return t.sent(),[4,this.Oc.start()];case 3:return t.sent(),[4,this.Sc.start()];case 4:return t.sent(),[4,this.Sc.Yu(this.ku.zc)];case 5:return t.sent(),[2]}})})},yc.prototype.F_=function(t){return new Ph(this.ku)},yc.prototype.b_=function(t){return null},yc.prototype.v_=function(t){return new ta(this.persistence,new Mh,t.N_)},yc.prototype.g_=function(t){return new uc(hc.A_)},yc.prototype.S_=function(t){var e=this;return new kh(this.uu,t.Ga,t.Nr,function(t){return e.ku.gc(t,0)},t.platform.k_())},yc.prototype.p_=function(t){return new Lh},yc.prototype.D_=function(t){return new Ch(this.uu,this.Sc,this.Oc,t.N_,t.Mc)},yc.prototype.clearPersistence=function(t){throw new Mi(Ui.FAILED_PRECONDITION,"You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.")},yc),fc=(dc.prototype.start=function(e,n){var i=this;this.O_();var r=new ju,o=new ju,s=!1;return this.credentials._(function(t){if(!s)return s=!0,lu("FirestoreClient","Initializing. user=",t.uid),i.M_(e,n,t,o).then(r.resolve,r.reject);i.Nr.xr(function(){return i.zu(t)})}),this.Nr.xr(function(){return r.promise}),o.promise},dc.prototype.enableNetwork=function(){var t=this;return this.O_(),this.Nr.enqueue(function(){return t.ku.enableNetwork()})},dc.prototype.M_=function(s,u,a,h){return c(this,void 0,void 0,function(){var e,n,i,r,o=this;return f(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),[4,this.platform.q_(this.L_)];case 1:return e=t.sent(),n=this.platform.B_(this.L_.ci),i=new _h(this.Nr,e,this.credentials,n),[4,s.initialize({Nr:this.Nr,L_:this.L_,platform:this.platform,Ga:i,clientId:this.clientId,N_:a,Mc:100,x_:u})];case 2:return t.sent(),this.persistence=s.persistence,this.Oc=s.Oc,this.uu=s.uu,this.Sc=s.Sc,this.ku=s.ku,this.y_=s.y_,this.U_=s.C_,this.persistence.__(function(){return c(o,void 0,void 0,function(){return f(this,function(t){switch(t.label){case 0:return[4,this.terminate()];case 1:return t.sent(),[2]}})})}),h.resolve(),[3,4];case 3:if(r=t.sent(),h.reject(r),!this.Q_(r))throw r;return[2,(console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+r),this.M_(new cc,{W_:!1},a,h))];case 4:return[2]}})})},dc.prototype.Q_=function(t){return"FirebaseError"===t.name?t.code===Ui.FAILED_PRECONDITION||t.code===Ui.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code},dc.prototype.O_=function(){if(this.Nr.Jr)throw new Mi(Ui.FAILED_PRECONDITION,"The client has already been terminated.")},dc.prototype.zu=function(t){return this.Nr.hh(),lu("FirestoreClient","Credential Changed. Current user: "+t.uid),this.ku.zu(t)},dc.prototype.disableNetwork=function(){var t=this;return this.O_(),this.Nr.enqueue(function(){return t.ku.disableNetwork()})},dc.prototype.terminate=function(){var t=this;return this.Nr.ih(function(){return c(t,void 0,void 0,function(){return f(this,function(t){switch(t.label){case 0:return this.y_&&this.y_.stop(),[4,this.Sc.Cu()];case 1:return t.sent(),[4,this.Oc.Cu()];case 2:return t.sent(),[4,this.persistence.Cu()];case 3:return t.sent(),this.credentials.T(),[2]}})})})},dc.prototype.waitForPendingWrites=function(){var t=this;this.O_();var e=new ju;return this.Nr.xr(function(){return t.ku.hl(e)}),e.promise},dc.prototype.listen=function(t,e,n){var i=this;this.O_();var r=new Uh(t,e,n);return this.Nr.xr(function(){return i.U_.listen(r)}),r},dc.prototype.Nu=function(t){var e=this;this.j_||this.Nr.xr(function(){return e.U_.Nu(t)})},dc.prototype.G_=function(t){var e=this;return this.O_(),this.Nr.enqueue(function(){return e.uu.Ao(t)}).then(function(t){if(t instanceof Lo)return t;if(t instanceof Do)return null;throw new Mi(Ui.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")})},dc.prototype.K_=function(r){var t=this;return this.O_(),this.Nr.enqueue(function(){return c(t,void 0,void 0,function(){var e,n,i;return f(this,function(t){switch(t.label){case 0:return[4,this.uu.vo(r,!0)];case 1:return e=t.sent(),n=new Dh(r,e.Do),i=n.Ec(e.documents),[2,n.Ac(i,!1).snapshot]}})})})},dc.prototype.write=function(t){var e=this;this.O_();var n=new ju;return this.Nr.xr(function(){return e.ku.write(t,n)}),n.promise},dc.prototype.ci=function(){return this.L_.ci},dc.prototype.ml=function(t){var e=this;this.O_(),this.Nr.xr(function(){return e.U_.ml(t),Promise.resolve()})},dc.prototype.Rl=function(t){this.j_||this.U_.Rl(t)},Object.defineProperty(dc.prototype,"j_",{get:function(){return this.Nr.Jr},enumerable:!0,configurable:!0}),dc.prototype.transaction=function(t){var e=this;this.O_();var n=new ju;return this.Nr.xr(function(){return e.ku.runTransaction(e.Nr,t,n),Promise.resolve()}),n.promise},dc),lc=(pc.prototype.next=function(t){this.H_(this.observer.next,t)},pc.prototype.error=function(t){this.H_(this.observer.error,t)},pc.prototype.z_=function(){this.muted=!0},pc.prototype.H_=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},pc);function pc(t){this.observer=t,this.muted=!1}function dc(t,e,n,i){this.platform=t,this.L_=e,this.credentials=n,this.Nr=i,this.clientId=gu.Tn()}function yc(){}function vc(t){this.persistence=t,this.m_=null,this.R_=null}function gc(t){var e=this;return(e=oc.call(this)||this).co=t,e}function mc(){this.E_=[]}function wc(t){var e=this;this.o_={},this.a_=new Lu(0),this.u_=!1,this.u_=!0,this.Fh=t(this),this.Lh=new sc(this),this.Yn=new Zu,this.Hn=new Fh(this.Yn,function(t){return e.Fh.c_(t)})}function bc(t){this.persistence=t,this.Xl=new Iu(function(t){return t.canonicalId()}),this.lastRemoteSnapshotVersion=Bi.MIN,this.highestTargetId=0,this.Jl=0,this.Zl=new _u,this.targetCount=0,this.t_=$u.Ph()}function Ec(r){return function(){if("object"==typeof r&&null!==r)for(var t=r,e=0,n=["next","error","complete"];e<n.length;e++){var i=n[e];if(i in t&&"function"==typeof t[i])return 1}}()}var Ac,Ic,Nc=(Wc.prototype.X_=function(t){switch(kr(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Ur(t.integerValue||t.doubleValue);case 3:return this.J_(t.timestampValue);case 4:return this.Z_(t);case 5:return t.stringValue;case 6:return new Sa(Mr(t.bytesValue));case 7:return this.tf(t.referenceValue);case 8:return new Wa(t.geoPointValue.latitude,t.geoPointValue.longitude);case 9:return this.ef(t.arrayValue);case 10:return this.sf(t.mapValue);default:throw yu()}},Wc.prototype.sf=function(t){var n=this,i={};return br(t.fields||{},function(t,e){i[t]=n.X_(e)}),i},Wc.prototype.ef=function(t){var e=this;return(t.values||[]).map(function(t){return e.X_(t)})},Wc.prototype.Z_=function(t){switch(this.Y_){case"previous":var e=function t(e){var n=e.mapValue.fields.__previous_value__;return _r(n)?t(n):n}(t);return null==e?null:this.X_(e);case"estimate":return this.J_(Sr(t));default:return null}},Wc.prototype.J_=function(t){var e=Pr(t),n=new ji(e.seconds,e.nanos);return this.timestampsInSnapshots?n:n.toDate()},Wc.prototype.tf=function(t){var e=Ji.K(t);vu(su(e));var n=new Au(e.get(1),e.get(3)),i=new sr(e.L(5));return n.isEqual(this.firestore.if)||pu("Document "+i+" contains a document reference within a different database ("+n.projectId+"/"+n.database+") which is not supported. It will be treated as a reference in the current database ("+this.firestore.if.projectId+"/"+this.firestore.if.database+") instead."),new Oc(i,this.firestore,this.converter)},Wc),Tc=Yu.Eh,_c=(Qc.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.timestampsInSnapshots===t.timestampsInSnapshots&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.forceLongPolling===t.forceLongPolling},Qc),Sc=(Yc.prototype.settings=function(t){ua("Firestore.settings",arguments,1),ca("Firestore.settings","object",1,t);var e=new _c(t);if(this.af&&!this.ff.isEqual(e))throw new Mi(Ui.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");void 0!==(this.ff=e).credentials&&(this.lf=function(t){if(!t)return new xi;switch(t.type){case"gapi":var e=t.Tf;return vu(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Gi(e,t.V||"0");case"provider":return t.Tf;default:throw new Mi(Ui.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(e.credentials))},Yc.prototype.enableNetwork=function(){return this.hf(),this.af.enableNetwork()},Yc.prototype.disableNetwork=function(){return this.hf(),this.af.disableNetwork()},Yc.prototype.enablePersistence=function(t){var e,n;if(this.af)throw new Mi(Ui.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var i=!1;return t&&(void 0!==t.experimentalTabSynchronization&&pu("The 'experimentalTabSynchronization' setting will be removed. Use 'synchronizeTabs' instead."),i=null!==(n=null!==(e=t.synchronizeTabs)&&void 0!==e?e:t.experimentalTabSynchronization)&&void 0!==n&&n),this.Ef(this._f,{W_:!0,cacheSizeBytes:this.ff.cacheSizeBytes,synchronizeTabs:i})},Yc.prototype.clearPersistence=function(){return c(this,void 0,void 0,function(){var i,e=this;return f(this,function(t){if(void 0!==this.af&&!this.af.j_)throw new Mi(Ui.FAILED_PRECONDITION,"Persistence cannot be cleared after this Firestore instance is initialized.");return i=new ju,[2,(this.rf.Zr(function(){return c(e,void 0,void 0,function(){var e,n;return f(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),e=this.If(),[4,this._f.clearPersistence(e)];case 1:return t.sent(),i.resolve(),[3,3];case 2:return n=t.sent(),i.reject(n),[3,3];case 3:return[2]}})})}),i.promise)]})})},Yc.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(Yc.prototype,"mf",{get:function(){return this.hf(),this.af.j_},enumerable:!0,configurable:!0}),Yc.prototype.waitForPendingWrites=function(){return this.hf(),this.af.waitForPendingWrites()},Yc.prototype.onSnapshotsInSync=function(t){if(this.hf(),Ec(t))return this.Rf(t);ca("Firestore.onSnapshotsInSync","function",1,t);var e={next:t};return this.Rf(e)},Yc.prototype.Rf=function(t){var e=this,n=new lc({next:function(){t.next&&t.next()},error:function(t){throw yu()}});return this.af.ml(n),function(){n.z_(),e.af.Rl(n)}},Yc.prototype.hf=function(){return this.af||this.Ef(new cc,{W_:!1}),this.af},Yc.prototype.If=function(){return new Eu(this.if,this.cf,this.ff.host,this.ff.ssl,this.ff.forceLongPolling)},Yc.prototype.Ef=function(t,e){var n=this.If();return this.af=new fc(uu.Ot(),n,this.lf,this.rf),this.af.start(t,e)},Yc.prototype.wf=function(i){var t=uu.Ot().B_(i);return new uh(t,function(t){if(t instanceof Oc){var e=i,n=t.firestore.if;if(!n.isEqual(e))throw new Mi(Ui.INVALID_ARGUMENT,"Document reference is for database "+n.projectId+"/"+n.database+" but should be for database "+e.projectId+"/"+e.database);return new sh(i,t.Af)}return t})},Yc.uf=function(t){if(e=t.options,!Object.prototype.hasOwnProperty.call(e,"projectId"))throw new Mi(Ui.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var e,n=t.options.projectId;if(!n||"string"!=typeof n)throw new Mi(Ui.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new Au(n)},Object.defineProperty(Yc.prototype,"app",{get:function(){if(!this.nf)throw new Mi(Ui.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.nf},enumerable:!0,configurable:!0}),Yc.prototype.collection=function(t){return ua("Firestore.collection",arguments,1),ca("Firestore.collection","non-empty string",1,t),this.hf(),new Uc(Ji.K(t),this)},Yc.prototype.doc=function(t){return ua("Firestore.doc",arguments,1),ca("Firestore.doc","non-empty string",1,t),this.hf(),Oc.Pf(Ji.K(t),this)},Yc.prototype.collectionGroup=function(t){if(ua("Firestore.collectionGroup",arguments,1),ca("Firestore.collectionGroup","non-empty string",1,t),0<=t.indexOf("/"))throw new Mi(Ui.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.hf(),new Cc(new Po(Ji.H,t),this)},Yc.prototype.runTransaction=function(e){var n=this;return ua("Firestore.runTransaction",arguments,1),ca("Firestore.runTransaction","function",1,e),this.hf().transaction(function(t){return e(new Rc(n,t))})},Yc.prototype.batch=function(){return this.hf(),new kc(this)},Object.defineProperty(Yc,"logLevel",{get:function(){switch(cu()){case u.DEBUG:return"debug";case u.SILENT:return"silent";default:return"error"}},enumerable:!0,configurable:!0}),Yc.setLogLevel=function(t){switch(ua("Firestore.setLogLevel",arguments,1),ca("Firestore.setLogLevel","non-empty string",1,t),t){case"debug":fu(u.DEBUG);break;case"error":fu(u.ERROR);break;case"silent":fu(u.SILENT);break;default:throw new Mi(Ui.INVALID_ARGUMENT,"Invalid log level: "+t)}},Yc.prototype.Vf=function(){return this.ff.timestampsInSnapshots},Yc),Rc=(Hc.prototype.get=function(t){var n=this;ua("Transaction.get",arguments,1);var i=Zc("Transaction.get",t,this.pf);return this.gf.Wa([i.Af]).then(function(t){if(!t||1!==t.length)return yu();var e=t[0];if(e instanceof Do)return new Dc(n.pf,i.Af,null,!1,!1,i.yf);if(e instanceof Lo)return new Dc(n.pf,i.Af,e,!1,!1,i.yf);throw yu()})},Hc.prototype.set=function(t,e,n){ha("Transaction.set",arguments,2,3);var i=Zc("Transaction.set",t,this.pf);n=Xc("Transaction.set",n);var r=Jc(i.yf,e,"Transaction.set"),o=r[0],s=r[1],u=n.merge||n.mergeFields?this.pf.df.ea(s,o,n.mergeFields):this.pf.df.Zo(s,o);return this.gf.set(i.Af,u),this},Hc.prototype.update=function(t,e,n){for(var i,r,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return r="string"==typeof e||e instanceof ka?(aa("Transaction.update",arguments,3),i=Zc("Transaction.update",t,this.pf),this.pf.df.ra("Transaction.update",e,n,o)):(ua("Transaction.update",arguments,2),i=Zc("Transaction.update",t,this.pf),this.pf.df.sa("Transaction.update",e)),this.gf.update(i.Af,r),this},Hc.prototype.delete=function(t){ua("Transaction.delete",arguments,1);var e=Zc("Transaction.delete",t,this.pf);return this.gf.delete(e.Af),this},Hc),kc=(zc.prototype.set=function(t,e,n){ha("WriteBatch.set",arguments,2,3),this.Sf();var i=Zc("WriteBatch.set",t,this.pf);n=Xc("WriteBatch.set",n);var r=Jc(i.yf,e,"WriteBatch.set"),o=r[0],s=r[1],u=n.merge||n.mergeFields?this.pf.df.ea(s,o,n.mergeFields):this.pf.df.Zo(s,o);return this.bf=this.bf.concat(u.Qo(i.Af,no.NONE)),this},zc.prototype.update=function(t,e,n){for(var i,r,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return this.Sf(),r="string"==typeof e||e instanceof ka?(aa("WriteBatch.update",arguments,3),i=Zc("WriteBatch.update",t,this.pf),this.pf.df.ra("WriteBatch.update",e,n,o)):(ua("WriteBatch.update",arguments,2),i=Zc("WriteBatch.update",t,this.pf),this.pf.df.sa("WriteBatch.update",e)),this.bf=this.bf.concat(r.Qo(i.Af,no.exists(!0))),this},zc.prototype.delete=function(t){ua("WriteBatch.delete",arguments,1),this.Sf();var e=Zc("WriteBatch.delete",t,this.pf);return this.bf=this.bf.concat(new vo(e.Af,no.NONE)),this},zc.prototype.commit=function(){return this.Sf(),this.vf=!0,0<this.bf.length?this.pf.hf().write(this.bf):Promise.resolve()},zc.prototype.Sf=function(){if(this.vf)throw new Mi(Ui.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},zc),Oc=(Bc.Pf=function(t,e,n){if(t.length%2!=0)throw new Mi(Ui.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.G()+" has "+t.length);return new Bc(new sr(t),e,n)},Object.defineProperty(Bc.prototype,"id",{get:function(){return this.Af.path.q()},enumerable:!0,configurable:!0}),Object.defineProperty(Bc.prototype,"parent",{get:function(){return new Uc(this.Af.path.O(),this.firestore,this.yf)},enumerable:!0,configurable:!0}),Object.defineProperty(Bc.prototype,"path",{get:function(){return this.Af.path.G()},enumerable:!0,configurable:!0}),Bc.prototype.collection=function(t){if(ua("DocumentReference.collection",arguments,1),ca("DocumentReference.collection","non-empty string",1,t),!t)throw new Mi(Ui.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");var e=Ji.K(t);return new Uc(this.Af.path.child(e),this.firestore)},Bc.prototype.isEqual=function(t){if(!(t instanceof Bc))throw ba("isEqual","DocumentReference",1,t);return this.firestore===t.firestore&&this.Af.isEqual(t.Af)&&this.yf===t.yf},Bc.prototype.set=function(t,e){ha("DocumentReference.set",arguments,1,2),e=Xc("DocumentReference.set",e);var n=Jc(this.yf,t,"DocumentReference.set"),i=n[0],r=n[1],o=e.merge||e.mergeFields?this.firestore.df.ea(r,i,e.mergeFields):this.firestore.df.Zo(r,i);return this.af.write(o.Qo(this.Af,no.NONE))},Bc.prototype.update=function(t,e){for(var n,i=[],r=2;r<arguments.length;r++)i[r-2]=arguments[r];return n="string"==typeof t||t instanceof ka?(aa("DocumentReference.update",arguments,2),this.firestore.df.ra("DocumentReference.update",t,e,i)):(ua("DocumentReference.update",arguments,1),this.firestore.df.sa("DocumentReference.update",t)),this.af.write(n.Qo(this.Af,no.exists(!0)))},Bc.prototype.delete=function(){return ua("DocumentReference.delete",arguments,0),this.af.write([new vo(this.Af,no.NONE)])},Bc.prototype.onSnapshot=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];ha("DocumentReference.onSnapshot",arguments,1,4);var n,i={includeMetadataChanges:!1},r=0;"object"!=typeof t[r]||Ec(t[r])||(wa("DocumentReference.onSnapshot",i=t[r],["includeMetadataChanges"]),pa("DocumentReference.onSnapshot","boolean","includeMetadataChanges",i.includeMetadataChanges),r++);var o={includeMetadataChanges:i.includeMetadataChanges};return n=Ec(t[r])?t[r]:(ca("DocumentReference.onSnapshot","function",r,t[r]),fa("DocumentReference.onSnapshot","function",r+1,t[r+1]),fa("DocumentReference.onSnapshot","function",r+2,t[r+2]),{next:t[r],error:t[r+1],complete:t[r+2]}),this.Df(o,n)},Bc.prototype.Df=function(t,n){var i=this,e=function(t){console.error("Uncaught Error in onSnapshot:",t)};n.error&&(e=n.error.bind(n));var r=new lc({next:function(t){if(n.next){var e=t.docs.get(i.Af);n.next(new Dc(i.firestore,i.Af,e,t.fromCache,t.hasPendingWrites,i.yf))}},error:e}),o=this.af.listen(Po.ve(this.Af.path),r,t);return function(){r.z_(),i.af.Nu(o)}},Bc.prototype.get=function(n){var i=this;return ha("DocumentReference.get",arguments,0,1),$c("DocumentReference.get",n),new Promise(function(e,t){n&&"cache"===n.source?i.firestore.hf().G_(i.Af).then(function(t){e(new Dc(i.firestore,i.Af,t,!0,t instanceof Lo&&t.te,i.yf))},t):i.Cf(e,t,n)})},Bc.prototype.Cf=function(e,n,i){var r=this.Df({includeMetadataChanges:!0,bl:!0},{next:function(t){r(),!t.exists&&t.metadata.fromCache?n(new Mi(Ui.UNAVAILABLE,"Failed to get document because the client is offline.")):t.exists&&t.metadata.fromCache&&i&&"server"===i.source?n(new Mi(Ui.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):e(t)},error:n})},Bc.prototype.withConverter=function(t){return new Bc(this.Af,this.firestore,t)},Bc),Lc=(jc.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},jc),Dc=(Gc.prototype.data=function(t){if(ha("DocumentSnapshot.data",arguments,0,1),t=Kc("DocumentSnapshot.data",t),this.Ff){if(this.yf){var e=new Vc(this.pf,this.Af,this.Ff,this.Nf,this.$f);return this.yf.fromFirestore(e,t)}return new Nc(this.pf,this.pf.Vf(),t.serverTimestamps,void 0).X_(this.Ff.me())}},Gc.prototype.get=function(t,e){if(ha("DocumentSnapshot.get",arguments,1,2),e=Kc("DocumentSnapshot.get",e),this.Ff){var n=this.Ff.data().field(lh("DocumentSnapshot.get",t));if(null!==n)return new Nc(this.pf,this.pf.Vf(),e.serverTimestamps,this.yf).X_(n)}},Object.defineProperty(Gc.prototype,"id",{get:function(){return this.Af.path.q()},enumerable:!0,configurable:!0}),Object.defineProperty(Gc.prototype,"ref",{get:function(){return new Oc(this.Af,this.pf,this.yf)},enumerable:!0,configurable:!0}),Object.defineProperty(Gc.prototype,"exists",{get:function(){return null!==this.Ff},enumerable:!0,configurable:!0}),Object.defineProperty(Gc.prototype,"metadata",{get:function(){return new Lc(this.$f,this.Nf)},enumerable:!0,configurable:!0}),Gc.prototype.isEqual=function(t){if(!(t instanceof Gc))throw ba("isEqual","DocumentSnapshot",1,t);return this.pf===t.pf&&this.Nf===t.Nf&&this.Af.isEqual(t.Af)&&(null===this.Ff?null===t.Ff:this.Ff.isEqual(t.Ff))&&this.yf===t.yf},Gc),Vc=(n(qc,Ic=Dc),qc.prototype.data=function(t){return Ic.prototype.data.call(this,t)},qc),Cc=(Fc.prototype.where=function(t,e,n){var i;ua("Query.where",arguments,3),ma("Query.where",3,n),function(t,e){if(!t.some(function(t){return t===e}))throw new Mi(Ui.INVALID_ARGUMENT,"Invalid value "+ga(e)+" provided to function Query.where() for its "+Aa(2)+" argument. Acceptable values: "+t.join(", "))}(["<","<=","==",">=",">","array-contains","in","array-contains-any"],e);var r=lh("Query.where",t),o=Uo.K(e);if(r.X()){if(o===Uo.ARRAY_CONTAINS||o===Uo.ARRAY_CONTAINS_ANY)throw new Mi(Ui.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o.toString()+"' queries on FieldPath.documentId().");if(o===Uo.IN){this.Lf(n,o);for(var s=[],u=0,a=n;u<a.length;u++){var h=a[u];s.push(this.Of(h))}i={arrayValue:{values:s}}}else i=this.Of(n)}else o!==Uo.IN&&o!==Uo.ARRAY_CONTAINS_ANY||this.Lf(n,o),i=this.firestore.df.ha("Query.where",n,o===Uo.IN);var c=$o.create(r,o,i);return this.Mf(c),new Fc(this.kf.Ce(c),this.firestore,this.yf)},Fc.prototype.orderBy=function(t,e){var n;if(ha("Query.orderBy",arguments,1,2),fa("Query.orderBy","non-empty string",2,e),void 0===e||"asc"===e)n=is.ASCENDING;else{if("desc"!==e)throw new Mi(Ui.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+e+"', expected 'asc' or 'desc'.");n=is.DESCENDING}if(null!==this.kf.startAt)throw new Mi(Ui.INVALID_ARGUMENT,"Invalid query. You must not call Query.startAt() or Query.startAfter() before calling Query.orderBy().");if(null!==this.kf.endAt)throw new Mi(Ui.INVALID_ARGUMENT,"Invalid query. You must not call Query.endAt() or Query.endBefore() before calling Query.orderBy().");var i=lh("Query.orderBy",t),r=new ys(i,n);return this.qf(r),new Fc(this.kf.Fe(r),this.firestore,this.yf)},Fc.prototype.limit=function(t){return ua("Query.limit",arguments,1),ca("Query.limit","number",1,t),Ea("Query.limit",1,t),new Fc(this.kf.Ne(t),this.firestore,this.yf)},Fc.prototype.limitToLast=function(t){return ua("Query.limitToLast",arguments,1),ca("Query.limitToLast","number",1,t),Ea("Query.limitToLast",1,t),new Fc(this.kf.$e(t),this.firestore,this.yf)},Fc.prototype.startAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];aa("Query.startAt",arguments,1);var i=this.Bf("Query.startAt",t,e,!0);return new Fc(this.kf.ke(i),this.firestore,this.yf)},Fc.prototype.startAfter=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];aa("Query.startAfter",arguments,1);var i=this.Bf("Query.startAfter",t,e,!1);return new Fc(this.kf.ke(i),this.firestore,this.yf)},Fc.prototype.endBefore=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];aa("Query.endBefore",arguments,1);var i=this.Bf("Query.endBefore",t,e,!0);return new Fc(this.kf.Le(i),this.firestore,this.yf)},Fc.prototype.endAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];aa("Query.endAt",arguments,1);var i=this.Bf("Query.endAt",t,e,!1);return new Fc(this.kf.Le(i),this.firestore,this.yf)},Fc.prototype.isEqual=function(t){if(!(t instanceof Fc))throw ba("isEqual","Query",1,t);return this.firestore===t.firestore&&this.kf.isEqual(t.kf)},Fc.prototype.withConverter=function(t){return new Fc(this.kf,this.firestore,t)},Fc.prototype.Bf=function(t,e,n,i){if(ma(t,1,e),e instanceof Dc){if(0<n.length)throw new Mi(Ui.INVALID_ARGUMENT,"Too many arguments provided to "+t+"().");var r=e;if(!r.exists)throw new Mi(Ui.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+t+"().");return this.xf(r.Ff,i)}var o=[e].concat(n);return this.Uf(t,o,i)},Fc.prototype.xf=function(t,e){for(var n=[],i=0,r=this.kf.orderBy;i<r.length;i++){var o=r[i];if(o.field.X())n.push(xr(this.firestore.if,t.key));else{var s=t.field(o.field);if(_r(s))throw new Mi(Ui.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+o.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===s){var u=o.field.G();throw new Mi(Ui.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.")}n.push(s)}}return new ds(n,e)},Fc.prototype.Uf=function(t,e,n){var i=this.kf.Ve;if(e.length>i.length)throw new Mi(Ui.INVALID_ARGUMENT,"Too many arguments provided to "+t+"(). The number of arguments must be less than or equal to the number of Query.orderBy() clauses");for(var r=[],o=0;o<e.length;o++){var s=e[o];if(i[o].field.X()){if("string"!=typeof s)throw new Mi(Ui.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+t+"(), but got a "+typeof s);if(!this.kf.ze()&&-1!==s.indexOf("/"))throw new Mi(Ui.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+t+"() must be a plain document ID, but '"+s+"' contains a slash.");var u=this.kf.path.child(Ji.K(s));if(!sr.st(u))throw new Mi(Ui.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+t+"() must result in a valid document path, but '"+u+"' is not because it contains an odd number of segments.");var a=new sr(u);r.push(xr(this.firestore.if,a))}else{var h=this.firestore.df.ha(t,s);r.push(h)}}return new ds(r,n)},Fc.prototype.onSnapshot=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];ha("Query.onSnapshot",arguments,1,4);var n,i={},r=0;return"object"!=typeof t[r]||Ec(t[r])||(wa("Query.onSnapshot",i=t[r],["includeMetadataChanges"]),pa("Query.onSnapshot","boolean","includeMetadataChanges",i.includeMetadataChanges),r++),n=Ec(t[r])?t[r]:(ca("Query.onSnapshot","function",r,t[r]),fa("Query.onSnapshot","function",r+1,t[r+1]),fa("Query.onSnapshot","function",r+2,t[r+2]),{next:t[r],error:t[r+1],complete:t[r+2]}),this.Qf(this.kf),this.Df(i,n)},Fc.prototype.Df=function(t,e){var n=this,i=function(t){console.error("Uncaught Error in onSnapshot:",t)};e.error&&(i=e.error.bind(e));var r=new lc({next:function(t){e.next&&e.next(new Pc(n.firestore,n.kf,t,n.yf))},error:i}),o=this.firestore.hf(),s=o.listen(this.kf,r,t);return function(){r.z_(),o.Nu(s)}},Fc.prototype.Qf=function(t){if(t.Ge()&&0===t.Ve.length)throw new Mi(Ui.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")},Fc.prototype.get=function(n){var i=this;return ha("Query.get",arguments,0,1),$c("Query.get",n),this.Qf(this.kf),new Promise(function(e,t){n&&"cache"===n.source?i.firestore.hf().K_(i.kf).then(function(t){e(new Pc(i.firestore,i.kf,t,i.yf))},t):i.Cf(e,t,n)})},Fc.prototype.Cf=function(e,n,i){var r=this.Df({includeMetadataChanges:!0,bl:!0},{next:function(t){r(),t.metadata.fromCache&&i&&"server"===i.source?n(new Mi(Ui.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):e(t)},error:n})},Fc.prototype.Of=function(t){if("string"==typeof t){if(""===t)throw new Mi(Ui.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!this.kf.ze()&&-1!==t.indexOf("/"))throw new Mi(Ui.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+t+"' contains a '/' character.");var e=this.kf.path.child(Ji.K(t));if(!sr.st(e))throw new Mi(Ui.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return xr(this.firestore.if,new sr(e))}if(t instanceof Oc){var n=t;return xr(this.firestore.if,n.Af)}throw new Mi(Ui.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+ga(t)+".")},Fc.prototype.Lf=function(t,e){if(!Array.isArray(t)||0===t.length)throw new Mi(Ui.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new Mi(Ui.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.");if(0<=t.indexOf(null))throw new Mi(Ui.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'null' in the value array.");if(0<t.filter(function(t){return Number.isNaN(t)}).length)throw new Mi(Ui.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'NaN' in the value array.")},Fc.prototype.Mf=function(t){if(t instanceof $o){var e=[Uo.ARRAY_CONTAINS,Uo.ARRAY_CONTAINS_ANY],n=[Uo.IN,Uo.ARRAY_CONTAINS_ANY],i=0<=e.indexOf(t.op),r=0<=n.indexOf(t.op);if(t.Ke()){var o=this.kf.Se();if(null!==o&&!o.isEqual(t.field))throw new Mi(Ui.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+o.toString()+"' and '"+t.field.toString()+"'");var s=this.kf.De();null!==s&&this.Wf(t.field,s)}else if(r||i){var u=null;if(r&&(u=this.kf.He(n)),null===u&&i&&(u=this.kf.He(e)),null!=u)throw u===t.op?new Mi(Ui.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+t.op.toString()+"' filter."):new Mi(Ui.INVALID_ARGUMENT,"Invalid query. You cannot use '"+t.op.toString()+"' filters with '"+u.toString()+"' filters.")}}},Fc.prototype.qf=function(t){if(null===this.kf.De()){var e=this.kf.Se();null!==e&&this.Wf(e,t.field)}},Fc.prototype.Wf=function(t,e){if(!e.isEqual(t))throw new Mi(Ui.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+t.toString()+"' and so you must also use '"+t.toString()+"' as your first Query.orderBy(), but your first Query.orderBy() is on field '"+e.toString()+"' instead.")},Fc),Pc=(Object.defineProperty(xc.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!0,configurable:!0}),Object.defineProperty(xc.prototype,"empty",{get:function(){return this.Gf.docs.B()},enumerable:!0,configurable:!0}),Object.defineProperty(xc.prototype,"size",{get:function(){return this.Gf.docs.size},enumerable:!0,configurable:!0}),xc.prototype.forEach=function(e,n){var i=this;ha("QuerySnapshot.forEach",arguments,1,2),ca("QuerySnapshot.forEach","function",1,e),this.Gf.docs.forEach(function(t){e.call(n,i.zf(t))})},Object.defineProperty(xc.prototype,"query",{get:function(){return new Cc(this.jf,this.pf,this.yf)},enumerable:!0,configurable:!0}),xc.prototype.docChanges=function(t){t&&(wa("QuerySnapshot.docChanges",t,["includeMetadataChanges"]),pa("QuerySnapshot.docChanges","boolean","includeMetadataChanges",t.includeMetadataChanges));var e=!(!t||!t.includeMetadataChanges);if(e&&this.Gf.fs)throw new Mi(Ui.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.Kf&&this.Hf===e||(this.Kf=function(r,e,o,s){if(o.cs.B()){var n=0;return o.docChanges.map(function(t){var e=new Vc(r,t.doc.key,t.doc,o.fromCache,o.ls.has(t.doc.key),s);return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var u=o.cs;return o.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=new Vc(r,t.doc.key,t.doc,o.fromCache,o.ls.has(t.doc.key),s),n=-1,i=-1;return 0!==t.type&&(n=u.indexOf(t.doc.key),u=u.delete(t.doc.key)),1!==t.type&&(i=(u=u.add(t.doc)).indexOf(t.doc.key)),{type:function(){switch(t.type){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return yu()}}(),doc:e,oldIndex:n,newIndex:i}})}(this.pf,e,this.Gf,this.yf),this.Hf=e),this.Kf},xc.prototype.isEqual=function(t){if(!(t instanceof xc))throw ba("isEqual","QuerySnapshot",1,t);return this.pf===t.pf&&this.jf.isEqual(t.jf)&&this.Gf.isEqual(t.Gf)&&this.yf===t.yf},xc.prototype.zf=function(t){return new Vc(this.pf,t.key,t,this.metadata.fromCache,this.Gf.ls.has(t.key),this.yf)},xc),Uc=(n(Mc,Ac=Cc),Object.defineProperty(Mc.prototype,"id",{get:function(){return this.kf.path.q()},enumerable:!0,configurable:!0}),Object.defineProperty(Mc.prototype,"parent",{get:function(){var t=this.kf.path.O();return t.B()?null:new Oc(new sr(t),this.firestore)},enumerable:!0,configurable:!0}),Object.defineProperty(Mc.prototype,"path",{get:function(){return this.kf.path.G()},enumerable:!0,configurable:!0}),Mc.prototype.doc=function(t){if(ha("CollectionReference.doc",arguments,0,1),0===arguments.length&&(t=gu.Tn()),ca("CollectionReference.doc","non-empty string",1,t),""===t)throw new Mi(Ui.INVALID_ARGUMENT,"Document path must be a non-empty string");var e=Ji.K(t);return Oc.Pf(this.kf.path.child(e),this.firestore,this.yf)},Mc.prototype.add=function(t){ua("CollectionReference.add",arguments,1),ca("CollectionReference.add","object",1,this.yf?this.yf.toFirestore(t):t);var e=this.doc();return e.set(t).then(function(){return e})},Mc.prototype.withConverter=function(t){return new Mc(this.Yf,this.firestore,t)},Mc);function Mc(t,e,n){var i=this;if(((i=Ac.call(this,Po.ve(t),e,n)||this).Yf=t).length%2!=1)throw new Mi(Ui.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t.G()+" has "+t.length);return i}function xc(t,e,n,i){this.pf=t,this.jf=e,this.Gf=n,this.yf=i,this.Kf=null,this.Hf=null,this.metadata=new Lc(n.hasPendingWrites,n.fromCache)}function Fc(t,e,n){this.kf=t,this.firestore=e,this.yf=n}function qc(){return null!==Ic&&Ic.apply(this,arguments)||this}function Gc(t,e,n,i,r,o){this.pf=t,this.Af=e,this.Ff=n,this.Nf=i,this.$f=r,this.yf=o}function jc(t,e){this.hasPendingWrites=t,this.fromCache=e}function Bc(t,e,n){this.Af=t,this.firestore=e,this.yf=n,this.af=this.firestore.hf()}function zc(t){this.pf=t,this.bf=[],this.vf=!1}function Hc(t,e){this.pf=t,this.gf=e}function Yc(t,e,n){var i=this;if(void 0===n&&(n=new cc),this.nf=null,this.rf=new Hu,this.INTERNAL={delete:function(){return c(i,void 0,void 0,function(){return f(this,function(t){switch(t.label){case 0:return this.hf(),[4,this.af.terminate()];case 1:return t.sent(),[2]}})})}},"object"==typeof t.options){var r=t;this.nf=r,this.if=Yc.uf(r),this.cf=r.name,this.lf=new Fi(e)}else{var o=t;if(!o.projectId)throw new Mi(Ui.INVALID_ARGUMENT,"Must provide projectId");this.if=new Au(o.projectId,o.database),this.cf="[DEFAULT]",this.lf=new xi}this._f=n,this.ff=new _c({}),this.df=this.wf(this.if)}function Qc(t){var e,n;if(void 0===t.host){if(void 0!==t.ssl)throw new Mi(Ui.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else la("settings","non-empty string","host",t.host),this.host=t.host,pa("settings","boolean","ssl",t.ssl),this.ssl=null===(e=t.ssl)||void 0===e||e;if(wa("settings",t,["host","ssl","credentials","timestampsInSnapshots","cacheSizeBytes","experimentalForceLongPolling"]),pa("settings","object","credentials",t.credentials),this.credentials=t.credentials,pa("settings","boolean","timestampsInSnapshots",t.timestampsInSnapshots),!0===t.timestampsInSnapshots?pu("The setting 'timestampsInSnapshots: true' is no longer required and should be removed."):!1===t.timestampsInSnapshots&&pu("Support for 'timestampsInSnapshots: false' will be removed soon. You must update your code to handle Timestamp objects."),this.timestampsInSnapshots=null===(n=t.timestampsInSnapshots)||void 0===n||n,pa("settings","number","cacheSizeBytes",t.cacheSizeBytes),void 0===t.cacheSizeBytes)this.cacheSizeBytes=Yu.mh;else{if(t.cacheSizeBytes!==Tc&&t.cacheSizeBytes<Yu.Ih)throw new Mi(Ui.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+Yu.Ih);this.cacheSizeBytes=t.cacheSizeBytes}pa("settings","boolean","experimentalForceLongPolling",t.experimentalForceLongPolling),this.forceLongPolling=void 0!==t.experimentalForceLongPolling&&t.experimentalForceLongPolling}function Wc(t,e,n,i){this.firestore=t,this.timestampsInSnapshots=e,this.Y_=n,this.converter=i}function Xc(t,e){if(void 0===e)return{merge:!1};if(wa(t,e,["merge","mergeFields"]),pa(t,"boolean","merge",e.merge),void 0!==(n=e.mergeFields)&&function(t,e,n){if(!(n instanceof Array))throw new Mi(Ui.INVALID_ARGUMENT,"Function "+t+"() requires its "+e+" option to be an array, but it was: "+ga(n));for(var i=0;i<n.length;++i)if(!("string"==typeof(r=n[i])||r instanceof ka))throw new Mi(Ui.INVALID_ARGUMENT,"Function "+t+"() requires all "+e+" elements to be a string or a FieldPath, but the value at index "+i+" was: "+ga(n[i]));var r}(t,"mergeFields",n),void 0!==e.mergeFields&&void 0!==e.merge)throw new Mi(Ui.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');var n;return e}function Kc(t,e){return void 0===e?{}:(wa(t,e,["serverTimestamps"]),da(t,0,"serverTimestamps",e.serverTimestamps,["estimate","previous","none"]),e)}function $c(t,e){fa(t,"object",1,e),e&&(wa(t,e,["source"]),da(t,0,"source",e.source,["default","server","cache"]))}function Zc(t,e,n){if(e instanceof Oc){if(e.firestore!==n)throw new Mi(Ui.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}throw ba(t,"DocumentReference",1,e)}function Jc(t,e,n){var i;return t?(i=t.toFirestore(e),n="toFirestore() in "+n):i=e,[i,n]}var tf,ef=Na(Sc,"Use firebase.firestore() instead."),nf=Na(Rc,"Use firebase.firestore().runTransaction() instead."),rf=Na(kc,"Use firebase.firestore().batch() instead."),of=Na(Oc,"Use firebase.firestore().doc() instead."),sf=Na(Dc),uf=Na(Vc),af=Na(Cc),hf=Na(Pc),cf=Na(Uc,"Use firebase.firestore().collection() instead."),ff={Firestore:ef,GeoPoint:Wa,Timestamp:ji,Blob:Ra,Transaction:nf,WriteBatch:rf,DocumentReference:of,DocumentSnapshot:sf,Query:af,QueryDocumentSnapshot:uf,QuerySnapshot:hf,CollectionReference:cf,FieldPath:ka,FieldValue:Qa,setLogLevel:Sc.setLogLevel,CACHE_SIZE_UNLIMITED:Tc},lf=(Ef.prototype.du=function(t){},Ef.prototype.Cu=function(){},Ef),pf=(bf.prototype.du=function(t){this.ed.push(t)},bf.prototype.Cu=function(){window.removeEventListener("online",this.Xf),window.removeEventListener("offline",this.Zf)},bf.prototype.sd=function(){window.addEventListener("online",this.Xf),window.addEventListener("offline",this.Zf)},bf.prototype.Jf=function(){lu("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.ed;t<e.length;t++)(0,e[t])(0)},bf.prototype.td=function(){lu("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.ed;t<e.length;t++)(0,e[t])(1)},bf.nd=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},bf),df=(wf.prototype.Da=function(t){this.od=t},wf.prototype.ga=function(t){this.ad=t},wf.prototype.onMessage=function(t){this.ud=t},wf.prototype.close=function(){this.hd()},wf.prototype.send=function(t){this.rd(t)},wf.prototype.ld=function(){this.od()},wf.prototype._d=function(t){this.ad(t)},wf.prototype.fd=function(t){this.ud(t)},wf),yf={BatchGetDocuments:"batchGet",Commit:"commit"},vf="gl-js/ fire/"+Li,gf=(mf.prototype.wd=function(t,e){if(e)for(var n in e.o)e.o.hasOwnProperty(n)&&(t[n]=e.o[n]);t["X-Goog-Api-Client"]=vf},mf.prototype.Qa=function(a,i,r){var h=this,c=this.Td(a);return new Promise(function(o,s){var u=new Oi;u.listenOnce(Ri.COMPLETE,function(){try{switch(u.getLastErrorCode()){case Si.NO_ERROR:var t=u.getResponseJson();lu("Connection","XHR received:",JSON.stringify(t)),o(t);break;case Si.TIMEOUT:lu("Connection",'RPC "'+a+'" timed out'),s(new Mi(Ui.DEADLINE_EXCEEDED,"Request time out"));break;case Si.HTTP_ERROR:var e=u.getStatus();if(lu("Connection",'RPC "'+a+'" failed with status:',e,"response text:",u.getResponseText()),0<e){var n=u.getResponseJson().error;if(n&&n.status&&n.message){var i=(r=n.status.toLowerCase().replace("_","-"),0<=Object.values(Ui).indexOf(r)?r:Ui.UNKNOWN);s(new Mi(i,n.message))}else s(new Mi(Ui.UNKNOWN,"Server responded with status "+u.getStatus()))}else lu("Connection",'RPC "'+a+'" failed'),s(new Mi(Ui.UNAVAILABLE,"Connection failed."));break;default:yu()}}finally{lu("Connection",'RPC "'+a+'" completed.')}var r});var t=Object.assign({},i);delete t.database;var e=JSON.stringify(t);lu("Connection","XHR sending: ",c+" "+e);var n={"Content-Type":"text/plain"};h.wd(n,r),u.send(c,"POST",e,n,15)})},mf.prototype.ja=function(t,e,n){return this.Qa(t,e,n)},mf.prototype.Ca=function(t,e){var n,i,r=[this.dd,"/","google.firestore.v1.Firestore","/",t,"/channel"],o=_i(),s={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.ci.projectId+"/databases/"+this.ci.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling};this.wd(s.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(d())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=d().indexOf("Electron/")||0<=(i=d()).indexOf("MSIE ")||0<=i.indexOf("Trident/")||0<=d().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(s.httpHeadersOverwriteParam="$httpHeaders");var u=r.join("");function a(t,e){h.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})}lu("Connection","Creating WebChannel: "+u+" "+s);var h=o.createWebChannel(u,s),c=!1,f=!1,l=new df({rd:function(t){f?lu("Connection","Not sending because WebChannel is closed:",t):(c||(lu("Connection","Opening WebChannel transport."),h.open(),c=!0),lu("Connection","WebChannel sending:",t),h.send(t))},hd:function(){return h.close()}});return a(ki.EventType.OPEN,function(){f||lu("Connection","WebChannel transport opened.")}),a(ki.EventType.CLOSE,function(){f||(f=!0,lu("Connection","WebChannel transport closed"),l._d())}),a(ki.EventType.ERROR,function(t){f||(f=!0,lu("Connection","WebChannel transport errored:",t),l._d(new Mi(Ui.UNAVAILABLE,"The operation could not be completed")))}),a(ki.EventType.MESSAGE,function(t){var e;if(!f){var n=t.data[0];vu(!!n);var i=n.error||(null===(e=n[0])||void 0===e?void 0:e.error);if(i){lu("Connection","WebChannel received error:",i);var r=i.status,o=function(){var t=ls[r];if(void 0!==t)return Is(t)}(),s=i.message;void 0===o&&(o=Ui.INTERNAL,s="Unknown error status: "+r+" with message "+i.message),f=!0,l._d(new Mi(o,s)),h.close()}else lu("Connection","WebChannel received:",n),l.fd(n)}}),setTimeout(function(){l.ld()},0),l},mf.prototype.Td=function(t){var e=yf[t];return this.dd+"/v1/projects/"+this.ci.projectId+"/databases/"+this.ci.database+"/documents:"+e},mf);function mf(t){this.ci=t.ci;var e=t.ssl?"https":"http";this.dd=e+"://"+t.host,this.forceLongPolling=t.forceLongPolling}function wf(t){this.rd=t.rd,this.hd=t.hd}function bf(){var t=this;this.Xf=function(){return t.Jf()},this.Zf=function(){return t.td()},this.ed=[],this.sd()}function Ef(){}function Af(){this.$o="undefined"!=typeof atob}uu.dn((Object.defineProperty(Af.prototype,"document",{get:function(){return"undefined"!=typeof document?document:null},enumerable:!0,configurable:!0}),Object.defineProperty(Af.prototype,"window",{get:function(){return"undefined"!=typeof window?window:null},enumerable:!0,configurable:!0}),Af.prototype.q_=function(t){return Promise.resolve(new gf(t))},Af.prototype.k_=function(){return new(pf.nd()?pf:lf)},Af.prototype.B_=function(t){return new ru(t,{fi:!0})},Af.prototype.wn=function(t){return JSON.stringify(t)},Af.prototype.atob=function(t){return atob(t)},Af.prototype.btoa=function(t){return btoa(t)},new Af)),(tf=If).INTERNAL.registerComponent(new E("firestore",function(t){return e=t.getProvider("app").getImmediate(),n=t.getProvider("auth-internal"),new Sc(e,n,new cc);var e,n},"PUBLIC").setServiceProps(Object.assign({},ff))),tf.registerVersion("@firebase/firestore","1.14.2-0")}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.memory.js - be sure to load firebase-app.js first.")}});