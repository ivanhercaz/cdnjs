!function(e,t){if("function"==typeof define&&define.amd)define(["exports","../../globals/js/misc/mixin","../../globals/js/mixins/create-component","../../globals/js/mixins/init-component-by-search","../../globals/js/mixins/handles","../../globals/js/misc/on","../../globals/js/settings","../../globals/js/misc/event-matches"],t);else if("undefined"!=typeof exports)t(exports,require("../../globals/js/misc/mixin"),require("../../globals/js/mixins/create-component"),require("../../globals/js/mixins/init-component-by-search"),require("../../globals/js/mixins/handles"),require("../../globals/js/misc/on"),require("../../globals/js/settings"),require("../../globals/js/misc/event-matches"));else{var n={};t(n,e.mixin,e.createComponent,e.initComponentBySearch,e.handles,e.on,e.settings,e.eventMatches),e.headerSubmenu=n}}("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:this,function(e,r,a,c,s,i,l,u){"use strict";function t(e){return e&&e.__esModule?e:{default:e}}function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function f(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],o=!0,r=!1,a=void 0;try{for(var c,s=e[Symbol.iterator]();!(o=(c=s.next()).done)&&(n.push(c.value),!t||n.length!==t);o=!0);}catch(e){r=!0,a=e}finally{try{o||null==s.return||s.return()}finally{if(r)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function d(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function p(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _(e,t){return(_=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,r=t(r),a=t(a),c=t(c),s=t(s),i=t(i),l=t(l),u=t(u);var E=function(){return Array.prototype.forEach}(),o=function(){function o(e,t){var l;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(l=p(this,m(o).call(this,e,t)))._getAction=function(e){if((0,u.default)(e,l.options.selectorFlyoutMenu))return l.constructor.actions.DELEGATE_TO_FLYOUT_MENU;switch(e.type){case"keydown":return{32:l.constructor.actions.TOGGLE_SUBMENU_WITH_FOCUS,13:l.constructor.actions.TOGGLE_SUBMENU_WITH_FOCUS,27:l.constructor.actions.CLOSE_SUBMENU}[e.which];case"click":return(0,u.default)(e,l.options.selectorItem)?l.constructor.actions.CLOSE_SUBMENU:null;case"blur":case"focusout":return l.element.contains(e.relatedTarget)?null:l.constructor.actions.CLOSE_SUBMENU;case"mouseenter":return l.constructor.actions.OPEN_SUBMENU;case"mouseleave":return l.constructor.actions.CLOSE_SUBMENU;default:return null}},l._getNewState=function(e){var t="true"===l.element.querySelector(l.options.selectorTrigger).getAttribute(l.options.attribExpanded);switch(e){case l.constructor.actions.CLOSE_SUBMENU:return!1;case l.constructor.actions.OPEN_SUBMENU:return!0;case l.constructor.actions.TOGGLE_SUBMENU_WITH_FOCUS:return!t;default:return t}},l._setState=function(e){var t=e.shouldBeExpanded,n=e.shouldFocusOnOpen;l.element.querySelector(l.options.selectorTrigger).setAttribute(l.options.attribExpanded,t),E.call(l.element.querySelectorAll(l.options.selectorItem),function(e){e.tabIndex=t?0:-1}),t&&n&&l.element.querySelector(l.options.selectorItem).focus()},l.getCurrentNavigation=function(){var e=l.element.ownerDocument.activeElement;return e.nodeType===Node.ELEMENT_NODE&&e.matches(l.options.selectorItem)?e:null},l.navigate=function(c){for(var e,s=(e=l.element.querySelectorAll(l.options.selectorItem),Array.prototype.slice.call(e)),t=l.getCurrentNavigation()||l.element.querySelector(l.options.selectorItemSelected),n=function(e){var t,n,o,r,a=Math.max(s.indexOf(e)+c,-1);return s[o=a,r=s.length,t=o-(o<r?0:r),n=s.length,t+(0<=t?0:n)]},o=n(t);o&&o!==t;o=n(o))if(!o.matches(l.options.selectorItemHidden)&&!o.parentNode.matches(l.options.selectorItemHidden)&&!o.matches(l.options.selectorItemSelected)){o.focus();break}},l._handleEvent=function(e){if(l.element.querySelector(l.options.selectorTrigger)){var t=l._getAction(e);if(t){var n=l._getNewState(t);l._setState({shouldBeExpanded:n})}}},l._handleKeyDown=function(e){var t=l.element.querySelector(l.options.selectorTrigger);if(t){var n=l._getAction(e);switch(32===e.which&&e.preventDefault(),n){case l.constructor.actions.DELEGATE_TO_FLYOUT_MENU:break;case l.constructor.actions.CLOSE_SUBMENU:var o=l._getNewState(n);l._setState({shouldBeExpanded:o});break;case l.constructor.actions.TOGGLE_SUBMENU_WITH_FOCUS:var r=l._getNewState(n);l._setState({shouldBeExpanded:r,shouldFocusOnOpen:!0});break;default:if("true"===t.getAttribute(l.options.attribExpanded)){var a={38:l.constructor.NAVIGATE.BACKWARD,40:l.constructor.NAVIGATE.FORWARD}[e.which];switch(e.which){case 35:e.preventDefault();var c=l.element.querySelectorAll(l.options.selectorItem),s=c[c.length-1];s&&s.focus();break;case 36:e.preventDefault();var i=f(l.element.querySelectorAll(l.options.selectorItem),1)[0];i&&i.focus();break;case 38:case 40:l.navigate(a),e.preventDefault()}}}}};var n="onfocusout"in window;return l.manage((0,i.default)(l.element,n?"focusout":"blur",l._handleEvent,!n)),l.manage((0,i.default)(l.element,"mouseenter",l._handleEvent)),l.manage((0,i.default)(l.element,"mouseleave",l._handleEvent)),l.manage((0,i.default)(l.element,"click",l._handleEvent)),l.manage((0,i.default)(l.element,"keydown",l._handleKeyDown)),l}var e,t,n;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_(e,t)}(o,(0,r.default)(a.default,c.default,s.default)),e=o,n=[{key:"options",get:function(){var e=l.default.prefix;return{selectorInit:"[data-header-submenu]",selectorTrigger:".".concat(e,"--header__menu-title"),selectorItem:".".concat(e,"--header__menu .").concat(e,"--header__menu-item"),attribExpanded:"aria-expanded"}}}],(t=null)&&d(e.prototype,t),n&&d(e,n),o.components=new WeakMap,o.actions={CLOSE_SUBMENU:"CLOSE_SUBMENU",OPEN_SUBMENU:"OPEN_SUBMENU",TOGGLE_SUBMENU_WITH_FOCUS:"TOGGLE_SUBMENU_WITH_FOCUS",DELEGATE_TO_FLYOUT_MENU:"DELEGATE_TO_FLYOUT_MENU"},o.NAVIGATE={BACKWARD:-1,FORWARD:1},o}();e.default=o});