!function(e,t){if("function"==typeof define&&define.amd)define(["exports","../../globals/js/settings","../../globals/js/misc/mixin","../../globals/js/mixins/create-component","../../globals/js/mixins/init-component-by-search","../../globals/js/mixins/evented-state","../../globals/js/mixins/handles","../../globals/js/misc/event-matches","../../globals/js/misc/on"],t);else if("undefined"!=typeof exports)t(exports,require("../../globals/js/settings"),require("../../globals/js/misc/mixin"),require("../../globals/js/mixins/create-component"),require("../../globals/js/mixins/init-component-by-search"),require("../../globals/js/mixins/evented-state"),require("../../globals/js/mixins/handles"),require("../../globals/js/misc/event-matches"),require("../../globals/js/misc/on"));else{var o={};t(o,e.settings,e.mixin,e.createComponent,e.initComponentBySearch,e.eventedState,e.handles,e.eventMatches,e.on),e.dataTable=o}}("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:this,function(e,n,l,c,r,s,i,u,d){"use strict";function t(e){return e&&e.__esModule?e:{default:e}}function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function p(e){return function(e){if(Array.isArray(e)){for(var t=0,o=new Array(e.length);t<e.length;t++)o[t]=e[t];return o}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function b(e,t){for(var o=0;o<t.length;o++){var a=t[o];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function f(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function g(e,t){return(g=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,n=t(n),l=t(l),c=t(c),r=t(r),s=t(s),i=t(i),u=t(u),d=t(d);function v(e){return Array.prototype.slice.call(e)}var a=function(){function o(e,t){var c;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(c=f(this,h(o).call(this,e,t)))._sortToggle=function(e){var o=e.element,t=e.previousValue;v(c.tableHeaders).forEach(function(e){var t=e.querySelector(c.options.selectorTableSort);null!==t&&t!==o&&(t.classList.remove(c.options.classTableSortActive),t.classList.remove(c.options.classTableSortAscending))}),t?"ascending"===t?(o.dataset.previousValue="descending",o.classList.add(c.options.classTableSortActive),o.classList.remove(c.options.classTableSortAscending)):"descending"===t&&(o.removeAttribute("data-previous-value"),o.classList.remove(c.options.classTableSortActive),o.classList.remove(c.options.classTableSortAscending)):(o.dataset.previousValue="ascending",o.classList.add(c.options.classTableSortActive),o.classList.add(c.options.classTableSortAscending))},c._selectToggle=function(e){var t=e.element,o=t.checked;c.state.checkboxCount+=o?1:-1,c.countEl.textContent=c.state.checkboxCount,t.parentNode.parentNode.classList.toggle(c.options.classTableSelected),c._actionBarToggle(0<c.state.checkboxCount)},c._selectAllToggle=function(e){var o=e.element.checked,t=v(c.element.querySelectorAll(c.options.selectorCheckbox));c.state.checkboxCount=o?t.length-1:0,t.forEach(function(e){e.checked=o;var t=e.parentNode.parentNode;o&&t?t.classList.add(c.options.classTableSelected):t.classList.remove(c.options.classTableSelected)}),c._actionBarToggle(0<c.state.checkboxCount),c.batchActionEl&&(c.countEl.textContent=c.state.checkboxCount)},c._actionBarCancel=function(){var e=v(c.element.querySelectorAll(c.options.selectorCheckbox));v(c.element.querySelectorAll(c.options.selectorTableSelected)).forEach(function(e){e.classList.remove(c.options.classTableSelected)}),e.forEach(function(e){e.checked=!1}),c.state.checkboxCount=0,c._actionBarToggle(!1),c.batchActionEl&&(c.countEl.textContent=c.state.checkboxCount)},c._actionBarToggle=function(e){var t;e?(c.batchActionEl.dataset.active=!0,c.batchActionEl.classList.add(c.options.classActionBarActive)):c.batchActionEl&&(c.batchActionEl.dataset.active=!1,c.batchActionEl.classList.remove(c.options.classActionBarActive)),c.batchActionEl&&(t=c.manage((0,d.default)(c.batchActionEl,"transitionend",function(e){t=t&&c.unmanage(t).release(),e.target.matches(c.options.selectorActions)&&("false"===c.batchActionEl.dataset.active?c.batchActionEl.setAttribute("tabIndex",-1):c.batchActionEl.setAttribute("tabIndex",0))})))},c._rowExpandToggle=function(e){var t=e.element,o=e.forceExpand,a=t.closest(c.options.eventParentContainer);if(null!=o?o:void 0===t.dataset.previousValue||"expanded"===t.dataset.previousValue)t.dataset.previousValue="collapsed",a.classList.add(c.options.classExpandableRow);else{a.classList.remove(c.options.classExpandableRow),t.dataset.previousValue="expanded";var n=c.element.querySelector(c.options.selectorExpandHeader);n&&(n.dataset.previousValue="expanded")}},c._rowExpandToggleAll=function(e){var t=e.element,o=void 0===t.dataset.previousValue||"expanded"===t.dataset.previousValue;t.dataset.previousValue=o?"collapsed":"expanded";var a=c.element.querySelectorAll(c.options.selectorExpandCells);Array.prototype.forEach.call(a,function(e){c._rowExpandToggle({element:e,forceExpand:o})})},c._expandableHoverToggle=function(e){var t=(0,u.default)(e,c.options.selectorChildRow);t&&t.previousElementSibling.classList.toggle(c.options.classExpandableRowHover,"mouseover"===e.type)},c._toggleState=function(e,t){var o=e.dataset,a=o.label?o.label:"",n=o.previousValue?o.previousValue:"",l=t;c.changeState({group:o.event,element:e,label:a,previousValue:n,initialEvt:l})},c._keydownHandler=function(e){var t=c.element.querySelector(c.options.selectorToolbarSearchContainer),o=(0,u.default)(e,c.options.selectorSearchMagnifier),a=t.classList.contains(c.options.classToolbarSearchActive);27===e.which&&c._actionBarCancel(),t&&o&&13===e.which&&c.activateSearch(t),a&&27===e.which&&c.deactivateSearch(t,e)},c.refreshRows=function(){var e=v(c.element.querySelectorAll(c.options.selectorExpandCells)),t=v(c.element.querySelectorAll(c.options.selectorExpandableRows)),o=v(c.element.querySelectorAll(c.options.selectorParentRows));if(0<c.parentRows.length){var a=o.filter(function(t){return!c.parentRows.some(function(e){return e===t})});if(0<t.length){var n=a.map(function(e){return e.nextElementSibling}),l=[].concat(p(v(c.expandableRows)),p(v(n)));c.expandableRows=l}}else 0<t.length&&(c.expandableRows=t);c.expandCells=e,c.parentRows=o},c.container=e.parentNode,c.toolbarEl=c.element.querySelector(c.options.selectorToolbar),c.batchActionEl=c.element.querySelector(c.options.selectorActions),c.countEl=c.element.querySelector(c.options.selectorCount),c.cancelEl=c.element.querySelector(c.options.selectorActionCancel),c.tableHeaders=c.element.querySelectorAll("th"),c.tableBody=c.element.querySelector(c.options.selectorTableBody),c.expandCells=[],c.expandableRows=[],c.parentRows=[],c.refreshRows(),c.manage((0,d.default)(c.element,"mouseover",c._expandableHoverToggle)),c.manage((0,d.default)(c.element,"mouseout",c._expandableHoverToggle)),c.manage((0,d.default)(c.element,"click",function(e){var t=(0,u.default)(e,c.options.eventTrigger),o=c.element.querySelector(c.options.selectorToolbarSearchContainer);t&&c._toggleState(t,e),o&&c._handleDocumentClick(e)})),c.manage((0,d.default)(c.element,"keydown",c._keydownHandler)),c.state={checkboxCount:0},c}var e,t,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&g(e,t)}(o,(0,l.default)(c.default,r.default,s.default,i.default)),e=o,a=[{key:"options",get:function(){var e=n.default.prefix;return{selectorInit:"[data-table]",selectorToolbar:".".concat(e,"--table--toolbar"),selectorActions:".".concat(e,"--batch-actions"),selectorCount:"[data-items-selected]",selectorActionCancel:".".concat(e,"--batch-summary__cancel"),selectorCheckbox:".".concat(e,"--checkbox"),selectorExpandHeader:"th.".concat(e,"--table-expand"),selectorExpandCells:"td.".concat(e,"--table-expand"),selectorExpandableRows:".".concat(e,"--expandable-row"),selectorParentRows:".".concat(e,"--parent-row"),selectorChildRow:"[data-child-row]",selectorTableBody:"tbody",selectorTableSort:".".concat(e,"--table-sort"),selectorTableSelected:".".concat(e,"--data-table--selected"),selectorToolbarSearchContainer:".".concat(e,"--toolbar-search-container-expandable"),selectorSearchMagnifier:".".concat(e,"--search-magnifier"),selectorSearchInput:".".concat(e,"--search-input"),classExpandableRow:"".concat(e,"--expandable-row"),classExpandableRowHidden:"".concat(e,"--expandable-row--hidden"),classExpandableRowHover:"".concat(e,"--expandable-row--hover"),classTableSortAscending:"".concat(e,"--table-sort--ascending"),classTableSortActive:"".concat(e,"--table-sort--active"),classToolbarSearchActive:"".concat(e,"--toolbar-search-container-active"),classActionBarActive:"".concat(e,"--batch-actions--active"),classTableSelected:"".concat(e,"--data-table--selected"),eventBeforeExpand:"data-table-beforetoggleexpand",eventAfterExpand:"data-table-aftertoggleexpand",eventBeforeExpandAll:"data-table-beforetoggleexpandall",eventAfterExpandAll:"data-table-aftertoggleexpandall",eventBeforeSort:"data-table-beforetogglesort",eventAfterSort:"data-table-aftertogglesort",eventTrigger:"[data-event]",eventParentContainer:"[data-parent-row]"}}}],(t=[{key:"_handleDocumentClick",value:function(e){var t=this.element.querySelector(this.options.selectorToolbarSearchContainer),o=(0,u.default)(e,this.options.selectorSearchMagnifier),a=t.classList.contains(this.options.classToolbarSearchActive);t&&o&&this.activateSearch(t),a&&this.deactivateSearch(t,e)}},{key:"activateSearch",value:function(e){var t=e.querySelector(this.options.selectorSearchInput);e.classList.add(this.options.classToolbarSearchActive),t.focus()}},{key:"deactivateSearch",value:function(e,t){var o=e.querySelector(this.options.selectorSearchMagnifier),a=e.querySelector(this.options.selectorSearchInput),n=o.querySelector("svg");0===a.value.length&&t.target!==a&&t.target!==o&&t.target!==n&&(e.classList.remove(this.options.classToolbarSearchActive),o.focus()),27===t.which&&t.target===a&&(e.classList.remove(this.options.classToolbarSearchActive),o.focus())}},{key:"_changeState",value:function(e,t){this[this.constructor.eventHandlers[e.group]](e),t()}}])&&b(e.prototype,t),a&&b(e,a),o.components=new WeakMap,o.eventHandlers={expand:"_rowExpandToggle",expandAll:"_rowExpandToggleAll",sort:"_sortToggle",select:"_selectToggle","select-all":"_selectAllToggle","action-bar-cancel":"_actionBarCancel"},o}();e.default=a});