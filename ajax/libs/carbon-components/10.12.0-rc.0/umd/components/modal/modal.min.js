!function(e,t){var n;"function"==typeof define&&define.amd?define(["exports","warning","../../globals/js/settings","../../globals/js/misc/mixin","../../globals/js/mixins/create-component","../../globals/js/mixins/init-component-by-launcher","../../globals/js/mixins/evented-show-hide-state","../../globals/js/mixins/handles","../../globals/js/misc/event-matches","../../globals/js/misc/on"],t):"undefined"!=typeof exports?t(exports,require("warning"),require("../../globals/js/settings"),require("../../globals/js/misc/mixin"),require("../../globals/js/mixins/create-component"),require("../../globals/js/mixins/init-component-by-launcher"),require("../../globals/js/mixins/evented-show-hide-state"),require("../../globals/js/mixins/handles"),require("../../globals/js/misc/event-matches"),require("../../globals/js/misc/on")):(t(n={},e.warning,e.settings,e.mixin,e.createComponent,e.initComponentByLauncher,e.eventedShowHideState,e.handles,e.eventMatches,e.on),e.modal=n)}("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:this,function(e,a,r,s,i,l,c,u,d,h){"use strict";function t(e){return e&&e.__esModule?e:{default:e}}function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function f(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function m(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function b(e,t){return(b=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,a=t(a),r=t(r),s=t(s),i=t(i),l=t(l),c=t(c),u=t(u),d=t(d),h=t(h);var o=function(){function o(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(n=m(this,p(o).call(this,e,t)))._handleFocusinListener=void 0,n._handleKeydownListener=void 0,n._handleFocusin=function(t){var e=n.element.querySelector(n.options.selectorModalContainer)||n.element;n.element.classList.contains(n.options.classVisible)&&!e.contains(t.target)&&n.options.selectorsFloatingMenus.every(function(e){return!(0,d.default)(t,e)})&&n.element.querySelector(r.default.selectorTabbable).focus()},n._hookCloseActions(),n}var e,t,n;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&b(e,t)}(o,(0,s.default)(i.default,l.default,c.default,u.default)),e=o,n=[{key:"options",get:function(){var e=r.default.prefix;return{selectorInit:"[data-modal]",selectorModalClose:"[data-modal-close]",selectorPrimaryFocus:"[data-modal-primary-focus]",selectorsFloatingMenus:[".".concat(e,"--overflow-menu-options"),".".concat(e,"--tooltip"),".flatpickr-calendar"],selectorModalContainer:".".concat(e,"--modal-container"),classVisible:"is-visible",classBody:"".concat(e,"--body--with-modal-open"),attribInitTarget:"data-modal-target",initEventNames:["click"],eventBeforeShown:"modal-beingshown",eventAfterShown:"modal-shown",eventBeforeHidden:"modal-beinghidden",eventAfterHidden:"modal-hidden"}}}],(t=[{key:"createdByLauncher",value:function(e){this.show(e)}},{key:"shouldStateBeChanged",value:function(e){return"shown"===e?!this.element.classList.contains(this.options.classVisible):this.element.classList.contains(this.options.classVisible)}},{key:"_changeState",value:function(t,e,n){var o,s,i,l=this;this._handleFocusinListener&&(this._handleFocusinListener=this.unmanage(this._handleFocusinListener).release()),"shown"===t&&(i=(s="onfocusin"in this.element.ownerDocument.defaultView)?"focusin":"focus",this._handleFocusinListener=this.manage((0,h.default)(this.element.ownerDocument,i,this._handleFocusin,!s))),"hidden"===t?(this.element.classList.toggle(this.options.classVisible,!1),this.element.ownerDocument.body.classList.toggle(this.options.classBody,!1),(this.options.selectorFocusOnClose||this.previouslyFocusedNode)&&(this.element.ownerDocument.querySelector(this.options.selectorFocusOnClose)||this.previouslyFocusedNode).focus()):"shown"===t&&(this.element.classList.toggle(this.options.classVisible,!0),this.element.ownerDocument.body.classList.toggle(this.options.classBody,!0)),o=this.manage((0,h.default)(this.element,"transitionend",function(){var e;o=o&&l.unmanage(o).release(),"shown"===t&&0<l.element.offsetWidth&&0<l.element.offsetHeight&&(l.previouslyFocusedNode=l.element.ownerDocument.activeElement,(e=l.element.querySelector(l.options.selectorPrimaryFocus)||l.element.querySelector(r.default.selectorTabbable)).focus(),"production"!==process.env.NODE_ENV&&"production"!==process.env.NODE_ENV&&(0,a.default)(e,"Modals need to contain a focusable element by either using "+"`".concat(l.options.selectorPrimaryFocus,"` or settings.selectorTabbable."))),n()}))}},{key:"_hookCloseActions",value:function(){var n=this;this.manage((0,h.default)(this.element,"click",function(e){var t=(0,d.default)(e,n.options.selectorModalClose);t&&(e.delegateTarget=t),!t&&e.target!==n.element||n.hide(e)})),this._handleKeydownListener&&(this._handleKeydownListener=this.unmanage(this._handleKeydownListener).release()),this._handleKeydownListener=this.manage((0,h.default)(this.element.ownerDocument.body,"keydown",function(e){27===e.which&&n.shouldStateBeChanged("hidden")&&(e.stopPropagation(),n.hide(e))}))}}])&&f(e.prototype,t),n&&f(e,n),o.components=new WeakMap,o}();e.default=o});