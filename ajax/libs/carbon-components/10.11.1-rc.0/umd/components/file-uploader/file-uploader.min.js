!function(e,t){if("function"==typeof define&&define.amd)define(["exports","../../globals/js/settings","../../globals/js/misc/mixin","../../globals/js/mixins/create-component","../../globals/js/mixins/init-component-by-search","../../globals/js/mixins/evented-state","../../globals/js/mixins/handles","../../globals/js/misc/event-matches","../../globals/js/misc/on"],t);else if("undefined"!=typeof exports)t(exports,require("../../globals/js/settings"),require("../../globals/js/misc/mixin"),require("../../globals/js/mixins/create-component"),require("../../globals/js/mixins/init-component-by-search"),require("../../globals/js/mixins/evented-state"),require("../../globals/js/mixins/handles"),require("../../globals/js/misc/event-matches"),require("../../globals/js/misc/on"));else{var n={};t(n,e.settings,e.mixin,e.createComponent,e.initComponentBySearch,e.eventedState,e.handles,e.eventMatches,e.on),e.fileUploader=n}}("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:this,function(e,a,i,l,r,s,c,f,u){"use strict";function t(e){return e&&e.__esModule?e:{default:e}}function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function d(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function p(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function g(e,t){return(g=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,a=t(a),i=t(i),l=t(l),r=t(r),s=t(s),c=t(c),f=t(f),u=t(u);function m(e){return Array.prototype.slice.call(e)}var o=function(){function n(e){var a,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if(!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(a=p(this,h(n).call(this,e,t)))._changeState=function(e,t,n){"delete-filename-fileuploader"===e&&a.container.removeChild(t.filenameElement),"function"==typeof n&&n()},a._handleDeleteButton=function(e){var t=(0,f.default)(e,a.options.selectorCloseButton);t&&a.changeState("delete-filename-fileuploader",{initialEvt:e,filenameElement:t.closest(a.options.selectorSelectedFile)})},a._handleDragDrop=function(e){var t=a.element.contains(e.target);if(0<=Array.prototype.indexOf.call(e.dataTransfer.types,"Files")&&!(0,f.default)(e,a.options.selectorOtherDropContainers)){var n=t&&(0,f.default)(e,a.options.selectorDropContainer);if("dragover"===e.type){e.preventDefault();var o=n?"copy":"none";Array.isArray(e.dataTransfer.types)&&(e.dataTransfer.effectAllowed=o),e.dataTransfer.dropEffect=o,a.dropContainer.classList.toggle(a.options.classDragOver,Boolean(n))}"dragleave"===e.type&&a.dropContainer.classList.toggle(a.options.classDragOver,!1),n&&"drop"===e.type&&(e.preventDefault(),a._displayFilenames(e.dataTransfer.files),a.dropContainer.classList.remove(a.options.classDragOver))}},a.input=a.element.querySelector(a.options.selectorInput),a.container=a.element.querySelector(a.options.selectorContainer),a.dropContainer=a.element.querySelector(a.options.selectorDropContainer),!a.input)throw new TypeError("Cannot find the file input box.");if(!a.container)throw new TypeError("Cannot find the file names container.");return a.inputId=a.input.getAttribute("id"),a.manage((0,u.default)(a.input,"change",function(){return a._displayFilenames()})),a.manage((0,u.default)(a.container,"click",a._handleDeleteButton)),a.manage((0,u.default)(a.element.ownerDocument,"dragleave",a._handleDragDrop)),a.manage((0,u.default)(a.dropContainer,"dragover",a._handleDragDrop)),a.manage((0,u.default)(a.dropContainer,"drop",a._handleDragDrop)),a}var e,t,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&g(e,t)}(n,(0,i.default)(l.default,r.default,s.default,c.default)),e=n,o=[{key:"options",get:function(){var e=a.default.prefix;return{selectorInit:"[data-file]",selectorInput:'input[type="file"].'.concat(e,"--file-input"),selectorContainer:"[data-file-container]",selectorCloseButton:".".concat(e,"--file-close"),selectorSelectedFile:".".concat(e,"--file__selected-file"),selectorDropContainer:"[data-file-drop-container]",selectorOtherDropContainers:"[data-drop-container]",classLoading:"".concat(e,"--loading ").concat(e,"--loading--small"),classLoadingAnimation:"".concat(e,"--inline-loading__animation"),classLoadingSvg:"".concat(e,"--loading__svg"),classLoadingBackground:"".concat(e,"--loading__background"),classLoadingStroke:"".concat(e,"--loading__stroke"),classFileName:"".concat(e,"--file-filename"),classFileClose:"".concat(e,"--file-close"),classFileComplete:"".concat(e,"--file-complete"),classSelectedFile:"".concat(e,"--file__selected-file"),classStateContainer:"".concat(e,"--file__state-container"),classDragOver:"".concat(e,"--file__drop-container--drag-over"),eventBeforeDeleteFilenameFileuploader:"fileuploader-before-delete-filename",eventAfterDeleteFilenameFileuploader:"fileuploader-after-delete-filename"}}}],(t=[{key:"_filenamesHTML",value:function(e,t){return'<span class="'.concat(this.options.classSelectedFile,'">\n      <p class="').concat(this.options.classFileName,'">').concat(e,'</p>\n      <span data-for="').concat(t,'" class="').concat(this.options.classStateContainer,'"></span>\n    </span>')}},{key:"_uploadHTML",value:function(){return'\n      <div class="'.concat(this.options.classLoadingAnimation,'">\n        <div data-inline-loading-spinner class="').concat(this.options.classLoading,'">\n          <svg class="').concat(this.options.classLoadingSvg,'" viewBox="-75 -75 150 150">\n            <circle class="').concat(this.options.classLoadingBackground,'" cx="0" cy="0" r="37.5" />\n            <circle class="').concat(this.options.classLoadingStroke,'" cx="0" cy="0" r="37.5" />\n          </svg>\n        </div>\n      </div>')}},{key:"_closeButtonHTML",value:function(){return'\n      <button class="'.concat(this.options.classFileClose,'" type="button" aria-label="close">\n      <svg aria-hidden="true" viewBox="0 0 16 16" width="16" height="16">\n      <path fill="#231F20" d="M12 4.7l-.7-.7L8 7.3 4.7 4l-.7.7L7.3 8 4 11.3l.7.7L8 8.7l3.3 3.3.7-.7L8.7 8z"/>\n      </svg>\n      </button>')}},{key:"_checkmarkHTML",value:function(){return'\n      <svg focusable="false"\n        preserveAspectRatio="xMidYMid meet"\n        style="will-change: transform;"\n        xmlns="http://www.w3.org/2000/svg"\n        class="'.concat(this.options.classFileComplete,'"\n        width="16" height="16" viewBox="0 0 16 16"\n        aria-hidden="true">\n        <path d="M8 1C4.1 1 1 4.1 1 8s3.1 7 7 7 7-3.1 7-7-3.1-7-7-7zM7 11L4.3 8.3l.9-.8L7 9.3l4-3.9.9.8L7 11z"></path>\n        <path d="M7 11L4.3 8.3l.9-.8L7 9.3l4-3.9.9.8L7 11z" data-icon-path="inner-path" opacity="0"></path>\n      </svg>\n    ')}},{key:"_getStateContainers",value:function(){var e=m(this.element.querySelectorAll("[data-for=".concat(this.inputId,"]")));if(0===e.length)throw new TypeError("State container elements not found; invoke _displayFilenames() first");if(e[0].dataset.for!==this.inputId)throw new TypeError("File input id must equal [data-for] attribute");return e}},{key:"_displayFilenames",value:function(e){var t=this,n=0<arguments.length&&void 0!==e?e:this.input.files,o=this.element.querySelector(this.options.selectorContainer),a=m(n).map(function(e){return t._filenamesHTML(e.name,t.inputId)}).join("");o.insertAdjacentHTML("afterbegin",a)}},{key:"_removeState",value:function(e){if(!e||e.nodeType!==Node.ELEMENT_NODE)throw new TypeError("DOM element should be given to initialize this widget.");for(;e.firstChild;)e.removeChild(e.firstChild)}},{key:"_handleStateChange",value:function(e,n,o){var a=this;void 0===n?e.forEach(function(e){a._removeState(e),e.insertAdjacentHTML("beforeend",o)}):e.forEach(function(e,t){t===n&&(a._removeState(e),e.insertAdjacentHTML("beforeend",o))})}},{key:"setState",value:function(e,t){var n=this._getStateContainers();"edit"===e&&this._handleStateChange(n,t,this._closeButtonHTML()),"upload"===e&&this._handleStateChange(n,t,this._uploadHTML()),"complete"===e&&this._handleStateChange(n,t,this._checkmarkHTML())}}])&&d(e.prototype,t),o&&d(e,o),n.components=new WeakMap,n}();e.default=o});